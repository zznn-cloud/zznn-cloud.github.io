<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>chronyä¸ntpdæ—¶é—´åŒæ­¥</title>
      <link href="/2025/09/10/chrony%E4%B8%8Entpd%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5/"/>
      <url>/2025/09/10/chrony%E4%B8%8Entpd%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="chronyä¸ntpdæ—¶é—´åŒæ­¥"><a href="#chronyä¸ntpdæ—¶é—´åŒæ­¥" class="headerlink" title="chronyä¸ntpdæ—¶é—´åŒæ­¥"></a>chronyä¸ntpdæ—¶é—´åŒæ­¥</h1><p><a href="https://wn.zznnwn.cloudns.biz/2023/05/22/centos-chrony%E8%AE%BE%E7%BD%AE%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5/">chronyé…ç½®å‚è€ƒ &gt;&gt;</a></p><p>æœ¬æ–‡ä¸­ceph1ä¸ºæœåŠ¡ç«¯å…¶ä»–ä¸ºå®¢æˆ·ç«¯</p><p>Cephä¸­ä¼šè‡ªåŠ¨æ ¡éªŒå­˜å‚¨èŠ‚ç‚¹ä¹‹é—´çš„æ—¶é—´ï¼Œè‹¥ä¸åŒèŠ‚ç‚¹ä¹‹é—´æ—¶å·®è¾ƒå¤§ï¼Œä¼šæœ‰å‘Šè­¦ï¼Œå› æ­¤<br>æ‰§è¡Œå¦‚ä¸‹æ­¥éª¤ï¼š</p><h2 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h2><p>æ­¥éª¤1 å®‰è£…NTPæœåŠ¡ã€‚</p><ol><li>åœ¨æ‰€æœ‰é›†ç¾¤å’Œå®¢æˆ·ç«¯èŠ‚ç‚¹å®‰è£…NTPã€‚<br>yum install ntp ntpdate  -y<br>apt install  ntp  ntpdate  -y</li><li>åœ¨æ‰€æœ‰é›†ç¾¤å’Œå®¢æˆ·ç«¯èŠ‚ç‚¹å¤‡ä»½æ—§é…ç½®ã€‚<br>cd /etc &amp;&amp; mv ntp.conf ntp.conf.bak</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»¥ceph1ä¸ºNTPæœåŠ¡ç«¯èŠ‚ç‚¹ï¼Œåœ¨ceph1æ–°å»ºNTPæ–‡ä»¶ã€‚ </span></span><br><span class="line">vi /etc/ntp.conf </span><br><span class="line"><span class="comment"># å¹¶æ–°å¢å¦‚ä¸‹å†…å®¹ä½œä¸ºNTPæœåŠ¡ç«¯ï¼š </span></span><br><span class="line">restrict 127.0.0.1 </span><br><span class="line">restrict ::1 </span><br><span class="line">restrict 192.168.3.0 mask 255.255.255.0 </span><br><span class="line">server 127.127.1.0 </span><br><span class="line">fudge 127.127.1.0 stratum 8 </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¯´æ˜: å…¶ä¸­ï¼Œâ€œrestrict 192.168.3.0 mask 255.255.255.0â€æ˜¯ceph1çš„ç½‘æ®µä¸æ©ç ã€‚</p><h3 id="æœåŠ¡ç«¯å®Œæ•´é…ç½®æ–‡ä»¶ã€-etc-ntp-confã€‘ï¼š"><a href="#æœåŠ¡ç«¯å®Œæ•´é…ç½®æ–‡ä»¶ã€-etc-ntp-confã€‘ï¼š" class="headerlink" title="æœåŠ¡ç«¯å®Œæ•´é…ç½®æ–‡ä»¶ã€/etc/ntp.confã€‘ï¼š"></a>æœåŠ¡ç«¯å®Œæ•´é…ç½®æ–‡ä»¶ã€/etc/ntp.confã€‘ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/ntp.conf, configuration for ntpd; see ntp.conf(5) for help</span></span><br><span class="line"></span><br><span class="line">driftfile /var/lib/ntp/ntp.drift</span><br><span class="line"></span><br><span class="line"><span class="comment"># Leap seconds definition provided by tzdata</span></span><br><span class="line">leapfile /usr/share/zoneinfo/leap-seconds.list</span><br><span class="line"></span><br><span class="line"><span class="comment"># Enable this if you want statistics to be logged.</span></span><br><span class="line"><span class="comment">#statsdir /var/log/ntpstats/</span></span><br><span class="line"></span><br><span class="line">statistics loopstats peerstats clockstats</span><br><span class="line">filegen loopstats file loopstats <span class="built_in">type</span> day <span class="built_in">enable</span></span><br><span class="line">filegen peerstats file peerstats <span class="built_in">type</span> day <span class="built_in">enable</span></span><br><span class="line">filegen clockstats file clockstats <span class="built_in">type</span> day <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Specify one or more NTP servers.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Use servers from the NTP Pool Project. Approved by Ubuntu Technical Board</span></span><br><span class="line"><span class="comment"># on 2011-02-08 (LP: #104525). See http://www.pool.ntp.org/join.html for</span></span><br><span class="line"><span class="comment"># more information.</span></span><br><span class="line">pool 0.ubuntu.pool.ntp.org iburst</span><br><span class="line">pool 1.ubuntu.pool.ntp.org iburst</span><br><span class="line">pool 2.ubuntu.pool.ntp.org iburst</span><br><span class="line">pool 3.ubuntu.pool.ntp.org iburst</span><br><span class="line"></span><br><span class="line"><span class="comment"># Use Ubuntu&#x27;s ntp server as a fallback.</span></span><br><span class="line">pool ntp.ubuntu.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># Access control configuration; see /usr/share/doc/ntp-doc/html/accopt.html for</span></span><br><span class="line"><span class="comment"># details.  The web page &lt;http://support.ntp.org/bin/view/Support/AccessRestrictions&gt;</span></span><br><span class="line"><span class="comment"># might also be helpful.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Note that &quot;restrict&quot; applies to both servers and clients, so a configuration</span></span><br><span class="line"><span class="comment"># that might be intended to block requests from certain clients could also end</span></span><br><span class="line"><span class="comment"># up blocking replies from your own upstream servers.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># By default, exchange time with everybody, but don&#x27;t allow configuration.</span></span><br><span class="line">restrict -4 default kod notrap nomodify nopeer noquery limited</span><br><span class="line">restrict -6 default kod notrap nomodify nopeer noquery limited</span><br><span class="line"></span><br><span class="line"><span class="comment"># Local users may interrogate the ntp server more closely.</span></span><br><span class="line">restrict 127.0.0.1 </span><br><span class="line">restrict ::1 </span><br><span class="line">restrict 10.0.0.10 mask 255.255.255.0 </span><br><span class="line">server 127.127.1.0 </span><br><span class="line">fudge 127.127.1.0 stratum 8 </span><br><span class="line"></span><br><span class="line"><span class="comment"># Needed for adding pool entries</span></span><br><span class="line">restrict <span class="built_in">source</span> notrap nomodify noquery</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clients from this (example!) subnet have unlimited access, but only if</span></span><br><span class="line"><span class="comment"># cryptographically authenticated.</span></span><br><span class="line"><span class="comment">#restrict 192.168.123.0 mask 255.255.255.0 notrust</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># If you want to provide time to your local subnet, change the next line.</span></span><br><span class="line"><span class="comment"># (Again, the address is an example only.)</span></span><br><span class="line"><span class="comment">#broadcast 192.168.123.255</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># If you want to listen to time broadcasts on your local subnet, de-comment the</span></span><br><span class="line"><span class="comment"># next lines.  Please do this only if you trust everybody on the network!</span></span><br><span class="line"><span class="comment">#disable auth</span></span><br><span class="line"><span class="comment">#broadcastclient</span></span><br></pre></td></tr></table></figure><h2 id="å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡ç«¯æ—¶é—´"><a href="#å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡ç«¯æ—¶é—´" class="headerlink" title="å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡ç«¯æ—¶é—´"></a>å®¢æˆ·ç«¯åŒæ­¥æœåŠ¡ç«¯æ—¶é—´</h2><h3 id="æ–¹æ³•1"><a href="#æ–¹æ³•1" class="headerlink" title="æ–¹æ³•1"></a>æ–¹æ³•1</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨é™¤ceph1çš„æ‰€æœ‰èŠ‚ç‚¹å¼ºåˆ¶åŒæ­¥serverï¼ˆceph1ï¼‰æ—¶é—´ã€‚</span></span><br><span class="line"></span><br><span class="line">ntpdate ceph1</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨é™¤ceph1çš„æ‰€æœ‰èŠ‚ç‚¹å†™å…¥ç¡¬ä»¶æ—¶é’Ÿï¼Œé¿å…é‡å¯åå¤±æ•ˆã€‚</span></span><br><span class="line"></span><br><span class="line">hwclock -w</span><br><span class="line"></span><br><span class="line"><span class="comment"># åœ¨é™¤ceph1çš„æ‰€æœ‰èŠ‚ç‚¹å®‰è£…å¹¶å¯åŠ¨crontabå·¥å…·ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># yum install -y crontabs</span></span><br><span class="line"></span><br><span class="line">chkconfig crond on</span><br><span class="line"></span><br><span class="line">systemctl start crond</span><br><span class="line"></span><br><span class="line">crontab -e</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼Œæ¯éš”10åˆ†é’Ÿè‡ªåŠ¨ä¸ceph1åŒæ­¥æ—¶é—´ã€‚</span></span><br><span class="line"></span><br><span class="line">*/10 * * * * /usr/sbin/ntpdate 192.168.3.166</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•2"><a href="#æ–¹æ³•2" class="headerlink" title="æ–¹æ³•2"></a>æ–¹æ³•2</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨ceph2ã€ceph3åŠæ‰€æœ‰å®¢æˆ·æœºèŠ‚ç‚¹æ–°å»ºNTPæ–‡ä»¶ã€‚</span></span><br><span class="line">vi /etc/ntp.conf</span><br><span class="line"><span class="comment"># å¹¶æ–°å¢å¦‚ä¸‹å†…å®¹ä½œä¸ºå®¢æˆ·ç«¯ï¼š</span></span><br><span class="line">server 192.168.3.166</span><br><span class="line"><span class="comment"># ä¿å­˜å¹¶é€€å‡ºã€‚</span></span><br><span class="line"><span class="comment"># æ­¥éª¤2 å¯åŠ¨NTPæœåŠ¡ã€‚</span></span><br><span class="line"><span class="comment"># åœ¨ceph1èŠ‚ç‚¹å¯åŠ¨NTPæœåŠ¡ï¼Œå¹¶æ£€æŸ¥çŠ¶æ€ã€‚</span></span><br><span class="line">systemctl start ntpd</span><br><span class="line">systemctl <span class="built_in">enable</span> ntpd</span><br></pre></td></tr></table></figure><h3 id="æ‰©å±•-chrony-ntpdæœåŠ¡ç«¯é˜²ç«å¢™è®¾ç½®"><a href="#æ‰©å±•-chrony-ntpdæœåŠ¡ç«¯é˜²ç«å¢™è®¾ç½®" class="headerlink" title="æ‰©å±•-chrony/ntpdæœåŠ¡ç«¯é˜²ç«å¢™è®¾ç½®"></a>æ‰©å±•-chrony/ntpdæœåŠ¡ç«¯é˜²ç«å¢™è®¾ç½®</h3><p>chrony</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">æœåŠ¡ç«¯</span><br><span class="line">vim /etc/chrony.conf</span><br><span class="line"></span><br><span class="line">firewall-cmd â€“zone=public â€“add-port=323/udp â€“permanent</span><br><span class="line">firewall-cmd â€“zone=public â€“add-port=123/udp â€“permanent</span><br><span class="line">systemctl restart firewalld</span><br><span class="line">systemctl restart chronyd</span><br><span class="line">firewall-cmd â€“list-all</span><br><span class="line"></span><br><span class="line">firewall-cmd â€“zone=public â€“remove-port=323/udp â€“permanent</span><br><span class="line">firewall-cmd â€“zone=public â€“remove-port=123/udp â€“permanent</span><br><span class="line">systemctl restart firewalld</span><br><span class="line">systemctl restart chronyd</span><br><span class="line">firewall-cmd â€“list-all</span><br><span class="line"></span><br><span class="line">æœåŠ¡ç«¯ä¿®æ”¹åå®¢æˆ·ç«¯ä¹Ÿéœ€è¦é‡å¯ å³ä¸¤è€…éƒ½éœ€è¦é‡å¯</span><br></pre></td></tr></table></figure><p>ntp</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ufw allow 123/udp</span><br><span class="line">ufw allow 123/tcp</span><br><span class="line">ufw reload</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ—¶é—´åŒæ­¥ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¶é—´åŒæ­¥ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wslå®‰è£…edgeæµè§ˆå™¨å¹¶è®¾ç½®ä¸­æ–‡æ”¯æŒ</title>
      <link href="/2025/09/02/wsl%E5%AE%89%E8%A3%85edge%E6%B5%8F%E8%A7%88%E5%99%A8%E5%B9%B6%E8%AE%BE%E7%BD%AE%E4%B8%AD%E6%96%87%E6%94%AF%E6%8C%81/"/>
      <url>/2025/09/02/wsl%E5%AE%89%E8%A3%85edge%E6%B5%8F%E8%A7%88%E5%99%A8%E5%B9%B6%E8%AE%BE%E7%BD%AE%E4%B8%AD%E6%96%87%E6%94%AF%E6%8C%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="wslå®‰è£…edgeæµè§ˆå™¨å¹¶è®¾ç½®ä¸­æ–‡æ”¯æŒ"><a href="#wslå®‰è£…edgeæµè§ˆå™¨å¹¶è®¾ç½®ä¸­æ–‡æ”¯æŒ" class="headerlink" title="wslå®‰è£…edgeæµè§ˆå™¨å¹¶è®¾ç½®ä¸­æ–‡æ”¯æŒ"></a>wslå®‰è£…edgeæµè§ˆå™¨å¹¶è®¾ç½®ä¸­æ–‡æ”¯æŒ</h2><p>debåŒ…ä¸‹è½½è·¯å¾„:<a href="https://packages.microsoft.com/repos/edge/pool/main/m/microsoft-edge-stable/microsoft-edge-stable_139.0.3405.125-1_amd64.deb?brand=M102">https://packages.microsoft.com/repos/edge/pool/main/m/microsoft-edge-stable/microsoft-edge-stable_139.0.3405.125-1_amd64.deb?brand=M102</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…edge</span></span><br><span class="line">sudo apt --fix-broken install || apt install -y </span><br><span class="line">dpkg -i  microsoft-edge-stable_139.0.3405.125-1_amd64.deb</span><br><span class="line"><span class="comment"># å¯åŠ¨edgeï¼ˆéœ€è¦åœ¨æ™®é€šç”¨æˆ·ä¸‹è¿è¡Œï¼‰</span></span><br><span class="line">microsoft-edge</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸­æ–‡æ”¯æŒ</span></span><br><span class="line">sudo apt install fonts-noto-cjk fonts-noto-cjk-extra</span><br><span class="line">sudo apt install language-pack-zh-hans  <span class="comment"># ç®€ä½“ä¸­æ–‡</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¥éª¤1ï¼šå°†ä¸­æ–‡è®¾ä¸ºé»˜è®¤è¯­è¨€æ‰“å¼€ Edgeï¼Œåœ¨åœ°å€æ è¾“å…¥ï¼š</span></span><br><span class="line">edge://settings/languages</span><br><span class="line"><span class="comment"># æ£€æŸ¥å·²å®‰è£…çš„ä¸­æ–‡å­—ä½“</span></span><br><span class="line">fc-list :lang=zh</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»ˆç«¯è¾“å…¥</span></span><br><span class="line">fc-list :lang=zh</span><br><span class="line">å¦‚æœè¾“å‡ºåŒ…å« Noto Sans CJK æˆ– Microsoft YaHeiï¼Œè¯´æ˜å­—ä½“å·²ç”Ÿæ•ˆã€‚</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯å®¿ä¸»æœº å†æ¬¡è¿è¡Œedgeæ­¤æ—¶å·²ç»æ”¯æŒä¸­æ–‡</span></span><br><span class="line">microsoft-edge</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ„å»ºdockeré•œåƒ"><a href="#æ„å»ºdockeré•œåƒ" class="headerlink" title="æ„å»ºdockeré•œåƒ"></a>æ„å»ºdockeré•œåƒ</h3><p>å·²æ„å»ºé•œåƒ: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:edge</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">FROM</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/ubuntu:20.04</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®éäº¤äº’æ¨¡å¼</span></span><br><span class="line"><span class="string">ENV</span> <span class="string">DEBIAN_FRONTEND=noninteractive</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…ä¾èµ–ï¼ˆåŒ…æ‹¬ GUI/å¤šåª’ä½“åº“ï¼ŒEdge å¿…é¡»è¦çš„ï¼‰</span></span><br><span class="line"><span class="string">RUN</span> <span class="string">apt</span> <span class="string">update</span> <span class="string">&amp;&amp;</span> <span class="string">apt</span> <span class="string">install</span> <span class="string">-y</span> <span class="string">\</span></span><br><span class="line">    <span class="string">tzdata</span> <span class="string">\</span></span><br><span class="line">    <span class="string">wget</span> <span class="string">\</span></span><br><span class="line">    <span class="string">xdg-utils</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libx11-xcb1</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libxtst6</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libnss3</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libasound2</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libatk1.0-0</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libatk-bridge2.0-0</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libgtk-3-0</span> <span class="string">\</span></span><br><span class="line">    <span class="string">fonts-liberation</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libdrm2</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libgbm1</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libxcb-dri3-0</span> <span class="string">\</span></span><br><span class="line">    <span class="string">libxshmfence1</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">ln</span> <span class="string">-fs</span> <span class="string">/usr/share/zoneinfo/UTC</span> <span class="string">/etc/localtime</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">dpkg-reconfigure</span> <span class="string">--frontend</span> <span class="string">noninteractive</span> <span class="string">tzdata</span> <span class="string">\</span></span><br><span class="line">    <span class="string">&amp;&amp;</span> <span class="string">rm</span> <span class="string">-rf</span> <span class="string">/var/lib/apt/lists/*</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨è‡ªå®šä¹‰æºï¼ˆå¦‚éœ€ï¼‰</span></span><br><span class="line"><span class="string">COPY</span> <span class="string">sources.list</span> <span class="string">/etc/apt/sources.list</span></span><br><span class="line"><span class="string">RUN</span> <span class="string">apt</span> <span class="string">update</span></span><br><span class="line"><span class="string">RUN</span> <span class="string">apt</span> <span class="string">install</span> <span class="string">fonts-noto-cjk</span> <span class="string">fonts-noto-cjk-extra</span></span><br><span class="line"><span class="comment"># å¤åˆ¶ Edge å®‰è£…åŒ…</span></span><br><span class="line"><span class="string">COPY</span> <span class="string">./microsoft-edge-stable_139.0.3405.125-1_amd64.deb</span> <span class="string">/opt/</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£… Edge</span></span><br><span class="line"><span class="string">RUN</span> <span class="string">apt</span> <span class="string">install</span> <span class="string">-f</span> <span class="string">-y</span> <span class="string">&amp;&amp;</span> <span class="string">\</span></span><br><span class="line">    <span class="string">apt</span> <span class="string">--fix-broken</span> <span class="string">install</span> <span class="string">-y</span> <span class="string">&amp;&amp;</span> <span class="string">\</span></span><br><span class="line">    <span class="string">apt</span> <span class="string">install</span> <span class="string">-y</span> <span class="string">/opt/microsoft-edge-stable_139.0.3405.125-1_amd64.deb</span> <span class="string">&amp;&amp;</span> <span class="string">\</span></span><br><span class="line">    <span class="string">rm</span> <span class="string">-rf</span> <span class="string">/var/lib/apt/lists/*</span> <span class="string">/opt/*.deb</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé root ç”¨æˆ·</span></span><br><span class="line"><span class="string">RUN</span> <span class="string">groupadd</span> <span class="string">-r</span> <span class="string">appuser</span> <span class="string">&amp;&amp;</span> <span class="string">\</span></span><br><span class="line">    <span class="string">useradd</span> <span class="string">-r</span> <span class="string">-g</span> <span class="string">appuser</span> <span class="string">-d</span> <span class="string">/home/appuser</span> <span class="string">-s</span> <span class="string">/bin/bash</span> <span class="string">appuser</span> <span class="string">&amp;&amp;</span> <span class="string">\</span></span><br><span class="line">    <span class="string">mkdir</span> <span class="string">-p</span> <span class="string">/home/appuser</span> <span class="string">&amp;&amp;</span> <span class="string">\</span></span><br><span class="line">    <span class="string">chown</span> <span class="string">-R</span> <span class="string">appuser:appuser</span> <span class="string">/home/appuser</span></span><br><span class="line"></span><br><span class="line"><span class="string">WORKDIR</span> <span class="string">/app</span></span><br><span class="line"><span class="string">RUN</span> <span class="string">chown</span> <span class="string">-R</span> <span class="string">appuser:appuser</span> <span class="string">/app</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ‡æ¢ç”¨æˆ·</span></span><br><span class="line"><span class="string">USER</span> <span class="string">appuser</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨ Edgeï¼Œç¦ç”¨ sandbox &amp; crashpadï¼Œé¿å… /dev/shm é—®é¢˜</span></span><br><span class="line"><span class="string">CMD</span> [<span class="string">&quot;microsoft-edge&quot;</span>, <span class="string">&quot;--no-sandbox&quot;</span>, <span class="string">&quot;--disable-dev-shm-usage&quot;</span>, <span class="string">&quot;--disable-crash-reporter&quot;</span>]</span><br></pre></td></tr></table></figure><p>æ„å»º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -f Dockerfile -t zznn/edge .</span><br></pre></td></tr></table></figure><p>è¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">xhost +<span class="built_in">local</span>:</span><br><span class="line">docker run -it   -e DISPLAY=<span class="variable">$DISPLAY</span>   -v /tmp/.X11-unix:/tmp/.X11-unix   zznn/edge:latest</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç°æˆçš„é•œåƒè¿è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -it   -e DISPLAY=<span class="variable">$DISPLAY</span>   -v /tmp/.X11-unix:/tmp/.X11-unix   registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:edge </span><br></pre></td></tr></table></figure><h2 id="å¿«æ·æ–¹å¼-ä¿å­˜ä¸º-batåç¼€å³å¯windowsæ¡Œé¢ä½¿ç”¨"><a href="#å¿«æ·æ–¹å¼-ä¿å­˜ä¸º-batåç¼€å³å¯windowsæ¡Œé¢ä½¿ç”¨" class="headerlink" title="å¿«æ·æ–¹å¼(ä¿å­˜ä¸º.batåç¼€å³å¯windowsæ¡Œé¢ä½¿ç”¨)"></a>å¿«æ·æ–¹å¼(ä¿å­˜ä¸º.batåç¼€å³å¯windowsæ¡Œé¢ä½¿ç”¨)</h2><h3 id="dockerç‰ˆæœ¬æ¡Œé¢å¿«æ·æ–¹å¼"><a href="#dockerç‰ˆæœ¬æ¡Œé¢å¿«æ·æ–¹å¼" class="headerlink" title="dockerç‰ˆæœ¬æ¡Œé¢å¿«æ·æ–¹å¼"></a>dockerç‰ˆæœ¬æ¡Œé¢å¿«æ·æ–¹å¼</h3><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="keyword">if</span> &quot;%<span class="number">1</span>&quot;==&quot;h&quot; <span class="keyword">goto</span> begin</span><br><span class="line"><span class="built_in">start</span> mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;&quot;&quot;%~nx0&quot;&quot; h&quot;,<span class="number">0</span>)(window.close)&amp;&amp;<span class="keyword">exit</span></span><br><span class="line">:begin</span><br><span class="line"></span><br><span class="line">wsl -d Ubuntu-<span class="number">20</span>.<span class="number">04</span> -- bash -c &quot;docker run --rm   -e DISPLAY=$DISPLAY   -v /tmp/.X11-unix:/tmp/.X11-unix   registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:edge&quot;</span><br></pre></td></tr></table></figure><h3 id="äºŒè¿›åˆ¶æ–¹å¼å¿«æ·æ–¹å¼bat"><a href="#äºŒè¿›åˆ¶æ–¹å¼å¿«æ·æ–¹å¼bat" class="headerlink" title="äºŒè¿›åˆ¶æ–¹å¼å¿«æ·æ–¹å¼bat"></a>äºŒè¿›åˆ¶æ–¹å¼å¿«æ·æ–¹å¼bat</h3><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="keyword">if</span> &quot;%<span class="number">1</span>&quot;==&quot;h&quot; <span class="keyword">goto</span> begin</span><br><span class="line"><span class="built_in">start</span> mshta vbscript:createobject(&quot;wscript.shell&quot;).run(&quot;&quot;&quot;%~nx0&quot;&quot; h&quot;,<span class="number">0</span>)(window.close)&amp;&amp;<span class="keyword">exit</span></span><br><span class="line">:begin</span><br><span class="line"></span><br><span class="line">wsl -d Ubuntu-<span class="number">20</span>.<span class="number">04</span> -- bash -c &quot;microsoft-edge&quot;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> wsl </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wsl </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8sé¢è¯•é¢˜æ€»ç»“</title>
      <link href="/2025/08/19/k8s%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/"/>
      <url>/2025/08/19/k8s%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="k8sé¢è¯•é¢˜æ€»ç»“"><a href="#k8sé¢è¯•é¢˜æ€»ç»“" class="headerlink" title="k8sé¢è¯•é¢˜æ€»ç»“"></a>k8sé¢è¯•é¢˜æ€»ç»“</h1><h2 id="ä¸€ã€ç½‘ç»œæ’ä»¶-calico-çš„å·¥ä½œæ¨¡å¼æœ‰å“ªå‡ ç§"><a href="#ä¸€ã€ç½‘ç»œæ’ä»¶-calico-çš„å·¥ä½œæ¨¡å¼æœ‰å“ªå‡ ç§" class="headerlink" title="ä¸€ã€ç½‘ç»œæ’ä»¶ calico çš„å·¥ä½œæ¨¡å¼æœ‰å“ªå‡ ç§"></a>ä¸€ã€ç½‘ç»œæ’ä»¶ calico çš„å·¥ä½œæ¨¡å¼æœ‰å“ªå‡ ç§</h2><p><strong>Calico åœ¨ Kubernetes  ä¸­çš„å·¥ä½œæ¨¡å¼ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç§ï¼Œä½ åœ¨éƒ¨ç½²æ—¶å¯ä»¥æ ¹æ®é›†ç¾¤ç¯å¢ƒã€éœ€æ±‚å’Œåº•å±‚ç½‘ç»œé€‰æ‹©ä¸åŒæ¨¡å¼ï¼š</strong></p><h3 id="1-BGP-æ¨¡å¼"><a href="#1-BGP-æ¨¡å¼" class="headerlink" title="1. BGP æ¨¡å¼"></a>1. <strong>BGP æ¨¡å¼</strong></h3><ul><li><strong>åŸç†</strong>ï¼šæ¯ä¸ªèŠ‚ç‚¹è¿è¡Œ <code>calico/node</code>ï¼ŒèŠ‚ç‚¹ä¹‹é—´é€šè¿‡ <strong>BGPï¼ˆBorder Gateway Protocolï¼‰</strong> äº¤æ¢è·¯ç”±ä¿¡æ¯ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li><strong>Pod IP åœ¨æ•´ä¸ªé›†ç¾¤ä¸­æ˜¯å¯è·¯ç”±çš„ï¼Œä¸éœ€è¦ NATã€‚</strong></li><li><strong>ä¸ä¾èµ– Overlayï¼ˆéš§é“ï¼‰ï¼Œæ€§èƒ½å¥½ï¼Œå»¶è¿Ÿä½ã€‚</strong></li><li><strong>å¸¸è§æœ‰ä¸¤ç§æ‹“æ‰‘ï¼š</strong><ul><li><strong>Full-mesh BGP</strong>ï¼šæ‰€æœ‰èŠ‚ç‚¹äº’ç›¸å»ºç«‹ BGP å¯¹ç­‰å…³ç³»ï¼Œé€‚åˆå°è§„æ¨¡é›†ç¾¤ï¼ˆå‡ åä¸ªèŠ‚ç‚¹ï¼‰ã€‚</li><li><strong>Route Reflector æ¨¡å¼</strong>ï¼šå¤§è§„æ¨¡é›†ç¾¤æ—¶ï¼Œç”¨ä¸€éƒ¨åˆ†èŠ‚ç‚¹åš BGP Route Reflector æ¥å‡å°‘å¯¹ç­‰è¿æ¥æ•°ã€‚</li></ul></li></ul></li></ul><h3 id="2-IP-in-IP-æ¨¡å¼"><a href="#2-IP-in-IP-æ¨¡å¼" class="headerlink" title="2. IP-in-IP æ¨¡å¼"></a>2. <strong>IP-in-IP æ¨¡å¼</strong></h3><ul><li><strong>åŸç†</strong>ï¼šåœ¨èŠ‚ç‚¹ä¹‹é—´ä½¿ç”¨ IP-in-IP å°è£…ï¼ˆç±»ä¼¼ Overlay ç½‘ç»œï¼‰ï¼Œè§£å†³èŠ‚ç‚¹ä¹‹é—´è·¯ç”±ä¸å¯è¾¾çš„é—®é¢˜ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li><strong>é€‚åˆæ²¡æœ‰é…ç½® BGP æˆ–åº•å±‚ç½‘ç»œä¸æ”¯æŒ Pod CIDR ç›´é€šçš„ç¯å¢ƒã€‚</strong></li><li><strong>æ•°æ®åŒ…ç»è¿‡ä¸€æ¬¡å°è£…ï¼Œæ€§èƒ½æ¯” BGP æ¨¡å¼ç¨å·®ã€‚</strong></li><li><strong>é»˜è®¤æ¨¡å¼ä¹‹ä¸€ï¼Œéƒ¨ç½²ç®€å•ã€‚</strong></li></ul></li></ul><h3 id="3-VXLAN-æ¨¡å¼"><a href="#3-VXLAN-æ¨¡å¼" class="headerlink" title="3. VXLAN æ¨¡å¼"></a>3. <strong>VXLAN æ¨¡å¼</strong></h3><ul><li><strong>åŸç†</strong>ï¼šå’Œ IP-in-IP ç±»ä¼¼ï¼Œä½†ä½¿ç”¨ VXLAN å°è£…ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li><strong>é€šå¸¸åœ¨äº‘ç¯å¢ƒæˆ–åº•å±‚ç½‘ç»œå—é™æ—¶ä½¿ç”¨ã€‚</strong></li><li><strong>VXLAN éš§é“æ›´é€šç”¨ï¼ˆå¤§å¤šæ•°äº‘å‚å•†éƒ½æ”¯æŒï¼‰ï¼Œå…¼å®¹æ€§å¼ºã€‚</strong></li><li><strong>æ€§èƒ½æ¯”çº¯ä¸‰å±‚ï¼ˆBGP æ¨¡å¼ï¼‰å·®ä¸€äº›ã€‚</strong></li></ul></li></ul><h3 id="4-CrossSubnet-æ¨¡å¼"><a href="#4-CrossSubnet-æ¨¡å¼" class="headerlink" title="4. CrossSubnet æ¨¡å¼"></a>4. <strong>CrossSubnet æ¨¡å¼</strong></h3><ul><li><strong>åŸç†</strong>ï¼šç»“åˆ BGP å’Œéš§é“ï¼ˆIP-in-IP æˆ– VXLANï¼‰ã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li><strong>åŒä¸€å­ç½‘å†…èŠ‚ç‚¹ä¹‹é—´ç›´æ¥è·¯ç”±ï¼Œä¸èµ°éš§é“ã€‚</strong></li><li><strong>è·¨å­ç½‘èŠ‚ç‚¹ä¹‹é—´æ‰ä½¿ç”¨éš§é“å°è£…ã€‚</strong></li><li><strong>åœ¨æ€§èƒ½å’Œå…¼å®¹æ€§ä¹‹é—´åšå¹³è¡¡ã€‚</strong></li></ul></li></ul><h3 id="5-Policy-only-æ¨¡å¼"><a href="#5-Policy-only-æ¨¡å¼" class="headerlink" title="5. Policy-only æ¨¡å¼"></a>5. <strong>Policy-only æ¨¡å¼</strong></h3><ul><li><strong>åŸç†</strong>ï¼šåªä½¿ç”¨ Calico çš„ <strong>ç½‘ç»œç­–ç•¥ï¼ˆNetworkPolicyï¼‰</strong> åŠŸèƒ½ï¼Œä¸è´Ÿè´£ Pod çš„ç½‘ç»œäº’é€šã€‚</li><li><strong>ç‰¹ç‚¹</strong>ï¼š<ul><li><strong>ä¾èµ– CNI æä¾›ç½‘ç»œï¼ˆæ¯”å¦‚ Flannelã€Ciliumã€AWS VPC CNIï¼‰ï¼ŒCalico ä»…ä½œä¸ºç­–ç•¥æ§åˆ¶å™¨ã€‚</strong></li><li><strong>é€‚åˆåªæƒ³ç”¨ Calico å¼ºå¤§çš„å®‰å…¨ç­–ç•¥åŠŸèƒ½çš„åœºæ™¯ã€‚</strong></li></ul></li></ul><p>æ€»ç»“ä¸€ä¸‹å¸¸è§é€‰æ‹©ï¼š</p><ul><li><strong>é«˜æ€§èƒ½è£¸æœº/è‡ªå»ºæ•°æ®ä¸­å¿ƒ</strong> â†’ BGP æ¨¡å¼ï¼ˆå¤§è§„æ¨¡ç”¨ Route Reflectorï¼‰ã€‚</li><li><strong>äº‘ç¯å¢ƒ / æ— æ³•ç›´é€šè·¯ç”±</strong> â†’ VXLAN æˆ– IP-in-IP æ¨¡å¼ã€‚</li><li><strong>æ··åˆç¯å¢ƒ</strong> â†’ CrossSubnetã€‚</li><li><strong>åªè¦ç­–ç•¥ï¼Œä¸è¦ç½‘ç»œ</strong> â†’ Policy-onlyã€‚</li></ul><p><strong>è¿™æ˜¯ Calico å„ç§å·¥ä½œæ¨¡å¼çš„å¯¹æ¯”å›¾ï¼ˆæ€§èƒ½ã€å…¼å®¹æ€§ã€å®‰å…¨æ€§ è¯„åˆ† 1~5ï¼‰ï¼š</strong></p><ul><li><strong>BGP</strong>ï¼šæ€§èƒ½æœ€ä½³ï¼Œä½†å…¼å®¹æ€§å–å†³äºåº•å±‚ç½‘ç»œæ˜¯å¦æ”¯æŒã€‚</li><li><strong>IP-in-IP / VXLAN</strong>ï¼šå…¼å®¹æ€§å¼ºï¼Œé€‚åˆäº‘ç¯å¢ƒï¼Œä½†æ€§èƒ½æ¯”ç›´è¿ç¨å·®ã€‚</li><li><strong>CrossSubnet</strong>ï¼šæ€§èƒ½å’Œå…¼å®¹æ€§æŠ˜ä¸­ã€‚</li><li><strong>Policy-only</strong>ï¼šä¾èµ–å…¶ä»– CNI æä¾›ç½‘ç»œï¼Œå®‰å…¨ç­–ç•¥åŠŸèƒ½æœ€å¼ºã€‚</li></ul><h2 id="äºŒã€cgroup-å’Œ-ns-çš„åŒºåˆ«"><a href="#äºŒã€cgroup-å’Œ-ns-çš„åŒºåˆ«" class="headerlink" title="äºŒã€cgroup å’Œ ns çš„åŒºåˆ«"></a>äºŒã€cgroup å’Œ ns çš„åŒºåˆ«</h2><p>**åœ¨ **<strong>Linux å®¹å™¨æŠ€æœ¯</strong>é‡Œï¼Œ<code>cgroup</code>ï¼ˆcontrol groupï¼‰å’Œ <code>namespace</code>ï¼ˆå‘½åç©ºé—´ï¼‰æ˜¯ä¸¤å¤§æ ¸å¿ƒæ¦‚å¿µï¼Œå®ƒä»¬è§£å†³çš„é—®é¢˜å®Œå…¨ä¸åŒï¼Œä½†åˆç»å¸¸é…åˆä½¿ç”¨ã€‚</p><h3 id="1-cgroupï¼ˆæ§åˆ¶ç»„ï¼‰"><a href="#1-cgroupï¼ˆæ§åˆ¶ç»„ï¼‰" class="headerlink" title="1. cgroupï¼ˆæ§åˆ¶ç»„ï¼‰"></a>1. <strong>cgroupï¼ˆæ§åˆ¶ç»„ï¼‰</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šé™åˆ¶å’Œç®¡ç†è¿›ç¨‹å¯ä»¥ä½¿ç”¨çš„èµ„æºã€‚</li><li><strong>æ ¸å¿ƒç‚¹</strong>ï¼šèµ„æºéš”ç¦» + é™é¢æ§åˆ¶ã€‚</li><li><strong>å¸¸è§æ§åˆ¶çš„èµ„æº</strong>ï¼š<ul><li><strong>CPUï¼ˆé™åˆ¶æŸä¸ªè¿›ç¨‹ç»„æœ€å¤šä½¿ç”¨å¤šå°‘ CPU æ—¶é—´ï¼‰</strong></li><li><strong>å†…å­˜ï¼ˆé™åˆ¶æœ€å¤§å†…å­˜ä½¿ç”¨ï¼Œè¶…è¿‡æ—¶ OOM Killï¼‰</strong></li><li><strong>ç£ç›˜ I/Oï¼ˆé™åˆ¶è¯»å†™å¸¦å®½ï¼‰</strong></li><li><strong>ç½‘ç»œå¸¦å®½ï¼ˆåœ¨æŸäº›æ‰©å±•é‡Œæ”¯æŒï¼‰</strong></li></ul></li><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<ul><li><strong>Docker é™åˆ¶å®¹å™¨ CPUã€å†…å­˜ç”¨é‡</strong></li><li><strong>Kubernetes Pod èµ„æºè¯·æ±‚/é™åˆ¶ï¼ˆrequests/limitsï¼‰</strong></li></ul></li><li>ç±»æ¯”ï¼šåƒç»™è¿›ç¨‹â€œé…é¢â€ï¼Œè§„å®šå®ƒèƒ½åƒå¤šå°‘é¥­ã€å–å¤šå°‘æ°´ã€‚</li></ul><h3 id="2-namespaceï¼ˆå‘½åç©ºé—´ï¼‰"><a href="#2-namespaceï¼ˆå‘½åç©ºé—´ï¼‰" class="headerlink" title="2. namespaceï¼ˆå‘½åç©ºé—´ï¼‰"></a>2. <strong>namespaceï¼ˆå‘½åç©ºé—´ï¼‰</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šæä¾›è¿›ç¨‹é—´çš„éš”ç¦»ç¯å¢ƒã€‚</li><li><strong>æ ¸å¿ƒç‚¹</strong>ï¼šè§†å›¾éš”ç¦» + èµ„æºè™šæ‹ŸåŒ–ã€‚</li><li><strong>å¸¸è§ç±»å‹</strong>ï¼š<ul><li><strong>PID namespace</strong>ï¼šè¿›ç¨‹å·éš”ç¦»ï¼ˆå®¹å™¨é‡Œçš„ PID 1 ä¸ä¼šçœ‹åˆ°å®¿ä¸»æœº PIDï¼‰</li><li><strong>NET namespace</strong>ï¼šç½‘ç»œéš”ç¦»ï¼ˆå®¹å™¨æœ‰ç‹¬ç«‹ç½‘å¡ã€IPã€è·¯ç”±ï¼‰</li><li><strong>IPC namespace</strong>ï¼šè¿›ç¨‹é—´é€šä¿¡éš”ç¦»ï¼ˆæ¶ˆæ¯é˜Ÿåˆ—ã€ä¿¡å·é‡ï¼‰</li><li><strong>UTS namespace</strong>ï¼šä¸»æœºåéš”ç¦»ï¼ˆå®¹å™¨å¯æœ‰ä¸åŒ hostnameï¼‰</li><li><strong>MNT namespace</strong>ï¼šæŒ‚è½½ç‚¹éš”ç¦»ï¼ˆä¸åŒæ–‡ä»¶ç³»ç»Ÿè§†å›¾ï¼‰</li><li><strong>USER namespace</strong>ï¼šç”¨æˆ·å’Œæƒé™éš”ç¦»ï¼ˆå®¹å™¨é‡Œ root æ˜ å°„åˆ°å®¿ä¸»æœºæ™®é€šç”¨æˆ·ï¼‰</li></ul></li><li><strong>ä½¿ç”¨åœºæ™¯</strong>ï¼š<ul><li><strong>è®©å®¹å™¨æ‹¥æœ‰ç‹¬ç«‹çš„æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹æ ‘ã€ç½‘ç»œæ ˆ</strong></li></ul></li><li>ç±»æ¯”ï¼šåƒç»™è¿›ç¨‹æˆ´ä¸Šâ€œVR çœ¼é•œâ€ï¼Œå®ƒåªèƒ½çœ‹åˆ°è‡ªå·±è™šæ‹Ÿå‡ºæ¥çš„ä¸–ç•Œã€‚</li></ul><h2 id="ä¸‰ã€ns-éš”ç¦»èµ„æºçš„åŸç†"><a href="#ä¸‰ã€ns-éš”ç¦»èµ„æºçš„åŸç†" class="headerlink" title="ä¸‰ã€ns éš”ç¦»èµ„æºçš„åŸç†"></a>ä¸‰ã€ns éš”ç¦»èµ„æºçš„åŸç†</h2><p>**è¦ç†è§£ **<strong>namespaceï¼ˆå‘½åç©ºé—´ï¼‰æ˜¯å¦‚ä½•å®ç°éš”ç¦»çš„</strong>ï¼Œå¾—ä» <strong>Linux å†…æ ¸çš„è®¾è®¡åŸç†</strong> è¯´èµ·ã€‚</p><h3 id="1-åŸºç¡€æ¦‚å¿µ"><a href="#1-åŸºç¡€æ¦‚å¿µ" class="headerlink" title="1. åŸºç¡€æ¦‚å¿µ"></a>1. åŸºç¡€æ¦‚å¿µ</h3><p><strong>åœ¨ Linux å†…æ ¸é‡Œï¼Œ****ä¸€åˆ‡éƒ½æ˜¯å…¨å±€çš„</strong>ï¼š</p><ul><li>**é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è¿›ç¨‹å…±äº«åŒä¸€å¥— **<strong>è¿›ç¨‹å·è¡¨ã€ç½‘ç»œåè®®æ ˆã€æŒ‚è½½ç‚¹è¡¨ã€ä¸»æœºåã€IPC èµ„æº</strong>ã€‚</li><li><strong>å¦‚æœæ²¡æœ‰ç‰¹æ®Šæœºåˆ¶ï¼Œæ‰€æœ‰è¿›ç¨‹çœ‹åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ªâ€œç³»ç»Ÿâ€ã€‚</strong></li></ul><p><strong>Namespace çš„ä½œç”¨</strong>ï¼šå°±æ˜¯åœ¨å†…æ ¸ä¸­åˆ›å»ºå¤šä¸ªâ€œè™šæ‹Ÿå‰¯æœ¬â€ï¼Œè®©è¿›ç¨‹åªèƒ½è®¿é—®è‡ªå·±é‚£ä»½å‰¯æœ¬ï¼Œä»è€Œå®ç°éš”ç¦»ã€‚</p><h3 id="2-å·¥ä½œåŸç†"><a href="#2-å·¥ä½œåŸç†" class="headerlink" title="2. å·¥ä½œåŸç†"></a>2. å·¥ä½œåŸç†</h3><h4 id="ï¼ˆ1ï¼‰å†…æ ¸æ•°æ®ç»“æ„â€œè™šæ‹ŸåŒ–â€"><a href="#ï¼ˆ1ï¼‰å†…æ ¸æ•°æ®ç»“æ„â€œè™šæ‹ŸåŒ–â€" class="headerlink" title="ï¼ˆ1ï¼‰å†…æ ¸æ•°æ®ç»“æ„â€œè™šæ‹ŸåŒ–â€"></a>ï¼ˆ1ï¼‰å†…æ ¸æ•°æ®ç»“æ„â€œè™šæ‹ŸåŒ–â€</h4><ul><li>**å†…æ ¸ä¼šä¸ºæŸäº›å…¨å±€èµ„æºï¼Œè®¾è®¡ä¸€å±‚ **<strong>namespace æŠ½è±¡å±‚</strong>ã€‚</li><li><strong>å½“æ–°å»ºä¸€ä¸ª namespace æ—¶ï¼Œå†…æ ¸ä¼šç”Ÿæˆè¯¥èµ„æºçš„â€œç‹¬ç«‹å‰¯æœ¬â€ã€‚</strong></li><li>**ä¸åŒ namespace ä¸‹çš„è¿›ç¨‹ï¼ŒæŒ‡å‘çš„æ˜¯ **<strong>ä¸åŒçš„å†…æ ¸å¯¹è±¡</strong>ã€‚</li></ul><p><strong>ä¾‹å¦‚ï¼š</strong></p><ul><li><strong>PID namespace</strong>ï¼šæ¯ä¸ª namespace éƒ½æœ‰ç‹¬ç«‹çš„ PID æ˜ å°„è¡¨ã€‚å®¹å™¨é‡Œçš„ PID 1ï¼Œå…¶å®åœ¨å®¿ä¸»æœºå¯èƒ½æ˜¯ 2345ã€‚</li><li><strong>NET namespace</strong>ï¼šæ¯ä¸ª namespace æœ‰è‡ªå·±çš„ç½‘å¡ã€è·¯ç”±è¡¨ã€iptables è§„åˆ™ã€‚å®¹å™¨ä¹‹é—´ç½‘ç»œäº’ä¸å½±å“ã€‚</li><li><strong>MNT namespace</strong>ï¼šæŒ‚è½½ç‚¹è¡¨è¢«éš”ç¦»ï¼Œä¸åŒå®¹å™¨çœ‹åˆ°çš„æ–‡ä»¶ç³»ç»Ÿå±‚æ¬¡ä¸åŒã€‚</li></ul><h4 id="ï¼ˆ2ï¼‰è¿›ç¨‹ä¸-namespace-çš„ç»‘å®š"><a href="#ï¼ˆ2ï¼‰è¿›ç¨‹ä¸-namespace-çš„ç»‘å®š" class="headerlink" title="ï¼ˆ2ï¼‰è¿›ç¨‹ä¸ namespace çš„ç»‘å®š"></a>ï¼ˆ2ï¼‰è¿›ç¨‹ä¸ namespace çš„ç»‘å®š</h4><ul><li>**æ¯ä¸ªè¿›ç¨‹åœ¨å†…æ ¸ä¸­éƒ½æœ‰ä¸€ä¸ª **<code>task_struct</code> ç»“æ„ä½“ã€‚</li><li>**é‡Œé¢åŒ…å«æŒ‡é’ˆï¼ŒæŒ‡å‘è¯¥è¿›ç¨‹æ‰€å±çš„ **<strong>namespace å¯¹è±¡</strong>ï¼ˆpid_nsã€net_nsã€mnt_nsâ€¦ï¼‰ã€‚</li><li>**æ‰€ä»¥ **<strong>åŒä¸€å®¿ä¸»æœºä¸Šçš„è¿›ç¨‹ï¼Œå¯ä»¥å±äºä¸åŒçš„ namespace</strong>ã€‚</li></ul><h4 id="ï¼ˆ3ï¼‰ç³»ç»Ÿè°ƒç”¨æ”¯æŒ"><a href="#ï¼ˆ3ï¼‰ç³»ç»Ÿè°ƒç”¨æ”¯æŒ" class="headerlink" title="ï¼ˆ3ï¼‰ç³»ç»Ÿè°ƒç”¨æ”¯æŒ"></a>ï¼ˆ3ï¼‰ç³»ç»Ÿè°ƒç”¨æ”¯æŒ</h4><ul><li>**Linux æä¾›äº† **<code>clone()</code>ã€<code>unshare()</code>ã€<code>setns()</code> ç­‰ç³»ç»Ÿè°ƒç”¨ï¼Œç”¨æ¥åˆ›å»ºæˆ–åˆ‡æ¢ namespaceã€‚</li><li><strong>å®¹å™¨è¿è¡Œæ—¶ï¼ˆDockerã€containerdã€K8sï¼‰å¯åŠ¨å®¹å™¨æ—¶ï¼Œä¼šè°ƒç”¨è¿™äº› APIï¼š</strong><ul><li><code>clone(CLONE_NEWNET)</code> â†’ åˆ›å»ºæ–°çš„ç½‘ç»œæ ˆ</li><li><code>clone(CLONE_NEWPID)</code> â†’ åˆ›å»ºæ–°çš„ PID ç©ºé—´</li><li><code>clone(CLONE_NEWNS)</code> â†’ åˆ›å»ºæ–°çš„æŒ‚è½½ç©ºé—´</li></ul></li></ul><h3 id="3-ç±»æ¯”ç†è§£"><a href="#3-ç±»æ¯”ç†è§£" class="headerlink" title="3. ç±»æ¯”ç†è§£"></a>3. ç±»æ¯”ç†è§£</h3><ul><li><strong>namespace</strong> å°±åƒä¸€ä¸ª <strong>éš”æ¿</strong>ï¼ŒæŠŠåŸæœ¬å…¨å±€å…±äº«çš„å¤§ç©ºé—´åˆ†éš”æˆå¤šä¸ªå°æˆ¿é—´ï¼Œæ¯ä¸ªè¿›ç¨‹åªèƒ½åœ¨è‡ªå·±çš„æˆ¿é—´é‡Œæ´»åŠ¨ã€‚</li><li><strong>è¿›ç¨‹çœ‹ä¸åˆ°æˆ¿é—´å¤–çš„ä¸œè¥¿</strong>ï¼Œæ‰€ä»¥å®ƒâ€œä»¥ä¸ºâ€è‡ªå·±ç‹¬å äº†ç³»ç»Ÿã€‚</li></ul><h3 id="ğŸ”¹-æ€»ç»“"><a href="#ğŸ”¹-æ€»ç»“" class="headerlink" title="ğŸ”¹ æ€»ç»“"></a>ğŸ”¹ æ€»ç»“</h3><ul><li><strong>åŸç†</strong>ï¼šnamespace é€šè¿‡å†…æ ¸æŠ½è±¡å±‚ï¼ŒæŠŠå…¨å±€èµ„æºå¤åˆ¶/è™šæ‹ŸåŒ–æˆå¤šä¸ªå®ä¾‹ï¼Œæ¯ä¸ªè¿›ç¨‹åªç»‘å®šåˆ°è‡ªå·±çš„å®ä¾‹ã€‚</li><li><strong>å…³é”®ç‚¹</strong>ï¼š<ul><li><strong>æ•°æ®ç»“æ„éš”ç¦»ï¼ˆä¸åŒ namespaceï¼Œèµ„æºè¡¨ä¸åŒï¼‰</strong></li><li><strong>è¿›ç¨‹ä¸ namespace ç»‘å®šï¼ˆtask_struct è®°å½•æ‰€å± nsï¼‰</strong></li><li><strong>ç³»ç»Ÿè°ƒç”¨æ”¯æŒï¼ˆclone/unshare/setns ç®¡ç† ns ç”Ÿå‘½å‘¨æœŸï¼‰</strong></li></ul></li></ul><hr><p>**âš¡ **ä¸€å¥è¯ï¼šnamespace é€šè¿‡åœ¨å†…æ ¸ä¸­ä¸ºå…¨å±€èµ„æºå»ºç«‹å¤šä¸ªå‰¯æœ¬ + è¿›ç¨‹ç»‘å®šä¸åŒå‰¯æœ¬ï¼Œå®ç°â€œè§†å›¾éš”ç¦»â€ã€‚</p><h2 id="å››ã€k8s-åˆ›å»º-pod-çš„æµç¨‹"><a href="#å››ã€k8s-åˆ›å»º-pod-çš„æµç¨‹" class="headerlink" title="å››ã€k8s åˆ›å»º pod çš„æµç¨‹"></a>å››ã€k8s åˆ›å»º pod çš„æµç¨‹</h2><p>**Kubernetes åˆ›å»ºä¸€ä¸ª Podï¼Œå…¶å®æ¶‰åŠ **<strong>API Serverã€è°ƒåº¦å™¨ã€kubeletã€å®¹å™¨è¿è¡Œæ—¶</strong> ç­‰å¤šä¸ªæ ¸å¿ƒç»„ä»¶ã€‚æˆ‘ç»™ä½ æ¢³ç†ä¸‹ <strong>ä»ç”¨æˆ·æäº¤ YAML åˆ° Pod è¿è¡Œèµ·æ¥</strong> çš„å®Œæ•´æµç¨‹ã€‚</p><h3 id="1-ç”¨æˆ·æäº¤è¯·æ±‚"><a href="#1-ç”¨æˆ·æäº¤è¯·æ±‚" class="headerlink" title="1. ç”¨æˆ·æäº¤è¯·æ±‚"></a>1. ç”¨æˆ·æäº¤è¯·æ±‚</h3><ul><li>**ç”¨æˆ·é€šè¿‡ **<code>kubectl apply -f pod.yaml</code> æˆ– API è°ƒç”¨ï¼Œå‘ <strong>API Server</strong> å‘é€åˆ›å»º Pod çš„è¯·æ±‚ã€‚</li><li><strong>API Server</strong>ï¼š<ul><li><strong>æ¥æ”¶è¯·æ±‚</strong></li><li><strong>æ ¡éªŒ YAMLï¼ˆåˆæ³•æ€§ã€schemaã€èµ„æºé…é¢ã€Admission Webhookâ€¦ï¼‰</strong></li><li>**å­˜å‚¨ Pod å¯¹è±¡åˆ° **<strong>etcd</strong></li></ul></li></ul><p><strong>ğŸ‘‰ æ­¤æ—¶ï¼ŒPod å¯¹è±¡å·²ç»å­˜åœ¨äº etcdï¼Œä½†è¿˜æ²¡è¿è¡Œã€‚</strong></p><h3 id="2-è°ƒåº¦æµç¨‹"><a href="#2-è°ƒåº¦æµç¨‹" class="headerlink" title="2. è°ƒåº¦æµç¨‹"></a>2. è°ƒåº¦æµç¨‹</h3><ul><li><strong>è°ƒåº¦å™¨ï¼ˆkube-schedulerï¼‰</strong> ä¼šç›‘å¬åˆ°æ–° Pod å¤„äº <code>Pending</code> çŠ¶æ€ã€‚</li><li><strong>è°ƒåº¦å™¨ï¼š</strong><ol><li><strong>æ ¹æ®è°ƒåº¦ç­–ç•¥ï¼ˆèµ„æºè¯·æ±‚/é™åˆ¶ã€äº²å’Œæ€§/åäº²å’Œæ€§ã€æ±¡ç‚¹/å®¹å¿åº¦ã€ä¼˜å…ˆçº§ç­‰ï¼‰ç­›é€‰å¯ç”¨èŠ‚ç‚¹</strong></li><li><strong>é€‰æ‹©ä¸€ä¸ªæœ€ä¼˜èŠ‚ç‚¹</strong></li><li>**æŠŠè°ƒåº¦ç»“æœï¼ˆPod â†’ èŠ‚ç‚¹ï¼‰å†™å› **<strong>API Server</strong></li></ol></li></ul><p>**ğŸ‘‰ æ­¤æ—¶ï¼ŒPod è¿˜æ˜¯ **<code>Pending</code>ï¼Œä½†å·²ç»ç»‘å®šåˆ°æŸä¸ª Nodeã€‚</p><h3 id="3-kubelet-åˆ›å»º-Pod"><a href="#3-kubelet-åˆ›å»º-Pod" class="headerlink" title="3. kubelet åˆ›å»º Pod"></a>3. kubelet åˆ›å»º Pod</h3><ul><li>**ç›®æ ‡èŠ‚ç‚¹ä¸Šçš„ **<strong>kubelet</strong> ç›‘å¬åˆ°æœ‰ Pod è°ƒåº¦è¿‡æ¥ã€‚</li><li><strong>kubelet æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š</strong><ol><li><strong>å‘ API Server æ‹‰å– Pod çš„å®šä¹‰</strong></li><li>**åˆ›å»º **<strong>PodSandbox</strong>ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ª pause å®¹å™¨ï¼Œå……å½“ Pod çš„ç½‘ç»œ &amp; namespace å®¹å™¨ï¼‰</li><li><strong>é…ç½® Pod ç½‘ç»œï¼ˆCNI æ’ä»¶ï¼šCalicoã€Flannelâ€¦ï¼Œä¸º Pod åˆ†é… IPï¼‰</strong></li><li><strong>é…ç½®å­˜å‚¨å·ï¼ˆæŒ‚è½½ PVã€PVCã€æœ¬åœ°ç›®å½•ã€ConfigMapã€Secret ç­‰ï¼‰</strong></li><li><strong>æ‹‰å–é•œåƒï¼ˆcontainerd / CRI-O / Docker shimï¼‰</strong></li><li><strong>å¯åŠ¨ Pod ä¸­å®šä¹‰çš„å„ä¸ªå®¹å™¨</strong></li></ol></li></ul><p>**ğŸ‘‰ æ­¤æ—¶ï¼Œå®¹å™¨è¿è¡Œèµ·æ¥ï¼ŒPod è¿›å…¥ **<code>Running</code> çŠ¶æ€ã€‚</p><h3 id="4-Pod-ç”Ÿå‘½å‘¨æœŸç®¡ç†"><a href="#4-Pod-ç”Ÿå‘½å‘¨æœŸç®¡ç†" class="headerlink" title="4. Pod ç”Ÿå‘½å‘¨æœŸç®¡ç†"></a>4. Pod ç”Ÿå‘½å‘¨æœŸç®¡ç†</h3><ul><li><strong>kubelet æŒç»­ç›‘æ§å®¹å™¨çŠ¶æ€ï¼Œä¸ŠæŠ¥ç»™ API Serverã€‚</strong></li><li><strong>API Server æŠŠçŠ¶æ€å†™å…¥ etcdã€‚</strong></li><li>**ç”¨æˆ·é€šè¿‡ **<code>kubectl get pod</code> çœ‹åˆ°çš„çŠ¶æ€ï¼Œå…¶å®æ˜¯ä» <strong>etcd â†’ API Server â†’ kubectl</strong> è¿”å›çš„ç»“æœã€‚</li><li>**å¦‚æœå®¹å™¨å¼‚å¸¸é€€å‡ºï¼Œkubelet ä¼šæŒ‰ Pod çš„ **<code>restartPolicy</code>ï¼ˆAlways/OnFailure/Neverï¼‰å†³å®šæ˜¯å¦é‡å¯ã€‚</li></ul><h3 id="5-äº‹ä»¶æµæ€»ç»“"><a href="#5-äº‹ä»¶æµæ€»ç»“" class="headerlink" title="5. äº‹ä»¶æµæ€»ç»“"></a>5. äº‹ä»¶æµæ€»ç»“</h3><ol><li><strong>kubectl / API</strong> â†’ è¯·æ±‚åˆ›å»º Pod</li><li><strong>API Server</strong> â†’ æ ¡éªŒã€å­˜å‚¨åˆ° etcd</li><li><strong>è°ƒåº¦å™¨</strong> â†’ é€‰æ‹©èŠ‚ç‚¹ï¼Œæ›´æ–° Pod ç»‘å®šä¿¡æ¯</li><li><strong>kubeletï¼ˆç›®æ ‡èŠ‚ç‚¹ï¼‰</strong> â†’ åˆ›å»º PodSandboxã€ç½‘ç»œã€å­˜å‚¨ã€æ‹‰é•œåƒã€å¯åŠ¨å®¹å™¨</li><li><strong>Pod Running</strong> â†’ çŠ¶æ€é€šè¿‡ kubelet ä¸ŠæŠ¥ API Server</li></ol><h3 id="ğŸ”¹-æ€»ç»“-1"><a href="#ğŸ”¹-æ€»ç»“-1" class="headerlink" title="ğŸ”¹ æ€»ç»“"></a>ğŸ”¹ æ€»ç»“</h3><ul><li><strong>API Server</strong>ï¼šå‰å°ï¼Œæ¥æ”¶è¯·æ±‚ï¼Œå­˜å‚¨å¯¹è±¡</li><li><strong>Scheduler</strong>ï¼šé€‰äººï¼ˆå†³å®š Pod è·‘åœ¨å“ªä¸ªèŠ‚ç‚¹ï¼‰</li><li><strong>Kubelet</strong>ï¼šå¹²æ´»çš„å·¥äººï¼ˆåœ¨èŠ‚ç‚¹ä¸ŠçœŸæ­£åˆ›å»ºå®¹å™¨ï¼‰</li><li><strong>etcd</strong>ï¼šå­˜æ¡£ï¼Œä¿å­˜é›†ç¾¤æ‰€æœ‰çŠ¶æ€</li></ul><hr><p><strong>âš¡</strong>ä¸€å¥è¯ï¼šç”¨æˆ·æäº¤ YAML â†’ API Server å­˜å‚¨ â†’ Scheduler åˆ†é… â†’ Kubelet åˆ›å»º â†’ Pod Runningã€‚</p><h2 id="äº”ã€svc-æš´éœ²ç«¯å£ç”¨åˆ°çš„æ˜¯å“ªä¸ªç»„ä»¶"><a href="#äº”ã€svc-æš´éœ²ç«¯å£ç”¨åˆ°çš„æ˜¯å“ªä¸ªç»„ä»¶" class="headerlink" title="äº”ã€svc æš´éœ²ç«¯å£ç”¨åˆ°çš„æ˜¯å“ªä¸ªç»„ä»¶"></a>äº”ã€svc æš´éœ²ç«¯å£ç”¨åˆ°çš„æ˜¯å“ªä¸ªç»„ä»¶</h2><p><strong>bernetes é‡Œï¼Œ****Service (svc)</strong> æš´éœ²ç«¯å£æ—¶ç”¨åˆ°çš„æ ¸å¿ƒç»„ä»¶ä¸»è¦æ˜¯ <strong>kube-proxy</strong>ã€‚</p><hr><h3 id="Service-æš´éœ²ç«¯å£çš„å®ç°ç»„ä»¶"><a href="#Service-æš´éœ²ç«¯å£çš„å®ç°ç»„ä»¶" class="headerlink" title="Service æš´éœ²ç«¯å£çš„å®ç°ç»„ä»¶"></a>Service æš´éœ²ç«¯å£çš„å®ç°ç»„ä»¶</h3><h4 id="1-kube-proxy"><a href="#1-kube-proxy" class="headerlink" title="1. kube-proxy"></a>1. <strong>kube-proxy</strong></h4><ul><li><strong>è¿è¡Œåœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šã€‚</strong></li><li><strong>ä½œç”¨ï¼š</strong><ul><li><strong>ç›‘å¬ API Server ä¸Šçš„ Service å’Œ Endpoints å˜åŒ–ã€‚</strong></li><li>**åœ¨èŠ‚ç‚¹ä¸Šè®¾ç½®è½¬å‘è§„åˆ™ï¼Œè®©è®¿é—® **<code>ServiceIP:Port</code> èƒ½è¢«è½¬å‘åˆ°åç«¯ Podã€‚</li></ul></li><li><strong>å®ç°æ–¹å¼ï¼š</strong><ul><li><strong>iptables æ¨¡å¼</strong>ï¼ˆå¸¸ç”¨ï¼‰ï¼šåŸºäº iptables çš„ DNAT è§„åˆ™è½¬å‘æµé‡ã€‚</li><li><strong>ipvs æ¨¡å¼</strong>ï¼šåŸºäº Linux IPVSï¼Œæ€§èƒ½æ›´å¥½ï¼Œæ”¯æŒæ›´å¤šè°ƒåº¦ç®—æ³•ï¼ˆrrã€lcã€dh ç­‰ï¼‰ã€‚</li><li><strong>userspace æ¨¡å¼</strong>ï¼ˆå¾ˆå°‘ç”¨ï¼Œæ€§èƒ½å·®ï¼‰ã€‚</li></ul></li></ul><p>**ğŸ‘‰ **<strong>æ ¸å¿ƒç‚¹</strong>ï¼šPod å†…éƒ¨æˆ–èŠ‚ç‚¹ä¸Šè®¿é—® Service ClusterIPï¼Œæµé‡å…ˆç»è¿‡ <strong>kube-proxy é…ç½®çš„è§„åˆ™</strong>ï¼Œå†è½¬å‘åˆ°æŸä¸ª Podã€‚</p><h4 id="2-Service-ç±»å‹å†³å®šæ˜¯å¦éœ€è¦å…¶ä»–ç»„ä»¶"><a href="#2-Service-ç±»å‹å†³å®šæ˜¯å¦éœ€è¦å…¶ä»–ç»„ä»¶" class="headerlink" title="2. Service ç±»å‹å†³å®šæ˜¯å¦éœ€è¦å…¶ä»–ç»„ä»¶"></a>2. <strong>Service ç±»å‹å†³å®šæ˜¯å¦éœ€è¦å…¶ä»–ç»„ä»¶</strong></h4><ul><li><strong>ClusterIPï¼ˆé»˜è®¤ï¼‰</strong>ï¼š<ul><li><strong>ä»…é›†ç¾¤å†…éƒ¨å¯è®¿é—®ã€‚</strong></li><li><strong>ä¾èµ– kube-proxy å®ç°ç«¯å£è½¬å‘ã€‚</strong></li></ul></li><li><strong>NodePort</strong>ï¼š<ul><li><strong>åœ¨æ¯ä¸ª Node ä¸Šæ‰“å¼€ä¸€ä¸ªç«¯å£ï¼ˆ30000â€“32767ï¼‰ã€‚</strong></li><li><strong>ä»ç”± kube-proxy ç»´æŠ¤è§„åˆ™ï¼ŒæŠŠè®¿é—® Node:Port çš„æµé‡è½¬å‘åˆ° Podã€‚</strong></li></ul></li><li><strong>LoadBalancer</strong>ï¼š<ul><li>**éœ€è¦ä¾èµ–äº‘å‚å•†çš„ **<strong>äº‘è´Ÿè½½å‡è¡¡å™¨</strong>ï¼ˆæ¯”å¦‚ AWS ELBã€é˜¿é‡Œäº‘ SLBï¼‰ã€‚</li><li><strong>kube-proxy ä»ç„¶è´Ÿè´£èŠ‚ç‚¹å†…éƒ¨è½¬å‘ã€‚</strong></li></ul></li><li><strong>ExternalName</strong>ï¼š<ul><li><strong>ä¸ä¾èµ– kube-proxyï¼Œåªæ˜¯ DNS CNAME åˆ°å¤–éƒ¨åœ°å€ã€‚</strong></li></ul></li></ul><hr><h4 id="ğŸ”¹-æ€»ç»“-2"><a href="#ğŸ”¹-æ€»ç»“-2" class="headerlink" title="ğŸ”¹ æ€»ç»“"></a>ğŸ”¹ æ€»ç»“</h4><ul><li><strong>æ ¸å¿ƒç»„ä»¶</strong>ï¼š<code>kube-proxy</code>ï¼ˆiptables æˆ– ipvs è§„åˆ™ï¼Œè´Ÿè´£è½¬å‘ Service æµé‡ï¼‰ã€‚</li><li><strong>æ‰©å±•ç»„ä»¶</strong>ï¼š<ul><li><strong>NodePort â†’ ä¾èµ– kube-proxy</strong></li><li>**LoadBalancer â†’ ä¾èµ– **<strong>äº‘å‚å•† LB + kube-proxy</strong></li><li><strong>ExternalName â†’ ä¾èµ– DNSï¼Œä¸èµ° kube-proxy</strong></li></ul></li></ul><hr><p><strong>âš¡</strong>ä¸€å¥è¯ï¼šKubernetes Service æš´éœ²ç«¯å£çš„åº•å±‚å®ç°ï¼Œæ ¸å¿ƒå°±æ˜¯Â kube-proxyï¼Œå®ƒåœ¨æ¯ä¸ªèŠ‚ç‚¹é…ç½®è½¬å‘è§„åˆ™ï¼ŒæŠŠ Service IP/ç«¯å£æ˜ å°„åˆ°åç«¯ Podã€‚</p><h2 id="å…­ã€äº‘ä¸Šä»¥åŠäºŒè¿›åˆ¶éƒ¨ç½²çš„k8s-æ€æ ·æ‰©å®¹é›†ç¾¤"><a href="#å…­ã€äº‘ä¸Šä»¥åŠäºŒè¿›åˆ¶éƒ¨ç½²çš„k8s-æ€æ ·æ‰©å®¹é›†ç¾¤" class="headerlink" title="å…­ã€äº‘ä¸Šä»¥åŠäºŒè¿›åˆ¶éƒ¨ç½²çš„k8s æ€æ ·æ‰©å®¹é›†ç¾¤"></a>å…­ã€äº‘ä¸Šä»¥åŠäºŒè¿›åˆ¶éƒ¨ç½²çš„k8s æ€æ ·æ‰©å®¹é›†ç¾¤</h2><h3 id="â˜ï¸-äº‘ä¸Š-K8s-æ‰©å®¹"><a href="#â˜ï¸-äº‘ä¸Š-K8s-æ‰©å®¹" class="headerlink" title="â˜ï¸ äº‘ä¸Š K8s æ‰©å®¹"></a>â˜ï¸ äº‘ä¸Š K8s æ‰©å®¹</h3><p><strong>ï¼ˆå…¸å‹ï¼šé˜¿é‡Œäº‘ ACKã€è…¾è®¯äº‘ TKEã€AWS EKSã€GKEã€AKSï¼‰</strong></p><h4 id="1-æ§åˆ¶å¹³é¢æ‰©å®¹"><a href="#1-æ§åˆ¶å¹³é¢æ‰©å®¹" class="headerlink" title="1. æ§åˆ¶å¹³é¢æ‰©å®¹"></a>1. æ§åˆ¶å¹³é¢æ‰©å®¹</h4><ul><li><strong>å¤§å¤šæ•°äº‘å‚å•†</strong>å·²ç»æä¾›äº†é«˜å¯ç”¨çš„ API Server / etcd ç®¡ç†ï¼Œç”¨æˆ·é€šå¸¸ä¸éœ€è¦æ‰‹åŠ¨æ‰©å®¹æ§åˆ¶å¹³é¢ã€‚</li><li>**å¦‚æœæ”¯æŒ **<strong>ä¸“æœ‰é›†ç¾¤ / è‡ªç®¡æ§åˆ¶å¹³é¢</strong>ï¼Œä¸€èˆ¬é€šè¿‡æ§åˆ¶å°æˆ– API <strong>æ–°å¢ Master èŠ‚ç‚¹</strong>ï¼Œäº‘å¹³å°ä¼šè‡ªåŠ¨è°ƒæ•´ <code>etcd</code> å’Œ <code>kube-apiserver</code>ã€‚</li></ul><h4 id="2-Node-æ‰©å®¹"><a href="#2-Node-æ‰©å®¹" class="headerlink" title="2. Node æ‰©å®¹"></a>2. Node æ‰©å®¹</h4><p><strong>æ–¹å¼ä¸€ï¼š****æ§åˆ¶å°/CLI ä¸€é”®åŠ èŠ‚ç‚¹</strong></p><ul><li><strong>åœ¨æ§åˆ¶å°é€‰æ‹©â€œæ·»åŠ èŠ‚ç‚¹â€ â†’ é€‰æ‹©äº‘æœåŠ¡å™¨è§„æ ¼ã€æ•°é‡ã€‚</strong></li><li><strong>ç³»ç»Ÿè‡ªåŠ¨å®‰è£… kubelet / kube-proxyï¼Œå¹¶åŠ å…¥é›†ç¾¤ã€‚</strong></li></ul><p><strong>æ–¹å¼äºŒï¼š****å¼¹æ€§ä¼¸ç¼© (Cluster Autoscaler)</strong></p><ul><li><strong>å¼€å¯è‡ªåŠ¨ä¼¸ç¼©ï¼Œäº‘å¹³å°ä¼šè‡ªåŠ¨åˆ›å»º/é‡Šæ”¾èŠ‚ç‚¹ã€‚</strong></li><li><strong>å¸¸ç”¨äºå¼¹æ€§ä¸šåŠ¡åœºæ™¯ã€‚</strong></li></ul><p>**ğŸ‘‰ **äº‘ä¸Šæ‰©å®¹çš„å…³é”®æ˜¯ï¼šèŠ‚ç‚¹ç”±äº‘å‚å•†æä¾›åˆå§‹åŒ–è„šæœ¬ï¼Œè‡ªåŠ¨å‘ API Server æ³¨å†Œã€‚</p><h3 id="ğŸ–¥-äºŒè¿›åˆ¶éƒ¨ç½²-K8s-æ‰©å®¹"><a href="#ğŸ–¥-äºŒè¿›åˆ¶éƒ¨ç½²-K8s-æ‰©å®¹" class="headerlink" title="ğŸ–¥ äºŒè¿›åˆ¶éƒ¨ç½² K8s æ‰©å®¹"></a>ğŸ–¥ äºŒè¿›åˆ¶éƒ¨ç½² K8s æ‰©å®¹</h3><p><strong>ï¼ˆäºŒè¿›åˆ¶æ–¹å¼ï¼škubeadm ä¹‹å¤–çš„çº¯æ‰‹å·¥å®‰è£…ï¼Œå¸¸è§äºç”Ÿäº§ç¯å¢ƒæˆ–å¤§è§„æ¨¡ç§æœ‰äº‘ï¼‰</strong></p><h4 id="1-æ‰©å®¹-Master-èŠ‚ç‚¹"><a href="#1-æ‰©å®¹-Master-èŠ‚ç‚¹" class="headerlink" title="1. æ‰©å®¹ Master èŠ‚ç‚¹"></a>1. æ‰©å®¹ Master èŠ‚ç‚¹</h4><ul><li><strong>éœ€è¦æ‰‹åŠ¨å‡†å¤‡æ–°æœåŠ¡å™¨ï¼Œå®‰è£…ï¼š</strong><code>kube-apiserver</code>ã€<code>kube-scheduler</code>ã€<code>kube-controller-manager</code>ã€‚</li><li><strong>å°†æ–° Master åŠ å…¥ç°æœ‰çš„ etcd é›†ç¾¤ï¼š</strong><ul><li><strong>åœ¨ etcd ä¸Šæ·»åŠ æ–°æˆå‘˜ â†’ åŒæ­¥æ•°æ®</strong></li><li><strong>ä¿®æ”¹æ‰€æœ‰ Master é…ç½® â†’ è®©å®ƒä»¬éƒ½èƒ½è®¿é—®å®Œæ•´ etcd é›†ç¾¤</strong></li></ul></li><li><strong>é…ç½® kube-apiserver ä½¿ç”¨æ–°çš„ etcd é›†ç¾¤ã€‚</strong></li><li><strong>é…ç½®é«˜å¯ç”¨å…¥å£ï¼ˆNginx/HAProxy/Keepalived/VIPï¼‰æ¥ç»Ÿä¸€ API Server åœ°å€ã€‚</strong></li></ul><h4 id="2-æ‰©å®¹-Node-èŠ‚ç‚¹"><a href="#2-æ‰©å®¹-Node-èŠ‚ç‚¹" class="headerlink" title="2. æ‰©å®¹ Node èŠ‚ç‚¹"></a>2. æ‰©å®¹ Node èŠ‚ç‚¹</h4><p><strong>æ­¥éª¤ï¼š</strong></p><ol><li><strong>åœ¨æ–°æœºå™¨ä¸Šå®‰è£…å¿…è¦ç»„ä»¶ï¼š</strong><ul><li><strong>kubelet</strong></li><li><strong>kube-proxy</strong></li><li><strong>CNI æ’ä»¶ï¼ˆCalico/Flannel/Cilium ç­‰ï¼‰</strong></li></ul></li><li><strong>é…ç½® kubeletï¼š</strong><ul><li>**æŒ‡å®š **<code>--kubeconfig</code> æŒ‡å‘ API Server</li><li><strong>è®¾ç½®èŠ‚ç‚¹åã€è¯ä¹¦ã€å·¥ä½œç›®å½•</strong></li></ul></li><li><strong>å¯åŠ¨ kubelet â†’ kubelet ä¼šå‘ API Server æ³¨å†Œè‡ªå·±ã€‚</strong></li><li>**ç®¡ç†å‘˜åœ¨ Master ä¸Š **<code>kubectl get nodes</code> æŸ¥çœ‹æ–°èŠ‚ç‚¹çŠ¶æ€ã€‚</li></ol><h4 id="3-æ³¨æ„ç‚¹"><a href="#3-æ³¨æ„ç‚¹" class="headerlink" title="3. æ³¨æ„ç‚¹"></a>3. æ³¨æ„ç‚¹</h4><ul><li><strong>è¯ä¹¦ç­¾å‘ï¼šå¦‚æœå¯ç”¨äº† TLSï¼Œéœ€è¦æ–°èŠ‚ç‚¹çš„ kubelet è¯ä¹¦ç”±é›†ç¾¤ CA ç­¾å‘ã€‚</strong></li><li><strong>ç½‘ç»œï¼šç¡®ä¿æ–°èŠ‚ç‚¹ä¸ Pod ç½‘æ®µã€Service ç½‘æ®µäº’é€šã€‚</strong></li><li><strong>è´Ÿè½½å‡è¡¡ï¼šå¦‚æœæ˜¯ Master æ‰©å®¹ï¼Œè®°å¾—æ›´æ–° LB é…ç½®ï¼ŒæŠŠæ–° Master åŠ å…¥ã€‚</strong></li></ul><hr><h4 id="ğŸ”¹-æ€»ç»“å¯¹æ¯”"><a href="#ğŸ”¹-æ€»ç»“å¯¹æ¯”" class="headerlink" title="ğŸ”¹ æ€»ç»“å¯¹æ¯”"></a>ğŸ”¹ æ€»ç»“å¯¹æ¯”</h4><table><thead><tr><th><strong>éƒ¨ç½²æ–¹å¼</strong></th><th><strong>Master æ‰©å®¹</strong></th><th><strong>Node æ‰©å®¹</strong></th></tr></thead><tbody><tr><td><strong>äº‘ä¸Šæ‰˜ç®¡</strong></td><td><strong>äº‘å‚å•†è‡ªåŠ¨ç»´æŠ¤ï¼Œç”¨æˆ·æ— éœ€æ“ä½œ</strong></td><td><strong>æ§åˆ¶å°/CLI æ·»åŠ èŠ‚ç‚¹ï¼Œæˆ–å¯ç”¨å¼¹æ€§ä¼¸ç¼©</strong></td></tr><tr><td><strong>äºŒè¿›åˆ¶è‡ªå»º</strong></td><td><strong>æ‰‹åŠ¨å®‰è£…ç»„ä»¶ï¼ŒåŠ å…¥ etcdï¼Œé…ç½® LB</strong></td><td><strong>æ‰‹åŠ¨å®‰è£… kubelet/kube-proxyï¼Œé…ç½®è¯ä¹¦ï¼ŒåŠ å…¥ API Server</strong></td></tr></tbody></table><hr><p><strong>âš¡ä¸€å¥è¯ï¼š</strong></p><ul><li><strong>äº‘ä¸Šæ‰©å®¹ â†’ æ§åˆ¶å°ç‚¹å‡ ä¸‹ï¼ŒèŠ‚ç‚¹è‡ªåŠ¨åŠ è¿›æ¥</strong>ã€‚</li><li>äºŒè¿›åˆ¶æ‰©å®¹ â†’ è‡ªå·±è£… kubelet/kube-proxy/ç½‘ç»œæ’ä»¶ï¼Œæè¯ä¹¦ï¼Œæ etcd/LBã€‚</li></ul><h2 id="ä¸ƒã€k8sæœ‰å‡ ç§æ¢é’ˆä»¥åŠåŒºåˆ«-æ¢é’ˆå¤±è´¥äº†-k8s-ä¼šå’‹æ ·"><a href="#ä¸ƒã€k8sæœ‰å‡ ç§æ¢é’ˆä»¥åŠåŒºåˆ«-æ¢é’ˆå¤±è´¥äº†-k8s-ä¼šå’‹æ ·" class="headerlink" title="ä¸ƒã€k8sæœ‰å‡ ç§æ¢é’ˆä»¥åŠåŒºåˆ« æ¢é’ˆå¤±è´¥äº† k8s ä¼šå’‹æ ·"></a>ä¸ƒã€k8sæœ‰å‡ ç§æ¢é’ˆä»¥åŠåŒºåˆ« æ¢é’ˆå¤±è´¥äº† k8s ä¼šå’‹æ ·</h2><p><strong>exec TCPSoket HTTPGet</strong></p><p>**åœ¨ Kubernetes é‡Œ **<strong>Pod çš„å¥åº·æ£€æŸ¥</strong>æ˜¯é  <strong>æ¢é’ˆ (Probe)</strong> å®ç°çš„ï¼Œä¸€å…±æœ‰ä¸‰ç§ï¼š</p><h3 id="1-æ¢é’ˆç±»å‹"><a href="#1-æ¢é’ˆç±»å‹" class="headerlink" title="1. æ¢é’ˆç±»å‹"></a>1. æ¢é’ˆç±»å‹</h3><h4 id="âœ…-Liveness-Probeï¼ˆå­˜æ´»æ¢é’ˆï¼‰"><a href="#âœ…-Liveness-Probeï¼ˆå­˜æ´»æ¢é’ˆï¼‰" class="headerlink" title="âœ… Liveness Probeï¼ˆå­˜æ´»æ¢é’ˆï¼‰"></a>âœ… Liveness Probeï¼ˆå­˜æ´»æ¢é’ˆï¼‰</h4><ul><li><strong>ä½œç”¨</strong>ï¼šåˆ¤æ–­å®¹å™¨æ˜¯å¦â€œè¿˜æ´»ç€â€ã€‚</li><li><strong>å¤±è´¥æ—¶è¡Œä¸º</strong>ï¼škubelet ä¼š <strong>æ€æ‰å®¹å™¨å¹¶é‡å¯</strong>ï¼ˆéµå¾ª <code>restartPolicy</code>ï¼‰ã€‚</li><li><strong>å…¸å‹ç”¨é€”</strong>ï¼šå®¹å™¨è¿›ç¨‹å¡æ­»ã€æ­»å¾ªç¯ã€æ­»é”æ—¶ï¼Œç”¨å®ƒæ¥è‡ªåŠ¨é‡å¯æ¢å¤ã€‚<br><strong>ä¾‹å­</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">livenessProbe:</span><br><span class="line">  httpGet:</span><br><span class="line"> Â   path: /healthz</span><br><span class="line"> Â   port: 8080</span><br><span class="line">  initialDelaySeconds: 10</span><br><span class="line">  periodSeconds: 5</span><br></pre></td></tr></table></figure></li></ul><p><strong>è§£é‡Šï¼š</strong></p><ul><li><strong>å®¹å™¨å¯åŠ¨å 10 ç§’å¼€å§‹æ£€æµ‹ã€‚</strong></li><li>**æ¯ 5 ç§’æ£€æŸ¥ä¸€æ¬¡ **<code>/healthz</code> æ¥å£ã€‚</li><li><strong>å¦‚æœæ¥å£è¿ç»­å¤±è´¥ï¼Œk8s ä¼šé‡å¯å®¹å™¨ã€‚</strong></li></ul><h3 id="2-Readiness-Probeï¼ˆå°±ç»ªæ¢é’ˆï¼‰"><a href="#2-Readiness-Probeï¼ˆå°±ç»ªæ¢é’ˆï¼‰" class="headerlink" title="2. Readiness Probeï¼ˆå°±ç»ªæ¢é’ˆï¼‰"></a>2. <strong>Readiness Probeï¼ˆå°±ç»ªæ¢é’ˆï¼‰</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šæ£€æŸ¥å®¹å™¨æ˜¯å¦ <strong>å‡†å¤‡å¥½æ¥æ”¶æµé‡</strong>ã€‚</li><li><strong>è¡Œä¸º</strong>ï¼šå¦‚æœ Readiness æ¢é’ˆå¤±è´¥ï¼ŒPod ä¼š <strong>ä» Service çš„ Endpoints ä¸­ç§»é™¤</strong>ï¼Œä¸ä¼šè¢«æµé‡è·¯ç”±åˆ°ã€‚</li><li><strong>å…¸å‹åœºæ™¯</strong>ï¼šåº”ç”¨å¯åŠ¨æ…¢ï¼Œæˆ–è€…åŠ è½½äº†å¤§æ•°æ®æ‰çœŸæ­£å¯ç”¨ã€‚</li></ul><p><strong>ç¤ºä¾‹</strong>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">readinessProbe:</span><br><span class="line">  httpGet:</span><br><span class="line"> Â   path: /ready</span><br><span class="line"> Â   port: 8080</span><br><span class="line">  initialDelaySeconds: 5</span><br><span class="line">  periodSeconds: 5</span><br></pre></td></tr></table></figure><p><strong>è§£é‡Šï¼š</strong></p><ul><li>**å®¹å™¨å¯åŠ¨ 5 ç§’åå¼€å§‹æ£€æŸ¥ **<code>/ready</code> æ¥å£ã€‚</li><li><strong>æ¥å£å¤±è´¥åˆ™è¡¨ç¤ºå®¹å™¨æš‚æ—¶ä¸æ¥æ”¶æµé‡ï¼Œä½†ä¸ä¼šè¢«é‡å¯ã€‚</strong></li></ul><h3 id="3-Startup-Probeï¼ˆå¯åŠ¨æ¢é’ˆï¼‰"><a href="#3-Startup-Probeï¼ˆå¯åŠ¨æ¢é’ˆï¼‰" class="headerlink" title="3. Startup Probeï¼ˆå¯åŠ¨æ¢é’ˆï¼‰"></a>3. <strong>Startup Probeï¼ˆå¯åŠ¨æ¢é’ˆï¼‰</strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šç”¨äºæ£€æµ‹ <strong>å®¹å™¨å¯åŠ¨æ˜¯å¦æˆåŠŸ</strong>ï¼Œé€‚ç”¨äºå¯åŠ¨æ…¢çš„åº”ç”¨ã€‚</li><li><strong>è¡Œä¸º</strong>ï¼š<ul><li>**åœ¨å®¹å™¨å¯åŠ¨é˜¶æ®µï¼ŒStartup Probe å¤±è´¥ä¼š **<strong>ç›´æ¥é‡å¯å®¹å™¨</strong>ã€‚</li><li><strong>å¯åŠ¨å®Œæˆåï¼ŒStartup Probe ä¼šåœæ­¢å·¥ä½œï¼Œäº¤ç»™ Liveness Probe ç›‘æ§ã€‚</strong></li></ul></li><li><strong>å…¸å‹åœºæ™¯</strong>ï¼šJavaã€æ•°æ®åº“ç­‰å¯åŠ¨å¾ˆæ…¢çš„æœåŠ¡ã€‚</li></ul><p><strong>ä¾‹å­</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">startupProbe:</span><br><span class="line">  httpGet:</span><br><span class="line"> Â   path: /healthz</span><br><span class="line"> Â   port: 8080</span><br><span class="line">  failureThreshold: 30</span><br><span class="line">  periodSeconds: 10</span><br></pre></td></tr></table></figure><p><strong>è§£é‡Šï¼š</strong></p><ul><li>**æ¯ 10 ç§’æ£€æŸ¥ä¸€æ¬¡ **<code>/healthz</code>ã€‚</li><li><strong>è¿ç»­å¤±è´¥ 30 æ¬¡æ‰é‡å¯å®¹å™¨ï¼Œé€‚åˆå¯åŠ¨æ—¶é—´è¾ƒé•¿çš„åº”ç”¨ã€‚</strong></li></ul><hr><h3 id="4-åŒºåˆ«æ€»ç»“è¡¨"><a href="#4-åŒºåˆ«æ€»ç»“è¡¨" class="headerlink" title="4. åŒºåˆ«æ€»ç»“è¡¨"></a>4. åŒºåˆ«æ€»ç»“è¡¨</h3><table><thead><tr><th><strong>æ¢é’ˆç±»å‹</strong></th><th><strong>è§¦å‘åŠ¨ä½œ</strong></th><th><strong>å…¸å‹ç”¨é€”</strong></th></tr></thead><tbody><tr><td><strong>Liveness</strong></td><td><strong>å¤±è´¥ â†’ å®¹å™¨é‡å¯</strong></td><td><strong>æ­»é”ã€è¿›ç¨‹æŒ‚æ‰</strong></td></tr><tr><td><strong>Readiness</strong></td><td><strong>å¤±è´¥ â†’ Pod ä» Service ç§»é™¤</strong></td><td><strong>åº”ç”¨æš‚æ—¶ä¸å¯ç”¨</strong></td></tr><tr><td><strong>Startup</strong></td><td><strong>å¤±è´¥ â†’ å®¹å™¨é‡å¯ï¼ˆä»…å¯åŠ¨é˜¶æ®µï¼‰</strong></td><td><strong>å¯åŠ¨æ…¢çš„åº”ç”¨</strong></td></tr></tbody></table><hr><h3 id="5-ä¸¾ä¾‹è¯´æ˜å®¹å™¨æ¢é’ˆå¤±è´¥åçš„è¡Œä¸º"><a href="#5-ä¸¾ä¾‹è¯´æ˜å®¹å™¨æ¢é’ˆå¤±è´¥åçš„è¡Œä¸º" class="headerlink" title="5. ä¸¾ä¾‹è¯´æ˜å®¹å™¨æ¢é’ˆå¤±è´¥åçš„è¡Œä¸º"></a>5. ä¸¾ä¾‹è¯´æ˜å®¹å™¨æ¢é’ˆå¤±è´¥åçš„è¡Œä¸º</h3><p><strong>å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª Nginx å®¹å™¨ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">containers:</span><br><span class="line">- name: nginx</span><br><span class="line">  image: nginx</span><br><span class="line">  livenessProbe:</span><br><span class="line"> Â   httpGet:</span><br><span class="line"> Â  Â   path: /healthz</span><br><span class="line"> Â  Â   port: 80</span><br><span class="line"> Â   initialDelaySeconds: 5</span><br><span class="line"> Â   periodSeconds: 2</span><br></pre></td></tr></table></figure><ul><li>**å¦‚æœ **<code>/healthz</code> æ¥å£è¿”å›é 200ï¼Œè¿ç»­å¤±è´¥ï¼š<ul><li><strong>k8s ä¼šæ€æ‰ nginx å®¹å™¨å¹¶é‡å¯ã€‚</strong></li></ul></li><li><strong>å¦‚æœæˆ‘ä»¬åŠ äº† Readiness Probeï¼š</strong><ul><li><strong>Pod ä¼šæš‚æ—¶è¢« Service ä¸‹çº¿ï¼Œä¸ä¼šè¢«è®¿é—®ï¼Œç›´åˆ°æ¢é’ˆæ¢å¤ã€‚</strong></li></ul></li></ul><h2 id="å…«ã€k8sç»„ä»¶æ€»è§ˆ"><a href="#å…«ã€k8sç»„ä»¶æ€»è§ˆ" class="headerlink" title="å…«ã€k8sç»„ä»¶æ€»è§ˆ"></a>å…«ã€k8sç»„ä»¶æ€»è§ˆ</h2><h3 id="1ï¸âƒ£-å‘½åç©ºé—´-èµ„æºéš”ç¦»ç›¸å…³"><a href="#1ï¸âƒ£-å‘½åç©ºé—´-èµ„æºéš”ç¦»ç›¸å…³" class="headerlink" title="1ï¸âƒ£ å‘½åç©ºé—´ / èµ„æºéš”ç¦»ç›¸å…³"></a>1ï¸âƒ£ <strong>å‘½åç©ºé—´ / èµ„æºéš”ç¦»ç›¸å…³</strong></h3><ul><li><strong>Namespaceï¼ˆå‘½åç©ºé—´ï¼‰</strong>ï¼šKubernetes å†…ç½®ï¼Œç”¨äºé€»è¾‘éš”ç¦»èµ„æºã€‚</li><li><strong>NetworkPolicy</strong>ï¼šæ§åˆ¶ Pod é—´ç½‘ç»œè®¿é—®ç­–ç•¥ï¼Œå®ç°éš”ç¦»ã€‚</li><li><strong>RBACï¼ˆRole/ClusterRoleï¼‰</strong>ï¼šæƒé™éš”ç¦»ã€‚</li><li><strong>ResourceQuota / LimitRange</strong>ï¼šèµ„æºä½¿ç”¨éš”ç¦»ã€‚</li></ul><blockquote><p><strong>ç±»ä¼¼ â€œnsâ€ çš„æ¦‚å¿µï¼Œä¸»è¦æ˜¯åšé€»è¾‘åˆ†ç»„ã€éš”ç¦»å’Œæƒé™æ§åˆ¶ã€‚</strong></p></blockquote><hr><h3 id="2ï¸âƒ£-æœåŠ¡å‘ç°-DNS"><a href="#2ï¸âƒ£-æœåŠ¡å‘ç°-DNS" class="headerlink" title="2ï¸âƒ£ æœåŠ¡å‘ç° / DNS"></a>2ï¸âƒ£ <strong>æœåŠ¡å‘ç° / DNS</strong></h3><ul><li><strong>CoreDNS</strong>ï¼š<ul><li><strong>é»˜è®¤é›†ç¾¤ DNS ç»„ä»¶ã€‚</strong></li><li>**ä¸º Pod æä¾› **<code>service-name.namespace.svc.cluster.local</code> è§£æã€‚</li></ul></li><li><strong>kube-dns</strong>ï¼ˆæ—§ç‰ˆï¼Œå·²è¢« CoreDNS æ›¿ä»£ï¼‰ã€‚</li><li><strong>ExternalDNS</strong>ï¼š<ul><li><strong>å°† Kubernetes Service çš„åŸŸåè‡ªåŠ¨åŒæ­¥åˆ°å¤–éƒ¨ DNSï¼ˆå¦‚ Route53ã€é˜¿é‡Œäº‘ DNSï¼‰ã€‚</strong></li></ul></li></ul><blockquote><p>**æ ¸å¿ƒåŠŸèƒ½æ˜¯åå­—è§£æå’ŒæœåŠ¡å‘ç°ï¼Œç±»ä¼¼ Linux ä¸‹çš„ **<code>nslookup</code> / <code>hosts</code> åŠŸèƒ½ï¼Œä½†åœ¨é›†ç¾¤å†…éƒ¨è‡ªåŠ¨åŒ–ã€‚</p></blockquote><hr><h3 id="3ï¸âƒ£-ç½‘ç»œ-CNI-ç›¸å…³"><a href="#3ï¸âƒ£-ç½‘ç»œ-CNI-ç›¸å…³" class="headerlink" title="3ï¸âƒ£ ç½‘ç»œ / CNI ç›¸å…³"></a>3ï¸âƒ£ <strong>ç½‘ç»œ / CNI ç›¸å…³</strong></h3><ul><li><strong>CNI æ’ä»¶</strong>ï¼ˆContainer Network Interfaceï¼‰ï¼š<ul><li><strong>Calico</strong>ï¼šæä¾›ç½‘ç»œç­–ç•¥å’Œå®‰å…¨ç»„åŠŸèƒ½ã€‚</li><li><strong>Flannel</strong>ï¼šç®€å•çš„ L2/L3 ç½‘ç»œå®ç°ã€‚</li><li><strong>Weave Net</strong>ï¼šæ”¯æŒåŠ å¯†å’Œè·¨èŠ‚ç‚¹ Pod é€šä¿¡ã€‚</li><li><strong>Cilium</strong>ï¼šåŸºäº eBPF çš„é«˜çº§ç½‘ç»œå’Œå®‰å…¨ç­–ç•¥ã€‚</li></ul></li><li><strong>kube-proxy</strong>ï¼š<ul><li><strong>å®ç° ClusterIPã€Service è´Ÿè½½å‡è¡¡ã€‚</strong></li></ul></li></ul><blockquote><p><strong>è¿™äº›ç»„ä»¶éƒ½å’Œ Pod é€šä¿¡ã€ç½‘ç»œè·¯ç”±ã€æœåŠ¡å‘ç°æœ‰å…³ç³»ã€‚</strong></p></blockquote><hr><h3 id="4ï¸âƒ£-é…ç½®-é…ç½®ç®¡ç†"><a href="#4ï¸âƒ£-é…ç½®-é…ç½®ç®¡ç†" class="headerlink" title="4ï¸âƒ£ é…ç½® / é…ç½®ç®¡ç†"></a>4ï¸âƒ£ <strong>é…ç½® / é…ç½®ç®¡ç†</strong></h3><ul><li><strong>ConfigMap</strong>ï¼šç®¡ç†éæ•æ„Ÿé…ç½®ä¿¡æ¯ã€‚</li><li><strong>Secret</strong>ï¼šç®¡ç†æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€è¯ä¹¦ï¼‰ã€‚</li><li><strong>ServiceAccount / Token</strong>ï¼šæä¾› Pod å¯¹ API Server çš„è®¿é—®å‡­è¯ã€‚</li></ul><blockquote><p><strong>é…ç½®ã€å¯†é’¥ã€è®¿é—®æ§åˆ¶ä¹Ÿæ˜¯â€œå‘½åå’Œèµ„æºç®¡ç†â€çš„ä¸€éƒ¨åˆ†ã€‚</strong></p></blockquote><hr><h3 id="5ï¸âƒ£-é«˜çº§æœåŠ¡å‘ç°-æœåŠ¡ç½‘æ ¼"><a href="#5ï¸âƒ£-é«˜çº§æœåŠ¡å‘ç°-æœåŠ¡ç½‘æ ¼" class="headerlink" title="5ï¸âƒ£ é«˜çº§æœåŠ¡å‘ç° / æœåŠ¡ç½‘æ ¼"></a>5ï¸âƒ£ <strong>é«˜çº§æœåŠ¡å‘ç° / æœåŠ¡ç½‘æ ¼</strong></h3><ul><li><strong>Istio / Linkerd / Consul</strong>ï¼š<ul><li><strong>æä¾›å¾®æœåŠ¡é—´æµé‡ç®¡ç†ã€æœåŠ¡å‘ç°ã€å¯è§‚æµ‹æ€§ã€‚</strong></li><li><strong>ç»“åˆ Envoy ä»£ç†å®ç° L7 å±‚æµé‡æ§åˆ¶ã€‚</strong></li></ul></li></ul><hr><p><strong>ğŸ’¡ æ€»ç»“ï¼š</strong> ** â€œç±»ä¼¼ **<code>ns</code> çš„ç»„ä»¶â€ï¼Œå¯ä»¥ç†è§£ä¸º <strong>å‘½åã€éš”ç¦»ã€å‘ç°ã€è·¯ç”±</strong>ç›¸å…³çš„ç³»ç»Ÿç»„ä»¶ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li><strong>å‘½åç©ºé—´ã€RBACã€èµ„æºé…é¢ï¼ˆéš”ç¦»ï¼‰</strong></li><li><strong>CoreDNS / kube-dns / ExternalDNSï¼ˆæœåŠ¡å‘ç°ï¼‰</strong></li><li><strong>CNI æ’ä»¶ã€kube-proxyï¼ˆç½‘ç»œå’Œè·¯ç”±ï¼‰</strong></li><li><strong>é…ç½®ç®¡ç†ç»„ä»¶ï¼ˆConfigMap / Secretï¼‰</strong></li><li><strong>é«˜çº§æœåŠ¡ç½‘æ ¼ï¼ˆIstio / Consul / Linkerdï¼‰</strong></li></ul><h2 id="ä¹ã€Deployment-StatefulSet-æœ‰çŠ¶æ€çš„å’Œæ— çŠ¶æ€çš„æœåŠ¡ä¹‹é—´çš„åŒºåˆ«"><a href="#ä¹ã€Deployment-StatefulSet-æœ‰çŠ¶æ€çš„å’Œæ— çŠ¶æ€çš„æœåŠ¡ä¹‹é—´çš„åŒºåˆ«" class="headerlink" title="ä¹ã€Deployment  StatefulSet æœ‰çŠ¶æ€çš„å’Œæ— çŠ¶æ€çš„æœåŠ¡ä¹‹é—´çš„åŒºåˆ«"></a>ä¹ã€Deployment  StatefulSet æœ‰çŠ¶æ€çš„å’Œæ— çŠ¶æ€çš„æœåŠ¡ä¹‹é—´çš„åŒºåˆ«</h2><p>**åœ¨ **<strong>Kubernetes</strong> ä¸­ï¼Œ<code>Deployment</code> å’Œ <code>StatefulSet</code> æ˜¯ä¸¤ç§å¸¸è§çš„ <strong>å·¥ä½œè´Ÿè½½æ§åˆ¶å™¨</strong>ï¼Œä¸»è¦ç”¨äºç®¡ç† <strong>æ— çŠ¶æ€æœåŠ¡</strong> å’Œ <strong>æœ‰çŠ¶æ€æœåŠ¡</strong>ã€‚å®ƒä»¬çš„åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p><hr><h3 id="1-é€‚ç”¨åœºæ™¯"><a href="#1-é€‚ç”¨åœºæ™¯" class="headerlink" title="1. é€‚ç”¨åœºæ™¯"></a>1. <strong>é€‚ç”¨åœºæ™¯</strong></h3><ul><li><strong>Deploymentï¼ˆæ— çŠ¶æ€æœåŠ¡ï¼‰</strong><ul><li>**ç”¨äº **<strong>æ— çŠ¶æ€åº”ç”¨</strong>ï¼Œæ¯”å¦‚ Nginxã€å‰ç«¯åº”ç”¨ã€å¾®æœåŠ¡ APIã€è´Ÿè½½å‡è¡¡å™¨ç­‰ã€‚</li><li><strong>æ¯ä¸ª Pod éƒ½æ˜¯ç›¸åŒçš„ï¼Œä¹‹é—´æ²¡æœ‰èº«ä»½å·®å¼‚ï¼Œéšæ—¶å¯æ›¿æ¢æˆ–æ‰©ç¼©å®¹ã€‚</strong></li></ul></li><li><strong>StatefulSetï¼ˆæœ‰çŠ¶æ€æœåŠ¡ï¼‰</strong><ul><li>**ç”¨äº **<strong>æœ‰çŠ¶æ€åº”ç”¨</strong>ï¼Œæ¯”å¦‚ MySQLã€Redisï¼ˆä¸»ä»ï¼‰ã€Zookeeperã€Kafkaã€Etcdã€‚</li><li>**æ¯ä¸ª Pod éƒ½æœ‰ **<strong>å›ºå®šèº«ä»½</strong>ï¼ˆç¼–å·ã€å­˜å‚¨ï¼‰ï¼Œä¸èƒ½éšä¾¿æ›¿æ¢ã€‚</li></ul></li></ul><hr><h3 id="2-Pod-æ ‡è¯†ï¼ˆIdentityï¼‰"><a href="#2-Pod-æ ‡è¯†ï¼ˆIdentityï¼‰" class="headerlink" title="2. Pod æ ‡è¯†ï¼ˆIdentityï¼‰"></a>2. <strong>Pod æ ‡è¯†ï¼ˆIdentityï¼‰</strong></h3><ul><li><strong>Deployment</strong><ul><li><strong>Pod åç§°æ˜¯éšæœºçš„ï¼Œæ¯”å¦‚ï¼š</strong><code>nginx-5c9c7d8c9f-abc12</code>ã€‚</li><li><strong>åˆ é™¤ä¸€ä¸ª Podï¼Œå†èµ·çš„æ–° Pod åå­—ä¸åŒã€‚</strong></li><li>**æ‰€æœ‰ Pod **<strong>å¯¹å¤–æ˜¯ä¸€æ ·çš„</strong>ã€‚</li></ul></li><li><strong>StatefulSet</strong><ul><li><strong>Pod æœ‰å›ºå®šçš„ç¼–å·ï¼Œæ¯”å¦‚ï¼š</strong><code>mysql-0</code>, <code>mysql-1</code>, <code>mysql-2</code>ã€‚</li><li>**åˆ é™¤ **<code>mysql-1</code> åï¼Œæ–°å»ºçš„ Pod è¿˜æ˜¯ <code>mysql-1</code>ã€‚</li><li><strong>Pod ä¹‹é—´æœ‰é¡ºåºå’Œå”¯ä¸€èº«ä»½ã€‚</strong></li></ul></li></ul><hr><h3 id="3-å­˜å‚¨ï¼ˆStorageï¼‰"><a href="#3-å­˜å‚¨ï¼ˆStorageï¼‰" class="headerlink" title="3. å­˜å‚¨ï¼ˆStorageï¼‰"></a>3. <strong>å­˜å‚¨ï¼ˆStorageï¼‰</strong></h3><ul><li><strong>Deployment</strong><ul><li>**ä¸€èˆ¬é…åˆ **<strong>ä¸´æ—¶å­˜å‚¨ï¼ˆemptyDirï¼‰</strong> æˆ–å…±äº«å­˜å‚¨ã€‚</li><li><strong>Pod åˆ é™¤åæ•°æ®ä¹Ÿä¼šä¸¢å¤±ã€‚</strong></li></ul></li><li><strong>StatefulSet</strong><ul><li>**æ”¯æŒ **<strong>ç¨³å®šçš„æŒä¹…åŒ–å­˜å‚¨ï¼ˆPVCï¼‰</strong>ï¼Œé€šå¸¸ç”± <code>volumeClaimTemplates</code> ç”Ÿæˆã€‚</li><li><strong>å³ä½¿ Pod è¢«åˆ é™¤æˆ–è¿ç§»ï¼Œæ•°æ®ä¾ç„¶ä¼šä¿ç•™ï¼Œå¹¶é‡æ–°æŒ‚è½½åˆ°åŒç¼–å·çš„ Pod ä¸Šã€‚</strong></li></ul></li></ul><hr><h3 id="4-å¯åŠ¨é¡ºåºä¸ä¾èµ–"><a href="#4-å¯åŠ¨é¡ºåºä¸ä¾èµ–" class="headerlink" title="4. å¯åŠ¨é¡ºåºä¸ä¾èµ–"></a>4. <strong>å¯åŠ¨é¡ºåºä¸ä¾èµ–</strong></h3><ul><li><strong>Deployment</strong><ul><li>**Pod å¯ä»¥ **<strong>æ— åºå¹¶è¡Œå¯åŠ¨</strong>ï¼Œå› ä¸ºå®ƒä»¬æ²¡æœ‰ä¾èµ–å…³ç³»ã€‚</li></ul></li><li><strong>StatefulSet</strong><ul><li>**Pod æœ‰é¡ºåºï¼šå…ˆå¯åŠ¨ **<code>pod-0</code>ï¼Œå†å¯åŠ¨ <code>pod-1</code>â€¦â€¦</li><li>**åˆ é™¤æ—¶ä¹Ÿæ˜¯ **<strong>é€†åºåˆ é™¤</strong>ã€‚</li><li>**é€‚åˆéœ€è¦ **<strong>ä¸»ä»/é›†ç¾¤åˆå§‹åŒ–</strong> çš„åœºæ™¯ã€‚</li></ul></li></ul><hr><h3 id="5-ç½‘ç»œæ ‡è¯†ï¼ˆDNSï¼‰"><a href="#5-ç½‘ç»œæ ‡è¯†ï¼ˆDNSï¼‰" class="headerlink" title="5. ç½‘ç»œæ ‡è¯†ï¼ˆDNSï¼‰"></a>5. <strong>ç½‘ç»œæ ‡è¯†ï¼ˆDNSï¼‰</strong></h3><ul><li><strong>Deployment</strong><ul><li><strong>Pod çš„ DNS åå­—æ˜¯éšæœºçš„ï¼Œåªèƒ½é€šè¿‡ Service è®¿é—®ã€‚</strong></li></ul></li><li><strong>StatefulSet</strong><ul><li><strong>æ¯ä¸ª Pod éƒ½æœ‰ç¨³å®šçš„ DNS åå­—ï¼š</strong><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;pod-name&gt;.&lt;service-name&gt;.&lt;namespace&gt;.svc.cluster.local</span><br><span class="line">æ¯”å¦‚ï¼šmysql-0.mysql.default.svc.cluster.local</span><br></pre></td></tr></table></figure></li><li><strong>æ–¹ä¾¿åº”ç”¨ä¹‹é—´ç›´æ¥é€šè¿‡å›ºå®šåŸŸåè®¿é—®ã€‚</strong></li></ul></li></ul><hr><h3 id="6-å…¸å‹ä½¿ç”¨åœºæ™¯"><a href="#6-å…¸å‹ä½¿ç”¨åœºæ™¯" class="headerlink" title="6. å…¸å‹ä½¿ç”¨åœºæ™¯"></a>6. <strong>å…¸å‹ä½¿ç”¨åœºæ™¯</strong></h3><ul><li><strong>Deploymentï¼ˆæ— çŠ¶æ€ï¼‰</strong><ul><li><strong>Web æœåŠ¡ï¼ˆNginxã€Tomcatï¼‰</strong></li><li><strong>API æœåŠ¡</strong></li><li><strong>é™æ€å†…å®¹æœåŠ¡</strong></li></ul></li><li><strong>StatefulSetï¼ˆæœ‰çŠ¶æ€ï¼‰</strong><ul><li><strong>æ•°æ®åº“ï¼ˆMySQLã€Postgresã€MongoDBï¼‰</strong></li><li><strong>åˆ†å¸ƒå¼åè°ƒæœåŠ¡ï¼ˆZooKeeperã€Etcdã€Consulï¼‰</strong></li><li><strong>æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆKafkaã€RabbitMQï¼‰</strong></li></ul></li></ul><hr><h3 id="ğŸ“Œ-æ€»ç»“ä¸€å¥è¯"><a href="#ğŸ“Œ-æ€»ç»“ä¸€å¥è¯" class="headerlink" title="ğŸ“Œ æ€»ç»“ä¸€å¥è¯"></a>ğŸ“Œ æ€»ç»“ä¸€å¥è¯</h3><ul><li>**å¦‚æœåº”ç”¨ **<strong>ä¸ä¾èµ–æŒä¹…å­˜å‚¨ã€Pod èº«ä»½ã€å¯åŠ¨é¡ºåº</strong> â†’ ç”¨ <strong>Deployment</strong>ã€‚</li><li>**å¦‚æœåº”ç”¨ **<strong>éœ€è¦å›ºå®šèº«ä»½ã€ç¨³å®šå­˜å‚¨ã€é¡ºåºå¯åŠ¨</strong> â†’ ç”¨ <strong>StatefulSet</strong>ã€‚</li></ul><h2 id="åã€yamlæ–¹å¼ä»‹ç»deployæœ‰å“ªäº›ç»„ä»¶"><a href="#åã€yamlæ–¹å¼ä»‹ç»deployæœ‰å“ªäº›ç»„ä»¶" class="headerlink" title="åã€yamlæ–¹å¼ä»‹ç»deployæœ‰å“ªäº›ç»„ä»¶"></a>åã€yamlæ–¹å¼ä»‹ç»deployæœ‰å“ªäº›ç»„ä»¶</h2><p>qexo</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‰ç½®å‡†å¤‡</span></span><br><span class="line"><span class="comment"># è®¾ç½®æ±¡ç‚¹</span></span><br><span class="line"><span class="comment"># kubectl taint nodes k8s1 tag=heima:NoExecute</span></span><br><span class="line"><span class="comment"># # å»é™¤æ±¡ç‚¹</span></span><br><span class="line"><span class="comment"># kubectl taint nodes k8s1 tag:NoExecute-</span></span><br><span class="line"><span class="comment"># # ä¾‹å­</span></span><br><span class="line"><span class="comment"># kubectl taint nodes gegewu node-role.kubernetes.io/control-plane:NoSchedule-</span></span><br><span class="line"><span class="comment"># # æŸ¥çœ‹æ±¡ç‚¹è®¾ç½®æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment"># kubectl describe nodes |grep Taints</span></span><br><span class="line"><span class="comment"># # Taints:             tag=heima:NoExecute</span></span><br><span class="line"><span class="comment"># # Taints:             &lt;none&gt;</span></span><br><span class="line"><span class="comment"># # è®¾ç½®èŠ‚ç‚¹æ ‡ç­¾</span></span><br><span class="line"><span class="comment"># kubectl label nodes k8s1 nodeenv=pro</span></span><br><span class="line"><span class="comment"># kubectl get nodes --show-labels</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">qexo</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span>         <span class="comment"># ä¿®æ”¹ä¸º3å‰¯æœ¬</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># å®šä¹‰æ»šåŠ¨æ›´æ–°</span></span><br><span class="line">  <span class="comment"># â— é‡å»ºæ›´æ–° Recreate: åœ¨åˆ›å»ºå‡ºè¯¥labelä¸‹æ–°çš„Podä¹‹å‰ä¼šå…ˆæ€æ‰æ‰€æœ‰å·²å­˜åœ¨çš„Pod</span></span><br><span class="line">  <span class="comment"># â— æ»šåŠ¨æ›´æ–°: å¯ä»¥é€šè¿‡strategyæŒ‡å®šç­–ç•¥ç±»å‹, æ”¯æŒä¸¤ä¸ªå±æ€§</span></span><br><span class="line">  <span class="attr">revisionHistoryLimit:</span> <span class="number">3</span>      <span class="comment"># ä¿ç•™å†å²ç‰ˆæœ¬ï¼Œæ˜¯ä¸ºäº†ç‰ˆæœ¬å›é€€</span></span><br><span class="line">  <span class="attr">paused:</span> <span class="literal">false</span>                <span class="comment"># æš‚åœéƒ¨ç½²ï¼Œé»˜è®¤æ˜¯false å³åˆ›å»ºå®Œdeployç«‹å³å¼€å§‹éƒ¨ç½²pod</span></span><br><span class="line">  <span class="attr">progressDeadlineSeconds:</span> <span class="number">600</span> <span class="comment"># éƒ¨ç½²è¶…æ—¶æ—¶é—´ï¼ˆsï¼‰ï¼Œé»˜è®¤æ˜¯600</span></span><br><span class="line">  <span class="attr">strategy:</span>                    <span class="comment"># ç­–ç•¥</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">RollingUpdate</span>        <span class="comment"># æ»šåŠ¨æ›´æ–°ç­–ç•¥ æˆ– Recreate é‡å»ºæ›´æ–°</span></span><br><span class="line">    <span class="attr">rollingUpdate:</span>             <span class="comment"># æ»šåŠ¨æ›´æ–°</span></span><br><span class="line">      <span class="attr">maxSurge:</span> <span class="number">25</span><span class="string">%</span>            <span class="comment"># åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œæœ€å¤šå¯ä»¥å¢åŠ çš„ Pod æ•°é‡</span></span><br><span class="line">      <span class="attr">maxUnavailable:</span> <span class="number">30</span><span class="string">%</span>      <span class="comment"># æœ€å¤§ä¸å¯ç”¨çŠ¶æ€çš„ Pod çš„æœ€å¤§å€¼ï¼Œå¯ä»¥ä¸ºç™¾åˆ†æ¯”ï¼Œä¹Ÿå¯ä»¥ä¸ºæ•´æ•°</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># é‡å»ºæ›´æ–°ï¼ˆå¦ä¸€ç§æ–¹å¼ï¼‰</span></span><br><span class="line">  <span class="comment"># strategy:</span></span><br><span class="line">  <span class="comment">#   type: Recreate</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">qexo</span>   <span class="comment"># å¿…é¡»ä¸ .spec.template.metadata.labels åŒ¹é…</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">qexo</span> <span class="comment"># å¿…é¡»ä¸ .spec.selector.matchLabels åŒ¹é…</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qexo</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.6.0</span> </span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8000</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">qexo</span></span><br><span class="line">        <span class="comment"># command: [&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;while true;do /bin/echo $(date +%T);sleep 60; done;&quot;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¯å¢ƒå˜é‡</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;username&quot;</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;admin&quot;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;password&quot;</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;123456&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># èµ„æºé…é¢</span></span><br><span class="line">        <span class="attr">resources:</span></span><br><span class="line">          <span class="attr">limits:</span>    <span class="comment"># é™åˆ¶èµ„æºï¼ˆä¸Šé™ï¼‰</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;2&quot;</span> <span class="comment"># CPUé™åˆ¶ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;10Gi&quot;</span> <span class="comment"># å†…å­˜é™åˆ¶</span></span><br><span class="line">          <span class="attr">requests:</span>        <span class="comment"># è¯·æ±‚èµ„æºï¼ˆä¸‹é™ï¼‰</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;1&quot;</span>       <span class="comment"># CPUè¯·æ±‚ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;1000Mi&quot;</span> <span class="comment"># å†…å­˜è¯·æ±‚ </span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç£ç›˜æŒ‚è½½</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qexo-volume</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">/app/db</span>   <span class="comment"># æŒ‚è½½åˆ°ç›®å½•è€Œä¸æ˜¯å•ä¸ªæ–‡ä»¶</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‹¾å­å‡½æ•°</span></span><br><span class="line">        <span class="comment"># â— post startï¼šå®¹å™¨åˆ›å»ºä¹‹åæ‰§è¡Œï¼Œå¦‚æœå¤±è´¥äº†ä¼šé‡å¯å®¹å™¨</span></span><br><span class="line">        <span class="comment"># â— pre stop ï¼šå®¹å™¨ç»ˆæ­¢ä¹‹å‰æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæˆä¹‹åå®¹å™¨å°†æˆåŠŸç»ˆæ­¢ï¼Œåœ¨å…¶å®Œæˆä¹‹å‰ä¼šé˜»å¡åˆ é™¤å®¹å™¨çš„æ“ä½œ</span></span><br><span class="line">        <span class="comment"># é’©å­å¤„ç†å™¨æ”¯æŒä½¿ç”¨ä¸‹é¢ä¸‰ç§æ–¹å¼å®šä¹‰åŠ¨ä½œï¼š</span></span><br><span class="line">        <span class="comment"># â— Execå‘½ä»¤ï¼šåœ¨å®¹å™¨å†…æ‰§è¡Œä¸€æ¬¡å‘½ä»¤</span></span><br><span class="line">        <span class="comment"># â— ç›¸å½“äº docker ä¸­ docker exec -it centos ls è¿™æ ·çš„å‘½ä»¤</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># lifecycle:</span></span><br><span class="line">        <span class="comment">#   postStart:</span></span><br><span class="line">        <span class="comment">#     exec: # åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œä¿®æ”¹æ‰nginxçš„é»˜è®¤é¦–é¡µå†…å®¹</span></span><br><span class="line">        <span class="comment">#       command: [&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;echo postStart... &gt; /usr/share/nginx/html/index.html&quot;]</span></span><br><span class="line">        <span class="comment">#   preStop:</span></span><br><span class="line">        <span class="comment">#     exec: # åœ¨å®¹å™¨åœæ­¢ä¹‹å‰åœæ­¢nginxæœåŠ¡</span></span><br><span class="line">        <span class="comment">#       command: [&quot;/usr/sbin/nginx&quot;,&quot;-s&quot;,&quot;quit&quot;]  </span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å®¹å™¨æ¢é’ˆ</span></span><br><span class="line">        <span class="comment"># â— liveness probesï¼šå­˜æ´»æ€§æ¢é’ˆï¼Œç”¨äºæ£€æµ‹åº”ç”¨å®ä¾‹æ˜¯å¦å­˜æ´»ï¼Œå¦‚æœä¸æ˜¯ï¼Œk8sä¼šé‡å¯å®¹å™¨</span></span><br><span class="line">        <span class="comment"># â— readiness probesï¼šå°±ç»ªæ€§æ¢é’ˆï¼Œç”¨äºæ£€æµ‹å®ä¾‹æ˜¯å¦å¯ä»¥æ¥æ”¶è¯·æ±‚ï¼Œå¦‚æœä¸èƒ½ï¼Œk8sä¸ä¼šè½¬å‘æµé‡</span></span><br><span class="line">        <span class="comment"># â— livenessProbe å†³å®šæ˜¯å¦é‡å¯å®¹å™¨ï¼ŒreadinessProbe å†³å®šæ˜¯å¦å°†è¯·æ±‚è½¬å‘ç»™å®¹å™¨</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># ä¸Šé¢ä¸¤ç§æ¢é’ˆæ”¯æŒä¸‰ç§æ¢æµ‹æ–¹å¼ï¼š</span></span><br><span class="line">        <span class="comment"># â— Execå‘½ä»¤ã€â— HTTPè¯·æ±‚ã€â— TCP Socket</span></span><br><span class="line">        <span class="comment"># livenessProbe:</span></span><br><span class="line">        <span class="comment">#   httpGet:       # å®é™…å°±æ˜¯è®¿é—® http://127.0.0.1:8000/</span></span><br><span class="line">        <span class="comment">#     scheme: HTTP # åè®®ï¼Œhttp æˆ– https</span></span><br><span class="line">        <span class="comment">#     port: 8000   # ç«¯å£å·</span></span><br><span class="line">        <span class="comment">#     path: /      # URIåœ°å€</span></span><br><span class="line"></span><br><span class="line">        <span class="attr">livenessProbe:</span></span><br><span class="line">          <span class="attr">tcpSocket:</span></span><br><span class="line">            <span class="attr">port:</span> <span class="number">8000</span> <span class="comment"># å°è¯•è®¿é—®8080ç«¯å£</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># å®¿ä¸»æœºæŒ‚è½½ç›®å½•ï¼ˆä¸å­˜åœ¨å°±åˆ›å»ºï¼‰</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qexo-volume</span></span><br><span class="line">        <span class="attr">hostPath:</span> </span><br><span class="line">          <span class="attr">path:</span> <span class="string">/opt/qexo/app/db</span>    <span class="comment"># å®¿ä¸»æœºç›®å½•  </span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span>              </span><br><span class="line"></span><br><span class="line">      <span class="comment"># æ±¡ç‚¹ä¸å®¹å¿</span></span><br><span class="line">      <span class="comment"># â— PreferNoScheduleï¼šå°½é‡é¿å…è°ƒåº¦ï¼Œä½†éå¼ºåˆ¶</span></span><br><span class="line">      <span class="comment"># â— NoScheduleï¼šä¸ä¼šè°ƒåº¦åˆ°å¸¦æ­¤æ±¡ç‚¹çš„èŠ‚ç‚¹ï¼Œä½†å·²æœ‰Podä¸å—å½±å“</span></span><br><span class="line">      <span class="comment"># â— NoExecuteï¼šä¸ä¼šè°ƒåº¦ï¼Œå¹¶é©±é€å·²æœ‰Pod</span></span><br><span class="line">      <span class="comment"># å¦‚æœæ±¡ç‚¹çš„æ•ˆæœæ˜¯NoExecuteï¼Œéœ€åœ¨å®¹å¿è§„åˆ™ä¸­è®¾ç½® effect: &quot;NoExecute&quot;</span></span><br><span class="line">      <span class="comment"># ä¹Ÿå¯ä»¥çœç•¥ effectï¼Œç”¨ operator: &quot;Exists&quot; å®¹å¿ä»»æ„æ•ˆæœ</span></span><br><span class="line">      <span class="attr">tolerations:</span>    </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">&quot;tag&quot;</span></span><br><span class="line">        <span class="attr">operator:</span> <span class="string">&quot;Exists&quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># äº²å’Œæ€§è®¾ç½®(è½¯é™åˆ¶)</span></span><br><span class="line">      <span class="attr">affinity:</span></span><br><span class="line">        <span class="attr">nodeAffinity:</span></span><br><span class="line">          <span class="attr">preferredDuringSchedulingIgnoredDuringExecution:</span> <span class="comment"># è½¯é™åˆ¶</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">weight:</span> <span class="number">1</span></span><br><span class="line">            <span class="attr">preference:</span></span><br><span class="line">              <span class="attr">matchExpressions:</span> <span class="comment"># åŒ¹é… nodeenv æ ‡ç­¾çš„å€¼åœ¨ [&quot;pro&quot;,&quot;yyy&quot;] ä¸­çš„èŠ‚ç‚¹</span></span><br><span class="line">              <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">nodeenv</span></span><br><span class="line">                <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">                <span class="attr">values:</span> [<span class="string">&quot;pro&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br><span class="line"></span><br><span class="line">      <span class="comment"># äº²å’Œæ€§è®¾ç½®(ç¡¬é™åˆ¶)</span></span><br><span class="line">      <span class="comment"># affinity:</span></span><br><span class="line">      <span class="comment">#   podAffinity: # è®¾ç½®podäº²å’Œæ€§</span></span><br><span class="line">      <span class="comment">#     requiredDuringSchedulingIgnoredDuringExecution: # ç¡¬é™åˆ¶</span></span><br><span class="line">      <span class="comment">#     - labelSelector:</span></span><br><span class="line">      <span class="comment">#         matchExpressions:    # åŒ¹é…podenvçš„å€¼åœ¨ [&quot;xxx&quot;,&quot;yyy&quot;] çš„æ ‡ç­¾</span></span><br><span class="line">      <span class="comment">#         - key: podenv</span></span><br><span class="line">      <span class="comment">#           operator: In</span></span><br><span class="line">      <span class="comment">#           values: [&quot;xxx&quot;,&quot;yyy&quot;]</span></span><br><span class="line">      <span class="comment">#       topologyKey: kubernetes.io/hostname  # åŸºäºèŠ‚ç‚¹è°ƒåº¦</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment"># æš´éœ²qexoç«¯å£</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">qexo-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">qexo</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8000</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8000</span></span><br><span class="line">  <span class="attr">sessionAffinity:</span> <span class="string">ClientIP</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span> <span class="comment"># å°†æœåŠ¡æš´éœ²ä¸º NodePort ç±»å‹</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>nginx</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‰ç½®å‡†å¤‡</span></span><br><span class="line"><span class="comment"># è®¾ç½®æ±¡ç‚¹</span></span><br><span class="line"><span class="comment"># kubectl taint nodes k8s1 tag=heima:NoExecute</span></span><br><span class="line"><span class="comment"># # å»é™¤æ±¡ç‚¹</span></span><br><span class="line"><span class="comment"># kubectl taint nodes k8s1 tag:NoExecute-</span></span><br><span class="line"><span class="comment"># # ä¾‹å­</span></span><br><span class="line"><span class="comment"># kubectl taint nodes gegewu node-role.kubernetes.io/control-plane:NoSchedule-</span></span><br><span class="line"><span class="comment"># # æŸ¥çœ‹æ±¡ç‚¹è®¾ç½®æ˜¯å¦æˆåŠŸ</span></span><br><span class="line"><span class="comment"># kubectl describe nodes |grep Taints</span></span><br><span class="line"><span class="comment"># # Taints:             tag=heima:NoExecute</span></span><br><span class="line"><span class="comment"># # Taints:             &lt;none&gt;</span></span><br><span class="line"><span class="comment"># # è®¾ç½®èŠ‚ç‚¹æ ‡ç­¾</span></span><br><span class="line"><span class="comment"># kubectl label nodes k8s1 nodeenv=pro</span></span><br><span class="line"><span class="comment"># kubectl get nodes --show-labels</span></span><br><span class="line"></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span>  <span class="comment"># ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span>     <span class="comment"># ç±»å‹</span></span><br><span class="line"><span class="attr">metadata:</span>            <span class="comment"># æºæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">deploy-nginx</span> <span class="comment"># å½“å‰deploymentæ‰€å±çš„åå­—</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>     <span class="comment"># å‘½åç©ºé—´</span></span><br><span class="line">  <span class="attr">labels:</span>            <span class="comment"># å½“å‰deployçš„æ ‡ç­¾</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">&quot;label-test&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤æ ç›®é…ç½®æ»šåŠ¨æ›´æ–°é…ç½®</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span>        <span class="comment"># å®šä¹‰å‰¯æœ¬æ•°</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># å®šä¹‰æ»šåŠ¨æ›´æ–°</span></span><br><span class="line">  <span class="comment"># â— é‡å»ºæ›´æ–°Recreate  åœ¨åˆ›å»ºå‡ºè¯¥labelä¸‹æ–°çš„Podä¹‹å‰ä¼šå…ˆæ€æ‰æ‰€æœ‰å·²å­˜åœ¨çš„Pod</span></span><br><span class="line">  <span class="comment"># â— æ»šåŠ¨æ›´æ–°,å¯ä»¥é€šè¿‡strategyæŒ‡å®šç­–ç•¥ç±»å‹,æ”¯æŒä¸¤ä¸ªå±æ€§:</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">revisionHistoryLimit:</span> <span class="number">3</span>      <span class="comment"># ä¿ç•™å†å²ç‰ˆæœ¬ æ˜¯ä¸ºäº†ç‰ˆæœ¬å›é€€</span></span><br><span class="line">  <span class="attr">paused:</span> <span class="literal">false</span>                <span class="comment"># æš‚åœéƒ¨ç½²ï¼Œé»˜è®¤æ˜¯false å³åˆ›å»ºå®Œdeployç«‹å³å¼€å§‹éƒ¨ç½²pod</span></span><br><span class="line">  <span class="attr">progressDeadlineSeconds:</span> <span class="number">600</span> <span class="comment"># éƒ¨ç½²è¶…æ—¶æ—¶é—´ï¼ˆsï¼‰ï¼Œé»˜è®¤æ˜¯600</span></span><br><span class="line">  <span class="attr">strategy:</span>                    <span class="comment"># ç­–ç•¥</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">RollingUpdate</span>        <span class="comment"># æ»šåŠ¨æ›´æ–°ç­–ç•¥ æˆ–Recreateé‡å»ºæ›´æ–°</span></span><br><span class="line">    <span class="attr">rollingUpdate:</span>             <span class="comment"># æ»šåŠ¨æ›´æ–°</span></span><br><span class="line">      <span class="comment"># è¿è§„è¯æ±‡: 30%  # æœ€å¤§é¢å¤–å¯ä»¥å­˜åœ¨çš„å‰¯æœ¬æ•°ï¼Œå¯ä»¥ä¸ºç™¾åˆ†æ¯”ï¼Œä¹Ÿå¯ä»¥ä¸ºæ•´æ•°</span></span><br><span class="line">      <span class="attr">maxSurge:</span> <span class="number">25</span><span class="string">%</span>            <span class="comment"># åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ï¼Œæœ€å¤šå¯ä»¥å¢åŠ çš„ Pod æ•°é‡</span></span><br><span class="line">      <span class="attr">maxUnavailable:</span> <span class="number">30</span><span class="string">%</span>      <span class="comment"># æœ€å¤§ä¸å¯ç”¨çŠ¶æ€çš„ Pod çš„æœ€å¤§å€¼ï¼Œå¯ä»¥ä¸ºç™¾åˆ†æ¯”ï¼Œä¹Ÿå¯ä»¥ä¸ºæ•´æ•°</span></span><br><span class="line">  </span><br><span class="line">  <span class="comment"># é‡å»ºæ›´æ–°</span></span><br><span class="line">  <span class="comment">#strategy: # ç­–ç•¥</span></span><br><span class="line">    <span class="comment">#type: Recreate # é‡å»ºæ›´æ–°</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">selector:</span>        <span class="comment"># æ ‡ç­¾é€‰æ‹©å™¨ é€‰æ‹©æ ‡ç­¾è¿›è¡Œæ“ä½œ</span></span><br><span class="line">    <span class="attr">matchLabels:</span>   <span class="comment"># é€‰æ‹©nginxæ ‡ç­¾</span></span><br><span class="line">      <span class="attr">version:</span> <span class="string">label-test</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">template:</span>                   <span class="comment"># ä»¥ä¸‹ä¸ºpod æ¨¡æ¿</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span>                 <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">        <span class="attr">version:</span> <span class="string">label-test</span>   <span class="comment"># å®šä¹‰æ ‡ç­¾ä¸ºlabel-test</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="comment"># é•œåƒä¿¡æ¯ç­‰</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-test</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span> <span class="comment"># ç”¨äºè®¾ç½®é•œåƒæ‹‰å–ç­–ç•¥</span></span><br><span class="line">        <span class="comment"># cmdå˜é‡ä¸ç«¯å£</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">        <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;while true;do /bin/echo $(date +%T);sleep 60; done;&quot;</span>]</span><br><span class="line">        <span class="attr">env:</span>                     <span class="comment"># è®¾ç½®ç¯å¢ƒå˜é‡åˆ—è¡¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;username&quot;</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;admin&quot;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;password&quot;</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;123456&quot;</span></span><br><span class="line">        <span class="comment"># èµ„æºé…é¢</span></span><br><span class="line">        <span class="attr">resources:</span></span><br><span class="line">          <span class="attr">limits:</span>    <span class="comment"># é™åˆ¶èµ„æºï¼ˆä¸Šé™ï¼‰</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;2&quot;</span> <span class="comment"># CPUé™åˆ¶ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;10Gi&quot;</span> <span class="comment"># å†…å­˜é™åˆ¶</span></span><br><span class="line">          <span class="attr">requests:</span>        <span class="comment"># è¯·æ±‚èµ„æºï¼ˆä¸‹é™ï¼‰</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;1&quot;</span>       <span class="comment"># CPUé™åˆ¶ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;10Mi&quot;</span> <span class="comment"># å†…å­˜é™åˆ¶</span></span><br><span class="line">        <span class="comment"># å‹¾å­å‡½æ•°</span></span><br><span class="line">        <span class="attr">lifecycle:</span></span><br><span class="line">          <span class="attr">postStart:</span></span><br><span class="line">            <span class="attr">exec:</span> <span class="comment"># åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œä¿®æ”¹æ‰nginxçš„é»˜è®¤é¦–é¡µå†…å®¹</span></span><br><span class="line">              <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;echo postStart... &gt; /usr/share/nginx/html/index.html&quot;</span>]</span><br><span class="line">          <span class="attr">preStop:</span></span><br><span class="line">            <span class="attr">exec:</span> <span class="comment"># åœ¨å®¹å™¨åœæ­¢ä¹‹å‰åœæ­¢nginxæœåŠ¡</span></span><br><span class="line">              <span class="attr">command:</span> [<span class="string">&quot;/usr/sbin/nginx&quot;</span>,<span class="string">&quot;-s&quot;</span>,<span class="string">&quot;quit&quot;</span>]</span><br><span class="line"></span><br><span class="line">      <span class="comment"># nodeName: node1  # å®šå‘è°ƒåº¦</span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># â— PreferNoScheduleï¼škuberneteså°†å°½é‡é¿å…æŠŠPodè°ƒåº¦åˆ°å…·æœ‰è¯¥æ±¡ç‚¹çš„Nodeä¸Šï¼Œé™¤éæ²¡æœ‰å…¶ä»–èŠ‚ç‚¹å¯è°ƒåº¦</span></span><br><span class="line">      <span class="comment"># â— NoScheduleï¼škuberneteså°†ä¸ä¼šæŠŠPodè°ƒåº¦åˆ°å…·æœ‰è¯¥æ±¡ç‚¹çš„Nodeä¸Šï¼Œä½†ä¸ä¼šå½±å“å½“å‰Nodeä¸Šå·²å­˜åœ¨çš„Pod</span></span><br><span class="line">      <span class="comment"># â— NoExecuteï¼škuberneteså°†ä¸ä¼šæŠŠPodè°ƒåº¦åˆ°å…·æœ‰è¯¥æ±¡ç‚¹çš„Nodeä¸Šï¼ŒåŒæ—¶ä¹Ÿä¼šå°†Nodeä¸Šå·²å­˜åœ¨çš„Podé©±ç¦»</span></span><br><span class="line">      <span class="comment"># tag=heima:NoExecute</span></span><br><span class="line">      <span class="comment"># å¦‚æœæ±¡ç‚¹çš„æ•ˆæœæ˜¯NoExecuteï¼Œé‚£ä¹ˆæ‚¨éœ€è¦åœ¨å®¹å¿è§„åˆ™ä¸­è®¾ç½®effect: &quot;NoExecute&quot;ã€‚</span></span><br><span class="line">      <span class="comment"># å¦‚æœæ±¡ç‚¹çš„æ•ˆæœä¸ç¡®å®šï¼Œä¹Ÿå¯ä»¥çœç•¥effectå­—æ®µï¼Œç”¨operator: &quot;Exists&quot;æ¥å®¹å¿ä»»ä½•æ•ˆæœã€‚ä¾‹å¦‚ï¼š</span></span><br><span class="line"></span><br><span class="line">      <span class="attr">tolerations:</span>        <span class="comment"># æ·»åŠ å®¹å¿</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">&quot;tag&quot;</span>        <span class="comment"># è¦å®¹å¿çš„æ±¡ç‚¹çš„key</span></span><br><span class="line">        <span class="attr">operator:</span> <span class="string">&quot;Equal&quot;</span> <span class="comment"># æ“ä½œç¬¦ï¼ˆç­‰äºæ“ä½œç¬¦ï¼‰</span></span><br><span class="line">        <span class="attr">value:</span> <span class="string">&quot;heima&quot;</span>    <span class="comment"># å®¹å¿çš„æ±¡ç‚¹çš„value</span></span><br><span class="line">        <span class="attr">effect:</span> <span class="string">&quot;NoExecute&quot;</span>   <span class="comment"># æ·»åŠ å®¹å¿çš„è§„åˆ™ï¼Œè¿™é‡Œå¿…é¡»å’Œæ ‡è®°çš„æ±¡ç‚¹è§„åˆ™ç›¸åŒ</span></span><br><span class="line">  </span><br><span class="line">      <span class="comment"># å®¹å¿ä»»ä½•æ•ˆæœ</span></span><br><span class="line">      <span class="comment">#- key: &quot;tag&quot;</span></span><br><span class="line">      <span class="comment">#  operator: &quot;Exists&quot;</span></span><br><span class="line">      <span class="comment"># äº²å’Œæ€§è®¾ç½®(è½¯é™åˆ¶)</span></span><br><span class="line">  </span><br><span class="line">      <span class="attr">affinity:</span></span><br><span class="line">        <span class="attr">nodeAffinity:</span> <span class="comment"># è®¾ç½®nodeäº²å’Œæ€§</span></span><br><span class="line">          <span class="attr">preferredDuringSchedulingIgnoredDuringExecution:</span> <span class="comment"># è½¯é™åˆ¶</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">weight:</span> <span class="number">1</span></span><br><span class="line">            <span class="attr">preference:</span></span><br><span class="line">              <span class="attr">matchExpressions:</span> <span class="comment"># åŒ¹é…envçš„å€¼åœ¨[&quot;xxx&quot;,&quot;yyy&quot;]ä¸­çš„æ ‡ç­¾(å½“å‰ç¯å¢ƒæ²¡æœ‰)</span></span><br><span class="line">              <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">nodeenv</span></span><br><span class="line">                <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">                <span class="attr">values:</span> [<span class="string">&quot;pro&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br><span class="line"></span><br><span class="line">      <span class="comment"># # äº²å’Œæ€§è®¾ç½®(ç¡¬é™åˆ¶)</span></span><br><span class="line">      <span class="comment"># affinity:</span></span><br><span class="line">      <span class="comment">#   podAffinity: # è®¾ç½®podäº²å’Œæ€§</span></span><br><span class="line">      <span class="comment">#     requiredDuringSchedulingIgnoredDuringExecution: # ç¡¬é™åˆ¶</span></span><br><span class="line">      <span class="comment">#     - labelSelector:</span></span><br><span class="line">      <span class="comment">#         matchExpressions:    # åŒ¹é…envçš„å€¼åœ¨[&quot;xxx&quot;,&quot;yyy&quot;]ä¸­çš„æ ‡ç­¾</span></span><br><span class="line">      <span class="comment">#         - key: podenv</span></span><br><span class="line">      <span class="comment">#           operator: In</span></span><br><span class="line">      <span class="comment">#           values: [&quot;xxx&quot;,&quot;yyy&quot;]</span></span><br><span class="line">      <span class="comment">#       topologyKey: kubernetes.io/hostname  # åŸºäºèŠ‚ç‚¹è°ƒåº¦</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>~</p>]]></content>
      
      
      <categories>
          
          <category> æ˜æœˆç­– </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ˜æœˆç­– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openstackå¸¸ç”¨å‘½ä»¤</title>
      <link href="/2025/08/04/openstack%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2025/08/04/openstack%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="openstackå¸¸ç”¨å‘½ä»¤"><a href="#openstackå¸¸ç”¨å‘½ä»¤" class="headerlink" title="openstackå¸¸ç”¨å‘½ä»¤"></a>openstackå¸¸ç”¨å‘½ä»¤</h1><h2 id="â‘ ã€aggregate-ç§»åŸŸ"><a href="#â‘ ã€aggregate-ç§»åŸŸ" class="headerlink" title="â‘ ã€aggregate ç§»åŸŸ"></a>â‘ ã€<code>aggregate</code> ç§»åŸŸ</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">```bash</span><br><span class="line">ä¸€ã€ç§»åŸŸ</span><br><span class="line">3.0ç¯å¢ƒ</span><br><span class="line">$ nova aggregate-list</span><br><span class="line">$ nova aggregate-remove-host &lt;aggregate-id&gt; &lt;hostname&gt;</span><br><span class="line">$ nova aggregate-add-host &lt;aggregate-id&gt; &lt;hostname&gt;</span><br></pre></td></tr></table></figure><h2 id="â‘¡ã€migrate-å†·è¿ç§»ã€çƒ­è¿ç§»"><a href="#â‘¡ã€migrate-å†·è¿ç§»ã€çƒ­è¿ç§»" class="headerlink" title="â‘¡ã€migrate å†·è¿ç§»ã€çƒ­è¿ç§»"></a>â‘¡ã€<code>migrate</code> å†·è¿ç§»ã€çƒ­è¿ç§»</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ã€å†·è¿ç§»</span></span><br><span class="line">å˜é‡è§£é‡Š</span><br><span class="line">&lt;server&gt; æ˜¯äº‘ä¸»æœºuuid</span><br><span class="line">&lt;host&gt;   ç›®çš„å®¿ä¸»æœºåç§°</span><br><span class="line"></span><br><span class="line">3.0ç¯å¢ƒ</span><br><span class="line">$ nova migrate --host &lt;host&gt; &lt;server&gt;</span><br><span class="line">$ nova resize-confirm &lt;server&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#ã€çƒ­è¿ç§»</span></span><br><span class="line">&lt;server&gt; æ˜¯äº‘ä¸»æœºuuid</span><br><span class="line">&lt;host&gt;   ç›®çš„å®¿ä¸»æœºåç§°</span><br><span class="line">3.0ç¯å¢ƒ</span><br><span class="line">$ nova live-migration &lt;server&gt; &lt;host&gt;</span><br><span class="line">$ nova migration-list --instance-uuid &lt;uuid&gt; --<span class="built_in">limit</span> 5</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="â‘¢ã€get-vnc-console-è·å–vncé“¾æ¥"><a href="#â‘¢ã€get-vnc-console-è·å–vncé“¾æ¥" class="headerlink" title="â‘¢ã€get-vnc-console è·å–vncé“¾æ¥"></a>â‘¢ã€<code>get-vnc-console</code> è·å–vncé“¾æ¥</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è·å–vncé“¾æ¥</span></span><br><span class="line">3.0ç¯å¢ƒ</span><br><span class="line">$ nova get-vnc-console &lt;vm_uuid&gt; novnc</span><br></pre></td></tr></table></figure><h2 id="â‘£ã€floating-vnetops-æ ¹æ®å…¬ç½‘IPæŸ¥è¯¢äº‘ä¸»æœºid"><a href="#â‘£ã€floating-vnetops-æ ¹æ®å…¬ç½‘IPæŸ¥è¯¢äº‘ä¸»æœºid" class="headerlink" title="â‘£ã€floating  vnetops æ ¹æ®å…¬ç½‘IPæŸ¥è¯¢äº‘ä¸»æœºid"></a>â‘£ã€<code>floating  vnetops </code>æ ¹æ®<code>å…¬ç½‘IP</code>æŸ¥è¯¢äº‘ä¸»æœºid</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®å…¬ç½‘IPæŸ¥è¯¢äº‘ä¸»æœºid</span></span><br><span class="line">3.0ç¯å¢ƒ</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å…¬ç½‘IP 118.183.216.89ä¸ºå…¬ç½‘IP</span></span><br><span class="line">$ openstack port list --fixed-ip ip-address=118.183.216.89  </span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¤–ç½‘IPè¯¦æƒ…a5bba6f4-27d8-4b8a-8a7e-38f6b4dfd7a1 ä¸ºä¸Šä¸€éƒ¨ä¸­æŸ¥è¯¢å‡ºçš„ID</span></span><br><span class="line">$ openstack port show a5bba6f4-27d8-4b8a-8a7e-38f6b4dfd7a1 </span><br><span class="line"><span class="comment"># æ ¹æ®å…¬ç½‘IPæŸ¥è¯¢ç»‘å®šçš„å†…ç½‘IP 118.183.216.89ä¸ºå…¬ç½‘IP</span></span><br><span class="line">$ openstack floating ip show 118.183.216.89  |grep  device_id </span><br><span class="line">$ æ­¤æ—¶å‡ºç°çš„device_idå°±æ˜¯äº‘ä¸»æœº<span class="built_in">id</span>  ï¼ˆä¸ä¸€å®šå‡†ç¡®ï¼‰</span><br></pre></td></tr></table></figure><h2 id="â‘¤ã€novaæ ¹æ®å†…ç½‘IPæŸ¥è¯¢äº‘ä¸»æœºid"><a href="#â‘¤ã€novaæ ¹æ®å†…ç½‘IPæŸ¥è¯¢äº‘ä¸»æœºid" class="headerlink" title="â‘¤ã€novaæ ¹æ®å†…ç½‘IPæŸ¥è¯¢äº‘ä¸»æœºid"></a>â‘¤ã€<code>nova</code>æ ¹æ®<code>å†…ç½‘IP</code>æŸ¥è¯¢äº‘ä¸»æœºid</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®å†…ç½‘ipæŸ¥è¯¢äº‘ä¸»æœºid</span></span><br><span class="line"><span class="comment"># 3.0</span></span><br><span class="line">nova list --all --ip 172.22.0.251</span><br></pre></td></tr></table></figure><h2 id="â‘¥ã€res-assess-py-æŸ¥çœ‹å¯¹åº”è§„æ ¼å¯ä»¥å¼€é€šå¤šå°‘è™šæ‹Ÿæœº"><a href="#â‘¥ã€res-assess-py-æŸ¥çœ‹å¯¹åº”è§„æ ¼å¯ä»¥å¼€é€šå¤šå°‘è™šæ‹Ÿæœº" class="headerlink" title="â‘¥ã€res_assess.py æŸ¥çœ‹å¯¹åº”è§„æ ¼å¯ä»¥å¼€é€šå¤šå°‘è™šæ‹Ÿæœº"></a>â‘¥ã€<code>res_assess.py</code> æŸ¥çœ‹å¯¹åº”è§„æ ¼å¯ä»¥å¼€é€šå¤šå°‘è™šæ‹Ÿæœº</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å¯¹åº”è§„æ ¼å¯ä»¥å¼€é€šå¤šå°‘è™šæ‹Ÿæœº</span></span><br><span class="line">3.0ç¯å¢ƒ</span><br><span class="line">$  python res_assess.py &lt;flavorID&gt; &lt;zonename&gt;</span><br></pre></td></tr></table></figure><h2 id="â‘¨ã€ZONE-ã€aggregate-listæŸ¥çœ‹ï¼ˆä¸»æœºèšåˆï¼‰ä¸‹é¢çš„è®¡ç®—èŠ‚ç‚¹"><a href="#â‘¨ã€ZONE-ã€aggregate-listæŸ¥çœ‹ï¼ˆä¸»æœºèšåˆï¼‰ä¸‹é¢çš„è®¡ç®—èŠ‚ç‚¹" class="headerlink" title="â‘¨ã€ZONE ã€aggregate-listæŸ¥çœ‹ï¼ˆä¸»æœºèšåˆï¼‰ä¸‹é¢çš„è®¡ç®—èŠ‚ç‚¹"></a>â‘¨ã€<code>ZONE ã€aggregate-list</code>æŸ¥çœ‹ï¼ˆä¸»æœºèšåˆï¼‰ä¸‹é¢çš„è®¡ç®—èŠ‚ç‚¹</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ä¸»æœºèšåˆä¸‹é¢çš„è®¡ç®—èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœåŠ¡æ‰¾åˆ°showä¸­</span></span><br><span class="line">nova  service-list</span><br><span class="line"><span class="comment"># dockeréƒ¨ç½²çš„ç™»å½•æ‰§è¡Œè„šæœ¬æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ</span></span><br><span class="line">docker <span class="built_in">exec</span> -it nova_api  bash</span><br><span class="line"><span class="comment"># æŸ¥çœ‹è®¡ç®—åˆ†ç»„</span></span><br><span class="line">nova aggregate-list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹s3ç±»å‹ä¸‹é¢çš„è®¡ç®—èŠ‚ç‚¹</span></span><br><span class="line">nova aggregate-show 14</span><br></pre></td></tr></table></figure><h2 id="å„ä¸ªç»„ä»¶å‘½ä»¤è¯¦ç»†æ€»ç»“"><a href="#å„ä¸ªç»„ä»¶å‘½ä»¤è¯¦ç»†æ€»ç»“" class="headerlink" title="å„ä¸ªç»„ä»¶å‘½ä»¤è¯¦ç»†æ€»ç»“"></a>å„ä¸ªç»„ä»¶å‘½ä»¤è¯¦ç»†æ€»ç»“</h2><p>æ¦‚è§ˆï¼š</p><ul><li>openstack domain list   æŸ¥çœ‹ç›®å‰çš„åŸŸ</li><li>openstack domain create â€“description â€œAn Example Domainâ€ example  åˆ›å»ºæ–°åŸŸ</li><li>openstack project create â€“domain default â€“description â€œDemo Projectâ€ myproject   åˆ›å»ºæ™®é€šé¡¹ç›®</li></ul><h3 id="é›¶ã€åˆ›å»ºserviceé¡¹ç›®ã€user-è§’è‰²ã€åŸŸï¼Œdefault-åŸŸé»˜è®¤å·²ç»å­˜åœ¨"><a href="#é›¶ã€åˆ›å»ºserviceé¡¹ç›®ã€user-è§’è‰²ã€åŸŸï¼Œdefault-åŸŸé»˜è®¤å·²ç»å­˜åœ¨" class="headerlink" title="é›¶ã€åˆ›å»ºserviceé¡¹ç›®ã€user è§’è‰²ã€åŸŸï¼Œdefault åŸŸé»˜è®¤å·²ç»å­˜åœ¨"></a>é›¶ã€åˆ›å»º<code>service</code>é¡¹ç›®ã€<code>user </code>è§’è‰²ã€åŸŸï¼Œ<code>default </code>åŸŸé»˜è®¤å·²ç»å­˜åœ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç›®å‰çš„åŸŸ</span></span><br><span class="line">openstack domain list</span><br><span class="line"><span class="comment"># åˆ›å»ºæ–°åŸŸ exampleï¼Œï¼ˆä»…ç”¨äºæµ‹è¯•ï¼Œå¯ä»¥ä¸åˆ›å»ºï¼‰ã€‚</span></span><br><span class="line">openstack domain create --description <span class="string">&quot;An Example Domain&quot;</span> example </span><br><span class="line">openstack domain list</span><br></pre></td></tr></table></figure><p>åˆ›å»ºæ™®é€šé¡¹ç›® myprojectï¼ˆä»…ç”¨äºæµ‹è¯•ï¼Œå¯ä»¥ä¸åˆ›å»ºï¼‰ã€‚</p><p>ä¸€ä¸ªç§Ÿæˆ·åœ¨ OpenStack é‡Œå°±æ˜¯ä¸€ä¸ªé¡¹ç›®ï¼Œåˆ›å»ºç”¨æˆ·æ—¶å¿…é¡»å…ˆè¦æœ‰ç§Ÿæˆ·ï¼ˆé¡¹ç›®ï¼‰ï¼ŒåŒæ—¶è¿˜éœ€è¦ä¸€ä¸ªèƒ½åˆ†é…ç»™è¯¥ç”¨æˆ·çš„è§’è‰²ï¼Œè¿™æ ·åˆ›å»ºçš„ç”¨æˆ·æ‰æœ‰æ„ä¹‰ã€‚</p><p>åˆ›å»º service é¡¹ç›®ï¼ˆç§Ÿæˆ·ï¼‰ï¼Œservice é¡¹ç›®å°†ä½œä¸º OpenStack çš„ç³»ç»Ÿé¡¹ç›®ï¼Œæ‰€æœ‰ç³»ç»ŸæœåŠ¡éƒ½è¦åŠ å…¥åˆ° service é¡¹ç›®ä¸­ã€‚</p><h3 id="ä¸€ã€é¡¹ç›®ä¸è§’è‰²"><a href="#ä¸€ã€é¡¹ç›®ä¸è§’è‰²" class="headerlink" title="ä¸€ã€é¡¹ç›®ä¸è§’è‰²"></a>ä¸€ã€<strong>é¡¹ç›®ä¸è§’è‰²</strong></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæ™®é€šé¡¹ç›®</span></span><br><span class="line">openstack project create --domain default --description <span class="string">&quot;Demo Project&quot;</span> myproject</span><br><span class="line"><span class="comment"># åˆ›å»ºæ™®é€šç”¨æˆ· myuserï¼ˆä»…ç”¨äºæµ‹è¯•ï¼Œå¯ä»¥ä¸åˆ›å»ºï¼‰ï¼Œå¯†ç ä¸º myuserã€‚ </span></span><br><span class="line"> openstack user create --domain default --password-prompt myuser</span><br><span class="line"><span class="comment"># åˆ›å»ºè§’è‰²ï¼ˆä»…ç”¨äºæµ‹è¯•ï¼Œå¯ä»¥ä¸åˆ›å»ºï¼‰</span></span><br><span class="line">openstack role create myrole</span><br><span class="line"><span class="comment"># å°† myrole è§’è‰²æ·»åŠ åˆ° myproject é¡¹ç›®å’Œ myuser ç”¨æˆ·ï¼ˆä»…ç”¨äºæµ‹è¯•ï¼Œå¯ä»¥ä¸åˆ›å»ºï¼‰ã€‚</span></span><br><span class="line">openstack role add --project myproject --user myuser myrole</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®é™…åˆ›å»ºç”¨æˆ·</span></span><br><span class="line">openstack user create --domain default --password SKYLINE_PASS  skyline </span><br><span class="line"><span class="comment"># åŠ å…¥adminæƒé™</span></span><br><span class="line">openstack role add --project service --user skyline admin </span><br><span class="line">   </span><br><span class="line"><span class="comment"># æŸ¥çœ‹è§’è‰²æƒé™</span></span><br><span class="line">openstack role list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç”¨æˆ·</span></span><br><span class="line">openstack user list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç›®å‰çš„é¡¹ç›®</span></span><br><span class="line">openstack project list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å½“å‰è®¤è¯ç”¨æˆ·çš„ Token å’Œç›¸å…³è®¤è¯ä¿¡æ¯</span></span><br><span class="line">openstack token issue</span><br><span class="line"><span class="comment"># åˆ—å‡º keystone æœåŠ¡ä¸­çš„ API ç«¯ç‚¹ä»¥éªŒè¯ä¸ Identity æœåŠ¡çš„è¿æ¥ã€‚</span></span><br><span class="line">openstack catalog list</span><br><span class="line"><span class="comment">#  æŸ¥çœ‹é•œåƒ</span></span><br><span class="line">openstack image list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®ä¾‹ç±»å‹</span></span><br><span class="line">openstack flavor list</span><br></pre></td></tr></table></figure><p>ğŸ“Œ openstack token issue ä½œç”¨è¯´æ˜</p><p>å½“ä½ è¿è¡Œ <code>openstack token issue</code> æ—¶ï¼Œå®ƒä¼šå‘ Keystone è®¤è¯æœåŠ¡å‘é€è¯·æ±‚ï¼Œç„¶åè¿”å›ä¸€ä¸ªåŒ…å«ç”¨æˆ·è®¤è¯è¯¦æƒ…çš„å“åº”ï¼Œ<strong>ä¸»è¦ç”¨äºéªŒè¯å½“å‰ç¯å¢ƒå˜é‡ï¼ˆå¦‚ç”¨æˆ·åã€å¯†ç ã€é¡¹ç›®ç­‰ï¼‰æ˜¯å¦é…ç½®æ­£ç¡®</strong>ã€‚</p><h3 id="äºŒã€æŸ¥çœ‹æœåŠ¡ã€åˆ›å»ºå¿«ç…§ç­‰"><a href="#äºŒã€æŸ¥çœ‹æœåŠ¡ã€åˆ›å»ºå¿«ç…§ç­‰" class="headerlink" title="äºŒã€æŸ¥çœ‹æœåŠ¡ã€åˆ›å»ºå¿«ç…§ç­‰"></a>äºŒã€æŸ¥çœ‹æœåŠ¡ã€åˆ›å»ºå¿«ç…§ç­‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰ç»„ä»¶</span></span><br><span class="line">openstack service list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹è®¡ç®—æœåŠ¡ç»„ä»¶</span></span><br><span class="line">openstack compute service list</span><br><span class="line"></span><br><span class="line"><span class="comment"># openstackå®¿ä¸»æœº</span></span><br><span class="line">openstack host list </span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·²æ³¨å†Œçš„è®¡ç®—èŠ‚ç‚¹</span></span><br><span class="line">openstack compute service list --service nova-compute</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŸä¸€ä¸ªæœåŠ¡</span></span><br><span class="line">openstack volume service list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç­‰åŒnovaå‘½ä»¤</span></span><br><span class="line">nova service-list | grep nova-compute</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºå¿«ç…§</span></span><br><span class="line">openstack server image create  --name my_instance_snapshot_2024  6ae61de8-b0bd-4567-bf5d-2a151d853fce</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¿«ç…§</span></span><br><span class="line">openstack image list |grep my_instance_snapshot_2024</span><br><span class="line"><span class="comment"># å¿«ç…§åˆ›å»ºå®Œæˆåå†é‡æ–°å¯åŠ¨å®ä¾‹</span></span><br><span class="line">openstack server start  6ae61de8-b0bd-4567-bf5d-2a151d853fce</span><br><span class="line"><span class="comment"># ç­‰åŒäºnovaå‘½ä»¤</span></span><br><span class="line">nova image-create &lt;å®ä¾‹åç§°æˆ–ID&gt; &lt;å¿«ç…§åç§°&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å¿«ç…§</span></span><br><span class="line">openstack image delete å¿«ç…§uuid</span><br><span class="line">æˆ–</span><br><span class="line">glance image-delete &lt;å¿«ç…§åç§°æˆ–ID&gt;</span><br><span class="line"><span class="comment"># å¼ºåˆ¶åˆ é™¤</span></span><br><span class="line">openstack image <span class="built_in">set</span> --unprotected &lt;å¿«ç…§ID&gt;  <span class="comment"># è§£é™¤ä¿æŠ¤</span></span><br><span class="line">openstack image <span class="built_in">set</span> --deactivate &lt;å¿«ç…§ID&gt;  </span><br></pre></td></tr></table></figure><h3 id="ä¸‰ã€æŸ¥çœ‹å®ä¾‹"><a href="#ä¸‰ã€æŸ¥çœ‹å®ä¾‹" class="headerlink" title="ä¸‰ã€æŸ¥çœ‹å®ä¾‹"></a>ä¸‰ã€æŸ¥çœ‹å®ä¾‹</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å®ä¾‹åˆ—è¡¨</span></span><br><span class="line">openstack server list </span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŸä¸€ä¸ªå®ä¾‹çš„è¯¦ç»†ä¿¡æ¯ </span></span><br><span class="line">openstack server show d032241e-0bed-412</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®ä¾‹æ“ä½œè®°å½•</span></span><br><span class="line">openstack server event list  93a08381-b1be-4cec-9284-e48ece60cabb</span><br><span class="line"><span class="comment"># novaå‘½ä»¤æ“ä½œæ–¹å¼ï¼ˆå¯ä»¥çœ‹åˆ°requestidï¼‰</span></span><br><span class="line">nova instance-action-list 93a08381-b1be-4cec-9284-e48ece60cabb</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç™»å½•å®ä¾‹ </span></span><br><span class="line">virsh console instance-00000001</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰‹åŠ¨åˆ é™¤å®ä¾‹</span></span><br><span class="line">è¯´æ˜ï¼šä½¿ç”¨ virsh console ç™»å½•å®ä¾‹åå¦‚ä½•é€€å‡ºå®ä¾‹ï¼šç›´æ¥æŒ‰ Ctrl + ] ç»„åˆé”® </span><br><span class="line"><span class="comment"># å…³é—­å®ä¾‹ </span></span><br><span class="line">openstack server stop vm01 </span><br><span class="line"><span class="comment"># å¯åŠ¨å®ä¾‹ </span></span><br><span class="line">openstack server start vm01 </span><br><span class="line"><span class="comment"># åˆ é™¤æ‰€é€‰çš„å®ä¾‹ </span></span><br><span class="line">openstack server delete vm01  ï¼ˆæˆ–-openstack server delete &lt;è™šæ‹Ÿæœºçš„ID&gt;ï¼‰</span><br></pre></td></tr></table></figure><h3 id="å››ã€cinderå¸¸ç”¨å‘½ä»¤"><a href="#å››ã€cinderå¸¸ç”¨å‘½ä»¤" class="headerlink" title="å››ã€cinderå¸¸ç”¨å‘½ä»¤"></a>å››ã€<code>cinder</code>å¸¸ç”¨å‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºå­˜å‚¨å·</span></span><br><span class="line">openstack volume create --size 1 volume01</span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šåˆ›å»ºä¸€ä¸ªå·åä¸º volume01 å¤§å°ä¸º 1GB çš„å·</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å­˜å‚¨å·åˆ—è¡¨</span></span><br><span class="line">openstack volume list</span><br><span class="line"><span class="comment"># ä¸ºå­˜å‚¨å·åˆ›å»ºå¿«ç…§</span></span><br><span class="line">openstack volume snapshot create --volume volume01 snap-volume01</span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šä¸ºå· volume01 åˆ›å»ºä¸€ä¸ªåä¸º snap-volume01 çš„å¿«ç…§</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¿«ç…§åˆ—è¡¨</span></span><br><span class="line">openstack volume snapshot list</span><br><span class="line"><span class="comment"># æŒ‚è½½å·åˆ°å®ä¾‹</span></span><br><span class="line">nova volume-attach vm01 ead55f47-a0f3-4eb9-854e-9dff638ff534 /dev/vdb</span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šæŒ‚è½½å·æ—¶ï¼Œè¦æŒ‡å®šå· idï¼Œæ­¤å¤„è¦æŒ‡å®šå· volume01 çš„ idï¼Œç„¶åæ˜¯è¿æ¥åˆ°å®ä¾‹ vm01 çš„/dev/vdb ä¸Š</span></span><br><span class="line"><span class="comment"># è™šæ‹Ÿæœºå¸è½½å·</span></span><br><span class="line">nova volume-detach vm01 ead55f47-a0f3-4eb9-854e-9dff638ff534</span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå¸è½½å·æ—¶ï¼Œè¯·å…ˆåœ¨æ“ä½œç³»ç»Ÿå±‚åœæ­¢æ­£åœ¨ä½¿ç”¨è¦å¸è½½çš„åº”ç”¨ï¼Œumount æ‰ï¼Œç„¶åå†æ‰§è¡Œ volume-detach</span></span><br><span class="line"><span class="comment"># åˆ é™¤æ‰€é€‰å­˜å‚¨å·</span></span><br><span class="line">openstack volume snapshot delete snap-volume01</span><br><span class="line">openstack volume delete volume01</span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šåˆ é™¤å·è¦å…·å¤‡ 2 ä¸ªæ¡ä»¶ï¼Œç¬¬ä¸€ä¸ªæ˜¯å·çŠ¶æ€æ˜¯å¯ç”¨(available)æˆ–å…¶ä»–è€Œéä½¿ç”¨ä¸­ï¼›ç¬¬äºŒä¸ªå°±æ˜¯è¦åˆ é™¤çš„å·ä¸Šæ²¡æœ‰å¿«ç…§ï¼Œå¦‚æœæœ‰è¦å…ˆåˆ é™¤å¿«ç…§ã€‚</span></span><br><span class="line">openstack volume show volume01</span><br><span class="line"><span class="comment"># ç¦ç”¨å­˜å‚¨èŠ‚ç‚¹</span></span><br><span class="line">openstack volume service <span class="built_in">set</span> --<span class="built_in">disable</span> compute02@lvm cinder-volume</span><br><span class="line"><span class="comment"># å¯ç”¨å­˜å‚¨èŠ‚ç‚¹</span></span><br><span class="line">openstack volume service <span class="built_in">set</span> --<span class="built_in">enable</span> compute02@lvm cinder-volume</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®äº‘ä¸»æœºidæŸ¥è¯¢äº‘ç¡¬ç›˜</span></span><br><span class="line">virsh domblklist 17dc79da-2c5c-4691-1855-154618622fa7</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦åˆ°æœŸå·²ç»æ˜¯å¦é™é€Ÿ</span></span><br><span class="line">cinder get-qos 17dc79da-2c5c-4691-1855-154618622fa7</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹cinderæœåŠ¡</span></span><br><span class="line"> cinder  service-list  </span><br><span class="line"><span class="comment"># ä¸»è¦ç”¨äºæŸ¥çœ‹åç«¯å­˜å‚¨èµ„æºæ˜¯å¦å……è¶³</span></span><br><span class="line"><span class="comment"># æ—¥å¿—æ‹¿åˆ°ç£ç›˜idåæŸ¥çœ‹è¯¦æƒ…ï¼ˆSAS-publicåœ¨è¯¦æƒ…æœ€åï¼‰</span></span><br><span class="line">cinder show 21b32e01-94f9-4f7a-b99a-3a68e115d2a2 --read-deleted</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å­˜å‚¨ç±»å‹</span></span><br><span class="line">cinder type-show SAS-public</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å­˜å‚¨èµ„æºæ± èµ„æºè¯¦æƒ…</span></span><br><span class="line">cinder get-pools --detail</span><br></pre></td></tr></table></figure><h4 id="1ã€domblklistã€-get-qosæ ¹æ®è™šæ‹ŸæœºuuidæŸ¥çœ‹ç£ç›˜"><a href="#1ã€domblklistã€-get-qosæ ¹æ®è™šæ‹ŸæœºuuidæŸ¥çœ‹ç£ç›˜" class="headerlink" title="1ã€domblklistã€ get-qosæ ¹æ®è™šæ‹ŸæœºuuidæŸ¥çœ‹ç£ç›˜"></a>1ã€<code>domblklist</code>ã€ <code>get-qos</code>æ ¹æ®è™šæ‹ŸæœºuuidæŸ¥çœ‹ç£ç›˜</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¹æ®äº‘ä¸»æœºidæŸ¥è¯¢äº‘ç¡¬ç›˜</span></span><br><span class="line">virsh domblklist 17dc79da-2c5c-4691-1855-154618622fa7</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦åˆ°æœŸå·²ç»æ˜¯å¦é™é€Ÿ</span></span><br><span class="line">cinder get-qos 17dc79da-2c5c-4691-1855-154618622fa7</span><br></pre></td></tr></table></figure><h4 id="2ã€-read-deletedæŸ¥çœ‹å·²ç»åˆ é™¤çš„ç£ç›˜è¯¦æƒ…"><a href="#2ã€-read-deletedæŸ¥çœ‹å·²ç»åˆ é™¤çš„ç£ç›˜è¯¦æƒ…" class="headerlink" title="2ã€--read-deletedæŸ¥çœ‹å·²ç»åˆ é™¤çš„ç£ç›˜è¯¦æƒ…"></a>2ã€<code>--read-deleted</code>æŸ¥çœ‹å·²ç»åˆ é™¤çš„ç£ç›˜è¯¦æƒ…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cinder show 21b32e01-94f9-4f7a-b99a-3a68e115d2a2 --read-deleted</span><br></pre></td></tr></table></figure><h4 id="3ã€get-poolsã€type-show-æŸ¥çœ‹åç«¯å­˜å‚¨èµ„æºè¯¦æƒ…"><a href="#3ã€get-poolsã€type-show-æŸ¥çœ‹åç«¯å­˜å‚¨èµ„æºè¯¦æƒ…" class="headerlink" title="3ã€get-poolsã€type-show æŸ¥çœ‹åç«¯å­˜å‚¨èµ„æºè¯¦æƒ…"></a>3ã€<code>get-poolsã€type-show</code> æŸ¥çœ‹åç«¯å­˜å‚¨èµ„æºè¯¦æƒ…</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å­˜å‚¨ç±»å‹</span></span><br><span class="line">cinder type-show SAS-public</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å­˜å‚¨èµ„æºæ± èµ„æºè¯¦æƒ…</span></span><br><span class="line">cinder get-pools --detail</span><br></pre></td></tr></table></figure><h3 id="å››ã€virsh"><a href="#å››ã€virsh" class="headerlink" title="å››ã€virsh"></a>å››ã€<code>virsh</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹åˆšé€šè¿‡é•œåƒå¯åŠ¨çš„è™šæ‹Ÿæœºè™šæ‹Ÿæœº / æŸ¥çœ‹--os-variantæ”¯æŒçš„ç±»å‹</span></span><br><span class="line">virsh list Â  Â  Â  Â  Â  Â  <span class="comment"># åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœº</span></span><br><span class="line">osinfo-query os Â  Â  Â  Â <span class="comment"># æŸ¥çœ‹æ”¯æŒçš„ç±»å‹</span></span><br><span class="line"><span class="comment"># virt-installå¸¸ç”¨å‘½ä»¤</span></span><br><span class="line">virsh list --all Â  Â  Â  <span class="comment"># åˆ—å‡ºæ‰€æœ‰è™šæœº</span></span><br><span class="line">virsh start  web01 Â  Â  <span class="comment"># å¯åŠ¨æŒ‡å®šè™šæœº</span></span><br><span class="line">virsh reboot web01 Â  Â  <span class="comment"># é‡å¯æŒ‡å®šè™šæœºï¼ˆå…³é—­çŠ¶æ€æ— æ³•é‡å¯ï¼‰</span></span><br><span class="line">virsh console name Â  Â  <span class="comment"># è¿æ¥è™šæ‹Ÿæœº</span></span><br><span class="line">virsh destroy name Â  Â  <span class="comment"># æ‹”æ‰ç”µæºï¼ˆå¾ˆå°‘ç”¨ï¼‰</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">virsh undefine web01 Â  <span class="comment"># åˆ é™¤è™šæœºæ–‡ä»¶å³åˆ é™¤è™šæ‹Ÿæœºï¼ˆä¸ä¼šåˆ é™¤ç£ç›˜æ–‡ä»¶ï¼‰</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">virsh domblklist web01 Â  Â  Â  Â  Â  Â  <span class="comment"># æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜ä¿¡æ¯</span></span><br><span class="line">virsh dominfo Â   web01 Â  Â  Â  Â  Â  Â  <span class="comment"># æŸ¥çœ‹è™šæ‹Ÿæœºé…ç½®ä¿¡æ¯</span></span><br><span class="line">virsh domiflist  web01 Â  Â  Â  Â  Â  Â  <span class="comment"># æŸ¥çœ‹è™šæ‹Ÿç½‘å¡ä¿¡æ¯</span></span><br><span class="line">virsh dumpxml Â   web01 Â  Â  Â  Â  Â  Â  <span class="comment"># ä»¥ xmlæ ¼å¼æŸ¥çœ‹è™šæ‹Ÿæœº</span></span><br><span class="line">virsh define Â  Â  file-name Â  Â  Â  Â <span class="comment"># å¯¼å…¥è™šæ‹Ÿæœº</span></span><br><span class="line">virsh edit Â  Â  Â  name Â  Â  Â  Â  Â  Â  <span class="comment"># ç¼–è¾‘è™šæ‹Ÿæœºé…ç½®ï¼ˆä¸€èˆ¬æ˜¯åœ¨åˆšå®šä¹‰å®Œè™šæ‹Ÿæœºä¹‹åï¼‰è‡ªå¸¦è¯­æ³•æ£€æµ‹</span></span><br><span class="line">virsh domrename  old-name  new-name Â  <span class="comment"># è™šæ‹Ÿæœºé‡å‘½å</span></span><br><span class="line">virsh vncdisplay web01 Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># æŸ¥çœ‹vncç«¯å£</span></span><br><span class="line">virsh autostart  name Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment"># è™šæ‹Ÿæœºéšæœºé‡å¯</span></span><br><span class="line">virsh autostart --<span class="built_in">disable</span> name Â  Â  Â  Â <span class="comment"># å–æ¶ˆè™šæ‹Ÿæœºéšæœºé‡å¯</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å›¾å½¢ç•Œé¢ï¼š</span></span><br><span class="line">é€šè¿‡æ‰§è¡Œåvirt-managerï¼Œå¯åŠ¨libvirtçš„å›¾å½¢ç•Œé¢ï¼Œåœ¨å›¾å½¢ç•Œé¢ä¸‹å¯ä»¥ä¸€æ­¥ä¸€æ­¥çš„åˆ›å»ºè™šæ‹Ÿæœºï¼Œç®¡ç†è™šæ‹Ÿæœºï¼Œè¿˜å¯ä»¥ç›´æ¥æ§åˆ¶è™šæ‹Ÿæœºçš„æ¡Œé¢ã€‚</span><br><span class="line"><span class="comment"># å‘½ä»¤è¡Œï¼š</span></span><br><span class="line">virsh list Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># æ˜¾ç¤ºæœ¬åœ°æ´»åŠ¨è™šæ‹Ÿæœº</span></span><br><span class="line">virsh list â€“all Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment"># æ˜¾ç¤ºæœ¬åœ°æ‰€æœ‰çš„è™šæ‹Ÿæœºï¼ˆæ´»åŠ¨çš„+ä¸æ´»åŠ¨çš„ï¼‰</span></span><br><span class="line">virsh define ubuntu.xml Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment"># é€šè¿‡é…ç½®æ–‡ä»¶å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆè¿™ä¸ªè™šæ‹Ÿæœºè¿˜ä¸æ˜¯æ´»åŠ¨çš„ï¼‰</span></span><br><span class="line">virsh start ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># å¯åŠ¨åå­—ä¸ºubuntuçš„éæ´»åŠ¨è™šæ‹Ÿæœº</span></span><br><span class="line">virsh create ubuntu.xml Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment"># åˆ›å»ºè™šæ‹Ÿæœºï¼ˆåˆ›å»ºåï¼Œè™šæ‹Ÿæœºç«‹å³æ‰§è¡Œï¼Œæˆä¸ºæ´»åŠ¨ä¸»æœºï¼‰</span></span><br><span class="line">virsh <span class="built_in">suspend</span> ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># æš‚åœè™šæ‹Ÿæœº</span></span><br><span class="line">virsh resume ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment"># å¯åŠ¨æš‚åœçš„è™šæ‹Ÿæœº</span></span><br><span class="line">virsh shutdown web01 Â  Â  Â  Â  Â <span class="comment"># æ­£å¸¸å…³é—­è™šæ‹Ÿæœº</span></span><br><span class="line">virsh destroy ubuntu Â  Â  Â  Â  Â <span class="comment"># å¼ºåˆ¶æ‹”æ‰ç”µæºå…³é—­è™šæ‹Ÿæœºï¼ˆå¾ˆå°‘ä½¿ç”¨ï¼‰</span></span><br><span class="line"></span><br><span class="line">virsh domname 2 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment"># æ˜¾ç¤ºidå·ä¸º2çš„è™šæ‹Ÿæœºå Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span></span><br><span class="line">virsh domid ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># æ˜¾ç¤ºè™šæ‹Ÿæœºidå· Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span></span><br><span class="line">virsh domuuid ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># æ˜¾ç¤ºè™šæ‹Ÿæœºçš„uuid Â  Â  Â  Â  Â  </span></span><br><span class="line">virsh domstate ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="comment"># æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰çŠ¶æ€ Â  Â  Â  Â  Â </span></span><br><span class="line">virsh dumpxml ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰é…ç½®æ–‡ä»¶ï¼ˆå¯èƒ½å’Œå®šä¹‰è™šæ‹Ÿæœºæ—¶çš„é…ç½®ä¸åŒï¼Œå› ä¸ºå½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œéœ€è¦ç»™# è™šæ‹Ÿæœºåˆ†é…idå·ã€uuidã€vncç«¯å£å·ç­‰ç­‰ï¼‰ Â  Â  Â  Â  Â </span></span><br><span class="line">virsh setmem ubuntu 512000 Â  Â  Â  Â  Â  Â  Â  <span class="comment"># ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®å†…å­˜å¤§å° Â </span></span><br><span class="line">virsh setvcpus ubuntu 4 Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®cpuä¸ªæ•° Â  Â  Â  Â  Â </span></span><br></pre></td></tr></table></figure><h3 id="äº”ã€novaæ“ä½œ"><a href="#äº”ã€novaæ“ä½œ" class="headerlink" title="äº”ã€novaæ“ä½œ"></a>äº”ã€<code>nova</code>æ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹äº‘ä¸»æœº</span></span><br><span class="line">nova list</span><br><span class="line"><span class="comment"># è¯¦ç»†æŸ¥çœ‹äº‘ä¸»æœºä¿¡æ¯</span></span><br><span class="line">nova show 6ae61de8-b0bd-4567-bf5d-2a151d853fce</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œå¼ºåˆ¶åˆ é™¤</span></span><br><span class="line">nova force-delete fdfjfdjgbjgf-fdfkdkvn-fdkfv</span><br><span class="line"><span class="comment"># æŸ¥çœ‹é•œåƒæœ‰é‚£äº›è™šæ‹Ÿæœºåœ¨ä½¿ç”¨</span></span><br><span class="line">nova  list  --all --image 81724cdc-d848-471d-9b2d-38d6513d0066</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœåŠ¡</span></span><br><span class="line">nova service-list | grep nova-compute</span><br><span class="line"></span><br><span class="line"><span class="comment"># novaå‘½ä»¤æŸ¥çœ‹å®ä¾‹æ“ä½œè®°å½•</span></span><br><span class="line">nova instance-action-list 93a08381-b1be-4cec-9284-e48ece60cabb</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·²åˆ é™¤çš„è™šæ‹Ÿæœºä¿¡æ¯/ æŸ¥è¯¢å·²æ’¤å•åˆ é™¤çš„äº‘ä¸»æœºè¯¦æƒ…</span></span><br><span class="line">nova show  93a08381-b1be-4cec-9284-e48ece60cabb  --de\lete</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®äº‘ä¸»æœºidæŸ¥çœ‹å¿«ç…§</span></span><br><span class="line">nova server-snapshot-list  --all --instance-uuid 617fb4e5-fc90-4298-9c27-5cd9f27c552a</span><br><span class="line"><span class="comment"># novaæ ¹æ®å†…ç½‘ipæŸ¥çœ‹äº‘ä¸»æœºuuid</span></span><br><span class="line">nova list --all --ip </span><br><span class="line"><span class="comment"># åº•å±‚è§£ç»‘ç£ç›˜</span></span><br><span class="line">nova volume-detach è™šæ‹Ÿæœºuuid ç£ç›˜<span class="built_in">id</span> </span><br></pre></td></tr></table></figure><h4 id="1ã€aggregateä¸»æœºèšåˆèµ„æºä½™é‡æŸ¥è¯¢"><a href="#1ã€aggregateä¸»æœºèšåˆèµ„æºä½™é‡æŸ¥è¯¢" class="headerlink" title="1ã€aggregateä¸»æœºèšåˆèµ„æºä½™é‡æŸ¥è¯¢"></a>1ã€<code>aggregate</code>ä¸»æœºèšåˆèµ„æºä½™é‡æŸ¥è¯¢</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æœåŠ¡æ‰¾åˆ°showä¸­</span></span><br><span class="line">nova  service-list</span><br><span class="line"><span class="comment"># dockeréƒ¨ç½²çš„ç™»å½•æ‰§è¡Œè„šæœ¬æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ</span></span><br><span class="line">docker <span class="built_in">exec</span> -it nova_api  bash</span><br><span class="line"><span class="comment"># æŸ¥çœ‹è®¡ç®—åˆ†ç»„</span></span><br><span class="line">nova aggregate-list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹s3ç±»å‹ä¸‹é¢çš„è®¡ç®—èŠ‚ç‚¹</span></span><br><span class="line">nova aggregate-show 14</span><br></pre></td></tr></table></figure><h4 id="2ã€reset-stateé‡ç½®çŠ¶æ€"><a href="#2ã€reset-stateé‡ç½®çŠ¶æ€" class="headerlink" title="2ã€reset-stateé‡ç½®çŠ¶æ€"></a>2ã€<code>reset-state</code>é‡ç½®çŠ¶æ€</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®çŠ¶æ€ä¸ºactive</span></span><br><span class="line">nova reset-state --active  fdfjfdjgbjgf-fdfkdkvn-fdkfv</span><br><span class="line">nova reset-state --stop  fdfjfdjgbjgf-fdfkdkvn-fdkfv</span><br></pre></td></tr></table></figure><h4 id="3ã€flavoræŸ¥çœ‹å®ä¾‹è§„æ ¼"><a href="#3ã€flavoræŸ¥çœ‹å®ä¾‹è§„æ ¼" class="headerlink" title="3ã€flavoræŸ¥çœ‹å®ä¾‹è§„æ ¼"></a>3ã€<code>flavor</code>æŸ¥çœ‹å®ä¾‹è§„æ ¼</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å®ä¾‹è§„æ ¼è¯¦æƒ…</span></span><br><span class="line">nova flavor-list</span><br><span class="line">nova flavor-show 48ddfdf5-c00d-4681-bcc7-2f6b5d16dd6e</span><br></pre></td></tr></table></figure><h4 id="4ã€volume-attachæŒ‚è½½å¸è½½"><a href="#4ã€volume-attachæŒ‚è½½å¸è½½" class="headerlink" title="4ã€volume-attachæŒ‚è½½å¸è½½"></a>4ã€<code>volume-attach</code>æŒ‚è½½å¸è½½</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‚è½½å·åˆ°å®ä¾‹</span></span><br><span class="line">nova volume-attach vm01 ead55f47-a0f3-4eb9-854e-9dff638ff534 /dev/vdb</span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šæŒ‚è½½å·æ—¶ï¼Œè¦æŒ‡å®šå· idï¼Œæ­¤å¤„è¦æŒ‡å®šå· volume01 çš„ idï¼Œç„¶åæ˜¯è¿æ¥åˆ°å®ä¾‹ vm01 çš„/dev/vdb ä¸Š</span></span><br><span class="line"><span class="comment"># è™šæ‹Ÿæœºå¸è½½å·</span></span><br><span class="line">nova volume-detach vm01 ead55f47-a0f3-4eb9-854e-9dff638ff534</span><br><span class="line"><span class="comment"># è¯´æ˜ï¼šå¸è½½å·æ—¶ï¼Œè¯·å…ˆåœ¨æ“ä½œç³»ç»Ÿå±‚åœæ­¢æ­£åœ¨ä½¿ç”¨è¦å¸è½½çš„åº”ç”¨ï¼Œumount æ‰ï¼Œç„¶åå†æ‰§è¡Œ volume-detach</span></span><br></pre></td></tr></table></figure><h4 id="5ã€listã€showæŸ¥çœ‹äº‘ä¸»æœºå¼€å…³æœº"><a href="#5ã€listã€showæŸ¥çœ‹äº‘ä¸»æœºå¼€å…³æœº" class="headerlink" title="5ã€listã€showæŸ¥çœ‹äº‘ä¸»æœºå¼€å…³æœº"></a>5ã€<code>listã€show</code>æŸ¥çœ‹äº‘ä¸»æœºå¼€å…³æœº</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹äº‘ä¸»æœº</span></span><br><span class="line">nova list</span><br><span class="line"><span class="comment"># è¯¦ç»†æŸ¥çœ‹äº‘ä¸»æœºä¿¡æ¯</span></span><br><span class="line">nova show 6ae61de8-b0bd-4567-bf5d-2a151d853fce</span><br><span class="line"><span class="comment"># å¼€æœº</span></span><br><span class="line">nova start 6ae61de8-b0bd-4567-bf5d-2a151d853fce</span><br></pre></td></tr></table></figure><h4 id="6ã€force-deleteå¼ºåˆ¶åˆ é™¤"><a href="#6ã€force-deleteå¼ºåˆ¶åˆ é™¤" class="headerlink" title="6ã€force-deleteå¼ºåˆ¶åˆ é™¤"></a>6ã€<code>force-delete</code>å¼ºåˆ¶åˆ é™¤</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰§è¡Œå¼ºåˆ¶åˆ é™¤</span></span><br><span class="line">nova force-delete fdfjfdjgbjgf-fdfkdkvn-fdkfv</span><br></pre></td></tr></table></figure><h4 id="7ã€å®ä¾‹æ“ä½œ"><a href="#7ã€å®ä¾‹æ“ä½œ" class="headerlink" title="7ã€å®ä¾‹æ“ä½œ"></a>7ã€å®ä¾‹æ“ä½œ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹</span></span><br><span class="line">nova list</span><br><span class="line">nova show</span><br><span class="line"><span class="comment"># çƒ­å¼€æœºå…³æœºé‡å¯</span></span><br><span class="line">nova start|stop|restart</span><br></pre></td></tr></table></figure><h3 id="å…­ã€-hypervisorä½¿ç”¨å‘½ä»¤æŸ¥çœ‹èµ„æºåˆ©ç”¨ç‡"><a href="#å…­ã€-hypervisorä½¿ç”¨å‘½ä»¤æŸ¥çœ‹èµ„æºåˆ©ç”¨ç‡" class="headerlink" title="å…­ã€ hypervisorä½¿ç”¨å‘½ä»¤æŸ¥çœ‹èµ„æºåˆ©ç”¨ç‡"></a>å…­ã€ <code>hypervisor</code>ä½¿ç”¨å‘½ä»¤æŸ¥çœ‹èµ„æºåˆ©ç”¨ç‡</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰è®¡ç®—èŠ‚ç‚¹</span></span><br><span class="line">openstack hypervisor list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å•ä¸ªè®¡ç®—èŠ‚ç‚¹çš„èµ„æºä½¿ç”¨æƒ…å†µ</span></span><br><span class="line">openstack hypervisor show compute1</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰è®¡ç®—èŠ‚ç‚¹çš„èµ„æºæ±‡æ€»æƒ…å†µ</span></span><br><span class="line">openstack hypervisor stats show</span><br></pre></td></tr></table></figure><h3 id="ä¸ƒã€glanceé•œåƒæ“ä½œ"><a href="#ä¸ƒã€glanceé•œåƒæ“ä½œ" class="headerlink" title="ä¸ƒã€glanceé•œåƒæ“ä½œ"></a>ä¸ƒã€<code>glance</code>é•œåƒæ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ—¥å¿—æ‹¿åˆ°é•œåƒuuidï¼ˆ3.0ï¼‰</span></span><br><span class="line">grep ctyunos-cii-25.07 /var/lib/docker/volumes/glance-api-6516030_kolla_logs/_data/glance/glance.log</span><br><span class="line"><span class="comment"># é€šè¿‡é•œåƒåç§°è¿‡æ»¤</span></span><br><span class="line">glance image-list |grep ctyunos-cii-25.07</span><br><span class="line"><span class="comment"># é€šè¿‡æ—¥å¿—ä¸­çš„req idè¿‡æ»¤</span></span><br><span class="line">glance task-list |grep 7c91577eec464f4fa960be908ee372ff</span><br><span class="line">--------------------------------------------------------------------</span><br><span class="line">| 8a2dcafb-0fb6-494d-b4c7-98ccac7e8cd4 | import      | failure | 7c91577eec464f4fa960be908ee372ff |</span><br><span class="line">| 0e6538d1-c781-4461-9bf2-c6359325b407 | import      | failure | 7c91577eec464f4fa960be908ee372ff |</span><br><span class="line">| 753be1a9-2528-4b1f-8815-35bdb47892fc | import      | failure | 7c91577eec464f4fa960be908ee372ff |</span><br><span class="line">| 17265974-5cac-4b18-8372-90ff2140a8e4 | import      | failure | 7c91577eec464f4fa960be908ee372ff |</span><br><span class="line">| 2a7eb98c-7594-4960-9d9f-0325a5345cd4 | import      | failure | 7c91577eec464f4fa960be908ee372ff |</span><br><span class="line">| a1645767-807d-4e8b-b1df-6291de2d200b | import      | failure | 7c91577eec464f4fa960be908ee372ff |</span><br><span class="line">| cadc9b91-1646-4525-bdfa-12fbeba73863 | import      | failure | 7c91577eec464f4fa960be908ee372ff |</span><br><span class="line"><span class="comment"># æ ¹æ®å›æ˜¾idè¿‡æ»¤æŸ¥çœ‹é•œåƒçŠ¶æ€ï¼ˆå¯ä»¥çœ‹åˆ°æŠ¥é”™503ï¼‰å‡çº§ç ”å‘ï¼ˆé•œåƒidï¼‰</span></span><br><span class="line">glance task-show  8a2dcafb-0fb6-494d-b4c7-98ccac7e8cd4</span><br><span class="line"><span class="comment"># æŸ¥çœ‹é•œåƒè¯¦æƒ…</span></span><br><span class="line">glance image-show c83208ae-8dee-49ff-a1f3-3ba292067fea</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">æˆ–</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é•œåƒ</span></span><br><span class="line">openstack image list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹é•œåƒè¯¦æƒ…</span></span><br><span class="line">openstack image show  c83208ae-8dee-49ff-a1f3-3ba292067fea</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹é•œåƒçŠ¶æ€</span></span><br><span class="line">glance image-show  10d36711-8eba-4428-8367-0c1d5f2227de</span><br><span class="line"><span class="comment"># æŸ¥çœ‹åŒæ­¥ä»»åŠ¡</span></span><br><span class="line">glance task-list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹åç«¯å­˜å‚¨</span></span><br><span class="line">glance stores-info</span><br><span class="line"><span class="comment"># æ‰‹åŠ¨è§¦å‘åŒæ­¥</span></span><br><span class="line">glance image-sync 10d36711-8eba-4428-8367-0c1d5f2227de  --dest_backend az1_ceph_ssd</span><br></pre></td></tr></table></figure><h4 id="1ã€image-listã€showæŸ¥çœ‹é•œåƒ"><a href="#1ã€image-listã€showæŸ¥çœ‹é•œåƒ" class="headerlink" title="1ã€image-listã€showæŸ¥çœ‹é•œåƒ"></a>1ã€<code>image-listã€show</code>æŸ¥çœ‹é•œåƒ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹é•œåƒè¯¦æƒ…</span></span><br><span class="line">glance image-list </span><br><span class="line">glance image-show c83208ae-8dee-49ff-a1f3-3ba292067fea</span><br></pre></td></tr></table></figure><h4 id="2ã€image-syncã€é•œåƒåŒæ­¥"><a href="#2ã€image-syncã€é•œåƒåŒæ­¥" class="headerlink" title="2ã€image-syncã€é•œåƒåŒæ­¥"></a>2ã€<code>image-sync</code>ã€é•œåƒåŒæ­¥</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹åŒæ­¥ä»»åŠ¡</span></span><br><span class="line">glance task-list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹åç«¯å­˜å‚¨</span></span><br><span class="line">glance stores-info</span><br><span class="line"><span class="comment"># æ‰‹åŠ¨è§¦å‘åŒæ­¥</span></span><br><span class="line">glance image-sync 10d36711-8eba-4428-8367-0c1d5f2227de  --dest_backend az1_ceph_ssd</span><br></pre></td></tr></table></figure><h3 id="å…«ã€live-migration-migrateçƒ­è¿ç§»ä¸å†·è¿ç§»ï¼ˆ3-0ï¼‰"><a href="#å…«ã€live-migration-migrateçƒ­è¿ç§»ä¸å†·è¿ç§»ï¼ˆ3-0ï¼‰" class="headerlink" title="å…«ã€live-migration migrateçƒ­è¿ç§»ä¸å†·è¿ç§»ï¼ˆ3.0ï¼‰"></a>å…«ã€<code>live-migration migrate</code>çƒ­è¿ç§»ä¸å†·è¿ç§»ï¼ˆ3.0ï¼‰</h3><h4 id="çƒ­è¿ç§»"><a href="#çƒ­è¿ç§»" class="headerlink" title="çƒ­è¿ç§»"></a><strong>çƒ­è¿ç§»</strong></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è™šæ‹Ÿæœºåˆ—è¡¨ä¿¡æ¯</span></span><br><span class="line">nova list </span><br><span class="line"><span class="comment"># æŸ¥çœ‹è™šæ‹Ÿæœºè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">nova show demo</span><br><span class="line"><span class="comment"># è¿ç§»åˆ°compute2</span></span><br><span class="line">nova live-migration 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad  compute2</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æœ€è¿‘äº”æ¬¡çš„è¿ç§»è®°å½•</span></span><br><span class="line">nova migration-list --instance-uuid 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad   --<span class="built_in">limit</span> 5</span><br></pre></td></tr></table></figure><p><strong>éšæœºçƒ­è¿ç§»</strong></p><p>$ nova live-migration <server> <host><br>$ nova migration-list â€“instance-uuid <uuid> â€“limit 5</uuid></host></server></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®ä¾‹</span></span><br><span class="line">nova live-migration 0fee1fa8-fb15-dc1f-cc7f-a48b79bc8722</span><br><span class="line"><span class="comment"># ç¡®è®¤</span></span><br><span class="line">nova migration-list --instance-uuid 0fee1fa8-fb15-dc1f-cc7f-a48b79bc8722 --<span class="built_in">limit</span> 5</span><br></pre></td></tr></table></figure><p>æ–°ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># f7e9d5dc-0b9c-4d75-bbee-65b3b9b7c2b6å®ä¾‹çƒ­è¿ç§»åˆ°compute2</span></span><br><span class="line">openstack server migrate --live compute2 --live-migration f7e9d5dc-0b9c-4d75-bbee-65b3b9b7c2b6 --shared-migration</span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¿ç§»è®°å½•</span></span><br><span class="line">openstack server migration list --server f7e9d5dc-0b9c-4d75-bbee-65b3b9b7c2b6 --<span class="built_in">limit</span> 5</span><br></pre></td></tr></table></figure><h4 id="å†·è¿ç§»ï¼ˆå¿…é¡»è¦å…ˆå…³é—­å®ä¾‹ï¼‰"><a href="#å†·è¿ç§»ï¼ˆå¿…é¡»è¦å…ˆå…³é—­å®ä¾‹ï¼‰" class="headerlink" title="å†·è¿ç§»ï¼ˆå¿…é¡»è¦å…ˆå…³é—­å®ä¾‹ï¼‰"></a><strong>å†·è¿ç§»</strong>ï¼ˆå¿…é¡»è¦å…ˆå…³é—­å®ä¾‹ï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†·è¿ç§»å®ä¾‹åˆ° compute2ï¼ˆå¦‚æœæ”¯æŒæŒ‡å®š hostï¼‰</span></span><br><span class="line">nova migrate --host compute2 &lt;server-id&gt;</span><br><span class="line"><span class="comment"># æŸ¥çœ‹çŠ¶æ€ï¼Œå˜æˆ VERIFY_RESIZE</span></span><br><span class="line">openstack server show &lt;server-id&gt;</span><br><span class="line"><span class="comment"># ç¡®è®¤å˜æ›´</span></span><br><span class="line">nova resize-confirm &lt;server-id&gt;</span><br><span class="line"><span class="comment"># æˆ–å–æ¶ˆè¿ç§»</span></span><br><span class="line">nova resize-revert &lt;server-id&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­è™šæ‹Ÿæœº</span></span><br><span class="line">nova stop 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦æˆåŠŸå…³é—­</span></span><br><span class="line">nova list </span><br><span class="line">nova show 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br><span class="line"><span class="comment"># å¼€å§‹è¿›è¡Œå†·è¿ç§» å°†è™šæ‹Ÿæœº 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad è¿ç§»åˆ°compute1</span></span><br><span class="line">nova migrate --host compute1 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br><span class="line"><span class="comment"># æœ€åç¡®è®¤è¿ç§»å˜æ›´æ“ä½œ è¾“å…¥å¦‚ä¸‹å‘½ä»¤</span></span><br><span class="line">nova resize-confirm 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br><span class="line"><span class="comment"># æœ€åè¿›è¡Œå¼€æœºç¡®è®¤ä¸šåŠ¡å³å¯</span></span><br><span class="line">nova start 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br></pre></td></tr></table></figure><p>éšæœºå†·è¿ç§»</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­è™šæ‹Ÿæœº</span></span><br><span class="line">nova stop 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦æˆåŠŸå…³é—­</span></span><br><span class="line">nova list </span><br><span class="line">nova show 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br><span class="line"><span class="comment"># å¼€å§‹è¿›è¡Œå†·è¿ç§» å°†è™šæ‹Ÿæœº 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad è¿ç§»åˆ°compute1</span></span><br><span class="line">nova migrate 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br><span class="line"><span class="comment"># æœ€åç¡®è®¤è¿ç§»å˜æ›´æ“ä½œ è¾“å…¥å¦‚ä¸‹å‘½ä»¤</span></span><br><span class="line">nova resize-confirm 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br><span class="line"><span class="comment"># æœ€åè¿›è¡Œå¼€æœºç¡®è®¤ä¸šåŠ¡å³å¯</span></span><br><span class="line">nova start 7d1f1d0f-3afd-45fe-8c7a-07cca49067ad</span><br></pre></td></tr></table></figure><p>æ–°ç‰ˆæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è‡ªåŠ¨é€‰æ‹©èŠ‚ç‚¹</span></span><br><span class="line">openstack server migrate &lt;server-id&gt;</span><br><span class="line"><span class="comment"># æ‰‹åŠ¨é€‰æ‹©è¿ç§»èŠ‚ç‚¹</span></span><br><span class="line">openstack server migrate --host &lt;target-hostname&gt; &lt;server-id&gt;</span><br><span class="line"><span class="comment"># ç¡®è®¤è¿ç§»</span></span><br><span class="line">openstack server resize confirm &lt;server-id&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿ç§»åˆ°compute2</span></span><br><span class="line">openstack server migrate --host compute2 ccef2616-2578-4a08-b2b8-e034a9fc1b8e</span><br><span class="line"><span class="comment"># ç­‰å¾…è¿ç§»å®Œæˆï¼ˆç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹çŠ¶æ€ï¼Œç›´åˆ°çŠ¶æ€å˜ä¸ºVERIFY_RESIZEï¼‰</span></span><br><span class="line">openstack server show ccef2616-2578-4a08-b2b8-e034a9fc1b8e</span><br><span class="line"><span class="comment"># ç¡®è®¤è¿ç§»</span></span><br><span class="line">openstack server resize confirm ccef2616-2578-4a08-b2b8-e034a9fc1b8e</span><br></pre></td></tr></table></figure><h3 id="ä¹ã€aggregate-remove-hostç§»åŸŸ"><a href="#ä¹ã€aggregate-remove-hostç§»åŸŸ" class="headerlink" title="ä¹ã€aggregate-remove-hostç§»åŸŸ"></a>ä¹ã€<code>aggregate-remove-hos</code>tç§»åŸŸ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸»æœºèšåˆ3æ˜¯ceshi1</span></span><br><span class="line"><span class="comment"># åˆ—å‡ºæ‰€æœ‰ä¸»æœºèšåˆåŠå…¶ç›¸å…³ä¿¡æ¯ï¼ˆå¦‚ IDã€åç§°ã€å¯ç”¨åŸŸç­‰ï¼‰</span></span><br><span class="line">nova aggregate-list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹ä¸»æœºèšåˆceshi1`ä¸­æœ‰å“ªäº›è®¡ç®—èŠ‚ç‚¹</span></span><br><span class="line">nova aggregate-show 3</span><br><span class="line"><span class="comment"># ä»æŒ‡å®šçš„èšåˆä¸­ç§»é™¤æŸä¸ªè®¡ç®—èŠ‚ç‚¹ï¼ˆä¸»æœºï¼‰</span></span><br><span class="line">nova aggregate-remove-host 3 compute1</span><br><span class="line"><span class="comment"># å°†compute1å†æ¬¡åŠ å…¥ä¸»æœºèšåˆ3</span></span><br><span class="line">nova aggregate-add-host 3 compute1</span><br></pre></td></tr></table></figure><h3 id="åã€flavorå®ä¾‹ç±»å‹æ“ä½œ"><a href="#åã€flavorå®ä¾‹ç±»å‹æ“ä½œ" class="headerlink" title="åã€flavorå®ä¾‹ç±»å‹æ“ä½œ"></a>åã€<code>flavor</code>å®ä¾‹ç±»å‹æ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºå®ä¾‹ç±»å‹</span></span><br><span class="line">openstack flavor create --disk 1 --ram 512 --vcpu 1 --<span class="built_in">id</span> 99999 test0</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®ä¾‹ç±»å‹</span></span><br><span class="line">openstack flavor list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®ä¾‹ç±»å‹è¯¦æƒ…</span></span><br><span class="line">openstack flavor show 48ddfdf5-c00d-4681-bcc7-2f6b5d16dd6e</span><br><span class="line"><span class="comment"># åˆ é™¤å®ä¾‹ç±»å‹</span></span><br><span class="line">openstack flavor delete 99999</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŒç­‰äºnovaï¼ˆå¯ä»¥ç›´æ¥+å¥—é¤ï¼‰</span></span><br><span class="line">nova flavor-show 48ddfdf5-c00d-4681-bcc7-2f6b5d16dd6e</span><br></pre></td></tr></table></figure><h3 id="åä¸€ã€security-å®‰å…¨ç»„æ“ä½œ"><a href="#åä¸€ã€security-å®‰å…¨ç»„æ“ä½œ" class="headerlink" title="åä¸€ã€security å®‰å…¨ç»„æ“ä½œ"></a>åä¸€ã€<code>security </code>å®‰å…¨ç»„æ“ä½œ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºå®‰å…¨ç»„</span></span><br><span class="line">openstack security group create my-security-group --description <span class="string">&quot;My-Security-Group&quot;</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®‰å…¨ç»„id</span></span><br><span class="line">openstack security group list</span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰icmpè§„åˆ™å…¥å£</span></span><br><span class="line">openstack security group rule create --protocol icmp --ingress 89a9d87c-03ae-4315-854f-a1c817a2979d</span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰icmpè§„åˆ™å‡ºå£</span></span><br><span class="line">openstack security group rule create --protocol icmp --egress  89a9d87c-03ae-4315-854f-a1c817a2979d</span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰udpè§„åˆ™å…¥å£</span></span><br><span class="line">openstack security group rule create --protocol udp --ingress  89a9d87c-03ae-4315-854f-a1c817a2979d</span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰udpè§„åˆ™å‡ºå£</span></span><br><span class="line">openstack security group rule create --protocol udp --egress  89a9d87c-03ae-4315-854f-a1c817a2979d</span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰tcpè§„åˆ™å…¥å£</span></span><br><span class="line">openstack security group rule create --protocol tcp --ingress 89a9d87c-03ae-4315-854f-a1c817a2979d</span><br><span class="line"><span class="comment"># æ·»åŠ æ‰€æœ‰tcpè§„åˆ™å‡ºå£</span></span><br><span class="line">openstack security group rule create --protocol tcp --egress  89a9d87c-03ae-4315-854f-a1c817a2979d</span><br><span class="line"><span class="comment"># æ”¾é€šå…¥æ–¹å‘22ç«¯å£</span></span><br><span class="line">openstack security group rule create --ingress --protocol tcp --dst-port 22:22 89a9d87c-03ae-4315-854f-a1c817a2979d</span><br><span class="line"><span class="comment"># æ”¾é€š10.0.0.30å…¥æ–¹å‘80ç«¯å£</span></span><br><span class="line">openstack security group rule create --ingress --protocol tcp --dst-port 80:80 --remote-ip 10.0.0.30/32 89a9d87c-03ae-4315-854f-a1c817a2979d</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®‰å…¨ç»„è§„åˆ™</span></span><br><span class="line">openstack security group rule list 89a9d87c-03ae-4315-854f-a1c817a2979d</span><br></pre></td></tr></table></figure><h3 id="åäºŒã€gemå‘½ä»¤"><a href="#åäºŒã€gemå‘½ä»¤" class="headerlink" title="åäºŒã€gemå‘½ä»¤"></a>åäºŒã€<code>gem</code>å‘½ä»¤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å®¿ä¸»æœºæ˜¯å¦æ­£å¸¸</span></span><br><span class="line">gem host list </span><br><span class="line"><span class="comment"># æŸ¥çœ‹å®¿ä¸»æœº</span></span><br><span class="line">gem host show 205</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ—¥å¿—</span></span><br><span class="line">gem fault-log list</span><br></pre></td></tr></table></figure><h3 id="åä¸‰ã€ovs-vsctl-ï¼ˆç½‘å¡æŸ¥çœ‹å‘½ä»¤ï¼‰"><a href="#åä¸‰ã€ovs-vsctl-ï¼ˆç½‘å¡æŸ¥çœ‹å‘½ä»¤ï¼‰" class="headerlink" title="åä¸‰ã€ovs-vsctl ï¼ˆç½‘å¡æŸ¥çœ‹å‘½ä»¤ï¼‰"></a>åä¸‰ã€<code>ovs-vsctl </code>ï¼ˆç½‘å¡æŸ¥çœ‹å‘½ä»¤ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹tap741c9e7d-d9</span></span><br><span class="line">openstack port list --fixed-ip ip-address=114.96.71.85     <span class="comment"># èŠœæ¹–2</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç½‘å¡é€Ÿç‡</span></span><br><span class="line">ovs-vsctl list interface tap741c9e7d-d9</span><br><span class="line"><span class="comment"># æ ¹æ®ç½‘å¡æŠ“åŒ…</span></span><br><span class="line">ovs-tcpdump -i port-238239 -enn1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntué”æ–‡ä»¶è¢«å ç”¨é—®é¢˜ï¼ˆ/var/lib/dpkg/lock-frontend è¢« unattended-upgr è¿›ç¨‹å ç”¨ï¼‰è§£å†³</title>
      <link href="/2025/07/17/ubuntu%E9%94%81%E6%96%87%E4%BB%B6%E8%A2%AB%E5%8D%A0%E7%94%A8%E9%97%AE%E9%A2%98%EF%BC%88/var/lib/dpkg/lock-frontend%20%E8%A2%AB%20unattended-upgr%20%E8%BF%9B%E7%A8%8B%E5%8D%A0%E7%94%A8%EF%BC%89%E8%A7%A3%E5%86%B3/"/>
      <url>/2025/07/17/ubuntu%E9%94%81%E6%96%87%E4%BB%B6%E8%A2%AB%E5%8D%A0%E7%94%A8%E9%97%AE%E9%A2%98%EF%BC%88/var/lib/dpkg/lock-frontend%20%E8%A2%AB%20unattended-upgr%20%E8%BF%9B%E7%A8%8B%E5%8D%A0%E7%94%A8%EF%BC%89%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>è¦è§£å†³åœ¨å®‰è£…NTPæ—¶é‡åˆ°çš„é”æ–‡ä»¶è¢«å ç”¨é—®é¢˜ï¼ˆ<code>/var/lib/dpkg/lock-frontend</code> è¢« <code>unattended-upgr</code> è¿›ç¨‹å ç”¨ï¼‰ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><h3 id="æ­¥éª¤-1ï¼šåœæ­¢å ç”¨é”çš„è¿›ç¨‹"><a href="#æ­¥éª¤-1ï¼šåœæ­¢å ç”¨é”çš„è¿›ç¨‹" class="headerlink" title="æ­¥éª¤ 1ï¼šåœæ­¢å ç”¨é”çš„è¿›ç¨‹"></a>æ­¥éª¤ 1ï¼šåœæ­¢å ç”¨é”çš„è¿›ç¨‹</h3><ol><li><p><strong>ç»ˆæ­¢è‡ªåŠ¨æ›´æ–°è¿›ç¨‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">kill</span> 4937  <span class="comment"># ç»“æŸæŒæœ‰é”çš„unattended-upgrè¿›ç¨‹ï¼ˆPIDä¸º4937ï¼‰</span></span><br></pre></td></tr></table></figure><p>å¦‚æœè¿›ç¨‹ä»åœ¨è¿è¡Œï¼Œå¼ºåˆ¶ç»ˆæ­¢ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">kill</span> -9 4937</span><br></pre></td></tr></table></figure></li><li><p><strong>åœæ­¢ systemd å®šæ—¶ä»»åŠ¡</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop apt-daily.timer       <span class="comment"># åœæ­¢è‡ªåŠ¨æ›´æ–°è®¡æ—¶å™¨</span></span><br><span class="line">sudo systemctl <span class="built_in">disable</span> apt-daily.timer    <span class="comment"># ç¦ç”¨å¼€æœºè‡ªå¯ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">sudo systemctl stop apt-daily.service     <span class="comment"># åœæ­¢æ­£åœ¨è¿è¡Œçš„æ›´æ–°æœåŠ¡</span></span><br><span class="line">sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure></li></ol><h3 id="æ­¥éª¤-2ï¼šåˆ é™¤é”æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰"><a href="#æ­¥éª¤-2ï¼šåˆ é™¤é”æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰" class="headerlink" title="æ­¥éª¤ 2ï¼šåˆ é™¤é”æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰"></a>æ­¥éª¤ 2ï¼šåˆ é™¤é”æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ï¼‰</h3><p>å¦‚æœç»ˆæ­¢è¿›ç¨‹åé”æ–‡ä»¶ä»æœªé‡Šæ”¾ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> /var/lib/dpkg/lock-frontend  <span class="comment"># åˆ é™¤å‰ç«¯é”æ–‡ä»¶</span></span><br><span class="line">sudo <span class="built_in">rm</span> /var/lib/apt/lists/lock      <span class="comment"># åˆ é™¤APTåˆ—è¡¨é”æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><h3 id="æ­¥éª¤-3ï¼šä¿®å¤åŒ…ç®¡ç†å™¨çŠ¶æ€"><a href="#æ­¥éª¤-3ï¼šä¿®å¤åŒ…ç®¡ç†å™¨çŠ¶æ€" class="headerlink" title="æ­¥éª¤ 3ï¼šä¿®å¤åŒ…ç®¡ç†å™¨çŠ¶æ€"></a>æ­¥éª¤ 3ï¼šä¿®å¤åŒ…ç®¡ç†å™¨çŠ¶æ€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg --configure -a  <span class="comment"># ä¿®å¤å¯èƒ½ä¸­æ–­çš„åŒ…é…ç½®</span></span><br></pre></td></tr></table></figure><h3 id="æ­¥éª¤-4ï¼šé‡è¯•å®‰è£…-NTP"><a href="#æ­¥éª¤-4ï¼šé‡è¯•å®‰è£…-NTP" class="headerlink" title="æ­¥éª¤ 4ï¼šé‡è¯•å®‰è£… NTP"></a>æ­¥éª¤ 4ï¼šé‡è¯•å®‰è£… NTP</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update         <span class="comment"># æ›´æ–°åŒ…åˆ—è¡¨</span></span><br><span class="line">sudo apt install -y ntp ntpdate  <span class="comment"># å®‰è£…è½¯ä»¶</span></span><br></pre></td></tr></table></figure><h3 id="æ­¥éª¤-5ï¼ˆå¯é€‰ï¼‰ï¼šæ¢å¤è‡ªåŠ¨æ›´æ–°"><a href="#æ­¥éª¤-5ï¼ˆå¯é€‰ï¼‰ï¼šæ¢å¤è‡ªåŠ¨æ›´æ–°" class="headerlink" title="æ­¥éª¤ 5ï¼ˆå¯é€‰ï¼‰ï¼šæ¢å¤è‡ªåŠ¨æ›´æ–°"></a>æ­¥éª¤ 5ï¼ˆå¯é€‰ï¼‰ï¼šæ¢å¤è‡ªåŠ¨æ›´æ–°</h3><p>å®‰è£…å®Œæˆåï¼Œé‡æ–°å¯ç”¨è‡ªåŠ¨æ›´æ–°ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> apt-daily.timer</span><br><span class="line">sudo systemctl start apt-daily.timer</span><br></pre></td></tr></table></figure><h3 id="éªŒè¯å®‰è£…"><a href="#éªŒè¯å®‰è£…" class="headerlink" title="éªŒè¯å®‰è£…"></a>éªŒè¯å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpq -p  <span class="comment"># æ£€æŸ¥NTPæœåŠ¡çŠ¶æ€</span></span><br></pre></td></tr></table></figure><h3 id="å¸¸è§åŸå› ä¸é¢„é˜²"><a href="#å¸¸è§åŸå› ä¸é¢„é˜²" class="headerlink" title="å¸¸è§åŸå› ä¸é¢„é˜²"></a>å¸¸è§åŸå› ä¸é¢„é˜²</h3><ul><li><strong>é—®é¢˜æ ¹æº</strong>ï¼šç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ï¼ˆ<code>unattended-upgrades</code>ï¼‰åœ¨åå°è¿è¡Œï¼Œä¸æ‰‹åŠ¨ apt æ“ä½œå†²çªã€‚</li><li><strong>é¢„é˜²æªæ–½</strong>ï¼š<ul><li>åœ¨æ‰‹åŠ¨ç®¡ç†åŒ…å‰ï¼Œä¸´æ—¶å…³é—­è‡ªåŠ¨æ›´æ–°ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop apt-daily.timer</span><br><span class="line">sudo systemctl stop apt-daily.service</span><br></pre></td></tr></table></figure></li><li>æˆ–åœ¨éç”Ÿäº§æ—¶æ®µæ‰‹åŠ¨æ›´æ–°ç³»ç»Ÿã€‚</li></ul></li></ul><blockquote><p><strong>æ³¨æ„</strong>ï¼šå¼ºåˆ¶åˆ é™¤é”æ–‡ä»¶æˆ–ç»ˆæ­¢è¿›ç¨‹ä»…åœ¨å¿…è¦æ—¶æ“ä½œï¼Œé¿å…å½±å“ç³»ç»Ÿç¨³å®šæ€§ã€‚å®ŒæˆååŠ¡å¿…éªŒè¯åŒ…çŠ¶æ€ï¼ˆ<code>sudo dpkg --configure -a</code>ï¼‰ã€‚</p><p>è¦è§£å†³åœ¨å®‰è£…NTPæ—¶é‡åˆ°çš„é”æ–‡ä»¶è¢«å ç”¨é—®é¢˜ï¼ˆ<code>/var/lib/dpkg/lock-frontend</code> è¢« <code>unattended-upgr</code> è¿›ç¨‹å ç”¨ï¼‰ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><h3 id="æ­¥éª¤-1ï¼šåœæ­¢å ç”¨é”çš„è¿›ç¨‹-1"><a href="#æ­¥éª¤-1ï¼šåœæ­¢å ç”¨é”çš„è¿›ç¨‹-1" class="headerlink" title="æ­¥éª¤ 1ï¼šåœæ­¢å ç”¨é”çš„è¿›ç¨‹"></a>æ­¥éª¤ 1ï¼šåœæ­¢å ç”¨é”çš„è¿›ç¨‹</h3><ol><li><p><strong>ç»ˆæ­¢è‡ªåŠ¨æ›´æ–°è¿›ç¨‹</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">kill</span> 4937  <span class="comment"># ç»“æŸæŒæœ‰é”çš„unattended-upgrè¿›ç¨‹ï¼ˆPIDä¸º4937ï¼‰</span></span><br></pre></td></tr></table></figure><p>å¦‚æœè¿›ç¨‹ä»åœ¨è¿è¡Œï¼Œå¼ºåˆ¶ç»ˆæ­¢ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">kill</span> -9 4937</span><br></pre></td></tr></table></figure></li><li><p><strong>åœæ­¢ systemd å®šæ—¶ä»»åŠ¡</strong>ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop apt-daily.timer       <span class="comment"># åœæ­¢è‡ªåŠ¨æ›´æ–°è®¡æ—¶å™¨</span></span><br><span class="line">sudo systemctl <span class="built_in">disable</span> apt-daily.timer    <span class="comment"># ç¦ç”¨å¼€æœºè‡ªå¯ï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">sudo systemctl stop apt-daily.service     <span class="comment"># åœæ­¢æ­£åœ¨è¿è¡Œçš„æ›´æ–°æœåŠ¡</span></span><br><span class="line">sudo systemctl daemon-reload</span><br></pre></td></tr></table></figure></li></ol><h3 id="æ­¥éª¤-2ï¼šåˆ é™¤é”æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦-å°½é‡ä¸è¦æ“ä½œæ­¤æ­¥éª¤ï¼‰"><a href="#æ­¥éª¤-2ï¼šåˆ é™¤é”æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦-å°½é‡ä¸è¦æ“ä½œæ­¤æ­¥éª¤ï¼‰" class="headerlink" title="æ­¥éª¤ 2ï¼šåˆ é™¤é”æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ å°½é‡ä¸è¦æ“ä½œæ­¤æ­¥éª¤ï¼‰"></a>æ­¥éª¤ 2ï¼šåˆ é™¤é”æ–‡ä»¶ï¼ˆå¦‚æœéœ€è¦ å°½é‡ä¸è¦æ“ä½œæ­¤æ­¥éª¤ï¼‰</h3><p>å¦‚æœç»ˆæ­¢è¿›ç¨‹åé”æ–‡ä»¶ä»æœªé‡Šæ”¾ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> /var/lib/dpkg/lock-frontend  <span class="comment"># åˆ é™¤å‰ç«¯é”æ–‡ä»¶</span></span><br><span class="line">sudo <span class="built_in">rm</span> /var/lib/apt/lists/lock      <span class="comment"># åˆ é™¤APTåˆ—è¡¨é”æ–‡ä»¶</span></span><br></pre></td></tr></table></figure><h3 id="æ­¥éª¤-3ï¼šä¿®å¤åŒ…ç®¡ç†å™¨çŠ¶æ€-1"><a href="#æ­¥éª¤-3ï¼šä¿®å¤åŒ…ç®¡ç†å™¨çŠ¶æ€-1" class="headerlink" title="æ­¥éª¤ 3ï¼šä¿®å¤åŒ…ç®¡ç†å™¨çŠ¶æ€"></a>æ­¥éª¤ 3ï¼šä¿®å¤åŒ…ç®¡ç†å™¨çŠ¶æ€</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo dpkg --configure -a  <span class="comment"># ä¿®å¤å¯èƒ½ä¸­æ–­çš„åŒ…é…ç½®</span></span><br></pre></td></tr></table></figure><h3 id="æ­¥éª¤-4ï¼šé‡è¯•å®‰è£…-NTP-1"><a href="#æ­¥éª¤-4ï¼šé‡è¯•å®‰è£…-NTP-1" class="headerlink" title="æ­¥éª¤ 4ï¼šé‡è¯•å®‰è£… NTP"></a>æ­¥éª¤ 4ï¼šé‡è¯•å®‰è£… NTP</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt update         <span class="comment"># æ›´æ–°åŒ…åˆ—è¡¨</span></span><br><span class="line">sudo apt install -y ntp ntpdate  <span class="comment"># å®‰è£…è½¯ä»¶</span></span><br></pre></td></tr></table></figure><h3 id="æ­¥éª¤-5ï¼ˆå¯é€‰ï¼‰ï¼šæ¢å¤è‡ªåŠ¨æ›´æ–°-1"><a href="#æ­¥éª¤-5ï¼ˆå¯é€‰ï¼‰ï¼šæ¢å¤è‡ªåŠ¨æ›´æ–°-1" class="headerlink" title="æ­¥éª¤ 5ï¼ˆå¯é€‰ï¼‰ï¼šæ¢å¤è‡ªåŠ¨æ›´æ–°"></a>æ­¥éª¤ 5ï¼ˆå¯é€‰ï¼‰ï¼šæ¢å¤è‡ªåŠ¨æ›´æ–°</h3><p>å®‰è£…å®Œæˆåï¼Œé‡æ–°å¯ç”¨è‡ªåŠ¨æ›´æ–°ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">enable</span> apt-daily.timer</span><br><span class="line">sudo systemctl start apt-daily.timer</span><br></pre></td></tr></table></figure><h3 id="éªŒè¯å®‰è£…-1"><a href="#éªŒè¯å®‰è£…-1" class="headerlink" title="éªŒè¯å®‰è£…"></a>éªŒè¯å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ntpq -p  <span class="comment"># æ£€æŸ¥NTPæœåŠ¡çŠ¶æ€</span></span><br></pre></td></tr></table></figure><h3 id="å¸¸è§åŸå› ä¸é¢„é˜²-1"><a href="#å¸¸è§åŸå› ä¸é¢„é˜²-1" class="headerlink" title="å¸¸è§åŸå› ä¸é¢„é˜²"></a>å¸¸è§åŸå› ä¸é¢„é˜²</h3><ul><li><strong>é—®é¢˜æ ¹æº</strong>ï¼šç³»ç»Ÿè‡ªåŠ¨æ›´æ–°ï¼ˆ<code>unattended-upgrades</code>ï¼‰åœ¨åå°è¿è¡Œï¼Œä¸æ‰‹åŠ¨ apt æ“ä½œå†²çªã€‚</li><li><strong>é¢„é˜²æªæ–½</strong>ï¼š<ul><li>åœ¨æ‰‹åŠ¨ç®¡ç†åŒ…å‰ï¼Œä¸´æ—¶å…³é—­è‡ªåŠ¨æ›´æ–°ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop apt-daily.timer</span><br><span class="line">sudo systemctl stop apt-daily.service</span><br></pre></td></tr></table></figure></li><li>æˆ–åœ¨éç”Ÿäº§æ—¶æ®µæ‰‹åŠ¨æ›´æ–°ç³»ç»Ÿã€‚</li></ul></li></ul><blockquote><p><strong>æ³¨æ„</strong>ï¼šå¼ºåˆ¶åˆ é™¤é”æ–‡ä»¶æˆ–ç»ˆæ­¢è¿›ç¨‹ä»…åœ¨å¿…è¦æ—¶æ“ä½œï¼Œé¿å…å½±å“ç³»ç»Ÿç¨³å®šæ€§ã€‚å®ŒæˆååŠ¡å¿…éªŒè¯åŒ…çŠ¶æ€ï¼ˆ<code>sudo dpkg --configure -a</code>ï¼‰ã€‚</p></blockquote></blockquote>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>centosé…ç½®æ¡¥æ¥ç½‘å¡br0</title>
      <link href="/2025/07/07/centos%E9%85%8D%E7%BD%AE%E6%A1%A5%E6%8E%A5%E7%BD%91%E5%8D%A1br0/"/>
      <url>/2025/07/07/centos%E9%85%8D%E7%BD%AE%E6%A1%A5%E6%8E%A5%E7%BD%91%E5%8D%A1br0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="centosé…ç½®æ¡¥æ¥ç½‘å¡br0"><a href="#centosé…ç½®æ¡¥æ¥ç½‘å¡br0" class="headerlink" title="centosé…ç½®æ¡¥æ¥ç½‘å¡br0"></a>centosé…ç½®æ¡¥æ¥ç½‘å¡br0</h2><p>ä¸ºäº†ç¼–å†™ç®€å•æˆ‘ä»¬cp ens33ç½‘å¡åœ¨å…¶åŸºç¡€ä¸Šç¼–å†™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> ifcfg-ens33 ifcfg-br0</span><br></pre></td></tr></table></figure><h3 id="1ã€ä¿®æ”¹ifcfg-ens33ç½‘å¡é…ç½®"><a href="#1ã€ä¿®æ”¹ifcfg-ens33ç½‘å¡é…ç½®" class="headerlink" title="1ã€ä¿®æ”¹ifcfg-ens33ç½‘å¡é…ç½®"></a>1ã€ä¿®æ”¹<code>ifcfg-ens33</code>ç½‘å¡é…ç½®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">2ã€BOOTPROTO=<span class="string">&quot;dhcp&quot;</span> <span class="comment"># æ”¹ä¸º BOOTPROTO=&quot;static&quot;</span></span><br><span class="line">3ã€BRIDGE=br0       <span class="comment"># è°ƒæ•´ä¸ºç½‘æ¡¥æ¨¡å¼ å…¶ä»–ä¸åšæ›´æ”¹</span></span><br><span class="line"><span class="comment"># ä¿ç•™å¦‚ä¸‹é…ç½®å…¶ä»–é…ç½®é€šé€šåˆ é™¤</span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens33</span><br><span class="line">BRIDGE=br0</span><br><span class="line">UUID=01d75770-3b87-47e3-bbc3-bebaed2293e3</span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/7/image_af9a3c0ca3e2b4cd4e46a8f49472d14a.png"></p><h3 id="2ã€ä¿®æ”¹ifcfg-br0"><a href="#2ã€ä¿®æ”¹ifcfg-br0" class="headerlink" title="2ã€ä¿®æ”¹ifcfg-br0"></a>2ã€ä¿®æ”¹ifcfg-br0</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">1ã€TYPE=<span class="string">&quot;Ethernet&quot;</span>   <span class="comment"># ä¿®æ”¹ä¸ºTYPE=&quot;Bridge&quot;</span></span><br><span class="line">2ã€BOOTPROTO=<span class="string">&quot;dhcp&quot;</span>  <span class="comment"># æ”¹ä¸ºÂ BOOTPROTO=&quot;static&quot;</span></span><br><span class="line">3ã€NAME=<span class="string">&quot;ens33&quot;</span>      <span class="comment"># ä¿®æ”¹ä¸ºÂ NAME=&quot;br0&quot;Â  åŠÂ DEVICE=&quot;ens33&quot;Â  ä¿®æ”¹ä¸ºÂ DEVICE=&quot;br0&quot;</span></span><br><span class="line">4ã€æ³¨é‡Š UUIDÂ  Â  Â     <span class="comment"># UUID=&quot;a8d78ec6-485c-4d14-aae1-1908bc6b9a61&quot;</span></span><br><span class="line">5ã€é…ç½®é™æ€IP</span><br><span class="line">IPADDR=10.0.0.20</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=223.5.5.5</span><br><span class="line"><span class="comment"># å®Œæ•´ç½‘å¡é…ç½® -------------------------------</span></span><br><span class="line">TYPE=Bridge</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=br0</span><br><span class="line"><span class="comment"># UUID=01d75770-3b87-47e3-bbc3-bebaed2293e3</span></span><br><span class="line">DEVICE=br0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">IPADDR=10.0.0.20</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=223.5.5.5</span><br></pre></td></tr></table></figure><h3 id="3ã€æœ€åé‡å¯ç½‘å¡ç”Ÿæ•ˆ"><a href="#3ã€æœ€åé‡å¯ç½‘å¡ç”Ÿæ•ˆ" class="headerlink" title="3ã€æœ€åé‡å¯ç½‘å¡ç”Ÿæ•ˆ"></a>3ã€æœ€åé‡å¯ç½‘å¡ç”Ÿæ•ˆ</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡å¯ç½‘å¡</span></span><br><span class="line">systemctl restart network.service</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶é…ç½®å®Œæˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sshæ‰‹åŠ¨æ·»åŠ å…å¯†</title>
      <link href="/2025/06/23/ssh%E6%89%8B%E5%8A%A8%E6%B7%BB%E5%8A%A0%E5%85%8D%E5%AF%86/"/>
      <url>/2025/06/23/ssh%E6%89%8B%E5%8A%A8%E6%B7%BB%E5%8A%A0%E5%85%8D%E5%AF%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="sshæ‰‹åŠ¨æ·»åŠ å…å¯†"><a href="#sshæ‰‹åŠ¨æ·»åŠ å…å¯†" class="headerlink" title="sshæ‰‹åŠ¨æ·»åŠ å…å¯†"></a>sshæ‰‹åŠ¨æ·»åŠ å…å¯†</h2><p>æŠ¥é”™ï¼š</p><p>wslç¯å¢ƒ root@k8s:~/ansible# ssh-copy-id <a href="mailto:&#114;&#x6f;&#x6f;&#116;&#64;&#x31;&#57;&#50;&#x2e;&#x31;&#54;&#56;&#x2e;&#51;&#x31;&#46;&#x31;&#54;&#53;">&#114;&#x6f;&#x6f;&#116;&#64;&#x31;&#57;&#50;&#x2e;&#x31;&#54;&#56;&#x2e;&#51;&#x31;&#46;&#x31;&#54;&#53;</a> /usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: â€œ/root/.ssh/id_rsa.pubâ€ /usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed /usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed â€“ if you are prompted now it is to install the new keys <a href="mailto:&#114;&#x6f;&#111;&#116;&#x40;&#49;&#57;&#50;&#46;&#49;&#x36;&#x38;&#46;&#51;&#49;&#46;&#x31;&#x36;&#53;">&#114;&#x6f;&#111;&#116;&#x40;&#49;&#57;&#50;&#46;&#49;&#x36;&#x38;&#46;&#51;&#49;&#46;&#x31;&#x36;&#53;</a>: Permission denied (publickey).</p><p>è¿™ä¸ªæƒ…å†µè¯´æ˜ï¼š</p><ul><li>WSL æœ¬åœ°å·²ç”Ÿæˆäº† SSH å¯†é’¥ï¼ˆ<code>/root/.ssh/id_rsa.pub</code>ï¼‰ï¼›</li><li><code>ssh-copy-id</code> æˆåŠŸè¯»å–äº†å…¬é’¥ï¼›</li><li><strong>ä½†ç›®æ ‡ä¸»æœº <code>192.168.31.165</code> ç¦ç”¨äº†å¯†ç ç™»å½•</strong>ï¼Œæ‰€ä»¥ <code>ssh-copy-id</code> æ— æ³•ç™»å½•è¿›å»å®‰è£…å…¬é’¥ã€‚</li></ul><hr><h2 id="âœ…-è§£å†³æ–¹æ³•"><a href="#âœ…-è§£å†³æ–¹æ³•" class="headerlink" title="âœ… è§£å†³æ–¹æ³•"></a>âœ… è§£å†³æ–¹æ³•</h2><p>å› ä¸ºç›®æ ‡ä¸»æœºåªæ”¯æŒ <code>publickey</code> ç™»å½•ï¼Œä½ æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š</p><hr><h3 id="æ–¹æ¡ˆ-1ï¼šæ‰‹åŠ¨é€šè¿‡ç›®æ ‡ä¸»æœºæ§åˆ¶å°æ·»åŠ å…¬é’¥"><a href="#æ–¹æ¡ˆ-1ï¼šæ‰‹åŠ¨é€šè¿‡ç›®æ ‡ä¸»æœºæ§åˆ¶å°æ·»åŠ å…¬é’¥" class="headerlink" title="æ–¹æ¡ˆ 1ï¼šæ‰‹åŠ¨é€šè¿‡ç›®æ ‡ä¸»æœºæ§åˆ¶å°æ·»åŠ å…¬é’¥"></a><strong>æ–¹æ¡ˆ 1ï¼šæ‰‹åŠ¨é€šè¿‡ç›®æ ‡ä¸»æœºæ§åˆ¶å°æ·»åŠ å…¬é’¥</strong></h3><p>å¦‚æœä½ èƒ½ç™»å½•ç›®æ ‡ä¸»æœºçš„æ§åˆ¶å°ï¼ˆæ¯”å¦‚é€šè¿‡ VMware/ESXi/vCenterã€KVM æ§åˆ¶å°æˆ–è€…ç‰©ç†æœºï¼‰ï¼Œè¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><h4 id="ğŸš€-1-åœ¨-WSL-æŸ¥çœ‹å…¬é’¥å†…å®¹ï¼š"><a href="#ğŸš€-1-åœ¨-WSL-æŸ¥çœ‹å…¬é’¥å†…å®¹ï¼š" class="headerlink" title="ğŸš€ 1. åœ¨ WSL æŸ¥çœ‹å…¬é’¥å†…å®¹ï¼š"></a>ğŸš€ 1. åœ¨ WSL æŸ¥çœ‹å…¬é’¥å†…å®¹ï¼š</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> ~/.ssh/id_rsa.pub</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå½¢å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA1z... root@k8s</span><br></pre></td></tr></table></figure><h4 id="ğŸ› -2-åœ¨ç›®æ ‡ä¸»æœºï¼ˆ192-168-31-165ï¼‰ä¸Šæ‰§è¡Œï¼š"><a href="#ğŸ› -2-åœ¨ç›®æ ‡ä¸»æœºï¼ˆ192-168-31-165ï¼‰ä¸Šæ‰§è¡Œï¼š" class="headerlink" title="ğŸ›  2. åœ¨ç›®æ ‡ä¸»æœºï¼ˆ192.168.31.165ï¼‰ä¸Šæ‰§è¡Œï¼š"></a>ğŸ›  2. åœ¨ç›®æ ‡ä¸»æœºï¼ˆ192.168.31.165ï¼‰ä¸Šæ‰§è¡Œï¼š</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /root/.ssh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ã€ä¸Šé¢é‚£ä¸²å…¬é’¥å†…å®¹ã€‘&quot;</span> &gt;&gt; /root/.ssh/authorized_keys</span><br><span class="line"><span class="built_in">chmod</span> 700 /root/.ssh</span><br><span class="line"><span class="built_in">chmod</span> 600 /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure><p>ç¡®ä¿ <code>sshd_config</code> ä¸­å¦‚ä¸‹å†…å®¹æ²¡æœ‰è¢«ç¦ç”¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PermitRootLogin <span class="built_in">yes</span></span><br><span class="line">PubkeyAuthentication <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åé‡å¯ SSH æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart ssh</span><br></pre></td></tr></table></figure><hr><h3 id="æ–¹æ¡ˆ-2ï¼šä¸´æ—¶å…è®¸å¯†ç ç™»å½•ç”¨äº-ssh-copy-id"><a href="#æ–¹æ¡ˆ-2ï¼šä¸´æ—¶å…è®¸å¯†ç ç™»å½•ç”¨äº-ssh-copy-id" class="headerlink" title="æ–¹æ¡ˆ 2ï¼šä¸´æ—¶å…è®¸å¯†ç ç™»å½•ç”¨äº ssh-copy-id"></a><strong>æ–¹æ¡ˆ 2ï¼šä¸´æ—¶å…è®¸å¯†ç ç™»å½•ç”¨äº ssh-copy-id</strong></h3><blockquote><p>ä»…å»ºè®®ä½ ä¸´æ—¶æ”¹ä¸€ä¸‹ï¼Œç”¨å®Œå†æ”¹å›å»ï¼</p></blockquote><h4 id="åœ¨ç›®æ ‡æœºä¿®æ”¹-etc-ssh-sshd-configï¼š"><a href="#åœ¨ç›®æ ‡æœºä¿®æ”¹-etc-ssh-sshd-configï¼š" class="headerlink" title="åœ¨ç›®æ ‡æœºä¿®æ”¹ /etc/ssh/sshd_configï¼š"></a>åœ¨ç›®æ ‡æœºä¿®æ”¹ <code>/etc/ssh/sshd_config</code>ï¼š</h4><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PermitRootLogin yes</span><br><span class="line">PasswordAuthentication yes</span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯ SSH æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart ssh</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨ WSL æ‰§è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id root@192.168.31.165</span><br></pre></td></tr></table></figure><p>éªŒè¯åå»ºè®®æŠŠ <code>PasswordAuthentication</code> æ”¹å› <code>no</code>ï¼Œæé«˜å®‰å…¨æ€§ã€‚</p><hr><h3 id="âœ…-éªŒè¯-SSH-æ˜¯å¦æˆåŠŸï¼š"><a href="#âœ…-éªŒè¯-SSH-æ˜¯å¦æˆåŠŸï¼š" class="headerlink" title="âœ… éªŒè¯ SSH æ˜¯å¦æˆåŠŸï¼š"></a>âœ… éªŒè¯ SSH æ˜¯å¦æˆåŠŸï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@192.168.31.165</span><br></pre></td></tr></table></figure><p>è‹¥æ— éœ€å¯†ç ï¼Œè¯´æ˜é…ç½®æˆåŠŸï¼Œæ­¤æ—¶ Ansible å°±èƒ½æ­£å¸¸è·‘äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible all -i host -m ping</span><br></pre></td></tr></table></figure><hr><p>éœ€è¦æˆ‘å¸®ä½ å†™è‡ªåŠ¨æ£€æµ‹æ˜¯å¦å·²é…ç½® SSH å…¬é’¥ã€è‡ªåŠ¨æ¨é€è„šæœ¬ï¼Œä¹Ÿå¯ä»¥ç»§ç»­å‘Šè¯‰æˆ‘ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ssh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å››ã€ansibleå„ä¸ªæ¨¡å—ç»„ä»¶ä»‹ç»ä¸ä½¿ç”¨</title>
      <link href="/2025/06/22/%E5%9B%9B%E3%80%81ansible%E5%90%84%E4%B8%AA%E6%A8%A1%E5%9D%97%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8/"/>
      <url>/2025/06/22/%E5%9B%9B%E3%80%81ansible%E5%90%84%E4%B8%AA%E6%A8%A1%E5%9D%97%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D%E4%B8%8E%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="å››ã€ansibleå„ä¸ªæ¨¡å—ç»„ä»¶ä»‹ç»ä¸ä½¿ç”¨"><a href="#å››ã€ansibleå„ä¸ªæ¨¡å—ç»„ä»¶ä»‹ç»ä¸ä½¿ç”¨" class="headerlink" title="å››ã€ansibleå„ä¸ªæ¨¡å—ç»„ä»¶ä»‹ç»ä¸ä½¿ç”¨"></a>å››ã€ansibleå„ä¸ªæ¨¡å—ç»„ä»¶ä»‹ç»ä¸ä½¿ç”¨</h2><h3 id="ä¸€ã€inventoryæ¨¡å—"><a href="#ä¸€ã€inventoryæ¨¡å—" class="headerlink" title="ä¸€ã€inventoryæ¨¡å—"></a>ä¸€ã€inventoryæ¨¡å—</h3><p>inventoryæ–‡ä»¶ä¸­å¡«å†™éœ€è¦è¢«ç®¡ç†ä¸»æœºä¸ä¸»æœºä¿¡æ¯ï¼ˆé€»è¾‘ä¸Šå®šä¹‰ï¼‰ã€‚</p><p>é»˜è®¤inventoryæ–‡ä»¶åœ¨ï¼š/etc/ansible/hosts</p><p>å¯ä»¥è‡ªå®šä¹‰ ä½¿ç”¨-i é€‰é¡¹æŒ‡å®šinventoryç»„ä»¶çš„æ–‡ä»¶ä½ç½®ã€‚</p><p>é…ç½®invertoyæ–‡ä»¶</p><h4 id="åœºæ™¯1"><a href="#åœºæ™¯1" class="headerlink" title="åœºæ™¯1"></a>åœºæ™¯1</h4><p>åŸºäºå¯†ç è¿æ¥ï¼ˆæ–¹å¼1ï¼Œä¸»æœº+ç«¯å£+å¯†ç ï¼‰</p><p>å›ºå®šçš„æ ¼å¼ä¸ºï¼š</p><ol start="0"><li>ä¸»æœº ï¼šåœ¨æœ€å‰10.0.0.10</li><li>ç«¯å£ ï¼šansible_ssh_port=22</li><li>ç”¨æˆ· ï¼šansible_ssh_user=root</li><li>å¯†ç  ï¼›ansible_ssh_pass=â€™123456â€™</li><li>[webservers] ï¼šæ˜¯é¡¹ç›®åç§°</li></ol><p><strong>å†™æ³•å¦‚ä¸‹ï¼š</strong></p><p>å†™æ³•1ï¼ˆå¸¸ç”¨ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[webservers]</span><br><span class="line">10.0.0.10  ansible_ssh_port=22 ansible_ssh_user=root ansible_ssh_pass=â€™123456â€™</span><br><span class="line">10.0.0.11  ansible_ssh_port=22 ansible_ssh_user=root ansible_ssh_pass=â€™123456â€™</span><br></pre></td></tr></table></figure><p>å†™æ³•2</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[webservers]</span><br><span class="line">Web[1:2].oldboy.com ansible_ssh_pass=â€™123456â€™[webservers]</span><br><span class="line">Web[1:2].oldboy.com ansible_ssh_pass=â€™123456â€™</span><br></pre></td></tr></table></figure><p>å†™æ³•3</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[webservers]</span><br><span class="line">Web[1:2].oldboy.com</span><br><span class="line">[webserversï¼švars]  <span class="comment"># æ„ä¸ºæŠŠweb....è¿™ä¸ªç»„è®¾ç½®ä¸ºå˜é‡ è¿æ¥æ—¶ç›´æ¥ä½¿ç”¨ä¸‹æ–¹å¯†ç </span></span><br><span class="line">ansible_ssh_pass=â€™123456â€™</span><br></pre></td></tr></table></figure><h4 id="æ¼”ç¤ºï¼šåœ¨åˆšæ‰æ–°å»ºçš„é¡¹ç›®ä¸‹é¢æ–°å»ºè‡ªå®šä¹‰inventoryæ¸…å•"><a href="#æ¼”ç¤ºï¼šåœ¨åˆšæ‰æ–°å»ºçš„é¡¹ç›®ä¸‹é¢æ–°å»ºè‡ªå®šä¹‰inventoryæ¸…å•" class="headerlink" title="æ¼”ç¤ºï¼šåœ¨åˆšæ‰æ–°å»ºçš„é¡¹ç›®ä¸‹é¢æ–°å»ºè‡ªå®šä¹‰inventoryæ¸…å•"></a>æ¼”ç¤ºï¼šåœ¨åˆšæ‰æ–°å»ºçš„é¡¹ç›®ä¸‹é¢æ–°å»ºè‡ªå®šä¹‰inventoryæ¸…å•</h4><p>æ³¨ï¼šæ­¤ç§æ–¹æ³•ä¸æ˜¯å¾ˆå®‰å…¨ä¸å¸¸ç”¨éœ€è¦å…ˆç»™è¢«æ§ç«¯å®‰è£…pythonã€‚</p><p>æ–°å»ºæ–‡ä»¶hosts</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[fruit]</span><br><span class="line">192.168.31.165  ansible_ssh_port=22 ansible_ssh_user=root ansible_ssh_pass=<span class="string">&#x27;123&#x27;</span></span><br><span class="line"><span class="comment">#10.0.0.11  ansible_ssh_port=22 ansible_ssh_user=root ansible_ssh_pass=&#x27;123&#x27;</span></span><br><span class="line">~                                                                        </span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#python2.7.5å®‰è£…</span></span><br><span class="line">sudo apt update</span><br><span class="line">sudo apt install -y build-essential zlib1g-dev libssl-dev \</span><br><span class="line">  libncurses5-dev libncursesw5-dev libreadline-dev libsqlite3-dev \</span><br><span class="line">  libgdbm-dev libdb5.3-dev libbz2-dev libffi-dev wget</span><br><span class="line"></span><br><span class="line"><span class="built_in">cd</span> /usr/src</span><br><span class="line">sudo wget https://www.python.org/ftp/python/2.7.5/Python-2.7.5.tgz</span><br><span class="line">sudo tar xzf Python-2.7.5.tgz</span><br><span class="line"><span class="built_in">cd</span> /usr/src/Python-2.7.5</span><br><span class="line"></span><br><span class="line">sudo ./configure --prefix=/usr/local/python2.7.5</span><br><span class="line">sudo make</span><br><span class="line">sudo make install</span><br><span class="line"></span><br><span class="line">/usr/local/python2.7.5/bin/python2.7 -V</span><br><span class="line"></span><br><span class="line">sudo <span class="built_in">ln</span> -s /usr/local/python2.7.5/bin/python2.7 /usr/local/bin/python2.7.5</span><br><span class="line"></span><br><span class="line">python2.7.5</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ansible </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ansible </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‰ã€ansibleé…ç½®æ–‡ä»¶è§£æ</title>
      <link href="/2025/06/22/%E4%B8%89%E3%80%81ansible%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90/"/>
      <url>/2025/06/22/%E4%B8%89%E3%80%81ansible%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%A7%A3%E6%9E%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸‰ã€ansibleé…ç½®æ–‡ä»¶è§£æ"><a href="#ä¸‰ã€ansibleé…ç½®æ–‡ä»¶è§£æ" class="headerlink" title="ä¸‰ã€ansibleé…ç½®æ–‡ä»¶è§£æ"></a>ä¸‰ã€ansibleé…ç½®æ–‡ä»¶è§£æ</h2><p>cat /etc/ansible/ansible.cfg</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[defaults]</span><br><span class="line"></span><br><span class="line"><span class="comment"># some basic default values...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#inventory      = /etc/ansible/hosts  </span></span><br><span class="line"><span class="comment">#library        = /usr/share/my_modules/              # ä¸»æœºåˆ—è¡¨é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="comment">#module_utils   = /usr/share/my_module_utils/         # åº“æ–‡ä»¶å­˜æ”¾ç›®å½•</span></span><br><span class="line"><span class="comment">#remote_tmp     = ~/.ansible/tmp                      # ä¸´æ—¶pyæ–‡ä»¶å­˜æ”¾åœ¨è¿œç¨‹ä¸»æœºç›®å½•</span></span><br><span class="line"><span class="comment">#local_tmp      = ~/.ansible/tmp                      # æœ¬æœºçš„ä¸´æ—¶æ‰§è¡Œç›®å½•</span></span><br><span class="line"><span class="comment">#plugin_filters_cfg = /etc/ansible/plugin_filters.yml </span></span><br><span class="line"><span class="comment">#forks          = 5       # é»˜è®¤å¹¶å‘æ•°</span></span><br><span class="line"><span class="comment">#poll_interval  = 15  </span></span><br><span class="line"><span class="comment">#sudo_user      = root    # é»˜è®¤sudoç”¨æˆ·</span></span><br><span class="line"><span class="comment">#ask_sudo_pass = True     # æ¯æ¬¡æ‰§è¡Œæ˜¯å¦è¯¢é—®sudoçš„sshå¯†ç </span></span><br><span class="line"><span class="comment">#ask_pass      = True     # æ¯æ¬¡æ‰§è¡Œæ˜¯å¦è¯¢é—®sshå¯†ç </span></span><br><span class="line"><span class="comment">#transport      = smart</span></span><br><span class="line"><span class="comment">#remote_port    = 22      # è¿œç¨‹ä¸»æœºç«¯å£</span></span><br><span class="line"><span class="comment">#module_lang    = C</span></span><br><span class="line"><span class="comment">#module_set_locale = False </span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ansible </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ansible </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒã€ansibleå®‰è£…</title>
      <link href="/2025/06/22/%E4%BA%8C%E3%80%81ansible%E5%AE%89%E8%A3%85/"/>
      <url>/2025/06/22/%E4%BA%8C%E3%80%81ansible%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="äºŒã€ansibleå®‰è£…"><a href="#äºŒã€ansibleå®‰è£…" class="headerlink" title="äºŒã€ansibleå®‰è£…"></a>äºŒã€ansibleå®‰è£…</h2><h3 id="ubuntuä¸centosï¼ˆæ¢æºé˜¿é‡Œäº‘åç›´æ¥å®‰è£…ï¼‰"><a href="#ubuntuä¸centosï¼ˆæ¢æºé˜¿é‡Œäº‘åç›´æ¥å®‰è£…ï¼‰" class="headerlink" title="ubuntuä¸centosï¼ˆæ¢æºé˜¿é‡Œäº‘åç›´æ¥å®‰è£…ï¼‰"></a>ubuntuä¸centosï¼ˆæ¢æºé˜¿é‡Œäº‘åç›´æ¥å®‰è£…ï¼‰</h3><p>centoséœ€è¦epel.repoæºï¼š<a href="https://developer.aliyun.com/mirror/epel/">https://developer.aliyun.com/mirror/epel/</a></p><p>æ¢æºï¼š<a href="https://developer.aliyun.com/mirror/">https://developer.aliyun.com/mirror/</a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">apt</span> <span class="string">install</span> <span class="string">-y</span> <span class="string">ansible</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@k8s:/mydata/jenkins_home/secrets# ansible --version</span><br><span class="line">ansible 2.9.6</span><br><span class="line">  config file = /etc/ansible/ansible.cfg</span><br><span class="line">  configured module search path = [&#x27;/root/.ansible/plugins/modules&#x27;, &#x27;/usr/share/ansible/plugins/modules&#x27;]</span><br><span class="line">  ansible python module location = /usr/lib/python3/dist-packages/ansible</span><br><span class="line">  executable location = /usr/bin/ansible</span><br><span class="line">  python version = 3.8.10 (default, Mar 18 2025, 20:04:55) [GCC 9.4.0]</span><br></pre></td></tr></table></figure><p>centoså¯ç”¨åšä¸»å¤šå¹´ä»¥å‰å†™çš„è„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment">#ä½œç”¨ï¼šå®‰è£…ansible</span></span><br><span class="line"><span class="function"><span class="title">welcome</span></span>() &#123;</span><br><span class="line"><span class="built_in">cat</span> &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">1.éœ€è¦ç”¨åˆ°çš„å‘½ä»¤awk/ansible --version </span></span><br><span class="line"><span class="string">2.éœ€è¦ç”¨åˆ°çš„å¾ªç¯for/if å®‰è£…ansibleéœ€è¦epelæº</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">start</span></span>() &#123;</span><br><span class="line">   epel_check=`<span class="built_in">ls</span> /etc/yum.repos.d/epel.repo`</span><br><span class="line">   version=`ansible --version |awk -F<span class="string">&#x27;[ .]+&#x27;</span> <span class="string">&#x27;NR==1&#123;print $1&#125;&#x27;</span>`</span><br><span class="line">&#125;</span><br><span class="line">[ -f <span class="variable">$&#123;epel_check&#125;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;å·²å­˜åœ¨epelæº&quot;</span> || wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</span><br><span class="line"><span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$&#123;epel_check&#125;</span>&quot;</span> = <span class="string">&quot;epel.repo&quot;</span> -a <span class="string">&quot;<span class="variable">$&#123;version&#125;</span>&quot;</span> = <span class="string">&quot;ansible&quot;</span> ];</span><br><span class="line">   <span class="keyword">then</span></span><br><span class="line">     <span class="built_in">echo</span> <span class="string">&quot;ansibleå·²å®‰è£…&quot;</span></span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">     yum install -y ansible</span><br><span class="line">     [ <span class="string">&quot;$?&quot;</span> = <span class="string">&quot;0&quot;</span> ] &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;å®‰è£…æˆåŠŸ&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;å®‰è£…å¤±è´¥è¯·æ£€æŸ¥&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">main</span></span>() &#123;</span><br><span class="line">  welcome</span><br><span class="line">  start</span><br><span class="line">&#125;</span><br><span class="line">main</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ansible </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ansible </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ã€ansibleä»‹ç»</title>
      <link href="/2025/06/22/%E4%B8%80%E3%80%81ansible%E4%BB%8B%E7%BB%8D/"/>
      <url>/2025/06/22/%E4%B8%80%E3%80%81ansible%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€ansibleä»‹ç»"><a href="#ä¸€ã€ansibleä»‹ç»" class="headerlink" title="ä¸€ã€ansibleä»‹ç»"></a>ä¸€ã€ansibleä»‹ç»</h2><p>ansibleè¿è¡Œçš„åŸºæœ¬è¿‡ç¨‹å›¾</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_9c322e7552ff461af69593bd94873582.png"></p><p>éœ€è¦å­¦ä¹ çš„ç›®æ ‡</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_59a850ba496c92d30545e695e71d8c2e.png"></p><h3 id="ä¸€ã€ä»€ä¹ˆæ˜¯ansible"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯ansible" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯ansible"></a>ä¸€ã€ä»€ä¹ˆæ˜¯ansible</h3><p>Ansibleé¦–æ¬¡å‘å¸ƒäº2012å¹´ï¼Œä½œè€…MichaelDeHaan</p><ul><li>MichaelDeHaanä¹Ÿæ˜¯cobblerçš„ä½œè€…</li><li>äº2015å¹´è¢«redhatæ”¶è´­</li></ul><p>Ansibleæ˜¯ä¸€æ¬¾è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·ã€åŸºäºpythonå¼€å‘</p><ul><li>æ‰¹é‡ç³»ç»Ÿé…ç½®</li><li>æ‰¹é‡ç¨‹åºéƒ¨ç½²</li><li>æ‰¹é‡è¿è¡Œå‘½ä»¤ç­‰åŠŸèƒ½</li></ul><p>Ansibleæ˜¯ä¸€ä¸ªitè‡ªåŠ¨åŒ–é…ç½®ç®¡ç†å·¥å…·è‡ªåŠ¨åŒ–ä¸»è¦ä½“ç°åœ¨absibleé›†æˆäº†ä¸°å¯Œæ¨¡å—ä¸°å¯Œçš„åŠŸèƒ½ç»„ä»¶ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªå‘½ä»¤è¡Œå®Œæˆä¸€äº›åˆ—çš„æ“ä½œã€‚è¿›è€Œå‡å°‘é‡å¤æ€§çš„å·¥ä½œå’Œç»´æŠ¤æˆæœ¬ï¼Œä»¥æé«˜å·¥ä½œæ•ˆç‡ã€‚</p><p><strong>å¦‚åœ¨10å°æœåŠ¡å™¨ä¸Šå®‰è£…nginxæœåŠ¡</strong></p><p>å‡è®¾æˆ‘ä»¬è¦åœ¨10å°linxæœåŠ¡å™¨ä¸Šå®‰è£…ä¸€ä¸ªnginxæœåŠ¡ï¼Œæ‰‹åŠ¨å¦‚ä½•ä½œçš„?</p><ul><li>ç¬¬ä¸€æ­¥ã€sshç™»é™†NUM(1..n)æœåŠ¡å™¨</li><li>ç¬¬äºŒæ­¥ã€è¾“å…¥å¯¹åº”æœåŠ¡å™¨å¯†ç </li><li>ç¬¬ä¸‰æ­¥ã€å®‰è£…yum install nginx</li><li>ç¬¬å››æ­¥ã€å¯åŠ¨systemctl start nginx</li><li>ç¬¬äº”æ­¥ã€é€€å‡ºç™»å½•</li></ul><p>å¦‚æ­¤å¾ªç¯åæ¬¡</p><p><strong>Ansibleå¯ä»¥å®Œæˆè¿™äº›åŠŸèƒ½</strong></p><ol><li>æ‰¹é‡æ‰§è¡Œè¿œç¨‹å‘½ä»¤ï¼Œå¯ä»¥å¯¹nå°ä¸»æœºåŒæ—¶è¿›è¡Œå‘½ä»¤çš„æ‰§è¡Œ</li><li>æ‰¹é‡é…ç½®è½¯ä»¶æœåŠ¡ï¼Œå¯ä»¥è¿›è¡Œè‡ªåŠ¨åŒ–çš„æ–¹å¼é…ç½®å’Œç®¡ç†æœåŠ¡</li><li>å®ç°è½¯ä»¶å¼€å‘åŠŸèƒ½ï¼Œjumpserveråº•å±‚ä½¿ç”¨ansibleæ¥å®ç°è‡ªåŠ¨åŒ–ç®¡ç†</li><li>ç¼–æ’é«˜çº§çš„ITä»»åŠ¡ï¼Œansibleçš„playbookæ˜¯ä¸€é—¨ç¼–ç¨‹è¯­è¨€å¯ä»¥ç”¨æ¥æç»˜ä¸€å°ITçš„æ¶æ„ã€‚</li></ol><p><strong>Ansibleçš„ç‰¹ç‚¹</strong></p><ol><li>å®¹æ˜“å­¦ä¹ ï¼Œæ— ä»£ç†æ¨¡å¼ï¼Œä¸åƒsaltstackæ—¢è¦å­¦å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ï¼Œè¿˜éœ€è¦å­¦ä¹ å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¸­é—´é€šè®¯åè®®</li><li>æ“ä½œçµæ´»ï¼Œä½“ç°åœ¨Ansibleæœ‰è¾ƒå¤šçš„æ¨¡å—ï¼Œæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ã€playbookåˆ™æä¾›ç±»ä¼¼äºç¼–ç¨‹è¯­è¨€çš„å¤æ‚åŠŸ</li><li>ç®€å•æ˜“ç”¨ä½“ç°åœ¨Ansibleä¸€ä¸ªå‘½ä»¤å¯ä»¥å®Œæˆå¾ˆå¤šäº‹æƒ…ã€‚</li><li>å®‰å…¨å¯é å› ä¸ºAnsibleä½¿ç”¨äº†SSHåè®®è¿›è¡Œé€šè®¯ï¼Œè”ç¨³å®šä¹Ÿå®‰å…¨</li><li>ç§»æ¤æ€§é«˜ï¼Œå¯ä»¥å°†å†™å¥½çš„playbookæ‹·è´è‡³ä»»æ„æœºå™¨è¿›è¡Œæ‰§è¡Œ</li></ol><p><strong>Ansibleçš„pythonåªèƒ½æ˜¯2.7.5.ä¸èƒ½å‡çº§åˆ°python3</strong></p><p>æ§åˆ¶ç«¯ä¸è¢«æ§ç«¯å¿…é¡»æœ‰python</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_0157a38c37fb66d1a4da9e5796c38a74.png"></p><p><strong>Ansibleâ€“version è§£æ</strong></p><ul><li>Ansibleç‰ˆæœ¬ï¼š2.9.72</li><li>é…ç½®æ–‡ä»¶ï¼š/etc/ansible/ansible.cfg</li><li>é…ç½®æ¨¡å—æŸ¥æ‰¾çš„è·¯å¾„ï¼š</li><li>/home/gegewu/.ansible/plugins/modules</li><li>/usr/share/ansible/plugins/modules</li><li>Pythonæ¨¡å—è·¯å¾„ï¼š/usr/lib/python2.7/site-packages/ansible</li><li>æ‰§è¡Œä½ç½®ï¼š /usr/bin/ansible</li></ul><p><strong>Ansibleå­˜åœ¨ä¼˜å…ˆçº§é—®é¢˜</strong></p><p>Ansibleçš„é…ç½®æ–‡ä»¶å¯ä»¥å­˜æ”¾åœ¨ä»»ä½•ä½ç½®ï¼Œä½†é…ç½®æ–‡ä»¶æœ‰è¯»å–é¡ºåºï¼Œå…ˆAnsibleé…ç½®åšä¸€ä¸ªåŸºæœ¬äº†è§£ã€‚ansibleçš„é…ç½®æ–‡ä»¶æœ‰æŸ¥æ‰¾é¡ºåºï¼ˆå¯é€šè¿‡ansible â€“versionæŸ¥çœ‹ï¼‰:</p><ol><li>æœ€å…ˆæŸ¥æ‰¾SANSIBLECONFIGå˜é‡</li><li>å…¶æ¬¡æŸ¥æ‰¾å½“å‰æ—¥å½•ä¸‹ansible.cfg</li><li>ç„¶åæŸ¥æ‰¾ç”¨æˆ·å®¶æ—¥å½•ä¸‹çš„.ansible.cfg</li><li>æœ€åæŸ¥æ‰¾â€™etc/ansible/ansible.cfg(è®¤)</li></ol><p><strong>ä¾‹1ï¼šæµ‹è¯•ä¼˜å…ˆçº§ç¬¬äºŒä¸ªé…ç½®æ–‡ä»¶é¡¹ç›®ç›®å½•ä¸‹çš„ansible.cfg</strong></p><p>åœ¨å®¶ç›®å½•åˆ›å»ºä¸€ä¸ªé¡¹ç›®</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_583529ab672b89f1555cdfe2c6346205.png"></p><p>å†åˆ°æ²¡æœ‰é¡¹ç›®çš„ç›®å½•æ—¶ï¼šå‰é¢ä¸‰ä¸ªæ²¡æ‰¾åˆ° æ¨åˆ°æœ€åä¸€ä¸ªé…ç½®æ–‡ä»¶</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_c3fb56ef97640110eda427530585ea87.png"></p><p><strong>ä¾‹2ï¼šæµ‹è¯•ä¼˜å…ˆçº§ç¬¬ä¸‰ä¸ªé…ç½®æ–‡ä»¶å®¶ç›®å½•ä¸‹çš„.ansible.cfg</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_8367c8a80acbec08d1b7c67cd33dbad7.png"></p><p><strong>ä¾‹3ï¼šæµ‹è¯•ä¼˜å…ˆçº§æœ€åä¸€ä¸ªä¸ªé…ç½®æ–‡ä»¶ï¼š/etc/ansible/ansible.cfg</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_214822b0205b0cc46856726e95ab106a.png"></p>]]></content>
      
      
      <categories>
          
          <category> ansible </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ansible </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‰ã€jenkinså®‰è£…</title>
      <link href="/2025/06/22/%E4%B8%89%E3%80%81jenkins%E5%AE%89%E8%A3%85/"/>
      <url>/2025/06/22/%E4%B8%89%E3%80%81jenkins%E5%AE%89%E8%A3%85/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸‰ã€jenkinså®‰è£…"><a href="#ä¸‰ã€jenkinså®‰è£…" class="headerlink" title="ä¸‰ã€jenkinså®‰è£…"></a>ä¸‰ã€jenkinså®‰è£…</h2><p>docker/k8sæ–¹å¼å®‰è£…jenkins</p><h3 id="dockeræ–¹å¼éƒ¨ç½²"><a href="#dockeræ–¹å¼éƒ¨ç½²" class="headerlink" title="dockeræ–¹å¼éƒ¨ç½²"></a>dockeræ–¹å¼éƒ¨ç½²</h3><p><strong>é•œåƒï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®˜æ–¹</span></span><br><span class="line">docker pull jenkins/jenkins:lts</span><br><span class="line"><span class="comment"># è‡ªæœ‰é˜¿é‡Œäº‘dockerä»“åº“</span></span><br><span class="line">docker pull registry.cn-hangzhou.aliyuncs.com/zznn/jenkins:lts</span><br></pre></td></tr></table></figure><p><strong>æ„å»ºjenkins</strong></p><p>å¦‚æœjenkinsæ— æ³•å¯åŠ¨åˆ™æ˜¯æŒä¹…åŒ–å®¿ä¸»æœºç›®å½•æƒé™æœ‰é—®é¢˜</p><ul><li><input checked disabled type="checkbox"> chown -R 1000 /mydata/jenkins_home</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /mydata/jenkins_home</span><br><span class="line">docker run -di --name=jenkins -p 8080:8080 -v /mydata/jenkins_home:/var/jenkins_home registry.cn-hangzhou.aliyuncs.com/zznn/jenkins:lts</span><br></pre></td></tr></table></figure><p><strong>docker-compose</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">jenkins:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/jenkins:lts</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">jenkins</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/mydata/jenkins_home:/var/jenkins_home</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure><h3 id="k8sæ–¹å¼éƒ¨ç½²"><a href="#k8sæ–¹å¼éƒ¨ç½²" class="headerlink" title="k8sæ–¹å¼éƒ¨ç½²"></a>k8sæ–¹å¼éƒ¨ç½²</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">jenkins</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">jenkins</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">jenkins</span> <span class="comment"># has to match .spec.template.metadata.labels</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">&quot;jenkins&quot;</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span> <span class="comment"># by default is 1               # 3å‰¯æœ¬</span></span><br><span class="line">  <span class="comment"># minReadySeconds: 10 # by default is 0</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">jenkins</span> <span class="comment"># has to match .spec.selector.matchLabels</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">jenkins</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/jenkins:lts</span></span><br><span class="line">        <span class="comment"># env:</span></span><br><span class="line">        <span class="comment"># - name: jenkins_ROOT_PASSWORD</span></span><br><span class="line">        <span class="comment">#   value: &quot;root_password&quot;  # è®¾ç½®æ ¹å¯†ç ,å»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/var/jenkins_home</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">jenkins-storage</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8080</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">jenkins</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">jenkins-storage</span></span><br><span class="line">          <span class="attr">hostPath:</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/mydata/jenkins_home</span>      <span class="comment"># å®¿ä¸»æœºç›®å½•</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span>     <span class="comment"># ç›®å½•å­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±å…ˆåˆ›å»ºåä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">service-jenkins</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">jenkins</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">jenkins</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8080</span></span><br><span class="line">  <span class="attr">sessionAffinity:</span> <span class="string">ClientIP</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span> <span class="comment"># å°†æœåŠ¡æš´éœ²ä¸º NodePort ç±»å‹</span></span><br></pre></td></tr></table></figure><p><strong>é€šè¿‡æ—¥å¿—æŸ¥çœ‹å¯†ç ï¼š70b19f8448b24a68bb8aa30dec2e3db4</strong></p><p><strong>åˆå§‹åŒ–å®Œæˆåæœ¬æ•™ç¨‹åˆ›å»ºadminè´¦æˆ·é»˜è®¤å¯†ç ç­‰éƒ½å†™admin</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_39ff478ad43429568ca44722b665b5c5.png"></p><p><strong>æ˜ å°„ç›®å½•</strong></p><p><strong>å®‰è£…å®Œæˆï¼ˆæœ€ååˆå§‹åŒ–è¿‡ç¨‹<strong><strong>éœ€è¦ç‚¹å‡»ä½¿ç”¨adminè´¦æˆ·ç»§ç»­</strong></strong>ï¼‰</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_49944c13e5842923fb378930487bd225.png"></p>]]></content>
      
      
      <categories>
          
          <category> jenkins </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jenkins </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒã€jenkinsæŒç»­é›†æˆçš„æ“ä½œæ­¥éª¤</title>
      <link href="/2025/06/22/%E4%BA%8C%E3%80%81jenkins%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E7%9A%84%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4/"/>
      <url>/2025/06/22/%E4%BA%8C%E3%80%81jenkins%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%E7%9A%84%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="äºŒã€jenkinsæŒç»­é›†æˆçš„æ“ä½œæ­¥éª¤"><a href="#äºŒã€jenkinsæŒç»­é›†æˆçš„æ“ä½œæ­¥éª¤" class="headerlink" title="äºŒã€jenkinsæŒç»­é›†æˆçš„æ“ä½œæ­¥éª¤"></a>äºŒã€jenkinsæŒç»­é›†æˆçš„æ“ä½œæ­¥éª¤</h2><p>æ ¹æ®æŒç»­é›†æˆçš„è®¾è®¡ã€ä»£ç ä»æäº¤åˆ°ç”Ÿäº§ã€æ•´ä¸ªç¯å¢ƒæœ‰ä»¥ä¸‹å‡ æ­¥ã€‚</p><p><strong>æäº¤</strong></p><p>æµç¨‹çš„ç¬¬ä¸€æ­¥ã€æ˜¯å¼€å‘è€…å‘ä»£ç ä»“åº“æäº¤ä»£ç ã€‚æ‰€æœ‰åé¢çš„æ­¥éª¤éƒ½å§‹äºæœ¬åœ°ä»£ç çš„ä¸€æ¬¡æäº¤ï¼ˆcommitï¼‰ã€‚</p><p><strong>æµ‹è¯•ï¼ˆç¬¬ä¸€è½®ï¼‰</strong></p><p>ä»£ç ä»“åº“å¯¹commitæ“ä½œé…ç½®äº†é’©å­ï¼ˆhookï¼‰ã€åªè¦æäº¤ä»£ç æˆ–è€…åˆå¹¶è¿›ä¸»å¹²ã€å°±ä¼šè·‘è‡ªåŠ¨åŒ–æµ‹è¯•ã€‚</p><p><strong>æµ‹è¯•çš„ç§ç±»ï¼š</strong></p><ul><li>å•å…ƒæµ‹è¯•ï¼šé’ˆå¯¹å‡½æ•°æˆ–æ¨¡å—çš„æµ‹è¯•</li><li>é›†æˆæµ‹è¯•ï¼šé’ˆå¯¹æ•´ä½“äº§å“çš„æŸä¸ªåŠŸèƒ½çš„æµ‹è¯•ã€åˆç§°åŠŸèƒ½æµ‹è¯•</li><li>ç«¯å¯¹ç«¯æµ‹è¯•ï¼šä»ç”¨æˆ·ç•Œé¢ç›´è¾¾æ•°æ®åº“çš„å…¨é“¾è·¯æµ‹è¯•ã€‚</li></ul><p><strong>æ„å»º</strong></p><p>é€šè¿‡ç¬¬ä¸€è½®æµ‹è¯•ã€ä»£ç å°±å¯ä»¥åˆå¹¶è¿›ä¸»å¹²ã€å°±ç®—å¯ä»¥äº¤ä»˜äº†ã€‚</p><p>äº¤ä»˜åã€å…ˆè¿›è¡Œæ„å»ºï¼ˆbulidï¼‰ã€å†è¿›è¡Œç¬¬äºŒè½®æµ‹è¯•ã€‚æ‰€è°“æ„å»ºã€æŒ‡çš„æ˜¯å°†æºç è½¬æ¢æˆå¯ä»¥ç›´æ¥è¿è¡Œçš„å®é™…ä»£ç ã€æ¯”å¦‚å®‰è£…ä¾èµ–ã€é…ç½®å„ç§èµ„æºï¼ˆæ ·å¼è¡¨ã€JSè„šæœ¬ã€å›¾ç‰‡ï¼‰ç­‰ç­‰ã€‚</p><p><strong>å¸¸ç”¨çš„æ„å»ºå·¥å…·å¦‚ä¸‹ï¼š</strong></p><ul><li>jenkins</li><li>travis</li><li>codeship</li><li>strider</li></ul><p>jenkinså’Œstarideræ˜¯å¼€æºè½¯ä»¶ã€traviså’Œcodeshipå¯¹äºå¼€æºé¡¹ç›®å¯ä»¥å…è´¹ä½¿ç”¨ã€‚ä»–ä»¬éƒ½ä¼šå°†æ„å»ºå’Œæµ‹è¯•ã€åœ¨ä¸€æ¬¡è¿è¡Œä¸­æ‰§è¡Œå®Œæˆã€‚</p><p><strong>æµ‹è¯•ï¼ˆç¬¬äºŒè½®ï¼‰</strong></p><p>æ„å»ºå®Œæˆã€å°±è¦è¿›è¡Œç¬¬äºŒè½®æµ‹è¯•ã€‚å¦‚æœç¬¬ä¸€è½®å·²ç»æ¶µç›–äº†æ‰€æœ‰æµ‹è¯•å†…å®¹ï¼Œç¬¬äºŒè½®å¯ä»¥å¿½ç•¥ï¼Œå½“ç„¶ã€è¿™æ—¶æ„å»ºæ­¥éª¤ä¹Ÿè¦ç§»åˆ°ç¬¬ä¸€è½®æµ‹è¯•å‰é¢ã€‚</p><p>ç¬¬äºŒè½®æ˜¯å…¨é¢æµ‹è¯•ã€å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•éƒ½ä¼šè·‘ï¼Œæœ‰æ¡ä»¶çš„è¯ï¼Œä¹Ÿè¦åšç«¯å¯¹ç«¯æµ‹è¯•ã€‚æ‰€æœ‰æµ‹è¯•ä»¥è‡ªåŠ¨åŒ–ä¸ºä¸»ï¼Œå°‘æ•°æ— æ³•è‡ªåŠ¨åŒ–çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå°±è¦äººå·¥è·‘ã€‚</p><p>éœ€è¦å¼ºè°ƒçš„æ˜¯ã€æ–°ç‰ˆæœ¬çš„æ¯ä¸€ä¸ªæ›´æ–°ç‚¹éƒ½å¿…é¡»æµ‹è¯•åˆ°ã€‚å¦‚æœæµ‹è¯•çš„è¦†ç›–ç‡ä¸é«˜ã€è¿›å…¥åé¢çš„éƒ¨ç½²é˜¶æ®µåã€å¾ˆå¯èƒ½ä¼šå‡ºç°ä¸¥é‡é—®é¢˜ã€‚</p><p><strong>éƒ¨ç½²</strong></p><p>é€šè¿‡äº†ç¬¬äºŒè½®æµ‹è¯•ã€å½“å‰ä»£ç å°±æ˜¯ä¸€ä¸ªå¯ä»¥ç›´æ¥éƒ¨ç½²çš„ç‰ˆæœ¬ï¼ˆartifackï¼‰ã€‚å°†è¿™ä¸ªç‰ˆæœ¬çš„æ‰€æœ‰æ–‡ä»¶æ‰“åŒ…ï¼ˆtar filename.tar*ï¼‰å­˜æ¡£ï¼Œå‘åˆ°ç”Ÿäº§æœåŠ¡å™¨ã€‚</p><p>ç”Ÿäº§æœåŠ¡å™¨å°†æ‰“åŒ…æ–‡ä»¶ï¼Œè§£åŒ…æˆæœ¬åœ°çš„ä¸€ä¸ªç›®å½•ã€å†å°†è¿è¡Œè·¯å¾„çš„ç¬¦å·é“¾æ¥ï¼ˆsymlinkï¼‰æŒ‡å‘è¿™ä¸ªç›®å½•ã€ç„¶åé‡å¯åº”ç”¨ã€‚è¿™æ–¹é¢çš„éƒ¨ç½²å·¥å…·æœ‰ansibleã€chefã€puppetç­‰ã€‚</p><p><strong>å›æ»š</strong></p><p>ä¸€ä½†å½“å‰ç‰ˆæœ¬å‘ç”Ÿé—®é¢˜ã€å°±è¦å›æ»šåˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬æ„å»ºçš„ç»“æœã€‚æœ€ç®€å•çš„åšæ³•å°±æ˜¯ä¿®æ”¹ä¸€ä¸‹ç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ä¸Šä¸€ä¸ªç‰ˆæœ¬çš„ç›®å½•ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> jenkins </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jenkins </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€ã€jenkinsï¼ˆcicdä»‹ç»ï¼‰</title>
      <link href="/2025/06/22/%E4%B8%80%E3%80%81jenkins%E4%BB%8B%E7%BB%8D/"/>
      <url>/2025/06/22/%E4%B8%80%E3%80%81jenkins%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€jenkinsï¼ˆcicdä»‹ç»ï¼‰"><a href="#ä¸€ã€jenkinsï¼ˆcicdä»‹ç»ï¼‰" class="headerlink" title="ä¸€ã€jenkinsï¼ˆcicdä»‹ç»ï¼‰"></a>ä¸€ã€jenkinsï¼ˆcicdä»‹ç»ï¼‰</h1><p>æ€ä¹ˆè¯´å‘¢ å»å¹´å°±æƒ³å­¦jinkensäº†ä¸€ç›´æ‹–åˆ°ç°åœ¨ äºŒåå››å²å·²ç»éƒ¨ç½²ä¸­å¹´æ‹–å»¶äº†  é‚£ä¹ˆå­¦ä¹ jenkinså°±ä»jenkinsä»‹ç»å¼€å§‹å§ å†²ï¼</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_6e6225dd1c97fd461dbae68abf994de4.png"></p><h2 id="ä¸€ã€ä»€ä¹ˆæ˜¯æŒç»­é›†æˆï¼ˆciï¼‰"><a href="#ä¸€ã€ä»€ä¹ˆæ˜¯æŒç»­é›†æˆï¼ˆciï¼‰" class="headerlink" title="ä¸€ã€ä»€ä¹ˆæ˜¯æŒç»­é›†æˆï¼ˆciï¼‰"></a>ä¸€ã€ä»€ä¹ˆæ˜¯æŒç»­é›†æˆï¼ˆciï¼‰</h2><p><strong>æŒç»­é›†æˆï¼ˆcontinuous integrationï¼‰æŒ‡çš„æ˜¯é¢‘ç¹çš„ï¼ˆä¸€å¤©å¤šæ¬¡ï¼‰å°†ä»£ç é›†æˆåˆ°ä¸»å¹²ã€‚ä»–çš„å¥½å¤„ä¸»è¦æœ‰ä¸¤ä¸ªï¼š</strong></p><ul><li><strong>å¿«é€Ÿå‘ç°é”™è¯¯æ²¡å®Œæˆä¸€ç‚¹æ›´æ–°å°±é›†æˆåˆ°ä¸»å¹²ã€å¯ä»¥å¿«é€Ÿçš„å‘ç°é”™è¯¯ã€å®šä½é”™è¯¯ä¹Ÿæ¯”è¾ƒå®¹æ˜“</strong></li><li><strong>é˜²æ­¢åˆ†æ”¯å¤§å¹…åº¦åç¦»ä¸»å¹²ã€‚å¦‚æœä¸æ˜¯ç»å¸¸é›†æˆã€ä¸»å¹²åˆåœ¨ä¸æ–­æ›´æ–°ã€ä¼šå¯¼è‡´ä»¥åé›†æˆçš„éš¾åº¦å˜å¤§ã€ç”šè‡³éš¾ä»¥é›†æˆ</strong></li></ul><p><strong>Martin Fowierè¯´è¿‡ã€â€œæŒç»­é›†æˆå¹¶ä¸èƒ½æ¶ˆé™¤bugã€è€Œæ˜¯è®©ä»–ä»¬éå¸¸å®¹æ˜“å‘ç°å’Œæ”¹æ­£â€ã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_a110c2eb492f2a70bf99e26a7a556270.png"></p><p><strong>æŒç»­é›†æˆå¼ºè°ƒå¼€å‘äººå‘˜æäº¤äº†æ–°ä»£ç ä¹‹åï¼Œç«‹å³è¿›è¡Œæ„å»ºï¼Œï¼ˆå•å…ƒï¼‰æµ‹è¯•ã€‚æ ¹æ®æµ‹è¯•ç»“æœã€æˆ‘ä»¬å¯ä»¥ç¡®å®šæ–°ä»£ç å’ŒåŸæœ‰ä»£ç èƒ½å¦æ­£ç¡®çš„é›†æˆåœ¨ä¸€èµ·ã€‚</strong></p><h2 id="äºŒã€æŒç»­äº¤ä»˜ï¼ˆCDï¼‰æ‰‹åŠ¨éƒ¨ç½²"><a href="#äºŒã€æŒç»­äº¤ä»˜ï¼ˆCDï¼‰æ‰‹åŠ¨éƒ¨ç½²" class="headerlink" title="äºŒã€æŒç»­äº¤ä»˜ï¼ˆCDï¼‰æ‰‹åŠ¨éƒ¨ç½²"></a>äºŒã€æŒç»­äº¤ä»˜ï¼ˆCDï¼‰æ‰‹åŠ¨éƒ¨ç½²</h2><p>æŒç»­äº¤ä»˜ï¼ˆcontinuous deliveryï¼‰æŒ‡çš„æ˜¯é¢‘ç¹çš„å°†è½¯ä»¶çš„æ–°ç‰ˆæœ¬ã€äº¤ä»˜ç»™è´¨é‡å›¢é˜Ÿæˆ–è€…ç”¨æˆ·ã€ä»¥ä¾›è¯„å®¡ã€‚å¦‚æœè¯„å®¡é€šè¿‡ã€ä»£ç å¯ä»¥è¿›å…¥ç”Ÿäº§é˜¶æ®µã€‚</p><p><strong>æŒç»­äº¤ä»˜å¯ä»¥çœ‹ä½œæŒç»­é›†æˆçš„ä¸‹ä¸€æ­¥ã€‚ä»–å¼ºè°ƒçš„æ˜¯ã€ä¸ç®¡æ€ä¹ˆæ›´æ–°ã€è½¯ä»¶æ˜¯éšæ—¶éšåœ°å¯ä»¥äº¤ä»˜çš„ã€‚</strong></p><p>æŒç»­äº¤ä»˜åœ¨æŒç»­é›†æˆçš„åŸºç¡€ä¸Šã€å°†é›†æˆåçš„ä»£ç éƒ¨ç½²åˆ°æ›´è´´è¿‘çœŸå®çš„è¿è¡Œç¯å¢ƒçš„{ç±»ç”Ÿäº§ç¯å¢ƒ}ï¼ˆproduction-like envionmentsï¼‰ä¸­ã€‚æ¯”å¦‚æˆ‘ä»¬å®Œæˆå•å…ƒæµ‹è¯•åã€å¯ä»¥æŠŠä»£ç éƒ¨ç½²åˆ°è¿æ¥æ•°æ®åº“çš„stagingç¯å¢ƒä¸­æ›´å¤šçš„æµ‹è¯•ã€‚å¦‚æœä»£ç æ²¡æœ‰é—®é¢˜ã€å¯ä»¥ç»§ç»­æ‰‹åŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼ˆæµ‹è¯•ç¯å¢ƒæ²¡æœ‰é—®é¢˜å†åˆ°ç±»ç”Ÿäº§ç¯å¢ƒè·‘ä»£ç ï¼‰ã€æ²¡æœ‰é—®é¢˜æ­¤æ—¶å†éƒ¨ç½²åˆ°æ­£ç¡®çš„ç”Ÿäº§ç¯å¢ƒã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_37ae822b3ac29b75a5ab025f48e4c89b.png"></p><h2 id="ä¸‰ã€æŒç»­éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨éƒ¨ç½²ï¼‰"><a href="#ä¸‰ã€æŒç»­éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨éƒ¨ç½²ï¼‰" class="headerlink" title="ä¸‰ã€æŒç»­éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨éƒ¨ç½²ï¼‰"></a>ä¸‰ã€æŒç»­éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒè‡ªåŠ¨éƒ¨ç½²ï¼‰</h2><p>æŒç»­éƒ¨ç½²ï¼ˆcontinuous deploymentï¼‰æ˜¯æŒç»­äº¤ä»˜çš„ä¸‹ä¸€æ­¥æŒ‡çš„æ˜¯ä»£ç é€šè¿‡è¯„å®¡åè‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€‚</p><p>æŒç»­éƒ¨ç½²çš„ç›®æ ‡æ˜¯ã€ä»£ç åœ¨ä»»ä½•æ—¶åˆ»éƒ½æ˜¯å¯éƒ¨ç½²çš„ï¼Œå¯ä»¥è¿›å…¥ç”Ÿäº§é˜¶æ®µã€‚</p><p><strong>æŒç»­éƒ¨ç½²çš„å‰ææ˜¯èƒ½è‡ªåŠ¨åŒ–å®Œæˆæµ‹è¯•ã€æ„å»ºã€éƒ¨ç½²ç­‰æ­¥éª¤ã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_25086192d2536f8fc774faf3438a70b9.png"></p><h2 id="å››ã€æ€»ç»“"><a href="#å››ã€æ€»ç»“" class="headerlink" title="å››ã€æ€»ç»“"></a>å››ã€æ€»ç»“</h2><p><strong>æŒç»­é›†æˆ ï¼š</strong>é¦–å…ˆä»£ç æäº¤åˆ°ä»“åº“&gt;&gt; è‡ªåŠ¨åŒ–æ„å»ºæµ‹è¯•&gt;&gt;è¿”å›ç»“æœ ï¼ˆç¡®è®¤ç°åœ¨çš„ä»£ç æ˜¯ä¸æ˜¯å’Œä¹‹å‰çš„ä»£ç æ­£ç¡®çš„é›†æˆåœ¨ä¸€èµ·ï¼‰</p><p><strong>æŒç»­äº¤ä»˜ï¼š</strong>å°†ä»£ç æ”¾åœ¨ä¸€ä¸ªæµ‹è¯•ç¯å¢ƒè¿è¡Œæ²¡æœ‰é—®é¢˜åˆ™ä¼šåˆ°ä¸€ä¸ªç±»ç”Ÿäº§ç¯å¢ƒè¿è¡Œ ç±»ç”Ÿäº§ç¯å¢ƒæ²¡æœ‰é—®é¢˜åˆ™ æ‰‹åŠ¨éƒ¨ç½²åˆ°æ­£å¼ç”Ÿäº§ç¯å¢ƒ è¿™æ ·ä¹Ÿæœ‰ç‚¹éº»çƒ¦åé¢å°±æœ‰äº†æŒç»­éƒ¨ç½²</p><p><strong>æŒç»­éƒ¨ç½²ï¼š</strong>ä¸éœ€è¦æ‰‹åŠ¨éƒ¨ç½²åˆ°æ­£å¼çš„ç”Ÿäº§ç¯å¢ƒäº† è€Œæ˜¯å¯ä»¥è‡ªåŠ¨éƒ¨ç½²</p><hr><h2 id="jenkinsä»‹ç»"><a href="#jenkinsä»‹ç»" class="headerlink" title="jenkinsä»‹ç»"></a>jenkinsä»‹ç»</h2><p><strong>å®˜ç½‘ï¼š</strong><a href="https://www.jenkins.io/">https://www.jenkins.io</a></p><p><strong>æ’ä»¶ï¼š</strong><a href="https://plugins.jenkins.io/">https://plugins.jenkins.io</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_69ff3cfcc806713501bd43e4d69787b1.png"></p><p><strong>jenkinsåŸåHudsonï¼Œ2011å¹´æ”¹ä¸ºç°åœ¨çš„åå­—ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼€æºçš„å®ç°æŒç»­é›†æˆçš„è½¯ä»¶å·¥å…·ã€‚</strong></p><p>**å®˜æ–¹ç½‘ç«™:  <a href="http://jenkins-ci.org/">http://jenkins-ci.org/</a> æˆ– **<a href="https://www.jenkins.io/">https://www.jenkins.io</a></p><p><strong>Jenkins èƒ½å®æ–½ç›‘æ§é›†æˆä¸­å­˜åœ¨çš„é”™è¯¯ï¼Œæä¾›è¯¦ç»†çš„æ—¥å¿—æ–‡ä»¶å’Œæé†’åŠŸèƒ½ï¼Œè¿˜èƒ½ç”¨å›¾è¡¨çš„å½¢å¼å½¢è±¡åœ°å±•ç¤ºé¡¹ç›®æ„å»ºçš„è¶‹åŠ¿å’Œç¨³å®šæ€§ã€‚</strong></p><h3 id="ç‰¹ç‚¹ï¼š"><a href="#ç‰¹ç‚¹ï¼š" class="headerlink" title="ç‰¹ç‚¹ï¼š"></a>ç‰¹ç‚¹ï¼š</h3><ul><li><strong>æ˜“å®‰è£…:ä»…ä»…ä¸€ä¸ªjava-jar jenkins.warï¼ˆæœ¬æ–‡ä½¿ç”¨dockeræ–¹å¼å®‰è£…jenkinsï¼‰ï¼Œä»å®˜ç½‘ä¸‹è½½è¯¥æ–‡ä»¶åï¼Œç›´æ¥è¿è¡Œï¼Œæ— éœ€é¢å¤–çš„å®‰è£…ï¼Œæ›´æ— éœ€å®‰è£…æ•°</strong></li><li><strong>æ®åº“;</strong></li><li><strong>æ˜“é…ç½®: æä¾›å‹å¥½çš„ GUIé…ç½®ç•Œé¢;</strong></li><li><strong>å˜æ›´æ”¯æŒ: Jenkinsèƒ½ä»ä»£ç ä»“åº“(Subversion/CVS)ä¸­è·å–å¹¶äº§ç”Ÿä»£ç æ›´æ–°åˆ—è¡¨å¹¶è¾“å‡ºåˆ°ç¼–è¯‘è¾“å‡ºä¿¡æ¯ä¸­;</strong></li><li><strong>æ”¯æŒæ°¸ä¹…é“¾æ¥: ç”¨æˆ·æ˜¯é€šè¿‡ webæ¥è®¿é—®Jenkinsçš„ï¼Œè€Œè¿™äº›webé¡µé¢çš„é“¾æ¥åœ°å€éƒ½æ˜¯æ°¸ä¹…é“¾æ¥åœ°å€ï¼Œå› æ­¤ï¼Œä½ å¯ä»¥åœ¨å„ç§æ–‡æ¡£ä¸­ç›´æ¥ä½¿ç”¨è¯¥é“¾æ¥;</strong></li><li><strong>ä»¥åœ¨ç­‰å¾…ç»“æœè¿‡ç¨‹ä¸­ï¼Œå¹²åˆ«çš„äº‹æƒ…)</strong></li><li><strong>é›†æˆ E-Mai/RSS/IM:å½“å®Œæˆä¸€æ¬¡é›†æˆæ—¶ï¼Œå¯é€šè¿‡è¿™äº›å·¥å…·å®æ—¶å‘Šè¯‰ä½ é›†æˆç»“æœ(æ®æˆ‘æ‰€çŸ¥ï¼Œæ„å»ºä¸€æ¬¡é›†æˆéœ€è¦èŠ±è´¹ä¸€å®šæ—¶é—´ï¼Œæœ‰äº†è¿™ä¸ªåŠŸèƒ½ï¼Œä½ å°±å¯ä»¥åœ¨ç­‰å¾…ç»“æœè¿‡ç¨‹ä¸­ï¼Œå¹²åˆ«çš„äº‹æƒ…)</strong></li><li><strong>JUnit/TestNG æµ‹è¯•æŠ¥å‘Š:ä¹Ÿå°±æ˜¯ç”¨ä»¥å›¾è¡¨ç­‰å½¢å¼æä¾›è¯¦ç»†çš„æµ‹è¯•æŠ¥è¡¨åŠŸèƒ½;</strong></li><li><strong>æ”¯æŒåˆ†å¸ƒå¼æ„å»º: Jenkinså¯ä»¥æŠŠé›†æˆæ„å»ºç­‰å·¥ä½œåˆ†å‘åˆ°å¤šå°è®¡ç®—æœºä¸­å®Œæˆ;</strong></li><li><strong>æ–‡ä»¶æŒ‡çº¹ä¿¡æ¯:Jenkinsä¼šä¿å­˜å“ªæ¬¡é›†æˆæ„å»ºäº§ç”Ÿäº†å“ªäº›jarsæ–‡ä»¶ï¼Œå“ªä¸€æ¬¡é›†æˆæ„å»ºä½¿ç”¨äº†å“ªä¸ªç‰ˆæœ¬çš„jarsæ–‡ä»¶</strong></li><li><strong>ç­‰æ„å»ºè®°å½•;</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> jenkins </category>
          
      </categories>
      
      
        <tags>
            
            <tag> jenkins </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8sæ€»ç»“ï¼ˆå…±äº«å­˜å‚¨nfs äº²å’Œæ€§ç­‰ï¼‰</title>
      <link href="/2025/06/03/k8s%E6%80%BB%E7%BB%93%E5%85%B1%E4%BA%AB%E5%AD%98%E5%82%A8nfs%20%E4%BA%B2%E5%92%8C%E6%80%A7%E7%AD%89/"/>
      <url>/2025/06/03/k8s%E6%80%BB%E7%BB%93%E5%85%B1%E4%BA%AB%E5%AD%98%E5%82%A8nfs%20%E4%BA%B2%E5%92%8C%E6%80%A7%E7%AD%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="k8sæ€»ç»“ï¼ˆå…±äº«å­˜å‚¨nfs-äº²å’Œæ€§ç­‰ï¼‰"><a href="#k8sæ€»ç»“ï¼ˆå…±äº«å­˜å‚¨nfs-äº²å’Œæ€§ç­‰ï¼‰" class="headerlink" title="k8sæ€»ç»“ï¼ˆå…±äº«å­˜å‚¨nfs äº²å’Œæ€§ç­‰ï¼‰"></a>k8sæ€»ç»“ï¼ˆå…±äº«å­˜å‚¨nfs äº²å’Œæ€§ç­‰ï¼‰</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_41c38c90c0a93c4baa0f93e474f099a7.png"></p><h2 id="ä¸€ã€è®¾ç½®ç¯å¢ƒ"><a href="#ä¸€ã€è®¾ç½®ç¯å¢ƒ" class="headerlink" title="ä¸€ã€è®¾ç½®ç¯å¢ƒ"></a>ä¸€ã€è®¾ç½®ç¯å¢ƒ</h2><p><strong>è®¾ç½®èŠ‚ç‚¹æ±¡ç‚¹ä¸æ ‡ç­¾</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®æ±¡ç‚¹</span></span><br><span class="line">kubectl taint nodes k8s1 tag=heima:NoExecute</span><br><span class="line"><span class="comment"># å»é™¤æ±¡ç‚¹</span></span><br><span class="line">kubectl taint nodes k8s1 tag:NoExecute-</span><br><span class="line"><span class="comment"># ä¾‹å­</span></span><br><span class="line">kubectl taint nodes gegewu node-role.kubernetes.io/control-plane:NoSchedule-</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ±¡ç‚¹è®¾ç½®æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">kubectl describe nodes |grep Taints</span><br><span class="line"><span class="comment"># Taints:             tag=heima:NoExecute</span></span><br><span class="line"><span class="comment"># Taints:             &lt;none&gt;</span></span><br><span class="line"><span class="comment"># è®¾ç½®èŠ‚ç‚¹æ ‡ç­¾</span></span><br><span class="line">kubectl label nodes k8s1 nodeenv=pro</span><br><span class="line">kubectl get nodes --show-labels<span class="comment"># è®¾ç½®æ±¡ç‚¹</span></span><br><span class="line">kubectl taint nodes k8s1 tag=heima:NoExecute</span><br><span class="line"><span class="comment"># å»é™¤æ±¡ç‚¹</span></span><br><span class="line">kubectl taint nodes k8s1 tag:NoExecute-</span><br><span class="line"><span class="comment"># ä¾‹å­</span></span><br><span class="line">kubectl taint nodes gegewu node-role.kubernetes.io/control-plane:NoSchedule-</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ±¡ç‚¹è®¾ç½®æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">kubectl describe nodes |grep Taints</span><br><span class="line"><span class="comment"># Taints:             tag=heima:NoExecute</span></span><br><span class="line"><span class="comment"># Taints:             &lt;none&gt;</span></span><br><span class="line"><span class="comment"># è®¾ç½®èŠ‚ç‚¹æ ‡ç­¾</span></span><br><span class="line">kubectl label nodes k8s1 nodeenv=pro</span><br><span class="line">kubectl get nodes --show-labels</span><br></pre></td></tr></table></figure><h2 id="äºŒã€é…ç½®yamlæ–‡ä»¶"><a href="#äºŒã€é…ç½®yamlæ–‡ä»¶" class="headerlink" title="äºŒã€é…ç½®yamlæ–‡ä»¶"></a>äºŒã€é…ç½®yamlæ–‡ä»¶</h2><p><strong>ä»¥yamlé…ç½®æ–¹å¼æ€»ç»“ åˆ›å»ºä¸€ä¸ªå¯ä»¥å¤–éƒ¨è®¿é—®çš„nginxï¼ˆzj.yamlï¼‰ï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span>  <span class="comment"># ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span>     <span class="comment"># ç±»å‹</span></span><br><span class="line"><span class="attr">metadata:</span>            <span class="comment"># æºæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">deploy-nginx</span> <span class="comment"># å½“å‰deploymentæ‰€å±çš„åå­—</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>     <span class="comment"># åŠns</span></span><br><span class="line">  <span class="attr">labels:</span>            <span class="comment"># å½“å‰deployçš„æ ‡ç­¾</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">&quot;label-test&quot;</span> </span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span>        <span class="comment"># å®šä¹‰å‰¯æœ¬æ•°</span></span><br><span class="line">  <span class="attr">selector:</span>          <span class="comment"># æ ‡ç­¾é€‰æ‹©å™¨ é€‰æ‹©æ ‡ç­¾è¿›è¡Œæ“ä½œ</span></span><br><span class="line">    <span class="attr">matchLabels:</span>     <span class="comment"># é€‰æ‹©nginxæ ‡ç­¾</span></span><br><span class="line">      <span class="attr">version:</span> <span class="string">label-test</span></span><br><span class="line">  <span class="attr">template:</span>                   <span class="comment"># ä»¥ä¸‹ä¸ºpod æ¨¡æ¿</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span>                 <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">        <span class="attr">version:</span> <span class="string">label-test</span>   <span class="comment"># å®šä¹‰æ ‡ç­¾ä¸ºlabel-test</span></span><br><span class="line">  </span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="comment"># é•œåƒä¿¡æ¯ç­‰   </span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span> <span class="comment"># ç”¨äºè®¾ç½®é•œåƒæ‹‰å–ç­–ç•¥</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx-test</span></span><br><span class="line">        <span class="comment"># cmdå˜é‡ä¸ç«¯å£</span></span><br><span class="line">        <span class="attr">ports:</span>       </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">protocol:</span> <span class="string">TCP</span>  </span><br><span class="line">          <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;while true;do /bin/echo $(date +%T);sleep 60; done;&quot;</span>]</span><br><span class="line">          <span class="attr">env:</span>                     <span class="comment"># è®¾ç½®ç¯å¢ƒå˜é‡åˆ—è¡¨</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;username&quot;</span></span><br><span class="line">            <span class="attr">value:</span> <span class="string">&quot;admin&quot;</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;password&quot;</span></span><br><span class="line">            <span class="attr">value:</span> <span class="string">&quot;123456&quot;</span>   </span><br><span class="line">        <span class="comment"># èµ„æºé…é¢</span></span><br><span class="line">        <span class="attr">resources:</span>              </span><br><span class="line">          <span class="attr">limits:</span>    <span class="comment"># é™åˆ¶èµ„æºï¼ˆä¸Šé™ï¼‰</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;2&quot;</span> <span class="comment"># CPUé™åˆ¶ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;10Gi&quot;</span> <span class="comment"># å†…å­˜é™åˆ¶</span></span><br><span class="line">          <span class="attr">requests:</span>        <span class="comment"># è¯·æ±‚èµ„æºï¼ˆä¸‹é™ï¼‰</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;1&quot;</span>       <span class="comment"># CPUé™åˆ¶ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;10Mi&quot;</span> <span class="comment"># å†…å­˜é™åˆ¶  </span></span><br><span class="line">      </span><br><span class="line">      <span class="comment"># å‹¾å­å‡½æ•°</span></span><br><span class="line">      <span class="attr">lifecycle:</span></span><br><span class="line">        <span class="attr">postStart:</span> </span><br><span class="line">          <span class="attr">exec:</span> <span class="comment"># åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œä¿®æ”¹æ‰nginxçš„é»˜è®¤é¦–é¡µå†…å®¹</span></span><br><span class="line">            <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;echo postStart... &gt; /usr/share/nginx/html/index.html&quot;</span>]</span><br><span class="line">        <span class="attr">preStop:</span></span><br><span class="line">          <span class="attr">exec:</span> <span class="comment"># åœ¨å®¹å™¨åœæ­¢ä¹‹å‰åœæ­¢nginxæœåŠ¡</span></span><br><span class="line">            <span class="attr">command:</span> [<span class="string">&quot;/usr/sbin/nginx&quot;</span>,<span class="string">&quot;-s&quot;</span>,<span class="string">&quot;quit&quot;</span>]</span><br><span class="line">      <span class="attr">tolerations:</span>        <span class="comment"># æ·»åŠ å®¹å¿</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">&quot;tag&quot;</span>        <span class="comment"># è¦å®¹å¿çš„æ±¡ç‚¹çš„key</span></span><br><span class="line">        <span class="attr">operator:</span> <span class="string">&quot;Equal&quot;</span> <span class="comment"># æ“ä½œç¬¦ï¼ˆç­‰äºæ“ä½œç¬¦ï¼‰</span></span><br><span class="line">        <span class="attr">value:</span> <span class="string">&quot;heima&quot;</span>        <span class="comment"># å®¹å¿çš„æ±¡ç‚¹çš„value</span></span><br><span class="line">        <span class="attr">effect:</span> <span class="string">&quot;NoExecute&quot;</span>   <span class="comment"># æ·»åŠ å®¹å¿çš„è§„åˆ™ï¼Œè¿™é‡Œå¿…é¡»å’Œæ ‡è®°çš„æ±¡ç‚¹è§„åˆ™ç›¸åŒ </span></span><br><span class="line">  </span><br><span class="line">      <span class="comment"># äº²å’Œæ€§è®¾ç½®  </span></span><br><span class="line">      <span class="attr">affinity:</span>   </span><br><span class="line">        <span class="attr">nodeAffinity:</span> <span class="comment"># è®¾ç½®nodeäº²å’Œæ€§</span></span><br><span class="line">          <span class="attr">preferredDuringSchedulingIgnoredDuringExecution:</span> <span class="comment"># è½¯é™åˆ¶</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">weight:</span> <span class="number">1</span></span><br><span class="line">            <span class="attr">preference:</span></span><br><span class="line">              <span class="attr">matchExpressions:</span> <span class="comment"># åŒ¹é…envçš„å€¼åœ¨[&quot;xxx&quot;,&quot;yyy&quot;]ä¸­çš„æ ‡ç­¾(å½“å‰ç¯å¢ƒæ²¡æœ‰)</span></span><br><span class="line">              <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">nodeenv</span></span><br><span class="line">                <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">                <span class="attr">values:</span> [<span class="string">&quot;pro&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br></pre></td></tr></table></figure><p><strong>æ€»ç»“2åŠ å…¥å…±äº«å­˜å‚¨æŒ‚è½½</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span>  <span class="comment"># ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span>     <span class="comment"># ç±»å‹</span></span><br><span class="line"><span class="attr">metadata:</span>            <span class="comment"># æºæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">deploy-nginx</span> <span class="comment"># å½“å‰deploymentæ‰€å±çš„åå­—</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>     <span class="comment"># åŠns</span></span><br><span class="line">  <span class="attr">labels:</span>            <span class="comment"># å½“å‰deployçš„æ ‡ç­¾</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">&quot;label-test&quot;</span> </span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span>        <span class="comment"># å®šä¹‰å‰¯æœ¬æ•°</span></span><br><span class="line">  <span class="attr">selector:</span>          <span class="comment"># æ ‡ç­¾é€‰æ‹©å™¨ é€‰æ‹©æ ‡ç­¾è¿›è¡Œæ“ä½œ</span></span><br><span class="line">    <span class="attr">matchLabels:</span>     <span class="comment"># é€‰æ‹©nginxæ ‡ç­¾</span></span><br><span class="line">      <span class="attr">version:</span> <span class="string">label-test</span></span><br><span class="line">  <span class="attr">template:</span>                   <span class="comment"># ä»¥ä¸‹ä¸ºpod æ¨¡æ¿</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span>                 <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">        <span class="attr">version:</span> <span class="string">label-test</span>   <span class="comment"># å®šä¹‰æ ‡ç­¾ä¸ºlabel-test</span></span><br><span class="line">    </span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="comment"># é•œåƒä¿¡æ¯ç­‰   </span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span></span><br><span class="line">        <span class="attr">imagePullPolicy:</span> <span class="string">IfNotPresent</span> <span class="comment"># ç”¨äºè®¾ç½®é•œåƒæ‹‰å–ç­–ç•¥</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx-test</span></span><br><span class="line">        <span class="comment"># cmdå˜é‡ä¸ç«¯å£</span></span><br><span class="line">        <span class="attr">ports:</span>         </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">protocol:</span> <span class="string">TCP</span> </span><br><span class="line">        <span class="comment"># ç¯å¢ƒå˜é‡</span></span><br><span class="line">        <span class="attr">env:</span>                 </span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;username&quot;</span></span><br><span class="line">            <span class="attr">value:</span> <span class="string">&quot;admin&quot;</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;password&quot;</span></span><br><span class="line">            <span class="attr">value:</span> <span class="string">&quot;123456&quot;</span>   </span><br><span class="line">        <span class="comment"># å®¹å™¨å‘½ä»¤</span></span><br><span class="line">        <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;while true;do /bin/echo $(date +%T);sleep 60; done;&quot;</span>]</span><br><span class="line">        <span class="comment"># æŒ‚è½½å·</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">logs-volume</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">/var/log/nginx</span></span><br><span class="line">        <span class="comment"># èµ„æºé…é¢</span></span><br><span class="line">        <span class="attr">resources:</span>                </span><br><span class="line">          <span class="attr">limits:</span>    <span class="comment"># é™åˆ¶èµ„æºï¼ˆä¸Šé™ï¼‰</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;2&quot;</span> <span class="comment"># CPUé™åˆ¶ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;10Gi&quot;</span> <span class="comment"># å†…å­˜é™åˆ¶</span></span><br><span class="line">          <span class="attr">requests:</span>        <span class="comment"># è¯·æ±‚èµ„æºï¼ˆä¸‹é™ï¼‰</span></span><br><span class="line">            <span class="attr">cpu:</span> <span class="string">&quot;1&quot;</span>       <span class="comment"># CPUé™åˆ¶ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">            <span class="attr">memory:</span> <span class="string">&quot;10Mi&quot;</span> <span class="comment"># å†…å­˜é™åˆ¶  </span></span><br><span class="line">        <span class="comment"># å‹¾å­å‡½æ•°</span></span><br><span class="line">        <span class="attr">lifecycle:</span></span><br><span class="line">          <span class="attr">postStart:</span> </span><br><span class="line">            <span class="attr">exec:</span> <span class="comment"># åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œä¿®æ”¹æ‰nginxçš„é»˜è®¤é¦–é¡µå†…å®¹</span></span><br><span class="line">              <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;echo postStart... &gt; /usr/share/nginx/html/index.html&quot;</span>]</span><br><span class="line">          <span class="attr">preStop:</span></span><br><span class="line">            <span class="attr">exec:</span> <span class="comment"># åœ¨å®¹å™¨åœæ­¢ä¹‹å‰åœæ­¢nginxæœåŠ¡</span></span><br><span class="line">              <span class="attr">command:</span> [<span class="string">&quot;/usr/sbin/nginx&quot;</span>,<span class="string">&quot;-s&quot;</span>,<span class="string">&quot;quit&quot;</span>]</span><br><span class="line"></span><br><span class="line">      <span class="comment"># å®šä¹‰ volume</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">logs-volume</span></span><br><span class="line">        <span class="attr">nfs:</span></span><br><span class="line">          <span class="attr">server:</span> <span class="number">58.49</span><span class="number">.144</span><span class="number">.8</span>  <span class="comment"># nfsæœåŠ¡å™¨åœ°å€ ï¼ˆå®¿ä¸»æœºåœ°å€ï¼‰</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">/srv/nfs4</span>      <span class="comment"># å…±äº«æ–‡ä»¶è·¯å¾„      </span></span><br><span class="line"></span><br><span class="line">      <span class="comment"># å®¹å¿æ±¡ç‚¹</span></span><br><span class="line">      <span class="attr">tolerations:</span>   </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">&quot;tag&quot;</span>    </span><br><span class="line">        <span class="attr">operator:</span> <span class="string">&quot;Equal&quot;</span> </span><br><span class="line">        <span class="attr">value:</span> <span class="string">&quot;heima&quot;</span>    </span><br><span class="line">        <span class="attr">effect:</span> <span class="string">&quot;NoExecute&quot;</span>   </span><br><span class="line">    </span><br><span class="line">      <span class="comment"># äº²å’Œæ€§è®¾ç½®  </span></span><br><span class="line">      <span class="attr">affinity:</span>   </span><br><span class="line">        <span class="attr">nodeAffinity:</span> <span class="comment"># è®¾ç½®nodeäº²å’Œæ€§</span></span><br><span class="line">          <span class="attr">preferredDuringSchedulingIgnoredDuringExecution:</span> <span class="comment"># è½¯é™åˆ¶</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">weight:</span> <span class="number">1</span></span><br><span class="line">            <span class="attr">preference:</span></span><br><span class="line">              <span class="attr">matchExpressions:</span> <span class="comment"># åŒ¹é…envçš„å€¼åœ¨[&quot;xxx&quot;,&quot;yyy&quot;]ä¸­çš„æ ‡ç­¾(å½“å‰ç¯å¢ƒæ²¡æœ‰)</span></span><br><span class="line">              <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">nodeenv</span></span><br><span class="line">                <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">                <span class="attr">values:</span> [<span class="string">&quot;pro&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>éªŒè¯nfsæŒ‚è½½æ˜¯å¦æˆåŠŸ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥å®¹å™¨</span></span><br><span class="line">kubectl <span class="built_in">exec</span> -it deploy-nginx-7d9b78b676-dvbxh -n dev -- /bin/sh</span><br><span class="line"><span class="comment"># è¿›å…¥å®¹å™¨æŒ‚è½½ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /var/log/nginx</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line"><span class="comment"># 1.txt  access.log  error.log  successful# è¿›å…¥å®¹å™¨</span></span><br><span class="line">kubectl <span class="built_in">exec</span> -it deploy-nginx-7d9b78b676-dvbxh -n dev -- /bin/sh</span><br><span class="line"><span class="comment"># è¿›å…¥å®¹å™¨æŒ‚è½½ç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> /var/log/nginx</span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line"><span class="comment"># 1.txt  access.log  error.log  successful</span></span><br></pre></td></tr></table></figure><p><strong>å¯¹å¤–æš´éœ²ç«¯å£</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">svc-nginx</span>    <span class="comment"># svcåç§°</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>     <span class="comment"># nsåç§°</span></span><br><span class="line"><span class="attr">labels:</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">label-test</span>     <span class="comment"># æ ‡ç­¾</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">clusterIP:</span> <span class="number">10.109</span><span class="number">.179</span><span class="number">.231</span> <span class="comment"># å›ºå®šsvcçš„å†…ç½‘ip kubectl get svc -n dev å¯æŸ¥çœ‹</span></span><br><span class="line">  <span class="attr">ports:</span>                    <span class="comment"># ç«¯å£é…ç½®éœ€è¦ä¸ä¸Šæ–¹ä¸€è‡´  </span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span>                <span class="comment"># å®¿ä¸»æœºç«¯å£</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">80</span>          <span class="comment"># å®¹å™¨ç«¯å£  </span></span><br><span class="line">  <span class="attr">selector:</span>                 <span class="comment"># é€‰æ‹©å¯¹æ ‡ç­¾label-testæ“ä½œ</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">label-test</span> </span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span>            <span class="comment"># ç±»å‹NodePort  </span></span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_0b97396d49190205d9862e55a8af18ba.png"><strong>kubectl get pod -n dev â€“show-labels</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_a01f7f55492ae5715c4515d795d79cc5.png"></p><p><strong># åªç­›é€‰å‡ºæ ‡ç­¾æ˜¯version=2.0çš„pod</strong></p><p><strong>kubectl get pods -l â€œversion=2.0â€ -n dev â€“show-labels</strong></p><p><strong># åªç­›é€‰å‡ºæ ‡ç­¾æ˜¯version=2.0çš„pod</strong></p><p><strong>kubectl get pods -l â€œversion=2.0â€ -n dev â€“show-labels</strong></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sshæš´åŠ›ç ´è§£è§£å†³sshç™½åå•åŠé˜²ç«å¢™è®¾ç½®</title>
      <link href="/2025/05/22/ssh%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E8%A7%A3%E5%86%B3ssh%E7%99%BD%E5%90%8D%E5%8D%95%E5%8F%8A%E9%98%B2%E7%81%AB%E5%A2%99%E8%AE%BE%E7%BD%AE/"/>
      <url>/2025/05/22/ssh%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E8%A7%A3%E5%86%B3ssh%E7%99%BD%E5%90%8D%E5%8D%95%E5%8F%8A%E9%98%B2%E7%81%AB%E5%A2%99%E8%AE%BE%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="sshæš´åŠ›ç ´è§£è§£å†³sshç™½åå•åŠé˜²ç«å¢™è®¾ç½®"><a href="#sshæš´åŠ›ç ´è§£è§£å†³sshç™½åå•åŠé˜²ç«å¢™è®¾ç½®" class="headerlink" title="sshæš´åŠ›ç ´è§£è§£å†³sshç™½åå•åŠé˜²ç«å¢™è®¾ç½®"></a>sshæš´åŠ›ç ´è§£è§£å†³sshç™½åå•åŠé˜²ç«å¢™è®¾ç½®</h1><p>ä»ä½ çš„ <code>journalctl -u sshd -f</code> æ—¥å¿—æ¥çœ‹ï¼Œè¿™äº›æ—¥å¿—ä¸»è¦æ˜¾ç¤ºçš„æ˜¯æ¥è‡ª <strong>å¤–éƒ¨ IP å¯¹ä½ çš„æœåŠ¡å™¨ SSH ç«¯å£çš„è¿æ¥å°è¯•</strong>ï¼Œå¹¶ä¸å±äºä½ æœåŠ¡å™¨è‡ªèº«çš„é”™è¯¯ï¼Œè€Œæ˜¯ä¸€äº›å…¸å‹çš„ <strong>æš´åŠ›ç ´è§£æ‰«æè¡Œä¸ºï¼ˆbrute-force scanï¼‰</strong> æˆ– <strong>æ¢æµ‹è¡Œä¸º</strong>ã€‚ä¸‹é¢æ˜¯æ¯æ¡æ—¥å¿—çš„å«ä¹‰è§£é‡Šï¼š</p><hr><h3 id="ğŸ”-æ—¥å¿—åˆ†æï¼š"><a href="#ğŸ”-æ—¥å¿—åˆ†æï¼š" class="headerlink" title="ğŸ” æ—¥å¿—åˆ†æï¼š"></a>ğŸ” æ—¥å¿—åˆ†æï¼š</h3><h4 id="1-è¿æ¥å°è¯•ç„¶åå…³é—­"><a href="#1-è¿æ¥å°è¯•ç„¶åå…³é—­" class="headerlink" title="1. è¿æ¥å°è¯•ç„¶åå…³é—­"></a>1. <strong>è¿æ¥å°è¯•ç„¶åå…³é—­</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">May 23 13:40:13 ... sshd[42391]: Connection from 165.154.168.234 port 53228 on 10.0.0.4 port 22</span><br><span class="line">May 23 13:40:18 ... sshd[42391]: Connection closed by 165.154.168.234 port 53228 [preauth]</span><br></pre></td></tr></table></figure><ul><li>è¯´æ˜ï¼šè¿™ä¸ª IP è¿æ¥åˆ°äº†ä½ çš„ SSH ç«¯å£ï¼Œç„¶åé©¬ä¸Šå…³é—­è¿æ¥äº†ã€‚</li><li>çŠ¶æ€ï¼šå¯èƒ½æ˜¯æ‰«æå™¨æ¢æµ‹ï¼Œæ²¡æœ‰è¿›è¡Œç™»å½•å°è¯•ã€‚</li></ul><hr><h4 id="2-æš´åŠ›ç ´è§£å°è¯•"><a href="#2-æš´åŠ›ç ´è§£å°è¯•" class="headerlink" title="2. æš´åŠ›ç ´è§£å°è¯•"></a>2. <strong>æš´åŠ›ç ´è§£å°è¯•</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">May 23 13:40:52 ... sshd[42494]: Connection from 223.197.125.110 port 54040</span><br><span class="line">May 23 13:40:53 ... pam_unix(sshd:auth): authentication failure ... user=root</span><br><span class="line">May 23 13:40:54 ... sshd[42494]: Failed password for root from 223.197.125.110</span><br><span class="line">May 23 13:40:56 ... sshd[42494]: Received disconnect ... Bye Bye [preauth]</span><br></pre></td></tr></table></figure><ul><li>è¯´æ˜ï¼šè¿™ä¸ª IP å°è¯•ç”¨ <code>root</code> ç”¨æˆ·ç™»å½•ï¼Œå¯†ç éªŒè¯å¤±è´¥ã€‚</li><li>çŠ¶æ€ï¼šè¿™æ˜¯å…¸å‹çš„æš´åŠ›ç ´è§£æ”»å‡»ã€‚</li></ul><hr><h4 id="3-è¿æ¥åç«‹åˆ»æ–­å¼€"><a href="#3-è¿æ¥åç«‹åˆ»æ–­å¼€" class="headerlink" title="3. è¿æ¥åç«‹åˆ»æ–­å¼€"></a>3. <strong>è¿æ¥åç«‹åˆ»æ–­å¼€</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">May 23 13:41:21 ... sshd[42588]: Connection from 193.32.162.185 ...</span><br><span class="line">May 23 13:41:22 ... error: kex_exchange_identification: Connection closed by remote host</span><br><span class="line">May 23 13:41:22 ... Connection closed by 193.32.162.185 ...</span><br></pre></td></tr></table></figure><ul><li>è¯´æ˜ï¼šè¿æ¥å»ºç«‹åï¼Œå°šæœªå®Œæˆå¯†é’¥äº¤æ¢å°±è¢«è¿œç¨‹ä¸»æœºå…³é—­ã€‚</li><li>çŠ¶æ€ï¼šä¹Ÿæ˜¯æ‰«æå™¨æˆ–æ¢æµ‹å™¨çš„è¡Œä¸ºã€‚</li></ul><hr><h3 id="ğŸš¨-æ€»ç»“"><a href="#ğŸš¨-æ€»ç»“" class="headerlink" title="ğŸš¨ æ€»ç»“"></a>ğŸš¨ æ€»ç»“</h3><p>è¿™äº›æ—¥å¿—è¡¨æ˜ä½ çš„æœåŠ¡å™¨æš´éœ²åœ¨å…¬ç½‘ï¼Œæ­£åœ¨è¢«å¤šä¸ª IP åœ°å€æ‰«ææˆ–å°è¯•æš´åŠ›ç ´è§£ SSH ç™»å½•ã€‚</p><hr><h3 id="âœ…-å»ºè®®çš„å®‰å…¨æªæ–½ï¼š"><a href="#âœ…-å»ºè®®çš„å®‰å…¨æªæ–½ï¼š" class="headerlink" title="âœ… å»ºè®®çš„å®‰å…¨æªæ–½ï¼š"></a>âœ… å»ºè®®çš„å®‰å…¨æªæ–½ï¼š</h3><ol><li><p><strong>ç¦æ­¢ root ç™»å½•ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¾‘ SSH é…ç½®</span></span><br><span class="line">vi /etc/ssh/sshd_config</span><br><span class="line"><span class="comment"># è®¾ç½®ï¼š</span></span><br><span class="line">PermitRootLogin no</span><br><span class="line"><span class="comment"># ç„¶åé‡å¯ SSH æœåŠ¡</span></span><br><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></figure></li><li><p><strong>å¼€å¯é˜²ç«å¢™é™åˆ¶ SSH IPï¼š</strong></p><ul><li>ufw<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. é»˜è®¤æ‹’ç»æ‰€æœ‰äººè®¿é—® SSHï¼ˆå…ˆæ¸…é™¤ç°æœ‰è§„åˆ™ï¼‰</span></span><br><span class="line">sudo ufw deny 22/tcp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å…è®¸æŒ‡å®š IP è®¿é—® SSH</span></span><br><span class="line">sudo ufw allow from 203.0.113.10 to any port 22 proto tcp</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. å¯ç”¨ ufwï¼ˆå¦‚æœæ²¡å¯ç”¨è¿‡ï¼‰</span></span><br><span class="line">sudo ufw <span class="built_in">enable</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. æŸ¥çœ‹è§„åˆ™ç¡®è®¤</span></span><br><span class="line">sudo ufw status numbered</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>iptables<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. å…ˆæ¸…é™¤ä¹‹å‰å¯èƒ½çš„è§„åˆ™ï¼ˆä»…SSHç›¸å…³ï¼‰</span></span><br><span class="line">iptables -D INPUT -p tcp --dport 22 -j ACCEPT || <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. å…è®¸æŒ‡å®š IP è®¿é—®ç«¯å£ 22</span></span><br><span class="line">iptables -A INPUT -p tcp -s 203.0.113.10 --dport 22 -j ACCEPT</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. æ‹’ç»æ‰€æœ‰å…¶ä»– IP çš„ SSH è¿æ¥</span></span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -j DROP</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. ä¿å­˜è§„åˆ™ï¼ˆCentOS 7ï¼‰</span></span><br><span class="line">service iptables save</span><br><span class="line"></span><br><span class="line"><span class="comment"># æˆ–è€… Ubuntu:</span></span><br><span class="line">iptables-save &gt; /etc/iptables/rules.v4</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li>åªå…è®¸ç‰¹å®š IP ç™»å½• SSHï¼ˆå¦‚æœä½ æœ‰å›ºå®š IPï¼‰ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --permanent --add-rich-rule=<span class="string">&#x27;rule family=&quot;ipv4&quot; source address=&quot;ä½ çš„IPåœ°å€&quot; port protocol=&quot;tcp&quot; port=&quot;22&quot; accept&#x27;</span></span><br><span class="line">firewall-cmd --permanent --remove-service=ssh</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure></li></ul><p>æˆ–è€…å¼€å¯rootå¯†ç ç™»å½•å¹¶é™åˆ¶ AllowUsers</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å¼€å¯rootå¯†ç ç™»å½•å¹¶é™åˆ¶ AllowUsers</span><br><span class="line"><span class="comment"># æŸ¥çœ‹è®¿é—®æœ¬æœºçš„å…¬ç½‘åœ°å€ä½¿ç”¨</span></span><br><span class="line">curl ifconfig.me</span><br><span class="line"><span class="comment"># é¦–å…ˆä¸º root è®¾ç½®å¯†ç  åå…è®¸rootç”¨æˆ·ç™»å½•</span></span><br><span class="line">vim /etc/ssh/sshd_config</span><br><span class="line">PermitRootLogin <span class="built_in">yes</span></span><br><span class="line">AllowUsers root@127.0.0.1/32 root@æœ¬æœºæ‰€åœ¨çš„å¤–ç½‘ç½‘æ®µ/31 root@å†…ç½‘ipæ®µ</span><br><span class="line"></span><br><span class="line">systemctl restart ssh</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨éæ ‡å‡†ç«¯å£ï¼ˆå˜æ›´é»˜è®¤22ç«¯å£ï¼‰ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®</span></span><br><span class="line">vi /etc/ssh/sshd_config</span><br><span class="line">Port 22222  <span class="comment"># æ”¹ä¸ºä½ è‡ªå®šä¹‰çš„ç«¯å£</span></span><br><span class="line">systemctl restart sshd</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨ Fail2Ban è‡ªåŠ¨å°é”æš´åŠ›ç ´è§£ IPï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install -y epel-release fail2ban</span><br><span class="line">yum install -y fail2ban</span><br><span class="line">systemctl <span class="built_in">enable</span> --now fail2ban</span><br></pre></td></tr></table></figure></li><li><p><strong>ä½¿ç”¨è·³æ¿æœºæˆ– VPN éšè— SSH æ¥å£</strong></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> ssh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sshè·³è¿‡ä¸€äº› PAMé‰´æƒ</title>
      <link href="/2025/05/18/ssh%E8%B7%B3%E8%BF%87%E4%B8%80%E4%BA%9B%20PAM%E9%89%B4%E6%9D%83/"/>
      <url>/2025/05/18/ssh%E8%B7%B3%E8%BF%87%E4%B8%80%E4%BA%9B%20PAM%E9%89%B4%E6%9D%83/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="sshè·³è¿‡ä¸€äº›-PAMé‰´æƒ"><a href="#sshè·³è¿‡ä¸€äº›-PAMé‰´æƒ" class="headerlink" title="sshè·³è¿‡ä¸€äº› PAMé‰´æƒ"></a>sshè·³è¿‡ä¸€äº› PAMé‰´æƒ</h2><hr><h3 id="ğŸ§©-ä»€ä¹ˆæ˜¯-PAMï¼Ÿ"><a href="#ğŸ§©-ä»€ä¹ˆæ˜¯-PAMï¼Ÿ" class="headerlink" title="ğŸ§© ä»€ä¹ˆæ˜¯ PAMï¼Ÿ"></a>ğŸ§© ä»€ä¹ˆæ˜¯ PAMï¼Ÿ</h3><p>PAMï¼ˆPluggable Authentication Modulesï¼‰æ˜¯ Linux ä¸­ä¸€ä¸ªå¯æ’æ‹”çš„è®¤è¯æ¡†æ¶ï¼Œå®ƒå…è®¸ç³»ç»Ÿç®¡ç†å‘˜çµæ´»åœ°é…ç½®ç”¨æˆ·è®¤è¯æœºåˆ¶ã€‚</p><p>åœ¨ SSH ç™»å½•è¿‡ç¨‹ä¸­ï¼ŒPAM æ˜¯å…¶ä¸­ä¸€ä¸ªå¯é€‰çš„è®¤è¯æœºåˆ¶ã€‚å¦‚æœå¯ç”¨äº† PAMï¼ŒSSH ç™»å½•æ—¶å°±ä¼šè°ƒç”¨ <code>/etc/pam.d/sshd</code> æ–‡ä»¶ä¸­é…ç½®çš„æ¨¡å—è¿›è¡Œä¸€ç³»åˆ—æ£€æŸ¥ï¼Œæ¯”å¦‚ï¼š</p><ul><li>å¯†ç å¤æ‚åº¦éªŒè¯</li><li>æ˜¯å¦å…è®¸ç‰¹å®šç”¨æˆ·æˆ–ç”¨æˆ·ç»„ç™»å½•</li><li>æ˜¯å¦å¯ç”¨åŒå› å­è®¤è¯</li><li>ç™»å½•å¤±è´¥æ¬¡æ•°é™åˆ¶ï¼ˆå¦‚ <code>pam_tally2</code> æˆ– <code>pam_faillock</code>ï¼‰</li><li>SELinux/å®‰å…¨ç­–ç•¥é™åˆ¶ç­‰</li></ul><hr><h3 id="ğŸ› ï¸-SSH-é…ç½®æ–‡ä»¶ä¸­-PAM-ç›¸å…³é¡¹"><a href="#ğŸ› ï¸-SSH-é…ç½®æ–‡ä»¶ä¸­-PAM-ç›¸å…³é¡¹" class="headerlink" title="ğŸ› ï¸ SSH é…ç½®æ–‡ä»¶ä¸­ PAM ç›¸å…³é¡¹"></a>ğŸ› ï¸ SSH é…ç½®æ–‡ä»¶ä¸­ PAM ç›¸å…³é¡¹</h3><p>åœ¨ <code>/etc/ssh/sshd_config</code> ä¸­æœ‰ä¸€é¡¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UsePAM <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>å«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li><code>yes</code>ï¼šSSH ç™»å½•ä¼šè°ƒç”¨ PAM æ¨¡å— <code>/etc/pam.d/sshd</code>ï¼Œåº”ç”¨ä¸€ç³»åˆ—ç­–ç•¥æ£€æŸ¥ã€‚</li><li><code>no</code>ï¼šä¸ä½¿ç”¨ PAMï¼Œè·³è¿‡è¿™äº›ç­–ç•¥ï¼Œå¯èƒ½åªä¾èµ– <code>sshd_config</code> ä¸­çš„å…¶å®ƒç™»å½•æ§åˆ¶é¡¹ï¼ˆå¦‚ <code>AllowUsers</code>ã€<code>PasswordAuthentication</code> ç­‰ï¼‰æ¥å†³å®šæ˜¯å¦å…è®¸ç™»å½•ã€‚</li></ul><hr><h3 id="ğŸ§¨-æ³¨æ„äº‹é¡¹"><a href="#ğŸ§¨-æ³¨æ„äº‹é¡¹" class="headerlink" title="ğŸ§¨ æ³¨æ„äº‹é¡¹"></a>ğŸ§¨ æ³¨æ„äº‹é¡¹</h3><p>æŠŠ <code>UsePAM</code> æ”¹æˆ <code>no</code> è™½ç„¶èƒ½è·³è¿‡ä¸€äº› PAM é™åˆ¶ï¼Œä½†ä¹Ÿå¯èƒ½é€ æˆï¼š</p><ol><li><strong>ç»•è¿‡å®‰å…¨é™åˆ¶</strong>ï¼Œå¦‚å¯†ç å°è¯•æ¬¡æ•°é™åˆ¶ã€é˜²æš´åŠ›ç ´è§£ç­‰ï¼›</li><li><strong>æŸäº›ç™»å½•éªŒè¯æœºåˆ¶å¤±æ•ˆ</strong>ï¼Œå¦‚ä½¿ç”¨ LDAPã€æŒ‡çº¹è¯†åˆ«ã€MFA ç­‰åŸºäº PAM çš„è®¤è¯æ–¹æ³•ã€‚</li></ol><hr><h3 id="âœ…-ç¤ºä¾‹åœºæ™¯"><a href="#âœ…-ç¤ºä¾‹åœºæ™¯" class="headerlink" title="âœ… ç¤ºä¾‹åœºæ™¯"></a>âœ… ç¤ºä¾‹åœºæ™¯</h3><p>ä½ é‡åˆ°è¿‡ä¸€äº›é™åˆ¶ç™»å½•çš„é—®é¢˜ï¼Œå¯èƒ½å°±æ˜¯ PAM æ¨¡å—ï¼ˆæ¯”å¦‚ <code>pam_access.so</code>ï¼‰é™åˆ¶äº†ç”¨æˆ·ç™»å½•ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># /etc/pam.d/sshd ç¤ºä¾‹ç‰‡æ®µ</span></span><br><span class="line">account    required     pam_access.so</span><br></pre></td></tr></table></figure><p>å¯¹åº”çš„ <code>/etc/security/access.conf</code> å¯èƒ½é…ç½®äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-:testuser:ALL</span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±ä¼šæ‹’ç»ç”¨æˆ· <code>testuser</code> çš„ SSH ç™»å½•ã€‚</p><p>è‹¥æ­¤æ—¶ä½ æŠŠ <code>UsePAM no</code>ï¼ŒSSH å°±ä¸ä¼šå†æ‰§è¡Œä¸Šé¢çš„ <code>pam_access.so</code> æ£€æŸ¥äº†ï¼Œç”¨æˆ·å°±èƒ½ç»•è¿‡ç™»å½•é™åˆ¶ã€‚</p><hr><h3 id="ğŸ”-æ€»ç»“"><a href="#ğŸ”-æ€»ç»“" class="headerlink" title="ğŸ” æ€»ç»“"></a>ğŸ” æ€»ç»“</h3><table><thead><tr><th>é¡¹</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td><code>UsePAM yes</code></td><td>è°ƒç”¨<code>/etc/pam.d/sshd</code>ä¸­çš„æ¨¡å—ï¼Œæ‰§è¡Œå¤šç§å®‰å…¨æ£€æŸ¥</td></tr><tr><td><code>UsePAM no</code></td><td>ä¸è°ƒç”¨ PAMï¼Œç®€å•è®¤è¯æµç¨‹ï¼Œç™»å½•é™åˆ¶ä¼šå˜å°‘</td></tr></tbody></table><p>æ˜¯å¦å¯ç”¨ PAM å–å†³äºä½ å¯¹å®‰å…¨æ€§å’Œæ§åˆ¶èƒ½åŠ›çš„éœ€æ±‚ã€‚éœ€è¦å®‰å…¨ç­–ç•¥å°±å¯ç”¨ï¼Œæƒ³ç®€åŒ–ç™»å½•å°±å…³é—­ã€‚</p><p>æ˜¯å¦éœ€è¦æˆ‘å¸®ä½ å®¡æŸ¥ä¸€ä¸‹ <code>/etc/pam.d/sshd</code> é‡Œé¢æœ‰å“ªäº›æ¨¡å—å¯èƒ½å½±å“ç™»å½•ï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> ssh </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ssh </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centosæ§åˆ¶å°ç™»å½•æŠ¥é”™Permission-denied</title>
      <link href="/2025/05/08/centos%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%99%BB%E5%BD%95%E6%8A%A5%E9%94%99Permission-denied/"/>
      <url>/2025/05/08/centos%E6%8E%A7%E5%88%B6%E5%8F%B0%E7%99%BB%E5%BD%95%E6%8A%A5%E9%94%99Permission-denied/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="centos7è´¦æˆ·åå’Œå¯†ç éƒ½æ­£ç¡®-å´æ€ä¹ˆéƒ½ç™»å½•å¤±è´¥"><a href="#centos7è´¦æˆ·åå’Œå¯†ç éƒ½æ­£ç¡®-å´æ€ä¹ˆéƒ½ç™»å½•å¤±è´¥" class="headerlink" title="centos7è´¦æˆ·åå’Œå¯†ç éƒ½æ­£ç¡®-å´æ€ä¹ˆéƒ½ç™»å½•å¤±è´¥"></a><a href="https://www.cnblogs.com/tangshengjie/p/15645506.html" title="å‘å¸ƒäº 2021-12-05 18:49">centos7è´¦æˆ·åå’Œå¯†ç éƒ½æ­£ç¡®-å´æ€ä¹ˆéƒ½ç™»å½•å¤±è´¥</a></h1><p>å‚è€ƒï¼š<a href="https://wn.zznnwn.cloudns.biz/2023/08/09/ubuntu18-04%E9%80%9A%E7%94%A8%E5%88%9D%E5%A7%8B%E5%8C%96/">https://wn.zznnwn.cloudns.biz/2023/08/09/ubuntu18-04%E9%80%9A%E7%94%A8%E5%88%9D%E5%A7%8B%E5%8C%96/</a></p><h1 id="é—®é¢˜æ¦‚è¿°åŠè§£å†³"><a href="#é—®é¢˜æ¦‚è¿°åŠè§£å†³" class="headerlink" title="é—®é¢˜æ¦‚è¿°åŠè§£å†³"></a>é—®é¢˜æ¦‚è¿°åŠè§£å†³</h1><h2 id="é—®é¢˜æè¿°"><a href="#é—®é¢˜æè¿°" class="headerlink" title="é—®é¢˜æè¿°"></a>é—®é¢˜æè¿°</h2><p>Centos 7 ç³»ç»Ÿ ä¼˜åŒ–ç³»ç»Ÿå†…æ ¸åï¼Œè´¦æˆ·æ— æ³•ç™»å½•ï¼ˆè¾“å…¥çš„è´¦å·å’Œå¯†ç å‡æ­£ç¡®ï¼Œç»å¯¹æ²¡æœ‰é”™è¯¯!!,ä¹Ÿæ²¡æœ‰ç¦æ­¢ç™»å½•!!ï¼‰ã€‚ æŠ¥é”™ä¸ºï¼šPermission deniedã€‚</p><p>ä¼˜åŒ–å†…æ ¸å†…å®¹ä¸ºï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/5/image_0e2522ad9bf3786bf27e2046dce4bc00.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/security/limits.conf</span><br><span class="line">* soft nofile 10000000  #é”™çš„ï¼Œåƒä¸‡åˆ«ç”¨</span><br><span class="line">* hard nofile 10000000 #é”™çš„ï¼Œåƒä¸‡åˆ«ç”¨</span><br><span class="line">* hard nproc 10000000 #é”™çš„ï¼Œåƒä¸‡åˆ«ç”¨</span><br><span class="line">* soft nproc 10000000 #é”™çš„ï¼Œåƒä¸‡åˆ«ç”¨</span><br></pre></td></tr></table></figure><p>æŠ¥é”™æˆªå›¾ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/5/image_73846570bd70375dc0a70a26e4e670dc.png"></p><p>å‡ºç°ä¸Šè¿°é—®é¢˜ï¼Œæ˜¯å› ä¸ºåœ¨ä¼˜åŒ–å†…æ ¸å‚æ•°æ—¶æ•°å€¼è¿‡å¤§</p><h2 id="åŸå› "><a href="#åŸå› " class="headerlink" title="åŸå› "></a>åŸå› </h2><p><del>limitè®¾ç½®çš„æœ€å¤§è¿›ç¨‹æ•°å’Œæ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°è¶…è¿‡äº†å†…æ ¸å‚æ•°sysctl..confå®šä¹‰çš„å€¼å°±æ˜¯è¶…è¿‡äº†å†…æ ¸å…è®¸çš„é»˜è®¤æœ€å¤§å€¼</del></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sysctl -p |grep fs.file-max</span><br><span class="line">sysctl -p |grep fs.nr_open</span><br></pre></td></tr></table></figure><h2 id="é—®é¢˜è§£å†³æ–¹æ³•ä¸€"><a href="#é—®é¢˜è§£å†³æ–¹æ³•ä¸€" class="headerlink" title="é—®é¢˜è§£å†³æ–¹æ³•ä¸€"></a>é—®é¢˜è§£å†³æ–¹æ³•ä¸€</h2><p>ä¿®æ”¹å†…æ ¸å‚æ•°ä¸ºä¸limitä¸€æ ·çš„å°±è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/sysctl.conf </span></span><br><span class="line"><span class="comment"># sysctl settings are defined through files in</span></span><br><span class="line"><span class="comment"># /usr/lib/sysctl.d/, /run/sysctl.d/, and /etc/sysctl.d/.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Vendors settings live in /usr/lib/sysctl.d/.</span></span><br><span class="line"><span class="comment"># To override a whole file, create a new file with the same in</span></span><br><span class="line"><span class="comment"># /etc/sysctl.d/ and put new settings there. To override</span></span><br><span class="line"><span class="comment"># only specific settings, add a file with a lexically later</span></span><br><span class="line"><span class="comment"># name in /etc/sysctl.d/ and put new settings there.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># For more information, see sysctl.conf(5) and sysctl.d(5).</span></span><br><span class="line">fs.file-max = 10000000</span><br><span class="line">fs.nr_open = 10000000</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/6/image_a1768e4a3fbafdcf1b5fc43e10de07e0.png"></p><h2 id="é—®é¢˜è§£å†³æ–¹æ³•äºŒ"><a href="#é—®é¢˜è§£å†³æ–¹æ³•äºŒ" class="headerlink" title="é—®é¢˜è§£å†³æ–¹æ³•äºŒ"></a>é—®é¢˜è§£å†³æ–¹æ³•äºŒ</h2><p>è¿›å•ç”¨æˆ·æ¨¡å¼å°†/etc/security/limits.conf ä¸­çš„å‚æ•°æ”¹ä¸ºç³»ç»Ÿå¯æ‰¿å—çš„å€¼ï¼Œç»è¿‡å¤šæ¬¡æµ‹éªŒï¼Œæœ€å¤§å¯å…è®¸çš„æ•°å€¼ä¸º<code>1000009ã€‚</code></p><h1 id="é—®é¢˜å‘ç°åŠæ’æŸ¥"><a href="#é—®é¢˜å‘ç°åŠæ’æŸ¥" class="headerlink" title="é—®é¢˜å‘ç°åŠæ’æŸ¥"></a>é—®é¢˜å‘ç°åŠæ’æŸ¥</h1><h2 id="é—®é¢˜å‘ç°"><a href="#é—®é¢˜å‘ç°" class="headerlink" title="é—®é¢˜å‘ç°"></a>é—®é¢˜å‘ç°</h2><p>Centosç³»ç»Ÿéƒ¨ç½²å®Œæˆï¼Œå¹¶è¿›è¡Œç³»ç»Ÿå†…æ ¸è°ƒä¼˜ï¼Œé‡å¯ç³»ç»Ÿåï¼Œå‘ç°è´¦æˆ·æ— æ³•ç™»å½•ã€‚ç¡®å®šè¾“å…¥çš„å¯†ç è‚¯å®šæ­£ç¡®ï¼Œä½†æ˜¯æŠ¥é”™Permission deniedã€‚</p><p>è§£å†³</p><p>åŠ è½½å†…æ ¸æ—¶æŒ‰eé”®è¿›å…¥å•ç”¨æˆ·æ¨¡å¼</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/5/image_d73ddba442a5120ce2ad9054fe768241.png"></p><p>æŒ‰æ–¹å‘é”®ä¸‹é”®â†“ï¼Œæ‰¾åˆ°è®¾ç½®è¯­è¨€çš„åœ°æ–¹ï¼Œå¦‚<code>LANG=en\_US.UTF-8</code>ï¼Œåœ¨åé¢è¿½åŠ <code>rw single init=/bin/bash</code>,ç„¶åæŒ‰<code>ctrl+x</code>é‡å¯ç³»ç»Ÿ</p><p>è¿›å…¥åå°±å‡ºç°æ­¤æŠ¥é”™</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/5/image_9ef4a15a2fde00976a591e39aff7b1ea.png"></p><p>ä¿®æ”¹å†…æ ¸å‚æ•°ä¸ºç³»ç»Ÿå¯ä»¥æ‰¿å—çš„èŒƒå›´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/security/limits.conf</span><br><span class="line">* soft nofile 1000000</span><br><span class="line">* hard nofile 1000000</span><br><span class="line">* hard <span class="built_in">nproc</span> 10000000</span><br><span class="line">* soft <span class="built_in">nproc</span> 1000000</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ–ä¿®æ”¹ä¸º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt;&gt; /etc/security/limits.conf &lt;&lt;<span class="string">EOF</span></span><br><span class="line"><span class="string">* - nofile 65535</span></span><br><span class="line"><span class="string">* - nproc 65535</span></span><br><span class="line"><span class="string">root - nofile 65535</span></span><br><span class="line"><span class="string">root - nproc 65535</span></span><br><span class="line"><span class="string">EOF</span></span><br><span class="line"> </span><br><span class="line"><span class="built_in">ulimit</span> -HSn 65535</span><br><span class="line"><span class="built_in">ulimit</span> -a</span><br></pre></td></tr></table></figure><p>æŒ‰Ctrl+Dï¼Œæ‰§è¡Œrebooté‡å¯ç”Ÿæ•ˆã€‚</p><p>è¾“å…¥è´¦æˆ·å¯†ç ï¼ŒæˆåŠŸç™»å½•ã€‚</p><p>è‡³æ­¤ï¼Œé—®é¢˜æˆåŠŸå®šä½å¹¶è§£å†³ã€‚</p><p>è¾“å…¥<code>exec /sbin/init</code>å‘½ä»¤é‡å¯ç³»ç»Ÿ</p><p><strong>å‚æ•°è§£é‡Šï¼š</strong></p><p><strong>ä»¥ä¸‹æ˜¯ä½ æä¾›çš„ <code>/etc/security/limits.conf</code> é…ç½®çš„è¯¦ç»†è¯´æ˜è¡¨æ ¼ï¼š</strong></p><table><thead><tr><th>ç”¨æˆ·/ç»„</th><th>ç±»å‹</th><th>é¡¹ç›®</th><th>é™åˆ¶å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>*</code></td><td>soft</td><td>nofile</td><td>1000000</td><td>æ¯ä¸ªè¿›ç¨‹å¯æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°ï¼ˆè½¯é™åˆ¶ï¼‰</td></tr><tr><td><code>*</code></td><td>hard</td><td>nofile</td><td>1000000</td><td>æ¯ä¸ªè¿›ç¨‹å¯æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°ï¼ˆç¡¬é™åˆ¶ï¼‰</td></tr><tr><td><code>*</code></td><td>hard</td><td>nproc</td><td>10000000</td><td>æ¯ä¸ªç”¨æˆ·å¯åˆ›å»ºçš„æœ€å¤§è¿›ç¨‹æ•°ï¼ˆç¡¬é™åˆ¶ï¼‰</td></tr><tr><td><code>*</code></td><td>soft</td><td>nproc</td><td>1000000</td><td>æ¯ä¸ªç”¨æˆ·å¯åˆ›å»ºçš„æœ€å¤§è¿›ç¨‹æ•°ï¼ˆè½¯é™åˆ¶ï¼‰</td></tr></tbody></table><p><strong>/etc/security/limits.conf è®¾ç½®å†…å®¹è§£æ</strong></p><table><thead><tr><th>ç”¨æˆ·/ç»„</th><th>ç±»å‹</th><th>é¡¹ç›®</th><th>é™åˆ¶å€¼</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>*</code></td><td><code>-</code></td><td>nofile</td><td>65535</td><td>æ‰€æœ‰ç”¨æˆ·æœ€å¤§å¯æ‰“å¼€æ–‡ä»¶æ•°ï¼ˆè½¯ç¡¬é™åˆ¶éƒ½è®¾ç½®ï¼‰</td></tr><tr><td><code>*</code></td><td><code>-</code></td><td>nproc</td><td>65535</td><td>æ‰€æœ‰ç”¨æˆ·æœ€å¤§å¯åˆ›å»ºè¿›ç¨‹æ•°ï¼ˆè½¯ç¡¬é™åˆ¶éƒ½è®¾ç½®ï¼‰</td></tr><tr><td><code>root</code></td><td><code>-</code></td><td>nofile</td><td>65535</td><td>root ç”¨æˆ·æœ€å¤§å¯æ‰“å¼€æ–‡ä»¶æ•°ï¼ˆè½¯ç¡¬é™åˆ¶éƒ½è®¾ç½®ï¼‰</td></tr><tr><td><code>root</code></td><td><code>-</code></td><td>nproc</td><td>65535</td><td>root ç”¨æˆ·æœ€å¤§å¯åˆ›å»ºè¿›ç¨‹æ•°ï¼ˆè½¯ç¡¬é™åˆ¶éƒ½è®¾ç½®ï¼‰</td></tr></tbody></table><blockquote><p>æ³¨ï¼š<code>-</code> è¡¨ç¤ºåŒæ—¶è®¾ç½®è½¯é™åˆ¶ï¼ˆsoftï¼‰å’Œç¡¬é™åˆ¶ï¼ˆhardï¼‰</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* hard nofile 1000000</span><br></pre></td></tr></table></figure><ul><li><strong>å«ä¹‰</strong>ï¼šæ‰€æœ‰ç”¨æˆ·çš„ <strong>hardï¼ˆç¡¬é™åˆ¶ï¼‰</strong> çš„ <code>nofile</code> ä¸º <code>1000000</code>ã€‚</li><li><strong>ç¡¬é™åˆ¶</strong> æ˜¯ç³»ç»Ÿå¼ºåˆ¶æ–½åŠ çš„ä¸Šé™ï¼Œä¸èƒ½è¢«éç‰¹æƒç”¨æˆ·æå‡ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* hard <span class="built_in">nproc</span> 10000000</span><br></pre></td></tr></table></figure><ul><li><strong>å«ä¹‰</strong>ï¼šæ‰€æœ‰ç”¨æˆ·çš„ <strong>ç¡¬é™åˆ¶</strong> çš„ <code>nproc</code>ï¼ˆæ¯ä¸ªç”¨æˆ·èƒ½åˆ›å»ºçš„æœ€å¤§è¿›ç¨‹æ•°ï¼‰ä¸º <code>10000000</code>ã€‚</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* soft <span class="built_in">nproc</span> 1000000</span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li><strong>å«ä¹‰</strong>ï¼šæ‰€æœ‰ç”¨æˆ·çš„ <strong>è½¯é™åˆ¶</strong> çš„ <code>nproc</code> ä¸º <code>1000000</code>ã€‚</li></ul><p><strong>Shell å‘½ä»¤è§£æ</strong></p><table><thead><tr><th>å‘½ä»¤</th><th>ä½œç”¨è¯´æ˜</th></tr></thead><tbody><tr><td><code>ulimit -HSn 65535</code></td><td>è®¾ç½®å½“å‰ shell ä¼šè¯çš„æ–‡ä»¶æè¿°ç¬¦è½¯ç¡¬é™åˆ¶ä¸º 65535</td></tr><tr><td><code>ulimit -a</code></td><td>æŸ¥çœ‹å½“å‰ shell ä¼šè¯çš„æ‰€æœ‰èµ„æºé™åˆ¶</td></tr></tbody></table><hr><p>ulimit -a è¾“å‡ºå‚æ•°è§£é‡Šè¡¨ï¼ˆå«å¸¸è§å­—æ®µï¼‰</p><p>ä»¥ä¸‹æ˜¯ <code>ulimit -a</code> å¯èƒ½è¾“å‡ºçš„é¡¹ç›®åŠå«ä¹‰ï¼ˆå…·ä½“è¾“å‡ºä¼šå› ç³»ç»Ÿè€Œå¼‚ï¼‰ï¼š</p><table><thead><tr><th>å‚æ•°åç§°</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>core file size</td><td>ç”Ÿæˆ core dump æ–‡ä»¶çš„æœ€å¤§å¤§å°ï¼ˆå•ä½ blocksï¼‰</td></tr><tr><td>data seg size</td><td>æ•°æ®æ®µçš„æœ€å¤§å¤§å°ï¼ˆè¿›ç¨‹å¯ç”¨çš„æ•°æ®ç©ºé—´ï¼‰</td></tr><tr><td>scheduling priority</td><td>è¿›ç¨‹è°ƒåº¦ä¼˜å…ˆçº§</td></tr><tr><td>file size</td><td>å•ä¸ªæ–‡ä»¶çš„æœ€å¤§å¯å†™å…¥å¤§å°</td></tr><tr><td>open files (<code>nofile</code>)</td><td>æ¯ä¸ªè¿›ç¨‹æœ€å¤§å¯æ‰“å¼€çš„æ–‡ä»¶æè¿°ç¬¦æ•°</td></tr><tr><td>pipe size</td><td>ç®¡é“ç¼“å†²åŒºå¤§å°</td></tr><tr><td>POSIX message queues</td><td>POSIX æ¶ˆæ¯é˜Ÿåˆ—å¯ç”¨çš„æœ€å¤§å†…å­˜</td></tr><tr><td>real-time priority</td><td>å®æ—¶è°ƒåº¦ç­–ç•¥çš„ä¼˜å…ˆçº§</td></tr><tr><td>stack size</td><td>çº¿ç¨‹æ ˆå¤§å°é™åˆ¶</td></tr><tr><td>cpu time</td><td>å•ä¸ªè¿›ç¨‹å¯ä½¿ç”¨çš„ CPU æ—¶é—´é™åˆ¶ï¼ˆå•ä½ç§’ï¼‰</td></tr><tr><td>max user processes (<code>nproc</code>)</td><td>æ¯ä¸ªç”¨æˆ·å…è®¸çš„æœ€å¤§è¿›ç¨‹æ•°ï¼ˆåŒ…æ‹¬çº¿ç¨‹ï¼‰</td></tr><tr><td>virtual memory</td><td>å¯ç”¨çš„è™šæ‹Ÿå†…å­˜æ€»é‡ï¼ˆåœ°å€ç©ºé—´ï¼‰</td></tr><tr><td>locked-in-memory size</td><td>å…è®¸é”å®šåˆ° RAM çš„å†…å­˜æœ€å¤§å€¼</td></tr></tbody></table><p><strong>è¡¥å……è¯´æ˜</strong>ï¼š</p><ul><li><code>*</code> è¡¨ç¤ºå¯¹æ‰€æœ‰ç”¨æˆ·ç”Ÿæ•ˆã€‚</li><li><code>soft</code>ï¼ˆè½¯é™åˆ¶ï¼‰å¯ä»¥ç”±ç”¨æˆ·è‡ªå·±ä¸´æ—¶æé«˜åˆ° <code>hard</code> é™å€¼ä»¥ä¸‹ã€‚</li><li><code>hard</code>ï¼ˆç¡¬é™åˆ¶ï¼‰æ˜¯ç³»ç»Ÿæ–½åŠ çš„æœ€å¤§é™åˆ¶ï¼Œä¸èƒ½è¢«é root ç”¨æˆ·æé«˜ã€‚</li><li><code>nofile</code>ï¼šæœ€å¤§æ–‡ä»¶æè¿°ç¬¦æ•°é‡ï¼Œå½±å“ç½‘ç»œè¿æ¥ã€æ–‡ä»¶æ‰“å¼€ç­‰ã€‚</li><li><code>nproc</code>ï¼šæœ€å¤§è¿›ç¨‹æ•°ï¼Œå½±å“ç”¨æˆ·èƒ½åŒæ—¶è¿è¡Œå¤šå°‘è¿›ç¨‹æˆ–çº¿ç¨‹ã€‚</li></ul><p>ä½ æ˜¯åœ¨å“ªç§åœºæ™¯ä¸‹éœ€è¦è®¾è¿™ä¹ˆé«˜çš„ <code>nofile</code> å’Œ <code>nproc</code>ï¼Ÿæ˜¯åšé«˜å¹¶å‘æœåŠ¡ï¼ˆå¦‚ Nginxã€Redisã€Kafkaï¼‰è¿˜æ˜¯ AI æ¨¡å‹è®¡ç®—ç±»ä»»åŠ¡ï¼Ÿ</p><h3 id="æ³¨æ„äº‹é¡¹ï¼š"><a href="#æ³¨æ„äº‹é¡¹ï¼š" class="headerlink" title="æ³¨æ„äº‹é¡¹ï¼š"></a>æ³¨æ„äº‹é¡¹ï¼š</h3><ol><li><p>è¿™äº›é™åˆ¶åªä¼šåœ¨ä½¿ç”¨ PAM ç™»å½•æ—¶ç”Ÿæ•ˆï¼ˆå¦‚ SSHã€suã€login ç­‰ï¼‰ã€‚</p></li><li><p>è¦è®©å®ƒç”Ÿæ•ˆï¼Œè¿˜è¦ç¡®ä¿ <code>/etc/pam.d/common-session</code> æˆ– <code>/etc/pam.d/sshd</code> ä¸­æœ‰å¦‚ä¸‹é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">session required pam_limits.so</span><br><span class="line"></span><br></pre></td></tr></table></figure></li><li><p>è®¾ç½®è¿‡é«˜çš„å€¼ï¼ˆæ¯”å¦‚ <code>nproc</code> è®¾åˆ°åƒä¸‡çº§ï¼‰å¦‚æœæ²¡æœ‰å¿…è¦ï¼Œå¯èƒ½å¯¼è‡´ç³»ç»Ÿèµ„æºè€—å°½æˆ–è¢«æ»¥ç”¨ï¼Œå»ºè®®æ ¹æ®å®é™…æƒ…å†µè®¾ç½®ã€‚</p></li></ol><p>ä½ æ˜¯ä¸ºå“ªç±»åº”ç”¨æˆ–æœåŠ¡é…ç½®è¿™ä¹ˆå¤§çš„èµ„æºé™åˆ¶ï¼Ÿ</p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centosåˆ›å»ºiscsiå­˜å‚¨</title>
      <link href="/2025/04/28/Centos%E5%88%9B%E5%BB%BAiscsi%E5%AD%98%E5%82%A8/"/>
      <url>/2025/04/28/Centos%E5%88%9B%E5%BB%BAiscsi%E5%AD%98%E5%82%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Centosåˆ›å»ºiscsiå­˜å‚¨"><a href="#Centosåˆ›å»ºiscsiå­˜å‚¨" class="headerlink" title="Centosåˆ›å»ºiscsiå­˜å‚¨"></a>Centosåˆ›å»ºiscsiå­˜å‚¨</h1><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_45052781/article/details/121300343">https://blog.csdn.net/weixin_45052781/article/details/121300343</a></p><h3 id="ISCSIæœåŠ¡ä»‹ç»"><a href="#ISCSIæœåŠ¡ä»‹ç»" class="headerlink" title="ISCSIæœåŠ¡ä»‹ç»"></a>ISCSIæœåŠ¡ä»‹ç»</h3><ul><li>å…¨ç§°ï¼šInternet Small Computer System Interfaceâ€”â€”äº’è”ç½‘å°å‹è®¡ç®—æœºæ¥å£<br>é€šè¿‡ç½‘ç»œè·å–ç£ç›˜è®¾å¤‡åœ¨æœ¬åœ°è¿›è¡Œå­˜å‚¨ä½¿ç”¨ã€‚</li><li>iscsiæ˜¯åŸºäºTCP/IPå’Œscsiåè®®çš„ä¸€é¡¹æŠ€æœ¯ï¼Œä»»ä¸€ä¸»æœºé€šè¿‡iscsi targetåŠŸèƒ½æˆä¸ºiscsiå­˜å‚¨ç©ºé—´çš„å…±äº«è€…/æœåŠ¡ç«¯ï¼›åŒæ ·çš„ï¼Œä»»ä¸€ä¸»æœºé€šè¿‡iscsi initiator(åˆå§‹åŒ–ç”¨æˆ·)åŠŸèƒ½å¯ä»¥æˆä¸ºiscsiå­˜å‚¨ç©ºé—´çš„ä½¿ç”¨è€…/å®¢æˆ·ç«¯ï¼›é™åˆ¶iscsiçš„ç›¸äº’ä¹‹é—´çš„è”ç³»éœ€è¦é…ç½®è§„åˆ™ï¼Œåœ¨æ— è§„åˆ™æƒ…å†µä¸‹ï¼ŒåŒæ–¹æ˜¯å¯ä»¥å»ºç«‹è”ç³»çš„</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_754fb78a46fd0fc815ae53870f2416e4.png"></p><ul><li>ç”±äºiscsiå’Œscsiå·®çš„æ˜¯ä¸€ä¸ªinternetï¼ˆtcp/ipåè®®ï¼‰ï¼Œå¤§åŒå°å¼‚ï¼Œæ‰€ä»¥<strong>é˜…è¯»æœ¬æ–‡æ—¶å¯ä»¥å°†iscsiå’Œscsiè§†ä¸ºåŒä¸€ç‰©</strong>ã€‚ï¼ˆ<strong>è™½ç„¶ä¸¥æ ¼æ¥è¯´ä¸ä¸€æ ·</strong>ï¼‰</li></ul><h3 id="ç¯å¢ƒè§„åˆ’"><a href="#ç¯å¢ƒè§„åˆ’" class="headerlink" title="ç¯å¢ƒè§„åˆ’"></a>ç¯å¢ƒè§„åˆ’</h3><table><thead><tr><th>åœ°å€</th><th>è§’è‰²</th><th>å…¶ä»–</th></tr></thead><tbody><tr><td>10.0.0.10</td><td>æœåŠ¡ç«¯</td><td>æ— </td></tr><tr><td>10.0.0.11</td><td>å®¢æˆ·ç«¯</td><td>æ— </td></tr></tbody></table><h3 id="æœåŠ¡ç«¯æ­å»º"><a href="#æœåŠ¡ç«¯æ­å»º" class="headerlink" title="æœåŠ¡ç«¯æ­å»º"></a>æœåŠ¡ç«¯æ­å»º</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_7a9f43f9608836490af7ea99d7e0f177.png"></p><h4 id="å®‰è£…æœåŠ¡ç«¯è½¯ä»¶"><a href="#å®‰è£…æœåŠ¡ç«¯è½¯ä»¶" class="headerlink" title="å®‰è£…æœåŠ¡ç«¯è½¯ä»¶"></a>å®‰è£…æœåŠ¡ç«¯è½¯ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…è½¯ä»¶</span></span><br><span class="line">yum install targetcli.noarch  -y</span><br><span class="line">yum install targetd targetcli -y  <span class="comment"># å…±äº«ç£ç›˜æœåŠ¡</span></span><br></pre></td></tr></table></figure><h4 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart target //é‡å¯targetæœåŠ¡</span><br><span class="line">systemctl stop firewalld //è®°å¾—å…³é—­é˜²ç«å¢™æˆ–è€…é…ç½®é˜²ç«å¢™è§„åˆ™ä¹Ÿå¯ä»¥</span><br><span class="line"><span class="comment"># centos7æ°¸ä¹…å¼€æ”¾3260ç«¯å£ï¼š</span></span><br><span class="line">firewall-cmd --zone=public --add-port=3260/tcp --permanent</span><br><span class="line">setenforce 0 //æš‚æ—¶å…³é—­selinux</span><br></pre></td></tr></table></figure><h4 id="é…ç½®æœåŠ¡ç«¯è¾“å…¥-targetcli-è¿›å…¥äº¤äº’å¼ç•Œé¢"><a href="#é…ç½®æœåŠ¡ç«¯è¾“å…¥-targetcli-è¿›å…¥äº¤äº’å¼ç•Œé¢" class="headerlink" title="é…ç½®æœåŠ¡ç«¯è¾“å…¥ targetcli è¿›å…¥äº¤äº’å¼ç•Œé¢"></a>é…ç½®æœåŠ¡ç«¯è¾“å…¥ targetcli è¿›å…¥äº¤äº’å¼ç•Œé¢</h4><p>äº¤äº’å¼æ“ä½œéœ€è¦ç”¨åˆ°çš„å‘½ä»¤ï¼šæ ‡é»„è‰²éƒ¨åˆ†</p><p>targetcli</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">[root@zxw1 ~]<span class="comment"># targetcli</span></span><br><span class="line">Warning: Could not load preferences file /root/.targetcli/prefs.bin.</span><br><span class="line">targetcli shell version 2.1.53</span><br><span class="line">Copyright 2011-2013 by Datera, Inc and others.</span><br><span class="line">For <span class="built_in">help</span> on commands, <span class="built_in">type</span> <span class="string">&#x27;help&#x27;</span>.</span><br><span class="line"></span><br><span class="line">/&gt; <span class="built_in">ls</span></span><br><span class="line">o- / ......................................................................................................................... [...]</span><br><span class="line">  o- backstores .............................................................................................................. [...]</span><br><span class="line">  | o- block .................................................................................................. [Storage Objects: 0]</span><br><span class="line">  | o- fileio ................................................................................................. [Storage Objects: 0]</span><br><span class="line">  | o- pscsi .................................................................................................. [Storage Objects: 0]</span><br><span class="line">  | o- ramdisk ................................................................................................ [Storage Objects: 0]</span><br><span class="line">  o- iscsi ............................................................................................................ [Targets: 0]</span><br><span class="line">  o- loopback ......................................................................................................... [Targets: 0]</span><br><span class="line">/&gt; <span class="built_in">cd</span> /backstores/block</span><br><span class="line">/backstores/block&gt; <span class="built_in">ls</span></span><br><span class="line">o- block ...................................................................................................... [Storage Objects: 0]</span><br><span class="line">/backstores/block&gt; create dev=/dev/sdb name=disk0</span><br><span class="line">Created block storage object disk0 using /dev/sdb.</span><br><span class="line">/backstores/block&gt; <span class="built_in">cd</span> iscsi</span><br><span class="line">No such path /backstores/block/iscsi</span><br><span class="line">/backstores/block&gt; <span class="built_in">ls</span></span><br><span class="line">o- block ...................................................................................................... [Storage Objects: 1]</span><br><span class="line">  o- disk0 .............................................................................. [/dev/sdb (5.0GiB) write-thru deactivated]</span><br><span class="line">    o- alua ....................................................................................................... [ALUA Groups: 1]</span><br><span class="line">      o- default_tg_pt_gp ........................................................................... [ALUA state: Active/optimized]</span><br><span class="line">/backstores/block&gt; <span class="built_in">cd</span>  /iscsi</span><br><span class="line">/iscsi&gt; <span class="built_in">ls</span></span><br><span class="line">o- iscsi .............................................................................................................. [Targets: 0]</span><br><span class="line">/iscsi&gt; create</span><br><span class="line">Created target iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22.</span><br><span class="line">Created TPG 1.</span><br><span class="line">Global pref auto_add_default_portal=<span class="literal">true</span></span><br><span class="line">Created default portal listening on all IPs (0.0.0.0), port 3260.</span><br><span class="line">/iscsi&gt; <span class="built_in">ls</span></span><br><span class="line">o- iscsi .............................................................................................................. [Targets: 1]</span><br><span class="line">  o- iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22 .............................................................. [TPGs: 1]</span><br><span class="line">    o- tpg1 ................................................................................................. [no-gen-acls, no-auth]</span><br><span class="line">      o- acls ............................................................................................................ [ACLs: 0]</span><br><span class="line">      o- luns ............................................................................................................ [LUNs: 0]</span><br><span class="line">      o- portals ...................................................................................................... [Portals: 1]</span><br><span class="line">        o- 0.0.0.0:3260 ....................................................................................................... [OK]</span><br><span class="line">/iscsi&gt; <span class="built_in">cd</span> iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22/tpg1/</span><br><span class="line">/iscsi/iqn.20...f8aabb22/tpg1&gt; <span class="built_in">ls</span></span><br><span class="line">o- tpg1 ..................................................................................................... [no-gen-acls, no-auth]</span><br><span class="line">  o- acls ................................................................................................................ [ACLs: 0]</span><br><span class="line">  o- luns ................................................................................................................ [LUNs: 0]</span><br><span class="line">  o- portals .......................................................................................................... [Portals: 1]</span><br><span class="line">    o- 0.0.0.0:3260 ........................................................................................................... [OK]</span><br><span class="line">/iscsi/iqn.20...f8aabb22/tpg1&gt; <span class="built_in">set</span> attribute authentication=0 demo_mode_write_protect=0 generate_node_acls=1 cache_dynamic_acls=1</span><br><span class="line">Parameter demo_mode_write_protect is now <span class="string">&#x27;0&#x27;</span>.</span><br><span class="line">Parameter authentication is now <span class="string">&#x27;0&#x27;</span>.</span><br><span class="line">Parameter generate_node_acls is now <span class="string">&#x27;1&#x27;</span>.</span><br><span class="line">Parameter cache_dynamic_acls is now <span class="string">&#x27;1&#x27;</span>.</span><br><span class="line">/iscsi/iqn.20...f8aabb22/tpg1&gt; <span class="built_in">cd</span> luns</span><br><span class="line">/iscsi/iqn.20...b22/tpg1/luns&gt; <span class="built_in">ls</span></span><br><span class="line">o- luns .................................................................................................................. [LUNs: 0]</span><br><span class="line">/iscsi/iqn.20...b22/tpg1/luns&gt; create /backstores/block/disk0</span><br><span class="line">Created LUN 0.</span><br><span class="line">/iscsi/iqn.20...b22/tpg1/luns&gt; <span class="built_in">exit</span></span><br><span class="line">Global pref auto_save_on_exit=<span class="literal">true</span></span><br><span class="line">Configuration saved to /etc/target/saveconfig.json</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°æ— è®ºä»»ä½•<code>IP</code>å®¢æœç«¯å‡å¯è¿æ¥</p><h4 id="å‚æ•°å‘½ä»¤è§£é‡Š"><a href="#å‚æ•°å‘½ä»¤è§£é‡Š" class="headerlink" title="å‚æ•°å‘½ä»¤è§£é‡Š"></a>å‚æ•°å‘½ä»¤è§£é‡Š</h4><h5 id="é…ç½®iscsiæœåŠ¡å™¨ç«¯çš„å…±äº«èµ„æº"><a href="#é…ç½®iscsiæœåŠ¡å™¨ç«¯çš„å…±äº«èµ„æº" class="headerlink" title="é…ç½®iscsiæœåŠ¡å™¨ç«¯çš„å…±äº«èµ„æº"></a>é…ç½®iscsiæœåŠ¡å™¨ç«¯çš„å…±äº«èµ„æº</h5><ul><li>ä½¿ç”¨targetcliå‘½ä»¤ç®¡ç†iscsiçš„é…ç½®ï¼Œå®ƒæä¾›äº†ä¸€ä¸ªäº¤äº’å¼çš„é…ç½®ç•Œé¢ï¼Œç±»ä¼¼fdiskå‘½ä»¤</li><li>æ‰§è¡Œtargetcliè¿›å…¥é…ç½®ç•Œé¢</li><li>æŸ¥çœ‹åˆå§‹é…ç½®</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_73eda6e10ee26ffb5dcc9c1fd4ceba88.png"></p><p>è¿›å…¥åˆ° /backstores/block ç›®å½•ï¼Œå°†åˆ›å»ºçš„md0æˆ–è€…ç£ç›˜æ·»åŠ åˆ°å…±äº«è®¾å¤‡çš„â€œèµ„æºæ± â€ä¸­</p><p>å°†æ–‡ä»¶é‡æ–°å‘½åä¸ºdisk0</p><p>backstores/block #ç‰©ç†å· å¦‚æœåˆ›å»ºçš„æ˜¯ç‰©ç†å·åœ¨è¯¥ç›®å½•åˆ›å»º</p><p>backstores/fileio #é€»è¾‘å· å¦‚æœåˆ›å»ºçš„æ˜¯é€»è¾‘å·åœ¨è¯¥ç›®å½•åˆ›å»º å¦‚lv</p><p>æˆ‘ä»¬ä¹‹å‰åŠ å…¥äº†ä¸€ä¸ªsdbç£ç›˜</p><p>åˆ©ç”¨sdbåˆ›å»º</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> backstores/block</span><br><span class="line">create disk0 /dev/sdb</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_f941ceee7ed5e18a2aab70d2e9df9ef5.png"></p><h4 id="åˆ›å»ºiscsi-targetåç§°åŠé…ç½®å…±äº«èµ„æº"><a href="#åˆ›å»ºiscsi-targetåç§°åŠé…ç½®å…±äº«èµ„æº" class="headerlink" title="åˆ›å»ºiscsi targetåç§°åŠé…ç½®å…±äº«èµ„æº"></a>åˆ›å»ºiscsi targetåç§°åŠé…ç½®å…±äº«èµ„æº</h4><ul><li>iscsi targetåç§°æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆçš„ï¼Œè¿™æ˜¯ä¸€ä¸²ç”¨äºæè¿°å…±äº«èµ„æºçš„å”¯ä¸€å­—ç¬¦ä¸²</li><li>ç”¨æˆ·åœ¨æ‰«æiscsiæœåŠ¡ç«¯æ—¶ä¼šæ˜¾ç¤ºè¿™ä¸ªtargetåç§°ã€‚è¿›å…¥åˆ°/iscsiç›®å½•ä¸‹ï¼Œç”Ÿæˆtargetåç§°ï¼Œ</li><li>åŒæ—¶ä¼šåˆ›å»ºä¸€ä¸ªåŒåçš„â€œç›®å½•â€ï¼Œæ¥å­˜æ”¾å…±äº«èµ„æº</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /iscsi</span><br><span class="line">create</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_4f835ddcf8d451cacc98030fdedc37c7.png"></p><h5 id="è¿›å…¥åˆ°æ–°åˆ›å»ºçš„ç›®å½•ä¸­ï¼Œå°†disk0æ·»åŠ åˆ°è¿™ä¸ªæ–°ç›®å½•"><a href="#è¿›å…¥åˆ°æ–°åˆ›å»ºçš„ç›®å½•ä¸­ï¼Œå°†disk0æ·»åŠ åˆ°è¿™ä¸ªæ–°ç›®å½•" class="headerlink" title="è¿›å…¥åˆ°æ–°åˆ›å»ºçš„ç›®å½•ä¸­ï¼Œå°†disk0æ·»åŠ åˆ°è¿™ä¸ªæ–°ç›®å½•"></a>è¿›å…¥åˆ°æ–°åˆ›å»ºçš„ç›®å½•ä¸­ï¼Œå°†disk0æ·»åŠ åˆ°è¿™ä¸ªæ–°ç›®å½•</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> iqn.2003-01.org.linux-iscsi.ceph01.x8664:sn.22f6a7064678/tpg1/luns</span><br><span class="line"></span><br><span class="line">create /backstores/block/disk0</span><br></pre></td></tr></table></figure><p>ç›®å½•ï¼š/iscsi/iqn.2003-01.org.linux-iscsi.ceph01.x8664:sn.22f6a7064678/tpg1/luns</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_520faee99bc566524dc5ede08cb63a58.png"></p><h3 id="äºŒã€è®¾ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨-ACL"><a href="#äºŒã€è®¾ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨-ACL" class="headerlink" title="äºŒã€è®¾ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨(ACL)"></a>äºŒã€è®¾ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨(ACL)</h3><ul><li><p>ä¸è®¾ç½®åˆ™æ‰€æœ‰äººéƒ½å¯ä»¥æŒ‚è½½æ­¤å—ç£ç›˜</p></li><li><p>åç§°ä¸æœåŠ¡ç«¯ä¸­è®¾ç½®çš„è®¿é—®æ§åˆ¶åˆ—è¡¨ä¸­æŸä¸€åç§°æ¡ç›®ä¸€è‡´å³å¯ã€‚aclså‚æ•°ç›®å½•ç”¨äºå­˜æ”¾èƒ½å¤Ÿè®¿é—®iscsiæœåŠ¡</p></li><li><p>å…±äº«å­˜å‚¨èµ„æºçš„å®¢æˆ·ç«¯åç§°ã€‚</p></li><li><p>åœ¨iscsiæœåŠ¡ç«¯çš„é…ç½®æ–‡ä»¶ä¸­å†™å…¥ä¸€ä¸²èƒ½å¤ŸéªŒè¯ç”¨æˆ·ä¿¡æ¯çš„åç§°ï¼Œè¿™é‡Œä½¿ç”¨targetåç§°ï¼ŒåŠ ä¸Š:clientï¼Œè¿™ä¸ª</p></li><li><p>è‡ªå·±å®šä¹‰çš„å­—ç¬¦ä¸²ï¼Œå…·æœ‰å”¯ä¸€æ€§å³å¯</p></li><li><p>iscsiåè®®æ˜¯é€šè¿‡å®¢æˆ·ç«¯åç§°è¿›è¡ŒéªŒè¯çš„ï¼Œç”¨æˆ·åœ¨è®¿é—®å­˜å‚¨å…±äº«èµ„æºæ˜¯ä¸éœ€è¦è¾“å…¥å¯†ç ï¼Œåªè¦iscsiå®¢æˆ·ç«¯çš„</p></li><li><p>targetcliè¿›å…¥äº¤äº’ç•Œé¢</p><p>ç›®å½•ï¼š/iscsi/iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22/tpg1/acls</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_dc18bb21ec3942cd2a585e58dfa4608d.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /iscsi/iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22/tpg1/acls</span><br><span class="line">create iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22:client</span><br></pre></td></tr></table></figure></li></ul><h4 id="è®¾ç½®iscsiæœåŠ¡ç«¯ç›‘å¬çš„IPå’Œç«¯å£å·"><a href="#è®¾ç½®iscsiæœåŠ¡ç«¯ç›‘å¬çš„IPå’Œç«¯å£å·" class="headerlink" title="è®¾ç½®iscsiæœåŠ¡ç«¯ç›‘å¬çš„IPå’Œç«¯å£å·"></a>è®¾ç½®iscsiæœåŠ¡ç«¯ç›‘å¬çš„IPå’Œç«¯å£å·</h4><p>ç›®å½•ï¼š/iscsi/iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22/tpg1/portals</p><p>æ­¤IPéœ€è¦æ˜¯æœåŠ¡ç«¯çš„IPï¼ˆ10.0.0.10ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /iscsi/iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22/tpg1/portals</span><br><span class="line">delete 0.0.0.0 3260</span><br><span class="line">create 10.0.0.10 3260</span><br></pre></td></tr></table></figure><p>å…ˆåˆ æ‰ä¹‹å‰é»˜è®¤ç”Ÿæˆçš„0.0.0.0å¦åˆ™ä¼šæŠ¥é”™</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_5684c7857214ab2948680e4db85dc616.png"></p><p>æ£€æŸ¥é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">/iscsi/iqn.20.../tpg1/portals&gt; <span class="built_in">cd</span> /</span><br><span class="line">/&gt; <span class="built_in">ls</span></span><br><span class="line">o- / ......................................................................................................................... [...]</span><br><span class="line">  o- backstores .............................................................................................................. [...]</span><br><span class="line">  | o- block .................................................................................................. [Storage Objects: 1]</span><br><span class="line">  | | o- disk0 ............................................................................ [/dev/sdb (5.0GiB) write-thru activated]</span><br><span class="line">  | |   o- alua ................................................................................................... [ALUA Groups: 1]</span><br><span class="line">  | |     o- default_tg_pt_gp ....................................................................... [ALUA state: Active/optimized]</span><br><span class="line">  | o- fileio ................................................................................................. [Storage Objects: 0]</span><br><span class="line">  | o- pscsi .................................................................................................. [Storage Objects: 0]</span><br><span class="line">  | o- ramdisk ................................................................................................ [Storage Objects: 0]</span><br><span class="line">  o- iscsi ............................................................................................................ [Targets: 1]</span><br><span class="line">  | o- iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22 ............................................................ [TPGs: 1]</span><br><span class="line">  |   o- tpg1 .................................................................................................. [gen-acls, no-auth]</span><br><span class="line">  |     o- acls .......................................................................................................... [ACLs: 1]</span><br><span class="line">  |     | o- iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22:client ........................................ [Mapped LUNs: 1]</span><br><span class="line">  |     |   o- mapped_lun0 ................................................................................. [lun0 block/disk0 (rw)]</span><br><span class="line">  |     o- luns .......................................................................................................... [LUNs: 1]</span><br><span class="line">  |     | o- lun0 ...................................................................... [block/disk0 (/dev/sdb) (default_tg_pt_gp)]</span><br><span class="line">  |     o- portals .................................................................................................... [Portals: 1]</span><br><span class="line">  |       o- 10.0.0.11:3260 ................................................................................................... [OK]</span><br><span class="line">  o- loopback ......................................................................................................... [Targets: 0]</span><br><span class="line">/&gt; saveconfig</span><br><span class="line">Last 10 configs saved <span class="keyword">in</span> /etc/target/backup/.</span><br><span class="line">Configuration saved to /etc/target/saveconfig.json</span><br></pre></td></tr></table></figure><p>æœ€åï¼šsaveconfig ä¿å­˜</p><p>è‹¥ï¼šæœ‰å¤šå—ç£ç›˜ä¾æ¬¡åˆ›å»ºå³å¯</p><p><strong>å¦‚æœä¸€ä¸ªå®¢æœç«¯è¦è¿æ¥å¤šä¸ªæœåŠ¡ç«¯åˆ™éœ€è¦è®¾ç½®çš„chapä¸€æ · asclä¸€æ ·å¦‚ä¸‹</strong></p><h3 id="ä¸‰ã€é‡å¯æœåŠ¡ï¼Œé…ç½®é˜²ç«å¢™"><a href="#ä¸‰ã€é‡å¯æœåŠ¡ï¼Œé…ç½®é˜²ç«å¢™" class="headerlink" title="ä¸‰ã€é‡å¯æœåŠ¡ï¼Œé…ç½®é˜²ç«å¢™"></a>ä¸‰ã€é‡å¯æœåŠ¡ï¼Œé…ç½®é˜²ç«å¢™</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart targetd</span><br><span class="line">firewall-cmd --permanent --add-port=3260/tcp</span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><p>iscsiæœåŠ¡å™¨ç«¯é…ç½®å®Œæˆã€‚</p><h3 id="å››ã€iscsiå®¢æˆ·ç«¯æ­å»º"><a href="#å››ã€iscsiå®¢æˆ·ç«¯æ­å»º" class="headerlink" title="å››ã€iscsiå®¢æˆ·ç«¯æ­å»º"></a>å››ã€iscsiå®¢æˆ·ç«¯æ­å»º</h3><h4 id="é…ç½®linuxå®¢æˆ·ç«¯"><a href="#é…ç½®linuxå®¢æˆ·ç«¯" class="headerlink" title="é…ç½®linuxå®¢æˆ·ç«¯"></a>é…ç½®linuxå®¢æˆ·ç«¯</h4><p>ä½¿ç”¨yumå®‰è£…å®¢æˆ·ç«¯è½¯ä»¶iscsi-initiator-utils</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install iscsi-initiator-utils -y</span><br></pre></td></tr></table></figure><h5 id="ä¿®æ”¹é…ç½®æ–‡ä»¶"><a href="#ä¿®æ”¹é…ç½®æ–‡ä»¶" class="headerlink" title="ä¿®æ”¹é…ç½®æ–‡ä»¶"></a>ä¿®æ”¹é…ç½®æ–‡ä»¶</h5><p>ç¼–è¾‘å®¢æˆ·ç«¯ä¸­çš„initiatoråç§°æ–‡ä»¶ï¼ŒæŠŠæœåŠ¡å™¨ç«¯çš„è®¿é—®æ§åˆ¶åˆ—è¡¨åç§°å¡«å†™è¿›æ¥(æœåŠ¡å™¨ç«¯aclsç›®å½•ä¸­è‡ªå®šä¹‰çš„åç§°),é‡å¯æœåŠ¡ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/iscsi/initiatorname.iscsi</span><br><span class="line"><span class="comment"># é»˜è®¤é…ç½®</span></span><br><span class="line">InitiatorName=iqn.1994-05.com.redhat:391499fd3913</span><br><span class="line"><span class="comment"># ä¿®æ”¹å</span></span><br><span class="line">InitiatorName=iqn.1994-05.com.redhat:391499fd3913</span><br><span class="line">InitiatorName=iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22:client</span><br><span class="line"><span class="comment"># é‡å¯å®¢æˆ·ç«¯</span></span><br><span class="line">systemctl restart iscsid</span><br><span class="line">systemctl <span class="built_in">enable</span> iscsid</span><br></pre></td></tr></table></figure><h5 id="æ‰«æiscsiæœåŠ¡å™¨ç«¯ï¼ŒæŸ¥çœ‹å¯ç”¨çš„å…±äº«å­˜å‚¨èµ„æº"><a href="#æ‰«æiscsiæœåŠ¡å™¨ç«¯ï¼ŒæŸ¥çœ‹å¯ç”¨çš„å…±äº«å­˜å‚¨èµ„æº" class="headerlink" title="æ‰«æiscsiæœåŠ¡å™¨ç«¯ï¼ŒæŸ¥çœ‹å¯ç”¨çš„å…±äº«å­˜å‚¨èµ„æº"></a>æ‰«æiscsiæœåŠ¡å™¨ç«¯ï¼ŒæŸ¥çœ‹å¯ç”¨çš„å…±äº«å­˜å‚¨èµ„æº</h5><ul><li><p>å£è¯€â€œå…ˆå‘ç°ï¼Œåœ¨ç™»é™†ï¼Œæœ€åæŒ‚è½½å¹¶ä½¿ç”¨â€ã€‚</p></li><li><p>iscsiadm ç”¨äºç®¡ç†ã€æŸ¥è¯¢ã€æ’å…¥ã€æ›´æ–°æˆ–åˆ é™¤iscsiæ•°æ®åº“é…ç½®æ–‡ä»¶çš„å·¥å…·ã€‚</p></li><li><p>-m discovery æ‰«æå¹¶å‘ç°å¯ç”¨çš„å­˜å‚¨èµ„æº</p></li><li><p>-t st æ‰§è¡Œæ‰«ææ“ä½œçš„ç±»å‹</p></li><li><p>-p 192.168.137.10 å‚æ•°ä¸ºiscsiæœåŠ¡ç«¯çš„IPåœ°å€</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iscsiadm -m discovery -t st -p 10.0.0.10</span><br></pre></td></tr></table></figure><h5 id="ç™»å½•iscsiæœåŠ¡ç«¯"><a href="#ç™»å½•iscsiæœåŠ¡ç«¯" class="headerlink" title="ç™»å½•iscsiæœåŠ¡ç«¯"></a>ç™»å½•iscsiæœåŠ¡ç«¯</h5><ul><li>ä½¿ç”¨iscsiadmå‘½ä»¤</li><li>-m node å°†å®¢æˆ·ç«¯æ‰€åœ¨ä¸»æœºä½œä¸ºä¸€å°èŠ‚ç‚¹æœåŠ¡å™¨</li><li>-T iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22 æŒ‡å®šè¦ä½¿ç”¨çš„èµ„æº</li><li>â€“login æˆ–-l è¿›è¡Œç™»å½•éªŒè¯</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">iscsiadm -m node -T iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22 -p 10.0.0.10 --login</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">successful</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_d32627fc0d656f836035e9f6bf231244.png"></p><p>ç™»å½•æˆåŠŸåï¼Œä¼šåœ¨å®¢æˆ·ç«¯å¤šå‡ºä¸€å—å­˜å‚¨è®¾å¤‡/dev/sdb(è®¾å¤‡åå¯èƒ½ä¸åŒ)ï¼Œç°åœ¨å°±å¯ä»¥å¯¹æ–°è®¾å¤‡è¿›è¡Œåˆ†åŒºï¼ŒæŒ‚è½½ä½¿ç”¨äº†ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/4/image_e85da5af0ba2ea08659ee7ab4b410654.png"></p><h3 id="å››ã€å¸è½½å­˜å‚¨è®¾å¤‡"><a href="#å››ã€å¸è½½å­˜å‚¨è®¾å¤‡" class="headerlink" title="å››ã€å¸è½½å­˜å‚¨è®¾å¤‡"></a>å››ã€å¸è½½å­˜å‚¨è®¾å¤‡</h3><p>ä½¿ç”¨iscsiadm -u å°†è®¾å¤‡å¸è½½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iscsiadm -m node -T iqn.2003-01.org.linux-iscsi.zxw1.x8664:sn.a27ff8aabb22 -p 10.0.0.10 -u</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="äº”ã€æ‰©å±•"><a href="#äº”ã€æ‰©å±•" class="headerlink" title="äº”ã€æ‰©å±•"></a>äº”ã€æ‰©å±•</h3><p>åˆ›å»ºchapè®¤è¯ ç­‰å¾…ä¸‹æ¬¡æ–‡æ¡£æ›´æ–°æ—¶é—´</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gpué©±åŠ¨æŒä¹…åŒ–åŠnvlinkæ£€æŸ¥</title>
      <link href="/2025/04/07/gpu%E9%A9%B1%E5%8A%A8%E6%8C%81%E4%B9%85%E5%8C%96%E5%8F%8Anvlink%E6%A3%80%E6%9F%A5/"/>
      <url>/2025/04/07/gpu%E9%A9%B1%E5%8A%A8%E6%8C%81%E4%B9%85%E5%8C%96%E5%8F%8Anvlink%E6%A3%80%E6%9F%A5/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="gpué©±åŠ¨æŒä¹…åŒ–åŠnvlinkæ£€æŸ¥"><a href="#gpué©±åŠ¨æŒä¹…åŒ–åŠnvlinkæ£€æŸ¥" class="headerlink" title="gpué©±åŠ¨æŒä¹…åŒ–åŠnvlinkæ£€æŸ¥"></a>gpué©±åŠ¨æŒä¹…åŒ–åŠnvlinkæ£€æŸ¥</h2><blockquote><p>GPUå†…å­˜å¸¸é©»<br>ä½¿ç”¨rootç”¨æˆ·æˆ–sudoæƒé™è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥è®¾ç½®GPUé©±åŠ¨çš„å†…å­˜å¸¸é©»æ¨¡å¼ï¼šnvidia-smi -pm 1<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¯ç”¨GPUé©±åŠ¨çš„å†…å­˜å¸¸é©»æ¨¡å¼ä¼šæŒç»­å ç”¨ç³»ç»Ÿèµ„æºï¼Œå¹¶å¢åŠ èƒ½è€—ã€‚å› æ­¤ï¼Œåœ¨ä½¿ç”¨å®Œæ¯•åï¼Œå¦‚æœä¸å†éœ€è¦å¸¸é©»æ¨¡å¼ï¼Œå»ºè®®å°†å…¶ç¦ç”¨ï¼Œä»¥èŠ‚çœèµ„æºå’Œèƒ½æºã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†GPUé©±åŠ¨ç¨‹åºè®¾ç½®ä¸ºéå¸¸é©»æ¨¡å¼ï¼šnvidia-smi -pm 0</p></blockquote><p>è½¬è½½ï¼š</p><p><a href="https://blog.csdn.net/weixin_54757969/article/details/131960450">https://blog.csdn.net/weixin_54757969/article/details/131960450</a></p><h3 id="æ“ä½œç³»ç»ŸåŠNVlinkæ¡¥æ¥åŠgpué©±åŠ¨æŒä¹…åŒ–"><a href="#æ“ä½œç³»ç»ŸåŠNVlinkæ¡¥æ¥åŠgpué©±åŠ¨æŒä¹…åŒ–" class="headerlink" title="æ“ä½œç³»ç»ŸåŠNVlinkæ¡¥æ¥åŠgpué©±åŠ¨æŒä¹…åŒ–"></a>æ“ä½œç³»ç»ŸåŠNVlinkæ¡¥æ¥åŠgpué©±åŠ¨æŒä¹…åŒ–</h3><p>æˆ‘æœ€ç†Ÿæ‚‰çš„linuxæ“ä½œç³»ç»Ÿæ˜¯Ubuntuï¼Œèµ·åˆæƒ³è£…23.04ï¼Œå®ƒçš„å†…æ ¸æ˜¯6.2ã€‚æœ€ç»ˆé€‰æ‹©äº†è£…Ubuntu22.04ï¼Œè€ƒè™‘å°±æ˜¯è¿™ä¸ªç‰ˆæœ¬æ”¯æŒè¾ƒå¥½ã€‚åŸºæœ¬ä¸Šæ‰€æœ‰çš„æ”¯æŒlinuxè½¯ä»¶ï¼Œéƒ½æœ‰Ubuntu22.04çš„å®‰è£…æ–¹æ³•ã€‚æˆ‘æ²¡è£…serverç‰ˆï¼Œç›´æ¥ä¸Šäº†æ¡Œé¢ç‰ˆæœ¬ï¼Œæ˜¾å¡é©±åŠ¨ç‰ˆæœ¬530.41.03ã€‚ï¼ˆæ³¨ï¼šåæ¥æˆ‘ä¸ºäº†å®‰è£…cuda11.7.1åŠcudnn8.6ï¼ŒæŠŠé©±åŠ¨é™è‡³515.65.01,2023.7.26ï¼‰</p><p>ç„¶åæ˜¯è®©NVlinkå·¥ä½œï¼Œéœ€è¦å¼€å¯é©±åŠ¨æŒä¹…åŒ–æ¨¡å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi -pm 1</span><br><span class="line">sudo reboot</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ£€æŸ¥æ–¹æ³•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi topo -m</span><br><span class="line"></span><br><span class="line">GPU0GPU1CPU AffinityNUMA Affinity</span><br><span class="line">GPU0 X NV40-23N/A</span><br><span class="line">GPU1NV4 X 0-23N/A</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸€ä¸ªäº‹é¡¹è¦è¯´æ˜ï¼ŒNVlinkæ’å¥½æ—¶ï¼Œä¼šå‘ç°å’”å“’ä¸€å£°ã€‚èµ·åˆæˆ‘æ’å®Œåï¼ŒæŒä¹…åŒ–é‡å¯ï¼Œç”¨æ£€æŸ¥å‘½ä»¤æŸ¥ä¸åˆ°nvlinkå·¥ä½œã€‚åæ¥æ–­ç”µå…³æœºï¼Œé‡æ–°æ’äº†ä¸€æ¬¡NVlinkï¼Œå¬åˆ°å’”å“’ä¸€å£°ã€‚ç„¶åå†å¼€æœºï¼Œä¸€åˆ‡æ­£å¸¸äº†ã€‚æµ‹è¯•ä¸€ä¸‹æ¡¥æ¥é€Ÿåº¦ï¼Œä¸çŸ¥é“ä¸ºä½•14GBï¼Œå¿«å—ï¼Ÿ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">allonx@x299:~/qmx_projects/langchain-ChatGLM$ nvidia-smi nvlink -s</span><br><span class="line">GPU 0: NVIDIA GeForce RTX 3090 (UUID: GPU-9cca89b5-8627-6cff-7cb4-d8fae8dfadbe)</span><br><span class="line"> Link 0: 14.062 GB/s</span><br><span class="line"> Link 1: 14.062 GB/s</span><br><span class="line"> Link 2: 14.062 GB/s</span><br><span class="line"> Link 3: 14.062 GB/s</span><br><span class="line">GPU 1: NVIDIA GeForce RTX 3090 (UUID: GPU-f3fc3749-f793-189f-b592-5af6bb39a569)</span><br><span class="line"> Link 0: 14.062 GB/s</span><br><span class="line"> Link 1: 14.062 GB/s</span><br><span class="line"> Link 2: 14.062 GB/s</span><br><span class="line"> Link 3: 14.062 GB/s</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å†æŸ¥ä¸€ä¸‹è¯¦ç»†æƒ…å†µï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">allonx@x299:~/qmx_projects/langchain-ChatGLM$ nvidia-smi nvlink -c</span><br><span class="line">GPU 0: NVIDIA GeForce RTX 3090 (UUID: GPU-9cca89b5-8627-6cff-7cb4-d8fae8dfadbe)</span><br><span class="line"> Link 0, P2P is supported: <span class="literal">true</span></span><br><span class="line"> Link 0, Access to system memory supported: <span class="literal">true</span></span><br><span class="line"> Link 0, P2P atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 0, System memory atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 0, SLI is supported: <span class="literal">true</span></span><br><span class="line"> Link 0, Link is supported: <span class="literal">false</span></span><br><span class="line"> Link 1, P2P is supported: <span class="literal">true</span></span><br><span class="line"> Link 1, Access to system memory supported: <span class="literal">true</span></span><br><span class="line"> Link 1, P2P atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 1, System memory atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 1, SLI is supported: <span class="literal">true</span></span><br><span class="line"> Link 1, Link is supported: <span class="literal">false</span></span><br><span class="line"> Link 2, P2P is supported: <span class="literal">true</span></span><br><span class="line"> Link 2, Access to system memory supported: <span class="literal">true</span></span><br><span class="line"> Link 2, P2P atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 2, System memory atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 2, SLI is supported: <span class="literal">true</span></span><br><span class="line"> Link 2, Link is supported: <span class="literal">false</span></span><br><span class="line"> Link 3, P2P is supported: <span class="literal">true</span></span><br><span class="line"> Link 3, Access to system memory supported: <span class="literal">true</span></span><br><span class="line"> Link 3, P2P atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 3, System memory atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 3, SLI is supported: <span class="literal">true</span></span><br><span class="line"> Link 3, Link is supported: <span class="literal">false</span></span><br><span class="line">GPU 1: NVIDIA GeForce RTX 3090 (UUID: GPU-f3fc3749-f793-189f-b592-5af6bb39a569)</span><br><span class="line"> Link 0, P2P is supported: <span class="literal">true</span></span><br><span class="line"> Link 0, Access to system memory supported: <span class="literal">true</span></span><br><span class="line"> Link 0, P2P atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 0, System memory atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 0, SLI is supported: <span class="literal">true</span></span><br><span class="line"> Link 0, Link is supported: <span class="literal">false</span></span><br><span class="line"> Link 1, P2P is supported: <span class="literal">true</span></span><br><span class="line"> Link 1, Access to system memory supported: <span class="literal">true</span></span><br><span class="line"> Link 1, P2P atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 1, System memory atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 1, SLI is supported: <span class="literal">true</span></span><br><span class="line"> Link 1, Link is supported: <span class="literal">false</span></span><br><span class="line"> Link 2, P2P is supported: <span class="literal">true</span></span><br><span class="line"> Link 2, Access to system memory supported: <span class="literal">true</span></span><br><span class="line"> Link 2, P2P atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 2, System memory atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 2, SLI is supported: <span class="literal">true</span></span><br><span class="line"> Link 2, Link is supported: <span class="literal">false</span></span><br><span class="line"> Link 3, P2P is supported: <span class="literal">true</span></span><br><span class="line"> Link 3, Access to system memory supported: <span class="literal">true</span></span><br><span class="line"> Link 3, P2P atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 3, System memory atomics supported: <span class="literal">true</span></span><br><span class="line"> Link 3, SLI is supported: <span class="literal">true</span></span><br><span class="line"> Link 3, Link is supported: <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å…¶ä¸­æœ‰æç¤ºâ€œLink is supported: falseâ€ï¼Œä¸æ˜å°±é‡Œï¼Œä¸Šç½‘æŸ¥äº†ä¸€ä¸‹ï¼Œæœ‰ä¸€ä¸ªäººä¸æˆ‘ä¸€æ ·çš„æƒ…å†µï¼Œå›å¤è¯´æ˜¯æ­£å¸¸ã€‚</p><p>æ€»ä½“æ¥è¯´ï¼Œè¿™ä¸ªä¸»æœºæ–¹æ¡ˆæ¥è¿‘å®Œç¾ï¼Œä¸ºäº†çœé’±ï¼Œæˆ‘æ²¡é€‰æ‹©æ°´å†·ï¼Œé‡‡ç”¨äº†ç»æµå®æƒ çš„é£å†·æ–¹æ¡ˆã€‚</p><p>è£…æœºä¹‹åï¼Œæˆ‘å…ˆè£…äº†ä¸€ä¸ªwindowsç³»ç»Ÿæµ‹è¯•ã€‚å¯èƒ½æ˜¯è¿™å—ä¸»æ¿æœ‰äº›å¤è€ï¼ˆ2017å¹´ç”Ÿäº§ï¼‰ï¼Œè¯•äº†å‡ æ¬¡æˆ‘éƒ½æ²¡æ³•æˆåŠŸå®‰è£…win11ï¼Œåªèƒ½å®‰è£…win10ã€‚ç”¨cup-zã€gpu-zã€é²å¤§å¸ˆã€3dmarkéƒ½è¿›è¡Œäº†æµ‹è¯•ã€‚ä¹Ÿè®¸æ˜¯åç¡•tuf 3090éƒ½è¿™æ ·ï¼Œ3dmarkç¨³å®šåº¦æµ‹è¯•æœ€é«˜éƒ½åªè¾¾åˆ°97%-98%ä¹‹é—´ï¼Œç®—æ˜¯å‹‰å¼ºé€šè¿‡äº†æµ‹è¯•ã€‚</p><p>å¦æœ‰ä¸€ä¸ªå°å°çš„ç¼ºæ†¾ï¼Œå°±æ˜¯è¿™å°å·¥ä½œç«™çš„ä¸»æœºä¸Šé¢ç¼ºå°‘äº†æ¡£æ¿ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯é•¿æœŸè¿è¡Œä¸»æœºä¼šè¿›å…¥å¤§é‡ç°å°˜ã€‚è€Œä¸”x299 gaming7çš„æ¡£æ¿å¾ˆéš¾é…ï¼Œå¶å°”æœ‰å–çš„ï¼Œä¸€å—æ¡£æ¿ç«Ÿè¦ä»·è¿‘300å…ƒã€‚å®åœ¨æ²¡å¿…è¦ã€‚</p><h3 id="å‚è€ƒèµ„æ–™ï¼š"><a href="#å‚è€ƒèµ„æ–™ï¼š" class="headerlink" title="å‚è€ƒèµ„æ–™ï¼š"></a>å‚è€ƒèµ„æ–™ï¼š</h3><ul><li><a href="https://zhuanlan.zhihu.com/p/339893484">https://zhuanlan.zhihu.com/p/339893484</a></li><li><a href="https://www.pugetsystems.com/labs/articles/NVIDIA-NVLink-2021-Update-and-Compatibility-Chart-2074/">https://www.pugetsystems.com/labs/articles/NVIDIA-NVLink-2021-Update-and-Compatibility-Chart-2074/</a></li><li><a href="https://forums.developer.nvidia.com/t/two-dual-geforce-rtx-3090s-and-nvlink-ubuntu-support-at-least-blender-has-support-for-nvlink/160561">https://forums.developer.nvidia.com/t/two-dual-geforce-rtx-3090s-and-nvlink-ubuntu-support-at-least-blender-has-support-for-nvlink/160561</a></li><li><a href="https://forums.developer.nvidia.com/t/two-rtx-a6000-nvlink-link-is-supported-false/177285">https://forums.developer.nvidia.com/t/two-rtx-a6000-nvlink-link-is-supported-false/177285</a></li></ul><p>gpu p2pé€šä¿¡ç§‘æ™®</p><blockquote><p>åœ¨å¤šGPUæœåŠ¡å™¨æˆ–å·¥ä½œç«™ä¸­ï¼Œ<strong>P2Pï¼ˆPeer-to-Peerï¼‰é€šä¿¡</strong>æ˜¯æŒ‡<strong>GPUå¡ä¹‹é—´ç›´æ¥è¿›è¡Œæ•°æ®ä¼ è¾“</strong>ï¼Œç»•è¿‡ä¸»æœºCPUå’Œå†…å­˜ï¼Œè¾¾åˆ°æ›´é«˜çš„å¸¦å®½å’Œæ›´ä½çš„å»¶è¿Ÿã€‚</p><h3 id="GPUé—´P2Pï¼ˆPeer-to-Peerï¼‰å«ä¹‰"><a href="#GPUé—´P2Pï¼ˆPeer-to-Peerï¼‰å«ä¹‰" class="headerlink" title="GPUé—´P2Pï¼ˆPeer-to-Peerï¼‰å«ä¹‰"></a>GPUé—´P2Pï¼ˆPeer-to-Peerï¼‰å«ä¹‰</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œå¤šå¼ GPUå¡éœ€è¦å…±äº«æ•°æ®ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªæ·±åº¦å­¦ä¹ æ¨¡å‹çš„ä¸åŒå±‚åˆ†å¸ƒåœ¨ä¸åŒGPUä¸Šï¼Œéœ€è¦é¢‘ç¹äº¤æ¢ä¸­é—´ç»“æœã€‚è¿™ç§æ—¶å€™ï¼ŒP2Pé€šä¿¡å°±å¾ˆå…³é”®ã€‚</p><hr><h3 id="P2Pçš„ä¸¤ç§æ¨¡å¼"><a href="#P2Pçš„ä¸¤ç§æ¨¡å¼" class="headerlink" title="P2Pçš„ä¸¤ç§æ¨¡å¼"></a>P2Pçš„ä¸¤ç§æ¨¡å¼</h3><ol><li><strong>P2P Memory Accessï¼ˆå†…å­˜è®¿é—®ï¼‰</strong><ul><li>ä¸€å¼ GPUå¯ä»¥ç›´æ¥è¯»å†™å¦ä¸€å¼ GPUçš„å†…å­˜ï¼ˆglobal memoryï¼‰ã€‚</li></ul></li><li><strong>P2P Memory Copyï¼ˆå†…å­˜æ‹·è´ï¼‰</strong><ul><li>åœ¨ç¼–ç¨‹ä¸­ä½¿ç”¨ <code>cudaMemcpyPeer()</code> æˆ– <code>cudaMemcpyPeerAsync()</code> å®ç°GPUä¹‹é—´çš„å†…å­˜æ‹·è´ã€‚</li></ul></li></ol><hr><h3 id="æ˜¯å¦æ”¯æŒP2Pé€šä¿¡å–å†³äºç¡¬ä»¶æ¶æ„"><a href="#æ˜¯å¦æ”¯æŒP2Pé€šä¿¡å–å†³äºç¡¬ä»¶æ¶æ„" class="headerlink" title="æ˜¯å¦æ”¯æŒP2Pé€šä¿¡å–å†³äºç¡¬ä»¶æ¶æ„"></a>æ˜¯å¦æ”¯æŒP2Pé€šä¿¡å–å†³äºç¡¬ä»¶æ¶æ„</h3><ul><li><strong>GPUä¹‹é—´çš„ç‰©ç†è¿æ¥æ–¹å¼</strong>ï¼š<ul><li>æ”¯æŒP2Pçš„å‰ææ˜¯ä¸¤å¼ GPUä¹‹é—´é€šè¿‡ <strong>NVLink</strong>ã€<strong>PCIeåŒä¸€Switch</strong>ã€æˆ– <strong>åŒä¸€ä¸ªPCIe Root Complex</strong>ã€‚</li></ul></li><li>ä¾‹å¦‚ï¼š<ul><li><strong>NVIDIA A100ã€V100ã€P100</strong> æ”¯æŒ NVLink çš„ç›´æ¥äº’è”ï¼ŒP2Pæ•ˆç‡é«˜ã€‚</li><li>å¦‚æœGPUä¹‹é—´è·¨Socketï¼ˆNUMAæ¶æ„ï¼‰ï¼ŒP2Pæ€§èƒ½ä¼šå˜å·®ç”šè‡³ä¸å¯ç”¨ã€‚</li></ul></li></ul><hr><h3 id="å¦‚ä½•æ£€æµ‹GPUä¹‹é—´æ˜¯å¦æ”¯æŒP2Pï¼Ÿ"><a href="#å¦‚ä½•æ£€æµ‹GPUä¹‹é—´æ˜¯å¦æ”¯æŒP2Pï¼Ÿ" class="headerlink" title="å¦‚ä½•æ£€æµ‹GPUä¹‹é—´æ˜¯å¦æ”¯æŒP2Pï¼Ÿ"></a>å¦‚ä½•æ£€æµ‹GPUä¹‹é—´æ˜¯å¦æ”¯æŒP2Pï¼Ÿ</h3><p>å¯ä»¥ä½¿ç”¨å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi topo -m</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">        GPU0    GPU1    CPU Affinity</span><br><span class="line">GPU0     X      NV2     0-15</span><br><span class="line">GPU1    NV2      X      0-15</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>NV2</code> è¡¨ç¤ºé€šè¿‡ <strong>NVLink 2.0</strong> è¿æ¥ï¼Œæ”¯æŒé«˜é€ŸP2Pï¼›è‹¥æ˜¾ç¤º <code>PHB</code>ï¼Œè¡¨ç¤ºæ˜¯é€šè¿‡ PCIe Host Bridgeï¼Œä¸ä¸€å®šæ”¯æŒé«˜æ•ˆçš„P2Pã€‚</p><hr><h3 id="P2Pçš„ä¼˜åŠ¿"><a href="#P2Pçš„ä¼˜åŠ¿" class="headerlink" title="P2Pçš„ä¼˜åŠ¿"></a>P2Pçš„ä¼˜åŠ¿</h3><ul><li>é¿å…æ•°æ®å…ˆæ‹·è´åˆ°CPUå†…å­˜å†æ‹·è´åˆ°å¦ä¸€GPU</li><li>æ˜¾è‘—æå‡å¤šå¡è®­ç»ƒã€å¤šå¡è®¡ç®—çš„æ€§èƒ½</li><li>é™ä½ç³»ç»Ÿæ€»çº¿è´Ÿè½½ï¼Œå‡å°‘å»¶è¿Ÿ</li></ul><hr><h3 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h3><ul><li>åˆ†å¸ƒå¼æ·±åº¦å­¦ä¹ ï¼ˆå¦‚TensorFlowã€PyTorchå¤šGPUè®­ç»ƒï¼‰</li><li>ç§‘å­¦è®¡ç®—ä¸­GPUé—´æ•°æ®äº¤äº’</li><li>GPUç›´æ¥DMAä¼ è¾“</li></ul><hr><p>å¦‚ä½ ä½¿ç”¨NVIDIA GPUï¼Œå¹¶ä½¿ç”¨CUDAç¼–ç¨‹ï¼Œå¯é€šè¿‡å¦‚ä¸‹å‡½æ•°å¼€å¯P2Pï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cudaSetDevice</span>(<span class="number">0</span>);</span><br><span class="line"><span class="built_in">cudaDeviceEnablePeerAccess</span>(<span class="number">1</span>, <span class="number">0</span>);</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºï¼šGPU0 å…è®¸è®¿é—® GPU1ã€‚</p><hr><p>å¦‚æœä½ æƒ³æˆ‘å¸®ä½ åˆ¤æ–­ä½ æœºå™¨çš„GPUæ˜¯å¦æ”¯æŒP2Pï¼Œå¯ä»¥å‘æˆ‘ <code>nvidia-smi topo -m</code> çš„è¾“å‡ºï¼Œæˆ‘æ¥åˆ†æã€‚</p></blockquote><p><strong>æ‰©å±•æŸ¥çœ‹gpu p2pé€šä¿¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line">root@A100:~<span class="comment"># nvidia-smi topo -m</span></span><br><span class="line">        GPU0    GPU1    GPU2    GPU3    GPU4    GPU5    GPU6    GPU7    NIC0    NIC1    NIC2    NIC3    NIC4    NIC5    CPU Affinity     NUMA Affinity   GPU NUMA ID</span><br><span class="line">GPU0     X      NV12    NV12    NV12    NV12    NV12    NV12    NV12    PXB     NODE    NODE    SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU1    NV12     X      NV12    NV12    NV12    NV12    NV12    NV12    PXB     NODE    NODE    SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU2    NV12    NV12     X      NV12    NV12    NV12    NV12    NV12    NODE    PXB     PXB     SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU3    NV12    NV12    NV12     X      NV12    NV12    NV12    NV12    NODE    PXB     PXB     SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU4    NV12    NV12    NV12    NV12     X      NV12    NV12    NV12    SYS     SYS     SYS     PXB     NODE    NODE    32-63,96-127     1               N/A</span><br><span class="line">GPU5    NV12    NV12    NV12    NV12    NV12     X      NV12    NV12    SYS     SYS     SYS     PXB     NODE    NODE    32-63,96-127     1               N/A</span><br><span class="line">GPU6    NV12    NV12    NV12    NV12    NV12    NV12     X      NV12    SYS     SYS     SYS     NODE    PXB     PXB     32-63,96-127     1               N/A</span><br><span class="line">GPU7    NV12    NV12    NV12    NV12    NV12    NV12    NV12     X      SYS     SYS     SYS     NODE    PXB     PXB     32-63,96-127     1               N/A</span><br><span class="line">NIC0    PXB     PXB     NODE    NODE    SYS     SYS     SYS     SYS      X      NODE    NODE    SYS     SYS     SYS</span><br><span class="line">NIC1    NODE    NODE    PXB     PXB     SYS     SYS     SYS     SYS     NODE     X      PIX     SYS     SYS     SYS</span><br><span class="line">NIC2    NODE    NODE    PXB     PXB     SYS     SYS     SYS     SYS     NODE    PIX      X      SYS     SYS     SYS</span><br><span class="line">NIC3    SYS     SYS     SYS     SYS     PXB     PXB     NODE    NODE    SYS     SYS     SYS      X      NODE    NODE</span><br><span class="line">NIC4    SYS     SYS     SYS     SYS     NODE    NODE    PXB     PXB     SYS     SYS     SYS     NODE     X      PIX</span><br><span class="line">NIC5    SYS     SYS     SYS     SYS     NODE    NODE    PXB     PXB     SYS     SYS     SYS     NODE    PIX      X </span><br><span class="line"></span><br><span class="line">Legend:</span><br><span class="line"></span><br><span class="line">  X    = Self</span><br><span class="line">  SYS  = Connection traversing PCIe as well as the SMP interconnect between NUMA nodes (e.g., QPI/UPI)</span><br><span class="line">  NODE = Connection traversing PCIe as well as the interconnect between PCIe Host Bridges within a NUMA node</span><br><span class="line">  PHB  = Connection traversing PCIe as well as a PCIe Host Bridge (typically the CPU)</span><br><span class="line">  PXB  = Connection traversing multiple PCIe bridges (without traversing the PCIe Host Bridge)</span><br><span class="line">  PIX  = Connection traversing at most a single PCIe bridge</span><br><span class="line">  NV<span class="comment">#  = Connection traversing a bonded set of # NVLinks</span></span><br><span class="line"></span><br><span class="line">NIC Legend:</span><br><span class="line"></span><br><span class="line">  NIC0: mlx5_0</span><br><span class="line">  NIC1: mlx5_1</span><br><span class="line">  NIC2: mlx5_2</span><br><span class="line">  NIC3: mlx5_3</span><br><span class="line">  NIC4: mlx5_4</span><br><span class="line">  NIC5: mlx5_5root@A100:~<span class="comment"># nvidia-smi topo -m</span></span><br><span class="line">        GPU0    GPU1    GPU2    GPU3    GPU4    GPU5    GPU6    GPU7    NIC0    NIC1    NIC2    NIC3    NIC4    NIC5    CPU Affinity     NUMA Affinity   GPU NUMA ID</span><br><span class="line">GPU0     X      NV12    NV12    NV12    NV12    NV12    NV12    NV12    PXB     NODE    NODE    SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU1    NV12     X      NV12    NV12    NV12    NV12    NV12    NV12    PXB     NODE    NODE    SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU2    NV12    NV12     X      NV12    NV12    NV12    NV12    NV12    NODE    PXB     PXB     SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU3    NV12    NV12    NV12     X      NV12    NV12    NV12    NV12    NODE    PXB     PXB     SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU4    NV12    NV12    NV12    NV12     X      NV12    NV12    NV12    SYS     SYS     SYS     PXB     NODE    NODE    32-63,96-127     1               N/A</span><br><span class="line">GPU5    NV12    NV12    NV12    NV12    NV12     X      NV12    NV12    SYS     SYS     SYS     PXB     NODE    NODE    32-63,96-127     1               N/A</span><br><span class="line">GPU6    NV12    NV12    NV12    NV12    NV12    NV12     X      NV12    SYS     SYS     SYS     NODE    PXB     PXB     32-63,96-127     1               N/A</span><br><span class="line">GPU7    NV12    NV12    NV12    NV12    NV12    NV12    NV12     X      SYS     SYS     SYS     NODE    PXB     PXB     32-63,96-127     1               N/A</span><br><span class="line">NIC0    PXB     PXB     NODE    NODE    SYS     SYS     SYS     SYS      X      NODE    NODE    SYS     SYS     SYS</span><br><span class="line">NIC1    NODE    NODE    PXB     PXB     SYS     SYS     SYS     SYS     NODE     X      PIX     SYS     SYS     SYS</span><br><span class="line">NIC2    NODE    NODE    PXB     PXB     SYS     SYS     SYS     SYS     NODE    PIX      X      SYS     SYS     SYS</span><br><span class="line">NIC3    SYS     SYS     SYS     SYS     PXB     PXB     NODE    NODE    SYS     SYS     SYS      X      NODE    NODE</span><br><span class="line">NIC4    SYS     SYS     SYS     SYS     NODE    NODE    PXB     PXB     SYS     SYS     SYS     NODE     X      PIX</span><br><span class="line">NIC5    SYS     SYS     SYS     SYS     NODE    NODE    PXB     PXB     SYS     SYS     SYS     NODE    PIX      X </span><br><span class="line"></span><br><span class="line">Legend:</span><br><span class="line"></span><br><span class="line">  X    = Self</span><br><span class="line">  SYS  = Connection traversing PCIe as well as the SMP interconnect between NUMA nodes (e.g., QPI/UPI)</span><br><span class="line">  NODE = Connection traversing PCIe as well as the interconnect between PCIe Host Bridges within a NUMA node</span><br><span class="line">  PHB  = Connection traversing PCIe as well as a PCIe Host Bridge (typically the CPU)</span><br><span class="line">  PXB  = Connection traversing multiple PCIe bridges (without traversing the PCIe Host Bridge)</span><br><span class="line">  PIX  = Connection traversing at most a single PCIe bridge</span><br><span class="line">  NV<span class="comment">#  = Connection traversing a bonded set of # NVLinks</span></span><br><span class="line"></span><br><span class="line">NIC Legend:</span><br><span class="line"></span><br><span class="line">  NIC0: mlx5_0</span><br><span class="line">  NIC1: mlx5_1</span><br><span class="line">  NIC2: mlx5_2</span><br><span class="line">  NIC3: mlx5_3</span><br><span class="line">  NIC4: mlx5_4</span><br><span class="line">  NIC5: mlx5_5root@A100:~<span class="comment"># nvidia-smi topo -m</span></span><br><span class="line">        GPU0    GPU1    GPU2    GPU3    GPU4    GPU5    GPU6    GPU7    NIC0    NIC1    NIC2    NIC3    NIC4    NIC5    CPU Affinity     NUMA Affinity   GPU NUMA ID</span><br><span class="line">GPU0     X      NV12    NV12    NV12    NV12    NV12    NV12    NV12    PXB     NODE    NODE    SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU1    NV12     X      NV12    NV12    NV12    NV12    NV12    NV12    PXB     NODE    NODE    SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU2    NV12    NV12     X      NV12    NV12    NV12    NV12    NV12    NODE    PXB     PXB     SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU3    NV12    NV12    NV12     X      NV12    NV12    NV12    NV12    NODE    PXB     PXB     SYS     SYS     SYS     0-31,64-95       0               N/A</span><br><span class="line">GPU4    NV12    NV12    NV12    NV12     X      NV12    NV12    NV12    SYS     SYS     SYS     PXB     NODE    NODE    32-63,96-127     1               N/A</span><br><span class="line">GPU5    NV12    NV12    NV12    NV12    NV12     X      NV12    NV12    SYS     SYS     SYS     PXB     NODE    NODE    32-63,96-127     1               N/A</span><br><span class="line">GPU6    NV12    NV12    NV12    NV12    NV12    NV12     X      NV12    SYS     SYS     SYS     NODE    PXB     PXB     32-63,96-127     1               N/A</span><br><span class="line">GPU7    NV12    NV12    NV12    NV12    NV12    NV12    NV12     X      SYS     SYS     SYS     NODE    PXB     PXB     32-63,96-127     1               N/A</span><br><span class="line">NIC0    PXB     PXB     NODE    NODE    SYS     SYS     SYS     SYS      X      NODE    NODE    SYS     SYS     SYS</span><br><span class="line">NIC1    NODE    NODE    PXB     PXB     SYS     SYS     SYS     SYS     NODE     X      PIX     SYS     SYS     SYS</span><br><span class="line">NIC2    NODE    NODE    PXB     PXB     SYS     SYS     SYS     SYS     NODE    PIX      X      SYS     SYS     SYS</span><br><span class="line">NIC3    SYS     SYS     SYS     SYS     PXB     PXB     NODE    NODE    SYS     SYS     SYS      X      NODE    NODE</span><br><span class="line">NIC4    SYS     SYS     SYS     SYS     NODE    NODE    PXB     PXB     SYS     SYS     SYS     NODE     X      PIX</span><br><span class="line">NIC5    SYS     SYS     SYS     SYS     NODE    NODE    PXB     PXB     SYS     SYS     SYS     NODE    PIX      X </span><br><span class="line"></span><br><span class="line">Legend:</span><br><span class="line"></span><br><span class="line">  X    = Self</span><br><span class="line">  SYS  = Connection traversing PCIe as well as the SMP interconnect between NUMA nodes (e.g., QPI/UPI)</span><br><span class="line">  NODE = Connection traversing PCIe as well as the interconnect between PCIe Host Bridges within a NUMA node</span><br><span class="line">  PHB  = Connection traversing PCIe as well as a PCIe Host Bridge (typically the CPU)</span><br><span class="line">  PXB  = Connection traversing multiple PCIe bridges (without traversing the PCIe Host Bridge)</span><br><span class="line">  PIX  = Connection traversing at most a single PCIe bridge</span><br><span class="line">  NV<span class="comment">#  = Connection traversing a bonded set of # NVLinks</span></span><br><span class="line"></span><br><span class="line">NIC Legend:</span><br><span class="line"></span><br><span class="line">  NIC0: mlx5_0</span><br><span class="line">  NIC1: mlx5_1</span><br><span class="line">  NIC2: mlx5_2</span><br><span class="line">  NIC3: mlx5_3</span><br><span class="line">  NIC4: mlx5_4</span><br><span class="line">  NIC5: mlx5_5</span><br></pre></td></tr></table></figure><p><strong>ä¸Šæ–¹ å‚æ•° è§£é‡Šï¼š</strong></p><blockquote><p>ä»ä½ æä¾›çš„ <code>nvidia-smi topo -m</code> è¾“å‡ºçœ‹ï¼Œä½ çš„ç³»ç»Ÿæœ‰ 8 å¼  GPU å¡ï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡ <strong>NV12</strong> äº’è”ï¼Œè¿™è¯´æ˜ <strong>æ¯å¯¹ GPU é—´éƒ½æœ‰ 12 æ¡ NVLink ç›´è¿é€šé“</strong>ï¼Œå±äºç›®å‰éå¸¸é«˜è§„æ ¼çš„è¿æ¥æ–¹å¼ã€‚</p><hr><h3 id="âœ…-ä½ çš„ç³»ç»Ÿæ”¯æŒæä½³çš„-GPU-é—´-P2P-é€šä¿¡"><a href="#âœ…-ä½ çš„ç³»ç»Ÿæ”¯æŒæä½³çš„-GPU-é—´-P2P-é€šä¿¡" class="headerlink" title="âœ… ä½ çš„ç³»ç»Ÿæ”¯æŒæä½³çš„ GPU é—´ P2P é€šä¿¡"></a>âœ… ä½ çš„ç³»ç»Ÿæ”¯æŒæä½³çš„ GPU é—´ P2P é€šä¿¡</h3><p><strong>è§£é‡Šå¦‚ä¸‹ï¼š</strong></p><ul><li><code>NV12</code> è¡¨ç¤ºä¸¤å¼ GPUä¹‹é—´é€šè¿‡ <strong>12æ¡ NVLink é€šé“</strong>äº’è¿ï¼Œå±äº NVIDIA NVSwitch æ¶æ„çš„ä¸€éƒ¨åˆ†ã€‚</li><li>NVLink æ˜¯ NVIDIA ä¸“ä¸º GPU é«˜é€Ÿäº’è”è®¾è®¡çš„æŠ€æœ¯ï¼Œè¿œé«˜äºä¼ ç»Ÿ PCIe å¸¦å®½å’Œå»¶è¿Ÿã€‚</li><li>ä½ çš„è¾“å‡ºä¸­ GPU0~GPU7 ä¹‹é—´å…¨éƒ¨ä¸º <code>NV12</code>ï¼Œè¯´æ˜è¿™äº› GPU æ„æˆä¸€ä¸ª <strong>NVLink å…¨äº’è¿æ‹“æ‰‘ï¼ˆfull meshï¼‰</strong>ï¼Œ<strong>P2P é€šä¿¡æ€§èƒ½æé«˜</strong>ã€‚</li><li>è¿™æ˜¯å…¸å‹çš„ <strong>HGX A100 æœåŠ¡å™¨</strong>ç»“æ„ï¼Œé€šå¸¸ç”¨äº AI è®­ç»ƒã€HPC è¶…ç®—ç­‰åœºæ™¯ã€‚</li></ul><hr><h3 id="NUMAä¿¡æ¯ä¹Ÿè¯´æ˜ç³»ç»Ÿä¸ºå¯¹ç§°æ¶æ„"><a href="#NUMAä¿¡æ¯ä¹Ÿè¯´æ˜ç³»ç»Ÿä¸ºå¯¹ç§°æ¶æ„" class="headerlink" title="NUMAä¿¡æ¯ä¹Ÿè¯´æ˜ç³»ç»Ÿä¸ºå¯¹ç§°æ¶æ„"></a>NUMAä¿¡æ¯ä¹Ÿè¯´æ˜ç³»ç»Ÿä¸ºå¯¹ç§°æ¶æ„</h3><ul><li>GPU0~GPU3 å±äº NUMA èŠ‚ç‚¹ 0ï¼ˆAffinity: <code>0-31,64-95</code>ï¼‰</li><li>GPU4~GPU7 å±äº NUMA èŠ‚ç‚¹ 1ï¼ˆAffinity: <code>32-63,96-127</code>ï¼‰</li></ul><p>è¿™é€šå¸¸æ„å‘³ç€åŒè·¯CPUï¼Œæ¯ä¸ªCPUæŒ‚è½½4å¼ GPUï¼Œé€šè¿‡ NVSwitch å®ç°GPUé—´çš„é«˜é€Ÿäº’é€šã€‚</p><hr><h3 id="å°ç»“"><a href="#å°ç»“" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><table><thead><tr><th>é¡¹ç›®</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>GPUé—´P2P</td><td>âœ… å…¨éƒ¨æ”¯æŒï¼ˆNV12ï¼‰</td></tr><tr><td>é€šä¿¡æ–¹å¼</td><td>NVLink 12è·¯äº’è”</td></tr><tr><td>æ¶æ„ç±»å‹</td><td>å¤šGPU NVSwitch</td></tr><tr><td>é€‚åˆåœºæ™¯</td><td>å¤§æ¨¡å‹è®­ç»ƒã€å¤šå¡æ¨ç†ã€æ·±åº¦å­¦ä¹ è®­ç»ƒç­‰</td></tr></tbody></table><hr><h3 id="âœ…-å»ºè®®"><a href="#âœ…-å»ºè®®" class="headerlink" title="âœ… å»ºè®®"></a>âœ… å»ºè®®</h3><p>ä½ å¯ä»¥åœ¨ CUDA æˆ–æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆå¦‚ PyTorchã€TensorFlowï¼‰ä¸­æ”¾å¿ƒä½¿ç”¨å¤šå¡è®­ç»ƒï¼Œä¸éœ€è¦æ‹…å¿ƒ GPU é—´çš„æ•°æ®ä¼ è¾“ç“¶é¢ˆã€‚</p><p>å¦‚éœ€éªŒè¯ç¨‹åºä¸­æ˜¯å¦ä½¿ç”¨äº† P2Pï¼Œå¯åœ¨ PyTorch ä¸­ä½¿ç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.cuda.device(<span class="number">0</span>).can_access_peer(<span class="number">1</span>)  <span class="comment"># True</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è¦è¿›ä¸€æ­¥ä¼˜åŒ–å¤šGPUè®­ç»ƒæ€§èƒ½ï¼Œè¿˜å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NCCL_P2P_LEVEL=NVL  <span class="comment"># å¼ºåˆ¶NCCLä½¿ç”¨NVLink</span></span><br></pre></td></tr></table></figure><p>éœ€è¦å¸®åŠ©é…ç½®å¤šå¡è®­ç»ƒæˆ– NCCL å‚æ•°ä¼˜åŒ–ï¼Œä¹Ÿå¯ä»¥ç»§ç»­é—®æˆ‘ã€‚</p><p>ä»ä½ æä¾›çš„ <code>nvidia-smi topo -m</code> è¾“å‡ºçœ‹ï¼Œä½ çš„ç³»ç»Ÿæœ‰ 8 å¼  GPU å¡ï¼Œå®ƒä»¬ä¹‹é—´é€šè¿‡ <strong>NV12</strong> äº’è”ï¼Œè¿™è¯´æ˜ <strong>æ¯å¯¹ GPU é—´éƒ½æœ‰ 12 æ¡ NVLink ç›´è¿é€šé“</strong>ï¼Œå±äºç›®å‰éå¸¸é«˜è§„æ ¼çš„è¿æ¥æ–¹å¼ã€‚</p><hr><h3 id="âœ…-ä½ çš„ç³»ç»Ÿæ”¯æŒæä½³çš„-GPU-é—´-P2P-é€šä¿¡-1"><a href="#âœ…-ä½ çš„ç³»ç»Ÿæ”¯æŒæä½³çš„-GPU-é—´-P2P-é€šä¿¡-1" class="headerlink" title="âœ… ä½ çš„ç³»ç»Ÿæ”¯æŒæä½³çš„ GPU é—´ P2P é€šä¿¡"></a>âœ… ä½ çš„ç³»ç»Ÿæ”¯æŒæä½³çš„ GPU é—´ P2P é€šä¿¡</h3><p><strong>è§£é‡Šå¦‚ä¸‹ï¼š</strong></p><ul><li><code>NV12</code> è¡¨ç¤ºä¸¤å¼ GPUä¹‹é—´é€šè¿‡ <strong>12æ¡ NVLink é€šé“</strong>äº’è¿ï¼Œå±äº NVIDIA NVSwitch æ¶æ„çš„ä¸€éƒ¨åˆ†ã€‚</li><li>NVLink æ˜¯ NVIDIA ä¸“ä¸º GPU é«˜é€Ÿäº’è”è®¾è®¡çš„æŠ€æœ¯ï¼Œè¿œé«˜äºä¼ ç»Ÿ PCIe å¸¦å®½å’Œå»¶è¿Ÿã€‚</li><li>ä½ çš„è¾“å‡ºä¸­ GPU0~GPU7 ä¹‹é—´å…¨éƒ¨ä¸º <code>NV12</code>ï¼Œè¯´æ˜è¿™äº› GPU æ„æˆä¸€ä¸ª <strong>NVLink å…¨äº’è¿æ‹“æ‰‘ï¼ˆfull meshï¼‰</strong>ï¼Œ<strong>P2P é€šä¿¡æ€§èƒ½æé«˜</strong>ã€‚</li><li>è¿™æ˜¯å…¸å‹çš„ <strong>HGX A100 æœåŠ¡å™¨</strong>ç»“æ„ï¼Œé€šå¸¸ç”¨äº AI è®­ç»ƒã€HPC è¶…ç®—ç­‰åœºæ™¯ã€‚</li></ul><hr><h3 id="NUMAä¿¡æ¯ä¹Ÿè¯´æ˜ç³»ç»Ÿä¸ºå¯¹ç§°æ¶æ„-1"><a href="#NUMAä¿¡æ¯ä¹Ÿè¯´æ˜ç³»ç»Ÿä¸ºå¯¹ç§°æ¶æ„-1" class="headerlink" title="NUMAä¿¡æ¯ä¹Ÿè¯´æ˜ç³»ç»Ÿä¸ºå¯¹ç§°æ¶æ„"></a>NUMAä¿¡æ¯ä¹Ÿè¯´æ˜ç³»ç»Ÿä¸ºå¯¹ç§°æ¶æ„</h3><ul><li>GPU0~GPU3 å±äº NUMA èŠ‚ç‚¹ 0ï¼ˆAffinity: <code>0-31,64-95</code>ï¼‰</li><li>GPU4~GPU7 å±äº NUMA èŠ‚ç‚¹ 1ï¼ˆAffinity: <code>32-63,96-127</code>ï¼‰</li></ul><p>è¿™é€šå¸¸æ„å‘³ç€åŒè·¯CPUï¼Œæ¯ä¸ªCPUæŒ‚è½½4å¼ GPUï¼Œé€šè¿‡ NVSwitch å®ç°GPUé—´çš„é«˜é€Ÿäº’é€šã€‚</p><hr><h3 id="å°ç»“-1"><a href="#å°ç»“-1" class="headerlink" title="å°ç»“"></a>å°ç»“</h3><table><thead><tr><th>é¡¹ç›®</th><th>çŠ¶æ€</th></tr></thead><tbody><tr><td>GPUé—´P2P</td><td>âœ… å…¨éƒ¨æ”¯æŒï¼ˆNV12ï¼‰</td></tr><tr><td>é€šä¿¡æ–¹å¼</td><td>NVLink 12è·¯äº’è”</td></tr><tr><td>æ¶æ„ç±»å‹</td><td>å¤šGPU NVSwitch</td></tr><tr><td>é€‚åˆåœºæ™¯</td><td>å¤§æ¨¡å‹è®­ç»ƒã€å¤šå¡æ¨ç†ã€æ·±åº¦å­¦ä¹ è®­ç»ƒç­‰</td></tr></tbody></table><hr><h3 id="âœ…-å»ºè®®-1"><a href="#âœ…-å»ºè®®-1" class="headerlink" title="âœ… å»ºè®®"></a>âœ… å»ºè®®</h3><p>ä½ å¯ä»¥åœ¨ CUDA æˆ–æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆå¦‚ PyTorchã€TensorFlowï¼‰ä¸­æ”¾å¿ƒä½¿ç”¨å¤šå¡è®­ç»ƒï¼Œä¸éœ€è¦æ‹…å¿ƒ GPU é—´çš„æ•°æ®ä¼ è¾“ç“¶é¢ˆã€‚</p><p>å¦‚éœ€éªŒè¯ç¨‹åºä¸­æ˜¯å¦ä½¿ç”¨äº† P2Pï¼Œå¯åœ¨ PyTorch ä¸­ä½¿ç”¨ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">torch.cuda.device(<span class="number">0</span>).can_access_peer(<span class="number">1</span>)  <span class="comment"># True</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ è¦è¿›ä¸€æ­¥ä¼˜åŒ–å¤šGPUè®­ç»ƒæ€§èƒ½ï¼Œè¿˜å¯ä»¥è®¾ç½®ç¯å¢ƒå˜é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NCCL_P2P_LEVEL=NVL  <span class="comment"># å¼ºåˆ¶NCCLä½¿ç”¨NVLink</span></span><br></pre></td></tr></table></figure><p>éœ€è¦å¸®åŠ©é…ç½®å¤šå¡è®­ç»ƒæˆ– NCCL å‚æ•°ä¼˜åŒ–ï¼Œä¹Ÿå¯ä»¥ç»§ç»­é—®æˆ‘ã€‚</p></blockquote><p>gpuæœºå™¨ä¸­nvidia-fabricmanager-550æœåŠ¡æ˜¯å¹²å˜›çš„</p><blockquote><p><code>Fabric Manager</code> æ˜¯ NVIDIA æä¾›çš„ä¸€ä¸ªç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹æœåŠ¡ï¼Œä¸»è¦ç”¨äºæ”¯æŒ <strong>NVSwitch/NVLink æ¶æ„çš„å¤šGPUé€šä¿¡å’Œç®¡ç†</strong>ï¼Œç‰¹åˆ«æ˜¯åœ¨ A100ã€H100 ç­‰æ•°æ®ä¸­å¿ƒçº§åˆ«çš„ GPU ç³»ç»Ÿä¸­ï¼ˆå¦‚ NVIDIA HGX å¹³å°ï¼‰ã€‚</p><hr><h2 id="ğŸ”§-Fabric-Manager-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#ğŸ”§-Fabric-Manager-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ğŸ”§ Fabric Manager æ˜¯ä»€ä¹ˆï¼Ÿ"></a>ğŸ”§ Fabric Manager æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p><strong>Fabric Manager</strong> æ˜¯ NVIDIA GPU é©±åŠ¨çš„ä¸€éƒ¨åˆ†ï¼Œä¸»è¦ç”¨äºï¼š</p><h3 id="âœ…-ç®¡ç†å’Œå¯ç”¨-NVSwitchï¼ˆGPUäº’è”äº¤æ¢èŠ¯ç‰‡ï¼‰"><a href="#âœ…-ç®¡ç†å’Œå¯ç”¨-NVSwitchï¼ˆGPUäº’è”äº¤æ¢èŠ¯ç‰‡ï¼‰" class="headerlink" title="âœ… ç®¡ç†å’Œå¯ç”¨ NVSwitchï¼ˆGPUäº’è”äº¤æ¢èŠ¯ç‰‡ï¼‰"></a>âœ… ç®¡ç†å’Œå¯ç”¨ NVSwitchï¼ˆGPUäº’è”äº¤æ¢èŠ¯ç‰‡ï¼‰</h3><ul><li><strong>NVSwitch</strong> æ˜¯ä¸€ç§é«˜é€Ÿäº¤æ¢èŠ¯ç‰‡ï¼Œç”¨äºè¿æ¥å¤šä¸ª GPUï¼Œå®ç°ç±»ä¼¼â€œç½‘ç»œäº¤æ¢æœºâ€ä¸€æ ·çš„äº’è”ã€‚</li><li>Fabric Manager ä¼šè´Ÿè´£å‘ç°ã€åˆå§‹åŒ–ã€é…ç½®è¿™äº› NVSwitchï¼Œè®©å¤šGPUä¹‹é—´å¯ä»¥ <strong>å…±äº«å†…å­˜ã€è¿›è¡Œé«˜é€ŸP2Pé€šä¿¡</strong>ã€‚</li></ul><h3 id="âœ…-æ”¯æŒç»Ÿä¸€å†…å­˜ç©ºé—´ï¼ˆå¦‚-Multi-Instance-GPUï¼‰"><a href="#âœ…-æ”¯æŒç»Ÿä¸€å†…å­˜ç©ºé—´ï¼ˆå¦‚-Multi-Instance-GPUï¼‰" class="headerlink" title="âœ… æ”¯æŒç»Ÿä¸€å†…å­˜ç©ºé—´ï¼ˆå¦‚ Multi-Instance GPUï¼‰"></a>âœ… æ”¯æŒç»Ÿä¸€å†…å­˜ç©ºé—´ï¼ˆå¦‚ Multi-Instance GPUï¼‰</h3><ul><li>åœ¨ A100/H100 ä¸Šï¼ŒFabric Manager ååŠ©æ„å»ºä¸€ä¸ªå¤§çš„<strong>ç»Ÿä¸€è™šæ‹Ÿ GPU å†…å­˜ç©ºé—´</strong>ï¼ˆUnified Virtual Address Space, UVAï¼‰ã€‚</li><li>è¿™æ ·å¯ä»¥è®©å¤šä¸ª GPU åƒä¸€ä¸ªæ•´ä½“ä¸€æ ·è¿è¡Œï¼Œæ¯”å¦‚æ¨¡å‹å¹¶è¡Œã€å¤§æ¨¡å‹è®­ç»ƒã€‚</li></ul><h3 id="âœ…-ä¿è¯-GPU-æ‹“æ‰‘æ„ŸçŸ¥é€šä¿¡æ­£å¸¸"><a href="#âœ…-ä¿è¯-GPU-æ‹“æ‰‘æ„ŸçŸ¥é€šä¿¡æ­£å¸¸" class="headerlink" title="âœ… ä¿è¯ GPU æ‹“æ‰‘æ„ŸçŸ¥é€šä¿¡æ­£å¸¸"></a>âœ… ä¿è¯ GPU æ‹“æ‰‘æ„ŸçŸ¥é€šä¿¡æ­£å¸¸</h3><ul><li>ç¡®ä¿ GPU æ‹“æ‰‘ï¼ˆå¦‚ NVLinkã€NVSwitch äº’è”å…³ç³»ï¼‰èƒ½æ­£ç¡®æš´éœ²ç»™å¦‚ NCCLã€CUDA ç­‰æ¡†æ¶ã€‚</li></ul><hr><h2 id="ğŸ–¥-ä½ åœ¨å“ªäº›æƒ…å†µä¸‹éœ€è¦-Fabric-Managerï¼Ÿ"><a href="#ğŸ–¥-ä½ åœ¨å“ªäº›æƒ…å†µä¸‹éœ€è¦-Fabric-Managerï¼Ÿ" class="headerlink" title="ğŸ–¥ ä½ åœ¨å“ªäº›æƒ…å†µä¸‹éœ€è¦ Fabric Managerï¼Ÿ"></a>ğŸ–¥ ä½ åœ¨å“ªäº›æƒ…å†µä¸‹éœ€è¦ Fabric Managerï¼Ÿ</h2><table><thead><tr><th>åœºæ™¯</th><th>æ˜¯å¦éœ€è¦ Fabric Manager</th></tr></thead><tbody><tr><td>å¤šGPUæ— NVSwitchäº’è”ï¼ˆå¦‚ä¸¤å¼  3090ï¼‰</td><td>âŒ ä¸éœ€è¦</td></tr><tr><td>ä½¿ç”¨ A100/H100 HGXå¹³å°ï¼Œæœ‰ NVSwitch</td><td>âœ… å¿…é¡»å¯ç”¨</td></tr><tr><td>éœ€è¦ Multi-Instance GPUï¼ˆMIGï¼‰</td><td>âœ… å¿…é¡»å¯ç”¨</td></tr><tr><td>è¿è¡Œ NCCL è·¨å¡é€šä¿¡ï¼ˆåœ¨ NVSwitch æ¶æ„ä¸Šï¼‰</td><td>âœ… å»ºè®®å¯ç”¨</td></tr></tbody></table><hr><h2 id="ğŸ“¦-å¦‚ä½•æŸ¥çœ‹-Fabric-Manager-æ˜¯å¦è¿è¡Œï¼Ÿ"><a href="#ğŸ“¦-å¦‚ä½•æŸ¥çœ‹-Fabric-Manager-æ˜¯å¦è¿è¡Œï¼Ÿ" class="headerlink" title="ğŸ“¦ å¦‚ä½•æŸ¥çœ‹ Fabric Manager æ˜¯å¦è¿è¡Œï¼Ÿ"></a>ğŸ“¦ å¦‚ä½•æŸ¥çœ‹ Fabric Manager æ˜¯å¦è¿è¡Œï¼Ÿ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status nvidia-fabricmanager</span><br></pre></td></tr></table></figure><p>æ­£å¸¸è¿è¡ŒçŠ¶æ€åº”ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â— nvidia-fabricmanager.service - NVIDIA Fabric Manager Daemon</span><br><span class="line">   Loaded: loaded (/lib/systemd/system/nvidia-fabricmanager.service; enabled)</span><br><span class="line">   Active: active (running)</span><br></pre></td></tr></table></figure><p>å¦‚æœæœªå¯åŠ¨ï¼Œå¯ä½¿ç”¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start nvidia-fabricmanager</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> nvidia-fabricmanager</span><br></pre></td></tr></table></figure><hr><h2 id="ğŸ§©-ä¸-GPU-é©±åŠ¨çš„å…³ç³»"><a href="#ğŸ§©-ä¸-GPU-é©±åŠ¨çš„å…³ç³»" class="headerlink" title="ğŸ§© ä¸ GPU é©±åŠ¨çš„å…³ç³»"></a>ğŸ§© ä¸ GPU é©±åŠ¨çš„å…³ç³»</h2><ul><li>Fabric Manager æ˜¯ GPU é©±åŠ¨åŒ…çš„ä¸€éƒ¨åˆ†ï¼ˆåœ¨ A100/H100 å¹³å°é©±åŠ¨å®‰è£…æ—¶å¯é€‰ï¼‰ã€‚</li><li>å®‰è£…æ–¹å¼ä¸€èˆ¬æ˜¯ï¼š</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install nvidia-fabricmanager-&lt;driver_version&gt;</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install nvidia-fabricmanager-550</span><br></pre></td></tr></table></figure><hr><h2 id="âœ…-å°ç»“"><a href="#âœ…-å°ç»“" class="headerlink" title="âœ… å°ç»“"></a>âœ… å°ç»“</h2><table><thead><tr><th>å±æ€§</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>æœåŠ¡åç§°</td><td><code>nvidia-fabricmanager</code></td></tr><tr><td>æ‰€å±å¹³å°</td><td>A100/H100 + NVSwitch æ¶æ„</td></tr><tr><td>æ˜¯å¦å¿…éœ€</td><td>å¦‚æœä½ ç”¨çš„æ˜¯ NVSwitch äº’è”ï¼ˆå¦‚ HGXï¼‰ï¼Œ<strong>å¿…é¡»å¯ç”¨</strong></td></tr><tr><td>ä½œç”¨</td><td>ç®¡ç† GPU äº’è”æ‹“æ‰‘ã€å¯ç”¨ NVSwitchã€æ”¯æŒç»Ÿä¸€å†…å­˜ã€MIGã€å¤šGPUé€šä¿¡</td></tr></tbody></table><hr><p>å¦‚æœä½ å½“å‰æœåŠ¡å™¨æ˜¯ 8x A100 å¹¶ä¸” <code>nvidia-smi topo -m</code> æ˜¾ç¤º <code>NV12</code>ï¼Œé‚£ä¹ˆä½ åº”è¯¥<strong>å¯ç”¨äº† Fabric Manager</strong>ï¼Œå®ƒåœ¨åå°è´Ÿè´£è¿™äº› NVLink å’Œ NVSwitch çš„é…ç½®å·¥ä½œã€‚</p><p>å¦‚æœä½ æƒ³æˆ‘å¸®ä½ æ£€æŸ¥å½“å‰ Fabric Manager çš„çŠ¶æ€æˆ–æ˜¯å¦éœ€è¦é…ç½®ï¼Œæˆ‘ä¹Ÿå¯ä»¥å¸®ä½ ç¡®è®¤ã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ­ç§˜Ubuntuç³»ç»Ÿä¸­çš„br0ç½‘ç»œæ¥å£ï¼šæ­ç§˜ç½‘ç»œé…ç½®èƒŒåçš„ç§˜å¯†</title>
      <link href="/2025/03/25/Ubuntu%E7%B3%BB%E7%BB%9F%E4%B8%AD%E9%85%8D%E7%BD%AEbr0%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3/"/>
      <url>/2025/03/25/Ubuntu%E7%B3%BB%E7%BB%9F%E4%B8%AD%E9%85%8D%E7%BD%AEbr0%E7%BD%91%E7%BB%9C%E6%8E%A5%E5%8F%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ­ç§˜Ubuntuç³»ç»Ÿä¸­çš„br0ç½‘ç»œæ¥å£ï¼šæ­ç§˜ç½‘ç»œé…ç½®èƒŒåçš„ç§˜å¯†"><a href="#æ­ç§˜Ubuntuç³»ç»Ÿä¸­çš„br0ç½‘ç»œæ¥å£ï¼šæ­ç§˜ç½‘ç»œé…ç½®èƒŒåçš„ç§˜å¯†" class="headerlink" title="æ­ç§˜Ubuntuç³»ç»Ÿä¸­çš„br0ç½‘ç»œæ¥å£ï¼šæ­ç§˜ç½‘ç»œé…ç½®èƒŒåçš„ç§˜å¯†"></a>æ­ç§˜Ubuntuç³»ç»Ÿä¸­çš„br0ç½‘ç»œæ¥å£ï¼šæ­ç§˜ç½‘ç»œé…ç½®èƒŒåçš„ç§˜å¯†</h1><p>æœ¬æ–‡è½¬è½½è‡ªï¼š<a href="https://www.oryoy.com/news/jie-mi-ubuntu-xi-tong-zhong-de-br0-wang-luo-jie-kou-jie-mi-wang-luo-pei-zhi-bei-hou-de-mi-mi.html">æ­ç§˜Ubuntuç³»ç»Ÿä¸­çš„br0ç½‘ç»œæ¥å£ï¼šæ­ç§˜ç½‘ç»œé…ç½®èƒŒåçš„ç§˜å¯† - äº‘åŸç”Ÿå®è·µ</a></p><p>å¤‡æ³¨ï¼šé‡å¯åå°†ä¼šå¤±æ•ˆ</p><h2 id="æ¦‚è§ˆï¼š"><a href="#æ¦‚è§ˆï¼š" class="headerlink" title="æ¦‚è§ˆï¼š"></a>æ¦‚è§ˆï¼š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sudo brctl addbr br0</span><br><span class="line">sudo brctl addif br0 eth0</span><br><span class="line">hostname -I</span><br><span class="line">sudo ip addr add 172.31.63.56/24 dev br0</span><br><span class="line">sudo ip <span class="built_in">link</span> <span class="built_in">set</span> br0 up</span><br><span class="line">sudo route add default gw 172.31.63.1  br0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ°¸ä¹…ç”Ÿæ•ˆï¼š</p><ul><li>sudo nano /etc/netplan/01-netcfg.yaml</li><li>sudo netplan apply<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">network:</span></span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">renderer:</span> <span class="string">networkd</span></span><br><span class="line">  <span class="attr">ethernets:</span></span><br><span class="line">    <span class="attr">eth0:</span></span><br><span class="line">      <span class="attr">dhcp4:</span> <span class="literal">no</span></span><br><span class="line">  <span class="attr">bridges:</span></span><br><span class="line">    <span class="attr">br0:</span></span><br><span class="line">      <span class="attr">interfaces:</span> [<span class="string">eth0</span>]</span><br><span class="line">      <span class="attr">addresses:</span> [<span class="number">172.31</span><span class="number">.63</span><span class="number">.56</span><span class="string">/24</span>]</span><br><span class="line">      <span class="attr">gateway4:</span> <span class="number">172.31</span><span class="number">.63</span><span class="number">.1</span></span><br><span class="line">      <span class="attr">nameservers:</span></span><br><span class="line">        <span class="attr">addresses:</span> [<span class="number">8.8</span><span class="number">.8</span><span class="number">.8</span>, <span class="number">223.5</span><span class="number">.5</span><span class="number">.5</span>]</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></li></ul><p> <img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_2e0b558b5e87e1f781e8113b48ff54f9.png"></p><h2 id="å¼•è¨€"><a href="#å¼•è¨€" class="headerlink" title="å¼•è¨€"></a>å¼•è¨€</h2><p>åœ¨Ubuntuç³»ç»Ÿä¸­ï¼Œæ‚¨å¯èƒ½ä¼šé‡åˆ°åä¸ºbr0çš„ç½‘ç»œæ¥å£ã€‚è¿™ä¸ªæ¥å£å¯¹äºæŸäº›ç½‘ç»œé…ç½®æ¥è¯´è‡³å…³é‡è¦ï¼Œä½†å¯¹äºæ–°æ‰‹æ¥è¯´ï¼Œå®ƒå¯èƒ½æ˜¾å¾—ç¥ç§˜ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨br0ç½‘ç»œæ¥å£çš„ä½œç”¨ã€é…ç½®æ–¹æ³•ä»¥åŠèƒŒåçš„åŸç†ã€‚</p><h2 id="br0ç½‘ç»œæ¥å£ç®€ä»‹"><a href="#br0ç½‘ç»œæ¥å£ç®€ä»‹" class="headerlink" title="br0ç½‘ç»œæ¥å£ç®€ä»‹"></a>br0ç½‘ç»œæ¥å£ç®€ä»‹</h2><p>br0æ˜¯Bridgeï¼ˆç½‘æ¡¥ï¼‰çš„ç®€ç§°ï¼Œå®ƒæ˜¯ä¸€ç§è™šæ‹Ÿç½‘ç»œæ¥å£ï¼Œç”¨äºå°†å¤šä¸ªç‰©ç†ç½‘ç»œæ¥å£æˆ–è™šæ‹Ÿæ¥å£è¿æ¥èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªé€»è¾‘ä¸Šçš„ç½‘ç»œæ®µã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œç½‘æ¡¥é€šå¸¸ç”¨äºè™šæ‹Ÿæœºç½‘ç»œã€å®¹å™¨ç½‘ç»œä»¥åŠå¤æ‚ç½‘ç»œç¯å¢ƒä¸­çš„å¤šä¸»æœºé€šä¿¡ã€‚</p><h2 id="br0çš„ä½œç”¨"><a href="#br0çš„ä½œç”¨" class="headerlink" title="br0çš„ä½œç”¨"></a>br0çš„ä½œç”¨</h2><ol><li><strong>è¿æ¥å¤šä¸ªç½‘ç»œæ¥å£</strong>ï¼šé€šè¿‡ç½‘æ¡¥ï¼Œæ‚¨å¯ä»¥è¿æ¥å¤šä¸ªç½‘ç»œæ¥å£ï¼Œå½¢æˆä¸€ä¸ªé€»è¾‘ä¸Šçš„ç½‘ç»œæ®µã€‚</li><li><strong>éš”ç¦»ç½‘ç»œæµé‡</strong>ï¼šç½‘æ¡¥å¯ä»¥å°†ä¸åŒçš„ç½‘ç»œæµé‡éš”ç¦»å¼€æ¥ï¼Œä»è€Œæé«˜ç½‘ç»œå®‰å…¨æ€§ã€‚</li><li><strong>è™šæ‹Ÿç½‘ç»œé…ç½®</strong>ï¼šåœ¨è™šæ‹ŸåŒ–ç¯å¢ƒä¸­ï¼Œç½‘æ¡¥ç”¨äºé…ç½®è™šæ‹Ÿæœºç½‘ç»œã€‚</li></ol><h2 id="br0çš„é…ç½®"><a href="#br0çš„é…ç½®" class="headerlink" title="br0çš„é…ç½®"></a>br0çš„é…ç½®</h2><h3 id="åˆ›å»ºç½‘æ¡¥"><a href="#åˆ›å»ºç½‘æ¡¥" class="headerlink" title="åˆ›å»ºç½‘æ¡¥"></a>åˆ›å»ºç½‘æ¡¥</h3><p>é¦–å…ˆï¼Œæ‚¨éœ€è¦åˆ›å»ºä¸€ä¸ªç½‘æ¡¥æ¥å£ï¼Œä¾‹å¦‚br0ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªç¤ºä¾‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo brctl addbr br0</span><br></pre></td></tr></table></figure><h3 id="æ·»åŠ ç½‘ç»œæ¥å£åˆ°ç½‘æ¡¥"><a href="#æ·»åŠ ç½‘ç»œæ¥å£åˆ°ç½‘æ¡¥" class="headerlink" title="æ·»åŠ ç½‘ç»œæ¥å£åˆ°ç½‘æ¡¥"></a>æ·»åŠ ç½‘ç»œæ¥å£åˆ°ç½‘æ¡¥</h3><p>å°†ç‰©ç†æ¥å£æˆ–è™šæ‹Ÿæ¥å£æ·»åŠ åˆ°ç½‘æ¡¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo brctl addif br0 eth0</span><br></pre></td></tr></table></figure><h3 id="é…ç½®IPåœ°å€"><a href="#é…ç½®IPåœ°å€" class="headerlink" title="é…ç½®IPåœ°å€"></a>é…ç½®IPåœ°å€</h3><p>ä¸ºç½‘æ¡¥åˆ†é…ä¸€ä¸ªIPåœ°å€ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ip addr add 192.168.1.1/24 dev br0</span><br></pre></td></tr></table></figure><h3 id="å¯ç”¨ç½‘æ¡¥"><a href="#å¯ç”¨ç½‘æ¡¥" class="headerlink" title="å¯ç”¨ç½‘æ¡¥"></a>å¯ç”¨ç½‘æ¡¥</h3><p>å¯ç”¨ç½‘æ¡¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo ip <span class="built_in">link</span> <span class="built_in">set</span> br0 up</span><br></pre></td></tr></table></figure><h3 id="è®¾ç½®é»˜è®¤ç½‘å…³"><a href="#è®¾ç½®é»˜è®¤ç½‘å…³" class="headerlink" title="è®¾ç½®é»˜è®¤ç½‘å…³"></a>è®¾ç½®é»˜è®¤ç½‘å…³</h3><p>ä¸ºç½‘æ¡¥è®¾ç½®é»˜è®¤ç½‘å…³ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo route add default gw 192.168.1.254 br0</span><br></pre></td></tr></table></figure><h3 id="é…ç½®DNSæœåŠ¡å™¨"><a href="#é…ç½®DNSæœåŠ¡å™¨" class="headerlink" title="é…ç½®DNSæœåŠ¡å™¨"></a>é…ç½®DNSæœåŠ¡å™¨</h3><p>é…ç½®DNSæœåŠ¡å™¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo nano /etc/resolv.conf</span><br></pre></td></tr></table></figure><p>åœ¨æ‰“å¼€çš„æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nameserver 8.8.8.8</span><br><span class="line">nameserver 8.8.4.4</span><br></pre></td></tr></table></figure><p>ä¿å­˜å¹¶é€€å‡ºæ–‡ä»¶ã€‚</p><h2 id="br0èƒŒåçš„åŸç†"><a href="#br0èƒŒåçš„åŸç†" class="headerlink" title="br0èƒŒåçš„åŸç†"></a>br0èƒŒåçš„åŸç†</h2><ol><li><strong>æ•°æ®å¸§è½¬å‘</strong>ï¼šç½‘æ¡¥é€šè¿‡æ£€æŸ¥æ•°æ®å¸§çš„MACåœ°å€ï¼Œå°†æ•°æ®å¸§è½¬å‘åˆ°ç›¸åº”çš„ç½‘ç»œæ¥å£ã€‚</li><li><strong>å­¦ä¹ MACåœ°å€è¡¨</strong>ï¼šç½‘æ¡¥å­¦ä¹ æ¯ä¸ªç½‘ç»œæ¥å£ä¸Šçš„MACåœ°å€ï¼Œå¹¶å°†å…¶å­˜å‚¨åœ¨MACåœ°å€è¡¨ä¸­ã€‚</li><li><strong>è¿‡æ»¤æµé‡</strong>ï¼šç½‘æ¡¥å¯ä»¥è¿‡æ»¤æµé‡ï¼Œé˜²æ­¢æœªç»æˆæƒçš„æ•°æ®åŒ…è¿›å…¥ç½‘ç»œã€‚</li></ol><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>br0ç½‘ç»œæ¥å£æ˜¯Ubuntuç³»ç»Ÿä¸­ä¸€ä¸ªé‡è¦çš„è™šæ‹Ÿç½‘ç»œæ¥å£ï¼Œå®ƒä¸ºç”¨æˆ·æä¾›äº†ä¸°å¯Œçš„ç½‘ç»œé…ç½®é€‰é¡¹ã€‚é€šè¿‡æœ¬æ–‡çš„ä»‹ç»ï¼Œæ‚¨åº”è¯¥å·²ç»å¯¹br0ç½‘ç»œæ¥å£æœ‰äº†æ›´æ·±å…¥çš„äº†è§£ã€‚åœ¨é…ç½®å’Œä½¿ç”¨br0æ—¶ï¼Œè¯·æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>ç¡®ä¿æ‚¨çš„ç½‘ç»œç¯å¢ƒæ»¡è¶³éœ€æ±‚ã€‚</li><li>ä»”ç»†é…ç½®IPåœ°å€ã€ç½‘å…³å’ŒDNSæœåŠ¡å™¨ã€‚</li><li>äº†è§£ç½‘æ¡¥èƒŒåçš„åŸç†ï¼Œä»¥ä¾¿æ›´å¥½åœ°ä½¿ç”¨å®ƒã€‚</li></ul><p>å¸Œæœ›æœ¬æ–‡èƒ½å¸®åŠ©æ‚¨æ›´å¥½åœ°ç†è§£Ubuntuç³»ç»Ÿä¸­çš„br0ç½‘ç»œæ¥å£ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœåŠ¡å™¨æŠ¥é”™nf_conntrack: table full, dropping packetè§£å†³</title>
      <link href="/2025/03/20/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8A%A5%E9%94%99nf_conntrack:%20table%20full,%20dropping%20packet%E5%A4%84%E7%90%86/"/>
      <url>/2025/03/20/%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8A%A5%E9%94%99nf_conntrack:%20table%20full,%20dropping%20packet%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="æœåŠ¡å™¨æŠ¥é”™nf-conntrack-table-full-dropping-packetè§£å†³"><a href="#æœåŠ¡å™¨æŠ¥é”™nf-conntrack-table-full-dropping-packetè§£å†³" class="headerlink" title="æœåŠ¡å™¨æŠ¥é”™nf_conntrack: table full, dropping packetè§£å†³"></a>æœåŠ¡å™¨æŠ¥é”™nf_conntrack: table full, dropping packetè§£å†³</h2><h3 id="ç°è±¡ï¼š"><a href="#ç°è±¡ï¼š" class="headerlink" title="ç°è±¡ï¼š"></a>ç°è±¡ï¼š</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_59807eee8b52d2819b903d40a70f237e.png"></p><p>ä½ çš„ç³»ç»Ÿæ—¥å¿—æç¤º <code>nf_conntrack: table full, dropping packet</code>ï¼Œè¯´æ˜ <strong><code>conntrack</code> è¿æ¥è·Ÿè¸ªè¡¨å·²æ»¡</strong>ï¼Œå¯¼è‡´æ–°è¿æ¥è¢«ä¸¢å¼ƒã€‚è¿™ä¸ªé—®é¢˜é€šå¸¸å‘ç”Ÿåœ¨é«˜å¹¶å‘ç½‘ç»œç¯å¢ƒä¸­ï¼Œç‰¹åˆ«æ˜¯ NAT æˆ–é˜²ç«å¢™è§„åˆ™ä½¿ç”¨ <code>conntrack</code> è¿›è¡Œè¿æ¥è·Ÿè¸ªæ—¶ã€‚</p><h3 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a><strong>è§£å†³æ–¹æ¡ˆï¼š</strong></h3><h4 id="1-ä¸´æ—¶å¢åŠ -conntrack-è¡¨å¤§å°"><a href="#1-ä¸´æ—¶å¢åŠ -conntrack-è¡¨å¤§å°" class="headerlink" title="1. ä¸´æ—¶å¢åŠ  conntrack è¡¨å¤§å°"></a><strong>1. ä¸´æ—¶å¢åŠ  conntrack è¡¨å¤§å°</strong></h4><p>å¯ä»¥æš‚æ—¶å¢å¤§ <code>nf_conntrack_max</code> å€¼ï¼Œè®©ç³»ç»Ÿèƒ½è·Ÿè¸ªæ›´å¤šè¿æ¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 262144 &gt; /proc/sys/net/netfilter/nf_conntrack_max</span><br></pre></td></tr></table></figure><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>sysctl</code> å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.netfilter.nf_conntrack_max=262144</span><br></pre></td></tr></table></figure><p><strong>è¯´æ˜ï¼š</strong></p><ul><li>é»˜è®¤å€¼é€šå¸¸åœ¨ <code>65536</code> å·¦å³ï¼Œå»ºè®®é€‚å½“å¢åŠ ï¼Œæ¯”å¦‚ <code>262144</code> æˆ–æ›´é«˜ï¼Œå…·ä½“å–å†³äºæœåŠ¡å™¨çš„ç½‘ç»œè´Ÿè½½ã€‚</li></ul><h4 id="2-æ°¸ä¹…å¢åŠ -conntrack-è¡¨å¤§å°"><a href="#2-æ°¸ä¹…å¢åŠ -conntrack-è¡¨å¤§å°" class="headerlink" title="2. æ°¸ä¹…å¢åŠ  conntrack è¡¨å¤§å°"></a><strong>2. æ°¸ä¹…å¢åŠ  conntrack è¡¨å¤§å°</strong></h4><p>ç¼–è¾‘ <code>/etc/sysctl.conf</code>ï¼Œæ·»åŠ ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">net.netfilter.nf_conntrack_max</span>=<span class="number">262144</span></span><br></pre></td></tr></table></figure><p>ç„¶åä½¿å…¶ç”Ÿæ•ˆï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -p</span><br></pre></td></tr></table></figure><h4 id="3-æŸ¥çœ‹å½“å‰-conntrack-ä½¿ç”¨æƒ…å†µ"><a href="#3-æŸ¥çœ‹å½“å‰-conntrack-ä½¿ç”¨æƒ…å†µ" class="headerlink" title="3. æŸ¥çœ‹å½“å‰ conntrack ä½¿ç”¨æƒ…å†µ"></a><strong>3. æŸ¥çœ‹å½“å‰ conntrack ä½¿ç”¨æƒ…å†µ</strong></h4><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹å½“å‰çš„ <code>conntrack</code> è¿æ¥æ•°å’Œä¸Šé™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/sys/net/netfilter/nf_conntrack_count</span><br><span class="line"><span class="built_in">cat</span> /proc/sys/net/netfilter/nf_conntrack_max</span><br></pre></td></tr></table></figure><p>å¦‚æœ <code>conntrack_count</code> æ¥è¿‘ <code>conntrack_max</code>ï¼Œè¯´æ˜è¡¨å¿«æ»¡äº†ï¼Œéœ€è¦å¢åŠ  <code>conntrack_max</code>ã€‚</p><h4 id="4-è°ƒæ•´-hashsize"><a href="#4-è°ƒæ•´-hashsize" class="headerlink" title="4. è°ƒæ•´ hashsize"></a><strong>4. è°ƒæ•´ <code>hashsize</code></strong></h4><p>conntrack ä½¿ç”¨å“ˆå¸Œè¡¨å­˜å‚¨è¿æ¥ä¿¡æ¯ã€‚å¦‚æœè¡¨å¤ªå¤§ï¼Œé»˜è®¤ <code>hashsize</code> å¯èƒ½å¯¼è‡´æŸ¥è¯¢æ•ˆç‡é™ä½ï¼Œå¯ä»¥å¢åŠ ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 65536 &gt; /sys/module/nf_conntrack/parameters/hashsize</span><br></pre></td></tr></table></figure><h4 id="5-æ¸…ç†æ— ç”¨è¿æ¥"><a href="#5-æ¸…ç†æ— ç”¨è¿æ¥" class="headerlink" title="5. æ¸…ç†æ— ç”¨è¿æ¥"></a><strong>5. æ¸…ç†æ— ç”¨è¿æ¥</strong></h4><p>å¯ä»¥å®šæœŸæ¸…ç† <code>conntrack</code> è¿æ¥ï¼Œé‡Šæ”¾èµ„æºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">conntrack -F</span><br></pre></td></tr></table></figure><h4 id="6-æ£€æŸ¥-nf-conntrack-buckets-è®¾ç½®"><a href="#6-æ£€æŸ¥-nf-conntrack-buckets-è®¾ç½®" class="headerlink" title="6. æ£€æŸ¥ nf_conntrack_buckets è®¾ç½®"></a><strong>6. æ£€æŸ¥ <code>nf_conntrack_buckets</code> è®¾ç½®</strong></h4><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>conntrack</code> å“ˆå¸Œæ¡¶çš„å¤§å°æ˜¯ <code>nf_conntrack_max / 4</code>ï¼Œå¦‚æœ <code>conntrack_max</code> è¿‡å¤§ï¼Œå¯èƒ½å¯¼è‡´å“ˆå¸Œå†²çªï¼Œå½±å“æ€§èƒ½ã€‚å¯ä»¥è°ƒæ•´ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> 16384 &gt; /sys/module/nf_conntrack/parameters/hashsize</span><br></pre></td></tr></table></figure><p><strong>æˆ–è€…æ°¸ä¹…ç”Ÿæ•ˆï¼š</strong><br>åœ¨ <code>/etc/modprobe.d/nf_conntrack.conf</code> æ·»åŠ ï¼š</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">options nf_conntrack <span class="attr">hashsize</span>=<span class="number">16384</span></span><br></pre></td></tr></table></figure><p>ç„¶åé‡å¯æœåŠ¡å™¨ã€‚</p><h4 id="7-é™ä½-conntrack-è¶…æ—¶æ—¶é—´"><a href="#7-é™ä½-conntrack-è¶…æ—¶æ—¶é—´" class="headerlink" title="7. é™ä½ conntrack è¶…æ—¶æ—¶é—´"></a><strong>7. é™ä½ <code>conntrack</code> è¶…æ—¶æ—¶é—´</strong></h4><p>å¯ä»¥å‡å°‘ <code>conntrack</code> è¡¨é¡¹çš„è¶…æ—¶æ—¶é—´ï¼Œè®©æ—§è¿æ¥æ›´å¿«é‡Šæ”¾ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.netfilter.nf_conntrack_tcp_timeout_established=300</span><br><span class="line">sysctl -w net.netfilter.nf_conntrack_tcp_timeout_time_wait=120</span><br><span class="line">sysctl -w net.netfilter.nf_conntrack_tcp_timeout_close_wait=60</span><br><span class="line">sysctl -w net.netfilter.nf_conntrack_tcp_timeout_fin_wait=60</span><br></pre></td></tr></table></figure><p>ç„¶åä¿å­˜åˆ° <code>/etc/sysctl.conf</code>ï¼Œå¹¶æ‰§è¡Œ <code>sysctl -p</code>ã€‚</p><h4 id="8-æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½"><a href="#8-æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½" class="headerlink" title="8. æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½"></a><strong>8. æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½</strong></h4><p>é«˜è´Ÿè½½æƒ…å†µä¸‹ï¼Œ<code>conntrack</code> å¤„ç†æ•ˆç‡å¯èƒ½é™ä½ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">top</span><br><span class="line">htop</span><br><span class="line">dmesg | <span class="built_in">tail</span> -50</span><br></pre></td></tr></table></figure><p>å¦‚æœå‘ç° CPUã€å†…å­˜æˆ– I/O è´Ÿè½½è¿‡é«˜ï¼Œå¯èƒ½éœ€è¦ä¼˜åŒ–æœåŠ¡å™¨æ€§èƒ½ã€‚</p><h4 id="9-å…³é—­-conntrackï¼ˆä»…é€‚ç”¨äºæ— çŠ¶æ€æµé‡ï¼‰"><a href="#9-å…³é—­-conntrackï¼ˆä»…é€‚ç”¨äºæ— çŠ¶æ€æµé‡ï¼‰" class="headerlink" title="9. å…³é—­ conntrackï¼ˆä»…é€‚ç”¨äºæ— çŠ¶æ€æµé‡ï¼‰"></a><strong>9. å…³é—­ <code>conntrack</code>ï¼ˆä»…é€‚ç”¨äºæ— çŠ¶æ€æµé‡ï¼‰</strong></h4><p>å¦‚æœä½ çš„æœåŠ¡å™¨åªæ˜¯è½¬å‘æµé‡ï¼Œä¸éœ€è¦ <code>conntrack</code>ï¼Œå¯ä»¥ç¦ç”¨å®ƒï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">iptables -t raw -A PREROUTING -j NOTRACK</span><br><span class="line">iptables -t raw -A OUTPUT -j NOTRACK</span><br></pre></td></tr></table></figure><p>ç„¶åæ£€æŸ¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -t raw -L -n -v</span><br></pre></td></tr></table></figure><hr><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h3><p>å¦‚æœä½ çš„æœåŠ¡å™¨ <strong>éœ€è¦è¿æ¥è·Ÿè¸ª</strong>ï¼Œå¯ä»¥ï¼š</p><ol><li><strong>å¢åŠ  <code>nf_conntrack_max</code></strong></li><li><strong>è°ƒæ•´ <code>hashsize</code></strong></li><li><strong>æ¸…ç†æ— ç”¨è¿æ¥</strong></li><li><strong>é™ä½ <code>conntrack</code> è¶…æ—¶æ—¶é—´</strong></li><li><strong>ç›‘æ§æœåŠ¡å™¨è´Ÿè½½</strong></li></ol><p>å¦‚æœæœåŠ¡å™¨åªæ˜¯ <strong>è½¬å‘å¤§é‡æµé‡ï¼ˆå¦‚ç½‘å…³æˆ–è¾¹ç•Œè·¯ç”±å™¨ï¼‰</strong>ï¼Œè€ƒè™‘ **ç¦ç”¨ <code>conntrack</code>**ã€‚</p><p>ä½ å¯ä»¥å…ˆå°è¯• <code>sysctl -w net.netfilter.nf_conntrack_max=262144</code>ï¼Œç„¶åè§‚å¯Ÿæ˜¯å¦å‡å°‘ä¸¢åŒ…æƒ…å†µã€‚å¦‚æœé—®é¢˜ä»ç„¶å­˜åœ¨ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰å¼‚å¸¸æµé‡æˆ– DDoS æ”»å‡»ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®¹å™¨åŒ–éƒ¨ç½²ollamaç¯å¢ƒå˜é‡é—®é¢˜</title>
      <link href="/2025/03/12/%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2ollama%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%97%AE%E9%A2%98/"/>
      <url>/2025/03/12/%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2ollama%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="å®¹å™¨åŒ–éƒ¨ç½²ollamaç¯å¢ƒå˜é‡é—®é¢˜"><a href="#å®¹å™¨åŒ–éƒ¨ç½²ollamaç¯å¢ƒå˜é‡é—®é¢˜" class="headerlink" title="å®¹å™¨åŒ–éƒ¨ç½²ollamaç¯å¢ƒå˜é‡é—®é¢˜"></a>å®¹å™¨åŒ–éƒ¨ç½²ollamaç¯å¢ƒå˜é‡é—®é¢˜</h2><p>ä½ çš„ GPU æ˜¯ <strong>GTX 1050 Ti</strong>ï¼Œè€Œ <strong>Ollama ä¾èµ– CUDA è®¡ç®—èƒ½åŠ›è‡³å°‘ 7.0</strong>ï¼Œä½† GTX 1050 Ti åªæœ‰ <strong>6.1</strong>ï¼Œè¿™å¯èƒ½æ˜¯ Ollama ä¸æ”¯æŒçš„åŸå› ã€‚</p><p>ä½ å¯ä»¥è¿è¡Œï¼š</p><pre class="!overflow-visible" data-start="1950" data-end="2009"><div class="contain-inline-size rounded-md border-[0.5px] border-token-border-medium relative bg-token-sidebar-surface-primary"><div class="flex items-center text-token-text-secondary px-4 py-2 text-xs font-sans justify-between h-9 bg-token-sidebar-surface-primary dark:bg-token-main-surface-secondary select-none rounded-t-[5px]">bash</div><div class="sticky top-9"><div class="absolute bottom-0 right-0 flex h-9 items-center pr-2"><div class="flex items-center rounded bg-token-sidebar-surface-primary px-2 font-sans text-xs text-token-text-secondary dark:bg-token-main-surface-secondary"><span class data-state="closed"><button class="flex gap-1 items-center select-none px-4 py-1" aria-label="å¤åˆ¶"><svg width="24" height="24" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-xs"><path fill-rule="evenodd" clip-rule="evenodd" d="M7 5C7 3.34315 8.34315 2 10 2H19C20.6569 2 22 3.34315 22 5V14C22 15.6569 20.6569 17 19 17H17V19C17 20.6569 15.6569 22 14 22H5C3.34315 22 2 20.6569 2 19V10C2 8.34315 3.34315 7 5 7H7V5ZM9 7H14C15.6569 7 17 8.34315 17 10V15H19C19.5523 15 20 14.5523 20 14V5C20 4.44772 19.5523 4 19 4H10C9.44772 4 9 4.44772 9 5V7ZM5 9C4.44772 9 4 9.44772 4 10V19C4 19.5523 4.44772 20 5 20H14C14.5523 20 15 19.5523 15 19V10C15 9.44772 14.5523 9 14 9H5Z" fill="currentColor"/></svg>å¤åˆ¶</button></span><span class data-state="closed"><button class="flex select-none items-center gap-1 px-4 py-1"><svg width="24" height="24" viewbox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-xs"><path d="M2.5 5.5C4.3 5.2 5.2 4 5.5 2.5C5.8 4 6.7 5.2 8.5 5.5C6.7 5.8 5.8 7 5.5 8.5C5.2 7 4.3 5.8 2.5 5.5Z" fill="currentColor" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"/><path d="M5.66282 16.5231L5.18413 19.3952C5.12203 19.7678 5.09098 19.9541 5.14876 20.0888C5.19933 20.2067 5.29328 20.3007 5.41118 20.3512C5.54589 20.409 5.73218 20.378 6.10476 20.3159L8.97693 19.8372C9.72813 19.712 10.1037 19.6494 10.4542 19.521C10.7652 19.407 11.0608 19.2549 11.3343 19.068C11.6425 18.8575 11.9118 18.5882 12.4503 18.0497L20 10.5C21.3807 9.11929 21.3807 6.88071 20 5.5C18.6193 4.11929 16.3807 4.11929 15 5.5L7.45026 13.0497C6.91175 13.5882 6.6425 13.8575 6.43197 14.1657C6.24513 14.4392 6.09299 14.7348 5.97903 15.0458C5.85062 15.3963 5.78802 15.7719 5.66282 16.5231Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/><path d="M14.5 7L18.5 11" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>ç¼–è¾‘</button></span></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="!whitespace-pre language-bash"><span><span>nvidia-smi --query-gpu=compute_cap --format=csv</span></span></code></div></div></pre><p>å¦‚æœè¾“å‡º <code>&lt; 7.0</code>ï¼Œè¯´æ˜ä½ çš„ GPU ä¸æ”¯æŒ Ollama çš„ CUDA ç‰ˆæœ¬ï¼Œä½ å¯èƒ½éœ€è¦ä½¿ç”¨ CPU æ¨ç†ï¼Œæˆ–è€…æ¢ä¸€å¼ æ›´é«˜è®¡ç®—èƒ½åŠ›çš„ GPUï¼ˆå¦‚ RTX 20 ç³»åˆ—åŠä»¥ä¸Šï¼‰ã€‚</p><h2 id="ç¯å¢ƒå˜é‡è§£é‡Šï¼š"><a href="#ç¯å¢ƒå˜é‡è§£é‡Šï¼š" class="headerlink" title="ç¯å¢ƒå˜é‡è§£é‡Šï¼š"></a>ç¯å¢ƒå˜é‡è§£é‡Šï¼š</h2><ul><li>CUDA_VISIBLE_DEVICES: 0   # æŒ‡å®šä½¿ç”¨ GPU 0</li><li>OLLAMA_USE_CUDA: true  # ollamaå¼€å¯GPU</li><li>OLLAMA_USE_GPU: true    # ollamaå¼€å¯GPU</li></ul><h2 id="è¿™äº›ç¯å¢ƒå˜é‡çš„è¯¦ç»†è§£é‡Šå¦‚ä¸‹ï¼ˆGPT4-0å›ç­”ï¼‰ï¼š"><a href="#è¿™äº›ç¯å¢ƒå˜é‡çš„è¯¦ç»†è§£é‡Šå¦‚ä¸‹ï¼ˆGPT4-0å›ç­”ï¼‰ï¼š" class="headerlink" title="è¿™äº›ç¯å¢ƒå˜é‡çš„è¯¦ç»†è§£é‡Šå¦‚ä¸‹ï¼ˆGPT4.0å›ç­”ï¼‰ï¼š"></a>è¿™äº›ç¯å¢ƒå˜é‡çš„è¯¦ç»†è§£é‡Šå¦‚ä¸‹ï¼ˆGPT4.0å›ç­”ï¼‰ï¼š</h2><h3 id="1-KEEP-GPUS-TIMEOUT-40"><a href="#1-KEEP-GPUS-TIMEOUT-40" class="headerlink" title="1. KEEP_GPUS_TIMEOUT: 40"></a><strong>1. <code>KEEP_GPUS_TIMEOUT: 40</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šä¿æŒ GPU èµ„æºåˆ†é…çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½é€šå¸¸æ˜¯ <strong>ç§’</strong>ã€‚</li><li><strong>å½±å“</strong>ï¼šå¦‚æœ Ollama åœ¨ 40 ç§’å†…æ²¡æœ‰ä½¿ç”¨ GPUï¼Œå¯èƒ½ä¼šé‡Šæ”¾ GPU èµ„æºï¼ˆå–å†³äºå®ç°ï¼‰ã€‚</li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šé¿å… GPU èµ„æºé•¿æœŸå ç”¨è€Œä¸é‡Šæ”¾ï¼Œæœ‰åŠ©äºæé«˜èµ„æºåˆ©ç”¨ç‡ã€‚</li></ul><hr><h3 id="2-TZ-Asia-Shanghai"><a href="#2-TZ-Asia-Shanghai" class="headerlink" title="2. TZ: Asia/Shanghai"></a><strong>2. <code>TZ: Asia/Shanghai</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šè®¾ç½® <strong>å®¹å™¨å†…éƒ¨çš„æ—¶åŒº</strong> ä¸º <code>Asia/Shanghai</code>ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰ã€‚</li><li><strong>å½±å“</strong>ï¼šå½±å“æ—¥å¿—ã€ä»»åŠ¡è°ƒåº¦ç­‰ä¾èµ–ç³»ç»Ÿæ—¶é—´çš„åŠŸèƒ½ã€‚</li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¦‚æœä¸è®¾ç½®ï¼Œå®¹å™¨å¯èƒ½é»˜è®¤ä½¿ç”¨ UTC æ—¶é—´ï¼Œå¯¼è‡´æ—¥å¿—æ—¶é—´ä¸å®é™…ä¸ç¬¦ã€‚</li></ul><hr><h3 id="3-OLLAMA-ORIGINS-quot-quot"><a href="#3-OLLAMA-ORIGINS-quot-quot" class="headerlink" title="3. OLLAMA_ORIGINS: &quot;*&quot;"></a><strong>3. <code>OLLAMA_ORIGINS: &quot;*&quot;</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šé…ç½® <strong>CORS å…è®¸çš„æ¥æº</strong>ï¼Œ<code>*</code> è¡¨ç¤ºå…è®¸æ‰€æœ‰æ¥æºè®¿é—® Ollama APIã€‚</li><li><strong>å½±å“</strong>ï¼š<ul><li>å…è®¸ä»»ä½•å®¢æˆ·ç«¯ï¼ˆå‰ç«¯ç½‘é¡µã€åº”ç”¨ç­‰ï¼‰è®¿é—® Ollama APIã€‚</li><li>å¯èƒ½å­˜åœ¨å®‰å…¨é£é™©ï¼Œå»ºè®®é™åˆ¶ç‰¹å®šåŸŸåï¼Œå¦‚ï¼š<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">OLLAMA_ORIGINS:</span> <span class="string">&quot;http://example.com,https://example.com&quot;</span></span><br></pre></td></tr></table></figure></li></ul></li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š<ul><li>å…è®¸ Web åº”ç”¨ï¼ˆå¦‚ <code>Vue</code> æˆ– <code>React</code>ï¼‰è°ƒç”¨ Ollamaã€‚</li><li>å¼€å‘å’Œæµ‹è¯•ç¯å¢ƒï¼Œæ–¹ä¾¿è·¨åŸŸè¯·æ±‚ã€‚</li></ul></li></ul><hr><h3 id="4-OLLAMA-HOST-quot-0-0-0-0-quot"><a href="#4-OLLAMA-HOST-quot-0-0-0-0-quot" class="headerlink" title="4. OLLAMA_HOST: &quot;0.0.0.0&quot;"></a><strong>4. <code>OLLAMA_HOST: &quot;0.0.0.0&quot;</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šè®¾ç½® Ollama ç›‘å¬çš„ <strong>ç½‘ç»œæ¥å£</strong>ï¼Œ<code>0.0.0.0</code> è¡¨ç¤ºç›‘å¬æ‰€æœ‰ IP åœ°å€ã€‚</li><li><strong>å½±å“</strong>ï¼š<ul><li>å…è®¸å¤–éƒ¨è®¿é—® Ollama APIï¼ˆå¦‚ <code>http://&lt;æœåŠ¡å™¨IP&gt;:11434</code>ï¼‰ã€‚</li><li>å¦‚æœåªæƒ³è®©æœ¬åœ°è®¿é—®ï¼Œå»ºè®®æ”¹æˆï¼š<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">OLLAMA_HOST:</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br></pre></td></tr></table></figure></li></ul></li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š<ul><li>éƒ¨ç½²åœ¨è¿œç¨‹æœåŠ¡å™¨ï¼Œå…è®¸å±€åŸŸç½‘æˆ–å…¬ç½‘è®¿é—® Ollamaã€‚</li><li>å¦‚æœæ˜¯æœ¬åœ°å¼€å‘ï¼Œå»ºè®®é™åˆ¶ä¸º <code>127.0.0.1</code>ã€‚</li></ul></li></ul><hr><h3 id="5-CUDA-VISIBLE-DEVICES-0"><a href="#5-CUDA-VISIBLE-DEVICES-0" class="headerlink" title="5. CUDA_VISIBLE_DEVICES: 0"></a><strong>5. <code>CUDA_VISIBLE_DEVICES: 0</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šæŒ‡å®š <strong>å¯è§çš„ GPU</strong>ï¼Œ<code>0</code> è¡¨ç¤ºä½¿ç”¨ <strong>ç¬¬ 1 å— GPU</strong>ã€‚</li><li><strong>å½±å“</strong>ï¼š<ul><li>å¦‚æœæœåŠ¡å™¨æœ‰å¤šå— GPUï¼š<ul><li><code>CUDA_VISIBLE_DEVICES: 1</code>  â†’ åªä½¿ç”¨ <strong>ç¬¬ 2 å— GPU</strong>ã€‚</li><li><code>CUDA_VISIBLE_DEVICES: 0,1</code> â†’ ä½¿ç”¨ <strong>ç¬¬ 1 å’Œ 2 å— GPU</strong>ã€‚</li></ul></li><li>å¦‚æœè®¾ç½®ä¸º <code>-1</code>ï¼Œåˆ™ <strong>ç¦ç”¨ GPU</strong>ï¼Œå¼ºåˆ¶ä½¿ç”¨ CPUã€‚</li></ul></li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š<ul><li>å¤š GPU æœåŠ¡å™¨ï¼ŒæŒ‡å®šæŸå— GPU è¿è¡Œ Ollamaã€‚</li><li>èµ„æºæ§åˆ¶ï¼Œé¿å… Ollama å ç”¨æ‰€æœ‰ GPUã€‚</li></ul></li></ul><hr><h3 id="6-OLLAMA-USE-CUDA-true"><a href="#6-OLLAMA-USE-CUDA-true" class="headerlink" title="6. OLLAMA_USE_CUDA: true"></a><strong>6. <code>OLLAMA_USE_CUDA: true</code></strong></h3><ul><li><strong>ä½œç”¨</strong>ï¼šå¼ºåˆ¶å¯ç”¨ <strong>CUDA åŠ é€Ÿ</strong>ï¼Œè®© Ollama ä½¿ç”¨ GPU è¿›è¡Œæ¨ç†ã€‚</li><li><strong>å½±å“</strong>ï¼š<ul><li><code>true</code>ï¼šå¦‚æœæ£€æµ‹åˆ° <strong>NVIDIA GPU</strong>ï¼ŒOllama è¿è¡Œåœ¨ GPU ä¸Šï¼ˆæ€§èƒ½æ›´å¿«ï¼‰ã€‚</li><li><code>false</code>ï¼šå³ä½¿æœ‰ GPU ä¹Ÿ <strong>å¼ºåˆ¶ä½¿ç”¨ CPU</strong>ï¼ˆå¯èƒ½ç”¨äºè°ƒè¯•ï¼‰ã€‚</li></ul></li><li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼š<ul><li>éœ€è¦ GPU åŠ é€Ÿçš„æ¨¡å‹æ¨ç†ã€‚</li><li>æœåŠ¡å™¨ä¸Šæœ‰ GPUï¼Œä½†é»˜è®¤æœªå¯ç”¨ï¼Œéœ€è¦æ‰‹åŠ¨æŒ‡å®šã€‚</li></ul></li></ul><h3 id="7ã€NVIDIA-DRIVER-CAPABILITIES-compute-utility"><a href="#7ã€NVIDIA-DRIVER-CAPABILITIES-compute-utility" class="headerlink" title="7ã€NVIDIA_DRIVER_CAPABILITIES=compute,utility"></a>7ã€NVIDIA_DRIVER_CAPABILITIES=compute,utility</h3><p><code>NVIDIA_DRIVER_CAPABILITIES=compute,utility</code> æ˜¯ä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œç”¨äºæ§åˆ¶ Docker å®¹å™¨å†…å¯ç”¨çš„ NVIDIA é©±åŠ¨åŠŸèƒ½ã€‚</p><p>åœ¨ Docker è¿è¡Œå¸¦ GPU åŠ é€Ÿçš„å®¹å™¨æ—¶ï¼Œè¿™ä¸ªå˜é‡ç¡®ä¿å®¹å™¨å¯ä»¥ä½¿ç”¨å¿…è¦çš„ GPU è®¡ç®—èƒ½åŠ›ã€‚å®ƒçš„ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li>**<code>compute</code>**ï¼šå¯ç”¨ GPU è®¡ç®—åŠŸèƒ½ï¼ˆç”¨äº CUDAã€TensorFlowã€PyTorch ç­‰ï¼‰ã€‚</li><li>**<code>utility</code>**ï¼šå¯ç”¨ NVIDIA å®ç”¨ç¨‹åºï¼ˆå¦‚ <code>nvidia-smi</code>ï¼‰ã€‚</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a><strong>æ€»ç»“</strong></h2><table><thead><tr><th>å˜é‡</th><th>ä½œç”¨</th><th>å½±å“</th></tr></thead><tbody><tr><td><code>KEEP_GPUS_TIMEOUT: 40</code></td><td>GPU èµ„æºä¿æŒæ—¶é—´</td><td>40 ç§’å†…æ— ä»»åŠ¡å¯èƒ½é‡Šæ”¾ GPU</td></tr><tr><td><code>TZ: Asia/Shanghai</code></td><td>è®¾ç½®æ—¶åŒº</td><td>ç¡®ä¿å®¹å™¨æ—¥å¿—æ—¶é—´æ­£ç¡®</td></tr><tr><td><code>OLLAMA_ORIGINS: &quot;*&quot;</code></td><td>å…è®¸æ‰€æœ‰æ¥æºè®¿é—® API</td><td>è·¨åŸŸè®¿é—®ï¼Œå¯èƒ½æœ‰å®‰å…¨é£é™©</td></tr><tr><td><code>OLLAMA_HOST: &quot;0.0.0.0&quot;</code></td><td>ç›‘å¬æ‰€æœ‰ IP</td><td>å…è®¸å¤–éƒ¨è®¿é—® Ollama</td></tr><tr><td><code>CUDA_VISIBLE_DEVICES: 0</code></td><td>é€‰æ‹© GPU</td><td><code>0</code>ä»£è¡¨ä½¿ç”¨ç¬¬ 1 å— GPU</td></tr><tr><td><code>OLLAMA_USE_CUDA: true</code></td><td>å¯ç”¨ GPU åŠ é€Ÿ</td><td><code>true</code>= ä½¿ç”¨ CUDAï¼Œ<code>false</code>= ä»… CPU</td></tr></tbody></table><p>å¦‚æœä½ åœ¨ <strong>äº‘æœåŠ¡å™¨</strong> ä¸Šè¿è¡Œ Ollamaï¼Œå»ºè®®ï¼š</p><ul><li><strong>é™åˆ¶ API è®¿é—®</strong>ï¼Œé¿å…è¢«æ»¥ç”¨ï¼š<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">OLLAMA_ORIGINS:</span> <span class="string">&quot;http://yourdomain.com&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>åªç›‘å¬æœ¬åœ°</strong>ï¼Œå¦‚æœä¸éœ€è¦å¤–éƒ¨è®¿é—®ï¼š<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">OLLAMA_HOST:</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br></pre></td></tr></table></figure></li><li><strong>æŒ‡å®š GPU</strong>ï¼Œé¿å…å½±å“å…¶ä»–ä»»åŠ¡ï¼š<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">CUDA_VISIBLE_DEVICES:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></li></ul><p>ä½ æ˜¯æƒ³æ’æŸ¥ <strong>Ollama ä¸ä½¿ç”¨ GPU</strong> çš„é—®é¢˜å—ï¼Ÿå¦‚æœæ˜¯ï¼Œ<code>nvidia-smi</code> æ˜¾ç¤º <strong>æ— è¿›ç¨‹</strong>ï¼Œè¯´æ˜ Ollama ä»ç„¶åœ¨ CPU ä¸Šè·‘ï¼Œå¯èƒ½è¦è¿›ä¸€æ­¥æ£€æŸ¥ Ollama è¿è¡Œæ—¥å¿—æˆ– <code>docker-compose</code> é…ç½®ã€‚ğŸš€</p><h2 id="docker-compose-ymlæ–‡ä»¶å¦‚ä¸‹"><a href="#docker-compose-ymlæ–‡ä»¶å¦‚ä¸‹" class="headerlink" title="docker-compose.ymlæ–‡ä»¶å¦‚ä¸‹"></a>docker-compose.ymlæ–‡ä»¶å¦‚ä¸‹</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">ollama:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ollama</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">ollama</span></span><br><span class="line">    <span class="attr">runtime:</span> <span class="string">nvidia</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">reservations:</span></span><br><span class="line">          <span class="attr">devices:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">driver:</span> <span class="string">nvidia</span></span><br><span class="line">            <span class="attr">capabilities:</span> [<span class="string">&quot;gpu&quot;</span>]</span><br><span class="line">            <span class="attr">count:</span> <span class="string">all</span>  <span class="comment"># æ ¹æ®éœ€è¦è°ƒæ•´ GPU çš„æ•°é‡  </span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/root/.ollama:/root/.ollama</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;11434:11434&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">KEEP_GPUS_TIMEOUT:</span> <span class="number">40</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">OLLAMA_ORIGINS:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">      <span class="attr">OLLAMA_HOST:</span> <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">      <span class="attr">CUDA_VISIBLE_DEVICES:</span> <span class="number">0</span><span class="string">,1</span></span><br><span class="line">      <span class="attr">OLLAMA_USE_CUDA:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">NVIDIA_DRIVER_CAPABILITIES:</span> <span class="string">compute,utility</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤©ç¿¼äº‘è£¸é‡‘å±å®‰å…¨ç»„æ”¾é€šç«¯å£å dockerç«¯å£ä»ç„¶æ— æ³•è®¿é—®é—®é¢˜</title>
      <link href="/2025/03/10/%E5%A4%A9%E7%BF%BC%E4%BA%91%E8%A3%B8%E9%87%91%E5%B1%9E%E5%AE%89%E5%85%A8%E7%BB%84%E6%94%BE%E9%80%9A%E7%AB%AF%E5%8F%A3%E5%90%8E%20docker%E7%AB%AF%E5%8F%A3%E4%BB%8D%E7%84%B6%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E9%97%AE%E9%A2%98/"/>
      <url>/2025/03/10/%E5%A4%A9%E7%BF%BC%E4%BA%91%E8%A3%B8%E9%87%91%E5%B1%9E%E5%AE%89%E5%85%A8%E7%BB%84%E6%94%BE%E9%80%9A%E7%AB%AF%E5%8F%A3%E5%90%8E%20docker%E7%AB%AF%E5%8F%A3%E4%BB%8D%E7%84%B6%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å¤©ç¿¼äº‘è£¸é‡‘å±å®‰å…¨ç»„æ”¾é€šç«¯å£å-dockerç«¯å£ä»ç„¶æ— æ³•è®¿é—®é—®é¢˜"><a href="#å¤©ç¿¼äº‘è£¸é‡‘å±å®‰å…¨ç»„æ”¾é€šç«¯å£å-dockerç«¯å£ä»ç„¶æ— æ³•è®¿é—®é—®é¢˜" class="headerlink" title="å¤©ç¿¼äº‘è£¸é‡‘å±å®‰å…¨ç»„æ”¾é€šç«¯å£å dockerç«¯å£ä»ç„¶æ— æ³•è®¿é—®é—®é¢˜"></a>å¤©ç¿¼äº‘è£¸é‡‘å±å®‰å…¨ç»„æ”¾é€šç«¯å£å dockerç«¯å£ä»ç„¶æ— æ³•è®¿é—®é—®é¢˜</h1><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>1ã€æŸ¥çœ‹iptablesè§„åˆ™iptables -L -n -v<br>2ã€æ¸…ç©ºiptablesè§„åˆ™ï¼ˆiptables -Fï¼‰<br>3ã€é‡å¯dockerï¼ˆsystemctl restart dockerï¼‰<br>4ã€æ­¤æ—¶å³å¯è®¿é—®</p><h2 id="éœ€è¦å•ç‹¬ç«¯å£æ—¶æ·»åŠ åˆ°ç¬¬ä¸€æ¡ä¸è¦æ·»åŠ åœ¨æ‹’ç»è§„åˆ™â€“reject-with-icmp-host-prohibitedè¿™ä¸ªçš„å¦åˆ™ä¸ä¼šç”Ÿæ•ˆ"><a href="#éœ€è¦å•ç‹¬ç«¯å£æ—¶æ·»åŠ åˆ°ç¬¬ä¸€æ¡ä¸è¦æ·»åŠ åœ¨æ‹’ç»è§„åˆ™â€“reject-with-icmp-host-prohibitedè¿™ä¸ªçš„å¦åˆ™ä¸ä¼šç”Ÿæ•ˆ" class="headerlink" title="éœ€è¦å•ç‹¬ç«¯å£æ—¶æ·»åŠ åˆ°ç¬¬ä¸€æ¡ä¸è¦æ·»åŠ åœ¨æ‹’ç»è§„åˆ™â€“reject-with icmp-host-prohibitedè¿™ä¸ªçš„å¦åˆ™ä¸ä¼šç”Ÿæ•ˆ"></a>éœ€è¦å•ç‹¬ç«¯å£æ—¶æ·»åŠ åˆ°ç¬¬ä¸€æ¡ä¸è¦æ·»åŠ åœ¨æ‹’ç»è§„åˆ™â€“reject-with icmp-host-prohibitedè¿™ä¸ªçš„å¦åˆ™ä¸ä¼šç”Ÿæ•ˆ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iptables -I INPUT 1  -p tcp -m state --state NEW -m tcp --dport 9000 -j ACCEPT</span><br></pre></td></tr></table></figure><p>æœ¬æ–‡å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_36074547/article/details/130359377">iptables å¼€æ”¾ç«¯å£åä¾ç„¶æ— æ³•è®¿é—®é—®é¢˜_linux iptableså¼€æ”¾ç«¯å£æ— æ•ˆ-CSDNåšå®¢</a></p><p>å½“åœ¨iptablesä¸­å¼€æ”¾ç«¯å£ä½†ä»ç„¶æ— æ³•è®¿é—®æ—¶ï¼Œå¯èƒ½æ˜¯å› ä¸ºâ€“reject-withicmp-host-prohibitedè§„åˆ™åœ¨æ–°ç«¯å£è§„åˆ™ä¹‹åï¼Œå¯¼è‡´å¼€æ”¾ç«¯å£æ— æ•ˆã€‚è¦è§£å†³æ­¤é—®é¢˜ï¼Œéœ€ç¡®ä¿å¼€æ”¾ç«¯å£çš„è§„åˆ™ä½äºæ‹’ç»è§„åˆ™ä¹‹å‰ä½¿ç”¨service  iptables  saveä¿å­˜ï¼Œç„¶åé‡å¯iptablesæœåŠ¡ã€‚</p><h3 id="iptableså¼€æ”¾ç«¯å£åä»ç„¶æ— æ³•è®¿é—®é—®é¢˜â€“reject-with-icmp-host-prohibited"><a href="#iptableså¼€æ”¾ç«¯å£åä»ç„¶æ— æ³•è®¿é—®é—®é¢˜â€“reject-with-icmp-host-prohibited" class="headerlink" title="iptableså¼€æ”¾ç«¯å£åä»ç„¶æ— æ³•è®¿é—®é—®é¢˜â€“reject-with icmp-host-prohibited"></a>iptableså¼€æ”¾ç«¯å£åä»ç„¶æ— æ³•è®¿é—®é—®é¢˜â€“reject-with icmp-host-prohibited</h3><h3 id="â€“reject-with-icmp-host-prohibited"><a href="#â€“reject-with-icmp-host-prohibited" class="headerlink" title="â€“reject-with icmp-host-prohibited"></a>â€“reject-with icmp-host-prohibited</h3><p>-A INPUT -j REJECT â€“reject-with icmp-host-prohibitedï¼Œè¿™è¡Œå·²æ‹’ç»å…¶ä»–ç«¯å£çš„å‘½ä»¤ï¼Œå¦‚æœæˆ‘ä»¬å°†æ–°æ’å…¥çš„å¼€æ”¾ç«¯å£åœ¨æ”¾åœ¨è¿™è¡Œå‘½ä»¤ä¹‹åçš„æƒ…å†µä¸‹ï¼Œåé¢çš„é…ç½®å¼€æ”¾çš„ç«¯å£æ˜¯ä¸ä¼šè¢«å¯ç”¨çš„ã€‚ä¾‹å¦‚ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-A INPUT -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">-A FORWARD -j REJECT --reject-with icmp-host-prohibited</span><br><span class="line">-A INPUT -m state --state NEW -m tcp -p tcp --dport 8777 -j ACCEPT</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_31e71b55868aa0a566124fd5213429ca.png"></p><p>æ–°å¢iptablesç«¯å£è§„åˆ™æ—¶ï¼Œç”¨ service iptables save è¿™ä¸ªå‘½ä»¤ä¿å­˜è§„åˆ™ä¼šè‡ªåŠ¨æŠŠç³»ç»Ÿå¤–çš„ç«¯å£åŠ åˆ°â€“reject-with icmp-host-prohibited çš„åé¢ï¼Œæ‰€ä»¥åœ¨æ“ä½œæ—¶éœ€è¦ç”¨vim /etc/sysconfig/iptables æŠŠæ–°å¢è§„åˆ™ç¼–è¾‘åˆ°â€“reject-with icmp-host-prohibitedå‰é¢ï¼Œæœ€åé‡å¯iptables service iptables restart</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TCPé˜Ÿåˆ—æ»¡äº†å¯¼è‡´webæ— æ³•è®¿é—®</title>
      <link href="/2025/03/10/TCP%E9%98%9F%E5%88%97%E6%BB%A1%E4%BA%86%E5%AF%BC%E8%87%B4web%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE/"/>
      <url>/2025/03/10/TCP%E9%98%9F%E5%88%97%E6%BB%A1%E4%BA%86%E5%AF%BC%E8%87%B4web%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="TCPé˜Ÿåˆ—æ»¡äº†å¯¼è‡´webæ— æ³•è®¿é—®"><a href="#TCPé˜Ÿåˆ—æ»¡äº†å¯¼è‡´webæ— æ³•è®¿é—®" class="headerlink" title="TCPé˜Ÿåˆ—æ»¡äº†å¯¼è‡´webæ— æ³•è®¿é—®"></a>TCPé˜Ÿåˆ—æ»¡äº†å¯¼è‡´webæ— æ³•è®¿é—®</h2><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/wx170119/p/12068005.html">æ€§èƒ½åˆ†æä¹‹TCPå…¨è¿æ¥é˜Ÿåˆ—å æ»¡é—®é¢˜åˆ†æåŠä¼˜åŒ–è¿‡ç¨‹ï¼ˆè½¬è½½ï¼‰ - å¯’å†°å®‡è‹¥ - åšå®¢å›­</a></p><h3 id="ä»‹ç»ï¼š"><a href="#ä»‹ç»ï¼š" class="headerlink" title="ä»‹ç»ï¼š"></a>ä»‹ç»ï¼š</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_eba7a8290c34f4202f101b972931a190.png"></p><p>ä»å›¾ä¸­æ˜æ˜¾å¯ä»¥çœ‹å‡ºå»ºç«‹ TCP è¿æ¥çš„æ—¶å€™ï¼Œæœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼š<code>syns queue</code>ï¼ˆåŠè¿æ¥é˜Ÿåˆ—ï¼‰å’Œ<code>accept queue</code>ï¼ˆå…¨è¿æ¥é˜Ÿåˆ—ï¼‰ï¼Œåˆ†åˆ«åœ¨ç¬¬ä¸€æ¬¡æ¡æ‰‹å’Œç¬¬ä¸‰æ¬¡æ¡æ‰‹ã€‚<br><strong>åŠè¿æ¥é˜Ÿåˆ—ï¼š</strong> ä¿å­˜ SYN_RECV çŠ¶æ€çš„è¿æ¥ã€‚<br><strong>æ§åˆ¶å‚æ•°ï¼š</strong></p><ul><li>åŠè¿æ¥é˜Ÿåˆ—çš„å¤§å°ï¼šmin(backlog, å†…æ ¸å‚æ•° net.core.somaxconnï¼Œå†…æ ¸å‚æ•°tcp_max_syn_backlog).</li><li>net.ipv4.tcp_max_syn_backlogï¼šèƒ½æ¥å— SYN åŒæ­¥åŒ…çš„æœ€å¤§å®¢æˆ·ç«¯æ•°é‡ï¼Œå³åŠè¿æ¥ä¸Šé™ï¼›</li><li>tcp_syncookiesï¼šå½“å‡ºç°SYNç­‰å¾…é˜Ÿåˆ—æº¢å‡ºæ—¶ï¼Œå¯ç”¨cookiesæ¥å¤„ç†ï¼Œå¯é˜²èŒƒå°‘é‡SYNæ”»å‡»ï¼Œé»˜è®¤ä¸º0ï¼Œè¡¨ç¤ºå…³é—­ï¼›</li></ul><p><strong>accepté˜Ÿåˆ—-å…¨è¿æ¥é˜Ÿåˆ—ï¼š</strong>ä¿å­˜ ESTABLISHED çŠ¶æ€çš„è¿æ¥ã€‚<br><strong>æ§åˆ¶å‚æ•°ï¼š</strong></p><ul><li>å…¨è¿æ¥é˜Ÿåˆ—çš„å¤§å°ï¼šmin(backlog, /proc/sys/net/core/somaxconn)ï¼Œæ„æ€æ˜¯å–backlog ä¸ somaxconn ä¸¤å€¼çš„æœ€å°å€¼ï¼Œ<code>net.core.somaxconn</code> å®šä¹‰äº†ç³»ç»Ÿçº§åˆ«çš„å…¨è¿æ¥é˜Ÿåˆ—æœ€å¤§é•¿åº¦ï¼Œè€Œ backlog åªæ˜¯åº”ç”¨å±‚ä¼ å…¥çš„å‚æ•°ï¼Œæ‰€ä»¥ backlog å€¼å°½é‡å°äº<code>net.core.somaxconn</code>;</li><li><code>net.core.somaxconn</code>(å†…æ ¸æ€å‚æ•°ï¼Œç³»ç»Ÿä¸­æ¯ä¸€ä¸ªç«¯å£æœ€å¤§çš„ç›‘å¬é˜Ÿåˆ—çš„é•¿åº¦);</li><li><code>net.core.netdev_max_backlog</code>(æ¯ä¸ªç½‘ç»œæ¥å£æ¥æ”¶æ•°æ®åŒ…çš„é€Ÿç‡æ¯”å†…æ ¸å¤„ç†è¿™äº›åŒ…çš„é€Ÿç‡å¿«æ—¶ï¼Œå…è®¸é€åˆ°é˜Ÿåˆ—çš„æ•°æ®åŒ…çš„æœ€å¤§æ•°ç›®);</li><li>ServerSocket(int port, int backlog) ä»£ç ä¸­çš„backlogå‚æ•°;</li><li>æ–‡ä»¶å¥æŸ„;</li><li><code>net.ipv4.tcp_abort_on_overflow</code> = 0ï¼Œæ­¤å€¼ä¸º 0 è¡¨ç¤ºæ¡æ‰‹åˆ°ç¬¬ä¸‰æ­¥æ—¶å…¨è¿æ¥é˜Ÿåˆ—æ»¡æ—¶åˆ™æ‰”æ‰ client å‘è¿‡æ¥çš„ ACKï¼Œæ­¤å€¼ä¸º 1 åˆ™è¯´æ˜æ¡æ‰‹åˆ°ç¬¬ä¸‰æ­¥æ—¶å…¨è¿æ¥é˜Ÿåˆ—æ»¡æ—¶åˆ™è¿”å› reset ç»™å®¢æˆ·ç«¯ã€‚</li></ul><h3 id="è§£å†³ï¼š"><a href="#è§£å†³ï¼š" class="headerlink" title="è§£å†³ï¼š"></a>è§£å†³ï¼š</h3><p>TCP è¿æ¥é˜Ÿåˆ—çš„æº¢å‡ºæ•°æ®ç»Ÿè®¡æƒ…å†µï¼Œå‘½ä»¤ä¸ºï¼šâ€œ<code>netstat -s</code>â€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹TCPåŠè¿æ¥é˜Ÿåˆ—æº¢å‡ºï¼š</span></span><br><span class="line">netstat -s | grep LISTEN</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹TCPaccepté˜Ÿåˆ—æº¢å‡ºï¼š</span></span><br><span class="line">netstat -s | grep overflow</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_d50e893c7e2b2767779ca86bb857b0ae.png"></p><p>é€šè¿‡åå¤æ•²å‘½ä»¤ï¼Œå¯ä»¥çœ‹å‡ºè¿™ä¸ª overflow çš„å€¼ä¸€ç›´åœ¨å¢åŠ ï¼Œé‚£ä¹ˆè¿™ä¸ªç°è±¡è¯´æ˜ server çš„TCP å…¨è¿æ¥é˜Ÿåˆ—çš„ç¡®æ˜¯æ»¡äº†ã€‚è¿™æ—¶å€™åº”è¯¥æƒ³åˆ°çš„æ˜¯ï¼Œå…¨è¿æ¥é˜Ÿåˆ—å·²ç»æº¢å‡ºäº†ï¼Œä¸‹ä¸€æ­¥å°±åº”è¯¥çœ‹ä¸€ä¸‹ï¼Œå…¨è¿æ¥é˜Ÿåˆ—çš„å ç”¨æƒ…å†µï¼Œå‘½ä»¤ä¸º:<br><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_a5b95d65c58c598b8e7f7f07bd93d50a.png"></p><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li>Recv-Qï¼šå…¨è¿æ¥å½“å‰é•¿åº¦</li><li>Send-Qï¼šå¦‚æœè¿æ¥ä¸æ˜¯åœ¨å»ºç«‹çŠ¶æ€ï¼Œåˆ™æ˜¯å½“å‰å…¨è¿æ¥æœ€å¤§é˜Ÿåˆ—é•¿åº¦</li></ul><p>ä»ä¸Šå›¾ç¬¬ä¸‰åˆ—çš„ <code>Send-Q</code> å¯ä»¥çœ‹å‡º,5000 ç«¯å£æœåŠ¡çš„å…¨è¿æ¥é˜Ÿåˆ—æœ€å¤§ä¸º 50ï¼Œè€Œ <code>Recv-Q</code> ä¸ºå½“å‰ä½¿ç”¨äº†å¤šå°‘ã€‚åœ¨å‹æµ‹è¿‡ç¨‹ä¸­ï¼ŒæŸ¥çœ‹æŒ‡å®šç«¯å£çš„ TCP å…¨è¿æ¥é˜Ÿåˆ—ä½¿ç”¨æƒ…å†µï¼Œå¦‚ä¸‹:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ss -lnt |grep 5000</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_54bd96472bde73e4d972bb53f3c277c5.png"></p><p>ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œ<strong>å…¨è¿æ¥é˜Ÿåˆ—å‡ ä¹å·²ç»è¢«å æ»¡</strong>ï¼Œé‚£ä¹ˆæœ€ç»ˆå¯ä»¥ç¡®å®šé—®é¢˜æ‰€åœ¨äº†ã€‚æ‰¾åˆ°åŸå› åï¼Œç°åœ¨åªè¦<strong>å¢å¤§å…¨è¿æ¥é˜Ÿåˆ—çš„é•¿åº¦</strong>å°±å¯ä»¥äº†ã€‚<br>é€šè¿‡ä¸Šé¢ä»‹ç»çš„å…¨è¿æ¥é˜Ÿåˆ—ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“å…¨è¿æ¥é˜Ÿåˆ—çš„å¤§å°ä¸º backlog å’Œ somaxconn çš„æœ€å°å€¼ï¼Œé‚£ä¹ˆæ¥çœ‹ä¸‹ somaxconn çš„å–å€¼ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sysctl -a |grep net.core.somaxconn</span><br><span class="line">sysctl -a |grep net.ipv4.tcp_max_syn_backlog</span><br></pre></td></tr></table></figure><p>å¦‚æœå¤ªå°‘åˆ™å¢åŠ å°±è¡Œï¼švim /etc/sysctl.conf</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_f9ba3c306d81b7dfbce878340dd5ac6a.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_b3f5209d1c489737a91f10ea33ee8bc3.png"></p><p>å¯ä»¥çœ‹å‡º somaxconn çš„å€¼æ˜¯å¾ˆå¤§çš„ï¼Œé‚£å°±åªæœ‰é€šçŸ¥å¼€å‘ï¼Œå¢åŠ åº”ç”¨ä»£ç ä¸­çš„ backlog çš„å€¼æ¥åŠ å¤§å…¨è¿æ¥é˜Ÿåˆ—çš„é•¿åº¦ã€‚</p><h3 id="æ‰©å±•ï¼š"><a href="#æ‰©å±•ï¼š" class="headerlink" title="æ‰©å±•ï¼š"></a>æ‰©å±•ï¼š</h3><p>ä¸€ã€æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸‹æ‰€æœ‰è¿æ¥çŠ¶æ€çš„æ•°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">netstat -n|awk <span class="string">&#x27;/^tcp/&#123;++S[\$NF]&#125;END&#123;for (key in S) print key,S[key]&#125;&#x27;</span></span><br><span class="line">ESTABLISHED 38</span><br><span class="line">TIME\_WAIT 1000</span><br></pre></td></tr></table></figure><p>äºŒã€çœ‹ä¸‹æˆ‘ç³»ç»Ÿä¸Šé»˜è®¤çš„SYNé˜Ÿåˆ—å¤§å°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@<span class="built_in">log</span>]<span class="comment"># cat /proc/sys/net/ipv4/tcp\_max\_syn\_backlog</span></span><br><span class="line">262144</span><br><span class="line">å®šä¹‰SYNé˜Ÿåˆ—å¤§å°ï¼š</span><br><span class="line"><span class="built_in">echo</span> 4096 &gt; /proc/sys/net/ipv4/tcp\_max\_syn\_backlog   --å®šä¹‰æ˜¯phpé…ç½®çš„ä¸¤å€ï¼Œå¤§äºphpçš„å°±è¡Œ</span><br></pre></td></tr></table></figure><p>ä¸‰ã€çœ‹ä¸‹æˆ‘ç³»ç»Ÿä¸Šé»˜è®¤çš„TIME_WAITé˜Ÿåˆ—å¤§å°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/sys/net/ipv4/tcp\_max\_tw\_buckets</span><br><span class="line">1000</span><br><span class="line">å®šä¹‰TIME\_WAITçš„å¤§å°ï¼š</span><br><span class="line"><span class="built_in">echo</span> 4096 &gt; /proc/sys/net/ipv4/tcp\_max\_tw\_buckets</span><br></pre></td></tr></table></figure><p>å››ã€ä¿®æ”¹backlogå‚æ•°<br>Kernelä¼šä¸ºLISTENçŠ¶æ€çš„socketç»´æŠ¤ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯SYN RECEIVEDçŠ¶æ€ï¼Œå¦ä¸€ä¸ªæ˜¯ESTABLISHEDçŠ¶æ€ï¼Œè€Œbacklogå°±æ˜¯è¿™ä¸¤ä¸ªé˜Ÿåˆ—çš„å¤§å°ä¹‹å’Œã€‚<br>å½“å‰Linuxç‰ˆæœ¬ä½¿ç”¨ä¸Šé¢è¯´æ³•ï¼Œæœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼šå…·æœ‰ç”±ç³»ç»ŸèŒƒå›´è®¾ç½®æŒ‡å®šçš„å¤§å°çš„SYNé˜Ÿåˆ— å’Œ åº”ç”¨ç¨‹åºï¼ˆä¹Ÿå°±æ˜¯backlogå‚æ•°ï¼‰æŒ‡å®šçš„accepté˜Ÿåˆ—ã€‚</p><p>äº”ã€æŸ¥çœ‹ç³»ç»Ÿé»˜è®¤æ•°é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /proc/sys/net/core/netdev\_max\_backlog</span><br><span class="line">å®šä¹‰é˜Ÿåˆ—çš„æ•°æ®åŒ…çš„æœ€å¤§æ•°ç›®</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;4096&quot;</span>  &gt; /proc/sys/net/core/netdev\_max\_backlog  <span class="comment">#åœ¨æ¯ä¸ªç½‘ç»œæ¥å£æ¥æ”¶æ•°æ®åŒ…çš„é€Ÿç‡æ¯”å†…æ ¸å¤„ç†è¿™äº›åŒ…çš„é€Ÿç‡å¿«æ—¶ï¼Œå…è®¸é€åˆ°é˜Ÿåˆ—çš„æ•°æ®åŒ…çš„æœ€å¤§æ•°ç›®ã€‚</span></span><br></pre></td></tr></table></figure><p>å…­ã€nginx é…ç½®å‚æ•°ä¼˜åŒ–ï¼š<br>æœ‰ä»£ç†å°±è®¾ç½®åœ¨ä»£ç†ä¸Šï¼šæ²¡æœ‰ä»£ç†å°±ç›´æ¥è®¾ç½®åœ¨webåº”ç”¨ä¸Šï¼ˆæˆ–è€…ä¸¤ä¸ªéƒ½è®¾ç½®ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">upstream js\_sdk &#123;</span><br><span class="line"><span class="comment">#ip\_hash;</span></span><br><span class="line">server \*\*\*\*\*\*\* weight=1 max\_fails=3 fail\_timeout=10s;</span><br><span class="line">server \*\*\*\*\*\*\* weight=1 max\_fails=3 fail\_timeout=10s;</span><br><span class="line">keepalive 1000;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 80 default backlog=1024;</span><br><span class="line">    listen 443 ssl default backlog=1024;</span><br></pre></td></tr></table></figure><p>ä¸ƒã€phpä¼˜åŒ–ï¼šï¼ˆ-1  è¡¨ç¤ºæ²¡æœ‰ä½¿ç”¨ç³»ç»Ÿçš„ backlog ï¼‰<br>vim /usr/local/php/etc/php-fpm.conf</p><p>listen.backlog = 2048   #æ¯ä¸€ä¸ªç«¯å£æœ€å¤§çš„ç›‘å¬é˜Ÿåˆ—çš„é•¿åº¦,éœ€è¦é…ç½®nginxé…ç½®æ–‡ä»¶ä½¿ç”¨ï¼Œå¦‚ä¸‹ï¼ˆæš‚æ—¶åªæ›´æ”¹è¿™é‡Œï¼‰<br>å…«ã€linuxå†…æ ¸å‚è¿›è¡Œä¼˜åŒ–ï¼š<br>vim /etc/sysctl.conf</p><p> net.ipv4.tcp_syncookies = 1<br> net.ipv4.tcp_max_syn_backlog = 4096  #å¯¹äºè¿˜æœªè·å¾—å¯¹æ–¹ç¡®è®¤çš„è¿æ¥è¯·æ±‚ï¼Œå¯ä¿å­˜åœ¨é˜Ÿåˆ—ä¸­çš„æœ€å¤§æ•°ç›®ã€‚å¦‚æœæœåŠ¡å™¨ç»å¸¸å‡ºç°è¿‡è½½ï¼Œå¯ä»¥å°è¯•å¢åŠ è¿™ä¸ªæ•°å­—ã€‚<br> net.core.somaxconn = 4096   #å®šä¹‰äº†ç³»ç»Ÿä¸­æ¯ä¸€ä¸ªç«¯å£æœ€å¤§çš„ç›‘å¬é˜Ÿåˆ—çš„é•¿åº¦ï¼Œè¿™æ˜¯ä¸ªå…¨å±€çš„å‚æ•°ã€‚backlogéœ€è¦è®¾ç½®è¿™ä¸ª</p><p>ä½¿ç”¨å‘½ä»¤ä½¿ä¹‹ç”Ÿæ•ˆï¼šsysctl -p<br>è½¬è‡ªï¼š<a href="https://blog.csdn.net/u010917150/article/details/95621873">https://blog.csdn.net/u010917150/article/details/95621873</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>sshæ…¢æŠ¥é”™org.freedesktop.login1timed Outé—®é¢˜</title>
      <link href="/2025/03/02/ssh%E6%85%A2%E6%8A%A5%E9%94%99org.freedesktop.login1timed%20Out%E9%97%AE%E9%A2%98/"/>
      <url>/2025/03/02/ssh%E6%85%A2%E6%8A%A5%E9%94%99org.freedesktop.login1timed%20Out%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="sshæ…¢æŠ¥é”™org-freedesktop-login1timed-Outé—®é¢˜"><a href="#sshæ…¢æŠ¥é”™org-freedesktop-login1timed-Outé—®é¢˜" class="headerlink" title="sshæ…¢æŠ¥é”™org.freedesktop.login1timed Outé—®é¢˜"></a>sshæ…¢æŠ¥é”™org.freedesktop.login1timed Outé—®é¢˜</h2><p>åŸå› ï¼š</p><ul><li>systemd-logind      è¿›ç¨‹å´©æºƒæˆ–æœªæ­£å¸¸è¿è¡Œ</li><li>systemd-logind      è´Ÿè´£ç®¡ç†ç”¨æˆ·ç™»å½•ä¼šè¯ï¼Œå¦‚æœå®ƒå´©æºƒæˆ–æ— æ³•å¯åŠ¨ï¼ŒSSH ä¼šè¯åˆ›å»ºå¯èƒ½ä¼šè¶…æ—¶ã€‚</li><li>D-Bus ç›¸å…³é—®é¢˜</li><li>systemd-logind      ä¾èµ– dbusï¼Œå¦‚æœ dbus æœåŠ¡å¼‚å¸¸ï¼Œä¹Ÿä¼šå¯¼è‡´ SSH è®¤è¯è¶…æ—¶ã€‚</li><li>ç³»ç»Ÿèµ„æºä¸è¶³ï¼ˆCPU/å†…å­˜å ç”¨è¿‡é«˜ï¼‰ï¼ˆæ’é™¤ï¼‰</li><li>å¦‚æœç³»ç»Ÿè´Ÿè½½è¿‡é«˜ï¼Œå¯¼è‡´      systemd-logind å“åº”å˜æ…¢ï¼ŒSSH ç™»å½•ä¼šå˜å¾—å¼‚å¸¸ç¼“æ…¢ã€‚ï¼ˆæ’é™¤ï¼‰</li></ul><p>æ’æŸ¥æ–¹æ¡ˆæ€è€ƒï¼š</p><p>1ã€çœ‹cpuå†…å­˜ç­‰èµ„æºå ç”¨æƒ…å†µ ï¼ˆæ­£å¸¸ï¼‰</p><p>2ã€ç½‘ç»œå¸¦å®½å ç”¨æƒ…å†µï¼šiftopã€bandwhichã€nethogsã€é•¿pingç­‰ ï¼ˆæ­£å¸¸ï¼‰</p><p>3ã€çœ‹æ˜¯ä¸æ˜¯æœ‰å¼‚å¸¸çš„IPåœ°å€è®¿é—®æœåŠ¡å™¨ ï¼ˆæ­£å¸¸ï¼‰</p><p>4ã€æ’æŸ¥æœåŠ¡ï¼ˆå¼‚å¸¸ï¼‰</p><h2 id="ç°è±¡ä¸æ•…éšœæ’æŸ¥ï¼š"><a href="#ç°è±¡ä¸æ•…éšœæ’æŸ¥ï¼š" class="headerlink" title="ç°è±¡ä¸æ•…éšœæ’æŸ¥ï¼š"></a>ç°è±¡ä¸æ•…éšœæ’æŸ¥ï¼š</h2><p>ssh -v 192.168.100.10</p><p>journalctl -u sshd -f</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_14f9b56791e96a5ed113252939e65d4d.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/3/image_dea227b9c112edcfe113455ef77ad6c2.png"></p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>åˆ é™¤machine-idåé‡å¯å„ä¸ªç›¸å…³æœåŠ¡<br>rm -rf /etc/machine-id</p><p>systemd-machine-id-setup</p><p>systemctl restart dbus</p><p>systemctl restart systemd-logind</p><p>systemctl restart sshd</p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wslå®‰è£…çš„ubuntu20.04å­ç³»ç»ŸäºŒè¿›åˆ¶éƒ¨ç½²ollamaå®ç°ç›´é€šåº•å±‚1050tiåŠopen-webuiç¯å¢ƒå˜é‡é—®é¢˜</title>
      <link href="/2025/02/10/Wsl%E5%AE%89%E8%A3%85%E7%9A%84ubuntu20.04%E5%AD%90%E7%B3%BB%E7%BB%9F%E4%BA%8C%E8%BF%9B%E5%88%B6%E9%83%A8%E7%BD%B2ollama%E5%AE%9E%E7%8E%B0%E7%9B%B4%E9%80%9A%E5%BA%95%E5%B1%821050ti%E5%8F%8Aopen-webui%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%97%AE%E9%A2%98/"/>
      <url>/2025/02/10/Wsl%E5%AE%89%E8%A3%85%E7%9A%84ubuntu20.04%E5%AD%90%E7%B3%BB%E7%BB%9F%E4%BA%8C%E8%BF%9B%E5%88%B6%E9%83%A8%E7%BD%B2ollama%E5%AE%9E%E7%8E%B0%E7%9B%B4%E9%80%9A%E5%BA%95%E5%B1%821050ti%E5%8F%8Aopen-webui%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="wslå®‰è£…çš„ubuntu20-04å­ç³»ç»ŸäºŒè¿›åˆ¶éƒ¨ç½²ollamaå®ç°ç›´é€šåº•å±‚1050tiåŠopen-webuiç¯å¢ƒå˜é‡é—®é¢˜"><a href="#wslå®‰è£…çš„ubuntu20-04å­ç³»ç»ŸäºŒè¿›åˆ¶éƒ¨ç½²ollamaå®ç°ç›´é€šåº•å±‚1050tiåŠopen-webuiç¯å¢ƒå˜é‡é—®é¢˜" class="headerlink" title="wslå®‰è£…çš„ubuntu20.04å­ç³»ç»ŸäºŒè¿›åˆ¶éƒ¨ç½²ollamaå®ç°ç›´é€šåº•å±‚1050tiåŠopen-webuiç¯å¢ƒå˜é‡é—®é¢˜"></a>wslå®‰è£…çš„ubuntu20.04å­ç³»ç»ŸäºŒè¿›åˆ¶éƒ¨ç½²ollamaå®ç°ç›´é€šåº•å±‚1050tiåŠopen-webuiç¯å¢ƒå˜é‡é—®é¢˜</h2><p>å¼€å§‹æœ¬æ–‡å‰éœ€è¦å…ˆä½¿ç”¨Wslå®‰è£…å¥½ubuntu20.04LTS:</p><ul><li><a href="https://sunlight.zznnwn.cloudns.biz/2025/02/10/windows11%E4%BD%BF%E7%94%A8wsl%E5%AE%89%E8%A3%85ubuntu20.04%E5%B9%B6%E5%AE%89%E8%A3%851050ti%E9%A9%B1%E5%8A%A8/">windows11ä½¿ç”¨wslå®‰è£…ubuntu20.04å¹¶å®‰è£…1050tié©±åŠ¨</a></li><li><a href="https://sunlight.zznnwn.cloudns.biz/2024/09/05/windows11%E4%BD%BF%E7%94%A8docker%E9%83%A8%E7%BD%B2ollama%E8%B0%83%E7%94%A8%E5%BA%95%E5%B1%82GPU/index.html?_sw-precache=7949b2ffa05f974aeb8530f0ce185b97">windows11ä½¿ç”¨dockeréƒ¨ç½²ollamaè°ƒç”¨åº•å±‚GPU</a></li></ul><p>éƒ¨ç½²ï¼šç•¥</p><p>open-webuiéƒ¨ç½²ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d -p 8080:8080 --privileged=<span class="literal">true</span> -e OLLAMA_BASE_URL=http://172.31.63.55:11434 -e ENABLE_SIGNUP=<span class="literal">true</span> -e ENABLE_OPENAI_API=False -v open-webui:/app/backend/data --name open-webui --restart always registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:open-webui-main</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows11ä½¿ç”¨wslå®‰è£…ubuntu20.04å¹¶å®‰è£…1050tié©±åŠ¨</title>
      <link href="/2025/02/10/windows11%E4%BD%BF%E7%94%A8wsl%E5%AE%89%E8%A3%85ubuntu20.04%E5%B9%B6%E5%AE%89%E8%A3%851050ti%E9%A9%B1%E5%8A%A8/"/>
      <url>/2025/02/10/windows11%E4%BD%BF%E7%94%A8wsl%E5%AE%89%E8%A3%85ubuntu20.04%E5%B9%B6%E5%AE%89%E8%A3%851050ti%E9%A9%B1%E5%8A%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="windows11ä½¿ç”¨wslå®‰è£…ubuntu20-04å¹¶å®‰è£…1050tié©±åŠ¨"><a href="#windows11ä½¿ç”¨wslå®‰è£…ubuntu20-04å¹¶å®‰è£…1050tié©±åŠ¨" class="headerlink" title="windows11ä½¿ç”¨wslå®‰è£…ubuntu20.04å¹¶å®‰è£…1050tié©±åŠ¨"></a>windows11ä½¿ç”¨wslå®‰è£…ubuntu20.04å¹¶å®‰è£…1050tié©±åŠ¨</h1><p>å‚è€ƒï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/689473287">NVIDIA Container Toolkit(NVIDIA Docker)å®‰è£…æ•™ç¨‹ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://link.zhihu.com/?target=https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/install-guide.html%23installing-on-ubuntu-and-debian">nvidiaå®˜ç½‘æ“ä½œæ•™ç¨‹</a></p><p><a href="https://sunlight.zznnwn.cloudns.biz/2024/09/05/windows11%E4%BD%BF%E7%94%A8docker%E9%83%A8%E7%BD%B2ollama%E8%B0%83%E7%94%A8%E5%BA%95%E5%B1%82GPU/?highlight=ollama">æœ¬åšå®¢æ•™ç¨‹</a></p><p>æœ¬æ•™ç¨‹ç¯å¢ƒï¼š</p><p>windows11ä¸Šä½¿ç”¨wslå®‰è£…çš„ubunto20.04LTS æ˜¾å¡ Goforce 1050ti</p><h2 id="å®‰è£…NVIDIA-Container-Toolkit-NVIDIA-Docker"><a href="#å®‰è£…NVIDIA-Container-Toolkit-NVIDIA-Docker" class="headerlink" title="å®‰è£…NVIDIA Container Toolkit(NVIDIA Docker)"></a>å®‰è£…NVIDIA Container Toolkit(NVIDIA Docker)</h2><h3 id="å¹³å°è¦æ±‚"><a href="#å¹³å°è¦æ±‚" class="headerlink" title="å¹³å°è¦æ±‚"></a>å¹³å°è¦æ±‚</h3><ul><li>å†…æ ¸ç‰ˆæœ¬ &gt; 3.10 çš„ GNU/Linux x86_64</li><li>Docker &gt;= 19.03ï¼ˆæ¨èï¼Œä½†æŸäº›å‘è¡Œç‰ˆå¯èƒ½åŒ…å«æ—§ç‰ˆæœ¬çš„ Dockerã€‚æ”¯æŒçš„æœ€ä½ç‰ˆæœ¬ä¸º 1.12)</li><li>GPUæ¶æ„ &gt;= Keplerï¼ˆæˆ–è®¡ç®—èƒ½åŠ› 3.0ï¼‰çš„ NVIDIA GPU</li><li>NVIDIA Linux <a href="https://zhida.zhihu.com/search?content_id=241346902&content_type=Article&match_order=1&q=%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F&zhida_source=entity">é©±åŠ¨ç¨‹åº</a>&gt;= 520.56.06 (è¯·æ³¨æ„ï¼Œä¸æ”¯æŒè¾ƒæ—§çš„é©±åŠ¨ç¨‹åºç‰ˆæœ¬æˆ–åˆ†æ”¯ã€‚ï¼‰</li></ul><h3 id="å®‰è£…NVIDIA-DRIVE-Base-apt"><a href="#å®‰è£…NVIDIA-DRIVE-Base-apt" class="headerlink" title="å®‰è£…NVIDIA-DRIVE(Base apt)"></a>å®‰è£…NVIDIA-DRIVE(Base apt)</h3><p>1.æ·»åŠ  PPA æºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo add-apt-repository ppa:graphics-drivers/ppa</span><br></pre></td></tr></table></figure><p>2.ä¸ºç³»ç»Ÿå®‰è£…ä¾èµ–é¡¹ä»¥æ„å»ºå†…æ ¸æ¨¡å—ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install dkms build-essential</span><br></pre></td></tr></table></figure><p>3.æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œæ˜¾ç¤ºå½“å‰è®¾å¤‡æ”¯æŒé©±åŠ¨çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ubuntu-drivers devices</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(base) xuehao@xuehao-Z370-HD3:~$ ubuntu-drivers devices</span><br><span class="line">== /sys/devices/pci0000:00/0000:00:01.0/0000:01:00.0 ==</span><br><span class="line">modalias : pci:v000010DEd00001C82sv00007377sd00000000bc03sc00i00</span><br><span class="line">vendor   : NVIDIA Corporation</span><br><span class="line">model    : GP107 [GeForce GTX 1050 Ti]</span><br><span class="line">driver   : nvidia-driver-525 - distro non-free recommended</span><br><span class="line">driver   : nvidia-driver-470 - distro non-free</span><br><span class="line">driver   : nvidia-driver-515-server - distro non-free</span><br><span class="line">driver   : nvidia-driver-470-server - distro non-free</span><br><span class="line">driver   : nvidia-driver-510 - distro non-free</span><br><span class="line">driver   : nvidia-driver-418-server - distro non-free</span><br><span class="line">driver   : nvidia-driver-525-server - distro non-free</span><br><span class="line">driver   : nvidia-driver-515 - distro non-free</span><br><span class="line">driver   : nvidia-driver-450-server - distro non-free</span><br><span class="line">driver   : nvidia-driver-390 - distro non-free</span><br><span class="line">driver   : xserver-xorg-video-nouveau - distro free <span class="built_in">builtin</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4.å®‰è£…æŒ‡å®šç‰ˆæœ¬é©±åŠ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install nvidia-driver-525</span><br></pre></td></tr></table></figure><p>5.é‡å¯è®¾å¤‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure><p>6.æ‰§è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi</span><br></pre></td></tr></table></figure><p>æ‰“å°ä»¥ä¸‹ä¿¡æ¯åˆ™å®‰è£…æˆåŠŸï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">(base) xuehao@xuehao-Z370-HD3:~$ nvidia-smi</span><br><span class="line">Mon Feb  6 09:55:22 2023   </span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| NVIDIA-SMI 525.78.01    Driver Version: 525.78.01    CUDA Version: 12.0     |</span><br><span class="line">|-------------------------------+----------------------+----------------------+</span><br><span class="line">| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |</span><br><span class="line">| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |</span><br><span class="line">|                               |                      |               MIG M. |</span><br><span class="line">|===============================+======================+======================|</span><br><span class="line">|   0  NVIDIA GeForce ...  Off  | 00000000:01:00.0  On |                  N/A |</span><br><span class="line">| 45%   36C    P0    N/A /  75W |    555MiB /  4096MiB |      8%      Default |</span><br><span class="line">|                               |                      |                  N/A |</span><br><span class="line">+-------------------------------+----------------------+----------------------+</span><br><span class="line">                                                                           </span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| Processes:                                                                  |</span><br><span class="line">|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |</span><br><span class="line">|        ID   ID                                                   Usage      |</span><br><span class="line">|=============================================================================|</span><br><span class="line">|    0   N/A  N/A      1084      G   /usr/lib/xorg/Xorg                 59MiB |</span><br><span class="line">|    0   N/A  N/A      1800      G   /usr/lib/xorg/Xorg                220MiB |</span><br><span class="line">|    0   N/A  N/A      1926      G   /usr/bin/gnome-shell               39MiB |</span><br><span class="line">|    0   N/A  N/A     49745      G   ...RendererForSitePerProcess       83MiB |</span><br><span class="line">|    0   N/A  N/A     60087      G   ...079604264900979074,131072      141MiB |</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…-NVIDIA-å®¹å™¨å·¥å…·åŒ…ï¼ˆNVIDIA-Container-Toolkitï¼‰"><a href="#å®‰è£…-NVIDIA-å®¹å™¨å·¥å…·åŒ…ï¼ˆNVIDIA-Container-Toolkitï¼‰" class="headerlink" title="å®‰è£… NVIDIA å®¹å™¨å·¥å…·åŒ…ï¼ˆNVIDIA Container Toolkitï¼‰"></a>å®‰è£… NVIDIA å®¹å™¨å·¥å…·åŒ…ï¼ˆNVIDIA Container Toolkitï¼‰</h3><p>1.è®¾ç½®åŒ…å­˜å‚¨åº“å’Œ GPG å¯†é’¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">distribution=$(. /etc/os-release;<span class="built_in">echo</span> $ID<span class="variable">$VERSION_ID</span>) \</span><br><span class="line">      &amp;&amp; curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \</span><br><span class="line">      &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/<span class="variable">$distribution</span>/libnvidia-container.list | \</span><br><span class="line">            sed <span class="string">&#x27;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#x27;</span> | \</span><br><span class="line">            sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/nvidia-container-toolkit.list</span><br></pre></td></tr></table></figure><p>2.æ›´æ–°åŒ…åˆ—è¡¨åå®‰è£…nvidia-docker2åŒ…ï¼ˆå’Œä¾èµ–é¡¹ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install -y nvidia-docker2</span><br></pre></td></tr></table></figure><p>3.è®¾ç½®é»˜è®¤è¿è¡Œæ—¶åé‡å¯ Docker å®ˆæŠ¤è¿›ç¨‹å®Œæˆå®‰è£…ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><p>4.æ­¤æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿è¡ŒåŸºæœ¬ CUDA å®¹å™¨æ¥æµ‹è¯•å·¥ä½œè®¾ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run --<span class="built_in">rm</span> --gpus all nvidia/cuda:11.6.2-base-ubuntu20.04 nvidia-smi</span><br></pre></td></tr></table></figure><p>è¿™åº”è¯¥ä¼šäº§ç”Ÿå¦‚ä¸‹æ‰€ç¤ºçš„æ§åˆ¶å°è¾“å‡ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| NVIDIA-SMI 450.51.06    Driver Version: 450.51.06    CUDA Version: 11.0     |</span><br><span class="line">|-------------------------------+----------------------+----------------------+</span><br><span class="line">| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |</span><br><span class="line">| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |</span><br><span class="line">|                               |                      |               MIG M. |</span><br><span class="line">|===============================+======================+======================|</span><br><span class="line">|   0  Tesla T4            On   | 00000000:00:1E.0 Off |                    0 |</span><br><span class="line">| N/A   34C    P8     9W /  70W |      0MiB / 15109MiB |      0%      Default |</span><br><span class="line">|                               |                      |                  N/A |</span><br><span class="line">+-------------------------------+----------------------+----------------------+</span><br><span class="line"></span><br><span class="line">+-----------------------------------------------------------------------------+</span><br><span class="line">| Processes:                                                                  |</span><br><span class="line">|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |</span><br><span class="line">|        ID   ID                                                   Usage      |</span><br><span class="line">|=============================================================================|</span><br><span class="line">|  No running processes found                                                 |</span><br><span class="line">+-----------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure><h3 id="æ‰©å±•wslå‘½ä»¤ç®€å•ä½¿ç”¨åŠwslå®‰è£…çš„ubuntuçš„å¤‡ä»½ä¸è¿˜åŸ"><a href="#æ‰©å±•wslå‘½ä»¤ç®€å•ä½¿ç”¨åŠwslå®‰è£…çš„ubuntuçš„å¤‡ä»½ä¸è¿˜åŸ" class="headerlink" title="æ‰©å±•wslå‘½ä»¤ç®€å•ä½¿ç”¨åŠwslå®‰è£…çš„ubuntuçš„å¤‡ä»½ä¸è¿˜åŸ"></a>æ‰©å±•wslå‘½ä»¤ç®€å•ä½¿ç”¨åŠwslå®‰è£…çš„ubuntuçš„å¤‡ä»½ä¸è¿˜åŸ</h3><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/Chary/p/18011740">wsl2å­ç³»ç»Ÿçš„å¤‡ä»½å’Œè¿˜åŸ - CharyGao - åšå®¢å›­ (cnblogs.com)</a></p><h4 id="wsl2å­ç³»ç»Ÿçš„å¤‡ä»½å’Œè¿˜åŸ"><a href="#wsl2å­ç³»ç»Ÿçš„å¤‡ä»½å’Œè¿˜åŸ" class="headerlink" title="wsl2å­ç³»ç»Ÿçš„å¤‡ä»½å’Œè¿˜åŸ"></a><a href="https://www.cnblogs.com/Chary/p/18011740" title="å‘å¸ƒäº 2024-02-08 13:39">wsl2å­ç³»ç»Ÿçš„å¤‡ä»½å’Œè¿˜åŸ</a></h4><h4 id="æŸ¥çœ‹å½“å‰WSLç‰ˆæœ¬"><a href="#æŸ¥çœ‹å½“å‰WSLç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹å½“å‰WSLç‰ˆæœ¬"></a>æŸ¥çœ‹å½“å‰<a href="https://so.csdn.net/so/search?q=WSL&spm=1001.2101.3001.7020">WSL</a>ç‰ˆæœ¬</h4><p>æŸ¥çœ‹æœ‰å“ªäº›å¯ä»¥å®‰è£…çš„ç³»ç»Ÿ</p><p><code>wsl --list --online</code></p><p><code>wsl -l</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\system32&gt; wsl -l</span><br><span class="line"></span><br><span class="line">é€‚ç”¨äº Linux çš„ Windows å­ç³»ç»Ÿåˆ†å‘:</span><br><span class="line">Ubuntu-22.04 (é»˜è®¤)</span><br></pre></td></tr></table></figure><p><code>wsl --version</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\system32&gt; wsl --version</span><br><span class="line"></span><br><span class="line">WSL ç‰ˆæœ¬ï¼š 1.2.5.0</span><br><span class="line">å†…æ ¸ç‰ˆæœ¬ï¼š 5.15.90.1</span><br><span class="line">WSLg ç‰ˆæœ¬ï¼š 1.0.51</span><br><span class="line">MSRDC ç‰ˆæœ¬ï¼š 1.2.3770</span><br><span class="line">Direct3D ç‰ˆæœ¬ï¼š 1.608.2-61064218</span><br><span class="line">DXCore ç‰ˆæœ¬ï¼š 10.0.25131.1002-220531-1700.rs-onecore-base2-hyp</span><br><span class="line">Windows ç‰ˆæœ¬ï¼š 10.0.19045.2965</span><br></pre></td></tr></table></figure><h4 id="æŸ¥çœ‹è¿è¡Œä¸­çš„å­ç³»ç»Ÿ"><a href="#æŸ¥çœ‹è¿è¡Œä¸­çš„å­ç³»ç»Ÿ" class="headerlink" title="æŸ¥çœ‹è¿è¡Œä¸­çš„å­ç³»ç»Ÿ"></a>æŸ¥çœ‹è¿è¡Œä¸­çš„å­ç³»ç»Ÿ</h4><p><code>wsl -l --running</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\system32&gt; wsl -l --running</span><br><span class="line">æ²¡æœ‰æ­£åœ¨è¿è¡Œçš„åˆ†å‘ã€‚</span><br></pre></td></tr></table></figure><h4 id="è¿è¡Œå­ç³»ç»Ÿ"><a href="#è¿è¡Œå­ç³»ç»Ÿ" class="headerlink" title="è¿è¡Œå­ç³»ç»Ÿ"></a>è¿è¡Œå­ç³»ç»Ÿ</h4><p><code>wsl --distribution Ubuntu-22.04</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\system32&gt; wsl --distribution Ubuntu-22.04</span><br><span class="line"></span><br><span class="line">Welcome to Ubuntu 22.04.2 LTS (GNU/Linux 5.15.90.1-microsoft-standard-WSL2 x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line"> * Strictly confined Kubernetes makes edge and IoT secure. Learn how MicroK8s</span><br><span class="line">   just raised the bar for easy, resilient and secure K8s cluster deployment.</span><br><span class="line"></span><br><span class="line">   https://ubuntu.com/engage/secure-kubernetes-at-the-edge</span><br><span class="line"></span><br><span class="line">This message is shown once a day. To disable it please create the</span><br><span class="line">/home/yang/.hushlogin file.</span><br></pre></td></tr></table></figure><h4 id="åœæ­¢å­ç³»ç»Ÿ"><a href="#åœæ­¢å­ç³»ç»Ÿ" class="headerlink" title="åœæ­¢å­ç³»ç»Ÿ"></a>åœæ­¢å­ç³»ç»Ÿ</h4><p><code>wsl --terminate Ubuntu-22.04</code> æˆ– <code>wsl --shutdown</code> (åœæ­¢å½“å‰å­ç³»ç»Ÿ)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\system32&gt; wsl --terminate Ubuntu-22.04</span><br><span class="line"></span><br><span class="line">æ“ä½œæˆåŠŸå®Œæˆã€‚</span><br></pre></td></tr></table></figure><h4 id="å¤‡ä»½å­ç³»ç»Ÿï¼ˆéœ€è¦å…ˆåœæ­¢æ‰èƒ½å¤‡ä»½ï¼‰"><a href="#å¤‡ä»½å­ç³»ç»Ÿï¼ˆéœ€è¦å…ˆåœæ­¢æ‰èƒ½å¤‡ä»½ï¼‰" class="headerlink" title="å¤‡ä»½å­ç³»ç»Ÿï¼ˆéœ€è¦å…ˆåœæ­¢æ‰èƒ½å¤‡ä»½ï¼‰"></a>å¤‡ä»½å­ç³»ç»Ÿï¼ˆéœ€è¦å…ˆåœæ­¢æ‰èƒ½å¤‡ä»½ï¼‰</h4><p><code>wsl --export Ubuntu-22.04 D:\temp\Ubuntu-22.04.tar</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">PS C:\windows\system32&gt; wsl --export Ubuntu-22.04 D:\temp\Ubuntu-22.04.tar</span><br><span class="line"></span><br><span class="line">æ­£åœ¨å¯¼å‡ºï¼Œè¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´ã€‚</span><br><span class="line">æ“ä½œæˆåŠŸå®Œæˆã€‚</span><br></pre></td></tr></table></figure><h4 id="å¸è½½å­ç³»ç»Ÿ"><a href="#å¸è½½å­ç³»ç»Ÿ" class="headerlink" title="å¸è½½å­ç³»ç»Ÿ"></a>å¸è½½å­ç³»ç»Ÿ</h4><p><code>wsl --unregister Ubuntu-22.04</code></p><h4 id="è¿˜åŸå­ç³»ç»Ÿ"><a href="#è¿˜åŸå­ç³»ç»Ÿ" class="headerlink" title="è¿˜åŸå­ç³»ç»Ÿ"></a>è¿˜åŸå­ç³»ç»Ÿ</h4><p><code>wsl --import &lt;Distro&gt; &lt;InstallLocation&gt; &lt;FileName&gt; [Options]</code></p><p><code>wsl --import Ubuntu-22.04 C:\WSL D:\temp\Ubuntu-22.04.tar</code></p><p><strong>Note: å½“è¿˜åŸåçš„å­ç³»ç»Ÿå˜ä¸ºrootæƒé™äº†</strong></p><h4 id="æ”¹ä¸ºé»˜è®¤ç”¨æˆ·æƒé™"><a href="#æ”¹ä¸ºé»˜è®¤ç”¨æˆ·æƒé™" class="headerlink" title="æ”¹ä¸ºé»˜è®¤ç”¨æˆ·æƒé™"></a>æ”¹ä¸ºé»˜è®¤ç”¨æˆ·æƒé™</h4><ol><li>æŸ¥çœ‹å½“å‰ç”¨æˆ· <code>ls /home/</code></li><li>å°è¯•åˆ‡æ¢è‡³ç”¨æˆ·æƒé™ <code>su ç”¨æˆ·å</code></li><li>åˆ‡æ¢è‡³<a href="https://so.csdn.net/so/search?q=root%E6%9D%83%E9%99%90&spm=1001.2101.3001.7020">rootæƒé™</a><code>sudo su</code></li><li>ä¿®æ”¹é»˜è®¤é…ç½®æ–‡ä»¶<ol><li>å¤‡ä»½ <code>cp /etc/wsl.conf /etc/wsl.conf.bk</code></li><li>ä¿®æ”¹ <code>vim /etc/wsl.conf</code> åœ¨æœ€å‰é¢å¢åŠ ä»¥ä¸‹å†…å®¹<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[user]</span><br><span class="line">default=ç”¨æˆ·å </span><br></pre></td></tr></table></figure></li><li>é‡å¯wslï¼Œåœ¨power shellä¸­é‡å¯<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹å½“å‰è¿è¡Œçš„wsl</span><br><span class="line">wsl --list --running</span><br><span class="line"></span><br><span class="line"># åœæ­¢ç‰¹å®šçš„wsl</span><br><span class="line">wsl -t Ubuntu-22.04</span><br><span class="line"># å¯åŠ¨ç‰¹å®šç‰ˆæœ¬wsl</span><br><span class="line">wsl -d Ubuntu-22.04</span><br><span class="line"></span><br><span class="line">#æˆ–è€…</span><br><span class="line"># åœæ­¢å½“å‰æ‰€æœ‰è¿è¡Œwsl</span><br><span class="line">wsl --shutdowm</span><br><span class="line"># å¯åŠ¨é»˜è®¤wsl</span><br><span class="line">wsl</span><br></pre></td></tr></table></figure></li></ol></li></ol><h2 id="wsl2è¿ç§»ä¸æ¢å¤"><a href="#wsl2è¿ç§»ä¸æ¢å¤" class="headerlink" title="wsl2è¿ç§»ä¸æ¢å¤"></a>wsl2è¿ç§»ä¸æ¢å¤</h2><p>æ­¤å¤„è®°å½•ä¸€ä¸‹wsl2çš„è¿ç§»ï¼Œä»¥åŠå½“åœ¨ç³»ç»ŸCç›˜é‡ç½®ç³»ç»Ÿå¦‚ä½•æ¢å¤æ—§ç‰ˆwsl2</p><h3 id="wsl2è¿ç§»"><a href="#wsl2è¿ç§»" class="headerlink" title="wsl2è¿ç§»"></a>wsl2è¿ç§»</h3><p>è¿™ä¸ªæ˜¯å»ºç«‹åœ¨å·²ç»å®‰è£…wsl2çš„åŸºç¡€ä¹‹ä¸Š</p><p>1.æŸ¥çœ‹å½“å‰wslä¸‹çš„Linuxæ˜¯å¦ä¸ºå…³é—­çŠ¶æ€ï¼Œå½“stateä¸ºStoppedæ‰èƒ½è¿›è¡Œä¸‹ä¸€æ­¥ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl -l -v  </span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/35ce5aa0dea44e0ab976a58404001362.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>è‹¥stateä¸ºRunningæ—¶ï¼Œåˆ©ç”¨ä¸‹é¢çš„å‘½ä»¤ç»“æŸ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --shutdown</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/d35fdc6412f1407a897cfa0e304af7a1.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>2.ä»¥.tarçš„å½¢å¼å¯¼å‡ºåˆ°å…¶ä»–ç›˜</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --<span class="keyword">export</span> <span class="title class_">Ubuntu</span>-<span class="number">20.04</span> <span class="attr">e</span>:\<span class="title class_">Ubuntu</span>-<span class="number">20.04</span>.<span class="property">tar</span></span><br></pre></td></tr></table></figure><p>ã€æ³¨ã€‘æ­¤å¤„å¯¼å‡ºçš„==Ubuntu-20.04.tar==æ–‡ä»¶å¯ä»¥ä½œä¸ºå¤‡ä»½æ–‡ä»¶ï¼Œä¸‹æ¬¡æ¢å¤æ—¶ç›´æ¥æ‰§è¡Œç¬¬4æ­¥çš„å¯¼å…¥ç³»ç»Ÿå°±è¡Œ</p><p>3.æ³¨é”€åŸæœ‰çš„<a href="https://so.csdn.net/so/search?q=linux%E7%B3%BB%E7%BB%9F&spm=1001.2101.3001.7020">linuxç³»ç»Ÿ</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --unregister <span class="title class_">Ubuntu</span>-<span class="number">20.04</span></span><br></pre></td></tr></table></figure><p>4.å¯¼å…¥ç³»ç»Ÿ</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --<span class="keyword">import</span> <span class="title class_">Ubuntu</span>-<span class="number">20.04</span> <span class="attr">E</span>:\ubuntu2004 <span class="attr">E</span>:\<span class="title class_">Ubuntu</span>-<span class="number">20.04</span>.<span class="property">tar</span></span><br></pre></td></tr></table></figure><p>5.ä¿®æ”¹é»˜è®¤ç”¨æˆ·ï¼ˆå› ä¸ºä¸ä¿®æ”¹ç”¨æˆ·åï¼Œæ‰“å¼€wsl ubuntuä¹‹åï¼Œé»˜è®¤ä»¥rootèº«ä»½ç™»å½•ã€‚ï¼‰</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ubuntu.<span class="property">exe</span> config --<span class="keyword">default</span>-user &lt;--ç”¨æˆ·å--&gt;</span><br></pre></td></tr></table></figure><p><strong>ç”¨æˆ·å</strong>æ˜¯åŸæœ‰wsl ubuntuçš„ç”¨æˆ·åç§°ã€‚</p><h3 id="é‡è£…ç³»ç»Ÿæ¢å¤æ—§ç‰ˆwsl2"><a href="#é‡è£…ç³»ç»Ÿæ¢å¤æ—§ç‰ˆwsl2" class="headerlink" title="é‡è£…ç³»ç»Ÿæ¢å¤æ—§ç‰ˆwsl2"></a>é‡è£…ç³»ç»Ÿæ¢å¤æ—§ç‰ˆwsl2</h3><p>æ­¤å¤„æ˜¯é’ˆå¯¹é‡ç½®ç³»ç»Ÿç›˜ï¼ŒåŒæ—¶æ—§ç‰ˆwsl2å·²ç»è¿ç§»åˆ°å…¶ä»–ç›˜ï¼Œå¦‚ä½•æ¢å¤æ—§ç‰ˆwsl2</p><p>1.å…ˆé‡æ–°å®‰è£…ä¸€ä¸ªæ–°çš„wsl2ï¼Œè¿™ä¸ªå¯ä»¥å‚ç…§ç½‘ä¸Šçš„<a href="https://so.csdn.net/so/search?q=wsl2%E5%AE%89%E8%A3%85&spm=1001.2101.3001.7020">wsl2å®‰è£…</a>æ•™ç¨‹ï¼Œæ³¨æ„å®‰è£…çš„Ubuntuçš„ç‰ˆæœ¬è¦å’Œæ—§ç‰ˆçš„Ubuntuç‰ˆæœ¬ï¼ˆå³ä½ æƒ³æ¢å¤çš„Ubuntuï¼‰ä¸€è‡´<br>2.å½“å®‰è£…wsl2æˆåŠŸåï¼Œæ­¤æ—¶wsl2é»˜è®¤å®‰è£…åœ¨ç³»ç»ŸCç›˜ï¼Œç„¶åæŒ‰ç…§ä¸Šé¢çš„==wsl2è¿ç§»==æ­¥éª¤æŠŠwsl2è¿ç§»åˆ°å…¶ä»–ç›˜<br>3.è¿ç§»æˆåŠŸåï¼ŒæŠŠæ–°ç‰ˆçš„==ext4.vhdx==<strong>åˆ é™¤</strong>ï¼Œæ‹·è´æˆæ—§ç‰ˆçš„<strong>ext4.vhdx</strong><br>4.å¯åŠ¨wsl2ï¼Œå³å¯æ¢å¤æ—§ç‰ˆwsl2<br>ã€æ³¨ã€‘ä¸€å®šè¦æŠŠæ–°ç‰ˆçš„==ext4.vhdx==åˆ é™¤ï¼Œä¸èƒ½ç”¨æ—§ç‰ˆçš„å»æ›¿æ¢æ–°ç‰ˆçš„==ext4.vhdx==ï¼ˆå³å¦‚ä¸‹å›¾æ“ä½œæ˜¯ä¸èƒ½æ¢å¤åˆ°æ—§ç‰ˆï¼‰ï¼Œå¦åˆ™æ›¿æ¢æˆåŠŸåï¼Œå½“ä½ å¯åŠ¨wsl2ä¼šå‘ç°è¿˜æ˜¯æ–°ç‰ˆçš„Ubuntuã€‚<br><img src="https://img-blog.csdnimg.cn/9dd9723d83444ccbad37bb999e494b97.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><blockquote><p>Docker æ˜¯æŒ‡å®¹å™¨åŒ–æŠ€æœ¯ï¼Œç”¨äºæ”¯æŒåˆ›å»ºå’Œä½¿ç”¨ LinuxÂ® å®¹å™¨ï¼ˆLXCæŠ€æœ¯ï¼‰ ã€‚<br>æˆ‘ä»¬åœ¨ Window ä¸Šå®‰è£… Docker Desktop ï¼Œéœ€è¦åŸºäº Linux ç¯å¢ƒã€‚<br>åœ¨ Windowsä¸Šï¼ŒDocker Desktop ä¸ºæˆ‘ä»¬æä¾›é€šè¿‡äº†ä¸¤ä¸ªé€‰é¡¹ï¼šWSL ä¸ Hyper-V ã€‚</p></blockquote><h2 id="ä¸€ã€WSL2-ä»¥åŠ-hyper-våŒºåˆ«ï¼ŒäºŒè€…å®‰è£…docker-desktop"><a href="#ä¸€ã€WSL2-ä»¥åŠ-hyper-våŒºåˆ«ï¼ŒäºŒè€…å®‰è£…docker-desktop" class="headerlink" title="ä¸€ã€WSL2 ä»¥åŠ hyper-våŒºåˆ«ï¼ŒäºŒè€…å®‰è£…docker desktop"></a>ä¸€ã€WSL2 ä»¥åŠ hyper-våŒºåˆ«ï¼ŒäºŒè€…å®‰è£…docker desktop</h2><h5 id="1-WSL2å’Œhyper-våŒºåˆ«"><a href="#1-WSL2å’Œhyper-våŒºåˆ«" class="headerlink" title="1.WSL2å’Œhyper-våŒºåˆ«"></a>1.WSL2å’Œhyper-våŒºåˆ«</h5><p>ç®€å•æ¥è¯´ï¼š</p><ul><li>wslæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨æˆ‘ä¸‹é¢çš„è§£é‡Šlinuxå‘½ä»¤çš„ç¨‹åºï¼Œå¯ä»¥ç›´æ¥æ“ä½œwinçš„èµ„æºï¼Œåˆé›†æˆäº†å¦‚puttyç±»çš„é›†åˆï¼Œä¸è¿‡äººå®¶æ˜¯è‡ªå·±åšçš„ã€‚WSL ä½¿ç”¨ Hyper-V æ¶æ„æ¥å®ç°å…¶è™šæ‹ŸåŒ–ã€‚ã€‚</li><li>WSL å®˜æ–¹æ–‡æ¡£ï¼ˆWindows Subsystem for Linuxï¼Œé€‚ç”¨äºwindowsçš„linuxå­ç³»ç»Ÿï¼‰åˆ™æ˜¯Windows æ“ä½œç³»ç»Ÿçš„ä¸€é¡¹ç‰¹æ€§ï¼Œå¯è®©æ‚¨ç›´æ¥åœ¨ Windows ä¸Šè¿è¡Œ Linux æ–‡ä»¶ç³»ç»Ÿä»¥åŠ Linux å‘½ä»¤è¡Œå·¥å…·å’Œ GUI åº”ç”¨ç¨‹åºï¼Œä»¥åŠä¼ ç»Ÿçš„ Windows æ¡Œé¢å’Œåº”ç”¨ç¨‹åºã€‚</li><li>è¿è¡ŒWSLçš„å¼€é”€æ¯”è¿è¡Œä¸€ä¸ªè™šæ‹Ÿæœºä½å¾ˆå¤šã€‚WSL 2å®é™…ä¸Šç”¨çš„æ˜¯è¿è¡Œåœ¨Hyper-vä¸Šçš„linuxå†…æ ¸ï¼Œç›¸è¾ƒäºè™šæ‹Ÿæœºä½ ä¸éœ€è¦å¾ˆå¤šçš„æ€§èƒ½å¼€é”€ã€‚</li><li>hyper-væ˜¯è™šæ‹Ÿæœºç¨‹åºï¼Œå¯ä»¥æä¾›ä¸€ä¸ªå®Œæ•´çš„è®¡ç®—æœºç¯æ¨¡æ‹Ÿï¼Œä¸hostéœ€è¦é€šè¿‡ç½‘ç»œè®¿é—® ã€‚Hyper-V å¾®è½¯å®˜æ–¹æ–‡æ¡£ :è®©ä½ å¯ä»¥åœ¨ Windows ä¸Šä»¥è™šæ‹Ÿæœºå½¢å¼è¿è¡Œå¤šä¸ªæ“ä½œç³»ç»Ÿï¼Œæä¾›ç¡¬ä»¶è™šæ‹ŸåŒ–ã€‚</li></ul><p><strong>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼š<br>å¦‚æœä½ åªä½¿ç”¨ Docker : WSL<br>å¦‚æœä½ éœ€è¦Linuxï¼Œå…¶ä»–çš„è™šæ‹Ÿæœºæˆ–æƒ³è®¿é—®Dockerçš„é«˜çº§é€‰é¡¹å¡æ¥åˆ†é…èµ„æº: Hyper-V</strong>ã€‚</p><h5 id="2-å®‰è£…Docker-Desktop"><a href="#2-å®‰è£…Docker-Desktop" class="headerlink" title="2.å®‰è£…Docker Desktop"></a>2.å®‰è£…Docker Desktop</h5><p><strong>å‚è€ƒï¼š</strong><a href="https://blog.csdn.net/rilqa/article/details/118496196">docker win10ä¸“ä¸šç‰ˆä¸‹ WSL 2 æˆ– hyper-v å®‰è£…Docker Desktop</a></p><h2 id="äºŒã€docker-desktopé™é¢é…ç½®ï¼Œèµ„æºé…ç½®æ–¹æ³•"><a href="#äºŒã€docker-desktopé™é¢é…ç½®ï¼Œèµ„æºé…ç½®æ–¹æ³•" class="headerlink" title="äºŒã€docker desktopé™é¢é…ç½®ï¼Œèµ„æºé…ç½®æ–¹æ³•"></a>äºŒã€docker desktopé™é¢é…ç½®ï¼Œèµ„æºé…ç½®æ–¹æ³•</h2><p>ä½¿ç”¨WSL2å’Œhyper-vå®‰è£…çš„dockerï¼Œé…ç½®æ˜¯æœ‰åŒºåˆ«çš„ã€‚</p><p><strong>1.ä½¿ç”¨WSL2è¿è¡Œdockerï¼š</strong></p><p>è¿™é‡Œä¼šæ˜¯é€‰æ‹©çŠ¶æ€ï¼š<br><img src="https://img-blog.csdnimg.cn/123d6961eedb4fe9845c044cf9e6cfe0.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>å®ƒçš„é…ç½®æ–¹æ³•å¦‚å›¾æ‰€ç¤ºï¼Œéœ€è¦åœ¨ç”¨æˆ·ç›®å½•(æ¯”å¦‚ï¼šC:\Users\lc)ä¸‹å»ºç«‹ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå«åš.wslconfigï¼Œ<br><img src="https://img-blog.csdnimg.cn/4e6482bd7fe94aa79627fa25831b5043.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¿®æ”¹æ–‡ä»¶å†…å®¹ä¸ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[wsl2]</span><br><span class="line">processors=4</span><br><span class="line">memory=8GB</span><br><span class="line">swap=8GB</span><br><span class="line">localhostForwarding=true</span><br></pre></td></tr></table></figure><p>memory: è¡¨ç¤ºæœ€å¤§ä½¿ç”¨ 2GB å†…å­˜<br>swap: è¡¨ç¤ºä¸è®¾ç½® swap<br>localhostForwarding: é»˜è®¤å€¼ä¸º trueã€‚å¦‚æœ WSL 2 VM ä¸­ç»‘å®šåˆ°é€šé…ç¬¦æˆ– localhost çš„ç«¯å£åº”è¯¥å¯ä»¥é€šè¿‡ localhost:port ä»ä¸»æœºè¿æ¥ã€‚<br>processors: ä½¿ç”¨çš„æ ¸å¿ƒæ•°é‡ï¼Œé»˜è®¤å’Œä½ çš„ Windows ç³»ç»Ÿä½¿ç”¨çš„æ ¸å¿ƒæ•°ä¸€æ ·</p><p>é‡å¯wsl2:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl --shutdown</span><br></pre></td></tr></table></figure><p><strong>2.ä½¿ç”¨hyper-vè¿è¡Œdockerï¼š</strong></p><p>é¦–å…ˆä¸å‹¾é€‰Use the WSL 2 based engineï¼Œ</p><p><img src="https://img-blog.csdnimg.cn/a13ad9bea2eb4c40a15045396883d8f3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ç„¶åè¿›å…¥Resources Advancedï¼š<br><img src="https://img-blog.csdnimg.cn/3bf73387f47944aeafd7331f060194a7.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><p>ä¿®æ”¹å³å¯ï¼</p><p><a href="https://blog.csdn.net/weixin_43431218/article/details/132335797">ã€Dockerã€‘Docker Desktopé…ç½®èµ„æºï¼šcpuã€å†…å­˜ç­‰(windowsç¯å¢ƒä¸‹)_wsl 2 å¯¹æ¯” hyper-v-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é­”æ”¹ç¬”è®°å…­ï¼šåšå®¢åŠ é€Ÿ</title>
      <link href="/2025/01/23/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E5%85%AD%EF%BC%9A%E5%8D%9A%E5%AE%A2%E5%8A%A0%E9%80%9F/"/>
      <url>/2025/01/23/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E5%85%AD%EF%BC%9A%E5%8D%9A%E5%AE%A2%E5%8A%A0%E9%80%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="é­”æ”¹ç¬”è®°å…­ï¼šåšå®¢åŠ é€Ÿï¼ˆæœ¬æ–‡è½¬è½½ï¼‰"><a href="#é­”æ”¹ç¬”è®°å…­ï¼šåšå®¢åŠ é€Ÿï¼ˆæœ¬æ–‡è½¬è½½ï¼‰" class="headerlink" title="é­”æ”¹ç¬”è®°å…­ï¼šåšå®¢åŠ é€Ÿï¼ˆæœ¬æ–‡è½¬è½½ï¼‰"></a>é­”æ”¹ç¬”è®°å…­ï¼šåšå®¢åŠ é€Ÿï¼ˆæœ¬æ–‡è½¬è½½ï¼‰</h1><h2 id="0x00-å‰è¨€"><a href="#0x00-å‰è¨€" class="headerlink" title="0x00 å‰è¨€"></a>0x00 å‰è¨€</h2><p>è¿™å‡ å¤©é—²æ¥æ— äº‹ï¼Œå­¦ä¹ äº†ä¸‹Hexoçš„åšå®¢é€Ÿåº¦ä¼˜åŒ–ï¼Œå‘ç°æœ‰å¥½å¤šæ–¹æ³•ã€‚CDNåŠ é€Ÿã€Codingéƒ¨ç½²ã€gulpå‹ç¼©ã€hexo-neatã€InstantClick é»‘ç§‘æŠ€ç­‰ç­‰ã€‚è¿™é‡Œè®°å½•ä¸‹æˆ‘ä½¿ç”¨gulpå‹ç¼©è¿›è¡ŒHexoé€Ÿåº¦ä¼˜åŒ–å’Œåœ¨æ­¤è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜ï¼Œä»¥åŠä½¿ç”¨hexo-neatå¯¹Hexoè¿›è¡Œé€Ÿåº¦ä¼˜åŒ–ã€‚<br>è¿™ä¸¤ç§æ–¹æ³•éƒ½æ˜¯é™æ€æ–‡ä»¶å‹ç¼©ï¼Œé™æ€æ–‡ä»¶åŒ…æ‹¬: html,css,js,images</p><p>0x01 ä¼˜åŒ–ä¹‹å‰<br>åœ¨åšå®¢é€Ÿåº¦ä¼˜åŒ–ä¹‹å‰ï¼Œå…ˆæ¥è¯´è¯´åœ¨æµè§ˆå™¨è¾“å…¥urlåˆ°é¡µé¢æ‰“å¼€ï¼Œéƒ½åšäº†äº›ä»€ä¹ˆï¼Ÿï¼Œå› ä¸ºæ²¡æ€ä¹ˆäº†è§£è¿‡ï¼Œæ‰€ä»¥å‚è€ƒäº†å¾ˆå¤šåšå®¢ï¼Œå…·ä½“å‚è€ƒçš„åšå®¢é“¾æ¥åœ¨æ–‡æœ«ã€‚<br>å½“åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ç½‘å€ï¼Œå¦‚ï¼š<a href="http://www.baidu.comåæµè§ˆå™¨æ˜¯æ€ä¹ˆæŠŠæœ€ç»ˆçš„é¡µé¢å‘ˆç°å‡ºæ¥çš„å‘¢ï¼Ÿè¿™ä¸ªè¿‡ç¨‹å¯ä»¥å¤§è‡´åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šç½‘ç»œé€šä¿¡å’Œé¡µé¢æ¸²æŸ“ã€‚">www.baidu.comåæµè§ˆå™¨æ˜¯æ€ä¹ˆæŠŠæœ€ç»ˆçš„é¡µé¢å‘ˆç°å‡ºæ¥çš„å‘¢ï¼Ÿè¿™ä¸ªè¿‡ç¨‹å¯ä»¥å¤§è‡´åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šç½‘ç»œé€šä¿¡å’Œé¡µé¢æ¸²æŸ“ã€‚</a></p><h2 id="1ã€å¤§è‡´æµç¨‹"><a href="#1ã€å¤§è‡´æµç¨‹" class="headerlink" title="1ã€å¤§è‡´æµç¨‹"></a>1ã€å¤§è‡´æµç¨‹</h2><p>URL è§£æ-&gt;DNS æŸ¥è¯¢-&gt;TCP è¿æ¥-&gt;å¤„ç†è¯·æ±‚-&gt;æ¥å—å“åº”-&gt;æ¸²æŸ“é¡µé¢<br>ç®€å•çš„æ¥è¯´ï¼Œå°±æ˜¯ï¼š</p><p>æµè§ˆå™¨é‡Œè¾“å…¥ç½‘å€<br>æµè§ˆå™¨æŸ¥æ‰¾åŸŸåå¯¹åº”çš„IPåœ°å€<br>DNSå…·ä½“çš„æŸ¥æ‰¾è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ï¼šæµè§ˆå™¨ç¼“å­˜-&gt;ç³»ç»Ÿç¼“å­˜-&gt;è·¯ç”±å™¨ç¼“å­˜-&gt;ISP DNSç¼“å­˜-&gt;æ ¹åŸŸåæœåŠ¡å™¨<br>æµè§ˆå™¨å‘webæœåŠ¡å™¨å‘é€ä¸€ä¸ªHTTPè¯·æ±‚<br>æœåŠ¡å™¨çš„æ°¸ä¹…é‡å®šå‘å“åº”ï¼ˆä»<a href="http://baidu.com/">http://baidu.com</a> åˆ° <a href="http://www.baidu.com)/">http://www.baidu.comï¼‰</a><br>ä¸ºä»€ä¹ˆè¦é‡å®šå‘ï¼Ÿå…¶ä¸­ä¸€ä¸ªåŸå› è·Ÿæœç´¢å¼•æ“æ’åæœ‰å…³ã€‚å¦‚æœä¸€ä¸ªé¡µé¢æœ‰ä¸¤ä¸ªåœ°å€ï¼Œå°±åƒ<a href="http://baidu.com/%E5%92%8Chttp://www.baidu.com/%EF%BC%8C%E6%90%9C%E7%B4%A2%E5%BC%95%E6%93%8E%E4%BC%9A%E8%AE%A4%E4%B8%BA%E5%AE%83%E4%BB%AC%E6%98%AF%E4%B8%A4%E4%B8%AA%E7%BD%91%E7%AB%99%EF%BC%8C%E7%BB%93%E6%9E%9C%E9%80%A0%E6%88%90%E6%AF%8F%E4%B8%80%E4%B8%AA%E7%9A%84%E6%90%9C%E7%B4%A2%E9%93%BE%E6%8E%A5%E9%83%BD%E5%87%8F%E5%B0%91%E4%BB%8E%E8%80%8C%E9%99%8D%E4%BD%8E%E6%8E%92%E5%90%8D%E3%80%82%E6%89%80%E4%BB%A5%E8%A6%81%E6%8A%8A%E5%B8%A6www%E7%9A%84%E5%92%8C%E4%B8%8D%E5%B8%A6www%E7%9A%84%E5%9C%B0%E5%9D%80%E5%BD%92%E5%88%B0%E5%90%8C%E4%B8%80%E4%B8%AA%E7%BD%91%E7%AB%99%E6%8E%92%E5%90%8D%E4%B8%8B%E3%80%82%E8%BF%98%E6%9C%89%E4%B8%80%E4%B8%AA%E5%8E%9F%E5%9B%A0%E6%98%AF%E7%94%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E5%9C%B0%E5%9D%80%E4%BC%9A%E9%80%A0%E6%88%90%E7%BC%93%E5%AD%98%E5%8F%8B%E5%A5%BD%E6%80%A7%E5%8F%98%E5%B7%AE%E3%80%82">http://baidu.com/å’Œhttp://www.baidu.com/ï¼Œæœç´¢å¼•æ“ä¼šè®¤ä¸ºå®ƒä»¬æ˜¯ä¸¤ä¸ªç½‘ç«™ï¼Œç»“æœé€ æˆæ¯ä¸€ä¸ªçš„æœç´¢é“¾æ¥éƒ½å‡å°‘ä»è€Œé™ä½æ’åã€‚æ‰€ä»¥è¦æŠŠå¸¦wwwçš„å’Œä¸å¸¦wwwçš„åœ°å€å½’åˆ°åŒä¸€ä¸ªç½‘ç«™æ’åä¸‹ã€‚è¿˜æœ‰ä¸€ä¸ªåŸå› æ˜¯ç”¨ä¸åŒçš„åœ°å€ä¼šé€ æˆç¼“å­˜å‹å¥½æ€§å˜å·®ã€‚</a></p><p>æµè§ˆå™¨è·Ÿè¸ªé‡å®šå‘åœ°å€ï¼Œå‘èµ·GETè¯·æ±‚<br>æœåŠ¡å™¨â€å¤„ç†â€è¯·æ±‚ï¼Œå‘æµè§ˆå™¨å‘å›ä¸€ä¸ªHTMLå“åº”<br>æµè§ˆå™¨è§£ææ˜¾ç¤ºHTML<br>æµè§ˆå™¨å‘é€è¯·æ±‚è·å–åµŒå…¥åœ¨ HTML ä¸­çš„èµ„æºï¼ˆå¦‚å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ã€CSSã€JSç­‰ç­‰ï¼‰<br>æµè§ˆå™¨å‘é€å¼‚æ­¥è¯·æ±‚ï¼ˆajaxè¯·æ±‚ç­‰ï¼‰</p><h2 id="2ã€ç®€å•åˆ†æ"><a href="#2ã€ç®€å•åˆ†æ" class="headerlink" title="2ã€ç®€å•åˆ†æ"></a>2ã€ç®€å•åˆ†æ</h2><p>ä»ä¸Šé¢çš„è¿‡ç¨‹å¯ä»¥çœ‹å‡ºï¼Œå¤§éƒ¨åˆ†è¿‡ç¨‹æˆ‘ä»¬æ— æ³•æ§åˆ¶ï¼Œæ‰€ä»¥åªèƒ½ä»æµè§ˆå™¨ç«¯å…¥æ‰‹æ¥æ‰¾ä¸€äº›å¯ä»¥åšçš„äº‹æƒ…ã€‚<br>å°‘å‘é€è¯·æ±‚</p><p>æŠŠè¦åŠ è½½çš„jsæ–‡ä»¶ï¼ˆcssæ–‡ä»¶åŒç†ï¼‰åˆå¹¶æˆä¸€ä¸ªï¼ˆå°½é‡å°‘ï¼‰æ–‡ä»¶ï¼Œåˆ™å¯ä»¥å‘æœåŠ¡å™¨å°‘å‘é€è¯·æ±‚ï¼Œä»è€Œå‡å°‘ç­‰å¾…æ—¶é—´ã€‚</p><p>å‹ç¼©æ–‡ä»¶</p><p>ä½¿ç”¨å‹ç¼©ä¹‹åçš„jsã€cssã€imgæ–‡ä»¶ï¼ŒåŒæ ·å¯ä»¥å‡å°‘è¯·æ±‚æ—¶é—´ã€‚</p><p>Css Sprite</p><p>è¿™æ˜¯cssçš„ä¸€é¡¹æŠ€æœ¯ï¼Œå°†å›¾ç‰‡å°½å¯èƒ½å¤šçš„åˆå¹¶æˆä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨çš„æ—¶å€™åŠ è½½è¿™å¼ å›¾ç‰‡ï¼Œç„¶åæµè§ˆå™¨ä¼šç¼“å­˜ä¸‹æ¥ï¼Œå…¶ä»–åœ°æ–¹å†ä½¿ç”¨çš„æ—¶å€™å°±ä¸éœ€è¦é‡æ–°è¯·æ±‚äº†ã€‚</p><p>jsï¼cssä½ç½®</p><p>csså¼•ç”¨å»ºè®®æ”¾åœ¨headæ ‡ç­¾é‡Œé¢ï¼›jsè„šæœ¬å»ºè®®æ”¾åˆ°bodyå†…å®¹çš„æœ€åï¼ŒåŸå› ï¼šç­‰å¾…jsåŠ è½½æˆ–è€…è„šæœ¬æœ‰é”™è¯¯çš„æ—¶å€™ä¸ä¼šå½±å“htmlé¡µé¢çš„å±•ç¤ºã€‚</p><p>é‚£ä¹ˆæ€ä¹ˆæé«˜hexoè¿™ä¸ªé™æ€åšå®¢çš„é¡µé¢åŠ è½½é€Ÿåº¦å‘¢ï¼Ÿå¯ä»¥ä»ä»¥ä¸‹çš„å‡ ä¸ªæ–¹é¢å»å…¥æ‰‹ï¼š</p><p>å°†jsæ–‡ä»¶å°½å¯èƒ½æ”¾åˆ°bodyçš„é—­åˆæ ‡ç­¾ä¹‹å‰ï¼Œå› ä¸ºåœ¨åŠ è½½æˆ–è€…å¼•å…¥jsæ–‡ä»¶æ—¶æ˜¯é˜»å¡å¼çš„ï¼Œå¦‚æœåœ¨é¡µé¢çš„æœ€å¼€å§‹å°±å¼•å…¥è¿™äº›jsæ–‡ä»¶ï¼Œè€Œè¿™äº›æ–‡ä»¶åˆæ¯”è¾ƒå¤§ï¼Œä¼šé€ æˆé¡µé¢åœ¨æ¸²æŸ“æ—¶é•¿æ—¶é—´å¤„äºç™½å±çŠ¶æ€ã€‚<br>å°½é‡é¿å…å»å¼•ç”¨è®¿é—®é€Ÿåº¦éå¸¸ä½ä¸‹çš„cdnæˆ–è€…å›¾ç‰‡ï¼Œå¯æ”¹ç”¨è®¿é—®é€Ÿåº¦æ›´å¿«çš„cdnï¼Œæˆ–å°†éš¾ä»¥è¿…é€ŸåŠ è½½çš„å›¾ç‰‡ä¿å­˜åˆ°è‡ªå·±çš„ç«™ç‚¹ç›®å½•ä¸‹ï¼Œä»¥å…åœ¨åŠ è½½å›¾ç‰‡æ—¶è€—è´¹å¤§é‡æ—¶é—´ï¼Œæœ€åè¿˜åŠ è½½å¤±è´¥ã€‚<br>å¯¹é¡µé¢çš„é™æ€èµ„æºè¿›è¡Œå‹ç¼©ï¼ŒåŒ…æ‹¬cssã€jså’Œhtmlç­‰æ–‡ä»¶ã€‚<br>æˆ‘ä»¬è‡ªå·±æ·»åŠ çš„csså’Œjsæ–‡ä»¶ä¸ºäº†å¯è¯»æ€§ï¼Œå¾€å¾€ä¼šæœ‰å¾ˆå¤šæ¢è¡Œå’Œç©ºæ ¼ï¼Œè¿™äº›å¯¹äºæµè§ˆå™¨æ¥è¯´å¹¶æ²¡ä»€ä¹ˆç”¨ï¼Œç”šè‡³è¿˜ä¼šé™ä½æ¸²æŸ“é¡µé¢çš„é€Ÿåº¦ã€‚<br>è‡³äºhtmlæ–‡ä»¶ï¼Œç”±äºMarkdownè½¬æˆhtmlçš„bugï¼Œä¼šå¯¼è‡´é¡µé¢å­˜åœ¨å¤§é‡çš„ç©ºç™½ï¼ŒæŸ¥çœ‹ä¸‹é¡µé¢çš„æºä»£ç ï¼Œä¼šå‘ç°æœ‰å¤§é‡çš„ç©ºç™½ç¬¦ï¼Œè¿™ä¹Ÿä¼šé€ æˆé¡µé¢æ¸²æŸ“çš„æ€§èƒ½é—®é¢˜ã€‚</p><h2 id="0x02-gulp4å‹ç¼©é™æ€æ–‡ä»¶"><a href="#0x02-gulp4å‹ç¼©é™æ€æ–‡ä»¶" class="headerlink" title="0x02 gulp4å‹ç¼©é™æ€æ–‡ä»¶"></a>0x02 gulp4å‹ç¼©é™æ€æ–‡ä»¶</h2><h3 id="1ã€å®‰è£…gulp"><a href="#1ã€å®‰è£…gulp" class="headerlink" title="1ã€å®‰è£…gulp"></a>1ã€å®‰è£…gulp</h3><p>åœ¨ç«™ç‚¹æ ¹ç›®å½•ä¸‹å®‰è£…gulpå·¥å…·</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp -g</span><br></pre></td></tr></table></figure><p>2.å®‰è£…gulpæ’ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-minify-html gulp-minify-css gulp-uglify gulp-imagemin --save</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å†³ã€Gulpæ‰“åŒ…é—®é¢˜ã€‘ GulpUglifyError: unable to minify JavaScript</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è§£å†³ gulp-uglify å‹ç¼©JavaScript ä¸å…¼å®¹ es5 è¯­æ³•çš„é—®é¢˜</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#npm install babel-core@6.26.3 --save</span></span><br><span class="line"><span class="comment">#npm install gulp-babel@7.0.1 --save</span></span><br><span class="line"><span class="comment">#npm install babel-preset-es2015@6.24.1 --save</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gulp-babel å–æ¶ˆä¸¥æ ¼æ¨¡å¼æ–¹æ³•(&quot;use strict&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#npm install gulp-remove-use-strict --save</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#é—®é¢˜ï¼šå¦‚æœå®‰è£…gulp-imageminé”™è¯¯è¯·æ‰§è¡Œä»¥ä¸‹è¯­å¥</span></span><br><span class="line"><span class="comment">#sudo npm i gulp-imagemin --unsafe-perms</span></span><br></pre></td></tr></table></figure><h3 id="2ã€å»ºç«‹gulpfile-jsæ–‡ä»¶"><a href="#2ã€å»ºç«‹gulpfile-jsæ–‡ä»¶" class="headerlink" title="2ã€å»ºç«‹gulpfile.jsæ–‡ä»¶"></a>2ã€å»ºç«‹gulpfile.jsæ–‡ä»¶</h3><p>åœ¨ç«™ç‚¹æ ¹ç›®å½•ä¸‹åˆ›å»ºgulpfile.js</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//Pluginsæ¨¡å—è·å–</span></span><br><span class="line"><span class="keyword">var</span> minifycss = <span class="built_in">require</span>(<span class="string">&#x27;gulp-minify-css&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">&#x27;gulp-uglify&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> minifyhtml = <span class="built_in">require</span>(<span class="string">&#x27;gulp-minify-html&#x27;</span>);</span><br><span class="line"><span class="comment">// å‹ç¼© public ç›®å½• cssæ–‡ä»¶</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-css&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./public/**/*.css&#x27;</span>)</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">minifycss</span>())</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å‹ç¼© public ç›®å½• htmlæ–‡ä»¶</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-html&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./public/**/*.html&#x27;</span>)</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">minifyhtml</span>())</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>))</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// å‹ç¼© public/js ç›®å½• jsæ–‡ä»¶ï¼Œå¿½ç•¥/public/lib/blog-encrypt.js</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-js&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//çº é”™å‰ï¼šreturn gulp.src(&#x27;./public/**/*.js&#x27;)</span></span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>([<span class="string">&#x27;./public/**/*.js&#x27;</span>, <span class="string">&#x27;!./public/lib/blog-encrypt.js&#x27;</span>])</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">uglify</span>())</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>))</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// å‹ç¼©å›¾ç‰‡</span></span><br><span class="line"><span class="comment">//gulp.task(&#x27;minify-images&#x27;, function() &#123;</span></span><br><span class="line"><span class="comment">//    return gulp.src(&#x27;./public/images/**/*.*&#x27;)</span></span><br><span class="line"><span class="comment">//        .pipe(imagemin(</span></span><br><span class="line"><span class="comment">//        [imagemin.gifsicle(&#123;&#x27;optimizationLevel&#x27;: 3&#125;),</span></span><br><span class="line"><span class="comment">//        imagemin.jpegtran(&#123;&#x27;progressive&#x27;: true&#125;),</span></span><br><span class="line"><span class="comment">//        imagemin.optipng(&#123;&#x27;optimizationLevel&#x27;: 7&#125;),</span></span><br><span class="line"><span class="comment">//        imagemin.svgo()],</span></span><br><span class="line"><span class="comment">//        &#123;&#x27;verbose&#x27;: true&#125;))</span></span><br><span class="line"><span class="comment">//        .pipe(gulp.dest(&#x27;./public/images&#x27;))</span></span><br><span class="line"><span class="comment">//&#125;);</span></span><br><span class="line"><span class="comment">//å› ä¸ºæˆ‘å›¾ç‰‡ç”¨çš„ç¬¬ä¸‰æ–¹å›¾åºŠå­˜æ”¾çš„ï¼Œæ‰€ä»¥å°±æ²¡å‹ç¼©å›¾ç‰‡ã€‚(å¹¶ä¸”æœ€åæµ‹è¯•å‹ç¼©å›¾ç‰‡æ—¶ï¼Œå‘ç°æœ‰ç‚¹æƒé™é—®é¢˜ï¼Œ</span></span><br><span class="line"><span class="comment">//æ•´äº†ä¸¤ä¸ªå¤šå°æ—¶æ²¡æ•´å¥½ï¼@^@)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ†åˆ«æ‰§è¡Œcssã€hemlã€jsçš„å‹ç¼©ä»»åŠ¡</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;default&#x27;</span>, gulp.<span class="title function_">parallel</span>(<span class="string">&#x27;minify-css&#x27;</span>, <span class="string">&#x27;minify-html&#x27;</span>, <span class="string">&#x27;minify-js&#x27;</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨ï¼š<br>1.ä¿®æ”¹ä¸Šé¢çš„å„ä¸ªç›®å½•ä¸ºä½ çš„çœŸå®ç›®å½•ï¼Œ ** ä»£è¡¨0æˆ–å¤šä¸ªå­ç›®å½•<br>2.åœ¨é»˜è®¤ä»»åŠ¡ä¸­ï¼Œgulp.parallel()æ˜¯gulp4ä¸­çš„æ–°å†™æ³•ï¼š<br>gulp.series ç”¨äºä¸²è¡Œ(é¡ºåº)æ‰§è¡Œ<br>gulp.parallel ç”¨äºå¹¶è¡Œæ‰§è¡Œ<br>3.éƒ¨ç½²æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo d</span><br></pre></td></tr></table></figure><p>æ„Ÿè§‰å‘½ä»¤æœ‰ç‚¹å¤šï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨<code>package.json</code>æ–‡ä»¶é‡Œæ·»åŠ </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;hexo&quot;</span>: <span class="string">&quot;hexo clean &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo d&quot;</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>3ã€é‡åˆ°çš„é—®é¢˜</p><p>åœ¨ä½¿ç”¨gup4å‹ç¼©é™æ€æ–‡ä»¶æ—¶é‡åˆ°ä¸€äº›é—®é¢˜ï¼Œæ€»ç»“ä¸€ä¸‹ï¼š<br><strong>1.gulp4çš„é»˜è®¤ä»»åŠ¡æ‰§è¡Œé—®é¢˜</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//4.0ä»¥å‰çš„å†™æ³• </span><br><span class="line">//gulp.task(<span class="string">&#x27;default&#x27;</span>, [<span class="string">&#x27;minify-html&#x27;</span>, <span class="string">&#x27;minify-css&#x27;</span>, <span class="string">&#x27;minify-js&#x27;</span>]);</span><br><span class="line">//4.0ä»¥åçš„å†™æ³•</span><br><span class="line">// æ‰§è¡Œ gulp å‘½ä»¤æ—¶æ‰§è¡Œçš„ä»»åŠ¡</span><br><span class="line">gulp.task(<span class="string">&#x27;default&#x27;</span>, gulp.parallel(<span class="string">&#x27;minify-css&#x27;</span>, <span class="string">&#x27;minify-html&#x27;</span>, <span class="string">&#x27;minify-js&#x27;</span>));</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>2.TypeError: dest.on is not a function</strong><br>å…ˆæ£€æŸ¥gulpfile.jsè‹¥æ²¡æœ‰é—®é¢˜ï¼Œåˆ æ‰node_modulesï¼Œé‡è£…ä¸€éä¾èµ–npm install</p><p><strong>3.GulpUglifyError: unable to minify JavaScript(Gulpæ‰“åŒ…é—®é¢˜)</strong><br>é”™è¯¯åŸå› æœ‰å¾ˆå¤šï¼Œå¦‚ï¼šæœ‰çš„æ–‡ä»¶ä¸èƒ½æ‰“åŒ…ã€javascirptè¯­æ³•é—®é¢˜ç­‰ç­‰ã€‚æˆ‘é‡åˆ°çš„é—®é¢˜æ˜¯æœ‰çš„æ–‡ä»¶ä¸èƒ½æ‰“åŒ…ã€‚<br>ï¼ˆ1ï¼‰è§£å†³æ–¹æ³•1ï¼š<br>æ£€æŸ¥å“ªä¸€ä¸ªæ–‡ä»¶ä¸­çš„å“ªä¸€è¡Œæœ‰é—®é¢˜ï¼Œå®‰è£… gulp-util æ¨¡å— ç”¨äºæ‰“å°æ—¥å¿—</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev gulp-util</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨<code>gulpfile.js</code>é‡Œæ·»åŠ ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">&#x27;script&#x27;</span>, <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">    gulp.src([<span class="string">&#x27;public/**/*.js&#x27;</span>, <span class="string">&#x27;public/lib/**/*.js&#x27;</span>])</span><br><span class="line">        .pipe(uglify())</span><br><span class="line">        .on(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">function</span>(err) &#123;</span><br><span class="line">            gutil.log(gutil.colors.red(<span class="string">&#x27;[Error]&#x27;</span>), err.toString());</span><br><span class="line">        &#125;)</span><br><span class="line">        .pipe(<span class="string">&#x27;dist/js&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ‰§è¡Œ<code>gulp script</code>ï¼Œè¿™æ ·å°±å¯ä»¥ç²¾å‡†çš„é€ä¸ªæ’æŸ¥æ–‡ä»¶äº†ã€‚è¿™é‡Œæˆ‘æ’æŸ¥åˆ°ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_f3aaeb96f790f6e8a908eba5ff8b3eef.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_f3aaeb96f790f6e8a908eba5ff8b3eef.png"></p><p>å‘ç°<code>blog-encrypt.js</code>æœ‰é—®é¢˜ï¼Œåœ¨<code>gulpfile.js</code>å¿½ç•¥<code>blog-encrypt.js</code>å³å¯ï¼Œå³</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å‹ç¼© public/js ç›®å½• jsæ–‡ä»¶</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-js&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//çº é”™å‰ï¼šreturn gulp.src(&#x27;./public/**/*.js&#x27;)</span></span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>([<span class="string">&#x27;./public/**/*.js&#x27;</span>, <span class="string">&#x27;!./public/lib/blog-encrypt.js&#x27;</span>])</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">uglify</span>())</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ï¼ˆ2ï¼‰è§£å†³æ–¹æ³•2ï¼š<br>ç»§ç»­æ–¹æ³•1 å®‰è£… babel æ¨¡å—<br><code>gulp-babel</code>ã€<code>babel-preset-es2015</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev gulp-babel babel-preset-es2015</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">gulp.task(<span class="string">&#x27;script&#x27;</span>, <span class="function"><span class="title">function</span></span>() &#123;</span><br><span class="line">    gulp.src([<span class="string">&#x27;public/**/*.js&#x27;</span>, <span class="string">&#x27;public/lib/**/*.js&#x27;</span>])</span><br><span class="line">        .pipe(babel(&#123;</span><br><span class="line">            presets: [<span class="string">&#x27;es2015&#x27;</span>] // es5æ£€æŸ¥æœºåˆ¶</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(uglify())</span><br><span class="line">        .on(<span class="string">&#x27;error&#x27;</span>, <span class="keyword">function</span>(err) &#123;</span><br><span class="line">            gutil.log(gutil.colors.red(<span class="string">&#x27;[Error]&#x27;</span>), err.toString());</span><br><span class="line">        &#125;)</span><br><span class="line">        .pipe(<span class="string">&#x27;dist/js&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿™æ ·å°±è§£å†³ gulp-uglify å‹ç¼©JavaScript ä¸å…¼å®¹ es5 è¯­æ³•çš„é—®é¢˜äº†ã€‚<br>4.The following tasks did not complete: html Did you forget to signal async completion?<br>è¿è¡Œgulpï¼Œå‡ºç°ä¸‹é¢æŠ¥é”™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">The following tasks did not complete: html </span><br><span class="line">Did you forget to signal async completion?</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è§£å†³åŠæ³•ï¼šåœ¨æ³¨å†Œçš„ä»»åŠ¡å‡½æ•°é‡Œä½¿ç”¨ async å’Œ awaitã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(<span class="string">&quot;html&quot;</span>,async()=&gt;&#123;</span><br><span class="line">await gulp.src(folder.src + <span class="string">&quot;html/*&quot;</span>)</span><br><span class="line">.pipe(htmlClean())</span><br><span class="line">.pipe(gulp.dest(folder.build + <span class="string">&quot;html&quot;</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>gulp4å®‰è£…ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘æš‚æ—¶å°±é‡åˆ°ä¸Šé¢è¿™å‡ ç§é”™è¯¯ã€‚é™¤äº†ä¸Šè¿°é”™è¯¯ï¼Œè¿˜æœ‰å¾ˆå¤šå¯èƒ½ä¼šå‡ºé”™çš„åœ°æ–¹ï¼Œè¿™é‡Œæœ‰ä¸ªåšå®¢è®°å½•äº†ä¸€äº›ï¼šgulp é”™è¯¯é›†é”¦</p><p>0x03 hexo-neatå‹ç¼©é™æ€æ–‡ä»¶<br>hexo-neatæ˜¯ç”±rozboå¤§ä½¬å¼€å‘çš„å‹ç¼©æ’ä»¶ï¼Œé…ç½®ç®€å•ï¼Œæ— éœ€é¢å¤–å‘½ä»¤ï¼Œåªè¦ä½¿ç”¨åŸæœ¬çš„è°ƒè¯•ä¸‰è¿æˆ–è€…éƒ¨ç½²ä¸‰è¿å°±å¯ä»¥è‡ªåŠ¨å®Œæˆé™æ€èµ„æºçš„å‹ç¼©</p><h4 id="1ã€å®‰è£…hexo-neat"><a href="#1ã€å®‰è£…hexo-neat" class="headerlink" title="1ã€å®‰è£…hexo-neat"></a>1ã€å®‰è£…hexo-neat</h4><p>åœ¨ç«™ç‚¹æ ¹ç›®å½•ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-neat --save</span><br></pre></td></tr></table></figure><h5 id="2ã€æ·»åŠ ç›¸å…³é…ç½®"><a href="#2ã€æ·»åŠ ç›¸å…³é…ç½®" class="headerlink" title="2ã€æ·»åŠ ç›¸å…³é…ç½®"></a>2ã€æ·»åŠ ç›¸å…³é…ç½®</h5><p>åœ¨ç«™ç‚¹é…ç½®æ–‡ä»¶<code>_config.yml</code>æ·»åŠ ç›¸å…³é…ç½®ï¼Œç›´æ¥æ·»åŠ åˆ°ç«™ç‚¹é…ç½®æ–‡ä»¶<code>_config.yml</code>çš„æœ«å°¾å°±å¯ä»¥ã€‚å¯ä»¥å®‰è£…è‡ªå·±çš„éœ€æ±‚å»è‡ªå®šä¹‰é…ç½®ï¼Œä¸è¿‡æœ‰äº›æ³¨æ„äº‹é¡¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-neat</span></span><br><span class="line"><span class="comment"># åšæ–‡å‹ç¼©</span></span><br><span class="line">neat_enable: <span class="literal">true</span></span><br><span class="line"><span class="comment"># å‹ç¼©html</span></span><br><span class="line">neat_html:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  exclude:</span><br><span class="line"><span class="comment"># å‹ç¼©css  </span></span><br><span class="line">neat_css:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  exclude:</span><br><span class="line">    - <span class="string">&#x27;**/*.min.css&#x27;</span></span><br><span class="line"><span class="comment"># å‹ç¼©js</span></span><br><span class="line">neat_js:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  mangle: <span class="literal">true</span></span><br><span class="line">  output:</span><br><span class="line">  compress:</span><br><span class="line">  exclude:</span><br><span class="line">    - <span class="string">&#x27;**/*.min.js&#x27;</span></span><br><span class="line">    - <span class="string">&#x27;**/jquery.fancybox.pack.js&#x27;</span></span><br><span class="line">    - <span class="string">&#x27;**/index.js&#x27;</span>  </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>3ã€hexo-neatæ’ä»¶æ³¨æ„äº‹é¡¹<br>åœ¨ä½¿ç”¨hexo-neatæ’ä»¶æ—¶ï¼Œå¯ä»¥åœ¨å‘½ä»¤çª—å£ä¸­çœ‹åˆ°å„ä¸ªæ–‡ä»¶çš„å‹ç¼©ç‡ï¼Œäºæ˜¯å¯ä»¥é€šè¿‡è·³è¿‡ä¸€äº›æ–‡ä»¶è®©æ•ˆç‡æ›´é«˜ã€‚<br>1.è·³è¿‡å‹ç¼©æ–‡ä»¶çš„æ­£ç¡®é…ç½®æ–¹å¼<br>å¦‚æœæŒ‰ç…§å®˜æ–¹æ’ä»¶çš„æ–‡æ¡£è¯´æ˜æ¥é…ç½®excludeï¼Œä¼šå‘ç°å®Œå…¨ä¸èµ·ä½œç”¨ã€‚è¿™æ˜¯å› ä¸ºé…ç½®çš„æ–‡ä»¶è·¯å¾„ä¸å¯¹ï¼Œå‹ç¼©æ—¶æ‰¾ä¸åˆ°ä½ é…ç½®çš„æ–‡ä»¶ï¼Œè‡ªç„¶ä¹Ÿå°±æ— æ³•è·³è¿‡äº†ã€‚äºæ˜¯éœ€è¦ç»™è¿™äº›æ–‡ä»¶æŒ‡å®šæ­£ç¡®çš„è·¯å¾„ï¼Œä¸‡èƒ½çš„é…ç½®æ–¹å¼å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">neat_css:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span></span><br><span class="line">  exclude:</span><br><span class="line">    - <span class="string">&#x27;**/*.min.css&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>2.å‹ç¼©htmlæ—¶ä¸è¦è·³è¿‡.mdæ–‡ä»¶å’Œ.swigæ–‡ä»¶<br>.mdæ–‡ä»¶å°±æ˜¯markdownæ–‡ä»¶ï¼Œå¦‚æœè·³è¿‡å‹ç¼©.mdæ–‡ä»¶ï¼Œè€Œåˆåˆšå¥½åœ¨æ–‡ç« ä¸­ä½¿ç”¨åˆ°äº†tabæ ‡ç­¾ï¼Œé‚£ä¹ˆå½“hexoåœ¨ç”Ÿæˆé™æ€é¡µé¢æ—¶å°±ä¼šå‘ç”Ÿè§£æé”™è¯¯ã€‚è¿™ä¼šå¯¼è‡´ä½¿ç”¨åˆ°äº†tabæ ‡ç­¾çš„é¡µé¢ç”Ÿæˆå¤±è´¥è€Œæ— æ³•è®¿é—®ã€‚</p><p>.swigæ–‡ä»¶æ˜¯æ¨¡æ¿å¼•æ“æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯hexoå¯ä»¥é€šè¿‡è¿™äº›æ–‡ä»¶æ¥ç”Ÿæˆå¯¹åº”çš„é¡µé¢ã€‚å¦‚æœè·³è¿‡è¿™äº›æ–‡ä»¶ï¼Œæ‰€æœ‰é¡µé¢å®Œå…¨æ²¡æœ‰èµ·åˆ°å‹ç¼©çš„æ•ˆæœï¼Œé¡µé¢æºä»£ç é‡Œä¾ç„¶å­˜åœ¨ç€ä¸€å¤§å †ç©ºç™½ã€‚</p><h2 id="hexo-offline-popupæ’ä»¶ï¼ˆåŠ é€Ÿä½ åšå®¢çš„è®¿é—®é€Ÿåº¦"><a href="#hexo-offline-popupæ’ä»¶ï¼ˆåŠ é€Ÿä½ åšå®¢çš„è®¿é—®é€Ÿåº¦" class="headerlink" title="hexo-offline-popupæ’ä»¶ï¼ˆåŠ é€Ÿä½ åšå®¢çš„è®¿é—®é€Ÿåº¦"></a>hexo-offline-popupæ’ä»¶ï¼ˆåŠ é€Ÿä½ åšå®¢çš„è®¿é—®é€Ÿåº¦</h2><p>ä¸ºäº†æ‚¨çš„æœ€ä½³æµè§ˆä½“éªŒï¼Œå»ºè®®æ‰“å¼€åŸç½‘å€æµè§ˆå“¦<br>æœ¬æ–‡é“¾æ¥ï¼š<a href="https://colsrch.cn/posts/32c8ba21/">https://colsrch.cn/posts/32c8ba21/</a><br>hexo-offline-popup<br>hexo-offline-popup æ˜¯ä¸€ä¸ª hexo æ’ä»¶ï¼Œ å®ƒå¯åŠ é€Ÿä½ çš„Hexoç½‘ç«™çš„åŠ è½½é€Ÿåº¦ï¼Œä»¥åŠç½‘ç«™å†…å®¹æ›´æ–°å¼¹çª—æç¤ºã€‚</p><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>åœ¨Hexoæ ¹ç›®å½•æ‰“å¼€<code>Git-bash</code> ï¼Œæ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-offline-popup --save</span><br></pre></td></tr></table></figure><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>åœ¨åšå®¢æ ¹ç›®å½•çš„<code>_config.yml</code>ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># offline config passed to sw-precache.</span></span><br><span class="line">service_worker:</span><br><span class="line">  maximumFileSizeToCacheInBytes: 5242880</span><br><span class="line">  staticFileGlobs:</span><br><span class="line">  - public/**/*.&#123;js,html,css,png,jpg,gif,svg,eot,ttf,woff,woff2&#125;</span><br><span class="line">  stripPrefix: public</span><br><span class="line">  verbose: <span class="literal">true</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦‚æœä½ æœ‰CDNèµ„æºï¼Œä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- https://unpkg.com/artitalk</span><br><span class="line">- https://cdn.jsdelivr.net/npm/artitalk</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†æ­¤é…ç½®æ·»åŠ åˆ°æ ¹ç›®å½•çš„<code>_config.yml</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">service_worker:</span><br><span class="line">  runtimeCaching:</span><br><span class="line">    - urlPattern: /*</span><br><span class="line">      handler: cacheFirst</span><br><span class="line">      options:</span><br><span class="line">        origin: unpkg.com</span><br><span class="line">    - urlPattern: /*</span><br><span class="line">      handler: cacheFirst</span><br><span class="line">      options:</span><br><span class="line">        origin: cdn.jsdelivr.net</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="ä¸Šä¼ "><a href="#ä¸Šä¼ " class="headerlink" title="ä¸Šä¼ "></a>ä¸Šä¼ </h3><p>æ‰§è¡Œè¯¥ä»£ç æ¿€æ´»å¹¶ä½¿ç”¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl &amp;&amp; hexo g -d</span><br></pre></td></tr></table></figure><p>æ¼”ç¤º<br>ç”±äºè¯¥å¼¹çª—ä»…åœ¨åšå®¢æ›´æ–°æ—¶ä¼šå¼¹å‡ºï¼Œå› æ­¤ç•™äº†ä¸€ä¸ªå¼¹çª—æ¼”ç¤ºç«™</p><p>å¼¹çª—æ¼”ç¤ºç«™ï¼š<a href="https://pfc049.coding-pages.com/">https://pfc049.coding-pages.com/</a></p><p>FAQ<br>å®‰è£…åæœªå¼¹çª—<br>è¯¥æ’ä»¶ä»…éƒ¨ç½²åç”Ÿæ•ˆï¼Œæœ¬åœ°è¿è¡Œä¸ç”Ÿæ•ˆ<br>å®‰è£…è¯¥æ’ä»¶åç¬¬ä¸€æ¬¡æ‰“å¼€ç½‘ç«™ä¸å¼¹çª—ï¼Œåç»­æ›´æ–°å°†ä¼šå¼¹çª—<br>æ’ä»¶åœ°å€ï¼šhexo-offline-popup<br>ç‰ˆæƒå£°æ˜ï¼šæœ¬ç½‘ç«™æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ CC BY-NC-SA 4.0 è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª Colsrchâ€™Blog</p><p>åŸæ–‡é“¾æ¥1ï¼š<a href="https://blog.csdn.net/qq_43625917/article/details/104136304">https://blog.csdn.net/qq_43625917/article/details/104136304</a></p><p>åŸæ–‡é“¾æ¥2ï¼š<a href="https://blog.csdn.net/qq_42830477/article/details/107296226">https://blog.csdn.net/qq_42830477/article/details/107296226</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ–°å¹´å¿«ä¹ï¼</title>
      <link href="/2025/01/23/%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90%EF%BC%81/"/>
      <url>/2025/01/23/%E6%96%B0%E5%B9%B4%E5%BF%AB%E4%B9%90%EF%BC%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="æ–°å¹´å¿«ä¹ï¼"><a href="#æ–°å¹´å¿«ä¹ï¼" class="headerlink" title="æ–°å¹´å¿«ä¹ï¼"></a>æ–°å¹´å¿«ä¹ï¼</h1><p><img src="https://f005.backblazeb2.com/file/ZzNnWn-Images/ZzNnWn-Images/8ef4486c-c914-4932-ab06-5c073a639b79.webp"></p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é­”æ”¹ç¬”è®°ä¸‰ï¼šæ–‡ç« ä¸‰æ ï¼ˆåº—é•¿+å¾®è°ƒï¼‰</title>
      <link href="/2025/01/22/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E4%B8%89%EF%BC%9A%E6%96%87%E7%AB%A0%E4%B8%89%E6%A0%8F%EF%BC%88%E5%BA%97%E9%95%BF+%E5%BE%AE%E8%B0%83%EF%BC%89/"/>
      <url>/2025/01/22/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E4%B8%89%EF%BC%9A%E6%96%87%E7%AB%A0%E4%B8%89%E6%A0%8F%EF%BC%88%E5%BA%97%E9%95%BF+%E5%BE%AE%E8%B0%83%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="é­”æ”¹ç¬”è®°ä¸‰ï¼šæ–‡ç« ä¸‰æ ï¼ˆåº—é•¿-å¾®è°ƒï¼‰"><a href="#é­”æ”¹ç¬”è®°ä¸‰ï¼šæ–‡ç« ä¸‰æ ï¼ˆåº—é•¿-å¾®è°ƒï¼‰" class="headerlink" title="é­”æ”¹ç¬”è®°ä¸‰ï¼šæ–‡ç« ä¸‰æ ï¼ˆåº—é•¿+å¾®è°ƒï¼‰"></a>é­”æ”¹ç¬”è®°ä¸‰ï¼šæ–‡ç« ä¸‰æ ï¼ˆåº—é•¿+å¾®è°ƒï¼‰</h1><h2 id="æ•™ç¨‹"><a href="#æ•™ç¨‹" class="headerlink" title="æ•™ç¨‹"></a>æ•™ç¨‹</h2><p>æœ¬ç½‘ç«™é‡‡ç”¨çš„æ˜¯ä¸‰æ +å“åº”å¼å¸ƒå±€çš„æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯slidecardçš„æ–¹æ¡ˆï¼Œä½†æ˜¯ä¸ºäº†å¯æ‹“å±•æ€§ï¼Œæˆ‘è¿˜æ˜¯æŠŠä¸¤ç§éƒ½æ¬äº†è¿‡æ¥ï¼Œæ–¹ä¾¿å¤§å®¶é˜…è¯»ï¼</p><p>1ã€ä¿®æ”¹<code>[BlogRoot]\themes\butterfly\layout\includes\mixins\post-ui.pug</code>,æ•´ä¸ªæ›¿æ¢ä¸ºä¸‹é¢çš„ä»£ç ï¼Œæ³¨æ„ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯å½©è‰²çš„å›¾æ ‡ï¼Œæ¯ä¸ª<code>//- i.fas</code>é‚£é‡Œè¡¨ç¤ºæˆ‘æ³¨é‡Šäº†é»‘ç™½çš„é¢å›¾æ ‡å¹¶æ¢ä¸Šå½©è‰²å›¾æ ‡ï¼Œå½©è‰²å›¾æ ‡å¼•å…¥çš„å…·ä½“æ–¹æ³•è§ä¹‹å‰çš„æ•™ç¨‹ï¼Œè¿™é‡Œåªéœ€è¦æ›¿æ¢æˆä½ è‡ªå·±çš„<code>å›¾æ ‡åå­—</code>å’Œè°ƒèŠ‚ç›¸åº”çš„<code>å¤§å°</code>å³å¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line">mixin postUI(posts)</span><br><span class="line">  each article , index in page.posts.data</span><br><span class="line">    .recent-post-item</span><br><span class="line">      -</span><br><span class="line">        let link = article.link || article.path</span><br><span class="line">        let title = article.title || _p(&#x27;no_title&#x27;)</span><br><span class="line">        const position = theme.cover.position</span><br><span class="line">        let leftOrRight = position === &#x27;both&#x27;</span><br><span class="line">          ? index%2 == 0 ? &#x27;left&#x27; : &#x27;right&#x27;</span><br><span class="line">          : position === &#x27;left&#x27; ? &#x27;left&#x27; : &#x27;right&#x27;</span><br><span class="line">        let post_cover = article.cover</span><br><span class="line">        let no_cover = article.cover === false || !theme.cover.index_enable ? &#x27;no-cover&#x27; : &#x27;&#x27;</span><br><span class="line">      -</span><br><span class="line">      .recent-post-content(class=leftOrRight)</span><br><span class="line">        .recent-post-cover</span><br><span class="line">          img.article-cover(src=url_for(post_cover) onerror=`this.onerror=null;this.src=&#x27;`+ url_for(theme.error_img.post_page) + `&#x27;` alt=title)</span><br><span class="line">        .recent-post-info</span><br><span class="line">          a.article-title(href=url_for(link) title=title)</span><br><span class="line">            .article-title-link= title</span><br><span class="line">          .recent-post-meta            </span><br><span class="line">            .article-meta-wrap</span><br><span class="line">              if (is_home() &amp;&amp; (article.top || article.sticky &gt; 0))</span><br><span class="line">                span.article-meta</span><br><span class="line">                  //- i.fas.fa-thumbtack.sticky</span><br><span class="line">                  svg.meta_icon(style=&quot;width:16px;height:16px;position:relative;top:3px&quot;).post-ui-icon</span><br><span class="line">                    use(xlink:href=&#x27;#icon-tuding&#x27;)</span><br><span class="line">                  span.sticky= _p(&#x27;sticky&#x27;)</span><br><span class="line">                  span.article-meta-separator  | </span><br><span class="line">              if (theme.post_meta.page.date_type)</span><br><span class="line">                span.post-meta-date</span><br><span class="line">                  if (theme.post_meta.page.date_type === &#x27;both&#x27;)</span><br><span class="line">                    //- i.far.fa-calendar-alt</span><br><span class="line">                    svg.meta_icon(style=&quot;width:21px;height:21px;position:relative;top:6px&quot;).post-ui-icon</span><br><span class="line">                      use(xlink:href=&#x27;#icon-rili&#x27;)</span><br><span class="line">                    span.article-meta-label=_p(&#x27;post.created&#x27;)</span><br><span class="line">                    time.post-meta-date-created(datetime=date_xml(article.date) title=_p(&#x27;post.created&#x27;) + &#x27; &#x27; + full_date(article.date))=date(article.date, config.date_format)</span><br><span class="line">                    span.article-meta-separator  | </span><br><span class="line">                    //- i.fas.fa-history</span><br><span class="line">                    svg.meta_icon(style=&quot;width:13px;height:13px;position:relative;top:2px&quot;).post-ui-icon</span><br><span class="line">                      use(xlink:href=&#x27;#icon-gengxin1&#x27;)                </span><br><span class="line">                    span.article-meta-label=_p(&#x27;post.updated&#x27;) + &quot; &quot;</span><br><span class="line">                    time.post-meta-date-updated(datetime=date_xml(article.updated) title=_p(&#x27;post.updated&#x27;) + &#x27; &#x27; + full_date(article.updated))=date(article.updated, config.date_format)</span><br><span class="line">                  else</span><br><span class="line">                    - let data_type_updated = theme.post_meta.page.date_type === &#x27;updated&#x27;</span><br><span class="line">                    - let date_type = data_type_updated ? &#x27;updated&#x27; : &#x27;date&#x27;</span><br><span class="line">                    - let date_icon = data_type_updated ? &#x27;fas fa-history&#x27; :&#x27;far fa-calendar-alt&#x27;</span><br><span class="line">                    - let date_title = data_type_updated ? _p(&#x27;post.updated&#x27;) : _p(&#x27;post.created&#x27;)</span><br><span class="line">                    i(class=date_icon)</span><br><span class="line">                    span.article-meta-label=date_title</span><br><span class="line">                    time(datetime=date_xml(article[date_type]) title=date_title + &#x27; &#x27; + full_date(article[date_type]))=date(article[date_type], config.date_format)</span><br><span class="line">              if (theme.post_meta.page.categories &amp;&amp; article.categories.data.length &gt; 0)</span><br><span class="line">                span.article-meta</span><br><span class="line">                  span.article-meta-separator  | </span><br><span class="line">                  //- i.fas.fa-inbox</span><br><span class="line">                  svg.meta_icon(style=&quot;width:12px;height:12px;position:relative;top:1px&quot;).post-ui-icon</span><br><span class="line">                    use(xlink:href=&#x27;#icon-fenlei&#x27;)</span><br><span class="line">                  each item, index in article.categories.data</span><br><span class="line">                    a(href=url_for(item.path)).article-meta__categories #[=item.name]</span><br><span class="line">                    if (index &lt; article.categories.data.length - 1)</span><br><span class="line">                      i.fas.fa-angle-right.article-meta-link</span><br><span class="line">              if (theme.post_meta.page.tags &amp;&amp; article.tags.data.length &gt; 0)</span><br><span class="line">                span.article-meta.tags</span><br><span class="line">                  span.article-meta-separator  | </span><br><span class="line">                  //- i.fas.fa-tag</span><br><span class="line">                  svg.meta_icon(style=&quot;width:13px;height:13px;position:relative;top:2px&quot;).post-ui-icon</span><br><span class="line">                    use(xlink:href=&#x27;#icon-biaoqian&#x27;)</span><br><span class="line">                  each item, index in article.tags.data</span><br><span class="line">                    a(href=url_for(item.path)).article-meta__tags #[=item.name]</span><br><span class="line">                    if (index &lt; article.tags.data.length - 1)</span><br><span class="line">                      span.article-meta-link #[=&#x27; â€¢ &#x27;]</span><br><span class="line">          </span><br><span class="line">              mixin countBlockInIndex</span><br><span class="line">                - needLoadCountJs = true</span><br><span class="line">                span.article-meta</span><br><span class="line">                  span.article-meta-separator  | </span><br><span class="line">                  //- i.fas.fa-comments</span><br><span class="line">                  svg.meta_icon(style=&quot;width:13px;height:13px;position:relative;top:2px&quot;).post-ui-icon</span><br><span class="line">                    use(xlink:href=&#x27;#icon-pinglun1&#x27;)</span><br><span class="line">                  if block</span><br><span class="line">                    block</span><br><span class="line">                  span.article-meta-label= &#x27; &#x27; + _p(&#x27;card_post_count&#x27;)</span><br><span class="line">          </span><br><span class="line">              if theme.comments.card_post_count</span><br><span class="line">                case theme.comments.use[0]</span><br><span class="line">                  when &#x27;Disqus&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=full_url_for(link) + &#x27;#disqus_thread&#x27;)</span><br><span class="line">                        i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Disqusjs&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=full_url_for(link) + &#x27;#disqusjs&#x27;)</span><br><span class="line">                        span.disqus-comment-count(data-disqus-url=full_url_for(link))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Valine&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.valine-comment-count(data-xid=url_for(link))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Waline&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.waline-comment-count(id=url_for(link))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Twikoo&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a.twikoo-count(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Facebook Comments&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.fb-comments-count(data-href=urlNoIndex(article.permalink))</span><br><span class="line">                  when &#x27;Remark42&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.remark42__counter(data-url=urlNoIndex(article.permalink))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin</span><br><span class="line">                  when &#x27;Artalk&#x27;</span><br><span class="line">                    +countBlockInIndex</span><br><span class="line">                      a(href=url_for(link) + &#x27;#post-comment&#x27;)</span><br><span class="line">                        span.artalk-count(data-page-key=url_for(link))</span><br><span class="line">                          i.fa-solid.fa-spinner.fa-spin  </span><br><span class="line">        a.article-content(href=url_for(link) title=title)</span><br><span class="line">          //- Display the article introduction on homepage</span><br><span class="line">          case theme.index_post_content.method</span><br><span class="line">            when false</span><br><span class="line">              - break</span><br><span class="line">            when 1</span><br><span class="line">              .article-content-text!= article.description</span><br><span class="line">            when 2</span><br><span class="line">              if article.description</span><br><span class="line">                .article-content-text!= article.description</span><br><span class="line">              else</span><br><span class="line">                - const content = strip_html(article.content)</span><br><span class="line">                - let expert = content.substring(0, theme.index_post_content.length) </span><br><span class="line">                - content.length &gt; theme.index_post_content.length ? expert += &#x27; ...&#x27; : &#x27;&#x27;</span><br><span class="line">                .article-content-text!= expert</span><br><span class="line">            default</span><br><span class="line">              - const content = strip_html(article.content)</span><br><span class="line">              - let expert = content.substring(0, theme.index_post_content.length) </span><br><span class="line">              - content.length &gt; theme.index_post_content.length ? expert += &#x27; ...&#x27; : &#x27;&#x27;</span><br><span class="line">              .article-content-text!= expert  </span><br><span class="line">        .recent-post-arrow</span><br><span class="line"></span><br><span class="line">    if theme.ad &amp;&amp; theme.ad.index</span><br><span class="line">      if (index + 1) % 3 == 0</span><br><span class="line">        .recent-post-item.ads-wrap!=theme.ad.index</span><br></pre></td></tr></table></figure><p>2ã€æ ·å¼æ–¹æ¡ˆæä¾›ä¸¤ç§ï¼š</p><ul><li>æ ·å¼ä¸€ï¼šç”µè„‘ç«¯å®½å±é‡‡ç”¨æ»‘åŠ¨å¡ç‰‡ï¼Œå¹³æ¿å®½åº¦é‡‡ç”¨åŒæ å¸ƒå±€ï¼Œæ‰‹æœºå®½åº¦é‡‡ç”¨å•æ å¡ç‰‡</li><li>æ ·å¼äºŒï¼šç§»é™¤æ»‘åŠ¨å¡ç‰‡ï¼ŒæŒ‰å±å¹•å®½åº¦ä¾æ¬¡åº”ç”¨ä¸‰æ ã€åŒæ ã€å•æ </li></ul><p>æ–°å»ºç›®å½•<code>[BlogRoot]\themes\butterfly\source\css\_index_card_style\</code>,å¹¶åœ¨ä¸‹é¢æ–°å»ºå¯¹åº”çš„æ–‡ä»¶<code>slidecard.styl</code>å’Œ<code>multicard.styl</code>å¹¶åˆ†åˆ«å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼Œç¬¬ä¸€ä¸ªæ»‘åŠ¨å¡ç‰‡çš„æ˜¯åº—é•¿åŸç‰ˆçš„ï¼Œæˆ‘å¾®è°ƒä¸€ä¸‹ç¬¬äºŒä¸ªçš„æ ·å¼ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„é€‰æ‹©è¿›è¡Œä¿®æ”¹ï¼š</p><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">æ ·å¼1ï¼šslidecard</button></li><li class="tab"><button type="button" data-href="#test4-2">æ ·å¼2ï¼šmulticard</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br></pre></td><td class="code"><pre><span class="line">//default color:</span><br><span class="line">:root</span><br><span class="line">  --recent-post-bgcolor: rgba(255, 255, 255, 0.9)  //é»˜è®¤èƒŒæ™¯</span><br><span class="line">  --article-content-bgcolor: <span class="comment">#49b1f5 //æè¿°ç‰ˆå—èƒŒæ™¯</span></span><br><span class="line">  --recent-post-arrow: <span class="comment">#ffffff //ç®­å¤´é…è‰²</span></span><br><span class="line">  --recent-post-cover-shadow: <span class="comment">#ffffff //å°é¢é®ç½©å±‚é…è‰²ï¼Œå»ºè®®å’Œé»˜è®¤å€¼çš„é¢œè‰²ç›¸å¯¹åº”ã€‚</span></span><br><span class="line">  --recent-post-transition: all 0.5s cubic-bezier(0.59, 0.01, 0.48, 1.17)  //åŠ¨ç”»æ•ˆæœã€‚ä¸äº†è§£çš„ä¸è¦æ”¹åŠ¨</span><br><span class="line">[data-theme=<span class="string">&quot;dark&quot;</span>]</span><br><span class="line">  --recent-post-bgcolor: rgba(35,35,35,0.5)</span><br><span class="line">  --article-content-bgcolor: <span class="comment">#99999a</span></span><br><span class="line">  --recent-post-arrow: <span class="comment">#37e2dd</span></span><br><span class="line">  --recent-post-cover-shadow: <span class="comment">#232323</span></span><br><span class="line">// é»˜è®¤çš„é¦–é¡µå¡ç‰‡å®¹å™¨å¸ƒå±€</span><br><span class="line">.recent-posts</span><br><span class="line">  padding 0 15px 0 15px</span><br><span class="line">  height fit-content</span><br><span class="line">  .recent-post-item</span><br><span class="line">    margin-bottom 15px</span><br><span class="line">    width 100%</span><br><span class="line">    background var(--recent-post-bgcolor)</span><br><span class="line">    overflow hidden</span><br><span class="line">    border-radius 15px</span><br><span class="line">    .recent-post-content</span><br><span class="line">      display flex</span><br><span class="line">      background var(--recent-post-bgcolor)</span><br><span class="line">      position relative</span><br><span class="line">      .recent-post-cover</span><br><span class="line">        display flex</span><br><span class="line">        background transparent</span><br><span class="line">      .recent-post-info</span><br><span class="line">        display flex</span><br><span class="line">        background transparent</span><br><span class="line">        flex-direction column</span><br><span class="line">        justify-content center</span><br><span class="line">        align-items center</span><br><span class="line">        .article-title</span><br><span class="line">          height 50%</span><br><span class="line">          display: flex</span><br><span class="line">          text-align: center</span><br><span class="line">          align-items: center</span><br><span class="line">          justify-content: flex-end</span><br><span class="line">          flex-direction: column</span><br><span class="line">          .article-title-link</span><br><span class="line">            color: var(--text-highlight-color)</span><br><span class="line">            transition: all .2s ease-in-out</span><br><span class="line">            display: -webkit-box;</span><br><span class="line">            -webkit-box-orient: vertical;</span><br><span class="line">            overflow: hidden;</span><br><span class="line">            &amp;:hover</span><br><span class="line">              color: <span class="variable">$text</span>-hover</span><br><span class="line">        .recent-post-meta</span><br><span class="line">          height 50%</span><br><span class="line">          display: flex</span><br><span class="line">          text-align: center</span><br><span class="line">          align-items: center</span><br><span class="line">          justify-content: flex-start</span><br><span class="line">          flex-direction: column</span><br><span class="line">          .article-meta-wrap</span><br><span class="line">            color <span class="comment">#969797</span></span><br><span class="line">            display: -webkit-box;</span><br><span class="line">            -webkit-box-orient: vertical;</span><br><span class="line">            overflow: hidden;</span><br><span class="line">            a</span><br><span class="line">              color: var(--text-highlight-color)</span><br><span class="line">              transition: all .2s ease-in-out</span><br><span class="line">              color <span class="comment">#969797</span></span><br><span class="line">              &amp;:hover</span><br><span class="line">                color: <span class="variable">$text</span>-hover</span><br><span class="line">      .article-content</span><br><span class="line">        display flex</span><br><span class="line">        text-align: center</span><br><span class="line">        flex-direction row</span><br><span class="line">        align-items center</span><br><span class="line">        justify-content center</span><br><span class="line">        .article-content-text</span><br><span class="line">          display -webkit-box</span><br><span class="line">          -webkit-box-orient vertical</span><br><span class="line">          text-overflow: ellipsis</span><br><span class="line">          overflow hidden</span><br><span class="line">          color <span class="comment">#fff</span></span><br><span class="line">          text-shadow 1px 2px 3px <span class="comment">#000</span></span><br><span class="line">          &amp;::before</span><br><span class="line">            content <span class="string">&quot;â&quot;</span></span><br><span class="line">            font-size 20px</span><br><span class="line">          &amp;::after</span><br><span class="line">            content <span class="string">&quot;â&quot;</span></span><br><span class="line">            font-size 20px</span><br><span class="line">    &amp;.ads-wrap</span><br><span class="line">      display: block !important</span><br><span class="line">      height: auto !important</span><br><span class="line">// PCç«¯æ»‘åŠ¨å¡ç‰‡æ ·å¼</span><br><span class="line">@media screen and (min-width:1069px)</span><br><span class="line">  .recent-posts</span><br><span class="line">    padding 0 15px 0 15px</span><br><span class="line">    .recent-post-item</span><br><span class="line">      .recent-post-content</span><br><span class="line">        position relative</span><br><span class="line">        height 200px</span><br><span class="line">        width 100%</span><br><span class="line">        transition var(--recent-post-transition)</span><br><span class="line">        &amp;:hover</span><br><span class="line">          .recent-post-cover-shadow</span><br><span class="line">            width 10.1%</span><br><span class="line">            transition var(--recent-post-transition)</span><br><span class="line">          .recent-post-cover</span><br><span class="line">            width 10%</span><br><span class="line">            transition var(--recent-post-transition)</span><br><span class="line">          .article-content</span><br><span class="line">            width calc(30% + 80px)</span><br><span class="line">            transition var(--recent-post-transition)</span><br><span class="line">            .article-content-text</span><br><span class="line">              opacity 1</span><br><span class="line">          .recent-post-arrow</span><br><span class="line">            transition var(--recent-post-transition)</span><br><span class="line">        .recent-post-cover-shadow</span><br><span class="line">          z-index: 1</span><br><span class="line">          transition var(--recent-post-transition)</span><br><span class="line">          position: absolute</span><br><span class="line">          height 200px</span><br><span class="line">          width 40%</span><br><span class="line">        .recent-post-cover</span><br><span class="line">          height 200px</span><br><span class="line">          width 40%</span><br><span class="line">          transition var(--recent-post-transition)</span><br><span class="line">          img</span><br><span class="line">            height 100%</span><br><span class="line">            width 100%</span><br><span class="line">            object-fit cover</span><br><span class="line"></span><br><span class="line">        .recent-post-info</span><br><span class="line">          height 200px</span><br><span class="line">          width calc(60% - 80px)</span><br><span class="line">          .article-title</span><br><span class="line">            margin: 0px 40px</span><br><span class="line">            font-size 24px</span><br><span class="line">            .article-title-link</span><br><span class="line">              -webkit-line-clamp: 2;</span><br><span class="line">          .recent-post-meta</span><br><span class="line">            margin: 0px 20px</span><br><span class="line">            .article-meta-wrap</span><br><span class="line">              font-size 12px</span><br><span class="line">              -webkit-line-clamp: 3;</span><br><span class="line">        .article-content</span><br><span class="line">          height 200px</span><br><span class="line">          width 90px</span><br><span class="line">          background var(--article-content-bgcolor)</span><br><span class="line">          transition var(--recent-post-transition)</span><br><span class="line">          .article-content-text</span><br><span class="line">            -webkit-line-clamp 4</span><br><span class="line">            transition: var(--recent-post-transition)</span><br><span class="line">            opacity 0</span><br><span class="line">        .recent-post-arrow</span><br><span class="line">          transition var(--recent-post-transition)</span><br><span class="line">          display block</span><br><span class="line">          position absolute</span><br><span class="line">          height 20px</span><br><span class="line">          width 8px</span><br><span class="line">          background var(--recent-post-arrow)</span><br><span class="line">        &amp;.both,</span><br><span class="line">        &amp;.right</span><br><span class="line">          .recent-post-cover-shadow</span><br><span class="line">            left 0</span><br><span class="line">            background linear-gradient(to left, var(--recent-post-cover-shadow), transparent)</span><br><span class="line">          .recent-post-cover</span><br><span class="line">            order: 1</span><br><span class="line">          .recent-post-info</span><br><span class="line">            order: 2</span><br><span class="line">          .article-content</span><br><span class="line">            order: 3</span><br><span class="line">            clip-path polygon(0 50%, 80px 0, 100% 0, 100% 100%, 80px 100%)</span><br><span class="line">            .article-content-text</span><br><span class="line">              margin 20px 40px 20px 80px</span><br><span class="line">          .recent-post-arrow</span><br><span class="line">            order: 4</span><br><span class="line">            left calc(100% - 80px)</span><br><span class="line">            top calc(50% - 10px)</span><br><span class="line">            clip-path polygon(0 10px, 8px 0, 8px 20px)</span><br><span class="line">          &amp;:hover</span><br><span class="line">            .recent-post-arrow</span><br><span class="line">              left calc(100% - 40px)</span><br><span class="line">        &amp;.left</span><br><span class="line">          .recent-post-cover-shadow</span><br><span class="line">            right 0</span><br><span class="line">            background linear-gradient(to right, var(--recent-post-cover-shadow), transparent)</span><br><span class="line">          .recent-post-cover</span><br><span class="line">            order: 4</span><br><span class="line">          .recent-post-info</span><br><span class="line">            order: 3</span><br><span class="line">          .article-content</span><br><span class="line">            order: 2</span><br><span class="line">            clip-path polygon(100% 50%,calc(100% - 80px) 100%,0 100%,0 0,calc(100% - 80px) 0)</span><br><span class="line">            .article-content-text</span><br><span class="line">              margin 20px 80px 20px 40px</span><br><span class="line">          .recent-post-arrow</span><br><span class="line">            order: 1</span><br><span class="line">            left 72px</span><br><span class="line">            top calc(50% - 10px)</span><br><span class="line">            clip-path polygon(0 0, 8px 10px, 0 20px)</span><br><span class="line">          &amp;:hover</span><br><span class="line">            .recent-post-arrow</span><br><span class="line">              left 32px</span><br><span class="line">// åŒæ å¸ƒå±€å¡ç‰‡è‡ªé€‚åº”é€‚é…</span><br><span class="line">@media screen and (min-width:572px) and (max-width:1068px)</span><br><span class="line">  .recent-posts</span><br><span class="line">    padding 0 15px 0 15px</span><br><span class="line">    display flex</span><br><span class="line">    flex-direction row</span><br><span class="line">    flex-wrap wrap</span><br><span class="line">    .recent-post-item</span><br><span class="line">      border-radius 15px</span><br><span class="line">      overflow hidden</span><br><span class="line">      width 47%</span><br><span class="line">      margin 0px 3% 20px 0px</span><br><span class="line">    nav<span class="comment">#pagination</span></span><br><span class="line">      width: 100%</span><br><span class="line">// æ‰‹æœºç«¯å•æ å¸ƒå±€è‡ªé€‚åº”é€‚é…</span><br><span class="line">@media screen and (max-width:572px)</span><br><span class="line">  .recent-posts</span><br><span class="line">    padding 0 15px 0 15px</span><br><span class="line">    .recent-post-item</span><br><span class="line">      border-radius 15px</span><br><span class="line">      overflow hidden</span><br><span class="line">    </span><br><span class="line">// æ‰‹æœºç«¯åŠåŒæ å¡ç‰‡æ ·å¼</span><br><span class="line">@media screen and (max-width:1068px)</span><br><span class="line">  .recent-posts</span><br><span class="line">    .recent-post-item</span><br><span class="line">      .recent-post-content</span><br><span class="line">        flex-direction column</span><br><span class="line">        flex-wrap nowrap</span><br><span class="line">        align-items center</span><br><span class="line">        max-height 350px</span><br><span class="line">        height: auto </span><br><span class="line">        width 100%</span><br><span class="line">        .recent-post-cover</span><br><span class="line">          width 100%</span><br><span class="line">          height 200px</span><br><span class="line">          clip-path polygon(0 130px,0 0,100% 0,100% 130px,50% 100%)</span><br><span class="line">          img</span><br><span class="line">            height 200px</span><br><span class="line">            width 100%</span><br><span class="line">            object-fit cover</span><br><span class="line">        .recent-post-info</span><br><span class="line">          height 150px</span><br><span class="line">          width 100%</span><br><span class="line">          padding 0px 25px 5px 25px</span><br><span class="line">          .article-title</span><br><span class="line">            margin: 0px 40px</span><br><span class="line">            font-size 18px</span><br><span class="line">            .article-title-link</span><br><span class="line">              -webkit-line-clamp: 2;</span><br><span class="line">          .recent-post-meta</span><br><span class="line">            margin: 0px 20px</span><br><span class="line">            .article-meta-wrap</span><br><span class="line">              font-size 12px</span><br><span class="line">              -webkit-line-clamp: 3;</span><br><span class="line">        .article-content</span><br><span class="line">          position absolute</span><br><span class="line">          height 200px</span><br><span class="line">          width 100%</span><br><span class="line">          background rgba(25,25,25,0.5)</span><br><span class="line">          clip-path polygon(0 130px,0 0,100% 0,100% 130px,50% 100%)</span><br><span class="line">          .article-content-text</span><br><span class="line">            -webkit-line-clamp 3</span><br><span class="line">            font-size 16px</span><br><span class="line">            margin 0px 25px 30px 25px</span><br><span class="line">        .recent-post-arrow</span><br><span class="line">          display block</span><br><span class="line">          background var(--article-content-bgcolor)</span><br><span class="line">          position absolute</span><br><span class="line">          height 10px</span><br><span class="line">          width 20px</span><br><span class="line">          clip-path polygon(0 0,100% 0,50% 100%)</span><br><span class="line">          top 20px</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">:root</span><br><span class="line">  --theme-color:rgb(57, 197, 187)</span><br><span class="line">  --text-bg-hover:rgba(57, 197, 187, 0.7)</span><br><span class="line">  </span><br><span class="line">.recent-posts</span><br><span class="line">  padding 0 5px 0 5px</span><br><span class="line">  height fit-content</span><br><span class="line">  .recent-post-item</span><br><span class="line">    margin-bottom 15px</span><br><span class="line">    overflow hidden</span><br><span class="line">    border-radius 15px</span><br><span class="line">    .recent-post-content</span><br><span class="line">      display flex</span><br><span class="line">      position relative</span><br><span class="line">      .recent-post-cover</span><br><span class="line">        display flex</span><br><span class="line">        background transparent</span><br><span class="line">      .recent-post-info</span><br><span class="line">        display flex</span><br><span class="line">        background transparent</span><br><span class="line">        flex-direction column</span><br><span class="line">        justify-content center</span><br><span class="line">        align-items center</span><br><span class="line">        .article-title</span><br><span class="line">          height 50%</span><br><span class="line">          display: flex</span><br><span class="line">          text-align: center</span><br><span class="line">          align-items: center</span><br><span class="line">          justify-content: flex-end</span><br><span class="line">          flex-direction: column</span><br><span class="line">          .article-title-link</span><br><span class="line">            color: var(--text-highlight-color)</span><br><span class="line">            transition: all .2s ease-in-out</span><br><span class="line">            display: -webkit-box;</span><br><span class="line">            -webkit-box-orient: vertical;</span><br><span class="line">            overflow: hidden;</span><br><span class="line">            &amp;:hover</span><br><span class="line">              color: var(--theme-color)</span><br><span class="line">        .recent-post-meta</span><br><span class="line">          height 50%</span><br><span class="line">          display: flex</span><br><span class="line">          text-align: center</span><br><span class="line">          align-items: center</span><br><span class="line">          justify-content: flex-start</span><br><span class="line">          flex-direction: column</span><br><span class="line">          .article-meta-wrap</span><br><span class="line">            color <span class="comment">#969797</span></span><br><span class="line">            display: -webkit-box;</span><br><span class="line">            -webkit-box-orient: vertical;</span><br><span class="line">            overflow: hidden;</span><br><span class="line">            a</span><br><span class="line">              color: var(--text-highlight-color)</span><br><span class="line">              transition: all .2s ease-in-out</span><br><span class="line">              color <span class="comment">#969797</span></span><br><span class="line">              &amp;:hover</span><br><span class="line">                color: var(--theme-color)</span><br><span class="line">      .article-content</span><br><span class="line">        display flex</span><br><span class="line">        text-align: center</span><br><span class="line">        flex-direction row</span><br><span class="line">        align-items center</span><br><span class="line">        justify-content center</span><br><span class="line">        .article-content-text</span><br><span class="line">          display -webkit-box</span><br><span class="line">          -webkit-box-orient vertical</span><br><span class="line">          text-overflow: ellipsis</span><br><span class="line">          overflow hidden</span><br><span class="line">          color <span class="comment">#fff</span></span><br><span class="line">          text-shadow 1px 2px 3px <span class="comment">#000</span></span><br><span class="line">          transition transform 0.6s;</span><br><span class="line">          &amp;:hover</span><br><span class="line">            transform: scale(1.1);</span><br><span class="line">    &amp;.ads-wrap</span><br><span class="line">      display: block !important</span><br><span class="line">      height: auto !important</span><br><span class="line">  nav<span class="comment">#pagination</span></span><br><span class="line">    width: 100%</span><br><span class="line">// å¡ç‰‡å•å…ƒå¸ƒå±€æ ·å¼</span><br><span class="line">.recent-posts</span><br><span class="line">  padding 0 5px 0 5px</span><br><span class="line">  display flex</span><br><span class="line">  flex-direction row</span><br><span class="line">  flex-wrap wrap</span><br><span class="line">  .recent-post-item</span><br><span class="line">    border-radius 15px</span><br><span class="line">    overflow hidden</span><br><span class="line">    .recent-post-content</span><br><span class="line">      flex-direction column</span><br><span class="line">      flex-wrap nowrap</span><br><span class="line">      align-items center</span><br><span class="line">      max-height 350px</span><br><span class="line">      height: auto</span><br><span class="line">      width 100%</span><br><span class="line">      .recent-post-cover</span><br><span class="line">        width 100%</span><br><span class="line">        height 200px</span><br><span class="line">        clip-path polygon(0 130px,0 0,100% 0,100% 130px,50% 100%)</span><br><span class="line">        img</span><br><span class="line">          height 200px</span><br><span class="line">          width 100%</span><br><span class="line">          object-fit cover</span><br><span class="line">      .recent-post-info</span><br><span class="line">        height 145px</span><br><span class="line">        width 100%</span><br><span class="line">        padding 0px 25px 5px 25px</span><br><span class="line">        .article-title</span><br><span class="line">          margin: 0px 40px</span><br><span class="line">          font-size 19px</span><br><span class="line">          .article-title-link</span><br><span class="line">            -webkit-line-clamp: 2;</span><br><span class="line">        .recent-post-meta</span><br><span class="line">          margin: 0px 20px</span><br><span class="line">          .article-meta-wrap</span><br><span class="line">            font-size 13px</span><br><span class="line">            -webkit-line-clamp: 3;</span><br><span class="line">      .article-content</span><br><span class="line">        position absolute</span><br><span class="line">        height 200px</span><br><span class="line">        width 100%</span><br><span class="line">        background rgba(25,25,25,0.4)</span><br><span class="line">        clip-path polygon(0 130px,0 0,100% 0,100% 130px,50% 100%)</span><br><span class="line">        .article-content-text</span><br><span class="line">          -webkit-line-clamp 3</span><br><span class="line">          font-size 16px</span><br><span class="line">          margin 0px 25px 30px 25px</span><br><span class="line">          &amp;::before</span><br><span class="line">            content <span class="string">&quot;ã€Œ&quot;</span></span><br><span class="line">            font-size 20px</span><br><span class="line">          &amp;::after</span><br><span class="line">            content <span class="string">&quot;ã€&quot;</span></span><br><span class="line">            font-size 20px</span><br><span class="line">      .recent-post-arrow</span><br><span class="line">        display block</span><br><span class="line">        background var(--text-bg-hover)</span><br><span class="line">        position absolute</span><br><span class="line">        height 10px</span><br><span class="line">        width 20px</span><br><span class="line">        clip-path polygon(0 0,100% 0,50% 100%)</span><br><span class="line">// ä¸‰æ å¸ƒå±€æ»‘åŠ¨å¡ç‰‡æ ·å¼</span><br><span class="line">@media screen and (min-width:1069px)</span><br><span class="line">  .recent-posts</span><br><span class="line">    .recent-post-item</span><br><span class="line">      width 32.3%</span><br><span class="line">      margin 0px 1% 20px 0px</span><br><span class="line">      .recent-post-content</span><br><span class="line">        .recent-post-info</span><br><span class="line">          .article-title</span><br><span class="line">            margin: 0px 5px</span><br><span class="line">            .article-title-link</span><br><span class="line">              -webkit-line-clamp: 1;</span><br><span class="line">          .recent-post-meta</span><br><span class="line">            margin: 0px 5px</span><br><span class="line">            .article-meta-wrap</span><br><span class="line">              -webkit-line-clamp: 2;</span><br><span class="line">// åŒæ å¸ƒå±€å¡ç‰‡è‡ªé€‚åº”é€‚é…</span><br><span class="line">@media screen and (min-width:572px) and (max-width:1068px)</span><br><span class="line">  .recent-posts</span><br><span class="line">    .recent-post-item</span><br><span class="line">      width 47%</span><br><span class="line">      margin 0px 3% 20px 0px</span><br><span class="line">// å•æ å¸ƒå±€å¡ç‰‡è‡ªé€‚åº”é€‚é…</span><br><span class="line">@media screen and (max-width:572px)</span><br><span class="line">  .recent-posts</span><br><span class="line">    .recent-post-item</span><br><span class="line">      width 100%</span><br></pre></td></tr></table></figure><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div><p>3ã€ä¿®æ”¹<code>[BlogRoot]\themes\butterfly\source\css\_page\homepage.styl</code>,å°†æ•´æ–‡ä»¶å†…å®¹æ›¿æ¢ä¸ºä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if hexo-config(&#x27;index_card_style&#x27;) == &#x27;slidecard&#x27;</span><br><span class="line">  @import &#x27;./_index_card_style/slidecard&#x27;</span><br><span class="line">else if hexo-config(&#x27;index_card_style&#x27;) == &#x27;multicard&#x27;</span><br><span class="line">  @import &#x27;./_index_card_style/multicard&#x27;</span><br></pre></td></tr></table></figure><p>4ã€ç„¶ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶<code>[BlogRoot]\_config.butterfly.yml</code>é‡Œæ–°å¢é…ç½®é¡¹ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡é…ç½®é¡¹è‡ªç”±åˆ‡æ¢ä½¿ç”¨å“ªæ¬¾äº†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ä¸»é¡µå¡ç‰‡æ ·å¼</span><br><span class="line"># Docs: https://akilar.top/posts/d6b69c49/</span><br><span class="line">index_card_style: multicard # slidecard | multicard</span><br></pre></td></tr></table></figure><p>5ã€è€ƒè™‘åˆ°ä¸ç®¡æ˜¯æ ·å¼ä¸€è¿˜æ˜¯æ ·å¼äºŒéƒ½å­˜åœ¨ä¸€ä¸ªå¸ƒå±€çªå˜çš„æƒ…å†µã€‚ä¸ºäº†ä¸è‡³äºè®©é¦–é¡µçš„æ–‡ç« å‡ºç°ç©ºç¼ºï¼Œå»ºè®®å°†é¦–é¡µç”Ÿæˆçš„æ–‡ç« æ•°é‡æ§åˆ¶ä¸º1,2,3çš„å…¬å€æ•°ã€‚ä¿®æ”¹ç«™ç‚¹é…ç½®æ–‡ä»¶<code>[BlogRoot]\_config.yml</code>ã€‚æ‰¾åˆ°ä»¥ä¸‹é…ç½®é¡¹è¿›è¡Œè°ƒæ•´ï¼Œæ³¨æ„è¿™æ˜¯ç«™ç‚¹é…ç½®æ–‡ä»¶æœ¬å°±æœ‰çš„é…ç½®é¡¹ï¼Œä¸æ˜¯æ–°å¢é…ç½®é¡¹ã€‚å»ºè®®æ˜¯è°ƒæ•´ä¸º12ç¯‡ã€‚å¦‚æœä½ çš„ä¾§è¾¹æ é­”æ”¹å†…å®¹ç‰¹åˆ«å¤šï¼Œé‚£ä¹ˆå»ºè®®æ”¹æˆ18ã€24ã€30ã€‚åŠ¡å¿…ç¡®ä¿æ–‡ç« å¡ç‰‡æ æ¯”ä¾§æ å®Œå…¨å±•å¼€è¦é•¿ï¼Œè¿™æ ·å±•ç¤ºæ•ˆæœæœ€å¥½</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Home page setting</span><br><span class="line"># path: Root path for your blogs index page. (default = &#x27;&#x27;)</span><br><span class="line"># per_page: Posts displayed per page. (0 = disable pagination)</span><br><span class="line"># order_by: Posts order. (Order by date descending by default)</span><br><span class="line">index_generator:</span><br><span class="line">  path: &#x27;&#x27;</span><br><span class="line">  per_page: 12</span><br><span class="line">  order_by: -date</span><br></pre></td></tr></table></figure><p>6ã€æœ¬æ•™ç¨‹è®¨è®ºçš„å¡ç‰‡éƒ½æ˜¯è€ƒè™‘æœ‰å°é¢å’Œæœ‰æè¿°çš„ã€‚æ‰€ä»¥éœ€è¦ä¿è¯ä½ å·²ç»å¼€å¯äº†ç›¸åº”çš„é…ç½®ï¼ŒæŸ¥çœ‹ä¸»é¢˜é…ç½®æ–‡ä»¶<code>[BlogRoot]\_config.butterfly.yml</code>,æ‰¾åˆ°é…ç½®é¡¹å¼€å¯æè¿°æ ï¼Œå»ºè®®é€‰æ‹©2æ¨¡å¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># Display the article introduction on homepage</span><br><span class="line"># 1: description</span><br><span class="line"># 2: both (if the description exists, it will show description, or show the auto_excerpt)</span><br><span class="line"># 3: auto_excerpt (default)</span><br><span class="line"># false: do not show the article introduction</span><br><span class="line">index_post_content:</span><br><span class="line">  method: 2</span><br><span class="line">  length: 500 # if you set method to 2 or 3, the length need to config</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><p><a href="https://www.fomal.cc/posts/d739261b.html">https://www.fomal.cc/posts/d739261b.html</a></p><p><a href="https://akilar.top/posts/d6b69c49/">https://akilar.top/posts/d6b69c49/</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é­”æ”¹ç¬”è®°äºŒï¼šå­—ä½“æ›´æ”¹</title>
      <link href="/2025/01/22/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E4%BA%8C%EF%BC%9A%E5%AD%97%E4%BD%93%E6%9B%B4%E6%94%B9/"/>
      <url>/2025/01/22/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E4%BA%8C%EF%BC%9A%E5%AD%97%E4%BD%93%E6%9B%B4%E6%94%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="é­”æ”¹ç¬”è®°äºŒï¼šå­—ä½“æ›´æ”¹"><a href="#é­”æ”¹ç¬”è®°äºŒï¼šå­—ä½“æ›´æ”¹" class="headerlink" title="é­”æ”¹ç¬”è®°äºŒï¼šå­—ä½“æ›´æ”¹"></a>é­”æ”¹ç¬”è®°äºŒï¼šå­—ä½“æ›´æ”¹</h1><p>å­—ä½“ä¸‹è½½åœ°å€ï¼š</p><p><a href="https://www.fonts.net.cn/font-38461409078.html">JetBrains Monoå­—ä½“å…è´¹ä¸‹è½½å’Œåœ¨çº¿é¢„è§ˆ-å­—ä½“å¤©ä¸‹ (fonts.net.cn)</a></p><p><a href="https://developer.huawei.com/consumer/cn/design/resource-V1/">HarmonyOSè®¾è®¡èµ„æºä¸‹è½½-é¸¿è’™Sanså­—ä½“ä¸‹è½½-åä¸ºå¼€å‘è€…è”ç›Ÿ (huawei.com)</a></p><h2 id="æ•™ç¨‹"><a href="#æ•™ç¨‹" class="headerlink" title="æ•™ç¨‹"></a>æ•™ç¨‹</h2><h3 id="åˆ›å»ºfontæ–‡ä»¶å¤¹"><a href="#åˆ›å»ºfontæ–‡ä»¶å¤¹" class="headerlink" title="åˆ›å»ºfontæ–‡ä»¶å¤¹"></a>åˆ›å»ºfontæ–‡ä»¶å¤¹</h3><p>åœ¨<code>themes/butterfly/source/</code>ä¸‹åˆ›å»º<code>font</code>æ–‡ä»¶å¤¹</p><p>å°†<code>HarmonyOS_Sans_SC_Regular.ttf</code>å’Œ<code>JetBrainsMono-Regular.ttf</code>æ”¾è¿›<code>font</code></p><h3 id="åˆ›å»ºcss"><a href="#åˆ›å»ºcss" class="headerlink" title="åˆ›å»ºcss"></a>åˆ›å»ºcss</h3><p>åœ¨<code>themes/butterfly/source/css/</code>ä¸‹åˆ›å»º<code>font.css</code></p><p>ç¼–è¾‘<code>font.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@font-face</span>&#123;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&#x27;JetBrains Mono&#x27;</span>;</span><br><span class="line">    <span class="attribute">font-display</span>: swap;</span><br><span class="line">    <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;../font/JetBrainsMono-Regular.ttf&#x27;</span>) <span class="built_in">format</span>(<span class="string">&quot;truetype&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@font-face</span>&#123;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&#x27;HarmonyOS Sans SC&#x27;</span>;</span><br><span class="line">    <span class="attribute">font-display</span>: swap;</span><br><span class="line">    <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&#x27;../font/HarmonyOS_Sans_SC_Regular.ttf&#x27;</span>) <span class="built_in">format</span>(<span class="string">&quot;truetype&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&#x27;JetBrains Mono&#x27;</span>,<span class="string">&#x27;HarmonyOS Sans SC&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="ç¼–è¾‘-config-butterfly-yml"><a href="#ç¼–è¾‘-config-butterfly-yml" class="headerlink" title="ç¼–è¾‘_config.butterfly.yml"></a>ç¼–è¾‘<code>_config.butterfly.yml</code></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Inject</span></span><br><span class="line"><span class="comment"># Insert the code to head (before &#x27;&lt;/head&gt;&#x27; tag) and the bottom (before &#x27;&lt;/body&gt;&#x27; tag)</span></span><br><span class="line"><span class="comment"># æ’å…¥ä»£ç åˆ°å¤´éƒ¨ &lt;/head&gt; ä¹‹å‰ å’Œ åº•éƒ¨ &lt;/body&gt; ä¹‹å‰</span></span><br><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="comment"># - &lt;link rel=&quot;stylesheet&quot; href=&quot;/xxx.css&quot;&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/font.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="comment"># - &lt;script src=&quot;xxxx&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é­”æ”¹ç¬”è®°ä¸€ï¼šé¦–é¡µåˆ†ç±»ï¼Œè½®æ’­å¡ç‰‡ä»¥åŠåŠ¨ç”»æ·»åŠ </title>
      <link href="/2025/01/22/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E4%B8%80%EF%BC%9A%E9%A6%96%E9%A1%B5%E5%88%86%E7%B1%BB%EF%BC%8C%E8%BD%AE%E6%92%AD%E5%8D%A1%E7%89%87%E4%BB%A5%E5%8F%8A%E5%8A%A8%E7%94%BB%E6%B7%BB%E5%8A%A0/"/>
      <url>/2025/01/22/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E4%B8%80%EF%BC%9A%E9%A6%96%E9%A1%B5%E5%88%86%E7%B1%BB%EF%BC%8C%E8%BD%AE%E6%92%AD%E5%8D%A1%E7%89%87%E4%BB%A5%E5%8F%8A%E5%8A%A8%E7%94%BB%E6%B7%BB%E5%8A%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="é­”æ”¹ç¬”è®°ä¸€ï¼šé¦–é¡µåˆ†ç±»ï¼Œè½®æ’­å¡ç‰‡ä»¥åŠåŠ¨ç”»æ·»åŠ "><a href="#é­”æ”¹ç¬”è®°ä¸€ï¼šé¦–é¡µåˆ†ç±»ï¼Œè½®æ’­å¡ç‰‡ä»¥åŠåŠ¨ç”»æ·»åŠ " class="headerlink" title="é­”æ”¹ç¬”è®°ä¸€ï¼šé¦–é¡µåˆ†ç±»ï¼Œè½®æ’­å¡ç‰‡ä»¥åŠåŠ¨ç”»æ·»åŠ "></a>é­”æ”¹ç¬”è®°ä¸€ï¼šé¦–é¡µåˆ†ç±»ï¼Œè½®æ’­å¡ç‰‡ä»¥åŠåŠ¨ç”»æ·»åŠ </h1><h2 id="ä¸€-é¦–é¡µåŠ¨ç”»æ•ˆæœï¼š"><a href="#ä¸€-é¦–é¡µåŠ¨ç”»æ•ˆæœï¼š" class="headerlink" title="ä¸€.é¦–é¡µåŠ¨ç”»æ•ˆæœï¼š"></a>ä¸€.é¦–é¡µåŠ¨ç”»æ•ˆæœï¼š</h2><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦ä¸‹è½½ä¸€ä¸ªæ’ä»¶ï¼šåœ¨åšå®¢çš„æ ¹ç›®å½•ä¸‹è¿è¡Œï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-wowjs --save</span><br></pre></td></tr></table></figure><p>åœ¨æ ¹ç›®å½•ä¸‹çš„ _config.yml æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ä¿¡æ¯ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># butterflyä¸»é¡µåŠ¨ç”»</span></span><br><span class="line"><span class="attr">wowjs:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#æ§åˆ¶åŠ¨ç”»å¼€å…³ã€‚trueæ˜¯æ‰“å¼€ï¼Œfalseæ˜¯å…³é—­</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">10</span> <span class="comment">#è¿‡æ»¤å™¨ä¼˜å…ˆçº§</span></span><br><span class="line">  <span class="attr">mobile:</span> <span class="literal">false</span> <span class="comment">#ç§»åŠ¨ç«¯æ˜¯å¦å¯ç”¨ï¼Œé»˜è®¤ç§»åŠ¨ç«¯ç¦ç”¨</span></span><br><span class="line">  <span class="attr">animateitem:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">recent-post-item</span> <span class="comment">#å¿…å¡«é¡¹ï¼Œéœ€è¦æ·»åŠ åŠ¨ç”»çš„å…ƒç´ çš„class</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__zoomIn</span> <span class="comment">#å¿…å¡«é¡¹ï¼Œéœ€è¦æ·»åŠ çš„åŠ¨ç”»</span></span><br><span class="line">      <span class="attr">duration:</span> <span class="string">1500ms</span> <span class="comment">#é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»æŒç»­æ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯msä¹Ÿå¯ä»¥æ˜¯sã€‚ä¾‹å¦‚3sï¼Œ700msã€‚</span></span><br><span class="line">      <span class="attr">delay:</span> <span class="string">0ms</span> <span class="comment">#é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»å¼€å§‹çš„å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯msä¹Ÿå¯ä»¥æ˜¯sã€‚ä¾‹å¦‚3sï¼Œ700msã€‚</span></span><br><span class="line">      <span class="attr">offset:</span> <span class="number">0</span> <span class="comment">#é€‰å¡«é¡¹ï¼Œå¼€å§‹åŠ¨ç”»çš„è·ç¦»ï¼ˆç›¸å¯¹æµè§ˆå™¨åº•éƒ¨ï¼‰</span></span><br><span class="line">      <span class="attr">iteration:</span> <span class="number">1</span> <span class="comment">#é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»é‡å¤çš„æ¬¡æ•°</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">card-widget</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__zoomIn</span></span><br><span class="line">      <span class="attr">duration:</span> <span class="string">1500ms</span> <span class="comment">#é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»æŒç»­æ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯msä¹Ÿå¯ä»¥æ˜¯sã€‚ä¾‹å¦‚3sï¼Œ700msã€‚</span></span><br><span class="line">      <span class="attr">delay:</span> <span class="string">0ms</span> <span class="comment">#é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»å¼€å§‹çš„å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯msä¹Ÿå¯ä»¥æ˜¯sã€‚ä¾‹å¦‚3sï¼Œ700msã€‚</span></span><br><span class="line">      <span class="attr">offset:</span> <span class="number">0</span> <span class="comment">#é€‰å¡«é¡¹ï¼Œå¼€å§‹åŠ¨ç”»çš„è·ç¦»ï¼ˆç›¸å¯¹æµè§ˆå™¨åº•éƒ¨ï¼‰</span></span><br><span class="line">      <span class="attr">iteration:</span> <span class="number">1</span> <span class="comment">#é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»é‡å¤çš„æ¬¡æ•°</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">class:</span> <span class="string">container</span></span><br><span class="line">      <span class="attr">style:</span> <span class="string">animate__zoomIn</span></span><br><span class="line">      <span class="attr">duration:</span> <span class="string">1500ms</span> <span class="comment">#é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»æŒç»­æ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯msä¹Ÿå¯ä»¥æ˜¯sã€‚ä¾‹å¦‚3sï¼Œ700msã€‚</span></span><br><span class="line">      <span class="attr">delay:</span> <span class="string">0ms</span> <span class="comment">#é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»å¼€å§‹çš„å»¶è¿Ÿæ—¶é—´ï¼Œå•ä½å¯ä»¥æ˜¯msä¹Ÿå¯ä»¥æ˜¯sã€‚ä¾‹å¦‚3sï¼Œ700msã€‚</span></span><br><span class="line">      <span class="attr">offset:</span> <span class="number">0</span> <span class="comment">#é€‰å¡«é¡¹ï¼Œå¼€å§‹åŠ¨ç”»çš„è·ç¦»ï¼ˆç›¸å¯¹æµè§ˆå™¨åº•éƒ¨ï¼‰</span></span><br><span class="line">      <span class="attr">iteration:</span> <span class="number">1</span> <span class="comment">#é€‰å¡«é¡¹ï¼ŒåŠ¨ç”»é‡å¤çš„æ¬¡æ•°</span></span><br><span class="line">  <span class="attr">animate_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css</span></span><br><span class="line">  <span class="attr">wow_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js</span></span><br><span class="line">  <span class="attr">wow_init_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js</span></span><br></pre></td></tr></table></figure><h2 id="äºŒ-é¦–é¡µè½®æ’­å›¾ï¼š"><a href="#äºŒ-é¦–é¡µè½®æ’­å›¾ï¼š" class="headerlink" title="äºŒ. é¦–é¡µè½®æ’­å›¾ï¼š"></a>äºŒ. é¦–é¡µè½®æ’­å›¾ï¼š</h2><p>ä¹Ÿæ˜¯ä¸€æ ·ï¼Œé¦–å…ˆåœ¨æ ¹ç›®å½•å®‰è£…æ’ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-swiper --save</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨é…ç½®æ–‡ä»¶ _config.yml æ–‡ä»¶ä¸­é…ç½®ç›¸å…³é¡¹ç›®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-butterfly-swiper é¦–é¡µçš„è½®æ’­</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/8e1264d1/</span></span><br><span class="line">swiper:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span> <span class="comment"># å¼€å…³</span></span><br><span class="line">  priority: 2 <span class="comment">#è¿‡æ»¤å™¨ä¼˜å…ˆæƒ</span></span><br><span class="line">  enable_page: all <span class="comment"># åº”ç”¨é¡µé¢</span></span><br><span class="line">  timemode: <span class="built_in">date</span> <span class="comment">#date/updated</span></span><br><span class="line">  layout: <span class="comment"># æŒ‚è½½å®¹å™¨ç±»å‹</span></span><br><span class="line">    <span class="built_in">type</span>: class</span><br><span class="line">    name: recent-posts</span><br><span class="line">    index: 0</span><br><span class="line">  default_descr: å†æ€ä¹ˆçœ‹æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆæè¿°å®ƒçš„å•¦ï¼å¿«ç‚¹è¿›æ¥ç§ç§ï¼</span><br><span class="line">  swiper_css: https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css <span class="comment">#swiper cssä¾èµ–</span></span><br><span class="line">  swiper_js: https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js <span class="comment">#swiper jsä¾èµ–</span></span><br><span class="line">  custom_css: https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css <span class="comment"># é€‚é…ä¸»é¢˜æ ·å¼è¡¥ä¸</span></span><br><span class="line">  custom_js: https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js <span class="comment"># swiperåˆå§‹åŒ–æ–¹æ³•</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æˆ–ï¼ˆæœ¬æ–‡ä½¿ç”¨ä¸‹æ–¹æ–¹å¼ï¼‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-butterfly-swiper</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/8e1264d1/</span></span><br><span class="line"><span class="attr">swiper:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment"># å¼€å…³</span></span><br><span class="line">  <span class="attr">priority:</span> <span class="number">5</span> <span class="comment">#è¿‡æ»¤å™¨ä¼˜å…ˆæƒ</span></span><br><span class="line">  <span class="attr">enable_page:</span> <span class="string">all</span> <span class="comment"># åº”ç”¨é¡µé¢</span></span><br><span class="line">  <span class="attr">timemode:</span> <span class="string">date</span> <span class="comment">#date/updated</span></span><br><span class="line">  <span class="attr">layout:</span> <span class="comment"># æŒ‚è½½å®¹å™¨ç±»å‹</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">id</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">recent-posts</span></span><br><span class="line">    <span class="attr">index:</span> <span class="number">0</span></span><br><span class="line">  <span class="attr">default_descr:</span> <span class="string">å†æ€ä¹ˆçœ‹æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆæè¿°å®ƒçš„å•¦ï¼</span></span><br><span class="line">  <span class="attr">swiper_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.css</span> <span class="comment">#swiper cssä¾èµ–</span></span><br><span class="line">  <span class="attr">swiper_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper.min.js</span> <span class="comment">#swiper jsä¾èµ–</span></span><br><span class="line">  <span class="attr">custom_css:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiperstyle.css</span> <span class="comment"># é€‚é…ä¸»é¢˜æ ·å¼è¡¥ä¸</span></span><br><span class="line">  <span class="attr">custom_js:</span> <span class="string">https://npm.elemecdn.com/hexo-butterfly-swiper/lib/swiper_init.js</span> <span class="comment"># swiperåˆå§‹åŒ–æ–¹æ³•  </span></span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹</p><p>è¿™ä¸ªé‡Œé¢æˆ‘æ„Ÿè§‰éœ€è¦æ³¨æ„çš„å°±æ˜¯layouté€‰é¡¹ï¼Œå¦‚æœæŒ‰ç…§æˆ‘çš„é…ç½®ï¼Œåˆ†ç±»ä¼šåœ¨è½®æ’­å›¾ä¸‹é¢æ˜¾ç¤ºï¼Œä½†æ˜¯å¦‚æœæŒ‰ç…§æ–‡æ¡£é»˜è®¤ï¼Œè¿™ä¸¤ä¸ªå¯èƒ½ä¼šå¯¼è‡´å‰åé¡ºåºä¸å¯¹é€ æˆçš„é—®é¢˜ï¼Œæ²¡æœ‰ä¿å­˜æˆªå›¾å°±ä¸æ”¾äº†å¯ä»¥è‡ªå·±è¯•è¯•ï¼Œæ³¨æ„éœ€è¦è®¾ç½® priority: 2 #è¿‡æ»¤å™¨ä¼˜å…ˆæƒ æŒ‰ç…§æˆ‘çš„æ–‡ä»¶é…ç½®å³å¯</p><p>æ–‡ç« æ·»åŠ è½®æ’­éœ€è¦åœ¨æ–‡ç« æœ€å‰é¢æ–°å¢é…ç½® å®Œæ•´é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">å»ºç«™é¦–å‘ï¼šMarkdownè¯­æ³•å¼€ç¯‡</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Markdown</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">è¯­è¨€</span></span><br><span class="line"><span class="attr">categories:</span> <span class="string">è¯­è¨€</span></span><br><span class="line"><span class="attr">sticky:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">katex:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">http://qiniu.gocit.cn/blog_posts_1/cover_img.jpeg</span></span><br><span class="line"><span class="attr">top_img:</span> <span class="string">http://qiniu.gocit.cn/blog_posts_1/top_img.png</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2022-08-02 09:28:56</span></span><br><span class="line"><span class="attr">abbrlink:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">swiper_index:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">åŠ¡å¿…é˜…è¯»ï¼šé€‚ç”¨äºæ–°æ‰‹å¿«é€Ÿå…¥é—¨çš„Markdownè¯­æ³•ä½¿ç”¨æ•™ç¨‹ï¼Œè¿ç”¨Markdownè¯­æ³•æ˜¯å»ºç«‹blogçš„å¿…è¦å‰æ!zf</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ¬æ–‡å®é™…æ·»åŠ ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">katex:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">abbrlink:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">swiper_index:</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h2 id="ä¸‰-åˆ†ç±»å¡ç‰‡ï¼š"><a href="#ä¸‰-åˆ†ç±»å¡ç‰‡ï¼š" class="headerlink" title="ä¸‰. åˆ†ç±»å¡ç‰‡ï¼š"></a>ä¸‰. åˆ†ç±»å¡ç‰‡ï¼š</h2><p>å®‰è£…æ’ä»¶å’¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-butterfly-categories-card --save</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°†ä»¥ä¸‹å‚æ•°ä¹Ÿæ˜¯æ”¾åˆ°æ ¹ç›®å½•ä¸‹çš„_config.ymlä¸­å³å¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hexo-butterfly-categories-card</span></span><br><span class="line"><span class="comment"># see https://akilar.top/posts/a9131002/</span></span><br><span class="line">categoryBar:</span><br><span class="line">  <span class="built_in">enable</span>: <span class="literal">true</span> <span class="comment"># å¼€å…³</span></span><br><span class="line">  priority: 5 <span class="comment">#è¿‡æ»¤å™¨ä¼˜å…ˆæƒ</span></span><br><span class="line">  enable_page: / <span class="comment"># åº”ç”¨é¡µé¢</span></span><br><span class="line">  layout: <span class="comment"># æŒ‚è½½å®¹å™¨ç±»å‹</span></span><br><span class="line">    <span class="built_in">type</span>: <span class="built_in">id</span></span><br><span class="line">    name: recent-posts</span><br><span class="line">    index: 1</span><br><span class="line">  column: odd <span class="comment"># oddï¼š3åˆ— | evenï¼š4åˆ—</span></span><br><span class="line">  row: 2 <span class="comment">#æ˜¾ç¤ºè¡Œæ•°ï¼Œé»˜è®¤ä¸¤è¡Œï¼Œè¶…è¿‡è¡Œæ•°åˆ‡æ¢ä¸ºæ»šåŠ¨æ˜¾ç¤º</span></span><br><span class="line">  message:</span><br><span class="line">    - descr: å­¦ä¹ èµ„æ–™</span><br><span class="line">      cover: https://npm.elemecdn.com/akilar-candyassets/image/cover1.webp</span><br><span class="line">    - descr: æ—¥å¸¸åˆ†äº«</span><br><span class="line">      cover: https://npm.elemecdn.com/akilar-candyassets/image/cover2.webp</span><br><span class="line">    - descr: åšå®¢é­”æ”¹</span><br><span class="line">      cover: https://npm.elemecdn.com/akilar-candyassets/image/cover3.webp</span><br><span class="line"><span class="comment">#    - descr: ä¸ªäººæ—¥è®°</span></span><br><span class="line"><span class="comment">#      cover: https://npm.elemecdn.com/akilar-candyassets/image/cover4.webp</span></span><br><span class="line"><span class="comment">#    - descr: è¯—è¯æ­Œèµ‹</span></span><br><span class="line"><span class="comment">#      cover: https://npm.elemecdn.com/akilar-candyassets/image/cover5.webp</span></span><br><span class="line"><span class="comment">#    - descr: æ‚è°ˆæ•™ç¨‹</span></span><br><span class="line"><span class="comment">#      cover: https://npm.elemecdn.com/akilar-candyassets/image/cover6.webp</span></span><br><span class="line">  custom_css: https://npm.elemecdn.com/hexo-butterfly-categories-card@1.0.0/lib/categorybar.css</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„äº‹é¡¹ï¼š</p><p>æ³¨æ„ä¿®æ”¹å…¶ä¸­çš„messageä¸ºä½ çš„åˆ†ç±»ï¼Œè¿™é‡Œæˆ‘åªæœ‰ä¸‰ä¸ªåˆ†ç±»æ‰€ä»¥å¼€äº†ä¸‰ä¸ªï¼Œå°½é‡ä¸è¦å¼€è¿‡å…­ä¸ªï¼Œæˆ‘ä¸ªäººæ„Ÿè§‰æ»šåŠ¨æ˜¾ç¤ºä¸å¥½çœ‹<br>ç„¶åå°±æ˜¯é»˜è®¤æ˜¾ç¤ºè¡Œæ•°å’Œåˆ—æ•°ï¼Œè¡Œæ•°æœ€å¥½è®¾ç½®å¤§ä¸€è¡Œï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°æ»šåŠ¨ï¼Œåˆ—æ•°ä¿æŒåˆ°ä¸‰å°±å¯ä»¥<br>å¦‚æœé…ç½®äº†ä¸Šæ–¹çš„swipperï¼Œæœ€å¥½ä¸è¦åŠ¨layoutï¼Œå½“ç„¶æˆ‘ä¹Ÿä¸æ˜¯å¾ˆæ‡‚ï¼Œä½†æ˜¯è‡³å°‘è¿™æ ·èƒ½å¤Ÿæ­£å¸¸è¿è¡Œhaha</p><p>å‚è€ƒå‚æ•°è§£é‡Šç­‰ï¼š</p><p><a href="https://blog.csdn.net/weixin_42464282/article/details/130989629">https://blog.csdn.net/weixin_42464282/article/details/130989629</a></p><p><a href="https://blog.liushen.fun/posts/6af2a5bb/#%E4%B8%80-%E9%A6%96%E9%A1%B5%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C%EF%BC%9A">https://blog.liushen.fun/posts/6af2a5bb/#%E4%B8%80-%E9%A6%96%E9%A1%B5%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C%EF%BC%9A</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é­”æ”¹ç¬”è®°äº”ï¼šåˆ†ç±»æ¡åŠå¤–é“¾å¡ç‰‡</title>
      <link href="/2025/01/21/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E4%BA%94%EF%BC%9A%E5%88%86%E7%B1%BB%E6%9D%A1%E5%8F%8A%E5%A4%96%E9%93%BE%E5%8D%A1%E7%89%87/"/>
      <url>/2025/01/21/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E4%BA%94%EF%BC%9A%E5%88%86%E7%B1%BB%E6%9D%A1%E5%8F%8A%E5%A4%96%E9%93%BE%E5%8D%A1%E7%89%87/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="é­”æ”¹ç¬”è®°äº”ï¼šåˆ†ç±»æ¡åŠå¤–é“¾å¡ç‰‡"><a href="#é­”æ”¹ç¬”è®°äº”ï¼šåˆ†ç±»æ¡åŠå¤–é“¾å¡ç‰‡" class="headerlink" title="é­”æ”¹ç¬”è®°äº”ï¼šåˆ†ç±»æ¡åŠå¤–é“¾å¡ç‰‡"></a>é­”æ”¹ç¬”è®°äº”ï¼šåˆ†ç±»æ¡åŠå¤–é“¾å¡ç‰‡</h1><p>é­”æ”¹æ•™ç¨‹<br>æ³¨æ„ï¼šç”±äºæœ¬æ¬¡é­”æ”¹ä¿®æ”¹äº†ä¸»é¢˜å†…éƒ¨æ–‡ä»¶ï¼Œä¸€å®šè¦æ³¨æ„æå‰å¤‡ä»½ï¼ä¸€å®šè¦æ³¨æ„æå‰å¤‡ä»½ï¼ä¸€å®šè¦æ³¨æ„æå‰å¤‡ä»½ï¼å¦‚æœæ²¡æœ‰é­”æ”¹åŸºç¡€å»ºè®®ç´§è·Ÿæ•™ç¨‹ï¼Œå¦‚æœæœ‰ä»»ä½•é—®é¢˜å¯ä»¥åœ¨ä¸‹æ–¹è¯„è®ºåŒºæå‡ºã€‚</p><p>åˆ†ç±»æ¡<br>æˆ‘åŸæœ‰çš„åˆ†ç±»æ˜¯åº—é•¿çš„åˆ†ç±»å¡ç‰‡ï¼Œä½†æ€»æ„Ÿè§‰å ç”¨ç©ºé—´æœ‰ç‚¹å¤§ï¼Œä¸”å¦‚æœåˆ†ç±»è¶…è¿‡ä¸‰ä¸ªä¼šæ˜¾ç¤ºæ»šåŠ¨æ¡ã€‚æˆ‘åœ¨ç½‘ç«™è®¾è®¡ä¸­å°½é‡é¿å…æ˜¾ç¤ºæ»šåŠ¨æ¡ï¼Œå› ä¸ºæ„Ÿè§‰ä¸å¤Ÿç¾è§‚ã€‚ä¸ºäº†ä½¿ç½‘ç«™æ›´åŠ ç®€æ´ï¼Œæˆ‘å†³å®šæŒ‰ç…§æœ‹å‹ klcdm çš„æ¨èï¼Œä½¿ç”¨æ´ªå“¥çš„åˆ†ç±»æ¡ã€‚ç„¶è€Œï¼Œæ´ªå“¥çš„åˆ†ç±»æ¡æ˜¯çº¯é™æ€çš„ï¼Œåˆ†ç±»éœ€è¦æ‰‹åŠ¨æ·»åŠ ä¸Šå»ï¼Œæ˜æ˜¾ä¸ç¬¦åˆæˆ‘çš„æ‡’è›‹éœ€æ±‚ã€‚å› æ­¤ï¼Œæˆ‘å†³å®šä¿®æ”¹æ´ªå“¥çš„åˆ†ç±»æ¡ï¼Œå¹¶ä» hexo-theme-solitude ä¸­æå–å‡ºåŠ¨æ€åˆ†ç±»æ¡çš„åŠŸèƒ½ï¼Œä»¥ä¾¿æ›´ç®€æ´åœ°æ˜¾ç¤ºæ‰€æœ‰åˆ†ç±»å¹¶å¿«æ·åˆ‡æ¢ã€‚</p><p>æ•ˆæœå±•ç¤º<br>ä»¥ä¸‹æ˜¯åˆ†ç±»æ¡çš„å±•ç¤ºæ•ˆæœï¼Œå…·ä½“æ•ˆæœå¯ä»¥åœ¨é¦–é¡µè‡ªè¡Œæ„Ÿå—ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_0f8430c0f966cdd10dfebc5685e24b4f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_0f8430c0f966cdd10dfebc5685e24b4f.png"></p><p>ä¸ºäº†ç¾è§‚ï¼Œæˆ‘æŠŠæ¨ªå‘åˆ†ç±»çš„æ»šåŠ¨æ¡ç§»é™¤äº†ï¼Œä½†æ˜¯ä»ç„¶å¯ä»¥ç§»åŠ¨ï¼Œå¦‚æœæ˜¯æ‰‹æœºçš„è¯ï¼Œé€šè¿‡å·¦å³æ»‘åŠ¨å³å¯æ‹‰åŠ¨æ»šåŠ¨æ¡ï¼Œä½†æ˜¯ä¸å¤ªæ˜æ˜¾ï¼Œæœ‰éœ€è¦çš„å¯ä»¥è‡ªè¡Œæ·»åŠ å…¶ä»–å…ƒç´ ã€‚</p><h2 id="æ•™ç¨‹"><a href="#æ•™ç¨‹" class="headerlink" title="æ•™ç¨‹"></a>æ•™ç¨‹</h2><p>æ–°å»ºæ–‡ä»¶[BlogRoot]\themes\butterfly\layout\includes\categoryBar.pugæ–‡ä»¶ï¼Œå†™å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.category-bar-items#category-bar-items(class=is_home() ? &#x27;home&#x27; : &#x27;&#x27;)</span><br><span class="line">  .category-bar-item(class=is_home() ? &#x27;select&#x27; : &#x27;&#x27;, id=&quot;category-bar-home&quot;)</span><br><span class="line">    a(href=url_for(&#x27;/&#x27;))= __(&#x27;åšå®¢é¦–é¡µ&#x27;)</span><br><span class="line">  each item in site.categories.find(&#123; parent: &#123; $exists: false &#125; &#125;).data</span><br><span class="line">    .category-bar-item(class=select ? (select === item.name ? &#x27;select&#x27; : &#x27;&#x27;) : &#x27;&#x27;, id=item.name)</span><br><span class="line">      a(href=url_for(item.path))= item.name</span><br><span class="line">  .category-bar-item</span><br><span class="line">    a(href=url_for(&#x27;/archives/&#x27;))= __(&#x27;æ–‡ç« å­˜æ¡£&#x27;)</span><br><span class="line">div.category-bar-right</span><br><span class="line">  a.category-bar-more(href=url_for(&#x27;/categories/&#x27;))= __(&#x27;æ›´å¤šåˆ†ç±»&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ä»¥ä¸Šå°±æ˜¯è¯¥æ»šåŠ¨æ¡çš„ç»“æ„ï¼Œä¸‹é¢æˆ‘ä»¬å¼€å§‹å®ç°æ ·å¼çš„å®šä¹‰ï¼Œæ–°å»ºæ–‡ä»¶[BlogRoot]\themes\butterfly\source\css_layout\category-bar.stylå†™å…¥ä»¥ä¸‹æ–‡ä»¶ï¼š</p><figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#category-bar</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">7px</span> <span class="number">11px</span></span><br><span class="line">  <span class="attribute">background</span> <span class="built_in">var</span>(--card-bg)</span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">8px</span></span><br><span class="line">  <span class="attribute">display</span> flex</span><br><span class="line">  <span class="attribute">white-space</span> nowrap</span><br><span class="line">  <span class="attribute">overflow</span> hidden</span><br><span class="line">  <span class="attribute">transition</span> <span class="number">0.3s</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">50px</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">justify-content</span> space-between</span><br><span class="line">  user-select <span class="attribute">none</span></span><br><span class="line">  <span class="attribute">align-items</span> center</span><br><span class="line">  <span class="attribute">margin-bottom</span> <span class="number">20px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.category-bar-right</span></span><br><span class="line">    <span class="attribute">display</span> flex</span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">8px</span></span><br><span class="line">    <span class="attribute">align-items</span> center</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.category-bar-more</span></span><br><span class="line">      <span class="attribute">margin-left</span> <span class="number">4px</span></span><br><span class="line">      <span class="attribute">margin-right</span> <span class="number">4px</span></span><br><span class="line">      <span class="attribute">font-weight</span> <span class="number">700</span></span><br><span class="line">      <span class="attribute">border-radius</span> <span class="number">8px</span></span><br><span class="line">      <span class="attribute">padding</span> <span class="number">0</span> <span class="number">8px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.category-bar-items</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">    <span class="attribute">white-space</span> nowrap</span><br><span class="line">    <span class="attribute">overflow-x</span> scroll</span><br><span class="line">    <span class="attribute">scrollbar-width</span>: none</span><br><span class="line">    -ms-<span class="attribute">overflow</span>-style: none</span><br><span class="line">    <span class="attribute">overflow-y</span> hidden</span><br><span class="line">    <span class="attribute">display</span> flex</span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">8px</span></span><br><span class="line">    <span class="attribute">align-items</span> center</span><br><span class="line">    <span class="attribute">height</span> <span class="number">30px</span></span><br><span class="line"></span><br><span class="line">    &amp;::-webkit-scrollbar</span><br><span class="line">      <span class="attribute">display</span>: none</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.category-bar-item</span></span><br><span class="line">      <span class="selector-tag">a</span></span><br><span class="line">        <span class="attribute">padding</span> .<span class="number">1rem</span> .<span class="number">5rem</span></span><br><span class="line">        <span class="attribute">margin-right</span> <span class="number">6px</span></span><br><span class="line">        <span class="attribute">font-weight</span> <span class="number">700</span></span><br><span class="line">        <span class="attribute">border-radius</span> <span class="number">8px</span></span><br><span class="line">        <span class="attribute">display</span> flex</span><br><span class="line">        <span class="attribute">align-items</span> center</span><br><span class="line">        <span class="attribute">height</span> <span class="number">30px</span></span><br><span class="line"></span><br><span class="line">      &amp;<span class="selector-class">.select</span></span><br><span class="line">        <span class="selector-tag">a</span></span><br><span class="line">          <span class="attribute">background</span> <span class="number">#3eb8be</span></span><br><span class="line">          <span class="attribute">color</span> <span class="built_in">var</span>(--btn-color)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨pugæ–‡ä»¶ä¸­ï¼Œæ‰€æœ‰çš„é¢œè‰²æˆ‘éƒ½å°½é‡ä½¿ç”¨äº†butterflyä¸»é¢˜è‡ªå¸¦çš„å˜é‡è¿›è¡Œäº†æ›¿ä»£ï¼Œç¡®ä¿å¤§éƒ¨åˆ†äººå¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚</p><p>ç„¶åå°†å…¶æ·»åŠ åˆ°ä¸åŒçš„ä½ç½®ï¼Œæ¯”å¦‚æˆ‘è¿™é‡Œå®ç°äº†æ·»åŠ åˆ°åˆ†ç±»é¡µé¢ç­‰ä½ç½®ï¼Œé…åˆä¸Špjaxå¯ä»¥åšåˆ°æ— åˆ·æ›´æ–°ï¼Œæ•ˆæœå¾ˆå¥½ï¼Œæ‰“å¼€æ–‡ä»¶[BlogRoot]\themes\butterfly\layout\category.pugï¼Œæ·»åŠ å…¶ä¸­ä¸¤è¡Œä»£ç ï¼Œå»æ‰åŠ å·å³ä¸ºæ­£å¸¸ç¼©è¿›ï¼š</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  if theme.category_ui == &#x27;index&#x27;</span><br><span class="line">    include ./includes/mixins/post-ui.pug</span><br><span class="line">    #recent-posts.recent-posts.category_ui</span><br><span class="line"><span class="addition">+      #category-bar.category-bar</span></span><br><span class="line"><span class="addition">+        include includes/categoryBar.pug</span></span><br><span class="line">      +postUI</span><br><span class="line">      include includes/pagination.pug</span><br><span class="line">  else</span><br><span class="line">    include ./includes/mixins/article-sort.pug</span><br><span class="line">    #category</span><br><span class="line">      &lt;div id=&quot;categories-chart&quot; data-parent=&quot;true&quot; style=&quot;height: 300px; padding: 10px;&quot;&gt;&lt;/div&gt;</span><br><span class="line">      .article-sort-title= _p(&#x27;page.category&#x27;) + &#x27; - &#x27; + page.category</span><br><span class="line">      +articleSort(page.posts)</span><br><span class="line">      include includes/pagination.pug</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨æ„ä¸Šæ–¹çš„ä¿®æ”¹ï¼Œéœ€è¦å°†é…ç½®æ–‡ä»¶ä¸­ï¼Œåˆ†ç±»é¡µé¢çš„ä¸»é¢˜æ”¹æˆindexï¼Œå¦åˆ™ä¸ä¼šæ˜¾ç¤ºã€‚</p><p>ä¸‹é¢æˆ‘ä»¬å°†å…¶æ·»åŠ åˆ°ä¸»é¡µï¼Œæ‰“å¼€æ–‡ä»¶[BlogRoot]\themes\butterfly\layout\index.pugæ–‡ä»¶ï¼Œæ·»åŠ ä¸‹é¢ä¸¤è¡Œ</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">block content</span><br><span class="line">  include ./includes/mixins/post-ui.pug</span><br><span class="line">  #recent-posts.recent-posts</span><br><span class="line"><span class="addition">+    #category-bar.category-bar</span></span><br><span class="line"><span class="addition">+      include includes/categoryBar.pug</span></span><br><span class="line">    +postUI</span><br><span class="line">    include includes/pagination.pug</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åå°±æ˜¯å®ç°ç‚¹å‡»åˆ‡æ¢åï¼Œé«˜äº®éƒ¨åˆ†è·Ÿéšåˆ†ç±»é¡µé¢èµ°çš„éƒ¨åˆ†ï¼Œä¸ºäº†å’Œä¸»é¢˜èåˆæˆ‘è¿˜æ˜¯ä¿®æ”¹æºç ï¼Œæ‰“å¼€[BlogRoot]\themes\butterfly\source\js\main.jsï¼Œæ·»åŠ jså‡½æ•°ï¼Œæ¯”å¦‚æˆ‘æ·»åŠ åˆ°äº†778è¡Œå·¦å³ï¼ŒswitchCommentså‡½æ•°çš„ä¸Šé¢ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">   * è‡ªå·±å†™çš„ï¼Œå®ç°åŠŸèƒ½åˆ‡æ¢ç±»åˆ«è¡¨</span></span><br><span class="line"><span class="comment">   */</span> </span><br><span class="line">  const setCategoryBarActive = () =&gt; &#123;</span><br><span class="line">    const categoryBar = document<span class="selector-class">.querySelector</span>(&quot;<span class="selector-id">#category-bar</span>&quot;);</span><br><span class="line">    const currentPath = decodeURIComponent(window<span class="selector-class">.location</span><span class="selector-class">.pathname</span>);</span><br><span class="line">    const isHomePage = currentPath === GLOBAL_CONFIG<span class="selector-class">.root</span>;</span><br><span class="line"></span><br><span class="line">    if (categoryBar) &#123;</span><br><span class="line">        const categoryItems = categoryBar<span class="selector-class">.querySelectorAll</span>(&quot;<span class="selector-class">.category-bar-item</span>&quot;);</span><br><span class="line">        categoryItems<span class="selector-class">.forEach</span>(item =&gt; item<span class="selector-class">.classList</span><span class="selector-class">.remove</span>(&quot;select&quot;));</span><br><span class="line"></span><br><span class="line">        const activeItemId = isHomePage ? &quot;category-bar-home&quot; : currentPath.<span class="built_in">split</span>(<span class="string">&quot;/&quot;</span>).<span class="built_in">slice</span>(-<span class="number">2</span>, -<span class="number">1</span>)[<span class="number">0</span>];</span><br><span class="line">        const activeItem = document<span class="selector-class">.getElementById</span>(activeItemId);</span><br><span class="line"></span><br><span class="line">        if (activeItem) &#123;</span><br><span class="line">            activeItem<span class="selector-class">.classList</span><span class="selector-class">.add</span>(&quot;select&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç„¶åå†åœ¨å¼•ç”¨éƒ¨åˆ†æ‰§è¡Œè¿™ä¸ªå‡½æ•°ï¼Œåœ¨åŒä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰¾åˆ°ä¸‹é¢çš„å‡½æ•°å¹¶æ·»åŠ å‡½æ•°çš„è°ƒç”¨ï¼Œä½ç½®çœ‹ä¸‹æ–¹æ³¨é‡Šï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">window<span class="selector-class">.refreshFn</span> = function () &#123;</span><br><span class="line">  initAdjust()</span><br><span class="line"></span><br><span class="line">  if (GLOBAL_CONFIG_SITE<span class="selector-class">.isPost</span>) &#123;</span><br><span class="line">    GLOBAL_CONFIG<span class="selector-class">.noticeOutdate</span> !== undefined &amp;&amp; addPostOutdateNotice()</span><br><span class="line">    GLOBAL_CONFIG<span class="selector-class">.relativeDate</span><span class="selector-class">.post</span> &amp;&amp; relativeDate(document<span class="selector-class">.querySelectorAll</span>(&#x27;<span class="selector-id">#post-meta</span> <span class="selector-tag">time</span>&#x27;))</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    GLOBAL_CONFIG<span class="selector-class">.relativeDate</span><span class="selector-class">.homepage</span> &amp;&amp; relativeDate(document<span class="selector-class">.querySelectorAll</span>(&#x27;<span class="selector-id">#recent-posts</span> <span class="selector-tag">time</span>&#x27;))</span><br><span class="line">    GLOBAL_CONFIG<span class="selector-class">.runtime</span> &amp;&amp; addRuntime()</span><br><span class="line">    addLastPushDate()</span><br><span class="line">    toggleCardCategory()</span><br><span class="line">    setCategoryBarActive()      // è‡ªå·±åŠ çš„ï¼Œç”¨äºåˆ‡æ¢ç±»åˆ«æ ç›®</span><br><span class="line">  &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æœ€åï¼Œhexoä¸‰ä»¶å¥—ï¼Œåº”è¯¥å°±èƒ½çœ‹åˆ°æ•ˆæœäº†ï¼è¯·æ ¹æ®è‡ªå·±çš„éœ€è¦è¿›è¡Œå®šåˆ¶åŒ–ã€‚</p><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://blog.liushen.fun/posts/a64defb4/">https://blog.liushen.fun/posts/a64defb4/</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>12ã€podæ§åˆ¶å™¨ä»‹ç»</title>
      <link href="/2025/01/05/12%E3%80%81pod%E6%8E%A7%E5%88%B6%E5%99%A8%E4%BB%8B%E7%BB%8D/"/>
      <url>/2025/01/05/12%E3%80%81pod%E6%8E%A7%E5%88%B6%E5%99%A8%E4%BB%8B%E7%BB%8D/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="12ã€podæ§åˆ¶å™¨ä»‹ç»"><a href="#12ã€podæ§åˆ¶å™¨ä»‹ç»" class="headerlink" title="12ã€podæ§åˆ¶å™¨ä»‹ç»"></a>12ã€podæ§åˆ¶å™¨ä»‹ç»</h2><h3 id="ä¸€ã€Podæ§åˆ¶å™¨ä»‹ç»"><a href="#ä¸€ã€Podæ§åˆ¶å™¨ä»‹ç»" class="headerlink" title="ä¸€ã€Podæ§åˆ¶å™¨ä»‹ç»"></a>ä¸€ã€Podæ§åˆ¶å™¨ä»‹ç»</h3><p><strong>Podæ˜¯kubernetesçš„æœ€å°ç®¡ç†å•å…ƒï¼Œåœ¨kubernetesä¸­ï¼ŒæŒ‰ç…§podçš„åˆ›å»ºæ–¹å¼å¯ä»¥å°†å…¶åˆ†ä¸ºä¸¤ç±»ï¼š</strong></p><ul><li><strong>è‡ªä¸»å¼podï¼škubernetesç›´æ¥åˆ›å»ºå‡ºæ¥çš„Podï¼Œè¿™ç§podåˆ é™¤åå°±æ²¡æœ‰äº†ï¼Œä¹Ÿä¸ä¼šé‡å»º</strong></li><li><strong>æ§åˆ¶å™¨åˆ›å»ºçš„podï¼škubernetesé€šè¿‡æ§åˆ¶å™¨åˆ›å»ºçš„podï¼Œè¿™ç§podåˆ é™¤äº†ä¹‹åè¿˜ä¼šè‡ªåŠ¨é‡å»º</strong></li></ul><h3 id="äºŒã€-lt-span-class-quot-ne-text-quot-gt-ä»€ä¹ˆæ˜¯Podæ§åˆ¶å™¨-lt-span-gt"><a href="#äºŒã€-lt-span-class-quot-ne-text-quot-gt-ä»€ä¹ˆæ˜¯Podæ§åˆ¶å™¨-lt-span-gt" class="headerlink" title="äºŒã€&lt;span class=&quot;ne-text&quot;&gt;ä»€ä¹ˆæ˜¯Podæ§åˆ¶å™¨&lt;/span&gt;"></a>äºŒã€<code>&lt;span class=&quot;ne-text&quot;&gt;ä»€ä¹ˆæ˜¯Podæ§åˆ¶å™¨&lt;/span&gt;</code></h3><p><strong>Podæ§åˆ¶å™¨æ˜¯ç®¡ç†podçš„ä¸­é—´å±‚ï¼Œä½¿ç”¨Podæ§åˆ¶å™¨ä¹‹åï¼Œåªéœ€è¦å‘Šè¯‰Podæ§åˆ¶å™¨ï¼Œæƒ³è¦å¤šå°‘ä¸ªä»€ä¹ˆæ ·çš„Podå°±å¯ä»¥äº†ï¼Œå®ƒä¼šåˆ›å»ºå‡ºæ»¡è¶³æ¡ä»¶çš„Podå¹¶ç¡®ä¿æ¯ä¸€ä¸ªPodèµ„æºå¤„äºç”¨æˆ·æœŸæœ›çš„ç›®æ ‡çŠ¶æ€ã€‚å¦‚æœPodèµ„æºåœ¨è¿è¡Œä¸­å‡ºç°æ•…éšœï¼Œå®ƒä¼šåŸºäºæŒ‡å®šç­–ç•¥é‡æ–°ç¼–æ’Podã€‚</strong></p><p><strong>åœ¨kubernetesä¸­ï¼Œæœ‰å¾ˆå¤šç±»å‹çš„podæ§åˆ¶å™¨ï¼Œæ¯ç§éƒ½æœ‰è‡ªå·±çš„é€‚åˆçš„åœºæ™¯ï¼Œå¸¸è§çš„æœ‰ä¸‹é¢è¿™äº›ï¼š</strong></p><ul><li><strong>ReplicationControllerï¼šæ¯”è¾ƒåŸå§‹çš„podæ§åˆ¶å™¨ï¼Œå·²ç»è¢«åºŸå¼ƒï¼Œç”±ReplicaSetæ›¿ä»£</strong></li><li><strong>ReplicaSetï¼šä¿è¯å‰¯æœ¬æ•°é‡ä¸€ç›´ç»´æŒåœ¨æœŸæœ›å€¼ï¼Œå¹¶æ”¯æŒpodæ•°é‡æ‰©ç¼©å®¹ï¼Œé•œåƒç‰ˆæœ¬å‡çº§</strong></li><li><strong>Deploymentï¼šé€šè¿‡æ§åˆ¶ReplicaSetæ¥æ§åˆ¶Podï¼Œå¹¶æ”¯æŒæ»šåŠ¨å‡çº§ã€å›é€€ç‰ˆæœ¬</strong></li><li><strong>Horizontal Pod Autoscalerï¼šå¯ä»¥æ ¹æ®é›†ç¾¤è´Ÿè½½è‡ªåŠ¨æ°´å¹³è°ƒæ•´Podçš„æ•°é‡ï¼Œå®ç°å‰Šå³°å¡«è°·</strong></li><li><strong>DaemonSetï¼šåœ¨é›†ç¾¤ä¸­çš„æŒ‡å®šNodeä¸Šè¿è¡Œä¸”ä»…è¿è¡Œä¸€ä¸ªå‰¯æœ¬ï¼Œä¸€èˆ¬ç”¨äºå®ˆæŠ¤è¿›ç¨‹ç±»çš„ä»»åŠ¡</strong></li><li><strong>Jobï¼šå®ƒåˆ›å»ºå‡ºæ¥çš„podåªè¦å®Œæˆä»»åŠ¡å°±ç«‹å³é€€å‡ºï¼Œä¸éœ€è¦é‡å¯æˆ–é‡å»ºï¼Œç”¨äºæ‰§è¡Œä¸€æ¬¡æ€§ä»»åŠ¡</strong></li><li><strong>Cronjobï¼šå®ƒåˆ›å»ºçš„Podè´Ÿè´£å‘¨æœŸæ€§ä»»åŠ¡æ§åˆ¶ï¼Œä¸éœ€è¦æŒç»­åå°è¿è¡Œ</strong></li><li><strong>StatefulSetï¼šç®¡ç†æœ‰çŠ¶æ€åº”ç”¨</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hostpathå­˜å‚¨ç±»å‹åŠheadlinesç±»å‹çš„serviceä¸æ‰‹åŠ¨æŒ‡å®šipç‰ˆmysql5.7éƒ¨ç½²å¹¶æ„å»ºwebstack</title>
      <link href="/2025/01/01/hostpath%E5%AD%98%E5%82%A8%E7%B1%BB%E5%9E%8B%E5%8F%8Aheadlines%E7%B1%BB%E5%9E%8B%E7%9A%84service%E4%B8%8E%E6%89%8B%E5%8A%A8%E6%8C%87%E5%AE%9Aip%E7%89%88mysql5.7%E9%83%A8%E7%BD%B2%E5%B9%B6%E6%9E%84%E5%BB%BAwebstack/"/>
      <url>/2025/01/01/hostpath%E5%AD%98%E5%82%A8%E7%B1%BB%E5%9E%8B%E5%8F%8Aheadlines%E7%B1%BB%E5%9E%8B%E7%9A%84service%E4%B8%8E%E6%89%8B%E5%8A%A8%E6%8C%87%E5%AE%9Aip%E7%89%88mysql5.7%E9%83%A8%E7%BD%B2%E5%B9%B6%E6%9E%84%E5%BB%BAwebstack/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="hostpathå­˜å‚¨ç±»å‹åŠheadlinesç±»å‹çš„serviceä¸æ‰‹åŠ¨æŒ‡å®šipç‰ˆmysql5-7éƒ¨ç½²å¹¶æ„å»ºwebstack"><a href="#hostpathå­˜å‚¨ç±»å‹åŠheadlinesç±»å‹çš„serviceä¸æ‰‹åŠ¨æŒ‡å®šipç‰ˆmysql5-7éƒ¨ç½²å¹¶æ„å»ºwebstack" class="headerlink" title="hostpathå­˜å‚¨ç±»å‹åŠheadlinesç±»å‹çš„serviceä¸æ‰‹åŠ¨æŒ‡å®šipç‰ˆmysql5.7éƒ¨ç½²å¹¶æ„å»ºwebstack"></a>hostpathå­˜å‚¨ç±»å‹åŠheadlinesç±»å‹çš„serviceä¸æ‰‹åŠ¨æŒ‡å®šipç‰ˆmysql5.7éƒ¨ç½²å¹¶æ„å»ºwebstack</h1><h2 id="ä¸€ã€headlinesç±»å‹çš„serviceç‰ˆmysqlæ„å»º"><a href="#ä¸€ã€headlinesç±»å‹çš„serviceç‰ˆmysqlæ„å»º" class="headerlink" title="ä¸€ã€headlinesç±»å‹çš„serviceç‰ˆmysqlæ„å»º"></a>ä¸€ã€headlinesç±»å‹çš„serviceç‰ˆmysqlæ„å»º</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ConfigMap</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mysql-cm</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">my.cnf:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    !includedir /etc/mysql/conf.d/</span></span><br><span class="line"><span class="string">    !includedir /etc/mysql/mysql.conf.d/</span></span><br><span class="line"><span class="string"></span>  </span><br><span class="line">    [<span class="string">mysqld</span>]</span><br><span class="line">    <span class="comment">## åŒä¸€å±€åŸŸç½‘å†…æ³¨æ„è¦å”¯ä¸€</span></span><br><span class="line">    <span class="string">server-id=001</span></span><br><span class="line">    <span class="comment">## å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½,å¯ä»¥éšä¾¿å–ï¼ˆå…³é”®ï¼‰</span></span><br><span class="line">    <span class="string">log-bin=mysql-bin</span></span><br><span class="line">  </span><br><span class="line">    <span class="string">gtid_mode=on</span></span><br><span class="line">    <span class="string">enforce_gtid_consistency=on</span></span><br><span class="line">  </span><br><span class="line">    <span class="string">relay-log=relay-log.log</span></span><br><span class="line">    <span class="string">binlog_format=ROW</span></span><br><span class="line">    <span class="comment">#MySQL5.7å¯ä»¥ä¸å¯ç”¨æ­¤å‚æ•°,5.7ç‰ˆæœ¬ä½¿ç”¨äº†gtid_executedè¡¨è®°å½•åŒæ­¥å¤åˆ¶çš„ä¿¡æ¯,é¿å…ä¸¤æ¬¡å†™å…¥relay-logå’Œbinlog,é™ä½äº†ä»åº“ç£ç›˜I/O</span></span><br><span class="line">    <span class="comment">#log_slave_updates=true</span></span><br><span class="line">    <span class="string">master_info_repository=TABLE</span></span><br><span class="line">    <span class="string">relay_log_info_repository=TABLE</span></span><br><span class="line">    <span class="string">sync_master_info=1</span></span><br><span class="line">    <span class="string">slave_parallel_workers=2</span></span><br><span class="line">    <span class="string">binlog_checksum=CRC32</span></span><br><span class="line">    <span class="string">master_verify_checksum=1</span></span><br><span class="line">    <span class="string">slave_sql_verify_checksum=1</span></span><br><span class="line">    <span class="string">binlog_rows_query_log_events=1</span></span><br><span class="line">    <span class="comment">#replicate_do_db=tt</span></span><br><span class="line">    <span class="comment">#MySQL5.7æ–°å¢åŠ çš„å€¼,é…ç½®åŸºäºè¡¨çš„ç»„æäº¤å¹¶è¡Œå¤åˆ¶,é»˜è®¤å€¼ä¸ºdatabaseï¼ˆåŸºäºåº“è¿›è¡Œå¤šçº¿ç¨‹å¤åˆ¶,MySQL5.6æ˜¯åŸºäºåº“çš„æ–¹å¼è¿›è¡Œå¤šçº¿ç¨‹æ–¹å¼å¤åˆ¶ï¼‰å»ºè®®æ”¹ä¸ºlogical_clock,åŸºäºè¡¨çš„ç»„æ–¹å¼å¤åˆ¶,æé«˜å¤åˆ¶çš„æ•ˆç‡</span></span><br><span class="line">    <span class="string">slave_parallel_type=logical_clock</span></span><br><span class="line">    <span class="comment">#å¼€å¯é€šç”¨æŸ¥è¯¢æ—¥å¿—</span></span><br><span class="line">    <span class="string">general_log=1</span></span><br><span class="line">    <span class="comment">#è®¾ç½®é€šç”¨æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ä¸ºæ–‡ä»¶å’Œè¡¨</span></span><br><span class="line">    <span class="string">log_output=FILE,TABLE</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">mysql</span> <span class="comment"># has to match .spec.template.metadata.labels</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">&quot;mysql&quot;</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span> <span class="comment"># by default is 1               # 3å‰¯æœ¬</span></span><br><span class="line">  <span class="comment"># minReadySeconds: 10 # by default is 0</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">mysql</span> <span class="comment"># has to match .spec.selector.matchLabels</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mysql:5.7</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_ROOT_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;root_password&quot;</span>  <span class="comment"># è®¾ç½®æ ¹å¯†ç ,å»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_DATABASE</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">webstack</span>         <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_USER</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">webstack</span>         <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;root_password&quot;</span>  <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="attr">args:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">--character-set-server=utf8mb4</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/var/lib/mysql</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">mysql-storage</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-map</span></span><br><span class="line">            <span class="attr">mountPath:</span> <span class="string">&quot;/etc/mysql/my.cnf&quot;</span></span><br><span class="line">            <span class="attr">subPath:</span> <span class="string">my.cnf</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">3306</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="comment"># å®šä¹‰ ConfigMap ç±»å‹çš„ Volume</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-map</span></span><br><span class="line">          <span class="attr">configMap:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">mysql-cm</span>  <span class="comment"># å¼•ç”¨åä¸º mysql-cm çš„ ConfigMap</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mysql-storage</span></span><br><span class="line">          <span class="attr">hostPath:</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/opt/webstack_db</span>      <span class="comment"># å®¿ä¸»æœºç›®å½•  </span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span>     <span class="comment"># ç›®å½•å­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±å…ˆåˆ›å»ºåä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">service-mysql</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">clusterIP:</span> <span class="string">None</span>  <span class="comment"># serviceçš„ipåœ°å€,å¦‚æœä¸å†™,é»˜è®¤ä¼šç”Ÿæˆä¸€ä¸ª æ­¤ä¸­å³ä¸ºheadlineç±»å‹çš„service</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ClusterIP</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">3306</span>             <span class="comment"># Serviceç«¯å£</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">3306</span>       <span class="comment"># podç«¯å£</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹åŸŸåå†…éƒ¨dnsè§£æ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="built_in">exec</span> -it mysql-0 -n dev   -- /bin/sh </span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line"><span class="comment"># bin  boot  dev  docker-entrypoint-initdb.d  entrypoint.sh  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span></span><br><span class="line"><span class="built_in">cat</span> /etc/resolv.conf </span><br><span class="line"><span class="comment"># search dev.svc.cluster.local svc.cluster.local cluster.local</span></span><br><span class="line"><span class="comment"># nameserver 10.96.0.10</span></span><br><span class="line"><span class="comment"># options ndots:5</span></span><br></pre></td></tr></table></figure><p><strong>å¤‡æ³¨ï¼šåŸŸåè§„åˆ™ svcåç§°+nsåç§°+å†™æ­»éƒ¨åˆ†svc.cluster.local å³æ­¤headlinessç±»å‹çš„podåŸŸåæ–¹å¼è®¿é—®åº”è¯¥æ˜¯</strong></p><p>service-mysql.dev.svc.cluster.local</p><p><strong>éªŒè¯ï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">dig @10.96.0.10 service-mysql.dev.svc.cluster.local </span><br><span class="line">// è¿”å›</span><br><span class="line">root@k8s:/opt/webstack<span class="comment"># dig @10.96.0.10 service-mysql.dev.svc.cluster.local</span></span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.11.3-1ubuntu1.18-Ubuntu &lt;&lt;&gt;&gt; @10.96.0.10 service-mysql.dev.svc.cluster.local</span><br><span class="line">; (1 server found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; WARNING: .<span class="built_in">local</span> is reserved <span class="keyword">for</span> Multicast DNS</span><br><span class="line">;; You are currently testing what happens when an mDNS query is leaked to DNS</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- <span class="string">opcode: QUERY, status: NOERROR, id: 52747</span></span><br><span class="line"><span class="string">;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1</span></span><br><span class="line"><span class="string">;; WARNING: recursion requested but not available</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; OPT PSEUDOSECTION:</span></span><br><span class="line"><span class="string">; EDNS: version: 0, flags:; udp: 4096</span></span><br><span class="line"><span class="string">; COOKIE: dd22da56f562b801 (echoed)</span></span><br><span class="line"><span class="string">;; QUESTION SECTION:</span></span><br><span class="line"><span class="string">;service-mysql.dev.svc.cluster.local. IN        A</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; ANSWER SECTION:</span></span><br><span class="line"><span class="string">service-mysql.dev.svc.cluster.local. 30 IN A    172.16.0.9</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; Query time: 0 msec</span></span><br><span class="line"><span class="string">;; SERVER: 10.96.0.10#53(10.96.0.10)</span></span><br><span class="line"><span class="string">;; WHEN: Tue Dec 24 15:19:34 CST 2024</span></span><br><span class="line"><span class="string">;; MSG SIZE  rcvd: 127</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">root@k8s:/opt/webstack# kubectl get pod -n dev -o wide</span></span><br><span class="line"><span class="string">NAME      READY   STATUS    RESTARTS      AGE   IP           NODE   NOMINATED NODE   READINESS GATES</span></span><br><span class="line"><span class="string">mysql-0   1/1     Running   0             18m   172.16.0.9   k8s    &lt;none&gt;           &lt;none&gt;</span></span><br><span class="line"><span class="string">qexo-0    1/1     Running   1 (64m ago)   77m   172.16.0.6   k8s    &lt;none&gt;           &lt;none&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_bbf96436226c61db3ef129199d2968e5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_bbf96436226c61db3ef129199d2968e5.png"></p><p><strong>headlinesç±»å‹çš„serviceé›†ç¾¤ä¹‹é—´é€šä¿¡ç›´æ¥ä½¿ç”¨svcåç§°</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_d98ea5eb38a20aaf13987b58ab40b280.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_d98ea5eb38a20aaf13987b58ab40b280.png"></p><h2 id="äºŒã€webstackæ„å»º"><a href="#äºŒã€webstackæ„å»º" class="headerlink" title="äºŒã€webstackæ„å»º"></a>äºŒã€webstackæ„å»º</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»ºwebstack</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">webstack</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span>         <span class="comment"># ä¿®æ”¹ä¸º3å‰¯æœ¬</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">webstack</span>   <span class="comment"># å¿…é¡»ä¸ .spec.template.metadata.labels åŒ¹é…</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">webstack</span> <span class="comment"># å¿…é¡»ä¸ .spec.selector.matchLabels åŒ¹é…</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">webstack</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:webstackv-1.2.2</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">LOGIN_COPTCHA</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;false&quot;</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_HOST</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;service-mysql&quot;</span>  <span class="comment"># æ­¤å¤„ä¸ºheadlinesç±»å‹çš„serviceç‰ˆmysqlçš„åœ°å€</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_DATABASE</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">webstack</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_USERNAME</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">root</span>   </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">root_password</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">APP_URL</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;&quot;</span> <span class="comment"># ç©ºå€¼æ˜ç¡®å†™ä¸º &quot;&quot;</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8000</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">webstack</span></span><br><span class="line">        <span class="attr">command:</span> [<span class="string">&#x27;/entrypoint.sh&#x27;</span>,<span class="string">&#x27;serve&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æš´éœ²webstackç«¯å£</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">webstack-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">webstack</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8000</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8000</span></span><br><span class="line">  <span class="attr">sessionAffinity:</span> <span class="string">ClientIP</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span> <span class="comment"># å°†æœåŠ¡æš´éœ²ä¸º NodePort ç±»å‹</span></span><br></pre></td></tr></table></figure><p>æˆåŠŸï¼</p><h2 id="ä¸‰ã€æ‰©å±•ã€clusterIP-æ‰‹åŠ¨æŒ‡å®šIPç‰ˆæœ¬éƒ¨ç½²MySQLä¸webstack"><a href="#ä¸‰ã€æ‰©å±•ã€clusterIP-æ‰‹åŠ¨æŒ‡å®šIPç‰ˆæœ¬éƒ¨ç½²MySQLä¸webstack" class="headerlink" title="ä¸‰ã€æ‰©å±•ã€clusterIP æ‰‹åŠ¨æŒ‡å®šIPç‰ˆæœ¬éƒ¨ç½²MySQLä¸webstack"></a>ä¸‰ã€æ‰©å±•ã€clusterIP æ‰‹åŠ¨æŒ‡å®šIPç‰ˆæœ¬éƒ¨ç½²MySQLä¸webstack</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mysqlé…ç½®</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ConfigMap</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mysql-cm</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">my.cnf:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    !includedir /etc/mysql/conf.d/</span></span><br><span class="line"><span class="string">    !includedir /etc/mysql/mysql.conf.d/</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    [<span class="string">mysqld</span>]</span><br><span class="line">    <span class="comment">## åŒä¸€å±€åŸŸç½‘å†…æ³¨æ„è¦å”¯ä¸€</span></span><br><span class="line">    <span class="string">server-id=001</span></span><br><span class="line">    <span class="comment">## å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½ï¼Œå¯ä»¥éšä¾¿å–ï¼ˆå…³é”®ï¼‰</span></span><br><span class="line">    <span class="string">log-bin=mysql-bin</span></span><br><span class="line"></span><br><span class="line">    <span class="string">gtid_mode=on</span></span><br><span class="line">    <span class="string">enforce_gtid_consistency=on</span></span><br><span class="line"></span><br><span class="line">    <span class="string">relay-log=relay-log.log</span></span><br><span class="line">    <span class="string">binlog_format=ROW</span></span><br><span class="line">    <span class="comment">#MySQL5.7å¯ä»¥ä¸å¯ç”¨æ­¤å‚æ•°ï¼Œ5.7ç‰ˆæœ¬ä½¿ç”¨äº†gtid_executedè¡¨è®°å½•åŒæ­¥å¤åˆ¶çš„ä¿¡æ¯ï¼Œé¿å…ä¸¤æ¬¡å†™å…¥relay-logå’Œbinlogï¼Œé™ä½äº†ä»åº“ç£ç›˜I/O</span></span><br><span class="line">    <span class="comment">#log_slave_updates=true</span></span><br><span class="line">    <span class="string">master_info_repository=TABLE</span></span><br><span class="line">    <span class="string">relay_log_info_repository=TABLE</span></span><br><span class="line">    <span class="string">sync_master_info=1</span></span><br><span class="line">    <span class="string">slave_parallel_workers=2</span></span><br><span class="line">    <span class="string">binlog_checksum=CRC32</span></span><br><span class="line">    <span class="string">master_verify_checksum=1</span></span><br><span class="line">    <span class="string">slave_sql_verify_checksum=1</span></span><br><span class="line">    <span class="string">binlog_rows_query_log_events=1</span></span><br><span class="line">    <span class="comment">#replicate_do_db=tt</span></span><br><span class="line">    <span class="comment">#MySQL5.7æ–°å¢åŠ çš„å€¼ï¼Œé…ç½®åŸºäºè¡¨çš„ç»„æäº¤å¹¶è¡Œå¤åˆ¶ï¼Œé»˜è®¤å€¼ä¸ºdatabaseï¼ˆåŸºäºåº“è¿›è¡Œå¤šçº¿ç¨‹å¤åˆ¶ï¼ŒMySQL5.6æ˜¯åŸºäºåº“çš„æ–¹å¼è¿›è¡Œå¤šçº¿ç¨‹æ–¹å¼å¤åˆ¶ï¼‰å»ºè®®æ”¹ä¸ºlogical_clockï¼ŒåŸºäºè¡¨çš„ç»„ æ–¹å¼å¤åˆ¶ï¼Œæé«˜å¤åˆ¶çš„æ•ˆç‡</span></span><br><span class="line">    <span class="string">slave_parallel_type=logical_clock</span></span><br><span class="line">    <span class="comment">#å¼€å¯é€šç”¨æŸ¥è¯¢æ—¥å¿—</span></span><br><span class="line">    <span class="string">general_log=1</span></span><br><span class="line">    <span class="comment">#è®¾ç½®é€šç”¨æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ä¸ºæ–‡ä»¶å’Œè¡¨</span></span><br><span class="line">    <span class="string">log_output=FILE,TABLE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">mysql</span> <span class="comment"># has to match .spec.template.metadata.labels</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">&quot;mysql&quot;</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span> <span class="comment"># by default is 1               # 3å‰¯æœ¬</span></span><br><span class="line">  <span class="comment"># minReadySeconds: 10 # by default is 0</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">mysql</span> <span class="comment"># has to match .spec.selector.matchLabels</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mysql:5.7</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_ROOT_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;root_password&quot;</span>         <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_DATABASE</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">webstack</span>         <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_USER</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">webstack</span>         <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;root_password&quot;</span>  <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="attr">args:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">--character-set-server=utf8mb4</span></span><br><span class="line">          <span class="comment"># - --collation-server=utf8mb4_unicode_ci</span></span><br><span class="line">          <span class="comment"># - &quot;--default-authentication-plugin=mysql_native_password&quot;</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/var/lib/mysql</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">mysql-storage</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-map</span></span><br><span class="line">            <span class="attr">mountPath:</span> <span class="string">&quot;/etc/mysql/my.cnf&quot;</span></span><br><span class="line">            <span class="attr">subPath:</span> <span class="string">my.cnf</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">3306</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="comment"># å®šä¹‰ ConfigMap ç±»å‹çš„ Volume</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-map</span></span><br><span class="line">          <span class="attr">configMap:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">mysql-cm</span>  <span class="comment"># å¼•ç”¨åä¸º mysql-cm çš„ ConfigMap</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mysql-storage</span></span><br><span class="line">          <span class="attr">hostPath:</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/opt/mysql</span>         <span class="comment"># å®¿ä¸»æœºç›®å½•</span></span><br><span class="line">            <span class="attr">type:</span> <span class="string">DirectoryOrCreate</span>  <span class="comment"># ç›®å½•å­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±å…ˆåˆ›å»ºåä½¿ç”¨</span></span><br><span class="line">        <span class="comment"># # å®šä¹‰æŒä¹…åŒ–å­˜å‚¨ Volume</span></span><br><span class="line">        <span class="comment"># - name: mysql-storage</span></span><br><span class="line">        <span class="comment">#   persistentVolumeClaim:</span></span><br><span class="line">        <span class="comment">#     claimName: mysql-pvc</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿mysql ipå›ºå®š</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">service-mysql</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">clusterIP:</span> <span class="number">10.96</span><span class="number">.0</span><span class="number">.2</span>  <span class="comment"># serviceçš„ipåœ°å€ï¼Œå¦‚æœä¸å†™ï¼Œé»˜è®¤ä¼šç”Ÿæˆä¸€ä¸ª</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ClusterIP</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">3306</span>             <span class="comment"># Serviceç«¯å£</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">3306</span>       <span class="comment"># podç«¯å£</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºwebstack</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">webstack</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span>         <span class="comment"># ä¿®æ”¹ä¸º3å‰¯æœ¬</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">webstack</span>   <span class="comment"># å¿…é¡»ä¸ .spec.template.metadata.labels åŒ¹é…</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">webstack</span> <span class="comment"># å¿…é¡»ä¸ .spec.selector.matchLabels åŒ¹é…</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">webstack</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:webstackv-1.2.2</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">LOGIN_COPTCHA</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;false&quot;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_HOST</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;10.96.0.2&quot;</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_DATABASE</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">webstack</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_USERNAME</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">root</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">root_password</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">APP_URL</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;&quot;</span> <span class="comment"># ç©ºå€¼æ˜ç¡®å†™ä¸º &quot;&quot;</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8000</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">webstack</span></span><br><span class="line">        <span class="attr">command:</span> [<span class="string">&#x27;/entrypoint.sh&#x27;</span>,<span class="string">&#x27;serve&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æš´éœ²webstackç«¯å£</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">webstack-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">webstack</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8000</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8000</span></span><br><span class="line">  <span class="attr">sessionAffinity:</span> <span class="string">ClientIP</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span> <span class="comment"># å°†æœåŠ¡æš´éœ²ä¸º NodePort ç±»å‹</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11.3ã€æ±¡ç‚¹å’Œå®¹å¿ï¼ˆTaintsï¼‰</title>
      <link href="/2024/12/23/11.3%E3%80%81%E6%B1%A1%E7%82%B9%E5%92%8C%E5%AE%B9%E5%BF%8D%EF%BC%88Taints%EF%BC%89/"/>
      <url>/2024/12/23/11.3%E3%80%81%E6%B1%A1%E7%82%B9%E5%92%8C%E5%AE%B9%E5%BF%8D%EF%BC%88Taints%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="11-3ã€æ±¡ç‚¹å’Œå®¹å¿ï¼ˆTaintsï¼‰"><a href="#11-3ã€æ±¡ç‚¹å’Œå®¹å¿ï¼ˆTaintsï¼‰" class="headerlink" title="11.3ã€æ±¡ç‚¹å’Œå®¹å¿ï¼ˆTaintsï¼‰"></a>11.3ã€æ±¡ç‚¹å’Œå®¹å¿ï¼ˆTaintsï¼‰</h2><h5 id="5-4-3-æ±¡ç‚¹å’Œå®¹å¿"><a href="#5-4-3-æ±¡ç‚¹å’Œå®¹å¿" class="headerlink" title="5.4.3 æ±¡ç‚¹å’Œå®¹å¿"></a>5.4.3 æ±¡ç‚¹å’Œå®¹å¿</h5><h2 id="ä¸€ã€æ±¡ç‚¹ï¼ˆTaintsï¼‰"><a href="#ä¸€ã€æ±¡ç‚¹ï¼ˆTaintsï¼‰" class="headerlink" title="ä¸€ã€æ±¡ç‚¹ï¼ˆTaintsï¼‰"></a>ä¸€ã€æ±¡ç‚¹ï¼ˆTaintsï¼‰</h2><p><strong>å‰é¢çš„è°ƒåº¦æ–¹å¼éƒ½æ˜¯ç«™åœ¨Podçš„è§’åº¦ä¸Šï¼Œé€šè¿‡åœ¨Podä¸Šæ·»åŠ å±æ€§ï¼Œæ¥ç¡®å®šPodæ˜¯å¦è¦è°ƒåº¦åˆ°æŒ‡å®šçš„Nodeä¸Šï¼Œå…¶å®æˆ‘ä»¬ä¹Ÿå¯ä»¥ç«™åœ¨Nodeçš„è§’åº¦ä¸Šï¼Œé€šè¿‡åœ¨Nodeä¸Šæ·»åŠ ****æ±¡ç‚¹</strong>å±æ€§ï¼Œæ¥å†³å®šæ˜¯å¦å…è®¸Podè°ƒåº¦è¿‡æ¥ã€‚</p><p><strong>Nodeè¢«è®¾ç½®ä¸Šæ±¡ç‚¹ä¹‹åå°±å’ŒPodä¹‹é—´å­˜åœ¨äº†ä¸€ç§ç›¸æ–¥çš„å…³ç³»</strong>ï¼Œè¿›è€Œæ‹’ç»Podè°ƒåº¦è¿›æ¥ï¼Œç”šè‡³å¯ä»¥å°†å·²ç»å­˜åœ¨çš„Podé©±é€å‡ºå»ã€‚</p><p><strong>æ±¡ç‚¹çš„æ ¼å¼ä¸ºï¼š</strong><code>key=value:effect</code>, keyå’Œvalueæ˜¯æ±¡ç‚¹çš„æ ‡ç­¾ï¼Œeffectæè¿°æ±¡ç‚¹çš„ä½œç”¨ï¼Œæ”¯æŒå¦‚ä¸‹ä¸‰ä¸ªé€‰é¡¹ï¼š</p><ul><li><p><strong>PreferNoScheduleï¼škubernetes</strong>å°†å°½é‡é¿å…æŠŠPodè°ƒåº¦åˆ°å…·æœ‰è¯¥æ±¡ç‚¹çš„Nodeä¸Š**ï¼Œé™¤éæ²¡æœ‰å…¶ä»–èŠ‚ç‚¹å¯è°ƒåº¦</p></li><li><p><strong>NoScheduleï¼škubernetes</strong>å°†ä¸ä¼šæŠŠPodè°ƒåº¦åˆ°å…·æœ‰è¯¥æ±¡ç‚¹çš„Nodeä¸Š<strong>ï¼Œ</strong>ä½†ä¸ä¼šå½±å“å½“å‰Nodeä¸Šå·²å­˜åœ¨çš„Pod</p></li><li><p>NoExecuteï¼škuberneteså°†ä¸ä¼šæŠŠPodè°ƒåº¦åˆ°å…·æœ‰è¯¥æ±¡ç‚¹çš„Nodeä¸Šï¼Œ**åŒæ—¶ä¹Ÿä¼šå°†Nodeä¸Šå·²å­˜åœ¨çš„Podé©±ç¦»</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_6a5ef52803df8b0fa5f4224196dc22d5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_6a5ef52803df8b0fa5f4224196dc22d5.png"></p></li></ul><p><strong>ä½¿ç”¨kubectlè®¾ç½®å’Œå»é™¤æ±¡ç‚¹çš„å‘½ä»¤ç¤ºä¾‹å¦‚ä¸‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®æ±¡ç‚¹</span></span><br><span class="line">kubectl taint nodes node1 key=value:effect</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»é™¤æ±¡ç‚¹</span></span><br><span class="line">kubectl taint nodes node1 key:effect-</span><br><span class="line"></span><br><span class="line"><span class="comment"># å»é™¤æ‰€æœ‰æ±¡ç‚¹</span></span><br><span class="line">kubectl taint nodes node1 key-</span><br></pre></td></tr></table></figure><p><strong>æ¥ä¸‹æ¥ï¼Œæ¼”ç¤ºä¸‹æ±¡ç‚¹çš„æ•ˆæœï¼š</strong></p><ol><li><strong>å‡†å¤‡èŠ‚ç‚¹node1ï¼ˆä¸ºäº†æ¼”ç¤ºæ•ˆæœæ›´åŠ æ˜æ˜¾ï¼Œæš‚æ—¶åœæ­¢node2èŠ‚ç‚¹ï¼‰</strong></li><li><strong>ä¸ºnode1èŠ‚ç‚¹è®¾ç½®ä¸€ä¸ªæ±¡ç‚¹:</strong> <code>tag=heima:PreferNoSchedule</code>ï¼›ç„¶ååˆ›å»ºpod1( pod1 å¯ä»¥ )</li><li>**ä¿®æ”¹ä¸ºnode1èŠ‚ç‚¹è®¾ç½®ä¸€ä¸ªæ±¡ç‚¹: **<code>tag=heima:NoSchedule</code>ï¼›   ç„¶ååˆ›å»ºpod2( pod1 æ­£å¸¸ pod2 å¤±è´¥ )</li><li>**ä¿®æ”¹ä¸ºnode1èŠ‚ç‚¹è®¾ç½®ä¸€ä¸ªæ±¡ç‚¹: **<code>tag=heima:NoExecute</code>ï¼›     ç„¶ååˆ›å»ºpod3 ( 3ä¸ªpodéƒ½å¤±è´¥ )</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ºnode1è®¾ç½®æ±¡ç‚¹ï¼ˆPreferNoScheduleï¼‰</span></span><br><span class="line">kubectl taint nodes node1 tag=heima:PreferNoSchedule</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ±¡ç‚¹</span></span><br><span class="line">kubectl describe nodes |grep Taints  </span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºpod1ï¼ˆå¯ä»¥æ­£å¸¸è¿è¡Œï¼‰</span></span><br><span class="line">kubectl run taint1 --image=registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest -n dev</span><br><span class="line">kubectl get pods -n dev -o wide</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºnode1è®¾ç½®æ±¡ç‚¹(å–æ¶ˆPreferNoScheduleåŠ ä¸ª-å‡å·å³å¯ï¼Œè®¾ç½®NoSchedule)</span></span><br><span class="line"><span class="comment"># æ­¤æ—¶èŠ‚ç‚¹ä¸Šå·²ç»å­˜åœ¨çš„æ­£å¸¸è¿è¡Œ åˆ›å»ºæ–°çš„åˆ™å¤±è´¥ä¸ºpendingçŠ¶æ€</span></span><br><span class="line">kubectl taint nodes node1 tag:PreferNoSchedule-</span><br><span class="line">kubectl taint nodes node1 tag=heima:NoSchedule</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºpod2</span></span><br><span class="line">kubectl run taint2 --image=registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest -n dev</span><br><span class="line">kubectl get pods taint2 -n dev -o wide</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¸ºnode1è®¾ç½®æ±¡ç‚¹(å–æ¶ˆNoScheduleï¼Œè®¾ç½®NoExecute)</span></span><br><span class="line">kubectl taint nodes node1 tag:NoSchedule-</span><br><span class="line">kubectl taint nodes node1 tag=heima:NoExecute</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºpod3</span></span><br><span class="line">kubectl run taint3 --image=registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest -n dev</span><br><span class="line">kubectl get pods -n dev -o wide</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹èŠ‚ç‚¹æ±¡æŸ“ï¼š</strong></p><p><strong>tag=heima:PreferNoSchedule æ­£å¸¸è¿è¡Œ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_929c89f9cb56ad00e6cba9511bc5cb76.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_929c89f9cb56ad00e6cba9511bc5cb76.png"></p><p><strong>tag=heima:NoSchedule å·²ç»å­˜åœ¨çš„æ­£å¸¸è¿è¡Œ ä¸å­˜åœ¨çš„æ— æ³•åˆ›å»º</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_c985ac7be50b36495a05c907c4491086.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_c985ac7be50b36495a05c907c4491086.png"></p><p><strong>tag=heima:NoExecute ä¸èƒ½åˆ›å»ºä¸”å·²ç»å­˜åœ¨çš„ä¼šå˜æˆpendingçŠ¶æ€</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_45917f8c57c5bb25841a6dd6e2f7295a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_45917f8c57c5bb25841a6dd6e2f7295a.png"></p><p><strong>å°æç¤ºï¼š</strong></p><ul><li><strong>ä½¿ç”¨kubeadmæ­å»ºçš„é›†ç¾¤ï¼Œ</strong>é»˜è®¤å°±ä¼šç»™masterèŠ‚ç‚¹æ·»åŠ ä¸€ä¸ªæ±¡ç‚¹æ ‡è®°**,æ‰€ä»¥podå°±ä¸ä¼šè°ƒåº¦åˆ°masterèŠ‚ç‚¹ä¸Š.**</li></ul><h2 id="äºŒã€å®¹å¿ï¼ˆTolerationï¼‰"><a href="#äºŒã€å®¹å¿ï¼ˆTolerationï¼‰" class="headerlink" title="äºŒã€å®¹å¿ï¼ˆTolerationï¼‰"></a>äºŒã€å®¹å¿ï¼ˆTolerationï¼‰</h2><p><strong>ä¸Šé¢ä»‹ç»äº†æ±¡ç‚¹çš„ä½œç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨nodeä¸Šæ·»åŠ æ±¡ç‚¹ç”¨äºæ‹’ç»podè°ƒåº¦ä¸Šæ¥ï¼Œä½†æ˜¯å¦‚æœå°±æ˜¯æƒ³å°†ä¸€ä¸ªpodè°ƒåº¦åˆ°ä¸€ä¸ªæœ‰æ±¡ç‚¹çš„nodeä¸Šå»ï¼Œè¿™æ—¶å€™åº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿè¿™å°±è¦ä½¿ç”¨åˆ°<strong><strong>å®¹å¿</strong></strong>ã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_d8313ab720279ccfd4715949a4358d12.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_d8313ab720279ccfd4715949a4358d12.png"></p><p><strong>æ±¡ç‚¹å°±æ˜¯æ‹’ç»ï¼Œå®¹å¿å°±æ˜¯å¿½ç•¥ï¼ŒNodeé€šè¿‡æ±¡ç‚¹æ‹’ç»podè°ƒåº¦ä¸Šå»ï¼ŒPodé€šè¿‡å®¹å¿å¿½ç•¥æ‹’ç»</strong></p><p><strong>ä¸‹é¢å…ˆé€šè¿‡ä¸€ä¸ªæ¡ˆä¾‹çœ‹ä¸‹æ•ˆæœï¼š</strong></p><ol><li><strong>ä¸Šä¸€å°èŠ‚ï¼Œå·²ç»åœ¨node1èŠ‚ç‚¹ä¸Šæ‰“ä¸Šäº†</strong><code>&lt;span class=&quot;ne-text&quot;&gt;NoExecute&lt;/span&gt;</code>çš„æ±¡ç‚¹ï¼Œæ­¤æ—¶podæ˜¯è°ƒåº¦ä¸ä¸Šå»çš„</li><li><strong>æœ¬å°èŠ‚ï¼Œå¯ä»¥é€šè¿‡ç»™podæ·»åŠ å®¹å¿ï¼Œç„¶åå°†å…¶è°ƒåº¦ä¸Šå»</strong></li></ol><h3 id="â‘ ã€æ·»åŠ å®¹å¿"><a href="#â‘ ã€æ·»åŠ å®¹å¿" class="headerlink" title="â‘ ã€æ·»åŠ å®¹å¿"></a>â‘ ã€æ·»åŠ å®¹å¿</h3><p><strong>å½“å‰å·²æœ‰æ±¡ç‚¹</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å®¹å¿</span></span><br><span class="line">kubectl describe nodes |grep Taints</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_a049a5cb4835960227191a854537515b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_a049a5cb4835960227191a854537515b.png"><img src="https://cdn.nlark.com/yuque/0/2024/png/49872452/1730181091573-3816af4d-578f-46af-b877-25a1a69f3e89.png"></p><p><strong>åˆ›å»ºpod-toleration.yaml,å†…å®¹å¦‚ä¸‹</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-toleration</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span></span><br><span class="line">  <span class="attr">tolerations:</span>        <span class="comment"># æ·»åŠ å®¹å¿</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">&quot;tag&quot;</span>        <span class="comment"># è¦å®¹å¿çš„æ±¡ç‚¹çš„key</span></span><br><span class="line">    <span class="attr">operator:</span> <span class="string">&quot;Equal&quot;</span> <span class="comment"># æ“ä½œç¬¦ï¼ˆç­‰äºæ“ä½œç¬¦ï¼‰</span></span><br><span class="line">    <span class="attr">value:</span> <span class="string">&quot;heima&quot;</span>        <span class="comment"># å®¹å¿çš„æ±¡ç‚¹çš„value</span></span><br><span class="line">    <span class="attr">effect:</span> <span class="string">&quot;NoExecute&quot;</span>   <span class="comment"># æ·»åŠ å®¹å¿çš„è§„åˆ™ï¼Œè¿™é‡Œå¿…é¡»å’Œæ ‡è®°çš„æ±¡ç‚¹è§„åˆ™ç›¸åŒ</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ å®¹å¿ä¹‹å‰çš„pod</span></span><br><span class="line">kubectl get pods -n dev -o wide  </span><br><span class="line"><span class="comment"># æ·»åŠ å®¹å¿ä¹‹åçš„pod</span></span><br><span class="line">kubectl get pods -n dev -o wide</span><br></pre></td></tr></table></figure><p>æ·»åŠ NoExecuteå®¹å¿å‰ä¸å®¹å¿åçŠ¶æ€</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_02ab68ad4ca512c496719b5c8baba33a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_02ab68ad4ca512c496719b5c8baba33a.png"></p><p><strong>ä¸‹é¢çœ‹ä¸€ä¸‹å®¹å¿çš„è¯¦ç»†é…ç½®:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">kubectl explain pod.spec.tolerations</span><br><span class="line">......</span><br><span class="line">FIELDS:</span><br><span class="line">   key       <span class="comment"># å¯¹åº”ç€è¦å®¹å¿çš„æ±¡ç‚¹çš„é”®ï¼Œç©ºæ„å‘³ç€åŒ¹é…æ‰€æœ‰çš„é”®</span></span><br><span class="line">   value     <span class="comment"># å¯¹åº”ç€è¦å®¹å¿çš„æ±¡ç‚¹çš„å€¼</span></span><br><span class="line">   operator  <span class="comment"># key-valueçš„è¿ç®—ç¬¦ï¼Œæ”¯æŒEqualå’ŒExistsï¼ˆé»˜è®¤ï¼‰</span></span><br><span class="line">   effect    <span class="comment"># å¯¹åº”æ±¡ç‚¹çš„effectï¼Œç©ºæ„å‘³ç€åŒ¹é…æ‰€æœ‰å½±å“</span></span><br><span class="line">   tolerationSeconds   <span class="comment"># å®¹å¿æ—¶é—´, å½“effectä¸ºNoExecuteæ—¶ç”Ÿæ•ˆï¼Œè¡¨ç¤ºpodåœ¨Nodeä¸Šçš„åœç•™æ—¶é—´</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8sä¸­podæ— æ³•è®¿é—®åŸŸåè§£å†³</title>
      <link href="/2024/12/22/k8s%E4%B8%ADpod%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E5%9F%9F%E5%90%8D%E8%A7%A3%E5%86%B3/"/>
      <url>/2024/12/22/k8s%E4%B8%ADpod%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E5%9F%9F%E5%90%8D%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="k8sä¸­podæ— æ³•è®¿é—®åŸŸåè§£å†³"><a href="#k8sä¸­podæ— æ³•è®¿é—®åŸŸåè§£å†³" class="headerlink" title="k8sä¸­podæ— æ³•è®¿é—®åŸŸåè§£å†³"></a>k8sä¸­podæ— æ³•è®¿é—®åŸŸåè§£å†³</h2><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/sky-cheng/p/14254871.html" title="å‘å¸ƒäº 2021-06-30 17:06">kubernetesä¸­çš„podä¸èƒ½è®¿é—®åŸŸåé—®é¢˜æ’æŸ¥ </a></p><h3 id="ä¸€ã€è¿›å…¥podå¯ä»¥è®¿é—®IPï¼Œä¸èƒ½è®¿é—®åŸŸå"><a href="#ä¸€ã€è¿›å…¥podå¯ä»¥è®¿é—®IPï¼Œä¸èƒ½è®¿é—®åŸŸå" class="headerlink" title="ä¸€ã€è¿›å…¥podå¯ä»¥è®¿é—®IPï¼Œä¸èƒ½è®¿é—®åŸŸå"></a>ä¸€ã€è¿›å…¥podå¯ä»¥è®¿é—®IPï¼Œä¸èƒ½è®¿é—®åŸŸå</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl exec -it qexo-0  -n dev  -- /bin/sh</span><br><span class="line">bash-5.0# ping www.baidu.com</span><br><span class="line">ping: bad address &#x27;www.baidu.com</span><br></pre></td></tr></table></figure><h3 id="äºŒã€è¿›å…¥ç›®æ ‡podå®¹å™¨ï¼ŒæŸ¥çœ‹-etc-resolv-conf"><a href="#äºŒã€è¿›å…¥ç›®æ ‡podå®¹å™¨ï¼ŒæŸ¥çœ‹-etc-resolv-conf" class="headerlink" title="äºŒã€è¿›å…¥ç›®æ ‡podå®¹å™¨ï¼ŒæŸ¥çœ‹/etc/resolv.conf"></a>äºŒã€è¿›å…¥ç›®æ ‡podå®¹å™¨ï¼ŒæŸ¥çœ‹/etc/resolv.conf</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bash-5.0# cat /etc/resolv.conf </span><br><span class="line">nameserver 10.96.0.10</span><br><span class="line">search hl95-notary.svc.master69.kubernetes.blockchain.hl95.com svc.master69.kubernetes.blockchain.hl95.com master69.kubernetes.blockchain.hl95.com hlqxt</span><br><span class="line">options ndots:5</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°dnsæœåŠ¡å™¨IPä¸º0.96.0.10,æˆ‘ä»¬æŸ¥çœ‹ä¸‹ç³»ç»Ÿçš„coredns podå®¹å™¨ä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@redis-03 kubernetes]# kubectl get pods -n kube-system -o wide |grep coredns</span><br><span class="line">coredns-66bff467f8-6w5j5            1/1     Running   0          3d20h   10.244.3.9     redis-03.hlqxt   &lt;none&gt;           &lt;none&gt;</span><br><span class="line">coredns-66bff467f8-h2zgp            1/1     Running   0          3d20h   10.244.4.9     redis-02.hlqxt   &lt;none&gt;           &lt;none&gt;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªcoredns podä½äºä¸¤ä¸ªnodeèŠ‚ç‚¹ä¸Šï¼Œå¹¶ä¸”çŠ¶æ€æ˜¯runningï¼Œæ­£å¸¸</p><p>æˆ‘ä»¬å†è¿›ä¸€æ­¥æŸ¥çœ‹dns serviceä¿¡æ¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@redis-03 kubernetes]# kubectl get svc -n kube-system -o wide</span><br><span class="line">NAME       TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)                  AGE    SELECTOR</span><br><span class="line">kube-dns   ClusterIP   10.96.0.10   &lt;none&gt;        53/UDP,53/TCP,9153/TCP   5d2h   k8s-app=kube-dns</span><br></pre></td></tr></table></figure><p>kube-dnsæœåŠ¡çš„IPæ­£æ˜¯10.96.0.10ï¼Œè¿™æ ·æˆ‘ä»¬çŸ¥é“äº†podæ˜¯é€šè¿‡kube-dns æœåŠ¡æ¥è§£æåŸŸåçš„ï¼Œç°åœ¨çš„é—®é¢˜æ˜¯PODæ— æ³•ä¸kube-dnsé€šä¿¡å‘¢ï¼Ÿè¿˜æ˜¯corednsæœ¬èº«åŸŸåè§£ææœ‰é—®é¢˜å‘¢ï¼Œæˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥æ¥ç¡®è®¤kube-dns æœåŠ¡åç«¯æ­£ç¡®ç»‘å®šäº†corednså®¹å™¨ï¼Œæˆ‘ä»¬æŸ¥çœ‹endpointæ¥ç¡®è®¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@redis-03 kubernetes]# kubectl get endpoints -n kube-system -o wide|grep kube-dns</span><br><span class="line">kube-dns                  10.244.3.9:53,10.244.4.9:53,10.244.3.9:9153 + 3 more...   5d2h</span><br><span class="line">[root@redis-03 kubernetes]# </span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°kube-dnsåç«¯æ­£ç¡®çš„ç»‘å®šäº†ä¸¤ä¸ªcoredns podçš„IPã€‚</p><p>æˆ‘ä»¬å†å°†ç›®æ ‡podä¸­çš„nameserver çš„ipåœ°å€æ”¹ä¸ºcoredns podçš„IPåœ°å€ï¼Œç»•è¿‡kube-dnsæœåŠ¡ï¼Œç›´æ¥ä¸coredns podé€šä¿¡</p><p>å‚è€ƒä¾‹å­ï¼ˆæ— æ•ˆï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bash-5.0<span class="comment"># cat /etc/resolv.conf </span></span><br><span class="line">nameserver 10.244.3.9</span><br><span class="line"><span class="comment">#nameserver 10.96.0.10</span></span><br><span class="line">search hl95-notary.svc.master69.kubernetes.blockchain.hl95.com svc.master69.kubernetes.blockchain.hl95.com master69.kubernetes.blockchain.hl95.com hlqxt</span><br><span class="line">options ndots:5</span><br></pre></td></tr></table></figure><p>10.244.3.9ï¼šä¸ºcoredns podå…¶ä¸­ä¸€ä¸ªçš„IP</p><p><strong>å®é™…æ“ä½œè®¾ç½®pod dnsæœåŠ¡å™¨ä¸ºé˜¿é‡Œäº‘çš„</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/app <span class="comment"># cat /etc/resolv.conf</span></span><br><span class="line">search dev.svc.cluster.local svc.cluster.local cluster.local</span><br><span class="line"><span class="comment"># nameserver 10.96.0.10</span></span><br><span class="line">nameserver 223.5.5.5  <span class="comment">#172.16.77.25</span></span><br><span class="line">options ndots:5</span><br></pre></td></tr></table></figure><p>å†æ‰§è¡Œping</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">bash-5.0# ping www.baidu.com</span><br><span class="line">PING www.baidu.com (110.242.68.3): 56 data bytes</span><br><span class="line">64 bytes from 110.242.68.3: seq=0 ttl=50 time=9.281 ms</span><br><span class="line">64 bytes from 110.242.68.3: seq=1 ttl=50 time=9.296 ms</span><br><span class="line">64 bytes from 110.242.68.3: seq=2 ttl=50 time=9.203 ms</span><br><span class="line">64 bytes from 110.242.68.3: seq=3 ttl=50 time=9.233 ms</span><br><span class="line">64 bytes from 110.242.68.3: seq=4 ttl=50 time=9.241 ms</span><br><span class="line">64 bytes from 110.242.68.3: seq=5 ttl=50 time=9.259 ms</span><br><span class="line">64 bytes from 110.242.68.3: seq=6 ttl=50 time=9.270 ms</span><br><span class="line">64 bytes from 110.242.68.3: seq=7 ttl=50 time=9.342 ms</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åŸŸåè§£ææˆåŠŸ</p><p>è¯´æ˜coredns podå·¥ä½œæ˜¯æ­£å¸¸çš„ï¼Œåº”ç”¨ç›®æ ‡podä¹Ÿæ˜¯å·¥ä½œæ­£å¸¸çš„é—®é¢˜å‡ºåœ¨kube-dnsæœåŠ¡ä¸corednsèŠ‚ç‚¹é€šä¿¡ä¸Šï¼ŒæœåŠ¡ä¸podä¹‹é—´é€šä¿¡æ˜¯é€šè¿‡kube-proxyå®ç°</p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11.2ã€äº²å’Œæ€§è°ƒåº¦ï¼ˆpodAffinityï¼‰</title>
      <link href="/2024/12/18/11.2%E3%80%81%E4%BA%B2%E5%92%8C%E6%80%A7%E8%B0%83%E5%BA%A6%EF%BC%88podAffinity%EF%BC%89/"/>
      <url>/2024/12/18/11.2%E3%80%81%E4%BA%B2%E5%92%8C%E6%80%A7%E8%B0%83%E5%BA%A6%EF%BC%88podAffinity%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="11-2ã€äº²å’Œæ€§è°ƒåº¦ï¼ˆpodAffinityï¼‰"><a href="#11-2ã€äº²å’Œæ€§è°ƒåº¦ï¼ˆpodAffinityï¼‰" class="headerlink" title="11.2ã€äº²å’Œæ€§è°ƒåº¦ï¼ˆpodAffinityï¼‰"></a>11.2ã€äº²å’Œæ€§è°ƒåº¦ï¼ˆpodAffinityï¼‰</h2><h5 id="5-4-2-äº²å’Œæ€§è°ƒåº¦"><a href="#5-4-2-äº²å’Œæ€§è°ƒåº¦" class="headerlink" title="5.4.2 äº²å’Œæ€§è°ƒåº¦"></a>5.4.2 äº²å’Œæ€§è°ƒåº¦</h5><p><strong>ä¸Šä¸€èŠ‚ï¼Œä»‹ç»äº†ä¸¤ç§å®šå‘è°ƒåº¦çš„æ–¹å¼ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€å®šçš„é—®é¢˜ï¼Œé‚£å°±æ˜¯å¦‚æœæ²¡æœ‰æ»¡è¶³æ¡ä»¶çš„Nodeï¼Œé‚£ä¹ˆPodå°†ä¸ä¼šè¢«è¿è¡Œï¼Œå³ä½¿åœ¨é›†ç¾¤ä¸­è¿˜æœ‰å¯ç”¨Nodeåˆ—è¡¨ä¹Ÿä¸è¡Œï¼Œè¿™å°±é™åˆ¶äº†å®ƒçš„ä½¿ç”¨åœºæ™¯ã€‚</strong></p><p><strong>åŸºäºä¸Šé¢çš„é—®é¢˜ï¼Œkubernetesè¿˜æä¾›äº†ä¸€ç§äº²å’Œæ€§è°ƒåº¦ï¼ˆAffinityï¼‰ã€‚å®ƒåœ¨NodeSelectorçš„åŸºç¡€ä¹‹ä¸Šçš„è¿›è¡Œäº†æ‰©å±•ï¼Œå¯ä»¥é€šè¿‡é…ç½®çš„å½¢å¼ï¼Œå®ç°ä¼˜å…ˆé€‰æ‹©æ»¡è¶³æ¡ä»¶çš„Nodeè¿›è¡Œè°ƒåº¦ï¼Œå¦‚æœæ²¡æœ‰ï¼Œä¹Ÿå¯ä»¥è°ƒåº¦åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹ä¸Šï¼Œä½¿è°ƒåº¦æ›´åŠ çµæ´»ã€‚</strong></p><p><strong>Affinityä¸»è¦åˆ†ä¸ºä¸‰ç±»ï¼š</strong></p><ul><li><strong>nodeAffinity(nodeäº²å’Œæ€§ï¼‰: ä»¥nodeä¸ºç›®æ ‡ï¼Œè§£å†³podå¯ä»¥è°ƒåº¦åˆ°å“ªäº›nodeçš„é—®é¢˜ï¼ˆå³podåå¥½node1åˆ™ä¼˜å…ˆè°ƒåº¦åˆ°node1ï¼‰</strong></li><li><strong>podAffinity(podäº²å’Œæ€§) : ä»¥podä¸ºç›®æ ‡ï¼Œè§£å†³podå¯ä»¥å’Œå“ªäº›å·²å­˜åœ¨çš„podéƒ¨ç½²åœ¨åŒä¸€ä¸ªæ‹“æ‰‘åŸŸä¸­çš„é—®é¢˜ï¼ˆå³pod1å–œæ¬¢å’Œnode2èŠ‚ç‚¹çš„pod2åœ¨ä¸€èµ·é‚£ä»–å°±å¯ä»¥å»node2ä¸Šï¼‰</strong></li><li><strong>podAntiAffinity(podåäº²å’Œæ€§) : ä»¥podä¸ºç›®æ ‡ï¼Œè§£å†³podä¸èƒ½å’Œå“ªäº›å·²å­˜åœ¨podéƒ¨ç½²åœ¨åŒä¸€ä¸ªæ‹“æ‰‘åŸŸä¸­çš„é—®é¢˜ï¼ˆå³pod2è®¨åŒå’Œnode1èŠ‚ç‚¹åœ¨ä¸€èµ·é‚£å®ƒå°±å¯ä»¥å»node2èŠ‚ç‚¹  è®¨åŒpod1é‚£ä»–å°±ä¸ä¼šåœ¨pod1æ‰€åœ¨çš„èŠ‚ç‚¹ï¼‰</strong></li></ul><p><strong>å…³äºäº²å’Œæ€§(åäº²å’Œæ€§)ä½¿ç”¨åœºæ™¯çš„è¯´æ˜ï¼š</strong></p><p>*<em>äº²å’Œæ€§</em>***ï¼šå¦‚æœä¸¤ä¸ªåº”ç”¨é¢‘ç¹äº¤äº’ï¼Œé‚£å°±æœ‰å¿…è¦åˆ©ç”¨äº²å’Œæ€§è®©ä¸¤ä¸ªåº”ç”¨çš„å°½å¯èƒ½çš„é è¿‘ï¼Œè¿™æ ·å¯ä»¥å‡å°‘å› ç½‘ç»œé€šä¿¡è€Œå¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚ **</p><p><strong>åäº²å’Œæ€§****ï¼šå½“åº”ç”¨çš„é‡‡ç”¨å¤šå‰¯æœ¬éƒ¨ç½²æ—¶ï¼Œæœ‰å¿…è¦é‡‡ç”¨åäº²å’Œæ€§è®©å„ä¸ªåº”ç”¨å®ä¾‹æ‰“æ•£åˆ†å¸ƒåœ¨å„ä¸ªnodeä¸Šï¼Œè¿™æ ·å¯ä»¥æé«˜æœåŠ¡çš„é«˜å¯ç”¨æ€§ï¼ˆå¦‚tomcaté«˜å¯ç”¨ï¼‰ã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_0f7bd9d4220e2c5ec39d8d47113d4768.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_0f7bd9d4220e2c5ec39d8d47113d4768.png"></p><h2 id="ä¸€ã€NodeAffinity-nodeäº²å’Œæ€§ï¼‰"><a href="#ä¸€ã€NodeAffinity-nodeäº²å’Œæ€§ï¼‰" class="headerlink" title="ä¸€ã€NodeAffinity (nodeäº²å’Œæ€§ï¼‰"></a>ä¸€ã€NodeAffinity (nodeäº²å’Œæ€§ï¼‰</h2><h3 id="1ã€é¦–å…ˆæ¥çœ‹ä¸€ä¸‹NodeAffinityçš„å¯é…ç½®é¡¹ï¼š"><a href="#1ã€é¦–å…ˆæ¥çœ‹ä¸€ä¸‹NodeAffinityçš„å¯é…ç½®é¡¹ï¼š" class="headerlink" title="1ã€é¦–å…ˆæ¥çœ‹ä¸€ä¸‹NodeAffinityçš„å¯é…ç½®é¡¹ï¼š"></a>1ã€é¦–å…ˆæ¥çœ‹ä¸€ä¸‹<code>NodeAffinity</code>çš„å¯é…ç½®é¡¹ï¼š</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">pod.spec.affinity.nodeAffinity</span><br><span class="line">  requiredDuringSchedulingIgnoredDuringExecution  NodeèŠ‚ç‚¹å¿…é¡»æ»¡è¶³æŒ‡å®šçš„æ‰€æœ‰è§„åˆ™æ‰å¯ä»¥ï¼Œç›¸å½“äºç¡¬é™åˆ¶</span><br><span class="line">    nodeSelectorTerms  èŠ‚ç‚¹é€‰æ‹©åˆ—è¡¨</span><br><span class="line">      matchFields   æŒ‰èŠ‚ç‚¹å­—æ®µåˆ—å‡ºçš„èŠ‚ç‚¹é€‰æ‹©å™¨è¦æ±‚åˆ—è¡¨</span><br><span class="line">      matchExpressions   æŒ‰èŠ‚ç‚¹æ ‡ç­¾åˆ—å‡ºçš„èŠ‚ç‚¹é€‰æ‹©å™¨è¦æ±‚åˆ—è¡¨(æ¨è)</span><br><span class="line">        key    é”®</span><br><span class="line">        values å€¼</span><br><span class="line">        operat <span class="keyword">or</span> å…³ç³»ç¬¦ æ”¯æŒExists, DoesNotExist, In, NotIn, Gt, Lt</span><br><span class="line">  preferredDuringSchedulingIgnoredDuringExecution ä¼˜å…ˆè°ƒåº¦åˆ°æ»¡è¶³æŒ‡å®šçš„è§„åˆ™çš„Nodeï¼Œç›¸å½“äºè½¯é™åˆ¶ (å€¾å‘)</span><br><span class="line">    preference   ä¸€ä¸ªèŠ‚ç‚¹é€‰æ‹©å™¨é¡¹ï¼Œä¸ç›¸åº”çš„æƒé‡ç›¸å…³è”</span><br><span class="line">      matchFields   æŒ‰èŠ‚ç‚¹å­—æ®µåˆ—å‡ºçš„èŠ‚ç‚¹é€‰æ‹©å™¨è¦æ±‚åˆ—è¡¨</span><br><span class="line">      matchExpressions   æŒ‰èŠ‚ç‚¹æ ‡ç­¾åˆ—å‡ºçš„èŠ‚ç‚¹é€‰æ‹©å™¨è¦æ±‚åˆ—è¡¨(æ¨è)</span><br><span class="line">        key    é”®</span><br><span class="line">        values å€¼</span><br><span class="line">        <span class="keyword">operator</span> å…³ç³»ç¬¦ æ”¯æŒIn, NotIn, Exists, DoesNotExist, Gt, Lt</span><br><span class="line">weight å€¾å‘æƒé‡ï¼Œåœ¨èŒƒå›´<span class="number">1</span><span class="number">-100</span>ã€‚</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">å…³ç³»ç¬¦çš„ä½¿ç”¨è¯´æ˜:</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">matchExpressions:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">nodeenv</span>              <span class="comment"># åŒ¹é…å­˜åœ¨æ ‡ç­¾ï¼ˆlabelï¼‰çš„keyä¸ºnodeenvçš„èŠ‚ç‚¹</span></span><br><span class="line">    <span class="attr">operator:</span> <span class="string">Exists</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">nodeenv</span>              <span class="comment"># åŒ¹é…æ ‡ç­¾çš„keyä¸ºnodeenv,ä¸”valueæ˜¯&quot;xxx&quot;æˆ–&quot;yyy&quot;çš„èŠ‚ç‚¹</span></span><br><span class="line">    <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">    <span class="attr">values:</span> [<span class="string">&quot;xxx&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br><span class="line">  <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">nodeenv</span>              <span class="comment"># åŒ¹é…æ ‡ç­¾çš„keyä¸ºnodeenv,ä¸”valueå¤§äº&quot;xxx&quot;çš„èŠ‚ç‚¹</span></span><br><span class="line">    <span class="attr">operator:</span> <span class="string">Gt</span></span><br><span class="line">    <span class="attr">values:</span> <span class="string">&quot;xxx&quot;</span></span><br></pre></td></tr></table></figure><h3 id="2ã€requiredDuringSchedulingIgnoredDuringExecutionç¡¬é™åˆ¶"><a href="#2ã€requiredDuringSchedulingIgnoredDuringExecutionç¡¬é™åˆ¶" class="headerlink" title="2ã€requiredDuringSchedulingIgnoredDuringExecutionç¡¬é™åˆ¶"></a>2ã€<code>requiredDuringSchedulingIgnoredDuringExecution</code>ç¡¬é™åˆ¶</h3><p><strong>å¿…é¡»è°ƒåº¦åˆ°å«æ ‡ç­¾çš„nodeä¸Šå¦åˆ™æŠ¥é”™</strong></p><p><strong>æ¥ä¸‹æ¥é¦–å…ˆæ¼”ç¤ºä¸€ä¸‹</strong><code>&lt;span class=&quot;ne-text&quot;&gt;requiredDuringSchedulingIgnoredDuringExecution&lt;/span&gt;</code> ï¼ˆç¡¬é™åˆ¶ï¼‰,</p><p><strong>åˆ›å»ºpod-nodeaffinity-required.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-nodeaffinity-required</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> <span class="comment"># nginx:1.17.1</span></span><br><span class="line">  <span class="attr">affinity:</span>       <span class="comment"># äº²å’Œæ€§è®¾ç½®</span></span><br><span class="line">    <span class="attr">nodeAffinity:</span> <span class="comment"># è®¾ç½®nodeäº²å’Œæ€§</span></span><br><span class="line">      <span class="attr">requiredDuringSchedulingIgnoredDuringExecution:</span> <span class="comment"># ç¡¬é™åˆ¶å¿…é¡»æ»¡è¶³å¦‚ä¸‹æ¡ä»¶æ‰èƒ½è°ƒåº¦</span></span><br><span class="line">        <span class="attr">nodeSelectorTerms:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">matchExpressions:</span>       <span class="comment"># åŒ¹é…envçš„å€¼åœ¨[&quot;xxx&quot;,&quot;yyy&quot;]ä¸­çš„æ ‡ç­¾</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">nodeenv</span>          <span class="comment"># å®šä¹‰æ ‡ç­¾nodeenvçš„å€¼å¿…é¡»ä¸ºxxxæˆ–yyy    </span></span><br><span class="line">            <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">            <span class="attr">values:</span> [<span class="string">&quot;xxx&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹å½“å‰èŠ‚ç‚¹ä¸‹æœ‰æ²¡æœ‰è¿™æ ·çš„æ ‡ç­¾ï¼ˆlabelï¼‰å¯ä»¥çœ‹åˆ°å½“å‰çš„nodeèŠ‚ç‚¹éƒ½æ— æ³•æ»¡è¶³</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰‹åŠ¨ç»™èŠ‚ç‚¹æ‰“ä¸Šæ ‡ç­¾</span></span><br><span class="line">kubectl label nodes k8s nodeenv=pro</span><br><span class="line">kubectl label nodes k8s1 nodeenv=<span class="built_in">test</span></span><br><span class="line"><span class="comment"># æŸ¥çœ‹èŠ‚ç‚¹æ ‡ç­¾</span></span><br><span class="line">kubectl get nodes --show-labels</span><br><span class="line"><span class="comment"># åˆ›å»ºpod</span></span><br><span class="line">kubectl create -f pod-nodeaffinity-required.yaml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹podçŠ¶æ€ ï¼ˆè¿è¡Œå¤±è´¥ï¼‰</span></span><br><span class="line">kubectl get pods pod-nodeaffinity-required -n dev -o wide</span><br><span class="line"><span class="comment"># æŸ¥çœ‹Podçš„è¯¦æƒ…</span></span><br><span class="line"><span class="comment"># å‘ç°è°ƒåº¦å¤±è´¥ï¼Œæç¤ºnodeé€‰æ‹©å¤±è´¥</span></span><br><span class="line">kubectl describe pod pod-nodeaffinity-required -n dev</span><br><span class="line"><span class="comment"># æ¥ä¸‹æ¥ï¼Œåœæ­¢pod</span></span><br><span class="line">kubectl delete -f pod-nodeaffinity-required.yaml</span><br><span class="line"><span class="comment"># ä¿®æ”¹æ–‡ä»¶ï¼Œå°†values: [&quot;xxx&quot;,&quot;yyy&quot;]------&gt; [&quot;pro&quot;,&quot;yyy&quot;]</span></span><br><span class="line">vim pod-nodeaffinity-required.yaml</span><br><span class="line"><span class="comment"># ä¿®æ”¹å¦‚ä¸‹éƒ¨åˆ†...</span></span><br><span class="line">  affinity:       <span class="comment"># äº²å’Œæ€§è®¾ç½®</span></span><br><span class="line">    nodeAffinity: <span class="comment"># è®¾ç½®nodeäº²å’Œæ€§</span></span><br><span class="line">      requiredDuringSchedulingIgnoredDuringExecution: <span class="comment"># ç¡¬é™åˆ¶å¿…é¡»æ»¡è¶³å¦‚ä¸‹æ¡ä»¶æ‰èƒ½è°ƒåº¦</span></span><br><span class="line">        nodeSelectorTerms:</span><br><span class="line">        - matchExpressions:       <span class="comment"># åŒ¹é…envçš„å€¼åœ¨[&quot;xxx&quot;,&quot;pro&quot;]ä¸­çš„æ ‡ç­¾</span></span><br><span class="line">          - key: nodeenv          <span class="comment"># å®šä¹‰æ ‡ç­¾nodeenvçš„å€¼å¿…é¡»ä¸ºxxxæˆ–yyy    </span></span><br><span class="line">            operator: In</span><br><span class="line">            values: [<span class="string">&quot;pro&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†æ¬¡å¯åŠ¨</span></span><br><span class="line">kubectl create -f pod-nodeaffinity-required.yaml</span><br><span class="line"><span class="comment"># æ­¤æ—¶æŸ¥çœ‹ï¼Œå‘ç°è°ƒåº¦æˆåŠŸï¼Œå·²ç»å°†podè°ƒåº¦åˆ°äº†node1ä¸Š</span></span><br><span class="line">kubectl get pods pod-nodeaffinity-required -n dev -o wide</span><br><span class="line"></span><br><span class="line">NAME                        READY   STATUS    RESTARTS   AGE   IP              NODE   NOMINATED NODE   READINESS GATES</span><br><span class="line">pod-nodeaffinity-required   1/1     Running   0          95s   192.168.77.14   k8s    &lt;none&gt;           &lt;none&gt;</span><br></pre></td></tr></table></figure><p><strong>æ ‡ç­¾</strong></p><p><strong>è°ƒåº¦å¤±è´¥ï¼ˆpendingï¼‰</strong></p><p><strong>æ•ˆæœ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_591290abc700dccc1f988add80419da9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_591290abc700dccc1f988add80419da9.png"></p><h3 id="3ã€requiredDuringSchedulingIgnoredDuringExecution-ï¼ˆè½¯é™åˆ¶ï¼‰"><a href="#3ã€requiredDuringSchedulingIgnoredDuringExecution-ï¼ˆè½¯é™åˆ¶ï¼‰" class="headerlink" title="3ã€requiredDuringSchedulingIgnoredDuringExecution ï¼ˆè½¯é™åˆ¶ï¼‰"></a>3ã€requiredDuringSchedulingIgnoredDuringExecution ï¼ˆè½¯é™åˆ¶ï¼‰</h3><p><strong>ä¼˜å…ˆè°ƒåº¦åˆ°æƒé‡é«˜ä¸”ç¬¦åˆæ ‡ç­¾çš„nodeä¸Šé¢</strong></p><p><strong>æ¥ä¸‹æ¥å†æ¼”ç¤ºä¸€ä¸‹</strong><code>&lt;span class=&quot;ne-text&quot;&gt;requiredDuringSchedulingIgnoredDuringExecution&lt;/span&gt;</code> ,ï¼ˆè½¯é™åˆ¶-å³ä¼˜å…ˆè°ƒåº¦åˆ°æ»¡è¶³æ¡ä»¶çš„ä¸Šé¢ï¼‰</p><p><strong>åˆ›å»º pod-nodeaffinity-preferred.yaml</strong></p><ul><li><strong>æƒé‡weightçš„æ„æ€æ˜¯è®¾ç½®æƒé‡ä¼˜å…ˆè°ƒåº¦åˆ°æ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹ä¸Šå»ã€å¦‚æœæ²¡æœ‰æ»¡è¶³çš„åˆ™éšä¾¿è°ƒåº¦åœ¨é‚£ä¸ªèŠ‚ç‚¹</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-nodeaffinity-preferred</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> <span class="comment"># nginx:1.17.1</span></span><br><span class="line">  <span class="attr">affinity:</span>       <span class="comment"># äº²å’Œæ€§è®¾ç½®</span></span><br><span class="line">    <span class="attr">nodeAffinity:</span> <span class="comment"># è®¾ç½®nodeäº²å’Œæ€§</span></span><br><span class="line">      <span class="attr">preferredDuringSchedulingIgnoredDuringExecution:</span> <span class="comment"># è½¯é™åˆ¶</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">weight:</span> <span class="number">1</span></span><br><span class="line">        <span class="attr">preference:</span></span><br><span class="line">          <span class="attr">matchExpressions:</span> <span class="comment"># åŒ¹é…envçš„å€¼åœ¨[&quot;xxx&quot;,&quot;yyy&quot;]ä¸­çš„æ ‡ç­¾(å½“å‰ç¯å¢ƒæ²¡æœ‰)</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">nodeenv</span></span><br><span class="line">            <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">            <span class="attr">values:</span> [<span class="string">&quot;xxx&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºpod</span></span><br><span class="line">kubectl create -f pod-nodeaffinity-preferred.yaml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹podçŠ¶æ€ ï¼ˆè¿è¡ŒæˆåŠŸï¼‰</span></span><br><span class="line">kubectl get pod pod-nodeaffinity-preferred -n dev -o wide</span><br><span class="line"></span><br><span class="line">NAME                         READY   STATUS    RESTARTS   AGE   IP                NODE   NOMINATED NODE   READINESS GATES</span><br><span class="line">pod-nodeaffinity-preferred   1/1     Running   0          54s   192.168.166.208   k8s1   &lt;none&gt;           &lt;none&gt;</span><br></pre></td></tr></table></figure><p><strong>NodeAffinityè§„åˆ™è®¾ç½®çš„æ³¨æ„äº‹é¡¹ï¼š</strong></p><ul><li><strong>å¦‚æœåŒæ—¶å®šä¹‰äº†nodeSelectorå’ŒnodeAffinityï¼Œé‚£ä¹ˆ</strong>å¿…é¡»ä¸¤ä¸ªæ¡ä»¶éƒ½å¾—åˆ°æ»¡è¶³<strong>ï¼ŒPodæ‰èƒ½è¿è¡Œåœ¨æŒ‡å®šçš„Nodeä¸Š</strong></li><li><strong>å¦‚æœnodeAffinityæŒ‡å®šäº†å¤šä¸ªnodeSelectorTermsï¼Œé‚£ä¹ˆåªéœ€è¦å…¶ä¸­ä¸€ä¸ªèƒ½å¤ŸåŒ¹é…æˆåŠŸå³å¯</strong></li><li><strong>å¦‚æœä¸€ä¸ªnodeSelectorTermsä¸­æœ‰å¤šä¸ªmatchExpressionså³æœ‰å¤šä¸ªkeyå€¼ ï¼Œåˆ™ä¸€ä¸ªèŠ‚ç‚¹å¿…é¡»æ»¡è¶³æ‰€æœ‰çš„æ‰èƒ½åŒ¹é…æˆåŠŸ</strong></li><li><strong>å¦‚æœä¸€ä¸ªpodæ‰€åœ¨çš„Nodeåœ¨Podè¿è¡ŒæœŸé—´å…¶æ ‡ç­¾å‘ç”Ÿäº†æ”¹å˜ï¼Œä¸å†ç¬¦åˆè¯¥Podçš„èŠ‚ç‚¹äº²å’Œæ€§éœ€æ±‚ï¼Œåˆ™ç³»ç»Ÿå°†å¿½ç•¥æ­¤å˜åŒ–</strong></li></ul><h3 id="4ã€PodAffinityï¼ˆæ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podåœ¨ä¸€ä¸ªåŒºåŸŸï¼‰"><a href="#4ã€PodAffinityï¼ˆæ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podåœ¨ä¸€ä¸ªåŒºåŸŸï¼‰" class="headerlink" title="4ã€PodAffinityï¼ˆæ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podåœ¨ä¸€ä¸ªåŒºåŸŸï¼‰"></a>4ã€PodAffinityï¼ˆ<strong>æ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podåœ¨ä¸€ä¸ªåŒºåŸŸ</strong>ï¼‰</h3><ul><li><strong>PodAffinityä¸»è¦å®ç°ä»¥è¿è¡Œçš„Podä¸ºå‚ç…§ï¼Œå®ç°è®©æ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podåœ¨ä¸€ä¸ªåŒºåŸŸçš„åŠŸèƒ½ã€‚</strong></li></ul><p><strong>é¦–å…ˆæ¥çœ‹ä¸€ä¸‹</strong><code>&lt;span class=&quot;ne-text&quot;&gt;PodAffinity&lt;/span&gt;</code>çš„å¯é…ç½®é¡¹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">pod.spec.affinity.podAffinity</span><br><span class="line">  requiredDuringSchedulingIgnoredDuringExecution  ç¡¬é™åˆ¶</span><br><span class="line">    namespaces       æŒ‡å®šå‚ç…§podçš„<span class="keyword">namespace</span></span><br><span class="line">    topologyKey      æŒ‡å®šè°ƒåº¦ä½œç”¨åŸŸ</span><br><span class="line">    labelSelector    æ ‡ç­¾é€‰æ‹©å™¨</span><br><span class="line">      matchExpressions  æŒ‰èŠ‚ç‚¹æ ‡ç­¾åˆ—å‡ºçš„èŠ‚ç‚¹é€‰æ‹©å™¨è¦æ±‚åˆ—è¡¨(æ¨è)</span><br><span class="line">        key    é”®</span><br><span class="line">        values å€¼</span><br><span class="line">        <span class="keyword">operator</span>     å…³ç³»ç¬¦ æ”¯æŒIn, NotIn, Exists, DoesNotExist.</span><br><span class="line">      matchLabels    æŒ‡å¤šä¸ªmatchExpressionsæ˜ å°„çš„å†…å®¹</span><br><span class="line">  preferredDuringSchedulingIgnoredDuringExecution è½¯é™åˆ¶</span><br><span class="line">    podAffinityTerm  é€‰é¡¹</span><br><span class="line">      namespaces  </span><br><span class="line">      topologyKey</span><br><span class="line">      labelSelector</span><br><span class="line">        matchExpressions  </span><br><span class="line">          key    é”®</span><br><span class="line">          values å€¼</span><br><span class="line">          <span class="keyword">operator</span></span><br><span class="line">        matchLabels </span><br><span class="line">    weight å€¾å‘æƒé‡ï¼Œåœ¨èŒƒå›´<span class="number">1</span><span class="number">-100</span></span><br></pre></td></tr></table></figure><p><strong>topologyKeyç”¨äºæŒ‡å®šè°ƒåº¦æ—¶ä½œç”¨åŸŸ,ä¾‹å¦‚:</strong></p><ul><li><strong>å¦‚æœæŒ‡å®šä¸º <strong>kubernetes.io/hostname</strong>ï¼Œé‚£å°±æ˜¯ä»¥NodeèŠ‚ç‚¹ä¸ºåŒºåˆ†èŒƒå›´</strong></li><li>**å¦‚æœæŒ‡å®šä¸º **beta.kubernetes.io/os <strong>,åˆ™ä»¥NodeèŠ‚ç‚¹çš„æ“ä½œç³»ç»Ÿç±»å‹æ¥åŒºåˆ†</strong></li></ul><h4 id="4-1ã€æ¥ä¸‹æ¥ï¼Œæ¼”ç¤ºä¸‹requiredDuringSchedulingIgnoredDuringExecution"><a href="#4-1ã€æ¥ä¸‹æ¥ï¼Œæ¼”ç¤ºä¸‹requiredDuringSchedulingIgnoredDuringExecution" class="headerlink" title="4.1ã€æ¥ä¸‹æ¥ï¼Œæ¼”ç¤ºä¸‹requiredDuringSchedulingIgnoredDuringExecution,"></a>4.1ã€æ¥ä¸‹æ¥ï¼Œæ¼”ç¤ºä¸‹<code>requiredDuringSchedulingIgnoredDuringExecution</code>,</h4><p><strong>1ï¼‰é¦–å…ˆåˆ›å»ºä¸€ä¸ªå‚ç…§Podï¼Œpod-podaffinity-target.yamlï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-podaffinity-target</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">podenv:</span> <span class="string">pro</span> <span class="comment">#è®¾ç½®æ ‡ç­¾</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> <span class="comment">#nginx:1.17.1</span></span><br><span class="line">  <span class="attr">nodeName:</span> <span class="string">k8s1</span> <span class="comment"># node1 å°†ç›®æ ‡podåç¡®æŒ‡å®šåˆ°node1ä¸Š</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ç›®æ ‡pod</span></span><br><span class="line">kubectl create -f pod-podaffinity-target.yaml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹podçŠ¶å†µ</span></span><br><span class="line">kubectl get pods  pod-podaffinity-target -n dev</span><br><span class="line"></span><br><span class="line">NAME                     READY   STATUS    RESTARTS   AGE</span><br><span class="line">pod-podaffinity-target   1/1     Running   0          2m59s</span><br></pre></td></tr></table></figure><h4 id="4-2ã€åˆ›å»ºpod-podaffinity-required-yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š"><a href="#4-2ã€åˆ›å»ºpod-podaffinity-required-yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š" class="headerlink" title="4.2ã€åˆ›å»ºpod-podaffinity-required.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š"></a>4.2ã€åˆ›å»ºpod-podaffinity-required.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-podaffinity-required</span>  <span class="comment"># podåç§°</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> <span class="comment">#nginx:1.17.1</span></span><br><span class="line">  <span class="attr">affinity:</span>      <span class="comment"># äº²å’Œæ€§è®¾ç½®</span></span><br><span class="line">    <span class="attr">podAffinity:</span> <span class="comment"># è®¾ç½®podäº²å’Œæ€§</span></span><br><span class="line">      <span class="attr">requiredDuringSchedulingIgnoredDuringExecution:</span> <span class="comment"># ç¡¬é™åˆ¶</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">labelSelector:</span></span><br><span class="line">          <span class="attr">matchExpressions:</span>    <span class="comment"># åŒ¹é…envçš„å€¼åœ¨[&quot;xxx&quot;,&quot;yyy&quot;]ä¸­çš„æ ‡ç­¾</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">podenv</span></span><br><span class="line">            <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">            <span class="attr">values:</span> [<span class="string">&quot;xxx&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br><span class="line">        <span class="attr">topologyKey:</span> <span class="string">kubernetes.io/hostname</span></span><br></pre></td></tr></table></figure><p><strong>ä¸Šé¢é…ç½®è¡¨è¾¾çš„æ„æ€æ˜¯ï¼š</strong></p><ul><li><p><strong>æ–°Podå¿…é¡»è¦ä¸æ‹¥æœ‰æ ‡ç­¾nodeenv=xxxæˆ–è€…nodeenv=yyyçš„podåœ¨åŒä¸€Nodeä¸Š</strong>ï¼ŒæŸ¥çœ‹èŠ‚ç‚¹æ˜¯å¦æœ‰ç°è¿™æ ·çš„podæ˜¾ç„¶æ²¡æœ‰ï¼Œæ¥ä¸‹æ¥ï¼Œè¿è¡Œæµ‹è¯•ä¸€ä¸‹ã€‚</p></li><li><p><strong>topologyKey: kubernetes.io/hostname æŒ‡å®šäº†ç”¨äºäº²å’Œæ€§åŒ¹é…çš„æ‹“æ‰‘é”®ã€‚è¿™è¡¨ç¤º Pod ä¼šè¢«è°ƒåº¦åˆ°ä¸å…¶å®¿ä¸»èŠ‚ç‚¹å…·æœ‰ç›¸åŒä¸»æœºåçš„èŠ‚ç‚¹ä¸Šã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_9ef6cc967fa4c5448054dc6a458f614f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_9ef6cc967fa4c5448054dc6a458f614f.png"></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨pod</span></span><br><span class="line">kubectl create -f pod-podaffinity-required.yaml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹podçŠ¶æ€ï¼Œå‘ç°æœªè¿è¡Œ</span></span><br><span class="line">kubectl get pods pod-podaffinity-required -n dev</span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">kubectl describe pods pod-podaffinity-required  -n dev</span><br><span class="line"><span class="comment"># æ¥ä¸‹æ¥ä¿®æ”¹  values: [&quot;xxx&quot;,&quot;yyy&quot;]-----&gt;values:[&quot;pro&quot;,&quot;yyy&quot;]</span></span><br><span class="line"><span class="comment"># æ„æ€æ˜¯ï¼šæ–°Podå¿…é¡»è¦ä¸æ‹¥æœ‰æ ‡ç­¾nodeenv=xxxæˆ–è€…nodeenv=yyyçš„podåœ¨åŒä¸€Nodeä¸Š</span></span><br><span class="line">vim pod-podaffinity-required.yaml</span><br><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®</span></span><br><span class="line">...</span><br><span class="line">  affinity:  <span class="comment">#äº²å’Œæ€§è®¾ç½®</span></span><br><span class="line">    podAffinity: <span class="comment">#è®¾ç½®podäº²å’Œæ€§</span></span><br><span class="line">      requiredDuringSchedulingIgnoredDuringExecution: <span class="comment"># ç¡¬é™åˆ¶</span></span><br><span class="line">      - labelSelector:</span><br><span class="line">          matchExpressions: <span class="comment"># åŒ¹é…envçš„å€¼åœ¨[&quot;xxx&quot;,&quot;yyy&quot;]ä¸­çš„æ ‡ç­¾</span></span><br><span class="line">          - key: podenv</span><br><span class="line">            operator: In</span><br><span class="line">            values: [<span class="string">&quot;pro&quot;</span>,<span class="string">&quot;yyy&quot;</span>]</span><br><span class="line">        topologyKey: kubernetes.io/hostname</span><br><span class="line">...</span><br><span class="line"><span class="comment"># ç„¶åé‡æ–°åˆ›å»ºpodï¼ŒæŸ¥çœ‹æ•ˆæœ</span></span><br><span class="line">kubectl delete -f  pod-podaffinity-required.yaml</span><br><span class="line"></span><br><span class="line">kubectl create -f pod-podaffinity-required.yaml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‘ç°æ­¤æ—¶Podè¿è¡Œæ­£å¸¸</span></span><br><span class="line">kubectl get pods pod-podaffinity-required -n dev</span><br></pre></td></tr></table></figure><p><strong>å¯ä»¥çœ‹åˆ°å’Œå‚ç…§çš„podåœ¨ä¸€èµ·</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_bcaccda2eda73fbce6bb2e44712bbfe9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_bcaccda2eda73fbce6bb2e44712bbfe9.png"></p><p><strong>å…³äº</strong><code>PodAffinity</code>çš„ <code>preferredDuringSchedulingIgnoredDuringExecution</code>ï¼Œè¿™é‡Œä¸å†æ¼”ç¤ºã€‚</p><h4 id="4-3ã€PodAntiAffinityï¼ˆæ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podä¸åœ¨ä¸€ä¸ªåŒºåŸŸï¼‰"><a href="#4-3ã€PodAntiAffinityï¼ˆæ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podä¸åœ¨ä¸€ä¸ªåŒºåŸŸï¼‰" class="headerlink" title="4.3ã€PodAntiAffinityï¼ˆæ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podä¸åœ¨ä¸€ä¸ªåŒºåŸŸï¼‰"></a>4.3ã€PodAntiAffinityï¼ˆæ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podä¸åœ¨ä¸€ä¸ªåŒºåŸŸï¼‰</h4><p><strong>PodAntiAffinityä¸»è¦å®ç°ä»¥è¿è¡Œçš„Podä¸ºå‚ç…§ï¼Œè®©æ–°åˆ›å»ºçš„Podè·Ÿå‚ç…§podä¸åœ¨ä¸€ä¸ªåŒºåŸŸä¸­çš„åŠŸèƒ½ã€‚</strong></p><p><strong>å®ƒçš„é…ç½®æ–¹å¼å’Œé€‰é¡¹è·ŸPodAffintyæ˜¯ä¸€æ ·çš„ï¼Œè¿™é‡Œä¸å†åšè¯¦ç»†è§£é‡Šï¼Œç›´æ¥åšä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ã€‚</strong></p><h5 id="4-3-1ã€ç»§ç»­ä½¿ç”¨ä¸Šä¸ªæ¡ˆä¾‹ä¸­ç›®æ ‡pod"><a href="#4-3-1ã€ç»§ç»­ä½¿ç”¨ä¸Šä¸ªæ¡ˆä¾‹ä¸­ç›®æ ‡pod" class="headerlink" title="4.3.1ã€ç»§ç»­ä½¿ç”¨ä¸Šä¸ªæ¡ˆä¾‹ä¸­ç›®æ ‡pod"></a>4.3.1ã€ç»§ç»­ä½¿ç”¨ä¸Šä¸ªæ¡ˆä¾‹ä¸­ç›®æ ‡pod</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods -n dev -o wide --show-labels</span><br><span class="line"></span><br><span class="line">NAME                       READY   STATUS    RESTARTS   AGE     IP            NODE   NOMINATED NODE   READINESS GATES   LABELS</span><br><span class="line">pod-podaffinity-required   1/1     Running   0          5m53s   172.16.0.54   k8s1   &lt;none&gt;           &lt;none&gt;            &lt;none&gt;</span><br><span class="line">pod-podaffinity-target     1/1     Running   0          21m     172.16.0.53   k8s1   &lt;none&gt;           &lt;none&gt;            podenv=pro</span><br></pre></td></tr></table></figure><h5 id="4-3-2ã€åˆ›å»ºpod-podantiaffinity-required-yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š"><a href="#4-3-2ã€åˆ›å»ºpod-podantiaffinity-required-yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š" class="headerlink" title="4.3.2ã€åˆ›å»ºpod-podantiaffinity-required.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š"></a>4.3.2ã€åˆ›å»ºpod-podantiaffinity-required.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-podantiaffinity-required</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> <span class="comment"># nginx:1.17.1</span></span><br><span class="line">  <span class="attr">affinity:</span>          <span class="comment"># äº²å’Œæ€§è®¾ç½®</span></span><br><span class="line">    <span class="attr">podAntiAffinity:</span> <span class="comment"># è®¾ç½®podäº²å’Œæ€§</span></span><br><span class="line">      <span class="attr">requiredDuringSchedulingIgnoredDuringExecution:</span> <span class="comment"># ç¡¬é™åˆ¶</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">labelSelector:</span></span><br><span class="line">          <span class="attr">matchExpressions:</span>                           <span class="comment"># åŒ¹é…podenvçš„å€¼åœ¨[&quot;pro&quot;]ä¸­çš„æ ‡ç­¾</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">podenv</span></span><br><span class="line">            <span class="attr">operator:</span> <span class="string">In</span></span><br><span class="line">            <span class="attr">values:</span> [<span class="string">&quot;pro&quot;</span>]</span><br><span class="line">        <span class="attr">topologyKey:</span> <span class="string">kubernetes.io/hostname</span></span><br></pre></td></tr></table></figure><p><strong>ä¸Šé¢é…ç½®è¡¨è¾¾çš„æ„æ€æ˜¯ï¼šæ–°Podå¿…é¡»è¦ä¸æ‹¥æœ‰æ ‡ç­¾nodeenv=proçš„podä¸åœ¨åŒä¸€Nodeä¸Šï¼Œè¿è¡Œæµ‹è¯•ä¸€ä¸‹ã€‚</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºpod</span></span><br><span class="line">kubectl create -f pod-podantiaffinity-required.yaml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹pod</span></span><br><span class="line"><span class="comment"># å‘ç°è°ƒåº¦åˆ°äº†node2ä¸Š</span></span><br><span class="line">kubectl get pods pod-podantiaffinity-required -n dev -o wide</span><br><span class="line">....</span><br><span class="line">NAME                           READY   STATUS    RESTARTS   AGE   IP            NODE   .. </span><br><span class="line">pod-podantiaffinity-required   1/1     Running   0          30s   10.244.1.96   node2  ..</span><br></pre></td></tr></table></figure><p><strong>å¦‚æœéƒ½æœ‰proæ ‡ç­¾æ—¶åˆ™ä¼šæŠ¥é”™å¦‚ä¸‹ï¼š</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_28aa58a6ca5b11dfe0c95c5d57d2274b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_28aa58a6ca5b11dfe0c95c5d57d2274b.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11.1ã€å®šå‘è°ƒåº¦ï¼ˆNodeNameï¼‰</title>
      <link href="/2024/12/17/11.1%E3%80%81%E5%AE%9A%E5%90%91%E8%B0%83%E5%BA%A6%EF%BC%88NodeName%EF%BC%89/"/>
      <url>/2024/12/17/11.1%E3%80%81%E5%AE%9A%E5%90%91%E8%B0%83%E5%BA%A6%EF%BC%88NodeName%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="11-1ã€å®šå‘è°ƒåº¦ï¼ˆNodeNameï¼‰"><a href="#11-1ã€å®šå‘è°ƒåº¦ï¼ˆNodeNameï¼‰" class="headerlink" title="11.1ã€å®šå‘è°ƒåº¦ï¼ˆNodeNameï¼‰"></a>11.1ã€å®šå‘è°ƒåº¦ï¼ˆNodeNameï¼‰</h2><h5 id="5-4-1-å®šå‘è°ƒåº¦"><a href="#5-4-1-å®šå‘è°ƒåº¦" class="headerlink" title="5.4.1 å®šå‘è°ƒåº¦"></a>5.4.1 å®šå‘è°ƒåº¦</h5><p><strong>å®šå‘è°ƒåº¦ï¼ŒæŒ‡çš„æ˜¯åˆ©ç”¨åœ¨podä¸Šå£°æ˜nodeNameæˆ–è€…nodeSelectorï¼Œä»¥æ­¤å°†Podè°ƒåº¦åˆ°æœŸæœ›çš„nodeèŠ‚ç‚¹ä¸Šã€‚æ³¨æ„ï¼Œè¿™é‡Œçš„è°ƒåº¦æ˜¯å¼ºåˆ¶çš„ï¼Œè¿™å°±æ„å‘³ç€å³ä½¿è¦è°ƒåº¦çš„ç›®æ ‡Nodeä¸å­˜åœ¨ï¼Œä¹Ÿä¼šå‘ä¸Šé¢è¿›è¡Œè°ƒåº¦ï¼Œåªä¸è¿‡podè¿è¡Œå¤±è´¥è€Œå·²ã€‚</strong></p><h2 id="ä¸€ã€å®šå‘è°ƒåº¦"><a href="#ä¸€ã€å®šå‘è°ƒåº¦" class="headerlink" title="ä¸€ã€å®šå‘è°ƒåº¦"></a>ä¸€ã€å®šå‘è°ƒåº¦</h2><h3 id="1ã€NodeName"><a href="#1ã€NodeName" class="headerlink" title="1ã€NodeName"></a>1ã€NodeName</h3><p><strong>NodeNameç”¨äºå¼ºåˆ¶çº¦æŸå°†Podè°ƒåº¦åˆ°æŒ‡å®šçš„Nameçš„NodeèŠ‚ç‚¹ä¸Šã€‚è¿™ç§æ–¹å¼ï¼Œå…¶å®æ˜¯ç›´æ¥è·³è¿‡Schedulerçš„è°ƒåº¦é€»è¾‘ï¼Œç›´æ¥å°†Podè°ƒåº¦åˆ°æŒ‡å®šåç§°çš„èŠ‚ç‚¹ã€‚</strong></p><p><strong>æ¥ä¸‹æ¥ï¼Œå®éªŒä¸€ä¸‹ï¼šåˆ›å»ºä¸€ä¸ªpod-nodename.yamlæ–‡ä»¶</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-nodename</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span>  <span class="comment"># nginx:1.17.1</span></span><br><span class="line">  <span class="attr">nodeName:</span> <span class="string">node1</span>       <span class="comment"># æŒ‡å®šè°ƒåº¦åˆ°node1èŠ‚ç‚¹ä¸Š</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">kubectl create -f pod-nodename.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Podè°ƒåº¦åˆ°NODEå±æ€§ï¼Œç¡®å®æ˜¯è°ƒåº¦åˆ°äº†node1èŠ‚ç‚¹ä¸Š</span></span><br><span class="line">kubectl get pods pod-nodename -n dev -o wide</span><br><span class="line"></span><br><span class="line">NAME           READY   STATUS    RESTARTS   AGE   IP            NODE      ......</span><br><span class="line">pod-nodename   1/1     Running   0          56s   10.244.1.87   node1     ......   </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¥ä¸‹æ¥ï¼Œåˆ é™¤podï¼Œä¿®æ”¹nodeNameçš„å€¼ä¸ºnode3ï¼ˆå¹¶æ²¡æœ‰node3èŠ‚ç‚¹ï¼‰</span></span><br><span class="line">kubectl delete -f pod-nodename.yaml</span><br><span class="line">vim pod-nodename.yaml </span><br><span class="line">// nodeName: node3</span><br><span class="line"></span><br><span class="line">kubectl create -f pod-nodename.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†æ¬¡æŸ¥çœ‹ï¼Œå‘ç°å·²ç»å‘Node3èŠ‚ç‚¹è°ƒåº¦ï¼Œä½†æ˜¯ç”±äºä¸å­˜åœ¨node3èŠ‚ç‚¹ï¼Œæ‰€ä»¥podæ— æ³•æ­£å¸¸è¿è¡Œ</span></span><br><span class="line">kubectl get pods pod-nodename -n dev -o wide</span><br><span class="line"></span><br><span class="line">NAME           READY   STATUS    RESTARTS   AGE   IP       NODE    ......</span><br><span class="line">pod-nodename   0/1     Pending   0          6s    &lt;none&gt;   node3   ......</span><br></pre></td></tr></table></figure><h3 id="2ã€NodeSelector"><a href="#2ã€NodeSelector" class="headerlink" title="2ã€NodeSelector"></a>2ã€NodeSelector</h3><p><strong>NodeSelectorç”¨äºå°†podè°ƒåº¦åˆ°æ·»åŠ äº†æŒ‡å®šæ ‡ç­¾çš„nodeèŠ‚ç‚¹ä¸Šã€‚å®ƒæ˜¯é€šè¿‡kubernetesçš„label-selectoræœºåˆ¶å®ç°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨podåˆ›å»ºä¹‹å‰ï¼Œä¼šç”±schedulerä½¿ç”¨MatchNodeSelectorè°ƒåº¦ç­–ç•¥è¿›è¡ŒlabelåŒ¹é…ï¼Œæ‰¾å‡ºç›®æ ‡nodeï¼Œç„¶åå°†podè°ƒåº¦åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œè¯¥åŒ¹é…è§„åˆ™æ˜¯å¼ºåˆ¶çº¦æŸã€‚</strong></p><p><strong>æ¥ä¸‹æ¥ï¼Œå®éªŒä¸€ä¸‹ï¼š</strong></p><p><strong>1 é¦–å…ˆåˆ†åˆ«ä¸ºnodeèŠ‚ç‚¹æ·»åŠ æ ‡ç­¾</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl label nodes node1 nodeenv=pro</span><br><span class="line">kubectl label nodes node2 nodeenv=<span class="built_in">test</span></span><br></pre></td></tr></table></figure><p><strong>2 åˆ›å»ºä¸€ä¸ªpod-nodeselector.yamlæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨å®ƒåˆ›å»ºPod</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-nodeselector</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.17.1</span></span><br><span class="line">  <span class="attr">nodeSelector:</span> </span><br><span class="line">    <span class="attr">nodeenv:</span> <span class="string">pro</span> <span class="comment"># æŒ‡å®šè°ƒåº¦åˆ°å…·æœ‰nodeenv=proæ ‡ç­¾çš„èŠ‚ç‚¹ä¸Š</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">kubectl create -f pod-nodeselector.yaml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Podè°ƒåº¦åˆ°NODEå±æ€§ï¼Œç¡®å®æ˜¯è°ƒåº¦åˆ°äº†node1èŠ‚ç‚¹ä¸Š</span></span><br><span class="line">kubectl get pods pod-nodeselector -n dev -o wide</span><br><span class="line"></span><br><span class="line">NAME               READY   STATUS    RESTARTS   AGE     IP          NODE    ......</span><br><span class="line">pod-nodeselector   1/1     Running   0          47s   10.244.1.87   node1   ......</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¥ä¸‹æ¥ï¼Œåˆ é™¤podï¼Œä¿®æ”¹nodeSelectorçš„å€¼ä¸ºnodeenv: xxxxï¼ˆä¸å­˜åœ¨æ‰“æœ‰æ­¤æ ‡ç­¾çš„èŠ‚ç‚¹ï¼‰</span></span><br><span class="line">kubectl delete -f pod-nodeselector.yaml</span><br><span class="line"></span><br><span class="line">vim pod-nodeselector.yaml</span><br><span class="line">kubectl create -f pod-nodeselector.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†æ¬¡æŸ¥çœ‹ï¼Œå‘ç°podæ— æ³•æ­£å¸¸è¿è¡Œ,Nodeçš„å€¼ä¸ºnone</span></span><br><span class="line">kubectl get pods -n dev -o wide</span><br><span class="line"></span><br><span class="line">NAME               READY   STATUS    RESTARTS   AGE     IP       NODE  </span><br><span class="line">pod-nodeselector   0/1     Pending   0          2m20s   &lt;none&gt;   &lt;none&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¯¦æƒ…,å‘ç°node selectoråŒ¹é…å¤±è´¥çš„æç¤º</span></span><br><span class="line">kubectl describe pods pod-nodeselector -n dev</span><br><span class="line">.......</span><br><span class="line">Events:</span><br><span class="line">  Type     Reason            Age        From               Message</span><br><span class="line">  ----     ------            ----       ----               -------</span><br><span class="line">  Warning  FailedScheduling  &lt;unknown&gt;  default-scheduler  0/3 nodes are available: 3 node(s) didn<span class="string">&#x27;t match node selector.</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_f9784e7b2d5ef85a96addb1f3daa1093.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_f9784e7b2d5ef85a96addb1f3daa1093.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11ã€podè°ƒåº¦ï¼ˆç­–ç•¥æŒ‡å®šéœ€è¦è°ƒåŠ¨åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼‰</title>
      <link href="/2024/12/17/11%E3%80%81pod%E8%B0%83%E5%BA%A6%EF%BC%88%E7%AD%96%E7%95%A5%E6%8C%87%E5%AE%9A%E9%9C%80%E8%A6%81%E8%B0%83%E5%8A%A8%E5%88%B0%E5%93%AA%E4%B8%AA%E8%8A%82%E7%82%B9%EF%BC%89/"/>
      <url>/2024/12/17/11%E3%80%81pod%E8%B0%83%E5%BA%A6%EF%BC%88%E7%AD%96%E7%95%A5%E6%8C%87%E5%AE%9A%E9%9C%80%E8%A6%81%E8%B0%83%E5%8A%A8%E5%88%B0%E5%93%AA%E4%B8%AA%E8%8A%82%E7%82%B9%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="11ã€podè°ƒåº¦ï¼ˆç­–ç•¥æŒ‡å®šéœ€è¦è°ƒåŠ¨åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼‰"><a href="#11ã€podè°ƒåº¦ï¼ˆç­–ç•¥æŒ‡å®šéœ€è¦è°ƒåŠ¨åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼‰" class="headerlink" title="11ã€podè°ƒåº¦ï¼ˆç­–ç•¥æŒ‡å®šéœ€è¦è°ƒåŠ¨åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼‰"></a>11ã€podè°ƒåº¦ï¼ˆç­–ç•¥æŒ‡å®šéœ€è¦è°ƒåŠ¨åˆ°å“ªä¸ªèŠ‚ç‚¹ï¼‰</h2><h4 id="5-4-Podè°ƒåº¦"><a href="#5-4-Podè°ƒåº¦" class="headerlink" title="5.4 Podè°ƒåº¦"></a>5.4 Podè°ƒåº¦</h4><p><strong>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªPodåœ¨å“ªä¸ªNodeèŠ‚ç‚¹ä¸Šè¿è¡Œï¼Œæ˜¯ç”±Schedulerç»„ä»¶é‡‡ç”¨ç›¸åº”çš„ç®—æ³•è®¡ç®—å‡ºæ¥çš„ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ä¸å—äººå·¥æ§åˆ¶çš„ã€‚ä½†æ˜¯åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œè¿™å¹¶ä¸æ»¡è¶³çš„éœ€æ±‚ï¼Œå› ä¸ºå¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æƒ³æ§åˆ¶æŸäº›Podåˆ°è¾¾æŸäº›èŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆåº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿè¿™å°±è¦æ±‚äº†è§£kuberneteså¯¹Podçš„è°ƒåº¦è§„åˆ™ï¼Œkubernetesæä¾›äº†å››å¤§ç±»è°ƒåº¦æ–¹å¼ï¼š</strong></p><ul><li><strong>è‡ªåŠ¨è°ƒåº¦ï¼šè¿è¡Œåœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šå®Œå…¨ç”±Schedulerç»è¿‡ä¸€ç³»åˆ—çš„ç®—æ³•è®¡ç®—å¾—å‡º</strong></li><li><strong>å®šå‘è°ƒåº¦ï¼šNodeNameã€NodeSelector ï¼ˆç¼ºç‚¹è¿™ä¸ªèŠ‚ç‚¹åäº†å°±æ— æ³•è¿è¡Œäº†ï¼‰</strong></li><li><strong>äº²å’Œæ€§è°ƒåº¦ï¼šNodeAffinityã€PodAffinityã€PodAntiAffinity ï¼ˆå®¹å™¨æ‰€åœ¨èŠ‚ç‚¹åäº†ä¼šè‡ªåŠ¨åœ¨ç›¸åŒæ ‡ç­¾ä¸‹çš„èŠ‚ç‚¹é‡å»ºï¼‰</strong></li><li><strong>æ±¡ç‚¹ï¼ˆå®¹å¿ï¼‰è°ƒåº¦ï¼šTaintsã€Toleration</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10.5ã€é‡å¯ç­–ç•¥ï¼ˆrestartPolicyï¼‰</title>
      <link href="/2024/12/17/10.5%E3%80%81%E9%87%8D%E5%90%AF%E7%AD%96%E7%95%A5%EF%BC%88restartPolicy%EF%BC%89/"/>
      <url>/2024/12/17/10.5%E3%80%81%E9%87%8D%E5%90%AF%E7%AD%96%E7%95%A5%EF%BC%88restartPolicy%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="10-5ã€é‡å¯ç­–ç•¥ï¼ˆrestartPolicyï¼‰"><a href="#10-5ã€é‡å¯ç­–ç•¥ï¼ˆrestartPolicyï¼‰" class="headerlink" title="10.5ã€é‡å¯ç­–ç•¥ï¼ˆrestartPolicyï¼‰"></a>10.5ã€é‡å¯ç­–ç•¥ï¼ˆrestartPolicyï¼‰</h2><p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œä¸€æ—¦å®¹å™¨æ¢æµ‹å‡ºç°äº†é—®é¢˜ï¼Œkuberneteså°±ä¼šå¯¹å®¹å™¨æ‰€åœ¨çš„Podè¿›è¡Œé‡å¯ï¼Œå…¶å®è¿™æ˜¯ç”±podçš„é‡å¯ç­–ç•¥å†³å®šçš„ï¼Œpodçš„é‡å¯ç­–ç•¥æœ‰ 3 ç§ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š</p><ul><li>Always ï¼šå®¹å™¨å¤±æ•ˆæ—¶ï¼Œè‡ªåŠ¨é‡å¯è¯¥å®¹å™¨ï¼Œè¿™ä¹Ÿæ˜¯é»˜è®¤å€¼ã€‚</li><li>OnFailure ï¼š å®¹å™¨ç»ˆæ­¢è¿è¡Œä¸”é€€å‡ºç ä¸ä¸º0æ—¶é‡å¯</li><li>Never ï¼š ä¸è®ºçŠ¶æ€ä¸ºä½•ï¼Œéƒ½ä¸é‡å¯è¯¥å®¹å™¨</li></ul><p>é‡å¯ç­–ç•¥é€‚ç”¨äºpodå¯¹è±¡ä¸­çš„æ‰€æœ‰å®¹å™¨ï¼Œé¦–æ¬¡éœ€è¦é‡å¯çš„å®¹å™¨ï¼Œå°†åœ¨å…¶éœ€è¦æ—¶ç«‹å³è¿›è¡Œé‡å¯ï¼Œéšåå†æ¬¡éœ€è¦é‡å¯çš„æ“ä½œå°†ç”±kubeletå»¶è¿Ÿä¸€æ®µæ—¶é—´åè¿›è¡Œï¼Œä¸”åå¤çš„é‡å¯æ“ä½œçš„å»¶è¿Ÿæ—¶é•¿ä»¥æ­¤ä¸º10sã€20sã€40sã€80sã€160så’Œ300sï¼Œ300sæ˜¯æœ€å¤§å»¶è¿Ÿæ—¶é•¿ã€‚</p><p><strong>åˆ›å»º pod-restartpolicy.yamlï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-restartpolicy</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> </span><br><span class="line">    <span class="comment"># nginx:1.17.1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">livenessProbe:</span>   <span class="comment"># å®¹å™¨æ¢æµ‹</span></span><br><span class="line">      <span class="attr">httpGet:</span></span><br><span class="line">        <span class="attr">scheme:</span> <span class="string">HTTP</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/hello</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">Never</span> <span class="comment"># è®¾ç½®é‡å¯ç­–ç•¥ä¸ºNever</span></span><br></pre></td></tr></table></figure><p><strong>è¿è¡ŒPodæµ‹è¯•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">kubectl create -f pod-restartpolicy.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Podè¯¦æƒ…ï¼Œå‘ç°nginxå®¹å™¨å¤±è´¥</span></span><br><span class="line">kubectl  describe pods pod-restartpolicy  -n dev</span><br><span class="line">......</span><br><span class="line">  Warning  Unhealthy  15s (x3 over 35s)  kubelet, node1     Liveness probe failed: HTTP probe failed with statuscode: 404</span><br><span class="line">  Normal   Killing    15s                kubelet, node1     Container nginx failed liveness probe</span><br><span class="line">  </span><br><span class="line"><span class="comment"># å¤šç­‰ä¸€ä¼šï¼Œå†è§‚å¯Ÿpodçš„é‡å¯æ¬¡æ•°ï¼Œå‘ç°ä¸€ç›´æ˜¯0ï¼Œå¹¶æœªé‡å¯   </span></span><br><span class="line">kubectl  get pods pod-restartpolicy -n dev</span><br><span class="line"></span><br><span class="line">NAME                   READY   STATUS    RESTARTS   AGE</span><br><span class="line">pod-restartpolicy      0/1     Running   0          5min42s</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8sä¸dockeråŠå…¶ä»–ä¸­é—´ä»¶é¢è¯•é¢˜æ€»ç»“</title>
      <link href="/2024/12/08/k8s%E4%B8%8Edocker%E5%8F%8A%E5%85%B6%E4%BB%96%E4%B8%AD%E9%97%B4%E4%BB%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/"/>
      <url>/2024/12/08/k8s%E4%B8%8Edocker%E5%8F%8A%E5%85%B6%E4%BB%96%E4%B8%AD%E9%97%B4%E4%BB%B6%E9%9D%A2%E8%AF%95%E9%A2%98%E6%80%BB%E7%BB%93/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="k8sä¸dockeråŠå…¶ä»–ä¸­é—´ä»¶é¢è¯•é¢˜æ€»ç»“"><a href="#k8sä¸dockeråŠå…¶ä»–ä¸­é—´ä»¶é¢è¯•é¢˜æ€»ç»“" class="headerlink" title="k8sä¸dockeråŠå…¶ä»–ä¸­é—´ä»¶é¢è¯•é¢˜æ€»ç»“"></a>k8sä¸dockeråŠå…¶ä»–ä¸­é—´ä»¶é¢è¯•é¢˜æ€»ç»“</h1><h2 id="ä¸€ã€k8s"><a href="#ä¸€ã€k8s" class="headerlink" title="ä¸€ã€k8s"></a>ä¸€ã€k8s</h2><h3 id="1ã€k8sæœ‰å‡ ç§podæ§åˆ¶å™¨"><a href="#1ã€k8sæœ‰å‡ ç§podæ§åˆ¶å™¨" class="headerlink" title="1ã€k8sæœ‰å‡ ç§podæ§åˆ¶å™¨"></a>1ã€k8sæœ‰å‡ ç§podæ§åˆ¶å™¨</h3><p>ç­”ï¼š</p><p>k8sæœ‰8ä¸­podæ§åˆ¶å™¨ åˆ†åˆ«ä¸ºâ€œReplicaSetã€deploymentã€StatefulSetã€Horizontal Pod Autoscaler(HPA)ã€DaemonSetã€Jobã€CronJobâ€</p><h3 id="2ã€æ»šåŠ¨æ›´æ–°å’Œç‰ˆæœ¬å›é€€"><a href="#2ã€æ»šåŠ¨æ›´æ–°å’Œç‰ˆæœ¬å›é€€" class="headerlink" title="2ã€æ»šåŠ¨æ›´æ–°å’Œç‰ˆæœ¬å›é€€"></a>2ã€æ»šåŠ¨æ›´æ–°å’Œç‰ˆæœ¬å›é€€</h3><p>ç­”ï¼š</p><p>æ»šåŠ¨æ›´æ–°å°±æ˜¯æ€æ­»ä¸€éƒ¨åˆ†å°±å¯åŠ¨ä¸€éƒ¨åˆ†åœ¨æ›´æ–°è¿‡ç¨‹ä¸­å­˜åœ¨ä¸¤ä¸ªç‰ˆæœ¬Pod</p><p>ç‰ˆæœ¬å›é€€å°±æ˜¯ æ”¯æŒç‰ˆæœ¬å‡çº§è¿‡ç¨‹ä¸­çš„æš‚åœã€ç»§ç»­åŠŸèƒ½ä»¥åŠç‰ˆæœ¬å›é€€ç­‰è¯¸å¤šåŠŸèƒ½ å‡çº§è¿‡ç¨‹ä¸­å‡ºç°é—®é¢˜åˆ™å›é€€åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬</p><h3 id="3ã€ä»€ä¹ˆæ˜¯ç°åº¦å‘å¸ƒ-è“ç»¿å‘å¸ƒ-é‡‘ä¸é›€å‘å¸ƒ"><a href="#3ã€ä»€ä¹ˆæ˜¯ç°åº¦å‘å¸ƒ-è“ç»¿å‘å¸ƒ-é‡‘ä¸é›€å‘å¸ƒ" class="headerlink" title="3ã€ä»€ä¹ˆæ˜¯ç°åº¦å‘å¸ƒ/è“ç»¿å‘å¸ƒ/é‡‘ä¸é›€å‘å¸ƒ"></a>3ã€ä»€ä¹ˆæ˜¯ç°åº¦å‘å¸ƒ/è“ç»¿å‘å¸ƒ/é‡‘ä¸é›€å‘å¸ƒ</h3><p>ç­”ï¼š</p><p>æœ‰ä¸€æ‰¹æ–°çš„Podèµ„æºåˆ›å»ºå®Œæˆåç«‹å³æš‚åœæ›´æ–°è¿‡ç¨‹ï¼Œæ­¤æ—¶ï¼Œä»…å­˜åœ¨ä¸€éƒ¨åˆ†æ–°ç‰ˆæœ¬çš„åº”ç”¨ï¼Œä¸»ä½“éƒ¨åˆ†è¿˜æ˜¯æ—§çš„ç‰ˆæœ¬ã€‚ç„¶åï¼Œå†ç­›é€‰ä¸€å°éƒ¨åˆ†çš„ç”¨æˆ·è¯·æ±‚è·¯ç”±åˆ°æ–°ç‰ˆæœ¬çš„Podåº”ç”¨ï¼Œç»§ç»­è§‚å¯Ÿèƒ½å¦ç¨³å®šåœ°æŒ‰æœŸæœ›çš„æ–¹å¼è¿è¡Œã€‚ç¡®å®šæ²¡é—®é¢˜ä¹‹åå†ç»§ç»­å®Œæˆä½™ä¸‹çš„Podèµ„æºæ»šåŠ¨æ›´æ–°ã€‚</p><h3 id="4ã€k8s-cni-cri-csi-åˆ†åˆ«æ˜¯ä»€ä¹ˆ"><a href="#4ã€k8s-cni-cri-csi-åˆ†åˆ«æ˜¯ä»€ä¹ˆ" class="headerlink" title="4ã€k8s cni cri csi åˆ†åˆ«æ˜¯ä»€ä¹ˆ"></a>4ã€k8s cni cri csi åˆ†åˆ«æ˜¯ä»€ä¹ˆ</h3><p>ç­”ï¼š</p><ul><li><strong>CNIï¼ˆcaclicoã€flannelã€Weave Netï¼‰</strong>ï¼šè´Ÿè´£ Pod çš„ç½‘ç»œè¿æ¥ï¼Œä¾‹å¦‚ä¸ºæ–°åˆ›å»ºçš„ Pod åˆ†é… IPï¼Œå¹¶ç¡®ä¿ Pod ä¹‹é—´å¯ä»¥é€šä¿¡ã€‚</li><li><strong>CSIï¼ˆnfs ceph AWS EBSï¼‰</strong>ï¼šä¸º Pod æä¾›å­˜å‚¨èµ„æºï¼Œä¾‹å¦‚æŒ‚è½½æŒä¹…åŒ–å­˜å‚¨å·ã€‚</li><li><strong>CRIï¼ˆDockerã€cri-ozã€containerï¼‰</strong>ï¼šä¸º Pod æä¾›å®¹å™¨è¿è¡Œç¯å¢ƒï¼Œä¾‹å¦‚æ‹‰å–é•œåƒå¹¶å¯åŠ¨å®¹å™¨ã€‚</li></ul><h3 id="5ã€k8sæœ‰å“ªäº›å­˜å‚¨"><a href="#5ã€k8sæœ‰å“ªäº›å­˜å‚¨" class="headerlink" title="5ã€k8sæœ‰å“ªäº›å­˜å‚¨"></a>5ã€k8sæœ‰å“ªäº›å­˜å‚¨</h3><p>ç­”ï¼š</p><p>EmptyDirã€HostPathã€NFSã€Pvã€Pvcã€StorageClassã€ConfigMapã€Secret</p><h3 id="6ã€serviceæœ‰å‡ ç§ç±»å‹"><a href="#6ã€serviceæœ‰å‡ ç§ç±»å‹" class="headerlink" title="6ã€serviceæœ‰å‡ ç§ç±»å‹"></a>6ã€serviceæœ‰å‡ ç§ç±»å‹</h3><p>ç­”ï¼š</p><p>CluSterIPã€Headlinessã€NodePortã€Loadbalancerã€ExternalName</p><h2 id="äºŒã€docker"><a href="#äºŒã€docker" class="headerlink" title="äºŒã€docker"></a>äºŒã€docker</h2><h3 id="1ã€docker-cgroupæ˜¯ä»€ä¹ˆ"><a href="#1ã€docker-cgroupæ˜¯ä»€ä¹ˆ" class="headerlink" title="1ã€docker cgroupæ˜¯ä»€ä¹ˆ"></a>1ã€docker cgroupæ˜¯ä»€ä¹ˆ</h3><p>ç­”ï¼š</p><p><code>cgroup</code>ï¼ˆControl Groupsï¼‰æ˜¯ Linux å†…æ ¸çš„ä¸€é¡¹åŠŸèƒ½ï¼Œç”¨äºé™åˆ¶ã€éš”ç¦»å’Œç›‘æ§ç³»ç»Ÿèµ„æºï¼ˆå¦‚ CPUã€å†…å­˜ã€I/O å’Œç½‘ç»œï¼‰çš„ä½¿ç”¨ã€‚Docker ä½¿ç”¨ <code>cgroup</code> æ¥å®ç°å®¹å™¨çš„èµ„æºé™åˆ¶å’Œéš”ç¦»ã€‚</p><h3 id="2ã€æ€æ ·æŸ¥çœ‹dockerçš„èµ„æºå ç”¨æƒ…å†µ"><a href="#2ã€æ€æ ·æŸ¥çœ‹dockerçš„èµ„æºå ç”¨æƒ…å†µ" class="headerlink" title="2ã€æ€æ ·æŸ¥çœ‹dockerçš„èµ„æºå ç”¨æƒ…å†µ"></a>2ã€æ€æ ·æŸ¥çœ‹dockerçš„èµ„æºå ç”¨æƒ…å†µ</h3><ul><li>é€šè¿‡telegrafã€prometheusç­‰ç›‘æ§æ’ä»¶ç›‘æ§</li><li>ä½¿ç”¨å‘½ä»¤docker statsç›‘æ§</li></ul><h3 id="3ã€dockerfileæœ‰å“ªäº›ä¿ç•™å­—æŒ‡ä»¤"><a href="#3ã€dockerfileæœ‰å“ªäº›ä¿ç•™å­—æŒ‡ä»¤" class="headerlink" title="3ã€dockerfileæœ‰å“ªäº›ä¿ç•™å­—æŒ‡ä»¤"></a>3ã€dockerfileæœ‰å“ªäº›ä¿ç•™å­—æŒ‡ä»¤</h3><p>docker build -f /home/Dockerfile/Dockerfile -t zznn/telegraf .</p><table><thead><tr><th>Dockerfile æŒ‡ä»¤</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>FROM</td><td>æŒ‡å®šåŸºç¡€é•œåƒï¼Œç”¨äºåç»­çš„æŒ‡ä»¤æ„å»ºã€‚</td></tr><tr><td>MAINTAINER</td><td>æŒ‡å®šDockerfileçš„ä½œè€…/ç»´æŠ¤è€…ã€‚ï¼ˆå·²å¼ƒç”¨ï¼Œæ¨èä½¿ç”¨LABELæŒ‡ä»¤ï¼‰</td></tr><tr><td>LABEL</td><td>æ·»åŠ é•œåƒçš„å…ƒæ•°æ®ï¼Œä½¿ç”¨é”®å€¼å¯¹çš„å½¢å¼ã€‚</td></tr><tr><td>RUN</td><td>åœ¨æ„å»ºè¿‡ç¨‹ä¸­åœ¨é•œåƒä¸­æ‰§è¡Œå‘½ä»¤ã€‚</td></tr><tr><td>CMD</td><td>æŒ‡å®šå®¹å™¨åˆ›å»ºæ—¶çš„é»˜è®¤å‘½ä»¤ã€‚ï¼ˆå¯ä»¥è¢«è¦†ç›–ï¼‰</td></tr><tr><td>ENTRYPOINT</td><td>è®¾ç½®å®¹å™¨åˆ›å»ºæ—¶çš„ä¸»è¦å‘½ä»¤ã€‚ï¼ˆä¸å¯è¢«è¦†ç›–ï¼‰</td></tr><tr><td>EXPOSE</td><td>å£°æ˜å®¹å™¨è¿è¡Œæ—¶ç›‘å¬çš„ç‰¹å®šç½‘ç»œç«¯å£ã€‚</td></tr><tr><td>ENV</td><td>åœ¨å®¹å™¨å†…éƒ¨è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</td></tr><tr><td>ADD</td><td>å°†æ–‡ä»¶ã€ç›®å½•æˆ–è¿œç¨‹URLå¤åˆ¶åˆ°é•œåƒä¸­ã€‚</td></tr><tr><td>COPY</td><td>å°†æ–‡ä»¶æˆ–ç›®å½•å¤åˆ¶åˆ°é•œåƒä¸­ã€‚</td></tr><tr><td>VOLUME</td><td>ä¸ºå®¹å™¨åˆ›å»ºæŒ‚è½½ç‚¹æˆ–å£°æ˜å·ã€‚</td></tr><tr><td>WORKDIR</td><td>è®¾ç½®åç»­æŒ‡ä»¤çš„å·¥ä½œç›®å½•ã€‚</td></tr><tr><td>USER</td><td>æŒ‡å®šåç»­æŒ‡ä»¤çš„ç”¨æˆ·ä¸Šä¸‹æ–‡ã€‚</td></tr><tr><td>ARG</td><td>å®šä¹‰åœ¨æ„å»ºè¿‡ç¨‹ä¸­ä¼ é€’ç»™æ„å»ºå™¨çš„å˜é‡ï¼Œå¯ä½¿ç”¨ â€œdocker buildâ€ å‘½ä»¤è®¾ç½®ã€‚</td></tr><tr><td>ONBUILD</td><td>å½“è¯¥é•œåƒè¢«ç”¨ä½œå¦ä¸€ä¸ªæ„å»ºè¿‡ç¨‹çš„åŸºç¡€æ—¶ï¼Œæ·»åŠ è§¦å‘å™¨ã€‚</td></tr><tr><td>STOPSIGNAL</td><td>è®¾ç½®å‘é€ç»™å®¹å™¨ä»¥é€€å‡ºçš„ç³»ç»Ÿè°ƒç”¨ä¿¡å·ã€‚</td></tr><tr><td>HEALTHCHECK</td><td>å®šä¹‰å‘¨æœŸæ€§æ£€æŸ¥å®¹å™¨å¥åº·çŠ¶æ€çš„å‘½ä»¤ã€‚</td></tr><tr><td>SHELL</td><td>è¦†ç›–Dockerä¸­é»˜è®¤çš„shellï¼Œç”¨äºRUNã€CMDå’ŒENTRYPOINTæŒ‡ä»¤ã€‚</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10.4ã€å®¹å™¨æ¢æµ‹ï¼ˆexec TCPSoket HTTPGetï¼‰</title>
      <link href="/2024/12/04/10.4%E3%80%81%E5%AE%B9%E5%99%A8%E6%8E%A2%E6%B5%8B%EF%BC%88exec%20TCPSoket%20HTTPGet%EF%BC%89/"/>
      <url>/2024/12/04/10.4%E3%80%81%E5%AE%B9%E5%99%A8%E6%8E%A2%E6%B5%8B%EF%BC%88exec%20TCPSoket%20HTTPGet%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="10-4ã€å®¹å™¨æ¢æµ‹ï¼ˆexec-TCPSoket-HTTPGetï¼‰"><a href="#10-4ã€å®¹å™¨æ¢æµ‹ï¼ˆexec-TCPSoket-HTTPGetï¼‰" class="headerlink" title="10.4ã€å®¹å™¨æ¢æµ‹ï¼ˆexec TCPSoket HTTPGetï¼‰"></a>10.4ã€å®¹å™¨æ¢æµ‹ï¼ˆexec TCPSoket HTTPGetï¼‰</h2><h2 id="ä¸€ã€æ¦‚è§ˆ"><a href="#ä¸€ã€æ¦‚è§ˆ" class="headerlink" title="ä¸€ã€æ¦‚è§ˆ"></a>ä¸€ã€æ¦‚è§ˆ</h2><p><strong>å®¹å™¨æ¢æµ‹ç”¨äºæ£€æµ‹å®¹å™¨ä¸­çš„åº”ç”¨å®ä¾‹æ˜¯å¦æ­£å¸¸å·¥ä½œï¼Œæ˜¯ä¿éšœä¸šåŠ¡å¯ç”¨æ€§çš„ä¸€ç§ä¼ ç»Ÿæœºåˆ¶ã€‚å¦‚æœç»è¿‡æ¢æµ‹ï¼Œå®ä¾‹çš„çŠ¶æ€ä¸ç¬¦åˆé¢„æœŸï¼Œé‚£ä¹ˆkuberneteså°±ä¼šæŠŠè¯¥é—®é¢˜å®ä¾‹â€ æ‘˜é™¤ â€œï¼Œä¸æ‰¿æ‹…ä¸šåŠ¡æµé‡ã€‚kubernetesæä¾›äº†ä¸¤ç§æ¢é’ˆæ¥å®ç°å®¹å™¨æ¢æµ‹ï¼Œåˆ†åˆ«æ˜¯ï¼š</strong></p><ul><li><strong>liveness probesï¼šå­˜æ´»æ€§æ¢é’ˆï¼Œç”¨äºæ£€æµ‹åº”ç”¨å®ä¾‹å½“å‰æ˜¯å¦å¤„äºæ­£å¸¸è¿è¡ŒçŠ¶æ€ï¼Œå¦‚æœä¸æ˜¯ï¼Œk8sä¼šé‡å¯å®¹å™¨</strong></li><li><strong>readiness probesï¼šå°±ç»ªæ€§æ¢é’ˆï¼Œç”¨äºæ£€æµ‹åº”ç”¨å®ä¾‹å½“å‰æ˜¯å¦å¯ä»¥æ¥æ”¶è¯·æ±‚ï¼Œå¦‚æœä¸èƒ½ï¼Œk8sä¸ä¼šè½¬å‘æµé‡</strong></li></ul><p><strong>livenessProbe å†³å®šæ˜¯å¦é‡å¯å®¹å™¨ï¼ŒreadinessProbe å†³å®šæ˜¯å¦å°†è¯·æ±‚è½¬å‘ç»™å®¹å™¨ã€‚</strong></p><p><strong>ä¸Šé¢ä¸¤ç§æ¢é’ˆç›®å‰å‡æ”¯æŒä¸‰ç§æ¢æµ‹æ–¹å¼ï¼š</strong></p><ul><li><strong>Execå‘½ä»¤ï¼šåœ¨å®¹å™¨å†…æ‰§è¡Œä¸€æ¬¡å‘½ä»¤ï¼Œå¦‚æœå‘½ä»¤æ‰§è¡Œçš„é€€å‡ºç ä¸º0ï¼Œåˆ™è®¤ä¸ºç¨‹åºæ­£å¸¸ï¼Œå¦åˆ™ä¸æ­£å¸¸</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">â€¦â€¦</span></span><br><span class="line">  <span class="attr">livenessProbe:</span></span><br><span class="line">    <span class="attr">exec:</span></span><br><span class="line">      <span class="attr">command:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">cat</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/tmp/healthy</span></span><br><span class="line"><span class="string">â€¦â€¦</span></span><br></pre></td></tr></table></figure><ul><li><strong>TCPSocketï¼šå°†ä¼šå°è¯•è®¿é—®ä¸€ä¸ªç”¨æˆ·å®¹å™¨çš„ç«¯å£ï¼Œå¦‚æœèƒ½å¤Ÿå»ºç«‹è¿™æ¡è¿æ¥ï¼Œåˆ™è®¤ä¸ºç¨‹åºæ­£å¸¸ï¼Œå¦åˆ™ä¸æ­£å¸¸</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">â€¦â€¦</span>  </span><br><span class="line">  <span class="attr">livenessProbe:</span></span><br><span class="line">    <span class="attr">tcpSocket:</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8080</span></span><br><span class="line"><span class="string">â€¦â€¦</span></span><br></pre></td></tr></table></figure><ul><li><strong>HTTPGetï¼šè°ƒç”¨å®¹å™¨å†…Webåº”ç”¨çš„URLï¼Œå¦‚æœè¿”å›çš„çŠ¶æ€ç åœ¨200å’Œ399ä¹‹é—´ï¼Œåˆ™è®¤ä¸ºç¨‹åºæ­£å¸¸ï¼Œå¦åˆ™ä¸æ­£å¸¸</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">â€¦â€¦</span></span><br><span class="line">  <span class="attr">livenessProbe:</span></span><br><span class="line">    <span class="attr">httpGet:</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">/</span> <span class="comment">#URIåœ°å€</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">80</span> <span class="comment">#ç«¯å£å·</span></span><br><span class="line">      <span class="attr">host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="comment">#ä¸»æœºåœ°å€</span></span><br><span class="line">      <span class="attr">scheme:</span> <span class="string">HTTP</span> <span class="comment">#æ”¯æŒçš„åè®®ï¼Œhttpæˆ–è€…https</span></span><br><span class="line"><span class="string">â€¦â€¦</span></span><br></pre></td></tr></table></figure><p><strong>ä¸‹é¢ä»¥liveness probesä¸ºä¾‹ï¼Œåšå‡ ä¸ªæ¼”ç¤ºï¼š</strong></p><h2 id="äºŒã€æ‰§è¡Œæ–¹å¼"><a href="#äºŒã€æ‰§è¡Œæ–¹å¼" class="headerlink" title="äºŒã€æ‰§è¡Œæ–¹å¼"></a>äºŒã€æ‰§è¡Œæ–¹å¼</h2><h3 id="1ã€æ–¹å¼ä¸€ï¼šExec"><a href="#1ã€æ–¹å¼ä¸€ï¼šExec" class="headerlink" title="1ã€æ–¹å¼ä¸€ï¼šExec"></a>1ã€æ–¹å¼ä¸€ï¼šExec</h3><p><strong>åˆ›å»ºpod-liveness-exec.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-liveness-exec</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> <span class="comment"># nginx:1.17.1</span></span><br><span class="line">    <span class="attr">ports:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">livenessProbe:</span></span><br><span class="line">      <span class="attr">exec:</span></span><br><span class="line">        <span class="attr">command:</span> [<span class="string">&quot;/bin/cat&quot;</span>,<span class="string">&quot;/tmp/hello.txt&quot;</span>] <span class="comment"># æ‰§è¡Œä¸€ä¸ªæŸ¥çœ‹æ–‡ä»¶çš„å‘½ä»¤</span></span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºpodï¼Œè§‚å¯Ÿæ•ˆæœ</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line"><span class="string">kubectl</span> <span class="string">create</span> <span class="string">-f</span> <span class="string">pod-liveness-exec.yaml</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Podè¯¦æƒ…</span></span><br><span class="line"><span class="string">kubectl</span> <span class="string">describe</span> <span class="string">pods</span> <span class="string">pod-liveness-exec</span> <span class="string">-n</span> <span class="string">dev</span></span><br><span class="line"></span><br><span class="line"><span class="string">......</span></span><br><span class="line">  <span class="string">Normal</span>   <span class="string">Created</span>    <span class="string">20s</span> <span class="string">(x2</span> <span class="string">over</span> <span class="string">50s)</span>  <span class="string">kubelet,</span> <span class="string">node1</span>     <span class="string">Created</span> <span class="string">container</span> <span class="string">nginx</span></span><br><span class="line">  <span class="string">Normal</span>   <span class="string">Started</span>    <span class="string">20s</span> <span class="string">(x2</span> <span class="string">over</span> <span class="string">50s)</span>  <span class="string">kubelet,</span> <span class="string">node1</span>     <span class="string">Started</span> <span class="string">container</span> <span class="string">nginx</span></span><br><span class="line">  <span class="string">Normal</span>   <span class="string">Killing</span>    <span class="string">20s</span>                <span class="string">kubelet,</span> <span class="string">node1</span>     <span class="string">Container</span> <span class="string">nginx</span> <span class="string">failed</span> <span class="string">liveness</span> <span class="string">probe,</span> <span class="string">will</span> <span class="string">be</span> <span class="string">restarted</span></span><br><span class="line">  <span class="string">Warning</span>  <span class="string">Unhealthy</span>  <span class="string">0s</span> <span class="string">(x5</span> <span class="string">over</span> <span class="string">40s)</span>   <span class="string">kubelet,</span> <span class="attr">node1     Liveness probe failed: cat:</span> <span class="string">can&#x27;t</span> <span class="string">open</span> <span class="string">&#x27;/tmp/hello11.txt&#x27;</span><span class="string">:</span> <span class="literal">No</span> <span class="string">such</span> <span class="string">file</span> <span class="string">or</span> <span class="string">directory</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># è§‚å¯Ÿä¸Šé¢çš„ä¿¡æ¯å°±ä¼šå‘ç°nginxå®¹å™¨å¯åŠ¨ä¹‹åå°±è¿›è¡Œäº†å¥åº·æ£€æŸ¥</span></span><br><span class="line"><span class="comment"># æ£€æŸ¥å¤±è´¥ä¹‹åï¼Œå®¹å™¨è¢«killæ‰ï¼Œç„¶åå°è¯•è¿›è¡Œé‡å¯ï¼ˆè¿™æ˜¯é‡å¯ç­–ç•¥çš„ä½œç”¨ï¼Œåé¢è®²è§£ï¼‰</span></span><br><span class="line"><span class="comment"># ç¨ç­‰ä¸€ä¼šä¹‹åï¼Œå†è§‚å¯Ÿpodä¿¡æ¯ï¼Œå°±å¯ä»¥çœ‹åˆ°RESTARTSä¸å†æ˜¯0ï¼Œè€Œæ˜¯ä¸€ç›´å¢é•¿</span></span><br><span class="line"><span class="string">kubectl</span> <span class="string">get</span> <span class="string">pods</span> <span class="string">pod-liveness-exec</span> <span class="string">-n</span> <span class="string">dev</span></span><br><span class="line"></span><br><span class="line"><span class="string">NAME</span>                <span class="string">READY</span>   <span class="string">STATUS</span>             <span class="string">RESTARTS</span>   <span class="string">AGE</span></span><br><span class="line"><span class="string">pod-liveness-exec</span>   <span class="number">0</span><span class="string">/1</span>     <span class="string">CrashLoopBackOff</span>   <span class="number">2</span>          <span class="string">3m19s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“ç„¶æ¥ä¸‹æ¥ï¼Œå¯ä»¥ä¿®æ”¹æˆä¸€ä¸ªå­˜åœ¨çš„æ–‡ä»¶ï¼Œæ¯”å¦‚/tmp/hello.txtï¼Œå†è¯•ï¼Œç»“æœå°±æ­£å¸¸äº†......</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_808501ef065eab0e4598ef658faa491c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_808501ef065eab0e4598ef658faa491c.png"></p><h3 id="2ã€æ–¹å¼äºŒï¼šTCPSocket"><a href="#2ã€æ–¹å¼äºŒï¼šTCPSocket" class="headerlink" title="2ã€æ–¹å¼äºŒï¼šTCPSocket"></a>2ã€æ–¹å¼äºŒï¼šTCPSocket</h3><p><strong>åˆ›å»º pod-liveness-tcpsocket.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-liveness-tcpsocket</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span>  <span class="comment"># nginx:1.17.1</span></span><br><span class="line">    <span class="attr">ports:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">livenessProbe:</span></span><br><span class="line">      <span class="attr">tcpSocket:</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">8080</span> <span class="comment"># å°è¯•è®¿é—®8080ç«¯å£</span></span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºpodï¼Œè§‚å¯Ÿæ•ˆæœ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">kubectl create -f pod-liveness-tcpsocket.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Podè¯¦æƒ…</span></span><br><span class="line">kubectl describe pods pod-liveness-tcpsocket -n dev</span><br><span class="line">......</span><br><span class="line">  Normal   Scheduled  31s                            default-scheduler  Successfully assigned dev/pod-liveness-tcpsocket to node2</span><br><span class="line">  Normal   Pulled     &lt;invalid&gt;                      kubelet, node2     Container image <span class="string">&quot;nginx:1.17.1&quot;</span> already present on machine</span><br><span class="line">  Normal   Created    &lt;invalid&gt;                      kubelet, node2     Created container nginx</span><br><span class="line">  Normal   Started    &lt;invalid&gt;                      kubelet, node2     Started container nginx</span><br><span class="line">  Warning  Unhealthy  &lt;invalid&gt; (x2 over &lt;invalid&gt;)  kubelet, node2     Liveness probe failed: dial tcp 10.244.2.44:8080: connect: connection refused</span><br><span class="line">  </span><br><span class="line"><span class="comment"># è§‚å¯Ÿä¸Šé¢çš„ä¿¡æ¯ï¼Œå‘ç°å°è¯•è®¿é—®8080ç«¯å£,ä½†æ˜¯å¤±è´¥äº†</span></span><br><span class="line"><span class="comment"># ç¨ç­‰ä¸€ä¼šä¹‹åï¼Œå†è§‚å¯Ÿpodä¿¡æ¯ï¼Œå°±å¯ä»¥çœ‹åˆ°RESTARTSä¸å†æ˜¯0ï¼Œè€Œæ˜¯ä¸€ç›´å¢é•¿</span></span><br><span class="line">kubectl get pods pod-liveness-tcpsocket  -n dev</span><br><span class="line"></span><br><span class="line">NAME                     READY   STATUS             RESTARTS   AGE</span><br><span class="line">pod-liveness-tcpsocket   0/1     CrashLoopBackOff   2          3m19s</span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“ç„¶æ¥ä¸‹æ¥ï¼Œå¯ä»¥ä¿®æ”¹æˆä¸€ä¸ªå¯ä»¥è®¿é—®çš„ç«¯å£ï¼Œæ¯”å¦‚80ï¼Œå†è¯•ï¼Œç»“æœå°±æ­£å¸¸äº†......</span></span><br></pre></td></tr></table></figure><h3 id="3ã€æ–¹å¼ä¸‰ï¼šHTTPGet"><a href="#3ã€æ–¹å¼ä¸‰ï¼šHTTPGet" class="headerlink" title="3ã€æ–¹å¼ä¸‰ï¼šHTTPGet"></a>3ã€æ–¹å¼ä¸‰ï¼šHTTPGet</h3><p><strong>åˆ›å»º pod-liveness-httpget.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-liveness-httpget</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.17.1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">livenessProbe:</span></span><br><span class="line">      <span class="attr">httpGet:</span>       <span class="comment"># å…¶å®å°±æ˜¯è®¿é—®http://127.0.0.1:80/hello  </span></span><br><span class="line">        <span class="attr">scheme:</span> <span class="string">HTTP</span> <span class="comment"># æ”¯æŒçš„åè®®ï¼Œhttpæˆ–è€…https</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">80</span>     <span class="comment"># ç«¯å£å·</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">/hello</span> <span class="comment"># URIåœ°å€</span></span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºpodï¼Œè§‚å¯Ÿæ•ˆæœ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">kubectl create -f pod-liveness-httpget.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Podè¯¦æƒ…</span></span><br><span class="line">kubectl describe pod pod-liveness-httpget -n dev</span><br><span class="line">.......</span><br><span class="line">  Normal   Pulled     6s (x3 over 64s)  kubelet, node1     Container image <span class="string">&quot;nginx:1.17.1&quot;</span> already present on machine</span><br><span class="line">  Normal   Created    6s (x3 over 64s)  kubelet, node1     Created container nginx</span><br><span class="line">  Normal   Started    6s (x3 over 63s)  kubelet, node1     Started container nginx</span><br><span class="line">  Warning  Unhealthy  6s (x6 over 56s)  kubelet, node1     Liveness probe failed: HTTP probe failed with statuscode: 404</span><br><span class="line">  Normal   Killing    6s (x2 over 36s)  kubelet, node1     Container nginx failed liveness probe, will be restarted</span><br><span class="line">  </span><br><span class="line"><span class="comment"># è§‚å¯Ÿä¸Šé¢ä¿¡æ¯ï¼Œå°è¯•è®¿é—®è·¯å¾„ï¼Œä½†æ˜¯æœªæ‰¾åˆ°,å‡ºç°404é”™è¯¯</span></span><br><span class="line"><span class="comment"># ç¨ç­‰ä¸€ä¼šä¹‹åï¼Œå†è§‚å¯Ÿpodä¿¡æ¯ï¼Œå°±å¯ä»¥çœ‹åˆ°RESTARTSä¸å†æ˜¯0ï¼Œè€Œæ˜¯ä¸€ç›´å¢é•¿</span></span><br><span class="line">kubectl get pod pod-liveness-httpget -n dev</span><br><span class="line"></span><br><span class="line">NAME                   READY   STATUS    RESTARTS   AGE</span><br><span class="line">pod-liveness-httpget   1/1     Running   5          3m17s</span><br><span class="line"></span><br><span class="line"><span class="comment"># å½“ç„¶æ¥ä¸‹æ¥ï¼Œå¯ä»¥ä¿®æ”¹æˆä¸€ä¸ªå¯ä»¥è®¿é—®çš„è·¯å¾„pathï¼Œæ¯”å¦‚/ï¼Œå†è¯•ï¼Œç»“æœå°±æ­£å¸¸äº†......</span></span><br></pre></td></tr></table></figure><p><strong>è‡³æ­¤ï¼Œå·²ç»ä½¿ç”¨liveness Probeæ¼”ç¤ºäº†ä¸‰ç§æ¢æµ‹æ–¹å¼ï¼Œä½†æ˜¯æŸ¥çœ‹livenessProbeçš„å­å±æ€§ï¼Œä¼šå‘ç°é™¤äº†è¿™ä¸‰ç§æ–¹å¼ï¼Œè¿˜æœ‰ä¸€äº›å…¶ä»–çš„é…ç½®ï¼Œåœ¨è¿™é‡Œä¸€å¹¶è§£é‡Šä¸‹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl explain pod.spec.containers.livenessProbe</span></span><br><span class="line">FIELDS:</span><br><span class="line">   <span class="built_in">exec</span> &lt;Object&gt;  </span><br><span class="line">   tcpSocket    &lt;Object&gt;</span><br><span class="line">   httpGet      &lt;Object&gt;</span><br><span class="line">   initialDelaySeconds  &lt;<span class="built_in">integer</span>&gt;  <span class="comment"># å®¹å™¨å¯åŠ¨åç­‰å¾…å¤šå°‘ç§’æ‰§è¡Œç¬¬ä¸€æ¬¡æ¢æµ‹</span></span><br><span class="line">   timeoutSeconds       &lt;<span class="built_in">integer</span>&gt;  <span class="comment"># æ¢æµ‹è¶…æ—¶æ—¶é—´ã€‚é»˜è®¤1ç§’ï¼Œæœ€å°1ç§’</span></span><br><span class="line">   periodSeconds        &lt;<span class="built_in">integer</span>&gt;  <span class="comment"># æ‰§è¡Œæ¢æµ‹çš„é¢‘ç‡ã€‚é»˜è®¤æ˜¯10ç§’ï¼Œæœ€å°1ç§’</span></span><br><span class="line">   failureThreshold     &lt;<span class="built_in">integer</span>&gt;  <span class="comment"># è¿ç»­æ¢æµ‹å¤±è´¥å¤šå°‘æ¬¡æ‰è¢«è®¤å®šä¸ºå¤±è´¥ã€‚é»˜è®¤æ˜¯3ã€‚æœ€å°å€¼æ˜¯1</span></span><br><span class="line">   successThreshold     &lt;<span class="built_in">integer</span>&gt;  <span class="comment"># è¿ç»­æ¢æµ‹æˆåŠŸå¤šå°‘æ¬¡æ‰è¢«è®¤å®šä¸ºæˆåŠŸã€‚é»˜è®¤æ˜¯1</span></span><br></pre></td></tr></table></figure><p><strong>ä¸‹é¢ç¨å¾®é…ç½®ä¸¤ä¸ªï¼Œæ¼”ç¤ºä¸‹æ•ˆæœå³å¯ï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[<span class="string">root@k8s-master01</span> <span class="string">~</span>]<span class="comment"># more pod-liveness-httpget.yaml</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-liveness-httpget</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.17.1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">livenessProbe:</span></span><br><span class="line">      <span class="attr">httpGet:</span></span><br><span class="line">        <span class="attr">scheme:</span> <span class="string">HTTP</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">80</span> </span><br><span class="line">        <span class="attr">path:</span> <span class="string">/</span></span><br><span class="line">      <span class="attr">initialDelaySeconds:</span> <span class="number">30</span> <span class="comment"># å®¹å™¨å¯åŠ¨å30så¼€å§‹æ¢æµ‹</span></span><br><span class="line">      <span class="attr">timeoutSeconds:</span> <span class="number">5</span> <span class="comment"># æ¢æµ‹è¶…æ—¶æ—¶é—´ä¸º5s</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10.3ã€é’©å­å‡½æ•°ï¼ˆexecï¼‰</title>
      <link href="/2024/12/04/10.3%E3%80%81%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0%EF%BC%88exec%EF%BC%89/"/>
      <url>/2024/12/04/10.3%E3%80%81%E9%92%A9%E5%AD%90%E5%87%BD%E6%95%B0%EF%BC%88exec%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="10-3ã€é’©å­å‡½æ•°ï¼ˆexecï¼‰"><a href="#10-3ã€é’©å­å‡½æ•°ï¼ˆexecï¼‰" class="headerlink" title="10.3ã€é’©å­å‡½æ•°ï¼ˆexecï¼‰"></a>10.3ã€é’©å­å‡½æ•°ï¼ˆexecï¼‰</h2><h5 id="5-3-3-é’©å­å‡½æ•°"><a href="#5-3-3-é’©å­å‡½æ•°" class="headerlink" title="5.3.3 é’©å­å‡½æ•°"></a>5.3.3 é’©å­å‡½æ•°</h5><p><strong>é’©å­å‡½æ•°èƒ½å¤Ÿæ„ŸçŸ¥è‡ªèº«ç”Ÿå‘½å‘¨æœŸä¸­çš„äº‹ä»¶ï¼Œå¹¶åœ¨ç›¸åº”çš„æ—¶åˆ»åˆ°æ¥æ—¶è¿è¡Œç”¨æˆ·æŒ‡å®šçš„ç¨‹åºä»£ç ã€‚</strong></p><p><strong>kubernetesåœ¨ä¸»å®¹å™¨çš„å¯åŠ¨ä¹‹åå’Œåœæ­¢ä¹‹å‰æä¾›äº†ä¸¤ä¸ªé’©å­å‡½æ•°ï¼š</strong></p><ul><li><strong>post startï¼šå®¹å™¨åˆ›å»ºä¹‹åæ‰§è¡Œï¼Œå¦‚æœå¤±è´¥äº†ä¼šé‡å¯å®¹å™¨</strong></li><li><strong>pre stop ï¼šå®¹å™¨ç»ˆæ­¢ä¹‹å‰æ‰§è¡Œï¼Œæ‰§è¡Œå®Œæˆä¹‹åå®¹å™¨å°†æˆåŠŸç»ˆæ­¢ï¼Œåœ¨å…¶å®Œæˆä¹‹å‰ä¼šé˜»å¡åˆ é™¤å®¹å™¨çš„æ“ä½œ</strong></li></ul><p><strong>é’©å­å¤„ç†å™¨æ”¯æŒä½¿ç”¨ä¸‹é¢ä¸‰ç§æ–¹å¼å®šä¹‰åŠ¨ä½œï¼š</strong></p><ul><li><strong>Execå‘½ä»¤ï¼šåœ¨å®¹å™¨å†…æ‰§è¡Œä¸€æ¬¡å‘½ä»¤</strong></li><li><strong>ç›¸å½“äº docker ä¸­ docker exec -it centos ls è¿™æ ·çš„å‘½ä»¤</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">â€¦â€¦</span></span><br><span class="line">  <span class="attr">lifecycle:</span></span><br><span class="line">    <span class="attr">postStart:</span> </span><br><span class="line">      <span class="attr">exec:</span></span><br><span class="line">        <span class="attr">command:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">cat</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">/tmp/healthy</span></span><br><span class="line"><span class="string">â€¦â€¦</span></span><br></pre></td></tr></table></figure><ul><li><strong>TCPSocketï¼šåœ¨å½“å‰å®¹å™¨å°è¯•è®¿é—®æŒ‡å®šçš„socket</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">â€¦â€¦  </span><br><span class="line">  lifecycle:</span><br><span class="line">    postStart:</span><br><span class="line">      tcpSocket:</span><br><span class="line">        port: 8080</span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure><ul><li><strong>HTTPGetï¼šåœ¨å½“å‰å®¹å™¨ä¸­å‘æŸurlå‘èµ·httpè¯·æ±‚</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â€¦â€¦</span><br><span class="line">  lifecycle:</span><br><span class="line">    postStart:</span><br><span class="line">      httpGet:</span><br><span class="line">        path: / <span class="comment">#URIåœ°å€</span></span><br><span class="line">        port: 80 <span class="comment">#ç«¯å£å·</span></span><br><span class="line">        host: 192.168.5.3 <span class="comment">#ä¸»æœºåœ°å€</span></span><br><span class="line">        scheme: HTTP <span class="comment">#æ”¯æŒçš„åè®®ï¼Œhttpæˆ–è€…https</span></span><br><span class="line">â€¦â€¦</span><br></pre></td></tr></table></figure><p><strong>æ¥ä¸‹æ¥ï¼Œä»¥execæ–¹å¼ä¸ºä¾‹ï¼Œæ¼”ç¤ºä¸‹é’©å­å‡½æ•°çš„ä½¿ç”¨ï¼Œåˆ›å»ºpod-hook-exec.yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-hook-exec</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">main-container</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> <span class="comment"># nginx:1.17.1</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">lifecycle:</span></span><br><span class="line">      <span class="attr">postStart:</span> </span><br><span class="line">        <span class="attr">exec:</span> <span class="comment"># åœ¨å®¹å™¨å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œä¸€ä¸ªå‘½ä»¤ï¼Œä¿®æ”¹æ‰nginxçš„é»˜è®¤é¦–é¡µå†…å®¹</span></span><br><span class="line">          <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;-c&quot;</span>, <span class="string">&quot;echo postStart... &gt; /usr/share/nginx/html/index.html&quot;</span>]</span><br><span class="line">      <span class="attr">preStop:</span></span><br><span class="line">        <span class="attr">exec:</span> <span class="comment"># åœ¨å®¹å™¨åœæ­¢ä¹‹å‰åœæ­¢nginxæœåŠ¡</span></span><br><span class="line">          <span class="attr">command:</span> [<span class="string">&quot;/usr/sbin/nginx&quot;</span>,<span class="string">&quot;-s&quot;</span>,<span class="string">&quot;quit&quot;</span>]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºpod</span></span><br><span class="line">kubectl create -f pod-hook-exec.yaml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹pod</span></span><br><span class="line">kubectl get pods  pod-hook-exec -n dev -o wide</span><br><span class="line"></span><br><span class="line">NAME           READY   STATUS     RESTARTS   AGE    IP            NODE  </span><br><span class="line">pod-hook-exec  1/1     Running    0          29s    10.244.2.48   node2   </span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¿é—®pod</span></span><br><span class="line">curl 172.16.0.39</span><br><span class="line"></span><br><span class="line">postStart...</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_3110e799fd7a8f2fcdf6df765798f473.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_3110e799fd7a8f2fcdf6df765798f473.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10.2ã€åˆå§‹åŒ–å®¹å™¨ï¼ˆå¯åŠ¨é¡ºåºï¼‰</title>
      <link href="/2024/12/04/10.2%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%B9%E5%99%A8%EF%BC%88%E5%90%AF%E5%8A%A8%E9%A1%BA%E5%BA%8F%EF%BC%89/"/>
      <url>/2024/12/04/10.2%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%B9%E5%99%A8%EF%BC%88%E5%90%AF%E5%8A%A8%E9%A1%BA%E5%BA%8F%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="10-2ã€åˆå§‹åŒ–å®¹å™¨ï¼ˆå¯åŠ¨é¡ºåºï¼‰"><a href="#10-2ã€åˆå§‹åŒ–å®¹å™¨ï¼ˆå¯åŠ¨é¡ºåºï¼‰" class="headerlink" title="10.2ã€åˆå§‹åŒ–å®¹å™¨ï¼ˆå¯åŠ¨é¡ºåºï¼‰"></a>10.2ã€åˆå§‹åŒ–å®¹å™¨ï¼ˆå¯åŠ¨é¡ºåºï¼‰</h2><h5 id="5-3-2-åˆå§‹åŒ–å®¹å™¨"><a href="#5-3-2-åˆå§‹åŒ–å®¹å™¨" class="headerlink" title="5.3.2 åˆå§‹åŒ–å®¹å™¨"></a>5.3.2 åˆå§‹åŒ–å®¹å™¨</h5><p>åˆå§‹åŒ–å®¹å™¨æ˜¯åœ¨ <strong>pod</strong> <strong>çš„ä¸»å®¹å™¨å¯åŠ¨ä¹‹å‰è¦è¿è¡Œçš„å®¹å™¨ï¼Œä¸»è¦æ˜¯åšä¸€äº›ä¸»å®¹å™¨çš„å‰ç½®å·¥ä½œï¼Œå®ƒå…·æœ‰ä¸¤å¤§ç‰¹å¾ï¼š</strong></p><ol><li><strong>åˆå§‹åŒ–å®¹å™¨å¿…é¡»è¿è¡Œå®Œæˆç›´è‡³ç»“æŸï¼Œè‹¥æŸåˆå§‹åŒ–å®¹å™¨è¿è¡Œå¤±è´¥ï¼Œé‚£ä¹ˆkuberneteséœ€è¦é‡å¯å®ƒç›´åˆ°æˆåŠŸå®Œæˆ</strong></li><li>åˆå§‹åŒ–å®¹å™¨å¿…é¡»æŒ‰ç…§å®šä¹‰çš„é¡ºåºæ‰§è¡Œï¼Œå½“ä¸”ä»…å½“å‰ä¸€ä¸ªæˆåŠŸä¹‹åï¼Œåé¢çš„ä¸€ä¸ªæ‰èƒ½è¿è¡Œ</li><li><strong>ç›¸å½“äºdockerä¸­ çš„ depond on</strong></li></ol><p><strong>åˆå§‹åŒ–å®¹å™¨æœ‰å¾ˆå¤šçš„åº”ç”¨åœºæ™¯ï¼Œä¸‹é¢åˆ—å‡ºçš„æ˜¯æœ€å¸¸è§çš„å‡ ä¸ªï¼š</strong></p><ul><li><strong>æä¾›ä¸»å®¹å™¨é•œåƒä¸­ä¸å…·å¤‡çš„å·¥å…·ç¨‹åºæˆ–è‡ªå®šä¹‰ä»£ç </strong></li><li><strong>åˆå§‹åŒ–å®¹å™¨è¦å…ˆäºåº”ç”¨å®¹å™¨ä¸²è¡Œå¯åŠ¨å¹¶è¿è¡Œå®Œæˆï¼Œå› æ­¤å¯ç”¨äºå»¶ååº”ç”¨å®¹å™¨çš„å¯åŠ¨ç›´è‡³å…¶ä¾èµ–çš„æ¡ä»¶å¾—åˆ°æ»¡è¶³</strong></li></ul><p><strong>æ¥ä¸‹æ¥åšä¸€ä¸ªæ¡ˆä¾‹ï¼Œæ¨¡æ‹Ÿä¸‹é¢è¿™ä¸ªéœ€æ±‚ï¼š</strong></p><p><strong>å‡è®¾è¦ä»¥ä¸»å®¹å™¨æ¥è¿è¡Œnginxï¼Œä½†æ˜¯è¦æ±‚åœ¨è¿è¡Œnginxä¹‹å‰å…ˆè¦èƒ½å¤Ÿè¿æ¥ä¸Šmysqlå’Œredisæ‰€åœ¨æœåŠ¡å™¨</strong></p><p><strong>ä¸ºäº†ç®€åŒ–æµ‹è¯•ï¼Œäº‹å…ˆè§„å®šå¥½mysql</strong><code>(192.168.90.14)</code>å’Œredis<code>(192.168.90.15)</code>æœåŠ¡å™¨çš„åœ°å€</p><p><strong>åˆ›å»ºpod-initcontainer.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-initcontainer</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">main-container</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.17.1</span></span><br><span class="line">    <span class="attr">ports:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">  <span class="attr">initContainers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">test-mysql</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:1.30</span></span><br><span class="line">    <span class="attr">command:</span> [<span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>, <span class="string">&#x27;until ping 192.168.90.14 -c 1 ; do echo waiting for mysql...; sleep 2; done;&#x27;</span>]</span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">test-redis</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:1.30</span></span><br><span class="line">    <span class="attr">command:</span> [<span class="string">&#x27;sh&#x27;</span>, <span class="string">&#x27;-c&#x27;</span>, <span class="string">&#x27;until ping 192.168.90.15 -c 1 ; do echo waiting for reids...; sleep 2; done;&#x27;</span>]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºpod</span></span><br><span class="line">kubectl create -f pod-initcontainer.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹podçŠ¶æ€</span></span><br><span class="line"><span class="comment"># å‘ç°podå¡åœ¨å¯åŠ¨ç¬¬ä¸€ä¸ªåˆå§‹åŒ–å®¹å™¨è¿‡ç¨‹ä¸­ï¼Œåé¢çš„å®¹å™¨ä¸ä¼šè¿è¡Œ</span></span><br><span class="line">kubectl describe pod  pod-initcontainer -n dev</span><br><span class="line">........</span><br><span class="line">Events:</span><br><span class="line">  Type    Reason     Age   From               Message</span><br><span class="line">  ----    ------     ----  ----               -------</span><br><span class="line">  Normal  Scheduled  49s   default-scheduler  Successfully assigned dev/pod-initcontainer to node1</span><br><span class="line">  Normal  Pulled     48s   kubelet, node1     Container image <span class="string">&quot;busybox:1.30&quot;</span> already present on machine</span><br><span class="line">  Normal  Created    48s   kubelet, node1     Created container test-mysql</span><br><span class="line">  Normal  Started    48s   kubelet, node1     Started container test-mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># åŠ¨æ€æŸ¥çœ‹pod</span></span><br><span class="line">kubectl get pods pod-initcontainer -n dev -w</span><br><span class="line"></span><br><span class="line">NAME                             READY   STATUS     RESTARTS   AGE</span><br><span class="line">pod-initcontainer                0/1     Init:0/2   0          15s</span><br><span class="line">pod-initcontainer                0/1     Init:1/2   0          52s</span><br><span class="line">pod-initcontainer                0/1     Init:1/2   0          53s</span><br><span class="line">pod-initcontainer                0/1     PodInitializing   0          89s</span><br><span class="line">pod-initcontainer                1/1     Running           0          90s</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¥ä¸‹æ¥æ–°å¼€ä¸€ä¸ªshellï¼Œä¸ºå½“å‰æœåŠ¡å™¨æ–°å¢ä¸¤ä¸ªipï¼Œè§‚å¯Ÿpodçš„å˜åŒ–</span></span><br><span class="line">ifconfig ens33:1 192.168.90.14 netmask 255.255.255.0 up</span><br><span class="line">ifconfig ens33:2 192.168.90.15 netmask 255.255.255.0 up</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10.1ã€podåˆ›å»ºå’Œåœæ­¢</title>
      <link href="/2024/12/04/10.1%E3%80%81pod%E5%88%9B%E5%BB%BA%E5%92%8C%E5%81%9C%E6%AD%A2/"/>
      <url>/2024/12/04/10.1%E3%80%81pod%E5%88%9B%E5%BB%BA%E5%92%8C%E5%81%9C%E6%AD%A2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="10-1ã€podåˆ›å»ºå’Œåœæ­¢"><a href="#10-1ã€podåˆ›å»ºå’Œåœæ­¢" class="headerlink" title="10.1ã€podåˆ›å»ºå’Œåœæ­¢"></a>10.1ã€podåˆ›å»ºå’Œåœæ­¢</h2><p><strong>podçš„åˆ›å»ºè¿‡ç¨‹</strong></p><ol><li><strong>ç”¨æˆ·é€šè¿‡kubectlæˆ–å…¶ä»–apiå®¢æˆ·ç«¯æäº¤éœ€è¦åˆ›å»ºçš„podä¿¡æ¯ç»™apiServer</strong></li><li><strong>apiServerå¼€å§‹ç”Ÿæˆpodå¯¹è±¡çš„ä¿¡æ¯ï¼Œå¹¶å°†ä¿¡æ¯å­˜å…¥etcdï¼Œç„¶åè¿”å›ç¡®è®¤ä¿¡æ¯è‡³å®¢æˆ·ç«¯</strong></li><li><strong>apiServerå¼€å§‹åæ˜ etcdä¸­çš„podå¯¹è±¡çš„å˜åŒ–ï¼Œå…¶å®ƒç»„ä»¶ä½¿ç”¨watchæœºåˆ¶æ¥è·Ÿè¸ªæ£€æŸ¥apiServerä¸Šçš„å˜åŠ¨</strong></li><li><strong>schedulerå‘ç°æœ‰æ–°çš„podå¯¹è±¡è¦åˆ›å»ºï¼Œå¼€å§‹ä¸ºPodåˆ†é…ä¸»æœºå¹¶å°†ç»“æœä¿¡æ¯æ›´æ–°è‡³apiServer</strong></li><li><strong>nodeèŠ‚ç‚¹ä¸Šçš„kubeletå‘ç°æœ‰podè°ƒåº¦è¿‡æ¥ï¼Œå°è¯•è°ƒç”¨dockerå¯åŠ¨å®¹å™¨ï¼Œå¹¶å°†ç»“æœå›é€è‡³apiServer</strong></li><li><strong>apiServerå°†æ¥æ”¶åˆ°çš„podçŠ¶æ€ä¿¡æ¯å­˜å…¥etcdä¸­</strong></li></ol><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_9516d9c15d037af232b1f94ed0f31438.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_9516d9c15d037af232b1f94ed0f31438.png"></p><p><strong>podçš„ç»ˆæ­¢è¿‡ç¨‹</strong></p><ol><li><strong>ç”¨æˆ·å‘apiServerå‘é€åˆ é™¤podå¯¹è±¡çš„å‘½ä»¤</strong></li><li><strong>apiServcerä¸­çš„podå¯¹è±¡ä¿¡æ¯ä¼šéšç€æ—¶é—´çš„æ¨ç§»è€Œæ›´æ–°ï¼Œåœ¨å®½é™æœŸå†…ï¼ˆé»˜è®¤30sï¼‰ï¼Œpodè¢«è§†ä¸ºdead</strong></li><li><strong>å°†podæ ‡è®°ä¸ºterminatingçŠ¶æ€</strong></li><li><strong>kubeletåœ¨ç›‘æ§åˆ°podå¯¹è±¡è½¬ä¸ºterminatingçŠ¶æ€çš„åŒæ—¶å¯åŠ¨podå…³é—­è¿‡ç¨‹</strong></li><li><strong>ç«¯ç‚¹æ§åˆ¶å™¨ç›‘æ§åˆ°podå¯¹è±¡çš„å…³é—­è¡Œä¸ºæ—¶å°†å…¶ä»æ‰€æœ‰åŒ¹é…åˆ°æ­¤ç«¯ç‚¹çš„serviceèµ„æºçš„ç«¯ç‚¹åˆ—è¡¨ä¸­ç§»é™¤</strong></li><li><strong>å¦‚æœå½“å‰podå¯¹è±¡å®šä¹‰äº†preStopé’©å­å¤„ç†å™¨ï¼Œåˆ™åœ¨å…¶æ ‡è®°ä¸ºterminatingåå³ä¼šä»¥åŒæ­¥çš„æ–¹å¼å¯åŠ¨æ‰§è¡Œ</strong></li><li><strong>podå¯¹è±¡ä¸­çš„å®¹å™¨è¿›ç¨‹æ”¶åˆ°åœæ­¢ä¿¡å·</strong></li><li><strong>å®½é™æœŸç»“æŸåï¼Œè‹¥podä¸­è¿˜å­˜åœ¨ä»åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œé‚£ä¹ˆpodå¯¹è±¡ä¼šæ”¶åˆ°ç«‹å³ç»ˆæ­¢çš„ä¿¡å·</strong></li><li><strong>kubeletè¯·æ±‚apiServerå°†æ­¤podèµ„æºçš„å®½é™æœŸè®¾ç½®ä¸º0ä»è€Œå®Œæˆåˆ é™¤æ“ä½œï¼Œæ­¤æ—¶podå¯¹äºç”¨æˆ·å·²ä¸å¯è§</strong></li></ol>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10ã€Podç”Ÿå‘½å‘¨æœŸ</title>
      <link href="/2024/12/04/10%E3%80%81Pod%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"/>
      <url>/2024/12/04/10%E3%80%81Pod%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="10ã€Podç”Ÿå‘½å‘¨æœŸ"><a href="#10ã€Podç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="10ã€Podç”Ÿå‘½å‘¨æœŸ"></a>10ã€Podç”Ÿå‘½å‘¨æœŸ</h2><h4 id="Podç”Ÿå‘½å‘¨æœŸ"><a href="#Podç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Podç”Ÿå‘½å‘¨æœŸ"></a>Podç”Ÿå‘½å‘¨æœŸ</h4><p><strong>æˆ‘ä»¬ä¸€èˆ¬å°†podå¯¹è±¡ä»åˆ›å»ºè‡³ç»ˆçš„è¿™æ®µæ—¶é—´èŒƒå›´ç§°ä¸ºpodçš„ç”Ÿå‘½å‘¨æœŸï¼Œå®ƒä¸»è¦åŒ…å«ä¸‹é¢çš„è¿‡ç¨‹ï¼š</strong></p><ul><li><p><strong>podåˆ›å»ºè¿‡ç¨‹</strong></p></li><li><p><strong>è¿è¡Œåˆå§‹åŒ–å®¹å™¨ï¼ˆinit containerï¼‰è¿‡ç¨‹</strong></p></li><li><p><strong>è¿è¡Œä¸»å®¹å™¨ï¼ˆmain containerï¼‰</strong></p><ul><li><strong>å®¹å™¨å¯åŠ¨åé’©å­ï¼ˆpost startï¼‰ã€å®¹å™¨ç»ˆæ­¢å‰é’©å­ï¼ˆpre stopï¼‰</strong></li><li><strong>å®¹å™¨çš„å­˜æ´»æ€§æ¢æµ‹ï¼ˆliveness probeï¼‰ã€å°±ç»ªæ€§æ¢æµ‹ï¼ˆreadiness probeï¼‰</strong></li></ul></li><li><p><strong>podç»ˆæ­¢è¿‡ç¨‹</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_373e4ff02d0b24e0ea4ed3bce107200a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_373e4ff02d0b24e0ea4ed3bce107200a.png"></p></li></ul><p>åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­ï¼ŒPodä¼šå‡ºç°5ç§<strong><strong>çŠ¶æ€</strong></strong>ï¼ˆ<strong><strong>ç›¸ä½</strong></strong>ï¼‰ï¼Œåˆ†åˆ«å¦‚ä¸‹ï¼š</p><ul><li><strong>æŒ‚èµ·ï¼ˆPendingï¼‰ï¼šapiserverå·²ç»åˆ›å»ºäº†podèµ„æºå¯¹è±¡ï¼Œä½†å®ƒå°šæœªè¢«è°ƒåº¦å®Œæˆæˆ–è€…ä»å¤„äºä¸‹è½½é•œåƒçš„è¿‡ç¨‹ä¸­</strong></li><li><strong>è¿è¡Œä¸­ï¼ˆRunningï¼‰ï¼špodå·²ç»è¢«è°ƒåº¦è‡³æŸèŠ‚ç‚¹ï¼Œå¹¶ä¸”æ‰€æœ‰å®¹å™¨éƒ½å·²ç»è¢«kubeletåˆ›å»ºå®Œæˆ</strong></li><li><strong>æˆåŠŸï¼ˆSucceededï¼‰ï¼špodä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½å·²ç»æˆåŠŸç»ˆæ­¢å¹¶ä¸”ä¸ä¼šè¢«é‡å¯</strong></li><li><strong>å¤±è´¥ï¼ˆFailedï¼‰ï¼šæ‰€æœ‰å®¹å™¨éƒ½å·²ç»ç»ˆæ­¢ï¼Œä½†è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨ç»ˆæ­¢å¤±è´¥ï¼Œå³å®¹å™¨è¿”å›äº†é0å€¼çš„é€€å‡ºçŠ¶æ€</strong></li><li><strong>æœªçŸ¥ï¼ˆUnknownï¼‰ï¼šapiserveræ— æ³•æ­£å¸¸è·å–åˆ°podå¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯ï¼Œé€šå¸¸ç”±ç½‘ç»œé€šä¿¡å¤±è´¥æ‰€å¯¼è‡´</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9.6ã€èµ„æºé…é¢ï¼ˆlimitsï¼‰</title>
      <link href="/2024/12/04/9.6%E3%80%81%E8%B5%84%E6%BA%90%E9%85%8D%E9%A2%9D%EF%BC%88limits%EF%BC%89/"/>
      <url>/2024/12/04/9.6%E3%80%81%E8%B5%84%E6%BA%90%E9%85%8D%E9%A2%9D%EF%BC%88limits%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="9-6ã€èµ„æºé…é¢ï¼ˆlimitsï¼‰"><a href="#9-6ã€èµ„æºé…é¢ï¼ˆlimitsï¼‰" class="headerlink" title="9.6ã€èµ„æºé…é¢ï¼ˆlimitsï¼‰"></a>9.6ã€èµ„æºé…é¢ï¼ˆlimitsï¼‰</h2><h5 id="5-2-6-èµ„æºé…é¢ï¼ˆdcokerç±»ä¼¼ï¼‰"><a href="#5-2-6-èµ„æºé…é¢ï¼ˆdcokerç±»ä¼¼ï¼‰" class="headerlink" title="5.2.6 èµ„æºé…é¢ï¼ˆdcokerç±»ä¼¼ï¼‰"></a>5.2.6 èµ„æºé…é¢ï¼ˆdcokerç±»ä¼¼ï¼‰</h5><p><strong>å®¹å™¨ä¸­çš„ç¨‹åºè¦è¿è¡Œï¼Œè‚¯å®šæ˜¯è¦å ç”¨ä¸€å®šèµ„æºçš„ï¼Œæ¯”å¦‚</strong> cpu** å’Œå†…å­˜ç­‰ï¼Œå¦‚æœä¸å¯¹æŸä¸ªå®¹å™¨çš„èµ„æºåšé™åˆ¶ï¼Œé‚£ä¹ˆå®ƒå°±å¯èƒ½åƒæ‰å¤§é‡èµ„æºï¼Œå¯¼è‡´å…¶å®ƒå®¹å™¨æ— æ³•è¿è¡Œã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œ**kubernetes <strong>æä¾›äº†å¯¹å†…å­˜å’Œ <strong>cpu</strong> çš„èµ„æºè¿›è¡Œé…é¢çš„æœºåˆ¶ï¼Œè¿™ç§æœºåˆ¶ä¸»è¦é€šè¿‡</strong> resources <strong>é€‰é¡¹å®ç°ï¼Œä»–æœ‰ä¸¤ä¸ªå­é€‰é¡¹ï¼š</strong></p><ul><li>limitsï¼šç”¨äºé™åˆ¶è¿è¡Œæ—¶å®¹å™¨çš„æœ€å¤§å ç”¨èµ„æºï¼Œå½“å®¹å™¨å ç”¨èµ„æºè¶…è¿‡limitsæ—¶ä¼šè¢«ç»ˆæ­¢ï¼Œå¹¶è¿›è¡Œé‡å¯</li><li>requests ï¼šç”¨äºè®¾ç½®å®¹å™¨éœ€è¦çš„æœ€å°èµ„æºï¼Œå¦‚æœç¯å¢ƒèµ„æºä¸å¤Ÿï¼Œå®¹å™¨å°†æ— æ³•å¯åŠ¨</li></ul><p><strong>å¯ä»¥é€šè¿‡ä¸Šé¢ä¸¤ä¸ªé€‰é¡¹è®¾ç½®èµ„æºçš„ä¸Šä¸‹é™ã€‚</strong></p><p>æ¥ä¸‹æ¥ï¼Œç¼–å†™ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼Œåˆ›å»º pod-resources.yaml</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-resources</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> <span class="comment"># nginx:1.17.1</span></span><br><span class="line">    <span class="attr">resources:</span>   <span class="comment"># èµ„æºé…é¢</span></span><br><span class="line">      <span class="attr">limits:</span>    <span class="comment"># é™åˆ¶èµ„æºï¼ˆä¸Šé™ï¼‰</span></span><br><span class="line">        <span class="attr">cpu:</span> <span class="string">&quot;2&quot;</span> <span class="comment"># CPUé™åˆ¶ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">&quot;10Gi&quot;</span> <span class="comment"># å†…å­˜é™åˆ¶</span></span><br><span class="line">      <span class="attr">requests:</span>        <span class="comment"># è¯·æ±‚èµ„æºï¼ˆä¸‹é™ï¼‰</span></span><br><span class="line">        <span class="attr">cpu:</span> <span class="string">&quot;1&quot;</span>       <span class="comment"># CPUé™åˆ¶ï¼Œå•ä½æ˜¯coreæ•°</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">&quot;10Mi&quot;</span> <span class="comment"># å†…å­˜é™åˆ¶</span></span><br></pre></td></tr></table></figure><p><strong>dockerä¾‹å­èµ„æºé…é¢é™åˆ¶åˆ™ä¸ºï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span>  </span><br><span class="line">  <span class="attr">openvpn:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">kylemanna/openvpn</span></span><br><span class="line">           <span class="comment"># registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:kylemanna_openvpn-v1</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">openvpn</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;21194:1194/udp&quot;</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./openvpn-data:/etc/openvpn</span></span><br><span class="line">    <span class="attr">cap_add:</span> </span><br><span class="line">      <span class="bullet">-</span> <span class="string">NET_ADMIN</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">limits:</span></span><br><span class="line">          <span class="attr">cpus:</span> <span class="string">&quot;1&quot;</span></span><br><span class="line">          <span class="attr">memory:</span> <span class="string">100M</span></span><br><span class="line">        <span class="attr">reservations:</span></span><br><span class="line">          <span class="attr">cpus:</span> <span class="string">&#x27;0.1&#x27;</span></span><br><span class="line">          <span class="attr">memory:</span> <span class="string">100M</span></span><br></pre></td></tr></table></figure><p><strong>åœ¨è¿™å¯¹cpuå’Œmemoryçš„å•ä½åšä¸€ä¸ªè¯´æ˜ï¼š</strong></p><ul><li><strong>cpuï¼šcoreæ•°ï¼Œå¯ä»¥ä¸ºæ•´æ•°æˆ–å°æ•°</strong></li><li><strong>memoryï¼š å†…å­˜å¤§å°ï¼Œå¯ä»¥ä½¿ç”¨Giã€Miã€Gã€Mç­‰å½¢å¼</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿è¡ŒPod</span></span><br><span class="line">kubectl create  -f pod-resources.yaml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å‘ç°podè¿è¡Œæ­£å¸¸</span></span><br><span class="line">kubectl get pod pod-resources -n dev </span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¥ä¸‹æ¥ï¼Œåœæ­¢Pod</span></span><br><span class="line">kubectl delete  -f pod-resources.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼–è¾‘podï¼Œä¿®æ”¹resources.requests.memoryçš„å€¼ä¸º10Gi</span></span><br><span class="line">vim pod-resources.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†æ¬¡å¯åŠ¨pod</span></span><br><span class="line">kubectl create  -f pod-resources.yaml</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹PodçŠ¶æ€ï¼Œå‘ç°Podå¯åŠ¨å¤±è´¥</span></span><br><span class="line">kubectl get pod pod-resources -n dev -o wide</span><br><span class="line"></span><br><span class="line">NAME            READY   STATUS    RESTARTS   AGE    </span><br><span class="line">pod-resources   0/1     Pending   0          20s  </span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹podè¯¦æƒ…ä¼šå‘ç°ï¼Œå¦‚ä¸‹æç¤º</span></span><br><span class="line">kubectl describe pod pod-resources -n dev</span><br><span class="line">......</span><br><span class="line">Warning  FailedScheduling  35s   default-scheduler  0/3 nodes are available: 1 node(s) had taint &#123;node-role.kubernetes.io/master: &#125;, that the pod didn<span class="string">&#x27;t tolerate, 2 Insufficient memory.(å†…å­˜ä¸è¶³)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9.5ã€ç«¯å£é…ç½®ï¼ˆportsï¼‰</title>
      <link href="/2024/12/04/9.5%E3%80%81%E7%AB%AF%E5%8F%A3%E9%85%8D%E7%BD%AE%EF%BC%88ports%EF%BC%89/"/>
      <url>/2024/12/04/9.5%E3%80%81%E7%AB%AF%E5%8F%A3%E9%85%8D%E7%BD%AE%EF%BC%88ports%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="9-5ã€ç«¯å£é…ç½®ï¼ˆportsï¼‰"><a href="#9-5ã€ç«¯å£é…ç½®ï¼ˆportsï¼‰" class="headerlink" title="9.5ã€ç«¯å£é…ç½®ï¼ˆportsï¼‰"></a>9.5ã€ç«¯å£é…ç½®ï¼ˆportsï¼‰</h2><h5 id="5-2-5-ç«¯å£è®¾ç½®"><a href="#5-2-5-ç«¯å£è®¾ç½®" class="headerlink" title="5.2.5 ç«¯å£è®¾ç½®"></a>5.2.5 ç«¯å£è®¾ç½®</h5><p>æœ¬å°èŠ‚æ¥ä»‹ç»å®¹å™¨çš„ç«¯å£è®¾ç½®ï¼Œä¹Ÿå°±æ˜¯ containers çš„ ports <strong>é€‰é¡¹ã€‚</strong></p><p><strong>é¦–å…ˆçœ‹ä¸‹portsæ”¯æŒçš„å­é€‰é¡¹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s-master01 ~]<span class="comment"># kubectl explain pod.spec.containers.ports</span></span><br><span class="line">KIND:     Pod</span><br><span class="line">VERSION:  v1</span><br><span class="line">RESOURCE: ports &lt;[]Object&gt;</span><br><span class="line">FIELDS:</span><br><span class="line">   name         &lt;string&gt;  <span class="comment"># ç«¯å£åç§°ï¼Œå¦‚æœæŒ‡å®šï¼Œå¿…é¡»ä¿è¯nameåœ¨podä¸­æ˜¯å”¯ä¸€çš„</span></span><br><span class="line">   containerPort&lt;<span class="built_in">integer</span>&gt; <span class="comment"># å®¹å™¨è¦ç›‘å¬çš„ç«¯å£(0&lt;x&lt;65536)</span></span><br><span class="line">   hostPort     &lt;<span class="built_in">integer</span>&gt; <span class="comment"># å®¹å™¨è¦åœ¨ä¸»æœºä¸Šå…¬å¼€çš„ç«¯å£ï¼Œå¦‚æœè®¾ç½®ï¼Œä¸»æœºä¸Šåªèƒ½è¿è¡Œå®¹å™¨çš„ä¸€ä¸ªå‰¯æœ¬(ä¸€èˆ¬çœç•¥) </span></span><br><span class="line">   hostIP       &lt;string&gt;  <span class="comment"># è¦å°†å¤–éƒ¨ç«¯å£ç»‘å®šåˆ°çš„ä¸»æœºIP(ä¸€èˆ¬çœç•¥)</span></span><br><span class="line">   protocol     &lt;string&gt;  <span class="comment"># ç«¯å£åè®®ã€‚å¿…é¡»æ˜¯UDPã€TCPæˆ–SCTPã€‚é»˜è®¤ä¸ºâ€œTCPâ€ã€‚</span></span><br></pre></td></tr></table></figure><p><strong>æ¥ä¸‹æ¥ï¼Œç¼–å†™ä¸€ä¸ªæµ‹è¯•æ¡ˆä¾‹ï¼Œåˆ›å»º pod-ports.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-ports</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span> <span class="comment"># nginx:1.17.1</span></span><br><span class="line">    <span class="attr">ports:</span> <span class="comment"># è®¾ç½®å®¹å™¨æš´éœ²çš„ç«¯å£åˆ—è¡¨</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">kubectl create -f pod-ports.yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹pod</span></span><br><span class="line"><span class="comment"># åœ¨ä¸‹é¢å¯ä»¥æ˜æ˜¾çœ‹åˆ°é…ç½®ä¿¡æ¯</span></span><br><span class="line">kubectl get pod pod-ports -n dev -o yaml</span><br><span class="line">......</span><br><span class="line">spec:</span><br><span class="line">  containers:</span><br><span class="line">  - image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span><br><span class="line">    imagePullPolicy: IfNotPresent</span><br><span class="line">    name: nginx</span><br><span class="line">    ports:</span><br><span class="line">    - containerPort: 80</span><br><span class="line">      name: nginx-port</span><br><span class="line">      protocol: TCP</span><br><span class="line">......</span><br></pre></td></tr></table></figure><p><strong>è®¿é—®å®¹å™¨ä¸­çš„ç¨‹åºéœ€è¦ä½¿ç”¨çš„æ˜¯</strong><code>Podip:containerPort</code></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9.4ã€ç¯å¢ƒå˜é‡ï¼ˆenvï¼‰</title>
      <link href="/2024/12/04/9.4%E3%80%81%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%EF%BC%88env%EF%BC%89/"/>
      <url>/2024/12/04/9.4%E3%80%81%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%EF%BC%88env%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="9-4ã€ç¯å¢ƒå˜é‡ï¼ˆenvï¼‰"><a href="#9-4ã€ç¯å¢ƒå˜é‡ï¼ˆenvï¼‰" class="headerlink" title="9.4ã€ç¯å¢ƒå˜é‡ï¼ˆenvï¼‰"></a>9.4ã€ç¯å¢ƒå˜é‡ï¼ˆenvï¼‰</h2><h3 id="1ã€åˆ›å»ºpod-env-yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š"><a href="#1ã€åˆ›å»ºpod-env-yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š" class="headerlink" title="1ã€åˆ›å»ºpod-env.yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š"></a>1ã€åˆ›å»ºpod-env.yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-env</span>    <span class="comment"># podåç§°</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>   <span class="comment"># ns</span></span><br><span class="line">  <span class="attr">labels:</span>          <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">&quot;3.0&quot;</span> </span><br><span class="line">    <span class="attr">env:</span> <span class="string">&quot;busybox&quot;</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:busybox-1.30</span> <span class="comment">#busybox:1.30</span></span><br><span class="line">    <span class="attr">imagePullPolicy:</span> <span class="string">Always</span>  <span class="comment"># é•œåƒæ‹‰å–ç­–ç•¥</span></span><br><span class="line">    <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;while true;do /bin/echo $(date +%T);sleep 60; done;&quot;</span>]</span><br><span class="line">    <span class="attr">env:</span>                     <span class="comment"># è®¾ç½®ç¯å¢ƒå˜é‡åˆ—è¡¨</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;username&quot;</span></span><br><span class="line">      <span class="attr">value:</span> <span class="string">&quot;admin&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">&quot;password&quot;</span></span><br><span class="line">      <span class="attr">value:</span> <span class="string">&quot;123456&quot;</span></span><br></pre></td></tr></table></figure><p><strong>å¤‡æ³¨ï¼šenvï¼Œç¯å¢ƒå˜é‡ï¼Œç”¨äºåœ¨podä¸­çš„å®¹å™¨è®¾ç½®ç¯å¢ƒå˜é‡ã€‚</strong></p><h3 id="2ã€éªŒè¯"><a href="#2ã€éªŒè¯" class="headerlink" title="2ã€éªŒè¯"></a>2ã€éªŒè¯</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">kubectl create -f pod-env.yaml</span><br><span class="line"><span class="comment"># è¿›å…¥å®¹å™¨ï¼Œè¾“å‡ºç¯å¢ƒå˜é‡</span></span><br><span class="line">kubectl <span class="built_in">exec</span> pod-env -n dev -c busybox -it /bin/sh</span><br><span class="line">/ <span class="comment"># echo $username</span></span><br><span class="line">admin</span><br><span class="line">/ <span class="comment"># echo $password</span></span><br><span class="line">123456</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹å¼ä¸æ˜¯å¾ˆæ¨èï¼Œæ¨èå°†è¿™äº›é…ç½®å•ç‹¬å­˜å‚¨åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œè¿™ç§æ–¹å¼å°†åœ¨åé¢ä»‹ç»ã€‚**</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_09105f30b43497e9e5af6cd544a09314.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_09105f30b43497e9e5af6cd544a09314.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9.3ã€å¯åŠ¨å‘½ä»¤ï¼ˆcommandï¼‰</title>
      <link href="/2024/12/04/9.3%E3%80%81%E5%90%AF%E5%8A%A8%E5%91%BD%E4%BB%A4%EF%BC%88command%EF%BC%89/"/>
      <url>/2024/12/04/9.3%E3%80%81%E5%90%AF%E5%8A%A8%E5%91%BD%E4%BB%A4%EF%BC%88command%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="9-3ã€å¯åŠ¨å‘½ä»¤ï¼ˆcommandï¼‰"><a href="#9-3ã€å¯åŠ¨å‘½ä»¤ï¼ˆcommandï¼‰" class="headerlink" title="9.3ã€å¯åŠ¨å‘½ä»¤ï¼ˆcommandï¼‰"></a>9.3ã€å¯åŠ¨å‘½ä»¤ï¼ˆcommandï¼‰</h2><p><strong>åœ¨å‰é¢çš„æ¡ˆä¾‹ä¸­ï¼Œä¸€ç›´æœ‰ä¸€ä¸ªé—®é¢˜æ²¡æœ‰è§£å†³ï¼Œå°±æ˜¯çš„busyboxå®¹å™¨ä¸€ç›´æ²¡æœ‰æˆåŠŸè¿è¡Œï¼Œé‚£ä¹ˆåˆ°åº•æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´è¿™ä¸ªå®¹å™¨çš„æ•…éšœå‘¢ï¼Ÿ</strong></p><p><strong>åŸæ¥busyboxå¹¶ä¸æ˜¯ä¸€ä¸ªç¨‹åºï¼Œè€Œæ˜¯ç±»ä¼¼äºä¸€ä¸ªå·¥å…·ç±»çš„é›†åˆï¼Œkubernetesé›†ç¾¤å¯åŠ¨ç®¡ç†åï¼Œå®ƒä¼šè‡ªåŠ¨å…³é—­ã€‚è§£å†³æ–¹æ³•å°±æ˜¯è®©å…¶ä¸€ç›´åœ¨è¿è¡Œï¼Œè¿™å°±ç”¨åˆ°äº†commandé…ç½®ã€‚</strong></p><h3 id="1ã€åˆ›å»ºpod-command-yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š"><a href="#1ã€åˆ›å»ºpod-command-yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š" class="headerlink" title="1ã€åˆ›å»ºpod-command.yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š"></a>1ã€åˆ›å»ºpod-command.yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</h3><ul><li><strong>æ–‡ä»¶ä¸­é•œåƒæ‹‰å–ç­–ç•¥å¯¹æœ¬æ–‡ä»¶æ‰€æœ‰é•œåƒæ‹‰å–æœ‰æ•ˆ</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-command</span>  <span class="comment"># podåç§°</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.17.1</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:busybox-1.30</span> <span class="comment">#busybox:1.30</span></span><br><span class="line">    <span class="attr">imagePullPolicy:</span> <span class="string">Never</span> <span class="comment"># ç”¨äºè®¾ç½®é•œåƒæ‹‰å–ç­–ç•¥</span></span><br><span class="line">    <span class="attr">command:</span> [<span class="string">&quot;/bin/sh&quot;</span>,<span class="string">&quot;-c&quot;</span>,<span class="string">&quot;touch /tmp/hello.txt;while true;do /bin/echo $(date +%T) &gt;&gt; /tmp/hello.txt; sleep 3; done;&quot;</span>]</span><br></pre></td></tr></table></figure><p><strong>commandï¼Œç”¨äºåœ¨podä¸­çš„å®¹å™¨åˆå§‹åŒ–å®Œæ¯•ä¹‹åè¿è¡Œä¸€ä¸ªå‘½ä»¤ã€‚</strong></p><p><strong>ç¨å¾®è§£é‡Šä¸‹ä¸Šé¢å‘½ä»¤çš„æ„æ€ï¼š</strong></p><p><strong>â€œ/bin/shâ€,â€-câ€, ä½¿ç”¨shæ‰§è¡Œå‘½ä»¤</strong></p><p><strong>touch /tmp/hello.txt; åˆ›å»ºä¸€ä¸ª/tmp/hello.txt æ–‡ä»¶</strong></p><p><strong>while true;do /bin/echo $(date +%T) &gt;&gt; /tmp/hello.txt; sleep 3; done; æ¯éš”3ç§’å‘æ–‡ä»¶ä¸­å†™å…¥å½“å‰æ—¶é—´</strong></p><h3 id="2ã€éªŒè¯å‘½ä»¤æ˜¯å¦ç”Ÿæ•ˆï¼š"><a href="#2ã€éªŒè¯å‘½ä»¤æ˜¯å¦ç”Ÿæ•ˆï¼š" class="headerlink" title="2ã€éªŒè¯å‘½ä»¤æ˜¯å¦ç”Ÿæ•ˆï¼š"></a>2ã€éªŒè¯å‘½ä»¤æ˜¯å¦ç”Ÿæ•ˆï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">[root@k8s-master01 pod]<span class="comment"># kubectl create  -f pod-command.yaml</span></span><br><span class="line">pod/pod-command created</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹PodçŠ¶æ€</span></span><br><span class="line"><span class="comment"># æ­¤æ—¶å‘ç°ä¸¤ä¸ªpodéƒ½æ­£å¸¸è¿è¡Œäº†</span></span><br><span class="line">[root@k8s-master01 pod]<span class="comment"># kubectl get pods pod-command -n dev</span></span><br><span class="line">NAME          READY   STATUS   RESTARTS   AGE</span><br><span class="line">pod-command   2/2     Runing   0          2s</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿›å…¥podä¸­çš„busyboxå®¹å™¨ï¼ŒæŸ¥çœ‹æ–‡ä»¶å†…å®¹</span></span><br><span class="line"><span class="comment"># è¡¥å……ä¸€ä¸ªå‘½ä»¤: kubectl exec  podåç§° -n å‘½åç©ºé—´ -it -c å®¹å™¨åç§° /bin/sh  åœ¨å®¹å™¨å†…éƒ¨æ‰§è¡Œå‘½ä»¤</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å°±å¯ä»¥è¿›å…¥æŸä¸ªå®¹å™¨çš„å†…éƒ¨ï¼Œç„¶åè¿›è¡Œç›¸å…³æ“ä½œäº†</span></span><br><span class="line"><span class="comment"># æ¯”å¦‚ï¼Œå¯ä»¥æŸ¥çœ‹txtæ–‡ä»¶çš„å†…å®¹</span></span><br><span class="line">[root@k8s-master01 pod]<span class="comment"># kubectl exec pod-command -n dev -it -c busybox /bin/sh</span></span><br><span class="line">/ <span class="comment"># tail -f /tmp/hello.txt</span></span><br><span class="line">14:44:19</span><br><span class="line">14:44:22</span><br><span class="line">14:44:25</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_15b91bcf5510e0501dd3ca636f492e47.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_15b91bcf5510e0501dd3ca636f492e47.png"></p><p><strong>ç‰¹åˆ«è¯´æ˜ï¼š</strong></p><p>é€šè¿‡ä¸Šé¢å‘ç°commandå·²ç»å¯ä»¥å®Œæˆå¯åŠ¨å‘½ä»¤å’Œä¼ é€’å‚æ•°çš„åŠŸèƒ½ï¼Œä¸ºä»€ä¹ˆè¿™é‡Œè¿˜è¦æä¾›ä¸€ä¸ªargsé€‰é¡¹ï¼Œç”¨äºä¼ é€’å‚æ•°å‘¢?è¿™å…¶å®è·Ÿdockeræœ‰ç‚¹å…³ç³»ï¼Œkubernetesä¸­çš„commandã€argsä¸¤é¡¹å…¶å®æ˜¯å®ç°è¦†ç›–Dockerfileä¸­ENTRYPOINTçš„åŠŸèƒ½ã€‚</p><ul><li>å¦‚æœ<strong>command</strong>å’Œ<strong>args</strong>å‡æ²¡æœ‰å†™ï¼Œé‚£ä¹ˆç”¨Dockerfileçš„é…ç½®ã€‚</li><li>å¦‚æœcommandå†™äº†ï¼Œä½†argsæ²¡æœ‰å†™ï¼Œé‚£ä¹ˆDockerfileé»˜è®¤çš„é…ç½®ä¼šè¢«å¿½ç•¥ï¼Œæ‰§è¡Œè¾“å…¥çš„command</li><li>å¦‚æœcommandæ²¡å†™ï¼Œä½†argså†™äº†ï¼Œé‚£ä¹ˆDockerfileä¸­é…ç½®çš„ENTRYPOINTçš„å‘½ä»¤ä¼šè¢«æ‰§è¡Œï¼Œä½¿ç”¨å½“å‰argsçš„å‚æ•°</li><li><strong>å¦‚æœcommandå’Œargséƒ½å†™äº†ï¼Œé‚£ä¹ˆDockerfileçš„é…ç½®è¢«å¿½ç•¥ï¼Œæ‰§è¡Œcommandå¹¶è¿½åŠ ä¸Šargså‚æ•°</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9.2ã€é•œåƒæ‹‰å–ç­–ç•¥ï¼ˆimagePullPolicyï¼‰</title>
      <link href="/2024/12/04/9.2%E3%80%81%E9%95%9C%E5%83%8F%E6%8B%89%E5%8F%96%E7%AD%96%E7%95%A5%EF%BC%88imagePullPolicy%EF%BC%89/"/>
      <url>/2024/12/04/9.2%E3%80%81%E9%95%9C%E5%83%8F%E6%8B%89%E5%8F%96%E7%AD%96%E7%95%A5%EF%BC%88imagePullPolicy%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="9-2ã€é•œåƒæ‹‰å–ç­–ç•¥ï¼ˆimagePullPolicyï¼‰"><a href="#9-2ã€é•œåƒæ‹‰å–ç­–ç•¥ï¼ˆimagePullPolicyï¼‰" class="headerlink" title="9.2ã€é•œåƒæ‹‰å–ç­–ç•¥ï¼ˆimagePullPolicyï¼‰"></a>9.2ã€é•œåƒæ‹‰å–ç­–ç•¥ï¼ˆimagePullPolicyï¼‰</h2><p><strong>åˆ›å»º pod-imagepullpolicy.yaml æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-imagepullpolicy</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.17.1</span></span><br><span class="line">    <span class="attr">imagePullPolicy:</span> <span class="string">Never</span> <span class="comment"># ç”¨äºè®¾ç½®é•œåƒæ‹‰å–ç­–ç•¥</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">busybox</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:busybox-1.30</span> <span class="comment"># busybox:1.30</span></span><br></pre></td></tr></table></figure><p><strong>imagePullPolicyï¼Œç”¨äºè®¾ç½®é•œåƒæ‹‰å–ç­–ç•¥ï¼Œkubernetesæ”¯æŒé…ç½®ä¸‰ç§æ‹‰å–ç­–ç•¥ï¼š</strong></p><ul><li>Alwaysï¼šæ€»æ˜¯ä»è¿œç¨‹ä»“åº“æ‹‰å–é•œåƒï¼ˆä¸€ç›´è¿œç¨‹ä¸‹è½½ï¼‰</li><li>IfNotPresentï¼šæœ¬åœ°æœ‰åˆ™ä½¿ç”¨æœ¬åœ°é•œåƒï¼Œæœ¬åœ°æ²¡æœ‰åˆ™ä»è¿œç¨‹ä»“åº“æ‹‰å–é•œåƒï¼ˆæœ¬åœ°æœ‰å°±æœ¬åœ° æœ¬åœ°æ²¡è¿œç¨‹ä¸‹è½½ï¼‰</li><li>Neverï¼šåªä½¿ç”¨æœ¬åœ°é•œåƒï¼Œä»ä¸å»è¿œç¨‹ä»“åº“æ‹‰å–ï¼Œæœ¬åœ°æ²¡æœ‰å°±æŠ¥é”™ ï¼ˆä¸€ç›´ä½¿ç”¨æœ¬åœ°ï¼‰</li></ul><p><strong>é»˜è®¤å€¼è¯´æ˜ï¼š</strong></p><p><strong>å¦‚æœé•œåƒtagä¸ºå…·ä½“ç‰ˆæœ¬å·ï¼Œ é»˜è®¤ç­–ç•¥æ˜¯ï¼šIfNotPresent</strong></p><p>å¦‚æœé•œåƒtagä¸ºï¼šlatestï¼ˆæœ€ç»ˆç‰ˆæœ¬ï¼‰ ï¼Œé»˜è®¤ç­–ç•¥æ˜¯always</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">[root@k8s-master01 pod]<span class="comment"># kubectl create -f pod-imagepullpolicy.yaml</span></span><br><span class="line">pod/pod-imagepullpolicy created</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹Podè¯¦æƒ…</span></span><br><span class="line"><span class="comment"># æ­¤æ—¶æ˜æ˜¾å¯ä»¥çœ‹åˆ°nginxé•œåƒæœ‰ä¸€æ­¥Pulling image &quot;nginx:1.17.1&quot;çš„è¿‡ç¨‹</span></span><br><span class="line">[root@k8s-master01 pod]<span class="comment"># kubectl describe pod pod-imagepullpolicy -n dev</span></span><br><span class="line">......</span><br><span class="line">Events:</span><br><span class="line">  Type     Reason     Age               From               Message</span><br><span class="line">  ----     ------     ----              ----               -------</span><br><span class="line">  Normal   Scheduled  &lt;unknown&gt;         default-scheduler  Successfully assigned dev/pod-imagePullPolicy to node1</span><br><span class="line">  Normal   Pulling    32s               kubelet, node1     Pulling image <span class="string">&quot;nginx:1.17.1&quot;</span></span><br><span class="line">  Normal   Pulled     26s               kubelet, node1     Successfully pulled image <span class="string">&quot;nginx:1.17.1&quot;</span></span><br><span class="line">  Normal   Created    26s               kubelet, node1     Created container nginx</span><br><span class="line">  Normal   Started    25s               kubelet, node1     Started container nginx</span><br><span class="line">  Normal   Pulled     7s (x3 over 25s)  kubelet, node1     Container image <span class="string">&quot;busybox:1.30&quot;</span> already present on machine</span><br><span class="line">  Normal   Created    7s (x3 over 25s)  kubelet, node1     Created container busybox</span><br><span class="line">  Normal   Started    7s (x3 over 25s)  kubelet, node1     Started container busybox</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9.1ã€Podçš„é…ç½®ï¼ˆpod.spec.containersï¼‰</title>
      <link href="/2024/12/04/9.1%E3%80%81Pod%E7%9A%84%E9%85%8D%E7%BD%AE%EF%BC%88pod.spec.containers%EF%BC%89/"/>
      <url>/2024/12/04/9.1%E3%80%81Pod%E7%9A%84%E9%85%8D%E7%BD%AE%EF%BC%88pod.spec.containers%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="9-1ã€Podçš„é…ç½®ï¼ˆpod-spec-containersï¼‰"><a href="#9-1ã€Podçš„é…ç½®ï¼ˆpod-spec-containersï¼‰" class="headerlink" title="9.1ã€Podçš„é…ç½®ï¼ˆpod.spec.containersï¼‰"></a>9.1ã€Podçš„é…ç½®ï¼ˆpod.spec.containersï¼‰</h2><p><strong>æœ¬å°èŠ‚ä¸»è¦æ¥ç ”ç©¶</strong><code>pod.spec.containers</code>å±æ€§ï¼Œè¿™ä¹Ÿæ˜¯podé…ç½®ä¸­æœ€ä¸ºå…³é”®çš„ä¸€é¡¹é…ç½®ã€‚</p><h2 id="ä¸€-æœ¬å°èŠ‚ä¸»è¦æ¥ç ”ç©¶pod-spec-containerså±æ€§ï¼Œè¿™ä¹Ÿæ˜¯podé…ç½®ä¸­æœ€ä¸ºå…³é”®çš„ä¸€é¡¹é…ç½®ã€‚"><a href="#ä¸€-æœ¬å°èŠ‚ä¸»è¦æ¥ç ”ç©¶pod-spec-containerså±æ€§ï¼Œè¿™ä¹Ÿæ˜¯podé…ç½®ä¸­æœ€ä¸ºå…³é”®çš„ä¸€é¡¹é…ç½®ã€‚" class="headerlink" title="ä¸€. æœ¬å°èŠ‚ä¸»è¦æ¥ç ”ç©¶pod.spec.containerså±æ€§ï¼Œè¿™ä¹Ÿæ˜¯podé…ç½®ä¸­æœ€ä¸ºå…³é”®çš„ä¸€é¡¹é…ç½®ã€‚"></a>ä¸€. æœ¬å°èŠ‚ä¸»è¦æ¥ç ”ç©¶<code>pod.spec.containers</code>å±æ€§ï¼Œè¿™ä¹Ÿæ˜¯podé…ç½®ä¸­æœ€ä¸ºå…³é”®çš„ä¸€é¡¹é…ç½®ã€‚</h2><h3 id="1-å®šä¹‰"><a href="#1-å®šä¹‰" class="headerlink" title="1. å®šä¹‰"></a>1. <strong>å®šä¹‰</strong></h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ä½¿ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="string">kubectl</span> <span class="string">explain</span> <span class="string">pod.spec.containers</span></span><br><span class="line"></span><br><span class="line"><span class="attr">KIND:</span>     <span class="string">Pod</span></span><br><span class="line"><span class="attr">VERSION:</span>  <span class="string">v1</span></span><br><span class="line"><span class="attr">RESOURCE:</span> <span class="string">containers</span> <span class="string">&lt;[]Object&gt;</span>   <span class="comment"># æ•°ç»„ï¼Œä»£è¡¨å¯ä»¥æœ‰å¤šä¸ªå®¹å™¨</span></span><br><span class="line"><span class="attr">FIELDS:</span></span><br><span class="line">   <span class="string">name</span>  <span class="string">&lt;string&gt;</span>            <span class="comment"># å®¹å™¨åç§°</span></span><br><span class="line">   <span class="string">image</span> <span class="string">&lt;string&gt;</span>            <span class="comment"># å®¹å™¨éœ€è¦çš„é•œåƒåœ°å€</span></span><br><span class="line">   <span class="string">imagePullPolicy</span>  <span class="string">&lt;string&gt;</span> <span class="comment"># é•œåƒæ‹‰å–ç­–ç•¥ </span></span><br><span class="line">   <span class="string">command</span>  <span class="string">&lt;[]string&gt;</span> <span class="comment"># å®¹å™¨çš„å¯åŠ¨å‘½ä»¤åˆ—è¡¨ï¼Œå¦‚ä¸æŒ‡å®šï¼Œä½¿ç”¨æ‰“åŒ…æ—¶ä½¿ç”¨çš„å¯åŠ¨å‘½ä»¤</span></span><br><span class="line">   <span class="string">args</span>     <span class="string">&lt;[]string&gt;</span> <span class="comment"># å®¹å™¨çš„å¯åŠ¨å‘½ä»¤éœ€è¦çš„å‚æ•°åˆ—è¡¨</span></span><br><span class="line">   <span class="string">env</span>      <span class="string">&lt;[]Object&gt;</span> <span class="comment"># å®¹å™¨ç¯å¢ƒå˜é‡çš„é…ç½®</span></span><br><span class="line">   <span class="string">ports</span>    <span class="string">&lt;[]Object&gt;</span>     <span class="comment"># å®¹å™¨éœ€è¦æš´éœ²çš„ç«¯å£å·åˆ—è¡¨</span></span><br><span class="line">   <span class="string">resources</span> <span class="string">&lt;Object&gt;</span>      <span class="comment"># èµ„æºé™åˆ¶å’Œèµ„æºè¯·æ±‚çš„è®¾ç½®</span></span><br></pre></td></tr></table></figure><p><strong>containers &lt;[]Object&gt; å®¹å™¨åˆ—è¡¨ï¼Œç”¨äºå®šä¹‰å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯</strong></p><h3 id="2-åŸºæœ¬é…ç½®"><a href="#2-åŸºæœ¬é…ç½®" class="headerlink" title="2. åŸºæœ¬é…ç½®"></a>2. <strong>åŸºæœ¬é…ç½®</strong></h3><p><strong>åˆ›å»ºpod-base.yamlæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span>          <span class="comment"># å…ƒæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pod-base</span>   <span class="comment"># podåç§°</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>   <span class="comment"># podæ‰€å±çš„å‘½åç©ºé—´</span></span><br><span class="line">  <span class="attr">labels:</span>          <span class="comment"># è‡ªå®šä¹‰æ ‡ç­¾ </span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">heima</span></span><br><span class="line"><span class="attr">spec:</span>              <span class="comment"># è¯¦ç»†æè¿°  </span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span>          <span class="comment"># å®¹å™¨åç§°  </span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:1.17.1</span>  <span class="comment"># å®¹å™¨é•œåƒ </span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">busybox</span>        <span class="comment"># å®¹å™¨åç§°</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:1.30</span>  <span class="comment"># å®¹å™¨é•œåƒ</span></span><br></pre></td></tr></table></figure><p><strong>ä¸Šé¢å®šä¹‰äº†ä¸€ä¸ªæ¯”è¾ƒç®€å•Podçš„é…ç½®ï¼Œé‡Œé¢æœ‰ä¸¤ä¸ªå®¹å™¨ï¼š</strong></p><ul><li><strong>nginxï¼šç”¨1.17.1ç‰ˆæœ¬çš„nginxé•œåƒåˆ›å»ºï¼Œï¼ˆnginxæ˜¯ä¸€ä¸ªè½»é‡çº§webå®¹å™¨ï¼‰</strong></li><li><strong>busyboxï¼šç”¨1.30ç‰ˆæœ¬çš„busyboxé•œåƒåˆ›å»ºï¼Œï¼ˆbusyboxæ˜¯ä¸€ä¸ªå°å·§çš„linuxå‘½ä»¤é›†åˆï¼‰</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPod</span></span><br><span class="line">[<span class="string">root@k8s-master01</span> <span class="string">pod</span>]<span class="comment"># kubectl apply -f pod-base.yaml</span></span><br><span class="line"><span class="string">pod/pod-base</span> <span class="string">created</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹PodçŠ¶å†µ</span></span><br><span class="line"><span class="comment"># READY 1/2 : è¡¨ç¤ºå½“å‰Podä¸­æœ‰2ä¸ªå®¹å™¨ï¼Œå…¶ä¸­1ä¸ªå‡†å¤‡å°±ç»ªï¼Œ1ä¸ªæœªå°±ç»ª</span></span><br><span class="line"><span class="comment"># RESTARTS  : é‡å¯æ¬¡æ•°ï¼Œå› ä¸ºæœ‰1ä¸ªå®¹å™¨æ•…éšœäº†ï¼ŒPodä¸€ç›´åœ¨é‡å¯è¯•å›¾æ¢å¤å®ƒ</span></span><br><span class="line">[<span class="string">root@k8s-master01</span> <span class="string">pod</span>]<span class="comment"># kubectl get pod -n dev</span></span><br><span class="line"><span class="string">NAME</span>       <span class="string">READY</span>   <span class="string">STATUS</span>    <span class="string">RESTARTS</span>   <span class="string">AGE</span></span><br><span class="line"><span class="string">pod-base</span>   <span class="number">1</span><span class="string">/2</span>     <span class="string">Running</span>   <span class="number">4</span>          <span class="string">95s</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯ä»¥é€šè¿‡describeæŸ¥çœ‹å†…éƒ¨çš„è¯¦æƒ…</span></span><br><span class="line"><span class="comment"># æ­¤æ—¶å·²ç»è¿è¡Œèµ·æ¥äº†ä¸€ä¸ªåŸºæœ¬çš„Podï¼Œè™½ç„¶å®ƒæš‚æ—¶æœ‰é—®é¢˜</span></span><br><span class="line">[<span class="string">root@k8s-master01</span> <span class="string">pod</span>]<span class="comment"># kubectl describe pod pod-base -n dev</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_33571420e04b19599c2fdbde3d555f2c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_33571420e04b19599c2fdbde3d555f2c.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>9ã€podç»“æ„è¯¦è§£</title>
      <link href="/2024/12/04/9%E3%80%81pod%E7%BB%93%E6%9E%84%E8%AF%A6%E8%A7%A3/"/>
      <url>/2024/12/04/9%E3%80%81pod%E7%BB%93%E6%9E%84%E8%AF%A6%E8%A7%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="9ã€podç»“æ„è¯¦è§£"><a href="#9ã€podç»“æ„è¯¦è§£" class="headerlink" title="9ã€podç»“æ„è¯¦è§£"></a>9ã€podç»“æ„è¯¦è§£</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_2aa0d2a2465ecb7007fd460aade64ce4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_2aa0d2a2465ecb7007fd460aade64ce4.png"></p><p><strong>æ¯ä¸ªPodä¸­éƒ½å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ï¼Œè¿™äº›å®¹å™¨å¯ä»¥åˆ†ä¸ºä¸¤ç±»ï¼š</strong></p><ul><li><p><strong>ç”¨æˆ·ç¨‹åºæ‰€åœ¨çš„å®¹å™¨ï¼Œæ•°é‡å¯å¤šå¯å°‘</strong></p></li><li><p><strong>Pauseå®¹å™¨ï¼Œè¿™æ˜¯æ¯ä¸ªPodéƒ½ä¼šæœ‰çš„ä¸€ä¸ª<strong><strong>æ ¹å®¹å™¨</strong></strong>ï¼Œå®ƒçš„ä½œç”¨æœ‰ä¸¤ä¸ªï¼š</strong></p><ul><li><strong>å¯ä»¥ä»¥å®ƒä¸ºä¾æ®ï¼Œè¯„ä¼°æ•´ä¸ªPodçš„å¥åº·çŠ¶æ€</strong></li><li><strong>å¯ä»¥åœ¨æ ¹å®¹å™¨ä¸Šè®¾ç½®Ipåœ°å€ï¼Œå…¶å®ƒå®¹å™¨éƒ½æ­¤Ipï¼ˆPod IPï¼‰ï¼Œä»¥å®ç°Podå†…éƒ¨çš„ç½‘è·¯é€šä¿¡</strong></li></ul></li><li><p><strong>è¿™é‡Œæ˜¯Podå†…éƒ¨çš„é€šè®¯ï¼ŒPodçš„ä¹‹é—´çš„é€šè®¯é‡‡ç”¨è™šæ‹ŸäºŒå±‚ç½‘ç»œæŠ€æœ¯æ¥å®ç°ï¼Œæˆ‘ä»¬å½“å‰ç¯å¢ƒç”¨çš„æ˜¯Flannel</strong></p></li></ul><h2 id="ä¸€-podçš„å®šä¹‰"><a href="#ä¸€-podçš„å®šä¹‰" class="headerlink" title="ä¸€. podçš„å®šä¹‰"></a>ä¸€. podçš„å®šä¹‰</h2><p><strong>ä¸‹é¢æ˜¯Podçš„èµ„æºæ¸…å•ï¼ˆç»å¸¸ç”¨åˆ°çš„èµ„æºæ¸…å•ï¼‰ï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span>     <span class="comment">#å¿…é€‰ï¼Œç‰ˆæœ¬å·ï¼Œä¾‹å¦‚v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span>       ã€€ <span class="comment">#å¿…é€‰ï¼Œèµ„æºç±»å‹ï¼Œä¾‹å¦‚ Pod</span></span><br><span class="line"><span class="attr">metadata:</span>       ã€€ <span class="comment">#å¿…é€‰ï¼Œå…ƒæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">string</span>     <span class="comment">#å¿…é€‰ï¼ŒPodåç§°</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">string</span>  <span class="comment">#Podæ‰€å±çš„å‘½åç©ºé—´,é»˜è®¤ä¸º&quot;default&quot;</span></span><br><span class="line">  <span class="attr">labels:</span>       ã€€ã€€  <span class="comment">#è‡ªå®šä¹‰æ ‡ç­¾åˆ—è¡¨</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">string</span>      ã€€      </span><br><span class="line"><span class="attr">spec:</span>  <span class="comment">#å¿…é€‰ï¼ŒPodä¸­å®¹å™¨çš„è¯¦ç»†å®šä¹‰</span></span><br><span class="line">  <span class="attr">containers:</span>  <span class="comment">#å¿…é€‰ï¼ŒPodä¸­å®¹å™¨åˆ—è¡¨</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">string</span>   <span class="comment">#å¿…é€‰ï¼Œå®¹å™¨åç§°</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">string</span>  <span class="comment">#å¿…é€‰ï¼Œå®¹å™¨çš„é•œåƒåç§°</span></span><br><span class="line">    <span class="attr">imagePullPolicy:</span> [ <span class="string">Always|Never|IfNotPresent</span> ]  <span class="comment">#è·å–é•œåƒçš„ç­–ç•¥ </span></span><br><span class="line">    <span class="attr">command:</span> [<span class="string">string</span>]   <span class="comment">#å®¹å™¨çš„å¯åŠ¨å‘½ä»¤åˆ—è¡¨ï¼Œå¦‚ä¸æŒ‡å®šï¼Œä½¿ç”¨æ‰“åŒ…æ—¶ä½¿ç”¨çš„å¯åŠ¨å‘½ä»¤</span></span><br><span class="line">    <span class="attr">args:</span> [<span class="string">string</span>]      <span class="comment">#å®¹å™¨çš„å¯åŠ¨å‘½ä»¤å‚æ•°åˆ—è¡¨</span></span><br><span class="line">    <span class="attr">workingDir:</span> <span class="string">string</span>  <span class="comment">#å®¹å™¨çš„å·¥ä½œç›®å½•</span></span><br><span class="line">    <span class="attr">volumeMounts:</span>       <span class="comment">#æŒ‚è½½åˆ°å®¹å™¨å†…éƒ¨çš„å­˜å‚¨å·é…ç½®</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">string</span>      <span class="comment">#å¼•ç”¨podå®šä¹‰çš„å…±äº«å­˜å‚¨å·çš„åç§°ï¼Œéœ€ç”¨volumes[]éƒ¨åˆ†å®šä¹‰çš„çš„å·å</span></span><br><span class="line">      <span class="attr">mountPath:</span> <span class="string">string</span> <span class="comment">#å­˜å‚¨å·åœ¨å®¹å™¨å†…mountçš„ç»å¯¹è·¯å¾„ï¼Œåº”å°‘äº512å­—ç¬¦</span></span><br><span class="line">      <span class="attr">readOnly:</span> <span class="string">boolean</span> <span class="comment">#æ˜¯å¦ä¸ºåªè¯»æ¨¡å¼</span></span><br><span class="line">    <span class="attr">ports:</span> <span class="comment">#éœ€è¦æš´éœ²çš„ç«¯å£åº“å·åˆ—è¡¨</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">string</span>        <span class="comment">#ç«¯å£çš„åç§°</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="string">int</span>  <span class="comment">#å®¹å™¨éœ€è¦ç›‘å¬çš„ç«¯å£å·</span></span><br><span class="line">      <span class="attr">hostPort:</span> <span class="string">int</span>       <span class="comment">#å®¹å™¨æ‰€åœ¨ä¸»æœºéœ€è¦ç›‘å¬çš„ç«¯å£å·ï¼Œé»˜è®¤ä¸Containerç›¸åŒ</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">string</span>    <span class="comment">#ç«¯å£åè®®ï¼Œæ”¯æŒTCPå’ŒUDPï¼Œé»˜è®¤TCP</span></span><br><span class="line">    <span class="attr">env:</span>   <span class="comment">#å®¹å™¨è¿è¡Œå‰éœ€è®¾ç½®çš„ç¯å¢ƒå˜é‡åˆ—è¡¨</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">string</span>  <span class="comment">#ç¯å¢ƒå˜é‡åç§°</span></span><br><span class="line">      <span class="attr">value:</span> <span class="string">string</span> <span class="comment">#ç¯å¢ƒå˜é‡çš„å€¼</span></span><br><span class="line">    <span class="attr">resources:</span> <span class="comment">#èµ„æºé™åˆ¶å’Œè¯·æ±‚çš„è®¾ç½®</span></span><br><span class="line">      <span class="attr">limits:</span>  <span class="comment">#èµ„æºé™åˆ¶çš„è®¾ç½®</span></span><br><span class="line">        <span class="attr">cpu:</span> <span class="string">string</span>     <span class="comment">#Cpuçš„é™åˆ¶ï¼Œå•ä½ä¸ºcoreæ•°ï¼Œå°†ç”¨äºdocker run --cpu-shareså‚æ•°</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">string</span>  <span class="comment">#å†…å­˜é™åˆ¶ï¼Œå•ä½å¯ä»¥ä¸ºMib/Gibï¼Œå°†ç”¨äºdocker run --memoryå‚æ•°</span></span><br><span class="line">      <span class="attr">requests:</span> <span class="comment">#èµ„æºè¯·æ±‚çš„è®¾ç½®</span></span><br><span class="line">        <span class="attr">cpu:</span> <span class="string">string</span>    <span class="comment">#Cpuè¯·æ±‚ï¼Œå®¹å™¨å¯åŠ¨çš„åˆå§‹å¯ç”¨æ•°é‡</span></span><br><span class="line">        <span class="attr">memory:</span> <span class="string">string</span> <span class="comment">#å†…å­˜è¯·æ±‚,å®¹å™¨å¯åŠ¨çš„åˆå§‹å¯ç”¨æ•°é‡</span></span><br><span class="line">    <span class="attr">lifecycle:</span> <span class="comment">#ç”Ÿå‘½å‘¨æœŸé’©å­</span></span><br><span class="line">        <span class="attr">postStart:</span> <span class="comment">#å®¹å™¨å¯åŠ¨åç«‹å³æ‰§è¡Œæ­¤é’©å­,å¦‚æœæ‰§è¡Œå¤±è´¥,ä¼šæ ¹æ®é‡å¯ç­–ç•¥è¿›è¡Œé‡å¯</span></span><br><span class="line">        <span class="attr">preStop:</span> <span class="comment">#å®¹å™¨ç»ˆæ­¢å‰æ‰§è¡Œæ­¤é’©å­,æ— è®ºç»“æœå¦‚ä½•,å®¹å™¨éƒ½ä¼šç»ˆæ­¢</span></span><br><span class="line">    <span class="attr">livenessProbe:</span>  <span class="comment">#å¯¹Podå†…å„å®¹å™¨å¥åº·æ£€æŸ¥çš„è®¾ç½®ï¼Œå½“æ¢æµ‹æ— å“åº”å‡ æ¬¡åå°†è‡ªåŠ¨é‡å¯è¯¥å®¹å™¨</span></span><br><span class="line">      <span class="attr">exec:</span>       ã€€ <span class="comment">#å¯¹Podå®¹å™¨å†…æ£€æŸ¥æ–¹å¼è®¾ç½®ä¸ºexecæ–¹å¼</span></span><br><span class="line">        <span class="attr">command:</span> [<span class="string">string</span>]  <span class="comment">#execæ–¹å¼éœ€è¦åˆ¶å®šçš„å‘½ä»¤æˆ–è„šæœ¬</span></span><br><span class="line">      <span class="attr">httpGet:</span>       <span class="comment">#å¯¹Podå†…ä¸ªå®¹å™¨å¥åº·æ£€æŸ¥æ–¹æ³•è®¾ç½®ä¸ºHttpGetï¼Œéœ€è¦åˆ¶å®šPathã€port</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">string</span></span><br><span class="line">        <span class="attr">port:</span> <span class="string">number</span></span><br><span class="line">        <span class="attr">host:</span> <span class="string">string</span></span><br><span class="line">        <span class="attr">scheme:</span> <span class="string">string</span></span><br><span class="line">        <span class="attr">HttpHeaders:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">string</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">string</span></span><br><span class="line">      <span class="attr">tcpSocket:</span>     <span class="comment">#å¯¹Podå†…ä¸ªå®¹å™¨å¥åº·æ£€æŸ¥æ–¹å¼è®¾ç½®ä¸ºtcpSocketæ–¹å¼</span></span><br><span class="line">         <span class="attr">port:</span> <span class="string">number</span></span><br><span class="line">       <span class="attr">initialDelaySeconds:</span> <span class="number">0</span>       <span class="comment">#å®¹å™¨å¯åŠ¨å®Œæˆåé¦–æ¬¡æ¢æµ‹çš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’</span></span><br><span class="line">       <span class="attr">timeoutSeconds:</span> <span class="number">0</span>    ã€€ã€€    <span class="comment">#å¯¹å®¹å™¨å¥åº·æ£€æŸ¥æ¢æµ‹ç­‰å¾…å“åº”çš„è¶…æ—¶æ—¶é—´ï¼Œå•ä½ç§’ï¼Œé»˜è®¤1ç§’</span></span><br><span class="line">       <span class="attr">periodSeconds:</span> <span class="number">0</span>     ã€€ã€€    <span class="comment">#å¯¹å®¹å™¨ç›‘æ§æ£€æŸ¥çš„å®šæœŸæ¢æµ‹æ—¶é—´è®¾ç½®ï¼Œå•ä½ç§’ï¼Œé»˜è®¤10ç§’ä¸€æ¬¡</span></span><br><span class="line">       <span class="attr">successThreshold:</span> <span class="number">0</span></span><br><span class="line">       <span class="attr">failureThreshold:</span> <span class="number">0</span></span><br><span class="line">       <span class="attr">securityContext:</span></span><br><span class="line">         <span class="attr">privileged:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> [<span class="string">Always</span> <span class="string">|</span> <span class="string">Never</span> <span class="string">|</span> <span class="string">OnFailure</span>]  <span class="comment">#Podçš„é‡å¯ç­–ç•¥</span></span><br><span class="line">  <span class="attr">nodeName:</span> <span class="string">&lt;string&gt;</span> <span class="comment">#è®¾ç½®NodeNameè¡¨ç¤ºå°†è¯¥Podè°ƒåº¦åˆ°æŒ‡å®šåˆ°åç§°çš„nodeèŠ‚ç‚¹ä¸Š</span></span><br><span class="line">  <span class="attr">nodeSelector:</span> <span class="string">obeject</span> <span class="comment">#è®¾ç½®NodeSelectorè¡¨ç¤ºå°†è¯¥Podè°ƒåº¦åˆ°åŒ…å«è¿™ä¸ªlabelçš„nodeä¸Š</span></span><br><span class="line">  <span class="attr">imagePullSecrets:</span> <span class="comment">#Pullé•œåƒæ—¶ä½¿ç”¨çš„secretåç§°ï¼Œä»¥keyï¼šsecretkeyæ ¼å¼æŒ‡å®š</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">string</span></span><br><span class="line">  <span class="attr">hostNetwork:</span> <span class="literal">false</span>   <span class="comment">#æ˜¯å¦ä½¿ç”¨ä¸»æœºç½‘ç»œæ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalseï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºä½¿ç”¨å®¿ä¸»æœºç½‘ç»œ</span></span><br><span class="line">  <span class="attr">volumes:</span>   <span class="comment">#åœ¨è¯¥podä¸Šå®šä¹‰å…±äº«å­˜å‚¨å·åˆ—è¡¨</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">string</span>    <span class="comment">#å…±äº«å­˜å‚¨å·åç§° ï¼ˆvolumesç±»å‹æœ‰å¾ˆå¤šç§ï¼‰</span></span><br><span class="line">    <span class="attr">emptyDir:</span> &#123;&#125;       <span class="comment">#ç±»å‹ä¸ºemtyDirçš„å­˜å‚¨å·ï¼Œä¸PodåŒç”Ÿå‘½å‘¨æœŸçš„ä¸€ä¸ªä¸´æ—¶ç›®å½•ã€‚ä¸ºç©ºå€¼</span></span><br><span class="line">    <span class="attr">hostPath:</span> <span class="string">string</span>   <span class="comment">#ç±»å‹ä¸ºhostPathçš„å­˜å‚¨å·ï¼Œè¡¨ç¤ºæŒ‚è½½Podæ‰€åœ¨å®¿ä¸»æœºçš„ç›®å½•</span></span><br><span class="line">      <span class="attr">path:</span> <span class="string">string</span>      ã€€ã€€        <span class="comment">#Podæ‰€åœ¨å®¿ä¸»æœºçš„ç›®å½•ï¼Œå°†è¢«ç”¨äºåŒæœŸä¸­mountçš„ç›®å½•</span></span><br><span class="line">    <span class="attr">secret:</span>       ã€€ã€€ã€€<span class="comment">#ç±»å‹ä¸ºsecretçš„å­˜å‚¨å·ï¼ŒæŒ‚è½½é›†ç¾¤ä¸å®šä¹‰çš„secretå¯¹è±¡åˆ°å®¹å™¨å†…éƒ¨</span></span><br><span class="line">      <span class="attr">scretname:</span> <span class="string">string</span>  </span><br><span class="line">      <span class="attr">items:</span>   </span><br><span class="line">      <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">string</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">string</span></span><br><span class="line">    <span class="attr">configMap:</span>         <span class="comment">#ç±»å‹ä¸ºconfigMapçš„å­˜å‚¨å·ï¼ŒæŒ‚è½½é¢„å®šä¹‰çš„configMapå¯¹è±¡åˆ°å®¹å™¨å†…éƒ¨</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">string</span></span><br><span class="line">      <span class="attr">items:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">key:</span> <span class="string">string</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">string</span></span><br></pre></td></tr></table></figure><h3 id="1-æŸ¥çœ‹k8sçš„å±æ€§"><a href="#1-æŸ¥çœ‹k8sçš„å±æ€§" class="headerlink" title="1. æŸ¥çœ‹k8sçš„å±æ€§"></a>1. <strong>æŸ¥çœ‹k8sçš„å±æ€§</strong></h3><p><strong>å°æç¤ºï¼š</strong></p><ul><li><strong>åœ¨è¿™é‡Œï¼Œå¯é€šè¿‡ä¸€ä¸ªå‘½ä»¤æ¥æŸ¥çœ‹æ¯ç§èµ„æºçš„å¯é…ç½®é¡¹</strong></li><li><strong>kubectl explain èµ„æºç±»å‹            æŸ¥çœ‹æŸç§èµ„æºå¯ä»¥é…ç½®çš„ä¸€çº§å±æ€§</strong></li><li><strong>kubectl.explain èµ„æºç±»å‹.å±æ€§     æŸ¥çœ‹å±æ€§çš„å­å±æ€§</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># k8s podçš„ä¸€çº§å±æ€§</span></span><br><span class="line">[<span class="string">root@k8s-master01</span> <span class="string">~</span>]<span class="comment"># kubectl explain pod</span></span><br><span class="line"><span class="attr">KIND:</span>     <span class="string">Pod</span></span><br><span class="line"><span class="attr">VERSION:</span>  <span class="string">v1</span></span><br><span class="line"><span class="attr">FIELDS:</span></span><br><span class="line">   <span class="string">apiVersion</span>   <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">kind</span> <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">metadata</span>     <span class="string">&lt;Object&gt;</span></span><br><span class="line">   <span class="string">spec</span> <span class="string">&lt;Object&gt;</span></span><br><span class="line">   <span class="string">status</span>       <span class="string">&lt;Object&gt;</span></span><br><span class="line"><span class="comment"># k8s podçš„äºŒçº§å±æ€§</span></span><br><span class="line">[<span class="string">root@k8s-master01</span> <span class="string">~</span>]<span class="comment"># kubectl explain pod.metadata</span></span><br><span class="line"><span class="attr">KIND:</span>     <span class="string">Pod</span></span><br><span class="line"><span class="attr">VERSION:</span>  <span class="string">v1</span></span><br><span class="line"><span class="attr">RESOURCE:</span> <span class="string">metadata</span> <span class="string">&lt;Object&gt;</span></span><br><span class="line"><span class="attr">FIELDS:</span></span><br><span class="line">   <span class="string">annotations</span>  <span class="string">&lt;map[string]string&gt;</span></span><br><span class="line">   <span class="string">clusterName</span>  <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">creationTimestamp</span>    <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">deletionGracePeriodSeconds</span>   <span class="string">&lt;integer&gt;</span></span><br><span class="line">   <span class="string">deletionTimestamp</span>    <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">finalizers</span>   <span class="string">&lt;[]string&gt;</span></span><br><span class="line">   <span class="string">generateName</span> <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">generation</span>   <span class="string">&lt;integer&gt;</span></span><br><span class="line">   <span class="string">labels</span>       <span class="string">&lt;map[string]string&gt;</span></span><br><span class="line">   <span class="string">managedFields</span>        <span class="string">&lt;[]Object&gt;</span></span><br><span class="line">   <span class="string">name</span> <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">namespace</span>    <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">ownerReferences</span>      <span class="string">&lt;[]Object&gt;</span></span><br><span class="line">   <span class="string">resourceVersion</span>      <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">selfLink</span>     <span class="string">&lt;string&gt;</span></span><br><span class="line">   <span class="string">uid</span>  <span class="string">&lt;string&gt;</span></span><br></pre></td></tr></table></figure><p><strong>åœ¨kubernetesä¸­åŸºæœ¬æ‰€æœ‰èµ„æºçš„ä¸€çº§å±æ€§éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¸»è¦åŒ…å«5éƒ¨åˆ†ï¼š</strong></p><ul><li><strong>apiVersion ç‰ˆæœ¬ï¼Œç”±kuberneteså†…éƒ¨å®šä¹‰ï¼Œç‰ˆæœ¬å·å¿…é¡»å¯ä»¥ç”¨ kubectl api-versions æŸ¥è¯¢åˆ°</strong></li><li><strong>kind ç±»å‹ï¼Œç”±kuberneteså†…éƒ¨å®šä¹‰ï¼Œç‰ˆæœ¬å·å¿…é¡»å¯ä»¥ç”¨ kubectl api-resources æŸ¥è¯¢åˆ°</strong></li><li><strong>metadata å…ƒæ•°æ®ï¼Œä¸»è¦æ˜¯èµ„æºæ ‡è¯†å’Œè¯´æ˜ï¼Œå¸¸ç”¨çš„æœ‰nameã€namespaceã€labelsç­‰</strong></li><li><strong>spec æè¿°ï¼Œè¿™æ˜¯é…ç½®ä¸­æœ€é‡è¦çš„ä¸€éƒ¨åˆ†ï¼Œé‡Œé¢æ˜¯å¯¹å„ç§èµ„æºé…ç½®çš„è¯¦ç»†æè¿°ï¼ˆé‡è¦ï¼‰</strong></li><li><strong>status çŠ¶æ€ä¿¡æ¯ï¼Œé‡Œé¢çš„å†…å®¹ä¸éœ€è¦å®šä¹‰ï¼Œç”±kubernetesè‡ªåŠ¨ç”Ÿæˆ</strong></li><li><strong>statusæŸ¥çœ‹:  kubectl get pod nginx-57f7cb8f64-jxk6s  -n dev  -o yaml è¾“å…¥åä¼šå›æ˜¾ä¸‹æ–¹å›æ˜¾ç¤ºçŠ¶æ€</strong></li></ul><p><strong>åœ¨ä¸Šé¢çš„å±æ€§ä¸­ï¼Œspecæ˜¯æ¥ä¸‹æ¥ç ”ç©¶çš„é‡ç‚¹ï¼Œç»§ç»­çœ‹ä¸‹å®ƒçš„å¸¸è§å­å±æ€§:</strong></p><ul><li><strong>containers &lt;[]Object&gt; å®¹å™¨åˆ—è¡¨ï¼Œç”¨äºå®šä¹‰å®¹å™¨çš„è¯¦ç»†ä¿¡æ¯</strong></li><li><strong>nodeName æ ¹æ®nodeNameçš„å€¼å°†podè°ƒåº¦åˆ°æŒ‡å®šçš„NodeèŠ‚ç‚¹ä¸Š</strong></li><li><strong>nodeSelector &lt;map[]&gt; æ ¹æ®NodeSelectorä¸­å®šä¹‰çš„ä¿¡æ¯é€‰æ‹©å°†è¯¥Podè°ƒåº¦åˆ°åŒ…å«è¿™äº›labelçš„Node ä¸Š</strong></li><li><strong>hostNetwork æ˜¯å¦ä½¿ç”¨ä¸»æœºç½‘ç»œæ¨¡å¼ï¼Œé»˜è®¤ä¸ºfalseï¼Œå¦‚æœè®¾ç½®ä¸ºtrueï¼Œè¡¨ç¤ºä½¿ç”¨å®¿ä¸»æœºç½‘ç»œ</strong></li><li><strong>volumes &lt;[]Object&gt; å­˜å‚¨å·ï¼Œç”¨äºå®šä¹‰Podä¸Šé¢æŒ‚åœ¨çš„å­˜å‚¨ä¿¡æ¯ ï¼ˆä¸dockerä¸­ç›¸åŒï¼‰</strong></li><li><strong>restartPolicy é‡å¯ç­–ç•¥ï¼Œè¡¨ç¤ºPodåœ¨é‡åˆ°æ•…éšœçš„æ—¶å€™çš„å¤„ç†ç­–ç•¥    ï¼ˆä¸dockerä¸­restart: alwaysç±»ä¼¼å·®ä¸å¤šï¼‰</strong></li></ul><p><strong>hostNetwork</strong>ä¸Šæ–¹ä¸»æœºç½‘ç»œï¼š</p><p><strong>ä¸‹æ–¹IP æ˜¯k8såˆ†ç»™ä»–çš„IP</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_90b818d1e53752466f798f2510296a54.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_90b818d1e53752466f798f2510296a54.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>8ã€å®æˆ˜å…¥é—¨namespace</title>
      <link href="/2024/12/04/8%E3%80%81%E5%AE%9E%E6%88%98%E5%85%A5%E9%97%A8namespace/"/>
      <url>/2024/12/04/8%E3%80%81%E5%AE%9E%E6%88%98%E5%85%A5%E9%97%A8namespace/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="8ã€å®æˆ˜å…¥é—¨namespace"><a href="#8ã€å®æˆ˜å…¥é—¨namespace" class="headerlink" title="8ã€å®æˆ˜å…¥é—¨namespace"></a>8ã€å®æˆ˜å…¥é—¨namespace</h2><h2 id="å®æˆ˜å…¥é—¨"><a href="#å®æˆ˜å…¥é—¨" class="headerlink" title="å®æˆ˜å…¥é—¨"></a>å®æˆ˜å…¥é—¨</h2><p><strong>æœ¬ç« èŠ‚å°†ä»‹ç»å¦‚ä½•åœ¨kubernetesé›†ç¾¤ä¸­éƒ¨ç½²ä¸€ä¸ªnginxæœåŠ¡ï¼Œå¹¶ä¸”èƒ½å¤Ÿå¯¹å…¶è¿›è¡Œè®¿é—®ã€‚</strong></p><h2 id="ä¸€-Namespace"><a href="#ä¸€-Namespace" class="headerlink" title="ä¸€ Namespace"></a><code>ä¸€ Namespace</code></h2><p><strong>Namespaceæ˜¯kubernetesç³»ç»Ÿä¸­çš„ä¸€ç§éå¸¸é‡è¦èµ„æºï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ç”¨æ¥å®ç°****å¤šå¥—ç¯å¢ƒçš„èµ„æºéš”ç¦»</strong>æˆ–è€…<strong>å¤šç§Ÿæˆ·çš„èµ„æºéš”ç¦»</strong>ã€‚</p><p><strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œkubernetesé›†ç¾¤ä¸­çš„æ‰€æœ‰çš„Podéƒ½æ˜¯å¯ä»¥ç›¸äº’è®¿é—®çš„ã€‚ä½†æ˜¯åœ¨å®é™…ä¸­ï¼Œå¯èƒ½ä¸æƒ³è®©ä¸¤ä¸ªPodä¹‹é—´è¿›è¡Œäº’ç›¸çš„è®¿é—®ï¼Œé‚£æ­¤æ—¶å°±å¯ä»¥å°†ä¸¤ä¸ªPodåˆ’åˆ†åˆ°ä¸åŒçš„namespaceä¸‹ã€‚kubernetesé€šè¿‡å°†é›†ç¾¤å†…éƒ¨çš„èµ„æºåˆ†é…åˆ°ä¸åŒçš„Namespaceä¸­ï¼Œå¯ä»¥å½¢æˆé€»è¾‘ä¸Šçš„â€ç»„â€ï¼Œä»¥æ–¹ä¾¿ä¸åŒçš„ç»„çš„èµ„æºè¿›è¡Œéš”ç¦»ä½¿ç”¨å’Œç®¡ç†ã€‚</strong></p><p><strong>å¯ä»¥é€šè¿‡kubernetesçš„æˆæƒæœºåˆ¶ï¼Œå°†ä¸åŒçš„namespaceäº¤ç»™ä¸åŒç§Ÿæˆ·è¿›è¡Œç®¡ç†ï¼Œè¿™æ ·å°±å®ç°äº†å¤šç§Ÿæˆ·çš„èµ„æºéš”ç¦»ã€‚æ­¤æ—¶è¿˜èƒ½ç»“åˆkubernetesçš„èµ„æºé…é¢æœºåˆ¶ï¼Œé™å®šä¸åŒç§Ÿæˆ·èƒ½å ç”¨çš„èµ„æºï¼Œä¾‹å¦‚CPUä½¿ç”¨é‡ã€å†…å­˜ä½¿ç”¨é‡ç­‰ç­‰ï¼Œæ¥å®ç°ç§Ÿæˆ·å¯ç”¨èµ„æºçš„ç®¡ç†ã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_0047560fb8757dfeeb73d08c00c497fd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_0047560fb8757dfeeb73d08c00c497fd.png"></p><h3 id="1-k8séƒ¨ç½²å®Œæˆåç³»ç»Ÿé»˜è®¤çš„namespaceæ˜¯å¹²å˜›ç”¨çš„"><a href="#1-k8séƒ¨ç½²å®Œæˆåç³»ç»Ÿé»˜è®¤çš„namespaceæ˜¯å¹²å˜›ç”¨çš„" class="headerlink" title="1.k8séƒ¨ç½²å®Œæˆåç³»ç»Ÿé»˜è®¤çš„namespaceæ˜¯å¹²å˜›ç”¨çš„"></a><code>1.</code>k8séƒ¨ç½²å®Œæˆåç³»ç»Ÿé»˜è®¤çš„namespaceæ˜¯å¹²å˜›ç”¨çš„</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹nsè¯¦æƒ…</span><br><span class="line">kubectl  get namespace</span><br><span class="line"># é»˜è®¤nsè§£é‡Š</span><br><span class="line">NAME              STATUS   AGE</span><br><span class="line">default           Active   45h     #  æ‰€æœ‰æœªæŒ‡å®šNamespaceçš„å¯¹è±¡éƒ½ä¼šè¢«åˆ†é…åœ¨defaultå‘½åç©ºé—´</span><br><span class="line">kube-node-lease   Active   45h     #  é›†ç¾¤èŠ‚ç‚¹ä¹‹é—´çš„å¿ƒè·³ç»´æŠ¤ï¼Œv1.13å¼€å§‹å¼•å…¥</span><br><span class="line">kube-public       Active   45h     #  æ­¤å‘½åç©ºé—´ä¸‹çš„èµ„æºå¯ä»¥è¢«æ‰€æœ‰äººè®¿é—®ï¼ˆåŒ…æ‹¬æœªè®¤è¯ç”¨æˆ·ï¼‰</span><br><span class="line">kube-system       Active   45h     #  æ‰€æœ‰ç”±Kubernetesç³»ç»Ÿåˆ›å»ºçš„èµ„æºéƒ½å¤„äºè¿™ä¸ªå‘½åç©ºé—´</span><br></pre></td></tr></table></figure><h3 id="2-namespaceèµ„æºçš„å…·ä½“æ“ä½œï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰"><a href="#2-namespaceèµ„æºçš„å…·ä½“æ“ä½œï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰" class="headerlink" title="2. namespaceèµ„æºçš„å…·ä½“æ“ä½œï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰"></a><code>2. namespace</code>èµ„æºçš„å…·ä½“æ“ä½œï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹æ‰€æœ‰ns</span><br><span class="line">kubectl get ns</span><br><span class="line"># æŸ¥çœ‹æŒ‡å®šns</span><br><span class="line">kubectl get ns default</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹</strong><code>ns</code>èµ„æºè¯¦æƒ…å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹nsè¯¦æƒ… (çŠ¶æ€é™¤äº†æ­¤ç§ï¼ˆæ­£åœ¨ä½¿ç”¨ä¸­ï¼‰è¿˜æœ‰Terminating æ­£åœ¨åˆ é™¤å‘½åç©ºé—´)</span><br><span class="line">kubectl describe ns default</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Name:         default</span><br><span class="line">Labels:       &lt;none&gt;</span><br><span class="line">Annotations:  &lt;none&gt;</span><br><span class="line">Status:       Active  # Active å‘½åç©ºé—´æ­£åœ¨ä½¿ç”¨ä¸­  Terminating æ­£åœ¨åˆ é™¤å‘½åç©ºé—´</span><br><span class="line"></span><br><span class="line"># ResourceQuota é’ˆå¯¹namespaceåšçš„èµ„æºé™åˆ¶</span><br><span class="line"># LimitRangeé’ˆå¯¹namespaceä¸­çš„æ¯ä¸ªç»„ä»¶åšçš„èµ„æºé™åˆ¶</span><br><span class="line">No resource quota.</span><br><span class="line">No LimitRange resource.</span><br></pre></td></tr></table></figure><p><strong>kubernetesæ”¯æŒçš„æ ¼å¼æœ‰å¾ˆå¤šï¼Œæ¯”è¾ƒå¸¸è§çš„æ˜¯wideã€jsonã€yaml</strong></p><p><strong>kubectl get ns default -o yaml</strong></p><p><strong>åˆ›å»º/åˆ é™¤</strong><code>ns</code>èµ„æº</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kubectl create ns dev</span><br><span class="line"># éªŒè¯æ˜¯å¦åˆ›å»ºå®Œæˆ</span><br><span class="line">kubectl get ns dev</span><br><span class="line"># åˆ é™¤èµ„æºï¼ˆåˆ é™¤ä¼šåˆ é™¤nsä¸‹çš„æ‰€æœ‰èµ„æºï¼‰</span><br><span class="line">kubectl delete ns dev</span><br></pre></td></tr></table></figure><h2 id="äºŒ-é…ç½®çš„æ–¹å¼åˆ›å»ºns"><a href="#äºŒ-é…ç½®çš„æ–¹å¼åˆ›å»ºns" class="headerlink" title="äºŒ. é…ç½®çš„æ–¹å¼åˆ›å»ºns"></a>äºŒ. é…ç½®çš„æ–¹å¼åˆ›å»º<code>ns</code></h2><p><strong>åˆ›å»ºä¸€ä¸ªyamlæ–‡ä»¶ã€ns-dev.yaml</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Namespace</span><br><span class="line">metadata:</span><br><span class="line">  name: dev</span><br></pre></td></tr></table></figure><p><strong>æ­¤æ—¶å°±å¯ä»¥æ‰§è¡Œå¯¹åº”çš„åˆ›å»ºå’Œåˆ é™¤å‘½ä»¤äº†</strong></p><ul><li><strong>åˆ›å»ºï¼škubectl create -f ns-dev.yaml</strong></li><li><strong>åˆ é™¤ï¼škubectl delete -f ns-dev.yaml</strong></li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_56529a6aa690ff5b06b1c25f9595dde5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_56529a6aa690ff5b06b1c25f9595dde5.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>7ã€å£°æ˜å¼å¯¹è±¡é…ç½®</title>
      <link href="/2024/12/04/7%E3%80%81%E5%A3%B0%E6%98%8E%E5%BC%8F%E5%AF%B9%E8%B1%A1%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/12/04/7%E3%80%81%E5%A3%B0%E6%98%8E%E5%BC%8F%E5%AF%B9%E8%B1%A1%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="7ã€å£°æ˜å¼å¯¹è±¡é…ç½®"><a href="#7ã€å£°æ˜å¼å¯¹è±¡é…ç½®" class="headerlink" title="7ã€å£°æ˜å¼å¯¹è±¡é…ç½®"></a>7ã€å£°æ˜å¼å¯¹è±¡é…ç½®</h2><h2 id="17-å£°æ˜å¼å¯¹è±¡é…ç½®"><a href="#17-å£°æ˜å¼å¯¹è±¡é…ç½®" class="headerlink" title="17.å£°æ˜å¼å¯¹è±¡é…ç½®"></a><code>17.</code>å£°æ˜å¼å¯¹è±¡é…ç½®</h2><p><strong>æ€»ç»“:</strong> å…¶å®å£°æ˜å¼å¯¹è±¡é…ç½®å°±æ˜¯ä½¿ç”¨applyæè¿°ä¸€ä¸ªèµ„æºæœ€ç»ˆçš„çŠ¶æ€ï¼ˆåœ¨yamlä¸­å®šä¹‰çŠ¶æ€ï¼‰** ä½¿ç”¨applyæ“ä½œèµ„æºï¼šå¦‚æœèµ„æºä¸å­˜åœ¨ï¼Œå°±åˆ›å»ºï¼Œç›¸å½“äº kubectl create** å¦‚æœèµ„æºå·²å­˜åœ¨ï¼Œå°±æ›´æ–°ï¼Œç›¸å½“äº kubectl patch</p><p><strong>å£°æ˜å¼å¯¹è±¡é…ç½®è·Ÿå‘½ä»¤å¼å¯¹è±¡é…ç½®å¾ˆç›¸ä¼¼ã€ä½†æ˜¯ä»–åªæœ‰ä¸€ä¸ªå‘½ä»¤applyï¼ˆæ›´æ–°åˆ›å»º å·²æœ‰åˆ™æ›´æ–° æ²¡æœ‰åˆ™åˆ›å»ºï¼‰</strong></p><p><strong>å¦‚æœä½¿ç”¨conmand ä¸­çš„create åˆ™ä¼šæŠ¥é”™</strong></p><p><strong>ä½¿ç”¨apply åˆ›å»º/æ›´æ–°èµ„æº</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># æ›´æ–°åˆ›å»º å·²æœ‰åˆ™æ›´æ–° æ²¡æœ‰åˆ™åˆ›å»º nginx</span><br><span class="line">kubectl apply -f nginxpod.yml </span><br><span class="line"># éªŒè¯</span><br><span class="line">kubectl get ns  dev</span><br><span class="line">kubectl get pods  -n dev</span><br></pre></td></tr></table></figure><p><strong>å†æ¬¡æ‰§è¡Œï¼ˆå·²èµ„æºæ­¤æ—¶æ›´æ–°ï¼‰</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># æ­¤æ—¶æˆ‘ä»¬å·²ç»åˆ›å»ºäº† æˆ‘ä»¬å†è¿è¡Œä¸€ä¸‹è¿™ä¸ªé…ç½®æ–‡ä»¶</span><br><span class="line">kubectl apply -f nginxpod.yml </span><br><span class="line">// è¿”å›ï¼ˆæç¤ºæ²¡æœ‰æ”¹å˜ï¼‰</span><br><span class="line">namespace/dev unchanged</span><br><span class="line">pod/nginxpod unchanged</span><br></pre></td></tr></table></figure><p><strong>æ­¤æ—¶æˆ‘ä»¬å°†</strong><code>nginxpod.yml</code>ä¸­é•œåƒç‰ˆæœ¬ä¿®æ”¹ä¸º<code>2</code>æ­¤æ—¶å†æ¬¡æ‰§è¡Œ<code>kubectl apply -f nginxpod.yml</code></p><p><strong>æ³¨æ„ï¼š</strong></p><ul><li><strong>ä¿®æ”¹podåç§°ä¼šé‡æ–°åˆ›å»ºä¸€ä¸ªpod ä¿®æ”¹é•œåƒæµ‹è¯•å³å¯</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å‘½åç©ºé—´çš„å£°æ˜ åˆ›å»ºä¸€ä¸ªdevçš„namespace</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span>   <span class="comment"># ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Namespace</span>  <span class="comment"># ç±»å‹</span></span><br><span class="line"><span class="attr">metadata:</span>        <span class="comment"># æè¿°åç§°ä¸ºdev </span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">dev</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span>      <span class="comment"># ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span>           <span class="comment"># ç±»å‹æ˜¯pod </span></span><br><span class="line"><span class="attr">metadata:</span>           <span class="comment"># æè¿°å¦‚ä¸‹</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginxpod</span>    <span class="comment"># åå­—å«nginxpod</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>    <span class="comment"># æ‰€åœ¨åç§°ç©ºé—´å«dev</span></span><br><span class="line"><span class="attr">spec:</span>               <span class="comment"># è¯¦ç»†æè¿°å¦‚ä¸‹</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-containers</span> <span class="comment"># podä¸­å®¹å™¨çš„åå­—å«nginx-containers</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-1.17.2</span> <span class="comment"># å®¹å™¨ä½¿ç”¨çš„é•œåƒnginx:latest æˆ– ç§æœ‰é•œåƒä»“åº“ registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span></span><br><span class="line"><span class="string">~</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹ æ­¤æ—¶è¿”å›å‘½åç©ºé—´æ²¡æœ‰æ”¹å˜ pod/nginxpodå‘ç”Ÿæ”¹å˜</strong></p><p><strong>æŸ¥çœ‹è¯¦æƒ…ï¼š</strong><code>kubectl describe pod nginxpod -n dev</code></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_320ee6bf67ce0c8b48d8f440b782316d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_320ee6bf67ce0c8b48d8f440b782316d.png"></p><h3 id="æ‰©å±•ï¼škubectlå¯ä»¥åœ¨nodeèŠ‚ç‚¹ä¸Šè¿è¡Œå—"><a href="#æ‰©å±•ï¼škubectlå¯ä»¥åœ¨nodeèŠ‚ç‚¹ä¸Šè¿è¡Œå—" class="headerlink" title="æ‰©å±•ï¼škubectlå¯ä»¥åœ¨nodeèŠ‚ç‚¹ä¸Šè¿è¡Œå— ?"></a>æ‰©å±•ï¼škubectlå¯ä»¥åœ¨nodeèŠ‚ç‚¹ä¸Šè¿è¡Œå— ?</h3><p><strong>kubectlçš„è¿è¡Œæ˜¯éœ€è¦è¿›è¡Œé…ç½®çš„ï¼Œå®ƒçš„é…ç½®æ–‡ä»¶æ˜¯$HOME/.kubeï¼Œå¦‚æœæƒ³è¦åœ¨nodeèŠ‚ç‚¹è¿è¡Œæ­¤å‘½ä»¤ï¼Œéœ€è¦å°†masterä¸Šçš„.kubeæ–‡ä»¶å¤åˆ¶åˆ°nodeèŠ‚ç‚¹ä¸Šï¼Œå³åœ¨masterèŠ‚ç‚¹ä¸Šæ‰§è¡Œä¸‹é¢æ“ä½œï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># å˜é‡å½¢å¼</span><br><span class="line">scp  -r  $HOME/.kube   node1: HOME/</span><br><span class="line"># ç­‰åŒäºå¦‚ä¸‹</span><br><span class="line">scp  -r  ~/.kube   node1:~/</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_5e5a9778ccfa864aed4adf4cffc6ee23.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_5e5a9778ccfa864aed4adf4cffc6ee23.png"></p><p><strong>ä½¿ç”¨æ¨è: ä¸‰ç§æ–¹å¼åº”è¯¥æ€ä¹ˆç”¨ ?</strong></p><h4 id="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä¸‰ç§æ–¹å¼çš„æ¨èä½¿ç”¨æ–¹å¼ï¼š"><a href="#ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä¸‰ç§æ–¹å¼çš„æ¨èä½¿ç”¨æ–¹å¼ï¼š" class="headerlink" title="ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä¸‰ç§æ–¹å¼çš„æ¨èä½¿ç”¨æ–¹å¼ï¼š"></a>ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ä¸‰ç§æ–¹å¼çš„æ¨èä½¿ç”¨æ–¹å¼ï¼š</h4><ul><li><strong>åˆ›å»º/æ›´æ–°èµ„æº ä½¿ç”¨å£°æ˜å¼å¯¹è±¡é…ç½® kubectl apply -f XXX.yaml</strong></li><li><strong>åˆ é™¤èµ„æº ä½¿ç”¨å‘½ä»¤å¼å¯¹è±¡é…ç½® kubectl delete -f XXX.yaml</strong></li><li><strong>æŸ¥è¯¢èµ„æº ä½¿ç”¨å‘½ä»¤å¼å¯¹è±¡ç®¡ç† kubectl get(describe) èµ„æºåç§°</strong></li></ul>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£/å›ºå®šå®¹å™¨å†…ç½‘åœ°å€ï¼‰</title>
      <link href="/2024/12/02/service%EF%BC%88pod%E5%AF%B9%E5%A4%96%E6%9A%B4%E9%9C%B2%E7%AB%AF%E5%8F%A3/%E5%9B%BA%E5%AE%9A%E5%AE%B9%E5%99%A8%E5%86%85%E7%BD%91%E5%9C%B0%E5%9D%80%EF%BC%89/"/>
      <url>/2024/12/02/service%EF%BC%88pod%E5%AF%B9%E5%A4%96%E6%9A%B4%E9%9C%B2%E7%AB%AF%E5%8F%A3/%E5%9B%BA%E5%AE%9A%E5%AE%B9%E5%99%A8%E5%86%85%E7%BD%91%E5%9C%B0%E5%9D%80%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="7ã€serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£-å›ºå®šå®¹å™¨å†…ç½‘åœ°å€ï¼‰"><a href="#7ã€serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£-å›ºå®šå®¹å™¨å†…ç½‘åœ°å€ï¼‰" class="headerlink" title="7ã€serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£/å›ºå®šå®¹å™¨å†…ç½‘åœ°å€ï¼‰"></a>7ã€serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£/å›ºå®šå®¹å™¨å†…ç½‘åœ°å€ï¼‰</h2><h3 id="4-5-Service"><a href="#4-5-Service" class="headerlink" title="4.5 Service"></a>4.5 Service</h3><p><strong>é€šè¿‡ä¸ŠèŠ‚è¯¾çš„å­¦ä¹ ï¼Œå·²ç»èƒ½å¤Ÿåˆ©ç”¨Deploymentæ¥åˆ›å»ºä¸€ç»„Podæ¥æä¾›å…·æœ‰é«˜å¯ç”¨æ€§çš„æœåŠ¡ã€‚</strong></p><p><strong>è™½ç„¶æ¯ä¸ªPodéƒ½ä¼šåˆ†é…ä¸€ä¸ªå•ç‹¬çš„Pod IPï¼Œç„¶è€Œå´å­˜åœ¨å¦‚ä¸‹ä¸¤é—®é¢˜ï¼š</strong></p><ul><li><strong>Pod IP ä¼šéšç€Podçš„é‡å»ºäº§ç”Ÿå˜åŒ–</strong></li><li><strong>Pod IP ä»…ä»…æ˜¯é›†ç¾¤å†…å¯è§çš„è™šæ‹ŸIPï¼Œå¤–éƒ¨æ— æ³•è®¿é—®</strong></li></ul><p><strong>è¿™æ ·å¯¹äºè®¿é—®è¿™ä¸ªæœåŠ¡å¸¦æ¥äº†éš¾åº¦ã€‚å› æ­¤ï¼Œkubernetesè®¾è®¡äº†Serviceæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</strong></p><p><strong>Serviceå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç»„åŒç±»Pod<strong><strong>å¯¹å¤–çš„è®¿é—®æ¥å£</strong></strong>ã€‚å€ŸåŠ©Serviceï¼Œåº”ç”¨å¯ä»¥</strong>æ–¹ä¾¿åœ°å®ç°æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_d8ec1d17faa4adf177b12d6b4f78597a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_d8ec1d17faa4adf177b12d6b4f78597a.png"></p><h3 id="4-5-1-åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯è®¿é—®çš„Service"><a href="#4-5-1-åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯è®¿é—®çš„Service" class="headerlink" title="4.5.1 åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯è®¿é—®çš„Service"></a>4.5.1 åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯è®¿é—®çš„Service</h3><p>å‰é¢ç¬¬5èŠ‚æˆ‘ä»¬åˆ›å»ºçš„pod è¦è®¿é—®ä»–éœ€è¦æŸ¥çœ‹ä»–çš„IP ä½†æ˜¯æ­¤IPæ˜¯èƒ½é›†ç¾¤å†…éƒ¨è®¿é—® IPè¿˜ä¼šå˜åŒ– å¹¶ä¸”å¤–é¢ç¯å¢ƒæ˜¯æ— æ³•è®¿é—®çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹devä¸‹é¢podä¿¡æ¯</span></span><br><span class="line">kubectl get pods -n dev -o wide</span><br></pre></td></tr></table></figure><h2 id="ä¸€-åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service"><a href="#ä¸€-åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service" class="headerlink" title="ä¸€. åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service"></a>ä¸€. åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service</h2><h3 id="1ã€é›†ç¾¤å†…éƒ¨è®¿é—®"><a href="#1ã€é›†ç¾¤å†…éƒ¨è®¿é—®" class="headerlink" title="1ã€é›†ç¾¤å†…éƒ¨è®¿é—®"></a>1ã€é›†ç¾¤å†…éƒ¨è®¿é—®</h3><p><strong>ç¯å¢ƒå‡†å¤‡ï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span>  <span class="comment"># ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span>     <span class="comment"># ç±»å‹</span></span><br><span class="line"><span class="attr">metadata:</span>            <span class="comment"># æºæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx</span>        <span class="comment"># å½“å‰deploymentæ‰€å±çš„åå­—</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>     <span class="comment"># åŠns</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span>        <span class="comment"># å®šä¹‰å‰¯æœ¬æ•°</span></span><br><span class="line">  <span class="attr">selector:</span>          <span class="comment"># æ ‡ç­¾é€‰æ‹©å™¨ é€‰æ‹©æ ‡ç­¾è¿›è¡Œæ“ä½œ</span></span><br><span class="line">    <span class="attr">matchLabels:</span>     <span class="comment"># é€‰æ‹©nginxæ ‡ç­¾</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span>          <span class="comment"># ä»¥ä¸‹ä¸ºpod æ¨¡æ¿</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span>        <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">nginx</span>   <span class="comment"># å®šä¹‰æ ‡ç­¾ä¸ºnginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">svc-nginx1</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">protocol:</span> <span class="string">TCP</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹deployment</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹deployment</span></span><br><span class="line">kubectl get deployment</span><br><span class="line"><span class="comment"># æŸ¥çœ‹podè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">kubectl get pods -n dev -o wide --show-labels</span><br></pre></td></tr></table></figure><p><strong>å‚æ•°ï¼š</strong></p><ul><li><strong>â€“port: 80  ç¨‹åºå†…éƒ¨ç«¯å£</strong></li><li><strong>â€“target-port:  80  éœ€è¦æš´éœ²çš„ç«¯å£å³80è½¬å‘åˆ°80</strong></li><li>**deploy nginx :  **nginxä¸ºdeploymentåç§°</li><li>**â€“name=svc-nginx1:  **<strong>æ­¤ä¸ºsvcåç§°</strong></li></ul><p><strong>è¿”å›:</strong></p><ul><li><strong>ClusterIP: 10.108.11.19   ä¸ºé›†ç¾¤IP  åªæœ‰é›†ç¾¤å†…éƒ¨æ‰å¯ä»¥è®¿é—®</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service</span></span><br><span class="line">kubectl expose deploy nginx --name=svc-nginx1  --<span class="built_in">type</span>=ClusterIP --port=80 --target-port=80 -n dev</span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">kubectl get svc -n dev -o wide</span><br><span class="line">curl 10.108.11.19</span><br></pre></td></tr></table></figure><p>**æ­¤æ—¶æˆ‘ä»¬è®¿é—®å°±ä¸è®¿é—®podIPäº†æˆ‘ä»¬è®¿é—®serviceçš„ipåŠ ç«¯å£  æ­¤æ—¶å…¶å®æ˜¯åšäº†ä¸€ä¸ªè´Ÿè½½å‡è¡¡ä»–ä¼šéšæœºè½¬å‘åˆ°ä¸€ä¸ªpodå»æä¾›æœåŠ¡ **</p><h3 id="2ã€å®ç°é›†ç¾¤å¤–éƒ¨è®¿é—®"><a href="#2ã€å®ç°é›†ç¾¤å¤–éƒ¨è®¿é—®" class="headerlink" title="2ã€å®ç°é›†ç¾¤å¤–éƒ¨è®¿é—®"></a>2ã€å®ç°é›†ç¾¤å¤–éƒ¨è®¿é—®</h3><ul><li><strong>ä¸Šé¢åˆ›å»ºçš„Serviceçš„typeç±»å‹ä¸ºClusterIPï¼Œè¿™ä¸ªipåœ°å€åªç”¨é›†ç¾¤å†…éƒ¨å¯è®¿é—®</strong></li><li><strong>å¦‚æœéœ€è¦åˆ›å»ºå¤–éƒ¨ä¹Ÿå¯ä»¥è®¿é—®çš„Serviceï¼Œéœ€è¦ä¿®æ”¹typeä¸ºNodePort</strong></li><li><strong>â€“name=svc-nginx2  ns devä¸‹deployment podæ§åˆ¶å™¨nginxä¼šå†åˆ›å»ºä¸€ä¸ªpodåç§°ä¸ºsvc-nginx2çš„å®¹å™¨</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é›†ç¾¤å¤–éƒ¨è®¿é—®</span></span><br><span class="line">kubectl expose deploy nginx --name=svc-nginx2  --<span class="built_in">type</span>=NodePort --port=80 --target-port=80 -n dev</span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">kubectl get svc -n dev --show-labels -o wide</span><br></pre></td></tr></table></figure><h3 id="3ã€åˆ é™¤service"><a href="#3ã€åˆ é™¤service" class="headerlink" title="3ã€åˆ é™¤service"></a>3ã€åˆ é™¤service</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤service</span></span><br><span class="line">kubectl delete svc svc-nginx2 -n dev</span><br></pre></td></tr></table></figure><h3 id="4ã€é…ç½®æ–¹å¼"><a href="#4ã€é…ç½®æ–¹å¼" class="headerlink" title="4ã€é…ç½®æ–¹å¼"></a>4ã€é…ç½®æ–¹å¼</h3><p><strong>åˆ›å»ºä¸€ä¸ªsvc-nginx.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</strong></p><p><strong>éœ€è¦ä¿®æ”¹typeä¸º</strong>NodePort <strong>ï¼ˆä¿®æ”¹typeç±»å‹ä¸ºNodePortå³å¯å®ç°å¤–éƒ¨è®¿é—®ï¼‰</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">svc-nginx</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">clusterIP:</span> <span class="number">10.109</span><span class="number">.179</span><span class="number">.231</span> <span class="comment"># å›ºå®šsvcçš„å†…ç½‘ip</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">80</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ClusterIP</span></span><br></pre></td></tr></table></figure><p><strong>ç„¶åå°±å¯ä»¥æ‰§è¡Œå¯¹åº”çš„åˆ›å»ºå’Œåˆ é™¤å‘½ä»¤äº†ï¼š</strong></p><p><strong>åˆ›å»ºï¼škubectl create -f svc-nginx.yaml</strong></p><p><strong>åˆ é™¤ï¼škubectl delete -f svc-nginx.yaml</strong></p><p><strong>å°ç»“</strong></p><p><strong>è‡³æ­¤ï¼Œå·²ç»æŒæ¡äº†Namespaceã€Podã€Deploymentã€Serviceèµ„æºçš„åŸºæœ¬æ“ä½œï¼Œæœ‰äº†è¿™äº›æ“ä½œï¼Œå°±å¯ä»¥åœ¨kubernetesé›†ç¾¤ä¸­å®ç°ä¸€ä¸ªæœåŠ¡çš„ç®€å•éƒ¨ç½²å’Œè®¿é—®äº†ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦æ›´å¥½çš„ä½¿ç”¨kubernetesï¼Œå°±éœ€è¦æ·±å…¥å­¦ä¹ è¿™å‡ ç§èµ„æºçš„ç»†èŠ‚å’ŒåŸç†ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>3ã€k8sèµ„æºç®¡ç†å‘½ä»¤å¼å¯¹è±¡é…ç½®</title>
      <link href="/2024/12/02/3%E3%80%81k8s%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4%E5%BC%8F%E5%AF%B9%E8%B1%A1%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/12/02/3%E3%80%81k8s%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4%E5%BC%8F%E5%AF%B9%E8%B1%A1%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="3ã€k8sèµ„æºç®¡ç†å‘½ä»¤å¼å¯¹è±¡é…ç½®"><a href="#3ã€k8sèµ„æºç®¡ç†å‘½ä»¤å¼å¯¹è±¡é…ç½®" class="headerlink" title="3ã€k8sèµ„æºç®¡ç†å‘½ä»¤å¼å¯¹è±¡é…ç½®"></a>3ã€k8sèµ„æºç®¡ç†å‘½ä»¤å¼å¯¹è±¡é…ç½®</h2><h2 id="ä¸€-å‘½ä»¤å¼å¯¹è±¡é…ç½®ï¼ˆæœ¬æ–‡æ¡£ç ”ç©¶æ€ä¹ˆä½¿ç”¨-ä¸ç ”ç©¶æ€ä¹ˆç¼–å†™ï¼‰"><a href="#ä¸€-å‘½ä»¤å¼å¯¹è±¡é…ç½®ï¼ˆæœ¬æ–‡æ¡£ç ”ç©¶æ€ä¹ˆä½¿ç”¨-ä¸ç ”ç©¶æ€ä¹ˆç¼–å†™ï¼‰" class="headerlink" title="ä¸€. å‘½ä»¤å¼å¯¹è±¡é…ç½®ï¼ˆæœ¬æ–‡æ¡£ç ”ç©¶æ€ä¹ˆä½¿ç”¨ ä¸ç ”ç©¶æ€ä¹ˆç¼–å†™ï¼‰"></a>ä¸€. å‘½ä»¤å¼å¯¹è±¡é…ç½®ï¼ˆæœ¬æ–‡æ¡£ç ”ç©¶æ€ä¹ˆä½¿ç”¨ ä¸ç ”ç©¶æ€ä¹ˆç¼–å†™ï¼‰</h2><ul><li>å‘½ä»¤å¼å¯¹è±¡é…ç½®ï¼šé€šè¿‡å‘½ä»¤é…ç½® + é…ç½®æ–‡ä»¶å»æ“ä½œ k8s èµ„æº</li><li><strong>å³å°†å‘½ä»¤å†™åˆ°æ–‡ä»¶ä¸­ç±»ä¼¼äº docker-composeï¼ˆå‚æ•° create/patch == åˆ›å»º/æ›´æ–° å³è¦åšçš„äº‹æ˜¯ é€šè¿‡æ–‡ä»¶ åˆ›å»ºå’Œæ›´æ–° nginx-pod è¦åšçš„äº‹æƒ…å®šä¹‰åœ¨ nginx-pod æ–‡ä»¶ä¸­ ï¼‰</strong></li></ul><p><strong>kubectl create/patch -f nginx-pod.yaml</strong></p><h3 id="3-3-2-å‘½ä»¤å¼å¯¹è±¡é…ç½®"><a href="#3-3-2-å‘½ä»¤å¼å¯¹è±¡é…ç½®" class="headerlink" title="3.3.2 å‘½ä»¤å¼å¯¹è±¡é…ç½®"></a><code>3.3.2</code> å‘½ä»¤å¼å¯¹è±¡é…ç½®</h3><p><strong>å‘½ä»¤å¼å¯¹è±¡é…ç½®å°±æ˜¯ä½¿ç”¨å‘½ä»¤é…åˆé…ç½®æ–‡ä»¶ä¸€èµ·æ¥æ“ä½œkubernetesèµ„æºã€‚</strong></p><h4 id="1-åˆ›å»ºä¸€ä¸ªnginxpod-yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š"><a href="#1-åˆ›å»ºä¸€ä¸ªnginxpod-yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š" class="headerlink" title="1.åˆ›å»ºä¸€ä¸ªnginxpod.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š"></a><code>1.</code>åˆ›å»ºä¸€ä¸ª<code>nginxpod.yaml</code>ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"># å‘½åç©ºé—´çš„å£°æ˜ åˆ›å»ºä¸€ä¸ªdevçš„namespace</span><br><span class="line">apiVersion: v1   # ç‰ˆæœ¬</span><br><span class="line">kind: Namespace  # ç±»å‹</span><br><span class="line">metadata:        # æè¿°åç§°ä¸ºdev </span><br><span class="line">  name: dev</span><br><span class="line"></span><br><span class="line">---</span><br><span class="line"></span><br><span class="line">apiVersion: v1      # ç‰ˆæœ¬</span><br><span class="line">kind: Pod           # ç±»å‹æ˜¯pod </span><br><span class="line">metadata:           # æè¿°å¦‚ä¸‹</span><br><span class="line">  name: nginxpod    # åå­—å«nginxpod</span><br><span class="line">  namespace: dev    # æ‰€åœ¨åç§°ç©ºé—´å«dev</span><br><span class="line">spec:               # è¯¦ç»†æè¿°å¦‚ä¸‹</span><br><span class="line">  containers:</span><br><span class="line">  - name: nginx-containers # podä¸­å®¹å™¨çš„åå­—å«nginx-containers</span><br><span class="line">    image: nginx:latest    # å®¹å™¨ä½¿ç”¨çš„é•œåƒnginx:latest æˆ– ç§æœ‰é•œåƒä»“åº“ registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span><br></pre></td></tr></table></figure><p><strong>ä¸Šé¢æ–‡ä»¶å†…å®¹ç­‰åŒäºå‘½ä»¤</strong></p><p><strong>kubectl create deployment nginx â€“image=registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest -n dev</strong></p><h4 id="2-æ‰§è¡Œcreateå‘½ä»¤ï¼Œåˆ›å»ºèµ„æºâ‘®"><a href="#2-æ‰§è¡Œcreateå‘½ä»¤ï¼Œåˆ›å»ºèµ„æºâ‘®" class="headerlink" title="2. æ‰§è¡Œcreateå‘½ä»¤ï¼Œåˆ›å»ºèµ„æºâ‘®"></a>2. æ‰§è¡Œ<code>create</code>å‘½ä»¤ï¼Œåˆ›å»ºèµ„æºâ‘®</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºèµ„æº</span><br><span class="line">kubectl create -f nginxpod.yml</span><br></pre></td></tr></table></figure><h4 id="3-æ‰§è¡Œgetå‘½ä»¤ï¼ŒæŸ¥çœ‹èµ„æº"><a href="#3-æ‰§è¡Œgetå‘½ä»¤ï¼ŒæŸ¥çœ‹èµ„æº" class="headerlink" title="3. æ‰§è¡Œgetå‘½ä»¤ï¼ŒæŸ¥çœ‹èµ„æº"></a><code>3.</code> æ‰§è¡Œ<code>get</code>å‘½ä»¤ï¼ŒæŸ¥çœ‹èµ„æº</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl get ns</span><br><span class="line">kubectl get pod  -n dev</span><br></pre></td></tr></table></figure><p><strong>æ‰§è¡Œååˆ›å»ºäº†ä¸¤ä¸ªèµ„æº</strong></p><ul><li>namespace: dev</li><li><strong>pod: nginxpod</strong></li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_b672bd2b47e40d7caa6379b515bb09ea.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_b672bd2b47e40d7caa6379b515bb09ea.png"></p><h4 id="4-åˆ é™¤èµ„æº"><a href="#4-åˆ é™¤èµ„æº" class="headerlink" title="4.åˆ é™¤èµ„æº"></a><code>4</code>.åˆ é™¤èµ„æº</h4><p><strong>é…ç½®æ–‡ä»¶åˆ é™¤æ–¹å¼</strong></p><p><strong>kubectl delete -f nginxpod.yml</strong></p><p><strong>å‘½ä»¤è¡Œæ–¹å¼</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># æ­¤æ—¶æŸ¥çœ‹å‘ç°è¿˜æœ‰ å…¶å®ä¹‹å‰çš„æˆ‘ä»¬å·²ç»åˆ äº† åªæ˜¯å®ƒåˆé‡æ–°å¯åŠ¨äº†ä¸€ä¸ªè€Œå·²</span><br><span class="line">kubectl get pods -n dev</span><br><span class="line"># åˆ é™¤dev namespace(ç¨å¾®ç­‰å¾…ä¸€ä¼šå„¿) </span><br><span class="line">kubectl delete ns dev</span><br></pre></td></tr></table></figure><h2 id="äºŒ-æ€»ç»“"><a href="#äºŒ-æ€»ç»“" class="headerlink" title="äºŒ. æ€»ç»“"></a>äºŒ. æ€»ç»“</h2><p><strong>å‘½ä»¤å¼å¯¹è±¡é…ç½®çš„æ–¹å¼æ“ä½œèµ„æºã€å¯ä»¥ç®€å•çš„è®¤ä¸ºï¼šå‘½ä»¤ + yamlé…ç½®æ–‡ä»¶ï¼ˆé‡Œé¢æ˜¯å‘½ä»¤éœ€è¦çš„å„ç§å‚æ•°ï¼‰</strong></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>2ã€k8sèµ„æºç®¡ç†_å‘½ä»¤å¼å¯¹è±¡ç®¡ç†æ¼”ç¤ºç®€å•åˆ›å»ºåˆ é™¤</title>
      <link href="/2024/12/02/2%E3%80%81k8s%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86_%E5%91%BD%E4%BB%A4%E5%BC%8F%E5%AF%B9%E8%B1%A1%E7%AE%A1%E7%90%86%E6%BC%94%E7%A4%BA%E7%AE%80%E5%8D%95%E5%88%9B%E5%BB%BA%E5%88%A0%E9%99%A4/"/>
      <url>/2024/12/02/2%E3%80%81k8s%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86_%E5%91%BD%E4%BB%A4%E5%BC%8F%E5%AF%B9%E8%B1%A1%E7%AE%A1%E7%90%86%E6%BC%94%E7%A4%BA%E7%AE%80%E5%8D%95%E5%88%9B%E5%BB%BA%E5%88%A0%E9%99%A4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="2ã€k8sèµ„æºç®¡ç†-å‘½ä»¤å¼å¯¹è±¡ç®¡ç†æ¼”ç¤ºç®€å•åˆ›å»ºåˆ é™¤"><a href="#2ã€k8sèµ„æºç®¡ç†-å‘½ä»¤å¼å¯¹è±¡ç®¡ç†æ¼”ç¤ºç®€å•åˆ›å»ºåˆ é™¤" class="headerlink" title="2ã€k8sèµ„æºç®¡ç†_å‘½ä»¤å¼å¯¹è±¡ç®¡ç†æ¼”ç¤ºç®€å•åˆ›å»ºåˆ é™¤"></a>2ã€k8sèµ„æºç®¡ç†_å‘½ä»¤å¼å¯¹è±¡ç®¡ç†æ¼”ç¤ºç®€å•åˆ›å»ºåˆ é™¤</h2><h2 id="k8s-çš„èµ„æºç®¡ç†æ–¹å¼"><a href="#k8s-çš„èµ„æºç®¡ç†æ–¹å¼" class="headerlink" title="k8s çš„èµ„æºç®¡ç†æ–¹å¼"></a><code>k8s</code> çš„èµ„æºç®¡ç†æ–¹å¼</h2><ul><li><strong>å‘½ä»¤å¼å¯¹è±¡ç®¡ç†ï¼šç›´æ¥ä½¿ç”¨å‘½ä»¤å»æ“ä½œ k8s èµ„æºï¼ˆå‚æ•° nginx-pod ä¸º pod åç§°ï¼‰</strong></li></ul><p>kubectl run nginx-pod â€“image=nginx:1.17.1 â€“port=80</p><ul><li><strong>å‘½ä»¤å¼å¯¹è±¡é…ç½®ï¼šé€šè¿‡å‘½ä»¤é…ç½®å’Œé…ç½®æ–‡ä»¶å»æ“ä½œ k8s èµ„æº å³å°†å‘½ä»¤å†™åˆ°æ–‡ä»¶ä¸­ç±»ä¼¼äº docker-composeï¼ˆå‚æ•° create/patch == åˆ›å»º/æ›´æ–° å³è¦åšçš„äº‹æ˜¯ é€šè¿‡æ–‡ä»¶ åˆ›å»ºå’Œæ›´æ–° nginx-pod è¦åšçš„äº‹æƒ…å®šä¹‰åœ¨ nginx-pod æ–‡ä»¶ä¸­ ï¼‰</strong></li></ul><p>nginx-pod.yamlæ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Namespace</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">dev</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginxpod</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-containers</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">nginx:latest</span></span><br></pre></td></tr></table></figure><p><strong>kubectl create/patch -f nginx-pod.yaml</strong></p><ul><li><strong>å£°æ˜å¼å¯¹è±¡é…ç½®ï¼šé€šè¿‡ apply å‘½ä»¤å’Œé…ç½®æ–‡ä»¶å»æ“ä½œ k8s èµ„æºï¼ˆ apply åªç”¨äºåˆ›å»ºå’Œæ›´æ–°èµ„æº å³å¦‚æœæœ‰åˆ™æ›´æ–°èµ„æº æ— åˆ™åˆ›å»ºèµ„æº å¦‚åˆ é™¤åˆ™éœ€è¦ç”¨ kubectl deleteï¼‰</strong></li></ul><p><strong>kubectl apply -f nginx-pod.yaml</strong></p><h3 id="ä¸Šè¿°ä¸‰ç§æ–¹å¼ä¼˜ç¼ºç‚¹å’Œåº”ç”¨åœºæ™¯"><a href="#ä¸Šè¿°ä¸‰ç§æ–¹å¼ä¼˜ç¼ºç‚¹å’Œåº”ç”¨åœºæ™¯" class="headerlink" title="ä¸Šè¿°ä¸‰ç§æ–¹å¼ä¼˜ç¼ºç‚¹å’Œåº”ç”¨åœºæ™¯"></a>ä¸Šè¿°ä¸‰ç§æ–¹å¼ä¼˜ç¼ºç‚¹å’Œåº”ç”¨åœºæ™¯</h3><table><thead><tr><th><strong>ç±»å‹</strong></th><th><strong>æ“ä½œå¯¹è±¡</strong></th><th><strong>é€‚ç”¨ç¯å¢ƒ</strong></th><th><strong>ä¼˜ç‚¹</strong></th><th><strong>ç¼ºç‚¹</strong></th></tr></thead><tbody><tr><td><strong>å‘½ä»¤å¼å¯¹åƒç®¡ç†</strong></td><td><strong>å¯¹è±¡</strong></td><td><strong>æµ‹è¯•</strong></td><td><strong>ç®€å•</strong></td><td><strong>åªèƒ½æ“ä½œæ´»åŠ¨å¯¹è±¡ï¼Œæ— æ³•å®¡è®¡ï¼Œè·Ÿè¸ª</strong></td></tr><tr><td><strong>å‘½ä»¤å¼å¯¹è±¡é…ç½®</strong></td><td><strong>æ–‡ä»¶</strong></td><td><strong>å¼€å‘</strong></td><td><strong>å¯ä»¥å®¡è®¡ï¼Œè·Ÿè¸ª</strong></td><td><strong>é¡¹ç›®å¤§æ—¶ï¼Œé…ç½®æ–‡ä»¶å¤šï¼Œæ“ä½œéº»çƒ¦</strong></td></tr><tr><td><strong>å£°æ˜å¼å¯¹è±¡é…ç½®</strong></td><td><strong>ç›®å½•</strong></td><td><strong>å¼€å‘</strong></td><td><strong>æ”¯æŒç›®å½•æ“ä½œ</strong></td><td><strong>æ„å¤–æƒ…å†µä¸‹éš¾ä»¥è°ƒè¯•</strong></td></tr></tbody></table><h2 id="ä¸€-å‘½ä»¤å¼å¯¹è±¡ç®¡ç†"><a href="#ä¸€-å‘½ä»¤å¼å¯¹è±¡ç®¡ç†" class="headerlink" title="ä¸€. å‘½ä»¤å¼å¯¹è±¡ç®¡ç†"></a>ä¸€. å‘½ä»¤å¼å¯¹è±¡ç®¡ç†</h2><p>kubectlå‘½ä»¤</p><p><strong>kubectl æ˜¯ kuberbetes é›†ç¾¤çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œé€šè¿‡å®ƒèƒ½å¤Ÿå¯¹é›†ç¾¤æœ¬èº«è¿›è¡Œç®¡ç†ï¼Œå¹¶èƒ½å¤Ÿåœ¨é›†ç¾¤ä¸Šè¿›è¡Œå®¹å™¨åŒ–åº”ç”¨çš„å®‰è£…éƒ¨ç½²ã€‚kubectlå‘½ä»¤çš„è¯­æ³•å¦‚ä¸‹ï¼š</strong></p><p><strong>kubectl ã€conmandã€‘ã€typeã€‘ã€nameã€‘ã€flagsã€‘</strong></p><p><strong>conmandï¼š</strong>æŒ‡å®šè¦å¯¹èµ„æºæ‰§è¡Œçš„æ“ä½œã€ä¾‹å¦‚createã€getã€deleteã€apply</p><p><strong>type:</strong> æŒ‡å®šèµ„æºç±»å‹ï¼Œæ¯”å¦‚ deploymentï¼Œpodï¼Œservice</p><p><strong>nameï¼š</strong>æŒ‡å®šèµ„æºçš„åç§° åç§°å¤§å°å†™æ•æ„Ÿ</p><p><strong>flagsï¼š</strong>æŒ‡å®šé¢å¤–çš„å¯é€‰å‚æ•°</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ‰€æœ‰pod</span></span><br><span class="line">kubectl get pod</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŸä¸ªpod</span></span><br><span class="line">kubectl get pod pod_name</span><br><span class="line"><span class="comment"># æŸ¥çœ‹podè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">kubectl get pod pod_name -o wide</span><br><span class="line"><span class="comment"># ä»¥jsonå½¢å¼æ˜¾ç¤º</span></span><br><span class="line">kubectl get pod pod_name -o json</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æŸä¸ªpodä»¥yamlæ–¹å¼æ˜¾ç¤ºç»“æœ</span></span><br><span class="line">kubectl get pod pod_name -o yaml</span><br></pre></td></tr></table></figure><p><strong>æŸ¥è¯¢</strong><code>&lt;span class=&quot;ne-text&quot;&gt;pod&lt;/span&gt;</code></p><h3 id="1-ä¸Šæ–¹-commond-æ“ä½œ"><a href="#1-ä¸Šæ–¹-commond-æ“ä½œ" class="headerlink" title="1. ä¸Šæ–¹ commond`æ“ä½œ"></a><code>1.</code> ä¸Šæ–¹ commond`æ“ä½œ</h3><p><strong>kuberneteså…è®¸å¯¹èµ„æºè¿›è¡Œå¤šç§æ“ä½œï¼Œå¯ä»¥é€šè¿‡â€“helpæŸ¥çœ‹è¯¦ç»†çš„æ“ä½œå‘½ä»¤</strong></p><p><strong>kubectl â€“help</strong></p><p><strong>ç»å¸¸ä½¿ç”¨çš„æ“ä½œæœ‰ä¸‹é¢è¿™äº›ï¼š</strong></p><table><thead><tr><th><strong>å‘½ä»¤åˆ†ç±»</strong></th><th><strong>å‘½ä»¤</strong></th><th><strong>ç¿»è¯‘</strong></th><th><strong>å‘½ä»¤ä½œç”¨</strong></th></tr></thead><tbody><tr><td><strong>åŸºæœ¬å‘½ä»¤</strong></td><td><strong>create</strong></td><td><strong>åˆ›å»º</strong></td><td><strong>åˆ›å»ºä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>edit</strong></td><td><strong>ç¼–è¾‘</strong></td><td><strong>ç¼–è¾‘ä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>get</strong></td><td><strong>è·å–</strong></td><td><strong>è·å–ä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>patch</strong></td><td><strong>æ›´æ–°</strong></td><td><strong>æ›´æ–°ä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>delete</strong></td><td><strong>åˆ é™¤</strong></td><td><strong>åˆ é™¤ä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>explain</strong></td><td><strong>è§£é‡Š</strong></td><td><strong>å±•ç¤ºèµ„æºæ–‡æ¡£</strong></td></tr><tr><td><strong>è¿è¡Œå’Œè°ƒè¯•</strong></td><td><strong>run</strong></td><td><strong>è¿è¡Œ</strong></td><td><strong>åœ¨é›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„é•œåƒ</strong></td></tr><tr><td></td><td><strong>expose</strong></td><td><strong>æš´éœ²</strong></td><td><strong>æš´éœ²èµ„æºä¸º Service</strong></td></tr><tr><td></td><td><strong>describe</strong></td><td><strong>æè¿°</strong></td><td><strong>æ˜¾ç¤ºèµ„æºå†…éƒ¨ä¿¡æ¯</strong></td></tr><tr><td></td><td><strong>logs</strong></td><td><strong>æ—¥å¿—è¾“å‡ºå®¹å™¨åœ¨ pod ä¸­çš„æ—¥å¿—</strong></td><td><strong>è¾“å‡ºå®¹å™¨åœ¨ pod ä¸­çš„æ—¥å¿—</strong></td></tr><tr><td></td><td><strong>attach</strong></td><td><strong>ç¼ ç»•è¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨</strong></td><td><strong>è¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨</strong></td></tr><tr><td></td><td><strong>exec</strong></td><td><strong>æ‰§è¡Œå®¹å™¨ä¸­çš„ä¸€ä¸ªå‘½ä»¤</strong></td><td><strong>æ‰§è¡Œå®¹å™¨ä¸­çš„ä¸€ä¸ªå‘½ä»¤</strong></td></tr><tr><td></td><td><strong>cp</strong></td><td><strong>å¤åˆ¶</strong></td><td><strong>åœ¨Podå†…å¤–å¤åˆ¶æ–‡ä»¶</strong></td></tr><tr><td></td><td><strong>rollout</strong></td><td><strong>é¦–æ¬¡å±•ç¤º</strong></td><td><strong>ç®¡ç†èµ„æºçš„å‘å¸ƒ</strong></td></tr><tr><td></td><td><strong>scale</strong></td><td><strong>è§„æ¨¡</strong></td><td><strong>æ‰©(ç¼©)å®¹Podçš„æ•°é‡</strong></td></tr><tr><td></td><td><strong>autoscale</strong></td><td><strong>è‡ªåŠ¨è°ƒæ•´</strong></td><td><strong>è‡ªåŠ¨è°ƒæ•´Podçš„æ•°é‡</strong></td></tr><tr><td><strong>é«˜çº§å‘½ä»¤</strong></td><td><strong>apply</strong></td><td><strong>rc</strong></td><td><strong>é€šè¿‡æ–‡ä»¶å¯¹èµ„æºè¿›è¡Œé…ç½®</strong></td></tr><tr><td></td><td><strong>label</strong></td><td><strong>æ ‡ç­¾</strong></td><td><strong>æ›´æ–°èµ„æºä¸Šçš„æ ‡ç­¾</strong></td></tr><tr><td><strong>å…¶ä»–å‘½ä»¤</strong></td><td><strong>cluster-info</strong></td><td><strong>é›†ç¾¤ä¿¡æ¯</strong></td><td><strong>æ˜¾ç¤ºé›†ç¾¤ä¿¡æ¯</strong></td></tr><tr><td></td><td><strong>version</strong></td><td><strong>ç‰ˆæœ¬</strong></td><td><strong>æ˜¾ç¤ºå½“å‰Serverå’ŒClientçš„ç‰ˆæœ¬</strong></td></tr></tbody></table><h4 id="a-æ¼”ç¤ºä¸Šæ–¹æ“ä½œå¦‚ä¸‹"><a href="#a-æ¼”ç¤ºä¸Šæ–¹æ“ä½œå¦‚ä¸‹" class="headerlink" title="a. æ¼”ç¤ºä¸Šæ–¹æ“ä½œå¦‚ä¸‹"></a>a. æ¼”ç¤ºä¸Šæ–¹æ“ä½œå¦‚ä¸‹</h4><p><strong>â‘ .åŸºæœ¬å‘½ä»¤</strong></p><p><strong>â‘¡.è¿è¡Œå’Œè°ƒè¯•</strong></p><ul><li><strong>kubectl expose deploy nginx â€“port=80 â€“target-port=80 â€“type=NodePort æš´éœ²ç«¯å£</strong></li><li><strong>kubectl describe pod nginx-54b7d798b5-2cxdv æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯</strong></li></ul><h3 id="2-èµ„æºç±»å‹å¯¹åº”ä¸Šæ–¹"><a href="#2-èµ„æºç±»å‹å¯¹åº”ä¸Šæ–¹" class="headerlink" title="2.èµ„æºç±»å‹å¯¹åº”ä¸Šæ–¹``"></a><code>2.</code><strong>èµ„æºç±»å‹å¯¹åº”ä¸Šæ–¹</strong>``</h3><p><code>kubernetes</code><strong>ä¸­æ‰€æœ‰çš„å†…å®¹éƒ½æŠ½è±¡ä¸ºèµ„æºï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹:</strong></p><p><strong>kubectl api-resources</strong></p><p><strong>ç»å¸¸ä½¿ç”¨çš„èµ„æºæœ‰ä¸‹é¢è¿™äº›ï¼š</strong></p><table><thead><tr><th><strong>èµ„æºåˆ†ç±»</strong></th><th><strong>èµ„æºåç§°</strong></th><th><strong>ç¼©å†™</strong></th><th><strong>èµ„æºä½œç”¨</strong></th></tr></thead><tbody><tr><td><strong>é›†ç¾¤çº§åˆ«èµ„æº</strong></td><td><strong>nodes</strong></td><td><strong>no</strong></td><td><strong>é›†ç¾¤ç»„æˆéƒ¨åˆ†</strong></td></tr><tr><td><strong>namespaces</strong></td><td><strong>ns</strong></td><td><strong>éš”ç¦»Pod</strong></td><td></td></tr><tr><td><strong>podèµ„æº</strong></td><td><strong>pods</strong></td><td><strong>po</strong></td><td><strong>è£…è½½å®¹å™¨</strong></td></tr><tr><td><strong>podèµ„æºæ§åˆ¶å™¨</strong></td><td><strong>replicationcontrollers</strong></td><td><strong>rc</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>replicasets</strong></td><td><strong>rs</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>deployments</strong></td><td><strong>deploy</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>daemonsets</strong></td><td><strong>ds</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>jobs</strong></td><td></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>cronjobs</strong></td><td><strong>cj</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>horizontalpodautoscalers</strong></td><td><strong>hpa</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>statefulsets</strong></td><td><strong>sts</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td><strong>æœåŠ¡å‘ç°èµ„æº</strong></td><td><strong>services</strong></td><td><strong>svc</strong></td><td><strong>ç»Ÿä¸€podå¯¹å¤–æ¥å£</strong></td></tr><tr><td></td><td><strong>ingress</strong></td><td><strong>ing</strong></td><td><strong>ç»Ÿä¸€podå¯¹å¤–æ¥å£</strong></td></tr><tr><td><strong>å­˜å‚¨èµ„æº</strong></td><td><strong>volumeattachments</strong></td><td></td><td><strong>å­˜å‚¨</strong></td></tr><tr><td></td><td><strong>persistentvolumes</strong></td><td><strong>pv</strong></td><td><strong>å­˜å‚¨</strong></td></tr><tr><td></td><td><strong>persistentvolumeclaims</strong></td><td><strong>pvc</strong></td><td><strong>å­˜å‚¨</strong></td></tr><tr><td><strong>é…ç½®èµ„æº</strong></td><td><strong>configmaps</strong></td><td><strong>cm</strong></td><td><strong>é…ç½®</strong></td></tr><tr><td></td><td><strong>secrets</strong></td><td></td><td><strong>é…ç½®</strong></td></tr></tbody></table><p><strong>nodes</strong></p><ul><li><strong>kubectl get nodes æŸ¥è¯¢èŠ‚ç‚¹ä¿¡æ¯</strong></li></ul><h4 id="a-ä¸‹é¢ä»¥ä¸€ä¸ª-namespace-podçš„åˆ›å»ºå’Œåˆ é™¤ç®€å•æ¼”ç¤ºä¸‹å‘½ä»¤çš„ä½¿ç”¨ï¼š"><a href="#a-ä¸‹é¢ä»¥ä¸€ä¸ª-namespace-podçš„åˆ›å»ºå’Œåˆ é™¤ç®€å•æ¼”ç¤ºä¸‹å‘½ä»¤çš„ä½¿ç”¨ï¼š" class="headerlink" title="a. ä¸‹é¢ä»¥ä¸€ä¸ª namespace / podçš„åˆ›å»ºå’Œåˆ é™¤ç®€å•æ¼”ç¤ºä¸‹å‘½ä»¤çš„ä½¿ç”¨ï¼š"></a>a. ä¸‹é¢ä»¥ä¸€ä¸ª <code>namespace / pod</code>çš„åˆ›å»ºå’Œåˆ é™¤ç®€å•æ¼”ç¤ºä¸‹å‘½ä»¤çš„ä½¿ç”¨ï¼š</h4><p><strong>æŸ¥çœ‹ç¼©å†™å‘½ä»¤ï¼š</strong><code>kubectl api-resources</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºä¸€ä¸ªnamespace</span><br><span class="line">kubectl create namespace dev </span><br><span class="line"># æˆ–è€…ä½¿ç”¨ç¼©å†™ </span><br><span class="line">kubectl create ns dev </span><br><span class="line"># æŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸ</span><br><span class="line">kubectl get ns</span><br><span class="line"># åˆ›å»ºä¸€ä¸ªpodåœ¨devä¸‹é¢ ä¸æŒ‡å®šåˆ™ä¼šåœ¨defaultä¸‹é¢</span><br><span class="line">kubectl create deployment nginx --image=registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest -n dev</span><br><span class="line"># ä½¿ç”¨æ­¤å‘½ä»¤åˆ›å»ºçš„podåˆ é™¤åä¼šè‡ªåŠ¨é‡å»ºéœ€è¦ä½¿ç”¨ä¸‹æ–¹å‘½ä»¤æ‰èƒ½å½»åº•åˆ é™¤</span><br><span class="line"># åŸå› ï¼šå½“ä¸€ä¸ªPodè¢«åˆ é™¤åï¼Œå¦‚æœå®ƒæ˜¯ç”±ä¸€ä¸ªReplicaSetã€Deploymentæˆ–å…¶ä»–æ§åˆ¶å™¨ç®¡ç†çš„ï¼Œé‚£ä¹ˆæ§åˆ¶å™¨ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„Podæ¥æ›¿ä»£è¢«åˆ é™¤çš„Podï¼Œä»¥ç¡®ä¿åº”ç”¨çš„å¯ç”¨æ€§å’Œå‰¯æœ¬æ•°ç›®çš„ä¸€è‡´æ€§ã€‚</span><br><span class="line">kubectl delete deployment nginx -n dev</span><br><span class="line">kubectl delete service nginx -n dev</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹åˆ›å»ºçš„podè¯¦ç»†ä¿¡æ¯</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹dev å‘½åç©ºé—´ä¸‹é¢çš„pod</span><br><span class="line">kubectl get pod -n dev</span><br><span class="line"># æŸ¥çœ‹åˆ›å»ºè¿‡ç¨‹ä¸­çš„è¯¦ç»†ä¿¡æ¯</span><br><span class="line">kubectl describe pod nginx-54b7d798b5-9p97w -n dev</span><br><span class="line"># åˆ é™¤devä¸‹é¢åˆšåˆšåˆ›å»ºçš„pod</span><br><span class="line">kubectl delete pod nginx-54b7d798b5-9p97w -n dev</span><br><span class="line"># æ­¤æ—¶æŸ¥çœ‹å‘ç°è¿˜æœ‰ å…¶å®ä¹‹å‰çš„æˆ‘ä»¬å·²ç»åˆ äº† åªæ˜¯å®ƒåˆé‡æ–°å¯åŠ¨äº†ä¸€ä¸ªè€Œå·²</span><br><span class="line">kubectl get pods -n dev</span><br><span class="line"># åˆ é™¤dev namespace(ç¨å¾®ç­‰å¾…ä¸€ä¼šå„¿) </span><br><span class="line">kubectl delete ns dev</span><br><span class="line"># æŸ¥çœ‹ns å’Œ podæ­¤æ—¶devæ²¡äº†ä¸‹é¢çš„podä¹Ÿæ²¡äº†</span><br><span class="line">kubectl get ns</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_cd93f06166727df2e0922f4a69f070b2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_cd93f06166727df2e0922f4a69f070b2.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_f20d485db3208befe88b697a698fc5ca.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/12/image_f20d485db3208befe88b697a698fc5ca.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8séƒ¨ç½²webstackï¼ˆstorageclassæ–¹å¼ï¼‰</title>
      <link href="/2024/11/25/k8s%E9%83%A8%E7%BD%B2webstack%EF%BC%88storageclass%E6%96%B9%E5%BC%8F%EF%BC%89/"/>
      <url>/2024/11/25/k8s%E9%83%A8%E7%BD%B2webstack%EF%BC%88storageclass%E6%96%B9%E5%BC%8F%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="k8séƒ¨ç½²webstackï¼ˆstorageclassæ–¹å¼ï¼‰"><a href="#k8séƒ¨ç½²webstackï¼ˆstorageclassæ–¹å¼ï¼‰" class="headerlink" title="k8séƒ¨ç½²webstackï¼ˆstorageclassæ–¹å¼ï¼‰"></a>k8séƒ¨ç½²webstackï¼ˆstorageclassæ–¹å¼ï¼‰</h2><h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p><strong>éƒ¨ç½²MySqlæ—¶æ— æ³•è‡ªåŠ¨åˆ›å»ºwebstackæ•°æ®åº“ æ­¤æ—¶éœ€è¦æ‰‹åŠ¨åˆ›å»º</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç™»å½•</span></span><br><span class="line">mysql -uroot -proot_password -h10.96.0.2</span><br><span class="line">CREATE DATABASE webstack;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><h3 id="ä¸€ã€é…ç½®æ–‡ä»¶ï¼ˆwebstack-ymlï¼‰"><a href="#ä¸€ã€é…ç½®æ–‡ä»¶ï¼ˆwebstack-ymlï¼‰" class="headerlink" title="ä¸€ã€é…ç½®æ–‡ä»¶ï¼ˆwebstack.ymlï¼‰"></a>ä¸€ã€é…ç½®æ–‡ä»¶ï¼ˆwebstack.ymlï¼‰</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mysqlé…ç½®</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ConfigMap</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mysql-cm</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">my.cnf:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    !includedir /etc/mysql/conf.d/</span></span><br><span class="line"><span class="string">    !includedir /etc/mysql/mysql.conf.d/</span></span><br><span class="line"><span class="string"></span>  </span><br><span class="line">    [<span class="string">mysqld</span>]</span><br><span class="line">    <span class="comment">## åŒä¸€å±€åŸŸç½‘å†…æ³¨æ„è¦å”¯ä¸€</span></span><br><span class="line">    <span class="string">server-id=001</span></span><br><span class="line">    <span class="comment">## å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—åŠŸèƒ½ï¼Œå¯ä»¥éšä¾¿å–ï¼ˆå…³é”®ï¼‰</span></span><br><span class="line">    <span class="string">log-bin=mysql-bin</span></span><br><span class="line">  </span><br><span class="line">    <span class="string">gtid_mode=on</span></span><br><span class="line">    <span class="string">enforce_gtid_consistency=on</span></span><br><span class="line">  </span><br><span class="line">    <span class="string">relay-log=relay-log.log</span></span><br><span class="line">    <span class="string">binlog_format=ROW</span></span><br><span class="line">    <span class="comment">#MySQL5.7å¯ä»¥ä¸å¯ç”¨æ­¤å‚æ•°ï¼Œ5.7ç‰ˆæœ¬ä½¿ç”¨äº†gtid_executedè¡¨è®°å½•åŒæ­¥å¤åˆ¶çš„ä¿¡æ¯ï¼Œé¿å…ä¸¤æ¬¡å†™å…¥relay-logå’Œbinlogï¼Œé™ä½äº†ä»åº“ç£ç›˜I/O</span></span><br><span class="line">    <span class="comment">#log_slave_updates=true</span></span><br><span class="line">    <span class="string">master_info_repository=TABLE</span></span><br><span class="line">    <span class="string">relay_log_info_repository=TABLE</span></span><br><span class="line">    <span class="string">sync_master_info=1</span></span><br><span class="line">    <span class="string">slave_parallel_workers=2</span></span><br><span class="line">    <span class="string">binlog_checksum=CRC32</span></span><br><span class="line">    <span class="string">master_verify_checksum=1</span></span><br><span class="line">    <span class="string">slave_sql_verify_checksum=1</span></span><br><span class="line">    <span class="string">binlog_rows_query_log_events=1</span></span><br><span class="line">    <span class="comment">#replicate_do_db=tt</span></span><br><span class="line">    <span class="comment">#MySQL5.7æ–°å¢åŠ çš„å€¼ï¼Œé…ç½®åŸºäºè¡¨çš„ç»„æäº¤å¹¶è¡Œå¤åˆ¶ï¼Œé»˜è®¤å€¼ä¸ºdatabaseï¼ˆåŸºäºåº“è¿›è¡Œå¤šçº¿ç¨‹å¤åˆ¶ï¼ŒMySQL5.6æ˜¯åŸºäºåº“çš„æ–¹å¼è¿›è¡Œå¤šçº¿ç¨‹æ–¹å¼å¤åˆ¶ï¼‰å»ºè®®æ”¹ä¸ºlogical_clockï¼ŒåŸºäºè¡¨çš„ç»„æ–¹å¼å¤åˆ¶ï¼Œæé«˜å¤åˆ¶çš„æ•ˆç‡</span></span><br><span class="line">    <span class="string">slave_parallel_type=logical_clock</span></span><br><span class="line">    <span class="comment">#å¼€å¯é€šç”¨æŸ¥è¯¢æ—¥å¿—</span></span><br><span class="line">    <span class="string">general_log=1</span></span><br><span class="line">    <span class="comment">#è®¾ç½®é€šç”¨æ—¥å¿—çš„è¾“å‡ºæ ¼å¼ä¸ºæ–‡ä»¶å’Œè¡¨</span></span><br><span class="line">    <span class="string">log_output=FILE,TABLE</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql    </span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">mysql</span> <span class="comment"># has to match .spec.template.metadata.labels</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">&quot;mysql&quot;</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span> <span class="comment"># by default is 1               # 3å‰¯æœ¬</span></span><br><span class="line">  <span class="comment"># minReadySeconds: 10 # by default is 0</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">mysql</span> <span class="comment"># has to match .spec.selector.matchLabels</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mysql:5.7</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_ROOT_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;root_password&quot;</span>         <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_DATABASE</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">webstack</span>         <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_USER</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">webstack</span>         <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">MYSQL_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;root_password&quot;</span>  <span class="comment"># è®¾ç½®æ ¹å¯†ç ï¼Œå»ºè®®ä½¿ç”¨ Secrets å­˜å‚¨</span></span><br><span class="line">        <span class="attr">args:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">--character-set-server=utf8mb4</span></span><br><span class="line">          <span class="comment"># - --collation-server=utf8mb4_unicode_ci</span></span><br><span class="line">          <span class="comment"># - &quot;--default-authentication-plugin=mysql_native_password&quot;</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">mountPath:</span> <span class="string">/var/lib/mysql</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">mysql-storage</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-map</span></span><br><span class="line">            <span class="attr">mountPath:</span> <span class="string">&quot;/etc/mysql/my.cnf&quot;</span></span><br><span class="line">            <span class="attr">subPath:</span> <span class="string">my.cnf</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">3306</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">mysql</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">www</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">/var/lib/mysql</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="comment"># å®šä¹‰ ConfigMap ç±»å‹çš„ Volume</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-map</span></span><br><span class="line">          <span class="attr">configMap:</span></span><br><span class="line">            <span class="attr">name:</span> <span class="string">mysql-cm</span>  <span class="comment"># å¼•ç”¨åä¸º mysql-cm çš„ ConfigMap</span></span><br><span class="line">        <span class="comment"># # å®šä¹‰æŒä¹…åŒ–å­˜å‚¨ Volume</span></span><br><span class="line">        <span class="comment"># - name: mysql-storage</span></span><br><span class="line">        <span class="comment">#   persistentVolumeClaim:</span></span><br><span class="line">        <span class="comment">#     claimName: mysql-pvc</span></span><br><span class="line">  <span class="attr">volumeClaimTemplates:</span>                   <span class="comment"># 3å‰¯æœ¬é‡Œé¢éƒ½ä¼šç”³è¯·ä¸€ä¸ªå­˜å‚¨ æ­¤é…ç½®å°±ç±»ä¼¼pvcäº†</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">www</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">accessModes:</span> [ <span class="string">&quot;ReadWriteOnce&quot;</span> ]             <span class="comment"># è®¿é—®æ¨¡å¼ReadWriteOnce å…è®¸ä¸€ä¸ªå®¢æˆ·è¿›è¡Œè¯»å†™</span></span><br><span class="line">      <span class="attr">storageClassName:</span> <span class="string">&quot;managed-nfs-storage&quot;</span>      <span class="comment"># æŒ‡å®šå®šä¹‰çš„StorageClass</span></span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">requests:</span></span><br><span class="line">          <span class="attr">storage:</span> <span class="string">2Gi</span>                             <span class="comment"># ç”³è¯·ç©ºé—´å¤§å°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿mysql ipå›ºå®š</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">service-mysql</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">mysql</span></span><br><span class="line">  <span class="attr">clusterIP:</span> <span class="number">10.96</span><span class="number">.0</span><span class="number">.2</span>  <span class="comment"># serviceçš„ipåœ°å€ï¼Œå¦‚æœä¸å†™ï¼Œé»˜è®¤ä¼šç”Ÿæˆä¸€ä¸ª</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ClusterIP</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">3306</span>             <span class="comment"># Serviceç«¯å£</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">3306</span>       <span class="comment"># podç«¯å£</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ„å»ºwebstack</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">webstack</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span>         <span class="comment"># ä¿®æ”¹ä¸º3å‰¯æœ¬</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">webstack</span>   <span class="comment"># å¿…é¡»ä¸ .spec.template.metadata.labels åŒ¹é…</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">webstack</span> <span class="comment"># å¿…é¡»ä¸ .spec.selector.matchLabels åŒ¹é…</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">webstack</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:webstackv-1.2.2</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">LOGIN_COPTCHA</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;false&quot;</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_HOST</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;10.96.0.2&quot;</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_DATABASE</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">webstack</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_USERNAME</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">root</span>   </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">DB_PASSWORD</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">root_password</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">APP_URL</span></span><br><span class="line">          <span class="attr">value:</span> <span class="string">&quot;&quot;</span> <span class="comment"># ç©ºå€¼æ˜ç¡®å†™ä¸º &quot;&quot;</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8000</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">webstack</span></span><br><span class="line">        <span class="attr">command:</span> [<span class="string">&#x27;/entrypoint.sh&#x27;</span>,<span class="string">&#x27;serve&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æš´éœ²webstackç«¯å£</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">webstack-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">webstack</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8000</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8000</span></span><br><span class="line">  <span class="attr">sessionAffinity:</span> <span class="string">ClientIP</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span> <span class="comment"># å°†æœåŠ¡æš´éœ²ä¸º NodePort ç±»å‹</span></span><br></pre></td></tr></table></figure><h3 id="æ•ˆæœï¼ˆéªŒè¯mysqlæŒä¹…åŒ–ï¼‰"><a href="#æ•ˆæœï¼ˆéªŒè¯mysqlæŒä¹…åŒ–ï¼‰" class="headerlink" title="æ•ˆæœï¼ˆéªŒè¯mysqlæŒä¹…åŒ–ï¼‰"></a>æ•ˆæœï¼ˆéªŒè¯mysqlæŒä¹…åŒ–ï¼‰</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹mysqlæƒ…å†µ</span></span><br><span class="line"><span class="string">ll</span> <span class="string">/mnt/data/mysql/dev-www-mysql-0-pvc-2396853f-5aed-4678-bfb7-73ca48e7a7cd/</span></span><br><span class="line"><span class="comment"># total 188488</span></span><br><span class="line"><span class="comment"># drwxrwxrwx 6 systemd-coredump root                 4096 Nov 25 16:21 ./</span></span><br><span class="line"><span class="comment"># drwxrwxrwx 5 root             root                 4096 Nov 25 14:49 ../</span></span><br><span class="line"><span class="comment"># -rw-r----- 1 systemd-coredump systemd-coredump       56 Nov 25 14:49 auto.cnf</span></span><br><span class="line"><span class="comment"># -rw------- 1 systemd-coredump systemd-coredump     1680 Nov 25 14:49 ca-key.pem</span></span><br><span class="line"><span class="comment"># -rw-r--r-- 1 systemd-coredump systemd-coredump     1112 Nov 25 14:49 ca.pem</span></span><br><span class="line"><span class="comment"># -rw-r--r-- 1 systemd-coredump systemd-coredump     1112 Nov 25 14:49 client-cert.pem</span></span><br><span class="line"><span class="comment"># -rw------- 1 systemd-coredump systemd-coredump     1676 Nov 25 14:49 client-key.pem</span></span><br><span class="line"><span class="comment"># -rw-r----- 1 systemd-coredump systemd-coredump      542 Nov 25 16:20 ib_buffer_pool</span></span><br><span class="line"><span class="comment"># -rw-r----- 1 systemd-coredump systemd-coredump 50331648 Nov 25 16:22 ib_logfile0</span></span><br><span class="line"><span class="comment"># -rw-r----- 1 systemd-coredump systemd-coredump 50331648 Nov 25 14:49 ib_logfile1</span></span><br><span class="line"><span class="comment"># -rw-r----- 1 systemd-coredump systemd-coredump 79691776 Nov 25 16:22 ibdata1</span></span><br><span class="line"><span class="comment"># -rw-r----- 1 systemd-coredump systemd-coredump 12582912 Nov 25 16:22 ibtmp1</span></span><br><span class="line"><span class="comment"># drwxr-x--- 2 systemd-coredump systemd-coredump     4096 Nov 25 14:49 mysql/</span></span><br><span class="line"><span class="comment"># lrwxrwxrwx 1 systemd-coredump systemd-coredump       27 Nov 25 16:21 mysql.sock -&gt; /var/run/mysqld/mysqld.sock</span></span><br><span class="line"><span class="comment"># drwxr-x--- 2 systemd-coredump systemd-coredump     4096 Nov 25 14:49 performance_schema/</span></span><br><span class="line"><span class="comment"># -rw------- 1 systemd-coredump systemd-coredump     1680 Nov 25 14:49 private_key.pem</span></span><br><span class="line"><span class="comment"># -rw-r--r-- 1 systemd-coredump systemd-coredump      452 Nov 25 14:49 public_key.pem</span></span><br><span class="line"><span class="comment"># -rw-r--r-- 1 systemd-coredump systemd-coredump     1112 Nov 25 14:49 server-cert.pem</span></span><br><span class="line"><span class="comment"># -rw------- 1 systemd-coredump systemd-coredump     1676 Nov 25 14:49 server-key.pem</span></span><br><span class="line"><span class="comment"># drwxr-x--- 2 systemd-coredump systemd-coredump    12288 Nov 25 14:49 sys/</span></span><br><span class="line"><span class="string">drwxr-x---</span> <span class="number">2</span> <span class="string">systemd-coredump</span> <span class="string">systemd-coredump</span>     <span class="number">4096 </span><span class="string">Nov</span> <span class="number">25</span> <span class="number">16</span><span class="string">:21</span> <span class="string">webstack/</span></span><br></pre></td></tr></table></figure><h3 id="éªŒè¯ï¼š"><a href="#éªŒè¯ï¼š" class="headerlink" title="éªŒè¯ï¼š"></a>éªŒè¯ï¼š</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_8d945e7a4af63ec585953c76f2668914.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_8d945e7a4af63ec585953c76f2668914.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8såˆ›å»ºStorageClass </title>
      <link href="/2024/11/25/k8s%E5%88%9B%E5%BB%BAStorageClass/"/>
      <url>/2024/11/25/k8s%E5%88%9B%E5%BB%BAStorageClass/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="k8såˆ›å»ºStorageClass"><a href="#k8såˆ›å»ºStorageClass" class="headerlink" title="k8såˆ›å»ºStorageClass"></a>k8såˆ›å»ºStorageClass</h2><p><strong>å‚è€ƒï¼š</strong><a href="https://www.cnblogs.com/panwenbin-logs/p/12196286.html#autoid-0-0-0">https://www.cnblogs.com/panwenbin-logs/p/12196286.html#autoid-0-0-0</a></p><h2 id="ä¸€ã€ä»‹ç»ï¼š"><a href="#ä¸€ã€ä»‹ç»ï¼š" class="headerlink" title="ä¸€ã€ä»‹ç»ï¼š"></a>ä¸€ã€ä»‹ç»ï¼š</h2><p><strong>Kubernetesæä¾›äº†ä¸€å¥—å¯ä»¥è‡ªåŠ¨åˆ›å»ºPVçš„æœºåˆ¶,å³:Dynamic Provisioning.è€Œè¿™ä¸ªæœºåˆ¶çš„æ ¸å¿ƒåœ¨äº:StorageClassè¿™ä¸ªAPIå¯¹è±¡.</strong></p><p><strong>StorageClasså¯¹è±¡ä¼šå®šä¹‰ä¸‹é¢ä¸¤éƒ¨åˆ†å†…å®¹:</strong></p><ul><li><strong>1,PVçš„å±æ€§.æ¯”å¦‚,å­˜å‚¨ç±»å‹,Volumeçš„å¤§å°ç­‰.</strong></li><li><strong>2,åˆ›å»ºè¿™ç§PVéœ€è¦ç”¨åˆ°çš„å­˜å‚¨æ’ä»¶</strong></li><li><strong>æœ‰äº†è¿™ä¸¤ä¸ªä¿¡æ¯ä¹‹å,Kuberneteså°±èƒ½å¤Ÿæ ¹æ®ç”¨æˆ·æäº¤çš„PVC,æ‰¾åˆ°ä¸€ä¸ªå¯¹åº”çš„StorageClass,ä¹‹åKuberneteså°±ä¼šè°ƒç”¨è¯¥StorageClasså£°æ˜çš„å­˜å‚¨æ’ä»¶,è¿›è€Œåˆ›å»ºå‡ºéœ€è¦çš„PV.</strong></li><li><strong>ä½†æ˜¯å…¶å®ä½¿ç”¨èµ·æ¥æ˜¯ä¸€ä»¶å¾ˆç®€å•çš„äº‹æƒ…,ä½ åªéœ€è¦æ ¹æ®è‡ªå·±çš„éœ€æ±‚,ç¼–å†™YAMLæ–‡ä»¶å³å¯,ç„¶åä½¿ç”¨kubectl createå‘½ä»¤æ‰§è¡Œå³å¯</strong></li></ul><h2 id="äºŒã€ä¸ºä»€ä¹ˆéœ€è¦StorageClass"><a href="#äºŒã€ä¸ºä»€ä¹ˆéœ€è¦StorageClass" class="headerlink" title="äºŒã€ä¸ºä»€ä¹ˆéœ€è¦StorageClass"></a>äºŒã€ä¸ºä»€ä¹ˆéœ€è¦StorageClass</h2><ul><li><strong>åœ¨ä¸€ä¸ªå¤§è§„æ¨¡çš„Kubernetesé›†ç¾¤é‡Œ,å¯èƒ½æœ‰æˆåƒä¸Šä¸‡ä¸ªPVC,è¿™å°±æ„å‘³ç€è¿ç»´äººå‘˜å¿…é¡»å®ç°åˆ›å»ºå‡ºè¿™ä¸ªå¤šä¸ªPV,æ­¤å¤–,éšç€é¡¹ç›®çš„éœ€è¦,ä¼šæœ‰æ–°çš„PVCä¸æ–­è¢«æäº¤,é‚£ä¹ˆè¿ç»´äººå‘˜å°±éœ€è¦ä¸æ–­çš„æ·»åŠ æ–°çš„,æ»¡è¶³è¦æ±‚çš„PV,å¦åˆ™æ–°çš„Podå°±ä¼šå› ä¸ºPVCç»‘å®šä¸åˆ°PVè€Œå¯¼è‡´åˆ›å»ºå¤±è´¥.è€Œä¸”é€šè¿‡ PVC è¯·æ±‚åˆ°ä¸€å®šçš„å­˜å‚¨ç©ºé—´ä¹Ÿå¾ˆæœ‰å¯èƒ½ä¸è¶³ä»¥æ»¡è¶³åº”ç”¨å¯¹äºå­˜å‚¨è®¾å¤‡çš„å„ç§éœ€æ±‚</strong></li><li><strong>è€Œä¸”ä¸åŒçš„åº”ç”¨ç¨‹åºå¯¹äºå­˜å‚¨æ€§èƒ½çš„è¦æ±‚å¯èƒ½ä¹Ÿä¸å°½ç›¸åŒï¼Œæ¯”å¦‚è¯»å†™é€Ÿåº¦ã€å¹¶å‘æ€§èƒ½ç­‰ï¼Œä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜ï¼ŒKubernetes åˆä¸ºæˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªæ–°çš„èµ„æºå¯¹è±¡ï¼šStorageClassï¼Œé€šè¿‡ StorageClass çš„å®šä¹‰ï¼Œç®¡ç†å‘˜å¯ä»¥å°†å­˜å‚¨èµ„æºå®šä¹‰ä¸ºæŸç§ç±»å‹çš„èµ„æºï¼Œæ¯”å¦‚å¿«é€Ÿå­˜å‚¨ã€æ…¢é€Ÿå­˜å‚¨ç­‰ï¼Œç”¨æˆ·æ ¹æ® StorageClass çš„æè¿°å°±å¯ä»¥éå¸¸ç›´è§‚çš„çŸ¥é“å„ç§å­˜å‚¨èµ„æºçš„å…·ä½“ç‰¹æ€§äº†ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®åº”ç”¨çš„ç‰¹æ€§å»ç”³è¯·åˆé€‚çš„å­˜å‚¨èµ„æºäº†ã€‚</strong></li></ul><h2 id="ä¸‰ã€StorageClassè¿è¡ŒåŸç†åŠéƒ¨ç½²æµç¨‹"><a href="#ä¸‰ã€StorageClassè¿è¡ŒåŸç†åŠéƒ¨ç½²æµç¨‹" class="headerlink" title="ä¸‰ã€StorageClassè¿è¡ŒåŸç†åŠéƒ¨ç½²æµç¨‹"></a>ä¸‰ã€StorageClassè¿è¡ŒåŸç†åŠéƒ¨ç½²æµç¨‹</h2><p><strong>è¦ä½¿ç”¨ StorageClassï¼Œæˆ‘ä»¬å°±å¾—å®‰è£…å¯¹åº”çš„è‡ªåŠ¨é…ç½®ç¨‹åºï¼Œæ¯”å¦‚æˆ‘ä»¬è¿™é‡Œå­˜å‚¨åç«¯ä½¿ç”¨çš„æ˜¯ nfsï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦ä½¿ç”¨åˆ°ä¸€ä¸ª nfs-client çš„è‡ªåŠ¨é…ç½®ç¨‹åºï¼Œæˆ‘ä»¬ä¹Ÿå«å®ƒ Provisionerï¼Œè¿™ä¸ªç¨‹åºä½¿ç”¨æˆ‘ä»¬å·²ç»é…ç½®å¥½çš„ nfs æœåŠ¡å™¨ï¼Œæ¥è‡ªåŠ¨åˆ›å»ºæŒä¹…å·ï¼Œä¹Ÿå°±æ˜¯è‡ªåŠ¨å¸®æˆ‘ä»¬åˆ›å»º PVã€‚</strong></p><ul><li><strong>1.è‡ªåŠ¨åˆ›å»ºçš„ PV ä»¥${namespace}-${pvcName}-${pvName}è¿™æ ·çš„å‘½åæ ¼å¼åˆ›å»ºåœ¨ NFS æœåŠ¡å™¨ä¸Šçš„å…±äº«æ•°æ®ç›®å½•ä¸­</strong></li><li><strong>2.è€Œå½“è¿™ä¸ª PV è¢«å›æ”¶åä¼šä»¥archieved-${namespace}-${pvcName}-${pvName}è¿™æ ·çš„å‘½åæ ¼å¼å­˜åœ¨ NFS æœåŠ¡å™¨ä¸Šã€‚</strong></li></ul><h6 id="1-åŸç†åŠéƒ¨ç½²æµç¨‹è¯´æ˜"><a href="#1-åŸç†åŠéƒ¨ç½²æµç¨‹è¯´æ˜" class="headerlink" title="1.åŸç†åŠéƒ¨ç½²æµç¨‹è¯´æ˜"></a>1.åŸç†åŠéƒ¨ç½²æµç¨‹è¯´æ˜</h6><p><strong>è¯¦ç»†çš„è¿ä½œæµç¨‹å¯ä»¥å‚è€ƒä¸‹å›¾:</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_eda76ec6387be6ea8041aeaaf321a385.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_eda76ec6387be6ea8041aeaaf321a385.png"></p><p><strong>æ­å»ºStorageClass+NFS,å¤§è‡´æœ‰ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤:</strong></p><ul><li><strong>1.åˆ›å»ºä¸€ä¸ªå¯ç”¨çš„NFS Serve</strong></li><li><strong>2.åˆ›å»ºService Account.è¿™æ˜¯ç”¨æ¥ç®¡æ§NFS provisioneråœ¨k8sé›†ç¾¤ä¸­è¿è¡Œçš„æƒé™</strong></li><li><strong>3.åˆ›å»ºStorageClass.è´Ÿè´£å»ºç«‹PVCå¹¶è°ƒç”¨NFS provisionerè¿›è¡Œé¢„å®šçš„å·¥ä½œ,å¹¶è®©PVä¸PVCå»ºç«‹ç®¡ç†</strong></li><li><strong>4.åˆ›å»ºNFS provisioner.æœ‰ä¸¤ä¸ªåŠŸèƒ½,ä¸€ä¸ªæ˜¯åœ¨NFSå…±äº«ç›®å½•ä¸‹åˆ›å»ºæŒ‚è½½ç‚¹(volume),å¦ä¸€ä¸ªåˆ™æ˜¯å»ºäº†PVå¹¶å°†PVä¸NFSçš„æŒ‚è½½ç‚¹å»ºç«‹å…³è”</strong></li></ul><h2 id="å››ã€åˆ›å»ºStorageClass"><a href="#å››ã€åˆ›å»ºStorageClass" class="headerlink" title="å››ã€åˆ›å»ºStorageClass"></a>å››ã€åˆ›å»ºStorageClass</h2><h3 id="1ã€åˆ›å»ºNFSå…±äº«æœåŠ¡"><a href="#1ã€åˆ›å»ºNFSå…±äº«æœåŠ¡" class="headerlink" title="1ã€åˆ›å»ºNFSå…±äº«æœåŠ¡"></a>1ã€åˆ›å»ºNFSå…±äº«æœåŠ¡</h3><p><a href="https://wn.zznnwn.cloudns.biz/2023/09/26/Ubuntu20-04%E4%B8%8A%E5%AE%89%E8%A3%85%E5%92%8C%E9%85%8D%E7%BD%AENFS%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%8C%82%E8%BD%BD/?highlight=nfs">è¾ƒä¸ºç®€å•è§ZzNnWnåšå®¢é“¾æ¥</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/srv/nfs4     *(rw,no_subtree_check)</span><br><span class="line">/nfs/data/pv1     *(rw,<span class="built_in">sync</span>,no_subtree_check)</span><br><span class="line">/nfs/data/pv2     *(rw,<span class="built_in">sync</span>,no_subtree_check)</span><br><span class="line">/nfs/data/pv3     10.0.0.0/24(rw,<span class="built_in">sync</span>,no_subtree_check)</span><br><span class="line">/mnt/data/mysql   *(rw,<span class="built_in">sync</span>,no_root_squash,no_subtree_check)</span><br></pre></td></tr></table></figure><h3 id="2ã€ä½¿ç”¨ä»¥ä¸‹æ–‡æ¡£é…ç½®accountåŠç›¸å…³æƒé™"><a href="#2ã€ä½¿ç”¨ä»¥ä¸‹æ–‡æ¡£é…ç½®accountåŠç›¸å…³æƒé™" class="headerlink" title="2ã€ä½¿ç”¨ä»¥ä¸‹æ–‡æ¡£é…ç½®accountåŠç›¸å…³æƒé™"></a>2ã€ä½¿ç”¨ä»¥ä¸‹æ–‡æ¡£é…ç½®accountåŠç›¸å…³æƒé™</h3><p><strong>rbac.yaml:      # å”¯ä¸€éœ€è¦ä¿®æ”¹çš„åœ°æ–¹åªæœ‰namespace,æ ¹æ®å®é™…æƒ…å†µå®šä¹‰</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">  <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span>        <span class="comment"># æ ¹æ®å®é™…ç¯å¢ƒè®¾å®šnamespace,ä¸‹é¢ç±»åŒ</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterRole</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nfs-client-provisioner-runner</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    <span class="attr">resources:</span> [<span class="string">&quot;persistentvolumes&quot;</span>]</span><br><span class="line">    <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;create&quot;</span>, <span class="string">&quot;delete&quot;</span>]</span><br><span class="line">  <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    <span class="attr">resources:</span> [<span class="string">&quot;persistentvolumeclaims&quot;</span>]</span><br><span class="line">    <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;update&quot;</span>]</span><br><span class="line">  <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;storage.k8s.io&quot;</span>]</span><br><span class="line">    <span class="attr">resources:</span> [<span class="string">&quot;storageclasses&quot;</span>]</span><br><span class="line">    <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>]</span><br><span class="line">  <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    <span class="attr">resources:</span> [<span class="string">&quot;events&quot;</span>]</span><br><span class="line">    <span class="attr">verbs:</span> [<span class="string">&quot;create&quot;</span>, <span class="string">&quot;update&quot;</span>, <span class="string">&quot;patch&quot;</span>]</span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterRoleBinding</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">run-nfs-client-provisioner</span></span><br><span class="line"><span class="attr">subjects:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">    <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">    <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line">  <span class="attr">kind:</span> <span class="string">ClusterRole</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nfs-client-provisioner-runner</span></span><br><span class="line">  <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Role</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">leader-locking-nfs-client-provisioner</span></span><br><span class="line">    <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">rules:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">apiGroups:</span> [<span class="string">&quot;&quot;</span>]</span><br><span class="line">    <span class="attr">resources:</span> [<span class="string">&quot;endpoints&quot;</span>]</span><br><span class="line">    <span class="attr">verbs:</span> [<span class="string">&quot;get&quot;</span>, <span class="string">&quot;list&quot;</span>, <span class="string">&quot;watch&quot;</span>, <span class="string">&quot;create&quot;</span>, <span class="string">&quot;update&quot;</span>, <span class="string">&quot;patch&quot;</span>]</span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">RoleBinding</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">leader-locking-nfs-client-provisioner</span></span><br><span class="line"><span class="attr">subjects:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">    <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">    <span class="attr">namespace:</span> <span class="string">default</span></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line">  <span class="attr">kind:</span> <span class="string">Role</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">leader-locking-nfs-client-provisioner</span></span><br><span class="line">  <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br></pre></td></tr></table></figure><h3 id="3ã€åˆ›å»ºNFSèµ„æºçš„StorageClass"><a href="#3ã€åˆ›å»ºNFSèµ„æºçš„StorageClass" class="headerlink" title="3ã€åˆ›å»ºNFSèµ„æºçš„StorageClass"></a>3ã€åˆ›å»ºNFSèµ„æºçš„StorageClass</h3><p><strong>nfs-StorageClass.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">storage.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StorageClass</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">managed-nfs-storage</span></span><br><span class="line"><span class="attr">provisioner:</span> <span class="string">qgg-nfs-storage</span> <span class="comment">#è¿™é‡Œçš„åç§°è¦å’Œä¸‹æ–¹provisioneré…ç½®æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡PROVISIONER_NAMEä¿æŒä¸€è‡´parameters:  archiveOnDelete: &quot;false&quot;</span></span><br><span class="line"><span class="attr">allowVolumeExpansion:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="4ã€åˆ›å»ºNFS-provisioner"><a href="#4ã€åˆ›å»ºNFS-provisioner" class="headerlink" title="4ã€åˆ›å»ºNFS provisioner"></a>4ã€<strong>åˆ›å»ºNFS provisioner</strong></h3><p><strong>nfs-provisioner.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">  <span class="comment"># replace with namespace where provisioner is deployed</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">default</span>  <span class="comment">#ä¸RBACæ–‡ä»¶ä¸­çš„namespaceä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">  <span class="attr">strategy:</span></span><br><span class="line">    <span class="attr">type:</span> <span class="string">Recreate</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">serviceAccountName:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nfs-client-provisioner</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/gegewu-kubernetes/nfs-subdir-external-provisioner:v4.0.2</span></span><br><span class="line">          <span class="attr">volumeMounts:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nfs-client-root</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/persistentvolumes</span></span><br><span class="line">          <span class="attr">env:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">PROVISIONER_NAME</span></span><br><span class="line">              <span class="attr">value:</span> <span class="string">qgg-nfs-storage</span>    <span class="comment"># provisioneråç§°,è¯·ç¡®ä¿è¯¥åç§°ä¸ nfs-StorageClass.yamlæ–‡ä»¶ä¸­çš„provisioneråç§°ä¿æŒä¸€è‡´</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">NFS_SERVER</span></span><br><span class="line">              <span class="attr">value:</span> <span class="number">10.0</span><span class="number">.0</span><span class="number">.10</span>          <span class="comment"># NFS Server IPåœ°å€</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">NFS_PATH</span>  </span><br><span class="line">              <span class="attr">value:</span> <span class="string">/mnt/data/mysql</span>    <span class="comment"># NFSæŒ‚è½½å·</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nfs-client-root</span></span><br><span class="line">          <span class="attr">nfs:</span></span><br><span class="line">            <span class="attr">server:</span> <span class="number">10.0</span><span class="number">.0</span><span class="number">.10</span>         <span class="comment"># NFS Server IPåœ°å€</span></span><br><span class="line">            <span class="attr">path:</span> <span class="string">/mnt/data/mysql</span>     <span class="comment"># NFS æŒ‚è½½å·</span></span><br></pre></td></tr></table></figure><h2 id="äº”ã€åˆ›å»ºæµ‹è¯•pod-æ£€æŸ¥æ˜¯å¦éƒ¨ç½²æˆåŠŸ"><a href="#äº”ã€åˆ›å»ºæµ‹è¯•pod-æ£€æŸ¥æ˜¯å¦éƒ¨ç½²æˆåŠŸ" class="headerlink" title="äº”ã€åˆ›å»ºæµ‹è¯•pod,æ£€æŸ¥æ˜¯å¦éƒ¨ç½²æˆåŠŸ"></a>äº”ã€åˆ›å»ºæµ‹è¯•pod,æ£€æŸ¥æ˜¯å¦éƒ¨ç½²æˆåŠŸ</h2><h3 id="1ã€Pod-PVC"><a href="#1ã€Pod-PVC" class="headerlink" title="1ã€Pod+PVC"></a>1ã€Pod+PVC</h3><p><strong>åˆ›å»ºPVC</strong></p><p><strong>test-claim.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">test-claim</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">volume.beta.kubernetes.io/storage-class:</span> <span class="string">&quot;managed-nfs-storage&quot;</span>   <span class="comment">#ä¸nfs-StorageClass.yaml metadata.nameä¿æŒä¸€è‡´</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">ReadWriteMany</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">requests:</span></span><br><span class="line">      <span class="attr">storage:</span> <span class="string">1Mi</span></span><br></pre></td></tr></table></figure><p>éªŒè¯-<strong>ç¡®ä¿PVCçŠ¶æ€ä¸ºBound</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@k8s1:~<span class="comment"># ls /mnt/data/mysql/</span></span><br><span class="line"><span class="comment"># default-test-claim-pvc-7cd4c19c-8df6-4b1b-ae4a-07fcaed08255</span></span><br><span class="line">root@k8s1:~<span class="comment"># kubectl get pv</span></span><br><span class="line"><span class="comment"># NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                STORAGECLASS          REASON   AGE</span></span><br><span class="line"><span class="comment"># mysql-pv                                   20Gi       RWO            Retain           Bound    dev/mysql-pvc-20g                                   67m</span></span><br><span class="line"><span class="comment"># pv1                                        5Gi        RWX            Retain           Bound    dev/pvc1                                            9d</span></span><br><span class="line"><span class="comment"># pv2                                        10Gi       RWX            Retain           Bound    dev/pvc2                                            9d</span></span><br><span class="line"><span class="comment"># pvc-7cd4c19c-8df6-4b1b-ae4a-07fcaed08255   1Mi        RWX            Delete           Bound    default/test-claim   managed-nfs-storage            14m</span></span><br><span class="line">root@k8s1:~<span class="comment"># kubectl get pvc</span></span><br><span class="line"><span class="comment"># NAME         STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS          AGE</span></span><br><span class="line"><span class="comment"># test-claim   Bound    pvc-7cd4c19c-8df6-4b1b-ae4a-07fcaed08255   1Mi        RWX            managed-nfs-storage   14m</span></span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºæµ‹è¯•pod,æŸ¥çœ‹æ˜¯å¦å¯ä»¥æ­£å¸¸æŒ‚è½½</strong></p><p><strong>test-pod.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">test-pod</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">test-pod</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">busybox:1.24</span></span><br><span class="line">    <span class="attr">command:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;/bin/sh&quot;</span></span><br><span class="line">    <span class="attr">args:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;-c&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;touch /mnt/SUCCESS &amp;&amp; exit 0 || exit 1&quot;</span>   <span class="comment">#åˆ›å»ºä¸€ä¸ªSUCCESSæ–‡ä»¶åé€€å‡º</span></span><br><span class="line">    <span class="attr">volumeMounts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nfs-pvc</span></span><br><span class="line">        <span class="attr">mountPath:</span> <span class="string">&quot;/mnt&quot;</span></span><br><span class="line">  <span class="attr">restartPolicy:</span> <span class="string">&quot;Never&quot;</span></span><br><span class="line">  <span class="attr">volumes:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nfs-pvc</span></span><br><span class="line">      <span class="attr">persistentVolumeClaim:</span></span><br><span class="line">        <span class="attr">claimName:</span> <span class="string">test-claim</span>  <span class="comment">#ä¸PVCåç§°ä¿æŒä¸€è‡´</span></span><br></pre></td></tr></table></figure><p><strong>æ£€æŸ¥ç»“æœ:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx-keepalived-155-227 ~]<span class="comment"># ll /data/volumes/default-test-claim-pvc-aae2b7fa-377b-11ea-87ad-525400512eca/   #æ–‡ä»¶è§„åˆ™æ˜¯æŒ‰ç…§$&#123;namespace&#125;-$&#123;pvcName&#125;-$&#123;pvName&#125;åˆ›å»ºçš„</span></span><br><span class="line">æ€»ç”¨é‡ 0</span><br><span class="line">-rw-r--r-- 1 root root 0 2020-01-15 17:51 SUCCESS  <span class="comment">#ä¸‹é¢æœ‰ä¸€ä¸ª SUCCESS çš„æ–‡ä»¶ï¼Œè¯æ˜æˆ‘ä»¬ä¸Šé¢çš„éªŒè¯æ˜¯æˆåŠŸ</span></span><br></pre></td></tr></table></figure><h6 id="2-StateFulDet-volumeClaimTemplatesè‡ªåŠ¨åˆ›å»ºPV"><a href="#2-StateFulDet-volumeClaimTemplatesè‡ªåŠ¨åˆ›å»ºPV" class="headerlink" title="2.StateFulDet+volumeClaimTemplatesè‡ªåŠ¨åˆ›å»ºPV"></a>2.StateFulDet+volumeClaimTemplatesè‡ªåŠ¨åˆ›å»ºPV</h6><p><strong>åˆ›å»ºæ— å¤´æœåŠ¡åŠstatefulset</strong></p><p><strong>nginx-statefulset.yaml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx-headless</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line">  <span class="attr">clusterIP:</span> <span class="string">None</span>   <span class="comment">#æ³¨æ„æ­¤å¤„çš„å€¼,Noneè¡¨ç¤ºæ— å¤´æœåŠ¡</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1beta1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">&quot;nginx&quot;</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span>  <span class="comment">#ä¸¤ä¸ªå‰¯æœ¬</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">ikubernetes/myapp:v1</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">www</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">/usr/share/nginx/html</span></span><br><span class="line">  <span class="attr">volumeClaimTemplates:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">www</span></span><br><span class="line">      <span class="attr">annotations:</span></span><br><span class="line">        <span class="attr">volume.beta.kubernetes.io/storage-class:</span> <span class="string">&quot;managed-nfs-storage&quot;</span>   <span class="comment">#managed-nfs-storageä¸ºæˆ‘ä»¬åˆ›å»ºçš„storage-classåç§°</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">accessModes:</span> [ <span class="string">&quot;ReadWriteOnce&quot;</span> ]</span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">requests:</span></span><br><span class="line">          <span class="attr">storage:</span> <span class="string">1Gi</span></span><br></pre></td></tr></table></figure><p><strong>æˆ–ä¸‹æ–¹ä¾‹å­</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">nginx</span> <span class="comment"># has to match .spec.template.metadata.labels</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">&quot;nginx&quot;</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span> <span class="comment"># by default is 1               # 3å‰¯æœ¬</span></span><br><span class="line">  <span class="comment"># minReadySeconds: 10 # by default is 0</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">nginx</span> <span class="comment"># has to match .spec.selector.matchLabels</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.k8s.io/nginx-slim:0.8</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">web</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">www</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">/usr/share/nginx/html</span></span><br><span class="line">  <span class="attr">volumeClaimTemplates:</span>       <span class="comment">#3å‰¯æœ¬é‡Œé¢éƒ½ä¼šç”³è¯·ä¸€ä¸ªå­˜å‚¨ æ­¤é…ç½®å°±ç±»ä¼¼pvcäº†</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">www</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">accessModes:</span> [ <span class="string">&quot;ReadWriteOnce&quot;</span> ]   <span class="comment">#è®¿é—®æ¨¡å¼ReadWriteOnce å…è®¸ä¸€ä¸ªå®¢æˆ·è¿›è¡Œè¯»å†™</span></span><br><span class="line">      <span class="attr">storageClassName:</span> <span class="string">&quot;csi-rbd-sc&quot;</span>      <span class="comment">#æŒ‡å®šå®šä¹‰çš„StorageClass</span></span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">requests:</span></span><br><span class="line">          <span class="attr">storage:</span> <span class="string">1Gi</span>                                             <span class="comment">#ç”³è¯·ç©ºé—´å¤§å°</span></span><br></pre></td></tr></table></figure><p><strong>æ£€æŸ¥ç»“æœ:</strong></p><p><strong>é›†ç¾¤èŠ‚ç‚¹ä¸Š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kubectl delete -f nginx-statefulset.yaml </span><br><span class="line">kubectl get pods -l app=nginx  <span class="comment"># æ£€æŸ¥podçŠ¶æ€</span></span><br><span class="line"><span class="comment"># NAME    READY   STATUS    RESTARTS   AGE</span></span><br><span class="line"><span class="comment"># web-0   1/1     Running   0          115m</span></span><br><span class="line"><span class="comment"># web-1   1/1     Running   0          114m</span></span><br><span class="line">kubectl get pvc <span class="comment"># æŸ¥çœ‹PVC</span></span><br><span class="line"><span class="comment"># NAME         STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS          AGE</span></span><br><span class="line"><span class="comment"># test-claim   Bound    pvc-aae2b7fa-377b-11ea-87ad-525400512eca   1Mi        RWX            managed-nfs-storage   19h</span></span><br><span class="line"><span class="comment"># www-web-0    Bound    pvc-4d7e342a-3810-11ea-87ad-525400512eca   1Gi        RWO            managed-nfs-storage   115m</span></span><br><span class="line"><span class="comment"># www-web-1    Bound    pvc-5431c8ba-3810-11ea-87ad-525400512eca   1Gi        RWO            managed-nfs-storage   115m</span></span><br><span class="line">kubectl get pv <span class="comment"># æŸ¥çœ‹PV</span></span><br><span class="line"><span class="comment"># NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS   CLAIM                STORAGECLASS          REASON   AGE</span></span><br><span class="line"><span class="comment"># pvc-4d7e342a-3810-11ea-87ad-525400512eca   1Gi        RWO            Delete           Bound    default/www-web-0    managed-nfs-storage            115m</span></span><br><span class="line"><span class="comment"># pvc-5431c8ba-3810-11ea-87ad-525400512eca   1Gi        RWO            Delete           Bound    default/www-web-1    managed-nfs-storage            115m</span></span><br><span class="line"><span class="comment"># pvc-aae2b7fa-377b-11ea-87ad-525400512eca   1Mi        RWX            Delete           Bound    default/test-claim   managed-nfs-storage            19h</span></span><br></pre></td></tr></table></figure><p><strong>NFS Serverä¸Š:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /data/volumes/</span><br><span class="line">ll  <span class="comment"># æ³¨æ„ç›®å½•çš„å‘½åæ ¼å¼</span></span><br><span class="line"><span class="comment"># æ€»ç”¨é‡ 0</span></span><br><span class="line"><span class="comment"># drwxrwxrwx 2 root root 21 2020-01-15 17:51 default-test-claim-pvc-aae2b7fa-377b-11ea-87ad-525400512eca</span></span><br><span class="line"><span class="comment"># drwxrwxrwx 2 root root  6 2020-01-16 11:28 default-www-web-0-pvc-4d7e342a-3810-11ea-87ad-525400512eca</span></span><br><span class="line"><span class="comment"># drwxrwxrwx 2 root root  6 2020-01-16 11:28 default-www-web-1-pvc-5431c8ba-3810-11ea-87ad-525400512eca</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;web-00&quot;</span> &gt; default-www-web-0-pvc-4d7e342a-3810-11ea-87ad-525400512eca/index.html <span class="comment">#åˆ†åˆ«åˆ›å»ºä¸åŒçš„indexæ–‡ä»¶</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;web-01&quot;</span> &gt; default-www-web-1-pvc-5431c8ba-3810-11ea-87ad-525400512eca/index.html</span><br></pre></td></tr></table></figure><p><strong>é›†ç¾¤ä»»æ„èŠ‚ç‚¹ä¸Š:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kubectl <span class="built_in">exec</span> -it pod-cm-1 -- /bin/sh  <span class="comment"># è¿›å…¥é›†ç¾¤ä¸­ä»»æ„podä¸­,è§£ænginx-headless æœåŠ¡/ # nslookup nginx-headless</span></span><br><span class="line"><span class="comment"># nslookup: can&#x27;t resolve &#x27;(null)&#x27;: Name does not resolve</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Name:      nginx-headless</span></span><br><span class="line"><span class="comment"># Address 1: 172.17.136.7 172-17-136-7.nginx-headless.default.svc.cluster.local  #å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªåœ°å€</span></span><br><span class="line"><span class="comment"># Address 2: 172.17.248.5 172-17-248-5.nginx-headless.default.svc.cluster.local</span></span><br><span class="line">curl 172.17.248.5 <span class="comment"># åˆ†åˆ«è®¿é—®ä¸€ä¸‹æŸ¥çœ‹ç»“æœ</span></span><br><span class="line"><span class="comment"># web-00</span></span><br><span class="line">curl 172.17.136.7</span><br><span class="line"><span class="comment"># web-01</span></span><br></pre></td></tr></table></figure><p><strong>å¯¹äºstatefulsetæˆ‘ä»¬å¯ä»¥é€šè¿‡æ·»åŠ /åˆ é™¤podå‰¯æœ¬çš„æ•°é‡,è§‚å¯ŸPV/PVCçš„çŠ¶æ€åŠå˜åŒ–.</strong></p><h2 id="å…­ã€å…³äºStorageClasså›æ”¶ç­–ç•¥å¯¹æ•°æ®çš„å½±å“"><a href="#å…­ã€å…³äºStorageClasså›æ”¶ç­–ç•¥å¯¹æ•°æ®çš„å½±å“" class="headerlink" title="å…­ã€å…³äºStorageClasså›æ”¶ç­–ç•¥å¯¹æ•°æ®çš„å½±å“"></a>å…­ã€å…³äºStorageClasså›æ”¶ç­–ç•¥å¯¹æ•°æ®çš„å½±å“</h2><h6 id="1-ç¬¬ä¸€ç§é…ç½®"><a href="#1-ç¬¬ä¸€ç§é…ç½®" class="headerlink" title="1.ç¬¬ä¸€ç§é…ç½®"></a>1.ç¬¬ä¸€ç§é…ç½®</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">archiveOnDelete:</span> <span class="string">&quot;false&quot;</span>  </span><br><span class="line">   <span class="attr">reclaimPolicy:</span> <span class="string">Delete</span>   <span class="comment"># é»˜è®¤æ²¡æœ‰é…ç½®,é»˜è®¤å€¼ä¸ºDelete</span></span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ç»“æœ:</strong></p><ul><li><strong>1.podåˆ é™¤é‡å»ºåæ•°æ®ä¾ç„¶å­˜åœ¨,æ—§podåç§°åŠæ•°æ®ä¾ç„¶ä¿ç•™ç»™æ–°podä½¿ç”¨</strong></li><li><strong>2.scåˆ é™¤é‡å»ºåæ•°æ®ä¾ç„¶å­˜åœ¨,æ—§podåç§°åŠæ•°æ®ä¾ç„¶ä¿ç•™ç»™æ–°podä½¿ç”¨</strong></li><li><strong>3.åˆ é™¤PVCå,PVè¢«åˆ é™¤ä¸”NFS Serverå¯¹åº”æ•°æ®è¢«åˆ é™¤</strong></li></ul><h6 id="2-ç¬¬äºŒç§é…ç½®"><a href="#2-ç¬¬äºŒç§é…ç½®" class="headerlink" title="2.ç¬¬äºŒç§é…ç½®"></a>2.ç¬¬äºŒç§é…ç½®</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">archiveOnDelete:</span> <span class="string">&quot;false&quot;</span>  </span><br><span class="line">   <span class="attr">reclaimPolicy:</span> <span class="string">Retain</span></span><br></pre></td></tr></table></figure><p><strong>æµ‹è¯•ç»“æœ:</strong></p><ul><li><strong>1.podåˆ é™¤é‡å»ºåæ•°æ®ä¾ç„¶å­˜åœ¨,æ—§podåç§°åŠæ•°æ®ä¾ç„¶ä¿ç•™ç»™æ–°podä½¿ç”¨</strong></li><li><strong>2.scåˆ é™¤é‡å»ºåæ•°æ®ä¾ç„¶å­˜åœ¨,æ—§podåç§°åŠæ•°æ®ä¾ç„¶ä¿ç•™ç»™æ–°podä½¿ç”¨</strong></li><li><strong>3.åˆ é™¤PVCå,PVä¸ä¼šè¢«åˆ é™¤,ä¸”çŠ¶æ€ç”±Boundå˜ä¸ºReleased,NFS Serverå¯¹åº”æ•°æ®è¢«ä¿ç•™</strong></li><li><strong>4.é‡å»ºscå,æ–°å»ºPVCä¼šç»‘å®šæ–°çš„pv,æ—§æ•°æ®å¯ä»¥é€šè¿‡æ‹·è´åˆ°æ–°çš„PVä¸­</strong></li></ul><h6 id="3-ç¬¬ä¸‰ç§é…ç½®"><a href="#3-ç¬¬ä¸‰ç§é…ç½®" class="headerlink" title="3.ç¬¬ä¸‰ç§é…ç½®"></a>3.ç¬¬ä¸‰ç§é…ç½®</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">archiveOnDelete:</span> <span class="string">&quot;ture&quot;</span>  </span><br><span class="line">   <span class="attr">reclaimPolicy:</span> <span class="string">Retain</span></span><br></pre></td></tr></table></figure><p><strong>ç»“æœ:</strong></p><ul><li><strong>1.podåˆ é™¤é‡å»ºåæ•°æ®ä¾ç„¶å­˜åœ¨,æ—§podåç§°åŠæ•°æ®ä¾ç„¶ä¿ç•™ç»™æ–°podä½¿ç”¨</strong></li><li><strong>2.scåˆ é™¤é‡å»ºåæ•°æ®ä¾ç„¶å­˜åœ¨,æ—§podåç§°åŠæ•°æ®ä¾ç„¶ä¿ç•™ç»™æ–°podä½¿ç”¨</strong></li><li><strong>3.åˆ é™¤PVCå,PVä¸ä¼šåˆ«åˆ é™¤,ä¸”çŠ¶æ€ç”±Boundå˜ä¸ºReleased,NFS Serverå¯¹åº”æ•°æ®è¢«ä¿ç•™</strong></li><li><strong>4.é‡å»ºscå,æ–°å»ºPVCä¼šç»‘å®šæ–°çš„pv,æ—§æ•°æ®å¯ä»¥é€šè¿‡æ‹·è´åˆ°æ–°çš„PVä¸­</strong></li></ul><h6 id="4-ç¬¬å››ç§é…ç½®"><a href="#4-ç¬¬å››ç§é…ç½®" class="headerlink" title="4.ç¬¬å››ç§é…ç½®"></a>4.ç¬¬å››ç§é…ç½®</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">archiveOnDelete:</span> <span class="string">&quot;ture&quot;</span>  </span><br><span class="line">  <span class="attr">reclaimPolicy:</span> <span class="string">Delete</span></span><br></pre></td></tr></table></figure><p><strong>ç»“æœ:</strong></p><ul><li><strong>1.podåˆ é™¤é‡å»ºåæ•°æ®ä¾ç„¶å­˜åœ¨,æ—§podåç§°åŠæ•°æ®ä¾ç„¶ä¿ç•™ç»™æ–°podä½¿ç”¨</strong></li><li><strong>2.scåˆ é™¤é‡å»ºåæ•°æ®ä¾ç„¶å­˜åœ¨,æ—§podåç§°åŠæ•°æ®ä¾ç„¶ä¿ç•™ç»™æ–°podä½¿ç”¨</strong></li><li><strong>3.åˆ é™¤PVCå,PVä¸ä¼šåˆ«åˆ é™¤,ä¸”çŠ¶æ€ç”±Boundå˜ä¸ºReleased,NFS Serverå¯¹åº”æ•°æ®è¢«ä¿ç•™</strong></li><li><strong>4.é‡å»ºscå,æ–°å»ºPVCä¼šç»‘å®šæ–°çš„pv,æ—§æ•°æ®å¯ä»¥é€šè¿‡æ‹·è´åˆ°æ–°çš„PVä¸­</strong></li></ul><p><strong>æ€»ç»“:é™¤ä»¥ç¬¬ä¸€ç§é…ç½®å¤–,å…¶ä»–ä¸‰ç§é…ç½®åœ¨PV/PVCè¢«åˆ é™¤åæ•°æ®ä¾ç„¶ä¿ç•™</strong></p><h2 id="ä¸ƒã€å¸¸è§é—®é¢˜"><a href="#ä¸ƒã€å¸¸è§é—®é¢˜" class="headerlink" title="ä¸ƒã€å¸¸è§é—®é¢˜"></a>ä¸ƒã€å¸¸è§é—®é¢˜</h2><h6 id="1-å¦‚ä½•è®¾ç½®é»˜è®¤çš„StorageClass"><a href="#1-å¦‚ä½•è®¾ç½®é»˜è®¤çš„StorageClass" class="headerlink" title="1.å¦‚ä½•è®¾ç½®é»˜è®¤çš„StorageClass"></a>1.å¦‚ä½•è®¾ç½®é»˜è®¤çš„StorageClass</h6><p><strong>æˆ‘ä»¬å¯ä»¥ç”¨ kubectl patch å‘½ä»¤æ¥æ›´æ–°ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">kubectl get sc  <span class="comment"># æŸ¥çœ‹å½“å‰sc </span></span><br><span class="line"><span class="comment"># NAME                  PROVISIONER       AGE </span></span><br><span class="line"><span class="comment"># managed-nfs-storage   qgg-nfs-storage   20h</span></span><br><span class="line">kubectl patch storageclass managed-nfs-storage -p <span class="string">&#x27;&#123;&quot;metadata&quot;: &#123;&quot;annotations&quot;:&#123;&quot;storageclass.kubernetes.io/is-default-class&quot;:&quot;true&quot;&#125;&#125;&#125;&#x27;</span>  <span class="comment"># è®¾ç½®managed-nfs-storageä¸ºé»˜è®¤åç«¯å­˜å‚¨</span></span><br><span class="line"><span class="comment"># storageclass.storage.k8s.io/managed-nfs-storage patched</span></span><br><span class="line">kubectl get sc  <span class="comment"># å†æ¬¡æŸ¥çœ‹,æ³¨æ„æ˜¯å¦æœ‰defaultæ ‡è¯†</span></span><br><span class="line"><span class="comment"># NAME                            PROVISIONER       AGE</span></span><br><span class="line"><span class="comment"># managed-nfs-storage (default)   qgg-nfs-storage   20h</span></span><br><span class="line">kubectl patch storageclass managed-nfs-storage -p <span class="string">&#x27;&#123;&quot;metadata&quot;: &#123;&quot;annotations&quot;:&#123;&quot;storageclass.kubernetes.io/is-default-class&quot;:&quot;false&quot;&#125;&#125;&#125;&#x27;</span> <span class="comment">#å–æ¶ˆé»˜è®¤å­˜å‚¨åç«¯</span></span><br><span class="line"><span class="comment"># storageclass.storage.k8s.io/managed-nfs-storage patched</span></span><br><span class="line">kubectl get sc</span><br><span class="line"><span class="comment"># NAME                  PROVISIONER       AGE</span></span><br><span class="line"><span class="comment"># managed-nfs-storage   qgg-nfs-storage   20h</span></span><br></pre></td></tr></table></figure><h6 id="YAMLæ–‡ä»¶"><a href="#YAMLæ–‡ä»¶" class="headerlink" title="YAMLæ–‡ä»¶"></a>YAMLæ–‡ä»¶</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">storage.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StorageClass</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">managed-nfs-storage</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">&quot;storageclass.kubernetes.io/is-default-class&quot;:</span> <span class="string">&quot;true&quot;</span>   <span class="comment"># æ·»åŠ æ­¤æ³¨é‡Š</span></span><br><span class="line"><span class="attr">provisioner:</span> <span class="string">qgg-nfs-storage</span>                                <span class="comment"># or choose another name, must match deployment&#x27;s env PROVISIONER_NAME&#x27;</span></span><br><span class="line"><span class="attr">parameters:</span></span><br><span class="line">  <span class="attr">archiveOnDelete:</span> <span class="string">&quot;false&quot;</span></span><br></pre></td></tr></table></figure><h6 id="2-å¦‚ä½•ä½¿ç”¨é»˜è®¤çš„StorageClass"><a href="#2-å¦‚ä½•ä½¿ç”¨é»˜è®¤çš„StorageClass" class="headerlink" title="2.å¦‚ä½•ä½¿ç”¨é»˜è®¤çš„StorageClass"></a>2.å¦‚ä½•ä½¿ç”¨é»˜è®¤çš„StorageClass</h6><p><strong>å¦‚æœé›†ç¾¤æœ‰ä¸€ä¸ªé»˜è®¤çš„StorageClassèƒ½å¤Ÿæ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼Œé‚£ä¹ˆå‰©ä¸‹æ‰€æœ‰éœ€è¦åšçš„å°±æ˜¯åˆ›å»ºPersistentVolumeClaim(PVC)ï¼Œå‰©ä¸‹çš„éƒ½æœ‰é»˜è®¤çš„åŠ¨æ€é…ç½®æå®šï¼ŒåŒ…æ‹¬æ— éœ€å»æŒ‡å®šstorageClassNameï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"> <span class="attr">name:</span> <span class="string">mypvc</span></span><br><span class="line"> <span class="attr">namespace:</span> <span class="string">testns</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line"> <span class="attr">accessModes:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">ReadWriteOnce</span></span><br><span class="line"> <span class="attr">resources:</span></span><br><span class="line">   <span class="attr">requests:</span></span><br><span class="line">     <span class="attr">storage:</span> <span class="string">10Gi</span></span><br></pre></td></tr></table></figure><h6 id="3-ä¿®æ”¹é»˜å›æ”¶ç­–ç•¥-é»˜è®¤ä¸ºDelete"><a href="#3-ä¿®æ”¹é»˜å›æ”¶ç­–ç•¥-é»˜è®¤ä¸ºDelete" class="headerlink" title="3.ä¿®æ”¹é»˜å›æ”¶ç­–ç•¥(é»˜è®¤ä¸ºDelete)"></a>3.ä¿®æ”¹é»˜å›æ”¶ç­–ç•¥(é»˜è®¤ä¸ºDelete)</h6><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">storage.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StorageClass</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">managed-nfs-storage</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line"><span class="attr">provisioner:</span> <span class="string">qgg-nfs-storage</span> <span class="comment">#or choose another name, must match deployment&#x27;s env PROVISIONER_NAME&#x27;</span></span><br><span class="line"><span class="attr">parameters:</span></span><br><span class="line">  <span class="attr">archiveOnDelete:</span> <span class="string">&quot;ture&quot;</span> <span class="comment"># æš‚æ—¶ä¸æ¸…æ¥šè¯¥å€¼å¯¹å›æ”¶ç­–ç•¥äº§ç”Ÿä»€ä¹ˆå½±å“</span></span><br><span class="line"><span class="attr">reclaimPolicy:</span> <span class="string">Retain</span>     <span class="comment"># åªæœ‰NFS å’ŒhostPthæ”¯æŒä¸¤ç§å›æ”¶ç­–ç•¥</span></span><br></pre></td></tr></table></figure><h6 id="4-èƒ½è¿‡åˆ é™¤-å…³é—­é»˜è®¤çš„StorageClass"><a href="#4-èƒ½è¿‡åˆ é™¤-å…³é—­é»˜è®¤çš„StorageClass" class="headerlink" title="4.èƒ½è¿‡åˆ é™¤/å…³é—­é»˜è®¤çš„StorageClass"></a>4.èƒ½è¿‡åˆ é™¤/å…³é—­é»˜è®¤çš„StorageClass</h6><ul><li><strong>ä¸èƒ½åˆ é™¤é»˜è®¤çš„StorageClassï¼Œå› ä¸ºå®ƒæ˜¯ä½œä¸ºé›†ç¾¤çš„add-onå®‰è£…çš„ï¼Œå¦‚æœå®ƒè¢«åˆ é™¤ï¼Œä¼šè¢«é‡æ–°å®‰è£…ã€‚</strong></li><li><strong>å½“ç„¶ï¼Œå¯ä»¥åœæ‰é»˜è®¤çš„StorageClassè¡Œä¸ºï¼Œé€šè¿‡åˆ é™¤annotationï¼šstorageclass.beta.kubernetes.io/is-default-class,æˆ–è€…è®¾ç½®ä¸ºfalseã€‚</strong></li><li><strong>å¦‚æœæ²¡æœ‰StorageClasså¯¹è±¡æ ‡è®°é»˜è®¤çš„annotationï¼Œé‚£ä¹ˆPersistentVolumeClaimå¯¹è±¡ï¼ˆåœ¨ä¸æŒ‡å®šStorageClassæƒ…å†µä¸‹ï¼‰å°†ä¸è‡ªåŠ¨è§¦å‘åŠ¨æ€é…ç½®ã€‚ç›¸åï¼Œå®ƒä»¬å°†å›åˆ°ç»‘å®šå¯ç”¨çš„*PersistentVolume(PV)*çš„çŠ¶æ€ã€‚</strong></li></ul><h6 id="5-å½“åˆ é™¤PersistentVolumeClaim-PVC-ä¼šå‘ç”Ÿä»€ä¹ˆ"><a href="#5-å½“åˆ é™¤PersistentVolumeClaim-PVC-ä¼šå‘ç”Ÿä»€ä¹ˆ" class="headerlink" title="5.å½“åˆ é™¤PersistentVolumeClaim(PVC)ä¼šå‘ç”Ÿä»€ä¹ˆ"></a>5.å½“åˆ é™¤PersistentVolumeClaim(PVC)ä¼šå‘ç”Ÿä»€ä¹ˆ</h6><ul><li><strong>å¦‚æœä¸€ä¸ªå·æ˜¯åŠ¨æ€é…ç½®çš„å·ï¼Œåˆ™é»˜è®¤çš„å›æ”¶ç­–ç•¥ä¸ºâ€œåˆ é™¤â€ã€‚è¿™æ„å‘³ç€ï¼Œåœ¨é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œå½“PVCè¢«åˆ é™¤æ—¶ï¼ŒåŸºç¡€çš„PVå’Œå¯¹åº”çš„å­˜å‚¨ä¹Ÿä¼šè¢«åˆ é™¤ã€‚å¦‚æœéœ€è¦ä¿ç•™å­˜å‚¨åœ¨å·ä¸Šçš„æ•°æ®ï¼Œåˆ™å¿…é¡»åœ¨PVè¢«è®¾ç½®ä¹‹åå°†å›æ”¶ç­–ç•¥ä»deleteæ›´æ”¹ä¸ºretainã€‚</strong></li></ul><p><strong>å‚è€ƒæ–‡æ¡£:</strong><a href="https://github.com/kubernetes-incubator/external-storage/tree/master/nfs-client">https://github.com/kubernetes-incubator/external-storage/tree/master/nfs-client</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>zabbixä½¿ç”¨ä¼ä¸šå¾®ä¿¡æœºå™¨äººæŠ¥è­¦åŠä¸­æ–‡ä¹±ç è§£å†³</title>
      <link href="/2024/11/20/zabbix%E4%BD%BF%E7%94%A8%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%8A%A5%E8%AD%A6%E5%8F%8A%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E8%A7%A3%E5%86%B3/"/>
      <url>/2024/11/20/zabbix%E4%BD%BF%E7%94%A8%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%9C%BA%E5%99%A8%E4%BA%BA%E6%8A%A5%E8%AD%A6%E5%8F%8A%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="zabbixä½¿ç”¨ä¼ä¸šå¾®ä¿¡æœºå™¨äººæŠ¥è­¦åŠä¸­æ–‡ä¹±ç è§£å†³"><a href="#zabbixä½¿ç”¨ä¼ä¸šå¾®ä¿¡æœºå™¨äººæŠ¥è­¦åŠä¸­æ–‡ä¹±ç è§£å†³" class="headerlink" title="zabbixä½¿ç”¨ä¼ä¸šå¾®ä¿¡æœºå™¨äººæŠ¥è­¦åŠä¸­æ–‡ä¹±ç è§£å†³"></a>zabbixä½¿ç”¨ä¼ä¸šå¾®ä¿¡æœºå™¨äººæŠ¥è­¦åŠä¸­æ–‡ä¹±ç è§£å†³</h2><p>å‰è¨€ï¼š</p><p><a href="https://sunlight.zznnwn.cloudns.biz/2024/03/28/zabbix%E7%9B%91%E6%8E%A7%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AE%E6%8A%A5%E8%AD%A6%E5%8F%8Agrafana%E9%9D%A2%E6%9D%BF%E8%AE%BE%E7%BD%AE/?highlight=zabbix">ä¼ ç»Ÿä¼ä¸šå¾®ä¿¡åˆ›å»ºåº”ç”¨æ–¹å¼æŠ¥è­¦</a>ç›®å‰å·²æ”¶è´¹ é‡‡ç”¨å…è´¹æ–¹å¼ ä¼å¾®æœºå™¨äºº</p><h2 id="ä¸€ã€ä¼ä¸šå¾®ä¿¡è®¾ç½®"><a href="#ä¸€ã€ä¼ä¸šå¾®ä¿¡è®¾ç½®" class="headerlink" title="ä¸€ã€ä¼ä¸šå¾®ä¿¡è®¾ç½®"></a>ä¸€ã€ä¼ä¸šå¾®ä¿¡è®¾ç½®</h2><p>ä¼ä¸šå¾®ä¿¡åˆ›å»ºæŠ¥è­¦æœºå™¨äºº</p><p><a href="https://open.work.weixin.qq.com/help2/pc/14931?person_id=1&is_tencent=">å¦‚ä½•è®¾ç½®ç¾¤æœºå™¨äºº -å¸®åŠ©ä¸­å¿ƒ-ä¼ä¸šå¾®ä¿¡</a></p><p>wechat.pyæ–‡ä»¶ç•™å­˜</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># æœºå™¨äººçš„webhookåœ°å€</span></span><br><span class="line">API_URL = <span class="string">&quot;https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=42d6sdhfj0205-77c0-4ef6-b903-2953bd705a65&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># HTTPè¯·æ±‚å¤´éƒ¨ä¿¡æ¯</span></span><br><span class="line">HEADERS = &#123;</span><br><span class="line">    <span class="string">&#x27;Content-Type&#x27;</span>: <span class="string">&#x27;application/json;charset=utf-8&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®šä¹‰å‘é€æ¶ˆæ¯çš„å‡½æ•°</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_text</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="comment"># æ„å»ºæ¶ˆæ¯ä½“</span></span><br><span class="line">    texts = &#123;</span><br><span class="line">        <span class="string">&quot;msgtype&quot;</span>: <span class="string">&quot;text&quot;</span>,</span><br><span class="line">        <span class="string">&quot;text&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;content&quot;</span>: text</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># å‘é€HTTP POSTè¯·æ±‚</span></span><br><span class="line">    response = requests.post(API_URL, json=texts, headers=HEADERS)</span><br><span class="line">    <span class="comment"># æ‰“å°å“åº”å†…å®¹ï¼ˆä¸€èˆ¬ç”¨äºè°ƒè¯•ï¼‰</span></span><br><span class="line">    <span class="built_in">print</span>(response.content)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœè¯¥æ–‡ä»¶è¢«ç›´æ¥æ‰§è¡Œï¼Œåˆ™ä»å‘½ä»¤è¡Œæ¥æ”¶ä¸€ä¸ªå‚æ•°å¹¶å°†å…¶å‘é€åˆ°æœºå™¨äººçš„webhookåœ°å€</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(sys.argv) != <span class="number">2</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Usage: python send_text.py &lt;text&gt;&quot;</span>)</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line">    text = sys.argv[<span class="number">1</span>]  <span class="comment"># è·å–å‘½ä»¤è¡Œå‚æ•°</span></span><br><span class="line">    send_text(text)  <span class="comment"># å‘é€æ¶ˆæ¯</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="äºŒã€zabbixè®¾ç½®"><a href="#äºŒã€zabbixè®¾ç½®" class="headerlink" title="äºŒã€zabbixè®¾ç½®"></a>äºŒã€zabbixè®¾ç½®</h2><p><a href="https://www.cnblogs.com/xiykj/p/18075308">https://www.cnblogs.com/xiykj/p/18075308</a></p><ul><li>è„šæœ¬ä¸Šä¼ åœ¨æœåŠ¡å™¨ç›®å½•ï¼š/usr/lib/zabbix/alertscripts/wechat.py</li><li>è„šæœ¬åç§°ä¸åç«¯è„šæœ¬ä¸€è‡´</li></ul><h3 id="1ã€ç®¡ç†-gt-åª’ä»‹"><a href="#1ã€ç®¡ç†-gt-åª’ä»‹" class="headerlink" title="1ã€ç®¡ç† &gt; åª’ä»‹"></a>1ã€<strong>ç®¡ç† &gt; åª’ä»‹</strong></h3><p>è„šæœ¬å‚æ•°ï¼š{ALERT.MESSAGE}</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_27569bb10a7b517c588e991a55b3076f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_27569bb10a7b517c588e991a55b3076f.png"></p><h3 id="2ã€é…ç½®-gt-åŠ¨ä½œ-gt-è§¦å‘å™¨åŠ¨ä½œ-gt-åˆ›å»ºåŠ¨ä½œå¾®ä¿¡å‘Šè­¦"><a href="#2ã€é…ç½®-gt-åŠ¨ä½œ-gt-è§¦å‘å™¨åŠ¨ä½œ-gt-åˆ›å»ºåŠ¨ä½œå¾®ä¿¡å‘Šè­¦" class="headerlink" title="2ã€é…ç½® &gt; åŠ¨ä½œ &gt; è§¦å‘å™¨åŠ¨ä½œ &gt; åˆ›å»ºåŠ¨ä½œå¾®ä¿¡å‘Šè­¦"></a>2ã€<strong>é…ç½® &gt; åŠ¨ä½œ &gt; è§¦å‘å™¨åŠ¨ä½œ &gt; åˆ›å»ºåŠ¨ä½œå¾®ä¿¡å‘Šè­¦</strong></h3><p>åŠ¨ä½œ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_24b86c8fafc0c9377f51fdc138baa7be.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_24b86c8fafc0c9377f51fdc138baa7be.png"></p><h4 id="2-1ã€æ“ä½œï¼ˆæŠ¥è­¦å‘é€å®šä¹‰ï¼‰"><a href="#2-1ã€æ“ä½œï¼ˆæŠ¥è­¦å‘é€å®šä¹‰ï¼‰" class="headerlink" title="2.1ã€æ“ä½œï¼ˆæŠ¥è­¦å‘é€å®šä¹‰ï¼‰"></a>2.1ã€<strong>æ“ä½œï¼ˆæŠ¥è­¦å‘é€å®šä¹‰ï¼‰</strong></h4><p><strong>ä¸»é¢˜</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ•…éšœ&#123;TRIGGER.STATUS&#125;,æœåŠ¡å™¨:&#123;HOSTNAME1&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;æ•…éšœ!</span><br></pre></td></tr></table></figure><p><strong>æ¶ˆæ¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOSTNAME1&#125;</span><br><span class="line">å‘Šè­¦åœ°å€ï¼š&#123;HOST.IP&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;</span><br><span class="line">å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125;</span><br><span class="line">é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br></pre></td></tr></table></figure><h4 id="2-2ã€æ“ä½œï¼ˆæŠ¥è­¦æ¢å¤å®šä¹‰ï¼‰"><a href="#2-2ã€æ“ä½œï¼ˆæŠ¥è­¦æ¢å¤å®šä¹‰ï¼‰" class="headerlink" title="2.2ã€æ“ä½œï¼ˆæŠ¥è­¦æ¢å¤å®šä¹‰ï¼‰"></a>2.2ã€<strong>æ“ä½œï¼ˆæŠ¥è­¦æ¢å¤å®šä¹‰ï¼‰</strong></h4><p>ä¸»é¢˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">æ•…éšœæ¢å¤&#123;TRIGGER.STATUS&#125;,æœåŠ¡å™¨:&#123;HOSTNAME1&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;å·²æ¢å¤!</span><br></pre></td></tr></table></figure><p>æ¶ˆæ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">æ¢å¤å‘Šè­¦ä¸»æœº:&#123;HOSTNAME1&#125;</span><br><span class="line">å‘Šè­¦åœ°å€ï¼š&#123;HOST.IP&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;</span><br><span class="line">å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125;</span><br><span class="line">é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€ç®¡ç†-gt-ç”¨æˆ·"><a href="#3ã€ç®¡ç†-gt-ç”¨æˆ·" class="headerlink" title="3ã€ç®¡ç† &gt; ç”¨æˆ·"></a>3ã€ç®¡ç† &gt; ç”¨æˆ·</h3><p><strong>è®¾ç½®æŠ¥è­¦åª’ä»‹å¾®ä¿¡æŠ¥è­¦</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_6ef34bc43ecb4959cb775b2900463692.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_6ef34bc43ecb4959cb775b2900463692.png"></p><h2 id="ä¸‰ã€è®¾ç½®ä¸­æ–‡åŠè§£å†³ä¸­æ–‡ä¹±ç "><a href="#ä¸‰ã€è®¾ç½®ä¸­æ–‡åŠè§£å†³ä¸­æ–‡ä¹±ç " class="headerlink" title="ä¸‰ã€è®¾ç½®ä¸­æ–‡åŠè§£å†³ä¸­æ–‡ä¹±ç "></a>ä¸‰ã€è®¾ç½®ä¸­æ–‡åŠè§£å†³ä¸­æ–‡ä¹±ç </h2><p><a href="https://www.cnblogs.com/GEGEWU-/p/16452198.html">zabbixå›¾å½¢ç•Œé¢æ˜¾ç¤ºæ–¹æ¡†+zabbix webé¡µé¢ä¸æ”¯æŒä¸­æ–‡ - GEGEWU- - åšå®¢å›­</a></p><h3 id="1ã€zabbixä¸æ”¯æŒä¸­æ–‡åˆ‡æ¢"><a href="#1ã€zabbixä¸æ”¯æŒä¸­æ–‡åˆ‡æ¢" class="headerlink" title="1ã€zabbixä¸æ”¯æŒä¸­æ–‡åˆ‡æ¢"></a>1ã€zabbixä¸æ”¯æŒä¸­æ–‡åˆ‡æ¢</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ä¸­æ–‡æ”¯æŒåŒ…language-pack-zh-hansï¼š</span></span><br><span class="line">sudo apt-get install language-pack-zh-hans</span><br></pre></td></tr></table></figure><h3 id="2ã€ä¸­æ–‡ä¹±ç è§£å†³"><a href="#2ã€ä¸­æ–‡ä¹±ç è§£å†³" class="headerlink" title="2ã€ä¸­æ–‡ä¹±ç è§£å†³"></a>2ã€ä¸­æ–‡ä¹±ç è§£å†³</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_f5f4b7bd2107721e3babedd0bc6bda81.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_f5f4b7bd2107721e3babedd0bc6bda81.png"></p><h4 id="2-1ã€ä»Windowsç³»åˆ—ç³»ç»Ÿå¤åˆ¶ä¸€ç§ä¸­æ–‡å­—ä½“ï¼š"><a href="#2-1ã€ä»Windowsç³»åˆ—ç³»ç»Ÿå¤åˆ¶ä¸€ç§ä¸­æ–‡å­—ä½“ï¼š" class="headerlink" title="2.1ã€ä»Windowsç³»åˆ—ç³»ç»Ÿå¤åˆ¶ä¸€ç§ä¸­æ–‡å­—ä½“ï¼š"></a>2.1ã€ä»Windowsç³»åˆ—ç³»ç»Ÿå¤åˆ¶ä¸€ç§ä¸­æ–‡å­—ä½“ï¼š</h4><ul><li>windowså­˜æ”¾å­—ä½“ç›®å½•<code>C:\Windows\Fonts</code>å¤åˆ¶ä¸€ä¸ªä¸­æ–‡å­— SIMKAI.TTF<br>å­—ä½“ç•™å­˜<a href="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E4%B8%AD%E6%96%87%E5%AD%97%E4%BD%93/graphfont.ttf">onedrive</a></li></ul><p>æŸ¥çœ‹zabbixå®‰è£…è·¯å¾„çš„æ–¹æ³•ï¼š</p><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"># æˆ–è€…ç›´æ¥ </span><br><span class="line">whereis zabbix</span><br><span class="line"><span class="built_in">find</span> / -name <span class="string">&quot;fornts &quot;</span> </span><br><span class="line"># æœç´¢ç›®å½• </span><br><span class="line"><span class="built_in">find</span> / -name <span class="string">&quot;graphfont.ttf&quot;</span></span><br><span class="line"># å¤‡ä»½åŸå­—ä½“æ–‡ä»¶ </span><br><span class="line">cp /usr/share/zabbix/assets/fonts/graphfont.ttf&#123;,.bak&#125;        (ubuntuéƒ¨ç½²æ‰€åœ¨ç›®å½•)</span><br><span class="line"># ä¸Šä¼ ä¸­æ–‡å­—ä½“æ–‡ä»¶åˆ°è¯¥ç›®å½•</span><br><span class="line">rz</span><br><span class="line"># åˆ é™¤è½¯è¿æ¥é»˜è®¤å­—ä½“æ–‡ä»¶</span><br><span class="line">rm -f graphfont.ttf</span><br><span class="line"># å°†ä¸Šä¼ çš„å­—ä½“æ–‡ä»¶é‡å‘½åä¸º</span><br><span class="line">mv SIMKAI.TTF graphfont.ttf </span><br><span class="line"># æˆäºˆæƒé™ åˆ·æ–°webé¡µé¢æ­¤æ—¶ç”Ÿæ•ˆ</span><br><span class="line">chmod <span class="number">777</span> graphfont.ttf</span><br></pre></td></tr></table></figure><p><strong>å¤‡æ³¨</strong></p><ul><li><code>ls -l</code>å¯ä»¥çœ‹åˆ°é»˜è®¤æ–‡ä»¶å·²é…ç½®è½¯è¿æ¥</li></ul><h4 id="2ã€ä¿®æ”¹phpé…ç½®æ–‡ä»¶ï¼ˆé”™è¯¯é…ç½®ä¸æ“ä½œï¼‰"><a href="#2ã€ä¿®æ”¹phpé…ç½®æ–‡ä»¶ï¼ˆé”™è¯¯é…ç½®ä¸æ“ä½œï¼‰" class="headerlink" title="2ã€ä¿®æ”¹phpé…ç½®æ–‡ä»¶ï¼ˆé”™è¯¯é…ç½®ä¸æ“ä½œï¼‰"></a>2ã€ä¿®æ”¹phpé…ç½®æ–‡ä»¶ï¼ˆé”™è¯¯é…ç½®ä¸æ“ä½œï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># zabbixä½¿ç”¨çš„æ˜¯phpé…ç½®æ–‡ä»¶: /usr/share/zabbix/include/defines.inc.php</span></span><br><span class="line"><span class="comment"># å¤‡ä»½</span></span><br><span class="line"><span class="built_in">cp</span> /usr/share/zabbix/include/defines.inc.php&#123;,.bak&#125;</span><br><span class="line">vim  /usr/share/zabbix/include/defines.inc.php</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰¾åˆ°ZBX_GRAPH_FONT_NAME   ZBX_FONT_NAME  å¹¶ä¿®æ”¹å¯¹åº”çš„å†…å®¹</span></span><br><span class="line"><span class="comment"># åŸå†…å®¹å¦‚ä¸‹ï¼š</span></span><br><span class="line">define(â€˜ZBX_GRAPH_FONT_NAMEâ€™,        â€˜DejaVuSansâ€™);</span><br><span class="line">define(â€˜ZBX_FONT_NAMEâ€™, â€˜DejaVuSansâ€™);</span><br><span class="line"><span class="comment"># ä¿®æ”¹æˆä»¥ä¸‹å†…å®¹ï¼š</span></span><br><span class="line">define(â€˜ZBX_GRAPH_FONT_NAMEâ€™,        â€˜simsunâ€™);</span><br><span class="line">define(â€˜ZBX_FONT_NAMEâ€™, â€˜simsunâ€™);</span><br></pre></td></tr></table></figure><p>å¤‡æ³¨ï¼šè¿™é‡Œä¸éœ€è¦æ·»åŠ æ–‡ä»¶åç¼€å</p><p>æœ€åé‡å¯ï¼šsystemctl restart zabbix-server zabbix-agent nginx php7.4-fpm</p>]]></content>
      
      
      <categories>
          
          <category> zabbix </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zabbix </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8såˆ›å»ºåŸºäºnfsç‰ˆçš„pvä¸pvcå¹¶éƒ¨ç½²PVCç‰ˆcloudreve</title>
      <link href="/2024/11/15/k8s%E5%88%9B%E5%BB%BA%E5%9F%BA%E4%BA%8Enfs%E7%89%88%E7%9A%84pv%E4%B8%8Epvc%E5%B9%B6%E9%83%A8%E7%BD%B2PVC%E7%89%88cloudreve/"/>
      <url>/2024/11/15/k8s%E5%88%9B%E5%BB%BA%E5%9F%BA%E4%BA%8Enfs%E7%89%88%E7%9A%84pv%E4%B8%8Epvc%E5%B9%B6%E9%83%A8%E7%BD%B2PVC%E7%89%88cloudreve/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="k8såˆ›å»ºåŸºäºnfsç‰ˆçš„pvä¸pvcå¹¶éƒ¨ç½²PVCç‰ˆcloudreve"><a href="#k8såˆ›å»ºåŸºäºnfsç‰ˆçš„pvä¸pvcå¹¶éƒ¨ç½²PVCç‰ˆcloudreve" class="headerlink" title="k8såˆ›å»ºåŸºäºnfsç‰ˆçš„pvä¸pvcå¹¶éƒ¨ç½²PVCç‰ˆcloudreve"></a>k8såˆ›å»ºåŸºäºnfsç‰ˆçš„pvä¸pvcå¹¶éƒ¨ç½²PVCç‰ˆcloudreve</h2><h2 id="ä¸€ã€åŸºäºnfså­˜å‚¨éƒ¨ç½²äºŒå‰¯æœ¬cloudreve"><a href="#ä¸€ã€åŸºäºnfså­˜å‚¨éƒ¨ç½²äºŒå‰¯æœ¬cloudreve" class="headerlink" title="ä¸€ã€åŸºäºnfså­˜å‚¨éƒ¨ç½²äºŒå‰¯æœ¬cloudreve"></a>ä¸€ã€åŸºäºnfså­˜å‚¨éƒ¨ç½²äºŒå‰¯æœ¬cloudreve</h2><h3 id="1ã€ç¯å¢ƒï¼ˆåœ¨nfså…±äº«æ–‡ä»¶å¤¹å†…åˆ›å»ºæŒ‚è½½ç›®å½•ï¼‰"><a href="#1ã€ç¯å¢ƒï¼ˆåœ¨nfså…±äº«æ–‡ä»¶å¤¹å†…åˆ›å»ºæŒ‚è½½ç›®å½•ï¼‰" class="headerlink" title="1ã€ç¯å¢ƒï¼ˆåœ¨nfså…±äº«æ–‡ä»¶å¤¹å†…åˆ›å»ºæŒ‚è½½ç›®å½•ï¼‰"></a>1ã€ç¯å¢ƒï¼ˆåœ¨nfså…±äº«æ–‡ä»¶å¤¹å†…åˆ›å»ºæŒ‚è½½ç›®å½•ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºæŒ‚è½½ç›®å½•</span></span><br><span class="line">sudo <span class="built_in">mkdir</span> -p /srv/nfs4/cloudreve-storage</span><br><span class="line">sudo <span class="built_in">mkdir</span> -p /srv/nfs4/config</span><br><span class="line">sudo <span class="built_in">mkdir</span> -p /srv/nfs4/cloudreve/uploads</span><br><span class="line">sudo <span class="built_in">mkdir</span> -p /srv/nfs4/cloudreve/avatar</span><br><span class="line">sudo <span class="built_in">chmod</span> -R 777 /srv/nfs4</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¾ç½®å…±äº«ç›®å½•</span></span><br><span class="line">vim /etc/exports</span><br><span class="line"></span><br><span class="line"><span class="comment"># /srv/nfs4     *(rw,no_subtree_check)</span></span><br><span class="line"><span class="comment"># /nfs/data/pv1     *(rw,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment"># /nfs/data/pv2     *(rw,sync,no_subtree_check)</span></span><br><span class="line"><span class="comment"># /nfs/data/pv3     10.0.0.0/24(rw,sync,no_subtree_check)</span></span><br></pre></td></tr></table></figure><h3 id="2ã€cloudreve-yamlæ–‡ä»¶"><a href="#2ã€cloudreve-yamlæ–‡ä»¶" class="headerlink" title="2ã€cloudreve.yamlæ–‡ä»¶"></a>2ã€cloudreve.yamlæ–‡ä»¶</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">metadata:</span>            <span class="comment"># æºæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">cloudreve</span>    <span class="comment"># å½“å‰deploymentæ‰€å±çš„åå­—</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>     <span class="comment"># åŠns  </span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">cloudreve</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">cloudreve</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudreve</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:xavierniu_cloudreve_3.4.2</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">5212</span></span><br><span class="line">          <span class="attr">volumeMounts:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudreve-storage</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/var/lib/cloudreve</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-volume</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/cloudreve/config</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">uploads-volume</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/cloudreve/uploads</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">avatar-volume</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/cloudreve/avatar</span></span><br><span class="line">          <span class="attr">stdin:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">tty:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">securityContext:</span></span><br><span class="line">            <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudreve-storage</span></span><br><span class="line">          <span class="attr">nfs:</span></span><br><span class="line">            <span class="attr">server:</span> <span class="number">58.49</span><span class="number">.1</span><span class="number">.8</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/srv/nfs4/cloudreve-storage</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">config-volume</span></span><br><span class="line">          <span class="attr">nfs:</span></span><br><span class="line">            <span class="attr">server:</span> <span class="number">58.49</span><span class="number">.1</span><span class="number">.8</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/srv/nfs4/config</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">uploads-volume</span></span><br><span class="line">          <span class="attr">nfs:</span></span><br><span class="line">            <span class="attr">server:</span> <span class="number">58.49</span><span class="number">.1</span><span class="number">.8</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/srv/nfs4/cloudreve/uploads</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">avatar-volume</span></span><br><span class="line">          <span class="attr">nfs:</span></span><br><span class="line">            <span class="attr">server:</span> <span class="number">58.49</span><span class="number">.1</span><span class="number">.8</span> </span><br><span class="line">            <span class="attr">path:</span> <span class="string">/srv/nfs4/cloudreve/avatar</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>  </span><br><span class="line">  <span class="attr">name:</span> <span class="string">cloudreve-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">cloudreve</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">9005</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">5212</span></span><br><span class="line">  <span class="attr">sessionAffinity:</span> <span class="string">ClientIP</span>   </span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹é»˜è®¤è´¦æˆ·å¯†ç </strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">kubectl logs cloudreve-598f69459c-nkbrd</span><br><span class="line">   ___ _                 _              </span><br><span class="line">  / __\ | ___  _   _  __| |_ __ _____   _____ </span><br><span class="line"> / /  | |/ _ \| | | |/ _  | <span class="string">&#x27;__/ _ \ \ / / _ \</span></span><br><span class="line"><span class="string">/ /___| | (_) | |_| | (_| | | |  __/\ V /  __/</span></span><br><span class="line"><span class="string">\____/|_|\___/ \__,_|\__,_|_|  \___| \_/ \___|</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">   V3.4.2  Commit #a11f819  Pro=false</span></span><br><span class="line"><span class="string">================================================</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[Info]    2024-11-15 15:10:43 åˆå§‹åŒ–æ•°æ®åº“è¿æ¥</span></span><br><span class="line"><span class="string">[Info]    2024-11-15 15:10:43 å¼€å§‹è¿›è¡Œæ•°æ®åº“åˆå§‹åŒ–...</span></span><br><span class="line"><span class="string">[Info]    2024-11-15 15:10:43 åˆå§‹ç®¡ç†å‘˜è´¦å·ï¼šadmin@cloudreve.org</span></span><br><span class="line"><span class="string">[Info]    2024-11-15 15:10:43 åˆå§‹ç®¡ç†å‘˜å¯†ç ï¼šscoXZsMt</span></span><br><span class="line"><span class="string">[Info]    2024-11-15 15:10:43 å¼€å§‹æ‰§è¡Œæ•°æ®åº“è„šæœ¬ [UpgradeTo3.4.0]</span></span><br><span class="line"><span class="string">[Info]    2024-11-15 15:10:43 æ•°æ®åº“åˆå§‹åŒ–ç»“æŸ</span></span><br><span class="line"><span class="string">[Info]    2024-11-15 15:10:43 åˆå§‹åŒ–ä»»åŠ¡é˜Ÿåˆ—ï¼ŒWorkerNum = 10</span></span><br><span class="line"><span class="string">[Info]    2024-11-15 15:10:43 åˆå§‹åŒ–å®šæ—¶ä»»åŠ¡...</span></span><br><span class="line"><span class="string">[Info]    2024-11-15 15:10:43 å½“å‰è¿è¡Œæ¨¡å¼ï¼šM</span></span><br></pre></td></tr></table></figure><h3 id="äºŒã€åŸºäºPVCç‰ˆcloudreveéƒ¨ç½²"><a href="#äºŒã€åŸºäºPVCç‰ˆcloudreveéƒ¨ç½²" class="headerlink" title="äºŒã€åŸºäºPVCç‰ˆcloudreveéƒ¨ç½²"></a>äºŒã€åŸºäºPVCç‰ˆcloudreveéƒ¨ç½²</h3><h4 id="1ã€åˆ›å»ºPVå·"><a href="#1ã€åˆ›å»ºPVå·" class="headerlink" title="1ã€åˆ›å»ºPVå·"></a>1ã€åˆ›å»ºPVå·</h4><h5 id="1-1ã€è®¾ç½®åº•å±‚å­˜å‚¨"><a href="#1-1ã€è®¾ç½®åº•å±‚å­˜å‚¨" class="headerlink" title="1.1ã€è®¾ç½®åº•å±‚å­˜å‚¨"></a>1.1ã€è®¾ç½®åº•å±‚å­˜å‚¨</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span>  -pv  /nfs/data/&#123;pv1,pv2,pv3&#125; </span><br><span class="line"><span class="built_in">chmod</span> 777 -R /nfs/data/&#123;pv1,pv2,pv3&#125;  </span><br><span class="line"></span><br><span class="line"><span class="comment"># æš´éœ²æœåŠ¡</span></span><br><span class="line">vim /etc/exports</span><br><span class="line"></span><br><span class="line">/nfs/data/pv1     *(rw,<span class="built_in">sync</span>,no_subtree_check)</span><br><span class="line">/nfs/data/pv2     *(rw,<span class="built_in">sync</span>,no_subtree_check)</span><br><span class="line">/nfs/data/pv3     10.0.0.0/24(rw,<span class="built_in">sync</span>,no_subtree_check)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">systemctl restart nfs</span><br><span class="line">systemctl <span class="built_in">enable</span> nfs</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”Ÿæ•ˆ</span></span><br><span class="line">exportfs -rav</span><br></pre></td></tr></table></figure><p><strong>åˆ›å»ºPVå·ä½¿ç”¨nfsç±»å‹ï¼ˆpv.ymlï¼‰</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolume</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span>  <span class="string">pv1</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">capacity:</span> </span><br><span class="line">    <span class="attr">storage:</span> <span class="string">1Gi</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">ReadWriteMany</span></span><br><span class="line">  <span class="attr">persistentVolumeReclaimPolicy:</span> <span class="string">Retain</span></span><br><span class="line">  <span class="attr">nfs:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/nfs/data/pv1</span></span><br><span class="line">    <span class="attr">server:</span> <span class="number">58.49</span><span class="number">.1</span><span class="number">.8</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolume</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span>  <span class="string">pv2</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">capacity:</span> </span><br><span class="line">    <span class="attr">storage:</span> <span class="string">2Gi</span></span><br><span class="line">  <span class="attr">accessModes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">ReadWriteMany</span></span><br><span class="line">  <span class="attr">persistentVolumeReclaimPolicy:</span> <span class="string">Retain</span></span><br><span class="line">  <span class="attr">nfs:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/nfs/data/pv2</span></span><br><span class="line">    <span class="attr">server:</span> <span class="number">58.49</span><span class="number">.1</span><span class="number">.8</span></span><br><span class="line">  </span><br></pre></td></tr></table></figure><h5 id="1-2ã€ç”³è¯·PVCï¼ˆpvc-ymlï¼‰"><a href="#1-2ã€ç”³è¯·PVCï¼ˆpvc-ymlï¼‰" class="headerlink" title="1.2ã€ç”³è¯·PVCï¼ˆpvc.ymlï¼‰"></a>1.2ã€ç”³è¯·PVCï¼ˆpvc.ymlï¼‰</h5><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pvc1</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">accessModes:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">ReadWriteMany</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">requests:</span></span><br><span class="line">      <span class="attr">storage:</span> <span class="string">5Gi</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">PersistentVolumeClaim</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">pvc2</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">accessModes:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">ReadWriteMany</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">requests:</span></span><br><span class="line">      <span class="attr">storage:</span> <span class="string">5Gi</span></span><br></pre></td></tr></table></figure><h4 id="2ã€åŸºäºPVCç”³è¯·åç«¯å®¹é‡åˆ›å»º"><a href="#2ã€åŸºäºPVCç”³è¯·åç«¯å®¹é‡åˆ›å»º" class="headerlink" title="2ã€åŸºäºPVCç”³è¯·åç«¯å®¹é‡åˆ›å»º"></a>2ã€åŸºäºPVCç”³è¯·åç«¯å®¹é‡åˆ›å»º</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line"><span class="attr">metadata:</span>            <span class="comment"># æºæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">cloudreve</span>    <span class="comment"># å½“å‰deploymentæ‰€å±çš„åå­—</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>     <span class="comment"># åŠns  </span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">cloudreve</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">cloudreve</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudreve</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:xavierniu_cloudreve_3.4.2</span></span><br><span class="line">          <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">5212</span></span><br><span class="line">          <span class="attr">volumeMounts:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudreve-storage</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/var/lib/cloudreve</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudreve-storage</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/cloudreve/config</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudreve-storage</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/cloudreve/uploads</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudreve-storage</span></span><br><span class="line">              <span class="attr">mountPath:</span> <span class="string">/cloudreve/avatar</span></span><br><span class="line">          <span class="attr">stdin:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">tty:</span> <span class="literal">true</span></span><br><span class="line">          <span class="attr">securityContext:</span></span><br><span class="line">            <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudreve-storage</span></span><br><span class="line">          <span class="attr">persistentVolumeClaim:</span></span><br><span class="line">            <span class="attr">claimName:</span> <span class="string">pvc1</span></span><br><span class="line">            <span class="attr">readOnly:</span> <span class="literal">false</span></span><br><span class="line">            <span class="comment"># ä¸å¯å†™trueå³å¯è¯»ä¸å¯å†™</span></span><br><span class="line"></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="comment"># æš´éœ²ç«¯å£</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">cloudreve-service</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>  </span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">cloudreve</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="comment"># å®¿ä¸»æœºç«¯å£</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">9005</span></span><br><span class="line">      <span class="comment"># å®¹å™¨ç«¯å£</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">5212</span></span><br><span class="line">  <span class="attr">sessionAffinity:</span> <span class="string">ClientIP</span>  <span class="comment"># è®¾ç½®ä¼šè¯äº²å’Œæ€§ä½¿å…¶è½¬å‘åˆ°ä¸Šä¸€æ¬¡è®¿é—®çš„ä¼šè¯ä¸­</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span>  </span><br></pre></td></tr></table></figure><h3 id="ä¸‰ã€æ•ˆæœ"><a href="#ä¸‰ã€æ•ˆæœ" class="headerlink" title="ä¸‰ã€æ•ˆæœ"></a>ä¸‰ã€æ•ˆæœ</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_bd516f0e473a2922cafd3ff154c7df7c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_bd516f0e473a2922cafd3ff154c7df7c.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>1ã€k8sä»‹ç»ç­‰</title>
      <link href="/2024/11/13/1%E3%80%81k8s%E4%BB%8B%E7%BB%8D%E7%AD%89/"/>
      <url>/2024/11/13/1%E3%80%81k8s%E4%BB%8B%E7%BB%8D%E7%AD%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€ã€k8sä»‹ç»ç­‰"><a href="#ä¸€ã€k8sä»‹ç»ç­‰" class="headerlink" title="ä¸€ã€k8sä»‹ç»ç­‰"></a>ä¸€ã€k8sä»‹ç»ç­‰</h2><h2 id="ç»“æ„å›¾"><a href="#ç»“æ„å›¾" class="headerlink" title="ç»“æ„å›¾"></a>ç»“æ„å›¾</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_6b8621f97808d6a7af7dace1e9b95dcd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_6b8621f97808d6a7af7dace1e9b95dcd.png"></p><h2 id="k8sç¬”è®°"><a href="#k8sç¬”è®°" class="headerlink" title="k8sç¬”è®°"></a><strong>k8sç¬”è®°</strong></h2><p><strong>NameSpace</strong>ï¼šå‘½åç©ºé—´ï¼Œç”¨æ¥éš”ç¦» <strong>pod</strong> çš„è¿è¡Œç¯å¢ƒ</p><h2 id="é›†ç¾¤ç±»å‹"><a href="#é›†ç¾¤ç±»å‹" class="headerlink" title="é›†ç¾¤ç±»å‹"></a>é›†ç¾¤ç±»å‹</h2><p><strong>ä¸€ä¸»å¤šä»ä¸å¤šä¸»å¤šä»</strong> ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ <strong>å¤šä¸»å¤šä»</strong></p><p>å­¦ä¹  <strong>kubernetes</strong> çš„æ ¸å¿ƒï¼Œå°±æ˜¯å­¦ä¹ å¦‚ä½•å¯¹é›†ç¾¤ä¸Šçš„<code>Podã€Podæ§åˆ¶å™¨ã€Serviceã€å­˜å‚¨</code>ç­‰å„ç§èµ„æºè¿›è¡Œæ“ä½œ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_a9943ac676cc7c29a16e7c0293ce8047.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_a9943ac676cc7c29a16e7c0293ce8047.png"></p><h4 id="2-7é›†ç¾¤éƒ¨ç½²å®Œæˆæµ‹è¯•ï¼ˆæˆåŠŸååˆ™éƒ¨ç½²æˆåŠŸï¼‰"><a href="#2-7é›†ç¾¤éƒ¨ç½²å®Œæˆæµ‹è¯•ï¼ˆæˆåŠŸååˆ™éƒ¨ç½²æˆåŠŸï¼‰" class="headerlink" title="2.7é›†ç¾¤éƒ¨ç½²å®Œæˆæµ‹è¯•ï¼ˆæˆåŠŸååˆ™éƒ¨ç½²æˆåŠŸï¼‰"></a><code>2.7</code>é›†ç¾¤éƒ¨ç½²å®Œæˆæµ‹è¯•ï¼ˆæˆåŠŸååˆ™éƒ¨ç½²æˆåŠŸï¼‰</h4><h5 id="2-7-1-åˆ›å»ºä¸€ä¸ªnginxæœåŠ¡"><a href="#2-7-1-åˆ›å»ºä¸€ä¸ªnginxæœåŠ¡" class="headerlink" title="2.7.1 åˆ›å»ºä¸€ä¸ªnginxæœåŠ¡"></a>2.7.1 åˆ›å»ºä¸€ä¸ªnginxæœåŠ¡</h5><p>kubectl create deployment nginx  â€“image=registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</p><h5 id="2-7-2ã€æš´éœ²ç«¯å£"><a href="#2-7-2ã€æš´éœ²ç«¯å£" class="headerlink" title="2.7.2ã€æš´éœ²ç«¯å£"></a>2.7.2ã€æš´éœ²ç«¯å£</h5><p>kubectl expose deploy nginx  â€“port=80 â€“target-port=80  â€“type=NodePort</p><h5 id="2-7-3ã€æŸ¥çœ‹æœåŠ¡"><a href="#2-7-3ã€æŸ¥çœ‹æœåŠ¡" class="headerlink" title="2.7.3ã€æŸ¥çœ‹æœåŠ¡"></a>2.7.3ã€æŸ¥çœ‹æœåŠ¡</h5><p><strong>kubectl get pod,svc</strong></p><h5 id="2-7-4ã€æŸ¥çœ‹pod"><a href="#2-7-4ã€æŸ¥çœ‹pod" class="headerlink" title="2.7.4ã€æŸ¥çœ‹pod"></a>2.7.4ã€æŸ¥çœ‹pod</h5><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_4e3d1924d8a957214363670284e29bb0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_4e3d1924d8a957214363670284e29bb0.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pveé‡å¯æˆ–é‡è£…æŠ¥é”™initramfs</title>
      <link href="/2024/11/07/pve%E9%87%8D%E5%90%AF%E6%88%96%E9%87%8D%E8%A3%85%E6%8A%A5%E9%94%99initramfs/"/>
      <url>/2024/11/07/pve%E9%87%8D%E5%90%AF%E6%88%96%E9%87%8D%E8%A3%85%E6%8A%A5%E9%94%99initramfs/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="pveé‡å¯æˆ–é‡è£…æŠ¥é”™initramfs"><a href="#pveé‡å¯æˆ–é‡è£…æŠ¥é”™initramfs" class="headerlink" title="pveé‡å¯æˆ–é‡è£…æŠ¥é”™initramfs"></a>pveé‡å¯æˆ–é‡è£…æŠ¥é”™initramfs</h2><p>æŠ¥é”™ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">initramfs)zpool import</span><br><span class="line">pool: rpoolid:6053000132496112234state: UNAVAIL</span><br><span class="line">status:0ne or more devices contains corrupted data.action: The pool cannot be imported due to damaged devices or data.see:https://openzfs.github.io/openzfs-docs/msg/2FS-8000-5Econfig:</span><br><span class="line">rpoo l</span><br><span class="line">UNAVA II.insufficient replicas</span><br><span class="line">mirror-0UNAVA ILinsufficient replicas</span><br><span class="line">nume0n1UNAVA IIinvalid labe l</span><br><span class="line">nume1n1UNAVA ILinva l <span class="built_in">id</span> label</span><br><span class="line">p001:rp00id :7811380569249672400</span><br><span class="line">state:ONLINE</span><br><span class="line">action:The pool can be imported using its name or numeric identifierconf ig :</span><br><span class="line">rpoo lONL INEmirror-0ONL,INEata-SAMSUNG M2?L3480HCHQ-00B7CS6KLNNOW902?40-part3ONL INEata-SAMSUNG M2?L3480HCHQ-00B7C S6KLNNOW?4?226-part3ONLINE</span><br><span class="line">initnamfe</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒï¼šGPT4å›ç­”</p><p>å‡ºç° <code>more than one matching pool</code> é”™è¯¯ï¼Œè¡¨ç¤ºç³»ç»Ÿæ£€æµ‹åˆ°å¤šä¸ªåç§°ç›¸åŒçš„ ZFS å­˜å‚¨æ± ï¼ˆé€šå¸¸æ˜¯ç”±äºç£ç›˜å…‹éš†æˆ–é‡å¤ï¼‰ï¼Œå› æ­¤æ— æ³•ç¡®å®šè¦å¯¼å…¥å“ªä¸ªå­˜å‚¨æ± ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥é€šè¿‡æŒ‡å®šå”¯ä¸€çš„å­˜å‚¨æ±  ID æ¥ç›´æ¥å¯¼å…¥ç‰¹å®šçš„æ± ã€‚</p><p>æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p><strong>åˆ—å‡ºæ‰€æœ‰å¯ç”¨çš„å­˜å‚¨æ± åŠå…¶å”¯ä¸€ ID</strong>ï¼š<br>åœ¨ <code>initramfs</code> æç¤ºç¬¦ä¸‹ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zpool import</span><br></pre></td></tr></table></figure><p>è¿™ä¼šæ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„å­˜å‚¨æ± åˆ—è¡¨ï¼Œå¹¶é™„å¸¦æ¯ä¸ªæ± çš„å”¯ä¸€ IDã€‚</p></li><li><p><strong>æ‰¾åˆ°è¦å¯¼å…¥çš„å­˜å‚¨æ± çš„ç¡®åˆ‡ ID</strong>ï¼š<br>ç¡®å®šéœ€è¦å¯¼å…¥çš„ <code>rpool</code> çš„å”¯ä¸€ IDã€‚åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°ç›¸åº”æ± çš„ IDã€‚</p></li><li><p><strong>ä½¿ç”¨å­˜å‚¨æ±  ID å¯¼å…¥æ± </strong>ï¼š<br>ä½¿ç”¨ä¸Šä¸€æ­¥æŸ¥åˆ°çš„æ±  ID æ¥å¯¼å…¥æ± ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zpool import -f -R /mnt 6053000132496112234</span><br></pre></td></tr></table></figure><ul><li>æŠŠ <code>6053000132496112234</code> æ›¿æ¢ä¸ºä½ è¦å¯¼å…¥çš„å­˜å‚¨æ± çš„å”¯ä¸€ IDã€‚</li><li><code>-f</code> å‚æ•°å¼ºåˆ¶å¯¼å…¥ï¼Œ<code>-R /mnt</code> ç”¨äºæŒ‡å®šæ ¹æ± çš„æŒ‚è½½ç‚¹ï¼Œå¯æ ¹æ®ç³»ç»Ÿæƒ…å†µè°ƒæ•´ <code>/mnt</code>ã€‚</li></ul></li><li><p><strong>ç»§ç»­å¯åŠ¨ç³»ç»Ÿ</strong>ï¼š<br>å­˜å‚¨æ± æˆåŠŸå¯¼å…¥åï¼Œé€€å‡º <code>initramfs</code> æç¤ºç¬¦ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><p>ç³»ç»Ÿåº”ç»§ç»­å¯åŠ¨ã€‚</p></li></ol><p>æ ¹æ®é”™è¯¯ä¿¡æ¯ï¼Œ<code>rpool</code> æ± çš„çŠ¶æ€ä¸º <code>UNAVAIL</code>ï¼Œä¸”åŒ…å«å—æŸçš„æ•°æ®æˆ–è®¾å¤‡ï¼Œå¯¼è‡´æ— æ³•å¯¼å…¥ã€‚è¿™é€šå¸¸æ˜¯ç”±äºè®¾å¤‡æŸåæˆ–æ ‡ç­¾ï¼ˆlabelï¼‰æŸåå¼•èµ·çš„ã€‚åŒæ—¶ï¼Œè¿˜æ˜¾ç¤ºäº†å¦ä¸€ä¸ªå¯ç”¨çš„æ±  ID ä¸º <code>7811380569249672400</code>ï¼Œä¸”çŠ¶æ€ä¸º <code>ONLINE</code>ã€‚</p><p>ä»¥ä¸‹æ˜¯å°è¯•è§£å†³é—®é¢˜çš„æ­¥éª¤ï¼š</p><h3 id="1-é€‰æ‹©å¯ç”¨çš„æ± "><a href="#1-é€‰æ‹©å¯ç”¨çš„æ± " class="headerlink" title="1. é€‰æ‹©å¯ç”¨çš„æ± "></a>1. é€‰æ‹©å¯ç”¨çš„æ± </h3><p>åœ¨æ˜¾ç¤ºçš„ä¸¤ä¸ªæ± ä¸­ï¼Œæœ‰ä¸€ä¸ª <code>rpool</code> çŠ¶æ€ä¸º <code>ONLINE</code>ï¼Œå¯ä»¥å°è¯•å¯¼å…¥è¿™ä¸ªå¯ç”¨çš„æ± ã€‚ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŒ‰å…¶å”¯ä¸€ ID å¯¼å…¥å®ƒï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zpool import -f -R /mnt 7811380569249672400</span><br></pre></td></tr></table></figure><ul><li><code>-f</code> å¼ºåˆ¶å¯¼å…¥ï¼Œ<code>-R /mnt</code> æŒ‡å®šæ ¹ç›®å½•çš„æŒ‚è½½ç‚¹ã€‚</li></ul><h3 id="2-æ£€æŸ¥æ˜¯å¦å¯ä»¥ç»§ç»­å¯åŠ¨"><a href="#2-æ£€æŸ¥æ˜¯å¦å¯ä»¥ç»§ç»­å¯åŠ¨" class="headerlink" title="2. æ£€æŸ¥æ˜¯å¦å¯ä»¥ç»§ç»­å¯åŠ¨"></a>2. æ£€æŸ¥æ˜¯å¦å¯ä»¥ç»§ç»­å¯åŠ¨</h3><p>å¯¼å…¥æˆåŠŸåï¼Œé€€å‡º <code>initramfs</code> æç¤ºç¬¦ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><h3 id="3-ä¿®å¤æŸåçš„æ± ï¼ˆå¦‚æœå¯¼å…¥æˆåŠŸï¼‰"><a href="#3-ä¿®å¤æŸåçš„æ± ï¼ˆå¦‚æœå¯¼å…¥æˆåŠŸï¼‰" class="headerlink" title="3. ä¿®å¤æŸåçš„æ± ï¼ˆå¦‚æœå¯¼å…¥æˆåŠŸï¼‰"></a>3. ä¿®å¤æŸåçš„æ± ï¼ˆå¦‚æœå¯¼å…¥æˆåŠŸï¼‰</h3><p>å¦‚æœç³»ç»ŸæˆåŠŸå¯åŠ¨ï¼Œæ‚¨å¯ä»¥åœ¨ç³»ç»Ÿå†…å¯¹æ±  <code>6053000132496112234</code> è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€æŸ¥å’Œä¿®å¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zpool status</span><br><span class="line">zpool scrub rpool</span><br></pre></td></tr></table></figure><p>æ‚¨é‡åˆ°çš„é”™è¯¯è¡¨æ˜ <code>rpool</code> æ± æ— æ³•å¯¼å…¥ï¼Œå› ä¸ºå…¶é•œåƒä¸­çš„è®¾å¤‡ï¼ˆ<code>nvme0n1</code> å’Œ <code>nvme1n1</code>ï¼‰åŒ…å«æŸåæˆ–æ— æ•ˆçš„æ ‡ç­¾ï¼Œè¿™å¯èƒ½å¯¼è‡´ <code>rpool</code> çŠ¶æ€ä¸å¯ç”¨ï¼ˆ<code>UNAVAIL</code>ï¼‰ï¼Œå¹¶æ˜¾ç¤ºâ€œinsufficient replicasâ€ï¼ˆå‰¯æœ¬ä¸è¶³ï¼‰ã€‚è¿™æ˜¯ç”±äºç¡¬ä»¶æŸåã€æ–‡ä»¶ç³»ç»Ÿæ•…éšœæˆ–æ± å…ƒæ•°æ®æŸåå¼•èµ·çš„ã€‚</p><p>ä»¥ä¸‹æ˜¯æ‚¨å¯ä»¥å°è¯•çš„æ­¥éª¤ï¼š</p><h3 id="1-æ£€æŸ¥è®¾å¤‡æ˜¯å¦è¿æ¥æ­£å¸¸"><a href="#1-æ£€æŸ¥è®¾å¤‡æ˜¯å¦è¿æ¥æ­£å¸¸" class="headerlink" title="1. æ£€æŸ¥è®¾å¤‡æ˜¯å¦è¿æ¥æ­£å¸¸"></a>1. æ£€æŸ¥è®¾å¤‡æ˜¯å¦è¿æ¥æ­£å¸¸</h3><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè®¾å¤‡å¯èƒ½æœªå®Œå…¨è¿æ¥æˆ–å‡ºç°äº†æ¥è§¦ä¸è‰¯ã€‚å°è¯•é‡æ–°è¿æ¥æˆ–æ£€æŸ¥ <code>nvme0n1</code> å’Œ <code>nvme1n1</code> è®¾å¤‡çš„ç‰©ç†çŠ¶æ€ã€‚</p><h3 id="2-å¼ºåˆ¶å¯¼å…¥åªè¯»æ¨¡å¼"><a href="#2-å¼ºåˆ¶å¯¼å…¥åªè¯»æ¨¡å¼" class="headerlink" title="2. å¼ºåˆ¶å¯¼å…¥åªè¯»æ¨¡å¼"></a>2. å¼ºåˆ¶å¯¼å…¥åªè¯»æ¨¡å¼</h3><p>å¦‚æœæ‚¨åªéœ€è¦è¯»å–æ•°æ®ï¼Œå¯ä»¥å°è¯•ä»¥åªè¯»æ¨¡å¼å¼ºåˆ¶å¯¼å…¥å—æŸçš„æ± ï¼Œè¿™æœ‰æ—¶å¯ä»¥é¿å…è¿›ä¸€æ­¥æŸåæ•°æ®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zpool import -o <span class="built_in">readonly</span>=on -f -R /mnt 6053000132496112234</span><br></pre></td></tr></table></figure><ul><li><code>-o readonly=on</code> ä»¥åªè¯»æ–¹å¼å¯¼å…¥æ± ï¼Œé˜²æ­¢è¿›ä¸€æ­¥å†™å…¥å¯èƒ½æŸåçš„æ•°æ®ã€‚</li><li><code>-f</code> å¼ºåˆ¶å¯¼å…¥ã€‚</li><li><code>-R /mnt</code> å°†æ± æŒ‚è½½åˆ° <code>/mnt</code>ï¼ˆå¯ä»¥æ ¹æ®éœ€è¦æ›´æ”¹ï¼‰ã€‚</li></ul><h3 id="3-ä½¿ç”¨-zpool-clear-æ¸…é™¤é”™è¯¯ï¼ˆå¦‚æœæˆåŠŸå¯¼å…¥ï¼‰"><a href="#3-ä½¿ç”¨-zpool-clear-æ¸…é™¤é”™è¯¯ï¼ˆå¦‚æœæˆåŠŸå¯¼å…¥ï¼‰" class="headerlink" title="3. ä½¿ç”¨ zpool clear æ¸…é™¤é”™è¯¯ï¼ˆå¦‚æœæˆåŠŸå¯¼å…¥ï¼‰"></a>3. ä½¿ç”¨ <code>zpool clear</code> æ¸…é™¤é”™è¯¯ï¼ˆå¦‚æœæˆåŠŸå¯¼å…¥ï¼‰</h3><p>å¦‚æœæ± èƒ½å¤ŸæˆåŠŸå¯¼å…¥ï¼Œå¯ä»¥å°è¯•æ¸…é™¤é”™è¯¯å¹¶è¿è¡Œæ•°æ®æ£€æŸ¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zpool clear rpool</span><br><span class="line">zpool scrub rpool</span><br></pre></td></tr></table></figure><ul><li><code>zpool scrub</code> ä¼šæ£€æŸ¥æ•°æ®å®Œæ•´æ€§ï¼Œä¿®å¤å¯æ¢å¤çš„æ•°æ®å—ã€‚</li></ul><h3 id="4-å°è¯•ä¿®å¤æŸåçš„æ ‡ç­¾"><a href="#4-å°è¯•ä¿®å¤æŸåçš„æ ‡ç­¾" class="headerlink" title="4. å°è¯•ä¿®å¤æŸåçš„æ ‡ç­¾"></a>4. å°è¯•ä¿®å¤æŸåçš„æ ‡ç­¾</h3><p>å¦‚æœæ— æ³•å¯¼å…¥ï¼Œå¯ä»¥å°è¯•é‡å»ºè®¾å¤‡çš„æ ‡ç­¾ï¼Œä¸è¿‡è¿™å…·æœ‰ä¸€å®šçš„é£é™©ï¼Œè¯·è°¨æ…æ“ä½œã€‚å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">zpool labelclear -f /dev/nvme0n1</span><br><span class="line">zpool labelclear -f /dev/nvme1n1</span><br></pre></td></tr></table></figure><ul><li>æ­¤æ“ä½œä¼šæ¸…é™¤è®¾å¤‡ä¸Šçš„ ZFS æ ‡ç­¾ï¼Œä½¿æ‚¨å¯ä»¥é‡æ–°å°è¯•å¯¼å…¥ã€‚</li></ul><h3 id="5-æ£€æŸ¥æ˜¯å¦éœ€è¦æ•°æ®æ¢å¤"><a href="#5-æ£€æŸ¥æ˜¯å¦éœ€è¦æ•°æ®æ¢å¤" class="headerlink" title="5. æ£€æŸ¥æ˜¯å¦éœ€è¦æ•°æ®æ¢å¤"></a>5. æ£€æŸ¥æ˜¯å¦éœ€è¦æ•°æ®æ¢å¤</h3><p>å¦‚æœä¸Šè¿°æ­¥éª¤ä»ç„¶æ— æ³•å¯¼å…¥æ± æˆ–ä¿®å¤æ•°æ®ï¼Œå¯èƒ½éœ€è¦ä¸“ä¸šçš„æ•°æ®æ¢å¤å·¥å…·æˆ–è”ç³»æ•°æ®æ¢å¤æœåŠ¡ã€‚</p><p>å¦‚æœå¯ä»¥æˆåŠŸè¿›å…¥ç³»ç»Ÿï¼Œå»ºè®®ç«‹å³å¤‡ä»½é‡è¦æ•°æ®ã€‚å¸Œæœ›è¿™äº›æ–¹æ³•å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ï¼å¦‚æœéœ€è¦è¿›ä¸€æ­¥çš„å¸®åŠ©ï¼Œè¯·å‘Šè¯‰æˆ‘æ›´å¤šç»†èŠ‚ã€‚</p></blockquote><p>å®é™…æ“ä½œè§£å†³</p><p>1ã€æŸ¥çœ‹id åˆ—è¡¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è®¾å¤‡idåˆ—è¡¨</span></span><br><span class="line">zpool import</span><br><span class="line"><span class="comment"># å¯¼å…¥æ­£å¸¸çš„id</span></span><br><span class="line">zpool import -f -R /mnt 6053000132496112234</span><br><span class="line"><span class="comment"># ä¿®å¤æœ‰é—®é¢˜çš„è®¾å¤‡</span></span><br><span class="line">zpool labelclear -f /dev/nvme0n1</span><br><span class="line"><span class="comment"># è¿ç»­ä¸¤æ¬¡ä¸­é—´é—´éš”5sè¾“å…¥exité€€å‡º åç³»ç»Ÿè‡ªåŠ¨é‡å¯åç³»ç»Ÿæ­£å¸¸è¿›å…¥ç³»ç»Ÿé—®é¢˜è§£å†³</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœæ± èƒ½å¤ŸæˆåŠŸå¯¼å…¥ï¼Œå¯ä»¥å°è¯•æ¸…é™¤é”™è¯¯å¹¶è¿è¡Œæ•°æ®æ£€æŸ¥</span></span><br><span class="line">zpool clear rpool</span><br><span class="line">zpool scrub rpool</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> pve </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntué…ç½®smbæŒ‚è½½åˆ°windows</title>
      <link href="/2024/11/07/ubuntu%E9%85%8D%E7%BD%AEsmb%E6%8C%82%E8%BD%BD%E5%88%B0windows/"/>
      <url>/2024/11/07/ubuntu%E9%85%8D%E7%BD%AEsmb%E6%8C%82%E8%BD%BD%E5%88%B0windows/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ubuntué…ç½®smbæŒ‚è½½åˆ°windows"><a href="#ubuntué…ç½®smbæŒ‚è½½åˆ°windows" class="headerlink" title="ubuntué…ç½®smbæŒ‚è½½åˆ°windows"></a>ubuntué…ç½®smbæŒ‚è½½åˆ°windows</h2><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/qq_44078824/article/details/119847027">https://blog.csdn.net/qq_44078824/article/details/119847027</a></p><h3 id="ä¸€ã€ubuntué…ç½®smbå®¢æˆ·ç«¯"><a href="#ä¸€ã€ubuntué…ç½®smbå®¢æˆ·ç«¯" class="headerlink" title="ä¸€ã€ubuntué…ç½®smbå®¢æˆ·ç«¯"></a>ä¸€ã€ubuntué…ç½®smbå®¢æˆ·ç«¯</h3><h4 id="1ã€å®‰è£…smbè½¯ä»¶"><a href="#1ã€å®‰è£…smbè½¯ä»¶" class="headerlink" title="1ã€å®‰è£…smbè½¯ä»¶"></a>1ã€å®‰è£…smbè½¯ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½smbè½¯ä»¶</span></span><br><span class="line">apt-get install samba samba-common</span><br><span class="line"><span class="comment"># è®¾ç½®å¼€æœºè‡ªå¯åŠ¨</span></span><br><span class="line">sudo systemctl <span class="built_in">enable</span> smbd</span><br><span class="line">sudo systemctl <span class="built_in">enable</span> nmbd</span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">sudo systemctl start smbd</span><br><span class="line">sudo systemctl start nmbd</span><br><span class="line">sudo systemctl status smbd</span><br><span class="line">sudo systemctl status nmbd</span><br></pre></td></tr></table></figure><h4 id="2ã€é…ç½®smbæœåŠ¡"><a href="#2ã€é…ç½®smbæœåŠ¡" class="headerlink" title="2ã€é…ç½®smbæœåŠ¡"></a>2ã€é…ç½®smbæœåŠ¡</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºç”¨äºå…±äº«çš„smbæœåŠ¡</span></span><br><span class="line"><span class="built_in">mkdir</span> -pv /smb/root/share</span><br><span class="line"><span class="comment"># ç»™äºˆæƒé™</span></span><br><span class="line"><span class="built_in">chmod</span> 755 /smb/root/share</span><br><span class="line"><span class="comment"># åˆ›å»ºå½“å‰ç™»å½•ubuntuç³»ç»Ÿçš„ç”¨æˆ·ç”¨äºsmbç™»å½•çš„å¯†ç  è¾“å…¥å¯†ç ï¼Œå¯†ç ä¼šè¾“å…¥2æ¬¡</span></span><br><span class="line">smbpasswd -a root</span><br></pre></td></tr></table></figure><h3 id="3ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼‰"><a href="#3ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼‰" class="headerlink" title="3ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼‰"></a>3ã€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆåœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶</span></span><br><span class="line">vim /etc/samba/smb.conf</span><br><span class="line"></span><br><span class="line">[share]</span><br><span class="line">comment = share folder</span><br><span class="line">browseable = <span class="built_in">yes</span></span><br><span class="line">path = /smb/root/share</span><br><span class="line">create mask = 0700</span><br><span class="line">directory mask = 0700</span><br><span class="line">valid <span class="built_in">users</span> = root</span><br><span class="line">force user = root</span><br><span class="line">force group = root</span><br><span class="line">public = <span class="built_in">yes</span></span><br><span class="line">available = <span class="built_in">yes</span></span><br><span class="line">writable = <span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>é‡å¯ç”Ÿæ•ˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæ•ˆé…ç½®</span></span><br><span class="line">service smbd restart</span><br></pre></td></tr></table></figure><p>å…¶ä¸­rootï¼Œä»ä¸ºæˆ‘çš„ç”¨æˆ·åä¿¡æ¯ã€‚</p><p>åœ¨é…ç½®æ–‡ä»¶çš„æœ€åæ·»åŠ å¦‚ä¸‹ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_e6aed2c36dab129fb04e6785685da771.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_e6aed2c36dab129fb04e6785685da771.png"></p><h3 id="4ã€é˜²ç«å¢™æ”¾å¼€å¯¹åº”ç«¯å£"><a href="#4ã€é˜²ç«å¢™æ”¾å¼€å¯¹åº”ç«¯å£" class="headerlink" title="4ã€é˜²ç«å¢™æ”¾å¼€å¯¹åº”ç«¯å£"></a>4ã€é˜²ç«å¢™æ”¾å¼€å¯¹åº”ç«¯å£</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ”¾é€šsmbç«¯å£</span></span><br><span class="line">ufw allow 139</span><br><span class="line">ufw allow 445</span><br></pre></td></tr></table></figure><h2 id="äºŒã€windowså®¢æˆ·ç«¯ç™»å½•"><a href="#äºŒã€windowså®¢æˆ·ç«¯ç™»å½•" class="headerlink" title="äºŒã€windowså®¢æˆ·ç«¯ç™»å½•"></a>äºŒã€windowså®¢æˆ·ç«¯ç™»å½•</h2><p>1ã€win+r cmdè¾“å…¥smbæœåŠ¡ç«¯IP<code>\\10.0.0.10</code></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_232bd704262c6ef34b1aec7bfea58759.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_232bd704262c6ef34b1aec7bfea58759.png"></p><p>2ã€æ­¤æ—¶æ–‡ä»¶å¤¹ç½‘ç»œå‡ºå…ˆshareæ–‡ä»¶å¤¹ åŒå‡»è¾“å…¥å¯†ç å³å¯æŒ‚è½½æˆåŠŸ</p><p>3ã€åœ¨è¯¥æŒ‚è½½çš„è®¾å¤‡å¤„å³é”®æ˜ å°„ç½‘ç»œé©±åŠ¨å™¨ è¾“å…¥<code>\\10.0.0.10\share</code>å³å¯</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_6b37c023678eb577bc676999b67cfcdc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_6b37c023678eb577bc676999b67cfcdc.png"></p><p>4ã€æœ€ç»ˆæ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_2ddc73f6c414a5fc0c34c8d9e60bb773.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_2ddc73f6c414a5fc0c34c8d9e60bb773.png"></p><h2 id="ä¸‰ã€ä¸€ç³»åˆ—æŠ¥é”™è§£å†³"><a href="#ä¸‰ã€ä¸€ç³»åˆ—æŠ¥é”™è§£å†³" class="headerlink" title="ä¸‰ã€ä¸€ç³»åˆ—æŠ¥é”™è§£å†³"></a>ä¸‰ã€ä¸€ç³»åˆ—æŠ¥é”™è§£å†³</h2><h3 id="ç°è±¡1ï¼š"><a href="#ç°è±¡1ï¼š" class="headerlink" title="ç°è±¡1ï¼š"></a>ç°è±¡1ï¼š</h3><p>ä¸å…è®¸ä¸€ä¸ªç”¨æˆ·ä½¿ç”¨ä¸€ä¸ªä»¥ä¸Šç”¨æˆ·åä¸æœåŠ¡å™¨æˆ–å…±äº«èµ„æºçš„å¤šé‡è¿æ¥ï¼Œä¸­æ–­ä¸æ­¤æœåŠ¡å™¨æˆ–å…±äº«</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/sunnyhill/p/11780248.html">https://www.cnblogs.com/sunnyhill/p/11780248.html</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_48dd7cdd1b5745f1a43a3058a388ad50.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_48dd7cdd1b5745f1a43a3058a388ad50.png"></p><h3 id="è§£å†³ï¼š"><a href="#è§£å†³ï¼š" class="headerlink" title="è§£å†³ï¼š"></a>è§£å†³ï¼š</h3><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/sunnyhill/p/11780248.html">https://www.cnblogs.com/sunnyhill/p/11780248.html</a></p><p>åŒä¸€è´¦å·ï¼Œä¸åŒç”µè„‘ç™»å½•ç»“æœä¸åŒï¼Œ æ¨æ–­æœåŠ¡å™¨ç«¯è®¾ç½®æ­£å¸¸ï¼Œé—®é¢˜å‡ºåœ¨å®¢æˆ·ç«¯ç”µè„‘ä¸Šï¼›</p><p>æ‰“å¼€å‘½ä»¤è¡Œçª—å£ï¼šè¿è¡Œ - CMD</p><p>ç»ˆç«¯ä¸‹é”®å…¥å‘½ä»¤ï¼š</p><p>:&gt;net use //æŸ¥çœ‹å·²ç»ç»‘å®šç¼“å­˜</p><p>:&gt;net use \\å…±äº«IP\æ–‡ä»¶å¤¹è·¯å¾„  /delete  //å¯¹ç¼“å­˜è¿›è¡Œæ¸…ç†</p><p><code>net use  \\192.168.39.4\IPC$  /delete</code></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_fcd90bb8330b643505283138943e87f1.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_fcd90bb8330b643505283138943e87f1.png"></p><p>æ–¹æ³•äºŒï¼šé‡æ–°åˆ›å»ºWindowså‡­æ®</p><p>å¦‚ä»¥ä¸Šä¸¤ç§æ–¹æ³•æ— æ•ˆï¼Œå¯å°è¯•é‡æ–°â€œæ·»åŠ Windowså‡­æ®â€ï¼Œé‡æ–°ç™»å½•ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_4673bce75d4d23c3ad9f3d2a0759e687.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_4673bce75d4d23c3ad9f3d2a0759e687.png"></p><h3 id="ç°è±¡2"><a href="#ç°è±¡2" class="headerlink" title="ç°è±¡2"></a>ç°è±¡2</h3><p>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/164721714">https://zhuanlan.zhihu.com/p/164721714</a></p><p>ä½ ä¸èƒ½è®¿é—®æ­¤å…±äº«æ–‡ä»¶å¤¹,å› ä¸ºä½ ç»„ç»‡çš„å®‰å…¨ç­–ç•¥ç»„ç»‡æœªç»èº«ä»½éªŒè¯çš„æ¥å®¾è®¿é—®ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_67ca98e8993674a6ead75c97b72c13d3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_67ca98e8993674a6ead75c97b72c13d3.png"></p><h3 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><p>æŒ‰window+Ré”®è¾“å…¥gpedit.msc æ¥å¯åŠ¨æœ¬åœ°ç»„ç­–ç•¥ç¼–è¾‘å™¨ ç®¡ç†é¢æ¿ ç½‘ç»œ lanmanå·¥ä½œç«™ å¯ç”¨ä¸å®‰å…¨çš„â€¦ç™»å½•ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_27c05b9a6bf92f48e9663356bf95bb2b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_27c05b9a6bf92f48e9663356bf95bb2b.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_49e5ef6ce88ac62e036507da3e894d8b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_49e5ef6ce88ac62e036507da3e894d8b.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_006598654d2ebf010d9d0b7d24a840d8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_006598654d2ebf010d9d0b7d24a840d8.png"></p><h3 id="ç°è±¡3"><a href="#ç°è±¡3" class="headerlink" title="ç°è±¡3"></a>ç°è±¡3</h3><p>Windowsè®¿é—®å…±äº«æ–‡ä»¶æŠ¥é”™ï¼šè¯·æ£€æŸ¥åç§°æ‹¼å†™ã€‚å¦åˆ™ï¼Œç½‘ç»œå¯èƒ½æœ‰é—®é¢˜</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_d331b8ba09ee7c76981155fecb507d63.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_d331b8ba09ee7c76981155fecb507d63.png"></p><h3 id="è§£å†³-1"><a href="#è§£å†³-1" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_44451165/article/details/121975436">https://blog.csdn.net/qq_44451165/article/details/121975436</a></p><p>ç‚¹å‡»Win+Rï¼Œè¾“å…¥<a href="https://so.csdn.net/so/search?q=cmd&spm=1001.2101.3001.7020">cmd</a>ï¼Œå›è½¦ï¼Œè¾“å…¥ä¸‹åˆ—å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">net use \\IPåœ°å€\ipc$ <span class="string">&quot;å¯†ç &quot;</span> /user:<span class="string">&quot;administrator&quot;</span> </span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_d33eb6158495ed655c064163addf5f2e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_d33eb6158495ed655c064163addf5f2e.png"></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>6ã€serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£ï¼‰</title>
      <link href="/2024/10/27/6%E3%80%81service%EF%BC%88pod%E5%AF%B9%E5%A4%96%E6%9A%B4%E9%9C%B2%E7%AB%AF%E5%8F%A3%EF%BC%89/"/>
      <url>/2024/10/27/6%E3%80%81service%EF%BC%88pod%E5%AF%B9%E5%A4%96%E6%9A%B4%E9%9C%B2%E7%AB%AF%E5%8F%A3%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="6ã€serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£ï¼‰"><a href="#6ã€serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£ï¼‰" class="headerlink" title="6ã€serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£ï¼‰"></a>6ã€serviceï¼ˆpodå¯¹å¤–æš´éœ²ç«¯å£ï¼‰</h2><h3 id="4-5-Service"><a href="#4-5-Service" class="headerlink" title="4.5 Service"></a>4.5 Service</h3><p><strong>é€šè¿‡ä¸ŠèŠ‚è¯¾çš„å­¦ä¹ ï¼Œå·²ç»èƒ½å¤Ÿåˆ©ç”¨Deploymentæ¥åˆ›å»ºä¸€ç»„Podæ¥æä¾›å…·æœ‰é«˜å¯ç”¨æ€§çš„æœåŠ¡ã€‚</strong></p><p><strong>è™½ç„¶æ¯ä¸ªPodéƒ½ä¼šåˆ†é…ä¸€ä¸ªå•ç‹¬çš„Pod IPï¼Œç„¶è€Œå´å­˜åœ¨å¦‚ä¸‹ä¸¤é—®é¢˜ï¼š</strong></p><ul><li><strong>Pod IP ä¼šéšç€Podçš„é‡å»ºäº§ç”Ÿå˜åŒ–</strong></li><li><strong>Pod IP ä»…ä»…æ˜¯é›†ç¾¤å†…å¯è§çš„è™šæ‹ŸIPï¼Œå¤–éƒ¨æ— æ³•è®¿é—®</strong></li></ul><p><strong>è¿™æ ·å¯¹äºè®¿é—®è¿™ä¸ªæœåŠ¡å¸¦æ¥äº†éš¾åº¦ã€‚å› æ­¤ï¼Œkubernetesè®¾è®¡äº†Serviceæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</strong></p><p><strong>Serviceå¯ä»¥çœ‹ä½œæ˜¯ä¸€ç»„åŒç±»Pod<strong><strong>å¯¹å¤–çš„è®¿é—®æ¥å£</strong></strong>ã€‚å€ŸåŠ©Serviceï¼Œåº”ç”¨å¯ä»¥</strong>æ–¹ä¾¿åœ°å®ç°æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_d7f2ed85346cce5cc991e3595fe22339.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_d7f2ed85346cce5cc991e3595fe22339.png"></p><h3 id="4-5-1-åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯è®¿é—®çš„Service"><a href="#4-5-1-åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯è®¿é—®çš„Service" class="headerlink" title="4.5.1 åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯è®¿é—®çš„Service"></a>4.5.1 åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯è®¿é—®çš„Service</h3><p>**å‰é¢ç¬¬5èŠ‚æˆ‘ä»¬åˆ›å»ºçš„pod è¦è®¿é—®ä»–éœ€è¦æŸ¥çœ‹ä»–çš„IP ä½†æ˜¯æ­¤IPæ˜¯èƒ½é›†ç¾¤å†…éƒ¨è®¿é—® IPè¿˜ä¼šå˜åŒ– å¹¶ä¸”å¤–é¢ç¯å¢ƒæ˜¯æ— æ³•è®¿é—®çš„ **</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹devä¸‹é¢podä¿¡æ¯</span></span><br><span class="line">kubectl get pods -n dev -o wide</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_8b1f4ccbd33ebc304d15abd941459981.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_8b1f4ccbd33ebc304d15abd941459981.png"></p><h2 id="ä¸€-åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service"><a href="#ä¸€-åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service" class="headerlink" title="ä¸€. åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service"></a>ä¸€. åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service</h2><h3 id="1ã€é›†ç¾¤å†…éƒ¨è®¿é—®"><a href="#1ã€é›†ç¾¤å†…éƒ¨è®¿é—®" class="headerlink" title="1ã€é›†ç¾¤å†…éƒ¨è®¿é—®"></a>1ã€é›†ç¾¤å†…éƒ¨è®¿é—®</h3><p><strong>ç¯å¢ƒå‡†å¤‡ï¼š</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span>  <span class="comment"># ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span>     <span class="comment"># ç±»å‹</span></span><br><span class="line"><span class="attr">metadata:</span>            <span class="comment"># æºæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx</span>        <span class="comment"># å½“å‰deploymentæ‰€å±çš„åå­—</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>     <span class="comment"># åŠns</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span>        <span class="comment"># å®šä¹‰å‰¯æœ¬æ•°</span></span><br><span class="line">  <span class="attr">selector:</span>          <span class="comment"># æ ‡ç­¾é€‰æ‹©å™¨</span></span><br><span class="line">    <span class="attr">matchLabels:</span>     <span class="comment"># é€‰æ‹©nginxæ ‡ç­¾</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span>          <span class="comment"># ä»¥ä¸‹ä¸ºpod æ¨¡æ¿</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span>        <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">nginx</span>   <span class="comment"># å®šä¹‰æ ‡ç­¾ä¸ºnginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">svc-nginx1</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">protocol:</span> <span class="string">TCP</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹deployment</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹deployment</span></span><br><span class="line">kubectl get deployment</span><br><span class="line"><span class="comment"># æŸ¥çœ‹podè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">kubectl get pods -n dev -o wide --show-labels</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_821d88f11ed23a952dae411a39c3790a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_821d88f11ed23a952dae411a39c3790a.png"></p><p><strong>å‚æ•°ï¼š</strong></p><ul><li><strong>â€“port: 80  ç¨‹åºå†…éƒ¨ç«¯å£</strong></li><li><strong>â€“target-port:80  éœ€è¦æš´éœ²çš„ç«¯å£å³80è½¬å‘åˆ°80</strong></li><li><strong>deploy nginx :  deploymentåç§°æ˜¯nginx</strong></li><li><strong>â€“name=svc-nginx1:  æ­¤ä¸ºpodåç§°</strong></li></ul><p><strong>è¿”å›:</strong></p><ul><li><strong>ClusterIP:10.108.11.19   ä¸ºé›†ç¾¤IP  åªæœ‰é›†ç¾¤å†…éƒ¨æ‰å¯ä»¥è®¿é—®</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºé›†ç¾¤å†…éƒ¨å¯ä»¥è®¿é—®çš„service</span></span><br><span class="line">kubectl expose deploy nginx --name=svc-nginx1  --<span class="built_in">type</span>=ClusterIP --port=80 --target-port=80 -n dev</span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">kubectl get svc -n dev -o wide</span><br><span class="line">curl 10.108.11.19</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_8ebae5ea44fcdb5fb5b65604aa82a768.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_8ebae5ea44fcdb5fb5b65604aa82a768.png"></p><p>**æ­¤æ—¶æˆ‘ä»¬è®¿é—®å°±ä¸è®¿é—®podIPäº†æˆ‘ä»¬è®¿é—®serviceçš„ipåŠ ç«¯å£  æ­¤æ—¶å…¶å®æ˜¯åšäº†ä¸€ä¸ªè´Ÿè½½å‡è¡¡ä»–ä¼šéšæœºè½¬å‘åˆ°ä¸€ä¸ªpodå»æä¾›æœåŠ¡ **</p><h3 id="2ã€å®ç°é›†ç¾¤å¤–éƒ¨è®¿é—®"><a href="#2ã€å®ç°é›†ç¾¤å¤–éƒ¨è®¿é—®" class="headerlink" title="2ã€å®ç°é›†ç¾¤å¤–éƒ¨è®¿é—®"></a>2ã€å®ç°é›†ç¾¤å¤–éƒ¨è®¿é—®</h3><ul><li><strong>ä¸Šé¢åˆ›å»ºçš„Serviceçš„typeç±»å‹ä¸ºClusterIPï¼Œè¿™ä¸ªipåœ°å€åªç”¨é›†ç¾¤å†…éƒ¨å¯è®¿é—®</strong></li><li><strong>å¦‚æœéœ€è¦åˆ›å»ºå¤–éƒ¨ä¹Ÿå¯ä»¥è®¿é—®çš„Serviceï¼Œéœ€è¦ä¿®æ”¹typeä¸ºNodePort</strong></li><li><strong>â€“name=svc-nginx2  ns devä¸‹deployment podæ§åˆ¶å™¨nginxä¼šå†åˆ›å»ºä¸€ä¸ªpodåç§°ä¸ºsvc-nginx2çš„å®¹å™¨</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é›†ç¾¤å¤–éƒ¨è®¿é—®</span></span><br><span class="line">kubectl expose deploy nginx --name=svc-nginx2  --<span class="built_in">type</span>=NodePort --port=80 --target-port=80 -n dev</span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">kubectl get svc -n dev --show-labels -o wide</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_5ab57120fd8c0a8abb13b2e210b5033b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_5ab57120fd8c0a8abb13b2e210b5033b.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_57002295d9abf70b483e20dedcb2e54f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_57002295d9abf70b483e20dedcb2e54f.png"></p><h3 id="3ã€åˆ é™¤service"><a href="#3ã€åˆ é™¤service" class="headerlink" title="3ã€åˆ é™¤service"></a>3ã€åˆ é™¤service</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤service</span></span><br><span class="line">kubectl delete svc svc-nginx2 -n dev</span><br></pre></td></tr></table></figure><h3 id="4ã€é…ç½®æ–¹å¼"><a href="#4ã€é…ç½®æ–¹å¼" class="headerlink" title="4ã€é…ç½®æ–¹å¼"></a>4ã€é…ç½®æ–¹å¼</h3><p><strong>åˆ›å»ºä¸€ä¸ªsvc-nginx.yamlï¼Œå†…å®¹å¦‚ä¸‹ï¼š</strong></p><p><strong>éœ€è¦ä¿®æ”¹typeä¸º</strong>NodePort <strong>ï¼ˆä¿®æ”¹typeç±»å‹ä¸ºNodePortå³å¯å®ç°å¤–éƒ¨è®¿é—®ï¼‰</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">svc-nginx</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">clusterIP:</span> <span class="number">10.109</span><span class="number">.179</span><span class="number">.231</span> <span class="comment">#å›ºå®šsvcçš„å†…ç½‘ip</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">    <span class="attr">targetPort:</span> <span class="number">80</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">ClusterIP</span></span><br></pre></td></tr></table></figure><p><strong>ç„¶åå°±å¯ä»¥æ‰§è¡Œå¯¹åº”çš„åˆ›å»ºå’Œåˆ é™¤å‘½ä»¤äº†ï¼š</strong></p><p><strong>åˆ›å»ºï¼škubectl create -f svc-nginx.yaml</strong></p><p><strong>åˆ é™¤ï¼škubectl delete -f svc-nginx.yaml</strong></p><p><strong>å°ç»“</strong></p><p><strong>è‡³æ­¤ï¼Œå·²ç»æŒæ¡äº†Namespaceã€Podã€Deploymentã€Serviceèµ„æºçš„åŸºæœ¬æ“ä½œï¼Œæœ‰äº†è¿™äº›æ“ä½œï¼Œå°±å¯ä»¥åœ¨kubernetesé›†ç¾¤ä¸­å®ç°ä¸€ä¸ªæœåŠ¡çš„ç®€å•éƒ¨ç½²å’Œè®¿é—®äº†ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦æ›´å¥½çš„ä½¿ç”¨kubernetesï¼Œå°±éœ€è¦æ·±å…¥å­¦ä¹ è¿™å‡ ç§èµ„æºçš„ç»†èŠ‚å’ŒåŸç†ã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>5ã€k8s-deploymentå¢åˆ æ”¹æŸ¥ï¼ˆpodæ§åˆ¶å™¨ï¼‰</title>
      <link href="/2024/10/27/5%E3%80%81deployment%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%EF%BC%88pod%E6%8E%A7%E5%88%B6%E5%99%A8%EF%BC%89/"/>
      <url>/2024/10/27/5%E3%80%81deployment%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%EF%BC%88pod%E6%8E%A7%E5%88%B6%E5%99%A8%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="5ã€k8s-deploymentå¢åˆ æ”¹æŸ¥ï¼ˆpodæ§åˆ¶å™¨ï¼‰"><a href="#5ã€k8s-deploymentå¢åˆ æ”¹æŸ¥ï¼ˆpodæ§åˆ¶å™¨ï¼‰" class="headerlink" title="5ã€k8s-deploymentå¢åˆ æ”¹æŸ¥ï¼ˆpodæ§åˆ¶å™¨ï¼‰"></a>5ã€k8s-deploymentå¢åˆ æ”¹æŸ¥ï¼ˆpodæ§åˆ¶å™¨ï¼‰</h2><h2 id="4-4-Deployment"><a href="#4-4-Deployment" class="headerlink" title="4.4 Deployment"></a>4.4 Deployment</h2><p>åœ¨kubernetesä¸­ï¼ŒPodæ˜¯æœ€å°çš„æ§åˆ¶å•å…ƒï¼Œä½†æ˜¯kuberneteså¾ˆå°‘ç›´æ¥æ§åˆ¶Podï¼Œä¸€èˆ¬éƒ½æ˜¯é€šè¿‡Podæ§åˆ¶å™¨æ¥å®Œæˆçš„ã€‚Podæ§åˆ¶å™¨ç”¨äºpodçš„ç®¡ç†ï¼Œç¡®ä¿podèµ„æºç¬¦åˆé¢„æœŸçš„çŠ¶æ€ï¼Œå½“podçš„èµ„æºå‡ºç°æ•…éšœæ—¶ï¼Œ**ä¼šå°è¯•è¿›è¡Œé‡å¯æˆ–é‡å»ºpodã€‚</p><p><strong>åœ¨kubernetesä¸­Podæ§åˆ¶å™¨çš„ç§ç±»æœ‰å¾ˆå¤šï¼Œæœ¬ç« èŠ‚åªä»‹ç»ä¸€ç§ï¼šDeploymentã€‚</strong></p><p>å¦‚æˆ‘åˆ›å»ºå®¹å™¨æ—¶å‘Šè¯‰podæ§åˆ¶å™¨æˆ‘éœ€è¦3ä¸ªåº”ç”¨ç¨‹åº è¿™æ—¶å€™podæ§åˆ¶å™¨ å°±ä¼šåˆ›å»ºå‡ºä¸‰ä¸ªæ¥ å¦‚æœä¸€ä¸ªå‡ºç°æ•…éšœ podæ§åˆ¶å™¨å°±ä¼šå°è¯•é‡å¯ é‡å¯å¤±è´¥å°±ä¼šé”€æ¯é‡å»º æ€»ä¹‹ç¡®ä¿ä¸€ç›´æœ‰3ä¸ªè¿è¡Œã€‚</p><p><strong>è¦æƒ³åˆ é™¤å¿…é¡»åˆ æ‰podæ§åˆ¶å™¨</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_84b19db3db82366663125705661cd6dc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_84b19db3db82366663125705661cd6dc.png"></p><h2 id="ä¸€-å‘½ä»¤æ“ä½œ"><a href="#ä¸€-å‘½ä»¤æ“ä½œ" class="headerlink" title="ä¸€. å‘½ä»¤æ“ä½œ"></a>ä¸€. å‘½ä»¤æ“ä½œ</h2><h3 id="1-åˆ›å»º2å‰¯æœ¬pod"><a href="#1-åˆ›å»º2å‰¯æœ¬pod" class="headerlink" title="1.åˆ›å»º2å‰¯æœ¬pod"></a>1.åˆ›å»º2å‰¯æœ¬pod</h3><p><strong>å‚æ•°è¯´æ˜ï¼š</strong></p><ul><li><strong>â€“image æŒ‡å®špodçš„é•œåƒ</strong></li><li><strong>â€“port             æŒ‡å®šç«¯å£</strong></li><li><strong>â€“replicas       æŒ‡å®špodçš„æ•°é‡</strong></li><li><strong>â€“namespace æŒ‡å®šns ï¼ˆéœ€è¦å¤šèŠ‚ç‚¹æ‰èƒ½æˆåŠŸè¿è¡Œï¼‰</strong></li></ul><p><strong>æœ¬èº«</strong>deploymentæ˜¯æœ‰æ ‡ç­¾é€‰æ‹©å™¨çš„ ä»–å°±ä¼šé€‰ä¸­ç›¸åŒæ ‡ç­¾çš„podè¿›è€Œç®¡ç†pod</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ºäº†ä¸å½±å“æ¥ä¸‹æ¥çš„æ“ä½œæˆ‘ä»¬åˆ é™¤ns dev è¿™æ ·devä¸‹é¢çš„podéƒ½ä¼šè¢«åˆ é™¤</span></span><br><span class="line">kubectl delete ns dev</span><br><span class="line"><span class="comment"># éªŒè¯æ˜¯å¦åˆ é™¤æˆåŠŸ</span></span><br><span class="line">kubectl get deployment,pod -n dev</span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªèµ„æºç”¨äºæµ‹è¯•ï¼ˆå‘½ä»¤è¡Œæ–¹å¼ï¼‰</span></span><br><span class="line">kubectl create ns dev</span><br><span class="line">kubectl run nginx-pod --image=registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest --port=80 --replicas=3 -n dev</span><br></pre></td></tr></table></figure><p><strong>æ‰©å±•æ‰‹åŠ¨ç»™nginx-podæ‰“ä¸Šæ ‡ç­¾</strong></p><p><strong>kubectl label pod nginx-pod version=2.0 -n dev â€“overwrite</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_e138646456edcc13cc512eef8b032bb5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_e138646456edcc13cc512eef8b032bb5.png"></p><p><strong>æ­¤æ—¶å¯ä»¥çœ‹åˆ°æ ‡ç­¾é€‰æ‹©å™¨é€‰æ‹©çš„æ ‡ç­¾åŒ–ä¸æˆ‘ä»¬æŸ¥çœ‹çš„æ ‡ç­¾ä¸€è‡´</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_799b6282dd3639776922530e3d941c19.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_799b6282dd3639776922530e3d941c19.png"></p><h3 id="2-åˆ é™¤podæ§åˆ¶å™¨deploymentï¼ˆç›´æ¥åˆ é™¤podä¼šé‡å»º-åˆ é™¤podæ§åˆ¶å™¨å³åˆ é™¤å®Œæˆï¼‰"><a href="#2-åˆ é™¤podæ§åˆ¶å™¨deploymentï¼ˆç›´æ¥åˆ é™¤podä¼šé‡å»º-åˆ é™¤podæ§åˆ¶å™¨å³åˆ é™¤å®Œæˆï¼‰" class="headerlink" title="2.åˆ é™¤podæ§åˆ¶å™¨deploymentï¼ˆç›´æ¥åˆ é™¤podä¼šé‡å»º åˆ é™¤podæ§åˆ¶å™¨å³åˆ é™¤å®Œæˆï¼‰"></a>2.åˆ é™¤podæ§åˆ¶å™¨deploymentï¼ˆç›´æ¥åˆ é™¤podä¼šé‡å»º åˆ é™¤podæ§åˆ¶å™¨å³åˆ é™¤å®Œæˆï¼‰</h3><p><strong>æ²¡æœ‰podæ§åˆ¶å™¨çš„ç›´æ¥å°±åˆ é™¤å®Œæˆäº†</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤nginx-podã€podçš„podæ§åˆ¶å™¨</span></span><br><span class="line">kubectl delete deploy nginx-pod -n dev</span><br><span class="line"><span class="comment"># éªŒè¯ï¼ˆæ­¤æ—¶ä¾¿æ²¡æœ‰äº†ï¼‰</span></span><br><span class="line">kubectl get pods -n dev</span><br></pre></td></tr></table></figure><h2 id="äºŒ-ä½¿ç”¨é…ç½®æ–‡ä»¶æ–¹å¼å®šä¹‰deploymentï¼ˆpodæ§åˆ¶å™¨ï¼‰"><a href="#äºŒ-ä½¿ç”¨é…ç½®æ–‡ä»¶æ–¹å¼å®šä¹‰deploymentï¼ˆpodæ§åˆ¶å™¨ï¼‰" class="headerlink" title="äºŒ. ä½¿ç”¨é…ç½®æ–‡ä»¶æ–¹å¼å®šä¹‰deploymentï¼ˆpodæ§åˆ¶å™¨ï¼‰"></a>äºŒ. ä½¿ç”¨é…ç½®æ–‡ä»¶æ–¹å¼å®šä¹‰deploymentï¼ˆpodæ§åˆ¶å™¨ï¼‰</h2><p><strong>nginx-pod.yml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span>  <span class="comment"># ç‰ˆæœ¬</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Deployment</span>     <span class="comment"># ç±»å‹</span></span><br><span class="line"><span class="attr">metadata:</span>            <span class="comment"># æºæ•°æ®</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">svc-nginx</span>    <span class="comment"># å½“å‰deploymentæ‰€å±çš„åå­—</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span>     <span class="comment"># åŠns  </span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">3</span>        <span class="comment"># å®šä¹‰å‰¯æœ¬æ•°</span></span><br><span class="line">  <span class="attr">selector:</span>          <span class="comment"># æ ‡ç­¾é€‰æ‹©å™¨</span></span><br><span class="line">    <span class="attr">matchLabels:</span>     <span class="comment"># é€‰æ‹©nginxæ ‡ç­¾</span></span><br><span class="line">      <span class="attr">run:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">template:</span>          <span class="comment"># ä»¥ä¸‹ä¸ºpod æ¨¡æ¿</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span>        <span class="comment"># æ ‡ç­¾</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">nginx</span>   <span class="comment"># å®šä¹‰æ ‡ç­¾ä¸ºnginx</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:latest</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx-pod</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">          <span class="attr">protocol:</span> <span class="string">TCP</span></span><br></pre></td></tr></table></figure><p><strong>ç„¶åå°±å¯ä»¥æ‰§è¡Œå¯¹åº”çš„åˆ›å»ºå’Œåˆ é™¤å‘½ä»¤äº†ï¼š</strong></p><p><strong>åˆ›å»ºï¼škubectl create -f deploy-nginx.yaml</strong></p><p><strong>åˆ é™¤ï¼škubectl delete -f deploy-nginx.yaml</strong></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>4ã€k8sæ ‡ç­¾ç®¡ç†label</title>
      <link href="/2024/10/24/4%E3%80%81k8s%E6%A0%87%E7%AD%BE%E7%AE%A1%E7%90%86label/"/>
      <url>/2024/10/24/4%E3%80%81k8s%E6%A0%87%E7%AD%BE%E7%AE%A1%E7%90%86label/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="4ã€k8sæ ‡ç­¾ç®¡ç†label"><a href="#4ã€k8sæ ‡ç­¾ç®¡ç†label" class="headerlink" title="4ã€k8sæ ‡ç­¾ç®¡ç†label"></a>4ã€k8sæ ‡ç­¾ç®¡ç†label</h2><h3 id="4-3-Label"><a href="#4-3-Label" class="headerlink" title="4.3 Label"></a>4.3 Label</h3><p><strong>Labelæ˜¯kubernetesç³»ç»Ÿä¸­çš„ä¸€ä¸ªé‡è¦æ¦‚å¿µã€‚å®ƒçš„ä½œç”¨å°±æ˜¯åœ¨èµ„æºä¸Šæ·»åŠ æ ‡è¯†ï¼Œç”¨æ¥å¯¹å®ƒä»¬è¿›è¡ŒåŒºåˆ†å’Œé€‰æ‹©ã€‚</strong></p><p><strong>Labelçš„ç‰¹ç‚¹ï¼š</strong></p><ul><li><strong>ä¸€ä¸ªLabelä¼šä»¥key/valueé”®å€¼å¯¹çš„å½¢å¼é™„åŠ åˆ°å„ç§å¯¹è±¡ä¸Šï¼Œå¦‚Nodeã€Podã€Serviceç­‰ç­‰</strong></li><li><strong>ä¸€ä¸ªèµ„æºå¯¹è±¡å¯ä»¥å®šä¹‰ä»»æ„æ•°é‡çš„Label ï¼ŒåŒä¸€ä¸ªLabelä¹Ÿå¯ä»¥è¢«æ·»åŠ åˆ°ä»»æ„æ•°é‡çš„èµ„æºå¯¹è±¡ä¸Šå»</strong></li><li><strong>Labelé€šå¸¸åœ¨</strong>èµ„æºå¯¹è±¡å®šä¹‰æ—¶ç¡®å®š<strong>ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥åœ¨å¯¹è±¡åˆ›å»ºå</strong>åŠ¨æ€æ·»åŠ æˆ–è€…åˆ é™¤</li></ul><p><strong>å¯ä»¥é€šè¿‡Labelå®ç°èµ„æºçš„å¤šç»´åº¦åˆ†ç»„ï¼Œä»¥ä¾¿çµæ´»ã€æ–¹ä¾¿åœ°è¿›è¡Œèµ„æºåˆ†é…ã€è°ƒåº¦ã€é…ç½®ã€éƒ¨ç½²ç­‰ç®¡ç†å·¥ä½œã€‚</strong></p><p><strong>ä¸€äº›å¸¸ç”¨çš„Label ç¤ºä¾‹å¦‚ä¸‹ï¼ˆæ²¡æœ‰å®šä¹‰éšä¾¿å®šä¹‰ï¼‰ï¼š</strong></p><ul><li><strong>ç‰ˆæœ¬æ ‡ç­¾ï¼šâ€versionâ€:â€releaseâ€, â€œversionâ€:â€stableâ€â€¦â€¦</strong></li><li><strong>ç¯å¢ƒæ ‡ç­¾ï¼šâ€environmentâ€:â€devâ€ï¼Œâ€environmentâ€:â€testâ€ï¼Œâ€environmentâ€:â€proâ€</strong></li><li><strong>æ¶æ„æ ‡ç­¾ï¼šâ€tierâ€:â€frontendâ€ï¼Œâ€tierâ€:â€backendâ€</strong></li></ul><p><strong>æ ‡ç­¾å®šä¹‰å®Œæ¯•ä¹‹åï¼Œè¿˜è¦è€ƒè™‘åˆ°æ ‡ç­¾çš„é€‰æ‹©ï¼Œè¿™å°±è¦ä½¿ç”¨åˆ°</strong>Label Selector<strong>ï¼Œå³ï¼š</strong></p><p><strong>Label</strong>ç”¨äºç»™æŸä¸ªèµ„æºå¯¹è±¡å®šä¹‰æ ‡è¯†</p><p><strong>Label Selector</strong>ç”¨äºæŸ¥è¯¢å’Œç­›é€‰æ‹¥æœ‰æŸäº›æ ‡ç­¾çš„èµ„æºå¯¹è±¡</p><p><strong>lableä¸namespaceç±»ä¼¼ä½†æ˜¯ä¸åŒçš„nsä¹‹é—´æ— æ³•é€šä¿¡æ­¤æ—¶å¼•å…¥lable å³åŒä¸€ä¸ªnsä¸‹é¢çš„podä½¿ç”¨ä¸åŒçš„æ ‡è¯†</strong></p><p><strong>è¿™æ ·å³è§£å†³ä¸åŒnsä¸‹podæ— æ³•ç›¸äº’é€šä¿¡é—®é¢˜</strong></p><p><strong>å½“å‰æœ‰ä¸¤ç§</strong>Label Selector<strong>ï¼š</strong></p><ul><li><strong>åŸºäº</strong>ç­‰å¼<strong>çš„Label Selector</strong></li></ul><p><strong>name = slave: é€‰æ‹©æ‰€æœ‰åŒ…å«Labelä¸­key=â€nameâ€ä¸”value=â€slaveâ€çš„å¯¹è±¡</strong></p><p><strong>env != production: é€‰æ‹©æ‰€æœ‰åŒ…æ‹¬Labelä¸­çš„key=â€envâ€ä¸”valueä¸ç­‰äºâ€productionâ€çš„å¯¹è±¡</strong></p><ul><li><strong>åŸºäº</strong>é›†åˆ<strong>çš„Label Selector</strong></li></ul><p><strong>name in (master, slave): é€‰æ‹©æ‰€æœ‰åŒ…å«Labelä¸­çš„key=â€nameâ€ä¸”value=â€masterâ€æˆ–â€slaveâ€çš„å¯¹è±¡</strong></p><p><strong>name not in (frontend): é€‰æ‹©æ‰€æœ‰åŒ…å«Labelä¸­çš„key=â€nameâ€ä¸”valueä¸ç­‰äºâ€frontendâ€çš„å¯¹è±¡</strong></p><p><strong>æ ‡ç­¾çš„é€‰æ‹©æ¡ä»¶å¯ä»¥ä½¿ç”¨å¤šä¸ªï¼Œæ­¤æ—¶å°†å¤šä¸ªLabel Selectorè¿›è¡Œç»„åˆï¼Œä½¿ç”¨é€—å·â€,â€è¿›è¡Œåˆ†éš”å³å¯ã€‚ä¾‹å¦‚ï¼š</strong></p><p><strong>name=slaveï¼Œenv!=production</strong></p><p><strong>name not in (frontend)ï¼Œenv!=production</strong></p><h3 id="4-4-æ ‡ç­¾çš„ä½¿ç”¨"><a href="#4-4-æ ‡ç­¾çš„ä½¿ç”¨" class="headerlink" title="4.4 æ ‡ç­¾çš„ä½¿ç”¨"></a>4.4 æ ‡ç­¾çš„ä½¿ç”¨</h3><h4 id="4-4-1-å‘½ä»¤è¡Œæ–¹å¼æ ‡ç­¾æ·»åŠ "><a href="#4-4-1-å‘½ä»¤è¡Œæ–¹å¼æ ‡ç­¾æ·»åŠ " class="headerlink" title="4.4.1 å‘½ä»¤è¡Œæ–¹å¼æ ‡ç­¾æ·»åŠ "></a>4.4.1 å‘½ä»¤è¡Œæ–¹å¼æ ‡ç­¾æ·»åŠ </h4><p><strong>èµ„æºå‡†å¤‡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªèµ„æºç”¨äºæµ‹è¯•ï¼ˆå‘½ä»¤è¡Œæ–¹å¼ï¼‰</span></span><br><span class="line">kubectl create ns dev</span><br><span class="line">kubectl run nginx-pod --image=registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest  -n dev</span><br></pre></td></tr></table></figure><p><strong>nginx-pod.yml</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx-pod</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">pod</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span></span><br></pre></td></tr></table></figure><p><strong>æ–‡ä»¶æ–¹å¼åˆ›å»ºï¼škubectl create -f  nginx-pod.yml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ºpodèµ„æºæ‰“ä¸Šæ ‡ç­¾</span></span><br><span class="line">kubectl label pod nginx-pod version=1.0 -n dev</span><br><span class="line">kubectl label pod nginx-pod tier=back -n dev</span><br><span class="line"><span class="comment"># ç°è±¡ï¼ˆæ­¤æ—¶ä½¿ç”¨ä¸‹æ–¹å‘½ä»¤æŸ¥çœ‹devä¸‹çš„nginx-podæ˜¯æ²¡æœ‰æ ‡ç­¾çš„ï¼‰</span></span><br><span class="line">kubectl get pod -n dev</span><br><span class="line">kubectl get pod -n dev --show-labels</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_d6e9c5ddf0433632f6a86e72570436bd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_d6e9c5ddf0433632f6a86e72570436bd.png"></p><h4 id="4-4-2-æ ‡ç­¾æ›´æ–°ï¼ˆå‚æ•°â€“overwriteï¼‰"><a href="#4-4-2-æ ‡ç­¾æ›´æ–°ï¼ˆå‚æ•°â€“overwriteï¼‰" class="headerlink" title="4.4.2 æ ‡ç­¾æ›´æ–°ï¼ˆå‚æ•°â€“overwriteï¼‰"></a>4.4.2 æ ‡ç­¾æ›´æ–°ï¼ˆå‚æ•°â€“overwriteï¼‰</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ‡ç­¾æ›´æ–°</span></span><br><span class="line">kubectl label pod nginx-pod version=2.0 -n dev --overwrite</span><br></pre></td></tr></table></figure><h4 id="4-4-3-ç­›é€‰æ ‡ç­¾ï¼ˆ-lï¼‰"><a href="#4-4-3-ç­›é€‰æ ‡ç­¾ï¼ˆ-lï¼‰" class="headerlink" title="4.4.3 ç­›é€‰æ ‡ç­¾ï¼ˆ-lï¼‰"></a>4.4.3 ç­›é€‰æ ‡ç­¾ï¼ˆ-lï¼‰</h4><p><strong>ä¿®æ”¹nginxé…ç½®å†æ¬¡åˆ›å»ºä¸€ä¸ªnginx-sx</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç»™nginx-sxæ‰“ä¸Šæ ‡ç­¾</span></span><br><span class="line">kubectl label pod nginx-sx version=1.0 -n dev --overwrite</span><br><span class="line"><span class="comment"># åªç­›é€‰å‡ºæ ‡ç­¾æ˜¯version=2.0çš„pod</span></span><br><span class="line">kubectl get pods -l <span class="string">&quot;version=2.0&quot;</span> -n dev --show-labels</span><br><span class="line">kubectl get pods -l <span class="string">&quot;version!=2.0&quot;</span> -n dev --show-labels</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_584efb8d5805177e68470ea32cf4474c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_584efb8d5805177e68470ea32cf4474c.png"></p><h4 id="4-4-4-åˆ é™¤æ ‡ç­¾"><a href="#4-4-4-åˆ é™¤æ ‡ç­¾" class="headerlink" title="4.4.4 åˆ é™¤æ ‡ç­¾"></a>4.4.4 åˆ é™¤æ ‡ç­¾</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤æ ‡ç­¾</span></span><br><span class="line">kubectl label pod nginx-pod  -n dev tier-</span><br></pre></td></tr></table></figure><h4 id="4-4-5-é…ç½®æ–¹å¼æ ‡ç­¾ç®¡ç†"><a href="#4-4-5-é…ç½®æ–¹å¼æ ‡ç­¾ç®¡ç†" class="headerlink" title="4.4.5 é…ç½®æ–¹å¼æ ‡ç­¾ç®¡ç†"></a>4.4.5 é…ç½®æ–¹å¼æ ‡ç­¾ç®¡ç†</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Pod</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">labels:</span></span><br><span class="line">    <span class="attr">version:</span> <span class="string">&quot;3.0&quot;</span> </span><br><span class="line">    <span class="attr">env:</span> <span class="string">&quot;test&quot;</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">containers:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">image:</span> <span class="string">nginx:latest</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">pod</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nginx-port</span></span><br><span class="line">      <span class="attr">containerPort:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">protocol:</span> <span class="string">TCP</span></span><br></pre></td></tr></table></figure><p><strong>ç„¶åå°±å¯ä»¥æ‰§è¡Œå¯¹åº”çš„æ›´æ–°å‘½ä»¤äº†ï¼škubectl apply -f pod-nginx.yaml</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_2eed665f8fca199832832b35738bb722.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_2eed665f8fca199832832b35738bb722.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SDæ–‡ç”Ÿå›¾æ•™ç¨‹</title>
      <link href="/2024/10/22/SD%E6%96%87%E7%94%9F%E5%9B%BE%E6%95%99%E7%A8%8B/"/>
      <url>/2024/10/22/SD%E6%96%87%E7%94%9F%E5%9B%BE%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="SDæ–‡ç”Ÿå›¾æ•™ç¨‹"><a href="#SDæ–‡ç”Ÿå›¾æ•™ç¨‹" class="headerlink" title="SDæ–‡ç”Ÿå›¾æ•™ç¨‹"></a>SDæ–‡ç”Ÿå›¾æ•™ç¨‹</h2><p><a href="https://sunlight.zznnwn.cloudns.biz/2024/08/02/ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83%E5%8F%8A%E5%A4%9A%E6%A8%A1%E6%80%81%E5%9B%BE%E7%89%87%E5%88%86%E6%9E%90%E6%96%87%E7%94%9F%E5%9B%BE/?highlight=%E6%96%87%E7%94%9F%E5%9B%BE">æ—§ç‰ˆæœ¬ç›´é€š</a></p><p><strong>ä½¿ç”¨å‚è€ƒï¼š</strong></p><p><a href="https://blog.csdn.net/Jack__Lau__/article/details/135140056">https://blog.csdn.net/Jack__Lau__/article/details/135140056</a></p><h3 id="ä¸€-æ’ä»¶"><a href="#ä¸€-æ’ä»¶" class="headerlink" title="ä¸€. æ’ä»¶"></a>ä¸€. æ’ä»¶</h3><p><strong>æ’ä»¶åœ°å€ï¼š</strong></p><p><strong>Civitaiï¼š</strong></p><p><a href="https://github.com/butaixianran/Stable-Diffusion-Webui-Civitai-Helper">https://github.com/butaixianran/Stable-Diffusion-Webui-Civitai-Helper</a></p><p><a href="https://gitee.com/aiovia/Stable-Diffusion-Webui-Civitai-Helper">https://gitee.com/aiovia/Stable-Diffusion-Webui-Civitai-Helper</a></p><p><strong>ä¸­æ–‡æ’ä»¶ï¼š</strong></p><p><a href="https://gitee.com/cloneai/sd-webui-bilingual-localization.git">https://gitee.com/cloneai/sd-webui-bilingual-localization.git</a></p><p><a href="https://gitee.com/stable_diffusion/stable-diffusion-webui-localization-zh_CN">https://gitee.com/stable_diffusion/stable-diffusion-webui-localization-zh_CN</a></p><p><strong>æ–°å¢å…¶ä»–æ¨¡å‹ï¼š</strong></p><p><a href="https://zhuanlan.zhihu.com/p/641027156">https://zhuanlan.zhihu.com/p/641027156</a></p><p><strong>æ¨¡å‹ä¸‹è½½åœ°å€ï¼š</strong></p><p><a href="https://huggingface.co/">https://huggingface.co/</a></p><p><a href="https://civitai.com/">https://civitai.com/</a></p><p>Cç«™ï¼š</p><p><a href="https://civitai.com/images">https://civitai.com/images</a><br>promptheroï¼š</p><p><a href="https://prompthero.com/">https://prompthero.com/</a><br>Majinaiï¼š</p><p><a href="https://majinai.art/index.php">https://majinai.art/index.php</a><br>è¯å›¾ï¼š</p><p><a href="https://www.prompttool.com/NovelAI">https://www.prompttool.com/NovelAI</a><br>Black Lilyï¼š</p><p><a href="http://heizicao.gitee.io/novelai/#/book">http://heizicao.gitee.io/novelai/#/book</a><br>Danbooru æ ‡ç­¾è¶…å¸‚ï¼š</p><p><a href="https://tags.novelai.dev/">https://tags.novelai.dev/</a><br>AI è¯æ±‡åŠ é€Ÿå™¨ï¼š</p><p><a href="https://ai.dawnmark.cn/">https://ai.dawnmark.cn/</a><br>NovelAI é­”å¯¼ä¹¦ï¼š</p><p><a href="https://thereisnospon.github.io/NovelAiTag/">https://thereisnospon.github.io/NovelAiTag/</a></p><h2 id="äºŒ-éƒ¨ç½²"><a href="#äºŒ-éƒ¨ç½²" class="headerlink" title="äºŒ. éƒ¨ç½²"></a>äºŒ. éƒ¨ç½²</h2><p>è¯´æ˜ï¼š</p><p>å¤–ç½‘è®¿é—®æ¨¡å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥modulesç›®å½•</span></span><br><span class="line"><span class="built_in">cd</span> modules</span><br><span class="line"><span class="comment"># ç¼–è¾‘å‚æ•°</span></span><br><span class="line">vim /dockerx/stable-diffusion-webui/modules/cmd_args.py</span><br><span class="line"><span class="comment"># ä¿®æ”¹ä»¥ä¸‹ä¸¤è¡Œ</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">parser.add_argument(<span class="string">&quot;--listen&quot;</span>, action=<span class="string">&#x27;store_true&#x27;</span>,default=True, <span class="built_in">help</span>=<span class="string">&quot;launch gradio with 0.0.0.0 as server name, allowing to respond to network requests&quot;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&quot;--port&quot;</span>, <span class="built_in">type</span>=int, <span class="built_in">help</span>=<span class="string">&quot;launch gradio with given server port, you need root/admin rights for ports &lt; 1024, defaults to 7860 if available&quot;</span>, default=7860)</span><br></pre></td></tr></table></figure><p>ä¸åŒæ¨¡å‹å­˜æ”¾ä½ç½®</p><p>æ¨¡å‹æ–‡ä»¶(safetensors,checkpoint)æ·»åŠ åˆ°ä»¥ä¸‹ç›®å½•</p><p><code>/dockerx/stable-diffusion-webui/models/Stable-diffusion/</code><br>Loraæ–‡ä»¶æ·»åŠ åˆ°ä»¥ä¸‹ç›®å½•</p><p><code>/dockerx/stable-diffusion-webui/models/Lora/</code><br>VAEæ–‡ä»¶æ·»åŠ åˆ°ä»¥ä¸‹ç›®å½•</p><p><code>/dockerx/stable-diffusion-webui/models/VAE/</code></p><p>ä½¿ç”¨<code>docker-compose</code>æ–¹å¼ï¼ˆéƒ¨ç½²å®Œæˆåéœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ æ‰èƒ½æµè§ˆå™¨è®¿é—®7860ç«¯å£ä½¿ç”¨ï¼‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span>  <span class="comment"># æˆ–è€…ä½¿ç”¨é€‚åˆæ‚¨éœ€æ±‚çš„ç‰ˆæœ¬</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">stable-diffusion:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">gpulab.tencentcloudcr.com/ai/stable-diffusion:1.0.7</span> <span class="comment">#gpulab.tencentcloudcr.com/ai/stable-diffusion:1.0.8</span></span><br><span class="line">    <span class="comment"># registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:stable-diffusion-1.0.7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">stable-diffusion</span></span><br><span class="line">    <span class="attr">runtime:</span> <span class="string">nvidia</span>  <span class="comment"># ç¡®ä¿ä½¿ç”¨ NVIDIA è¿è¡Œæ—¶</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">reservations:</span></span><br><span class="line">          <span class="attr">devices:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">capabilities:</span> [<span class="string">gpu</span>]  <span class="comment"># é¢„ç•™ GPU èµ„æº</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">host</span>  <span class="comment"># ä½¿ç”¨ä¸»æœºç½‘ç»œ</span></span><br><span class="line">    <span class="attr">devices:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/dev/dri:/dev/dri</span>  <span class="comment"># å…è®¸è®¿é—®è®¾å¤‡</span></span><br><span class="line">    <span class="attr">group_add:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">video</span>  <span class="comment"># å°†å®¹å™¨åŠ å…¥è§†é¢‘ç»„</span></span><br><span class="line">    <span class="attr">ipc:</span> <span class="string">host</span>  <span class="comment"># ä½¿ç”¨ä¸»æœº IPC</span></span><br><span class="line">    <span class="attr">cap_add:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SYS_PTRACE</span>  <span class="comment"># æ·»åŠ  SYS_PTRACE æƒé™</span></span><br><span class="line">    <span class="attr">security_opt:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">seccomp=unconfined</span>  <span class="comment"># ç¦ç”¨ seccomp é™åˆ¶</span></span><br><span class="line">    <span class="attr">stdin_open:</span> <span class="literal">true</span>  <span class="comment"># ä¿æŒæ ‡å‡†è¾“å…¥æ‰“å¼€</span></span><br><span class="line">    <span class="comment">#tty: true  # åˆ†é…ä¸€ä¸ªä¼ªç»ˆç«¯</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./cmd_args.py:/dockerx/stable-diffusion-webui/modules/cmd_args.py</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./ponyRealism_v22MainVAE.safetensors:/dockerx/stable-diffusion-webui/models/VAE/ponyRealism_v22MainVAE.safetensors</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./3Guofeng3_v34.safetensors:/dockerx/stable-diffusion-webui/models/Stable-diffusion/å›½é£/3Guofeng3_v34.safetensors</span>  </span><br><span class="line">      <span class="bullet">-</span> <span class="string">./vae-ft-mse-840000-ema-pruned.ckpt:/dockerx/stable-diffusion-webui/models/VAE/vae-ft-mse-840000-ema-pruned.ckpt</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./face.ckpt:/dockerx/stable-diffusion-webui/models/Stable-diffusion/çœŸå®/face.ckpt</span>  </span><br><span class="line">      <span class="bullet">-</span> <span class="string">./Nahida.safetensors:/dockerx/stable-diffusion-webui/models/Stable-diffusion/ç°å®ä¸åŠ¨æ¼«/Nahida.safetensors</span>  </span><br><span class="line">      <span class="comment">#- ./1990s_Anime_Style.safetensors:/dockerx/stable-diffusion-webui/models/Stable-diffusion/90å¹´ä»£æ—¥æœ¬åŠ¨æ¼«é£æ ¼/1990s_Anime_Style.safetensors</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./sd1.5_Outline_Color_1.0.safetensors:/dockerx/stable-diffusion-webui/models/Stable-diffusion/åŠ¨æ¼«æ’ç”»é£/sd1.5_Outline_Color_1.0.safetensors</span></span><br></pre></td></tr></table></figure><h2 id="ä¸‰-å‰ç«¯é¡µé¢å¼€å¯ç›¸å…³åŠŸèƒ½"><a href="#ä¸‰-å‰ç«¯é¡µé¢å¼€å¯ç›¸å…³åŠŸèƒ½" class="headerlink" title="ä¸‰. å‰ç«¯é¡µé¢å¼€å¯ç›¸å…³åŠŸèƒ½"></a>ä¸‰. å‰ç«¯é¡µé¢å¼€å¯ç›¸å…³åŠŸèƒ½</h2><h3 id="å¼€å¯vae"><a href="#å¼€å¯vae" class="headerlink" title="å¼€å¯vae"></a>å¼€å¯vae</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_c244f24b53185a9ebe2ed610bfdfdf84.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_c244f24b53185a9ebe2ed610bfdfdf84.png"></p><h3 id="å®‰è£…æ’ä»¶"><a href="#å®‰è£…æ’ä»¶" class="headerlink" title="å®‰è£…æ’ä»¶"></a>å®‰è£…æ’ä»¶</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_42218fd8bef76e3155a5cb676f9a8792.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_42218fd8bef76e3155a5cb676f9a8792.png"></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Kubernetesæ•…éšœç¯‡ï¼šcalico/node is not ready: BIRD is not ready</title>
      <link href="/2024/10/20/Kubernetes%E6%95%85%E9%9A%9C%E7%AF%87%EF%BC%9Acalico/node%20is%20not%20ready:%20BIRD%20is%20not%20ready/"/>
      <url>/2024/10/20/Kubernetes%E6%95%85%E9%9A%9C%E7%AF%87%EF%BC%9Acalico/node%20is%20not%20ready:%20BIRD%20is%20not%20ready/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Kubernetesæ•…éšœç¯‡ï¼šcalico-node-is-not-ready-BIRD-is-not-ready"><a href="#Kubernetesæ•…éšœç¯‡ï¼šcalico-node-is-not-ready-BIRD-is-not-ready" class="headerlink" title="Kubernetesæ•…éšœç¯‡ï¼šcalico/node is not ready: BIRD is not ready"></a><a href="https://www.cnblogs.com/codertl/p/17021964.html" title="å‘å¸ƒäº 2023-01-03 14:04">Kubernetesæ•…éšœç¯‡ï¼šcalico/node is not ready: BIRD is not ready</a></h1><h2 id="ä¸€ã€é—®é¢˜äº§ç”Ÿ"><a href="#ä¸€ã€é—®é¢˜äº§ç”Ÿ" class="headerlink" title="ä¸€ã€é—®é¢˜äº§ç”Ÿ"></a>ä¸€ã€é—®é¢˜äº§ç”Ÿ</h2><h3 id="1-k8sé›†ç¾¤éƒ¨ç½²åå‘ç°calicoçš„podæœªé€šè¿‡å¥åº·æ£€æŸ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š"><a href="#1-k8sé›†ç¾¤éƒ¨ç½²åå‘ç°calicoçš„podæœªé€šè¿‡å¥åº·æ£€æŸ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š" class="headerlink" title="1. k8sé›†ç¾¤éƒ¨ç½²åå‘ç°calicoçš„podæœªé€šè¿‡å¥åº·æ£€æŸ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š"></a>1. k8sé›†ç¾¤éƒ¨ç½²åå‘ç°calicoçš„podæœªé€šè¿‡å¥åº·æ£€æŸ¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods -A -o wide</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_2b399502c98fb452733a85c290d601ab.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_2b399502c98fb452733a85c290d601ab.png"></p><blockquote><p>å¯ä»¥çœ‹åˆ° k8s-materèŠ‚ç‚¹æœªReadyï¼Œä¼šå¯¼è‡´ä¸»èŠ‚ç‚¹è®¿é—®nodeæ˜¾ç¤ºæ‹’æ¥è¿æ¥ã€‚å³: curl 10.0.169.144 æ˜¾ç¤ºä¸ºæ‹’ç»è¿æ¥</p></blockquote><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_7fa73e77464fec1d997cab51be0238e7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_7fa73e77464fec1d997cab51be0238e7.png"></p><h3 id="2-é€šè¿‡å‘½ä»¤kubectl-describe-pods-calico-node-8lb6j-n-kube-systemï¼ŒæŸ¥çœ‹å…¶ä¸­ä¸€ä¸ªpodä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š"><a href="#2-é€šè¿‡å‘½ä»¤kubectl-describe-pods-calico-node-8lb6j-n-kube-systemï¼ŒæŸ¥çœ‹å…¶ä¸­ä¸€ä¸ªpodä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š" class="headerlink" title="2. é€šè¿‡å‘½ä»¤kubectl describe pods calico-node-8lb6j -n kube-systemï¼ŒæŸ¥çœ‹å…¶ä¸­ä¸€ä¸ªpodä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š"></a>2. é€šè¿‡å‘½ä»¤kubectl describe pods calico-node-8lb6j -n kube-systemï¼ŒæŸ¥çœ‹å…¶ä¸­ä¸€ä¸ªpodä¿¡æ¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl describe pods calico-node-8lb6j -n kube-system</span><br></pre></td></tr></table></figure><h2 id="äºŒã€è§£å†³æ–¹æ³•"><a href="#äºŒã€è§£å†³æ–¹æ³•" class="headerlink" title="äºŒã€è§£å†³æ–¹æ³•"></a>äºŒã€è§£å†³æ–¹æ³•</h2><blockquote><p>è§£å†³æ–¹æ¡ˆï¼šè°ƒæ•´calicaoç½‘ç»œæ’ä»¶çš„ç½‘å¡å‘ç°æœºåˆ¶ï¼Œä¿®æ”¹IP_AUTODETECTION_METHODå¯¹åº”çš„valueå€¼ã€‚å®˜æ–¹æä¾›çš„yamlæ–‡ä»¶ä¸­ï¼Œipè¯†åˆ«ç­–ç•¥ï¼ˆIPDETECTMETHODï¼‰æ²¡æœ‰é…ç½®ï¼Œå³é»˜è®¤ä¸ºfirst-foundï¼Œè¿™ä¼šå¯¼è‡´ä¸€ä¸ªç½‘ç»œå¼‚å¸¸çš„ipä½œä¸ºnodeIPè¢«æ³¨å†Œï¼Œä»è€Œå½±å“node-to-node meshã€‚æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆcan-reachæˆ–è€…interfaceçš„ç­–ç•¥ï¼Œå°è¯•è¿æ¥æŸä¸€ä¸ªReadyçš„nodeçš„IPï¼Œä»¥æ­¤é€‰æ‹©å‡ºæ­£ç¡®çš„IPã€‚</p></blockquote><p>æ“ä½œå¦‚ä¸‹:</p><h3 id="2-1-æŸ¥çœ‹æœ¬æœºç½‘å¡ä¿¡æ¯"><a href="#2-1-æŸ¥çœ‹æœ¬æœºç½‘å¡ä¿¡æ¯" class="headerlink" title="2.1 æŸ¥çœ‹æœ¬æœºç½‘å¡ä¿¡æ¯"></a>2.1 æŸ¥çœ‹æœ¬æœºç½‘å¡ä¿¡æ¯</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_913079859149ed1f89a5f279143d64c7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_913079859149ed1f89a5f279143d64c7.png"></p><h3 id="2-2-ä¿®æ”¹-calico-yamlæ–‡ä»¶"><a href="#2-2-ä¿®æ”¹-calico-yamlæ–‡ä»¶" class="headerlink" title="2.2 ä¿®æ”¹ calico.yamlæ–‡ä»¶"></a>2.2 ä¿®æ”¹ calico.yamlæ–‡ä»¶</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¿®æ”¹calicoçš„yamlæ–‡ä»¶ï¼Œæ·»åŠ é…ç½®é¡¹</span></span><br><span class="line">vim calico.yaml</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Cluster type to identify the deployment type</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">IP_AUTODETECTION_METHOD</span> <span class="comment">#å¢åŠ å†…å®¹</span></span><br><span class="line">  <span class="attr">value:</span> <span class="string">&quot;interface=ens*&quot;</span> <span class="string">æˆ–è€…</span> <span class="attr">value:</span> <span class="string">&quot;interface=ens33&quot;</span>     <span class="comment">#å¢åŠ å†…å®¹</span></span><br><span class="line"><span class="comment"># ä¸‹é¢å†…å®¹æ˜¯calico.yamlé‡Œé»˜è®¤çš„ä¸ä¿®æ”¹  </span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">CLUSTER_TYPE</span></span><br><span class="line">  <span class="attr">value:</span> <span class="string">&quot;k8s,bgp&quot;</span></span><br><span class="line"><span class="comment"># Auto-detect the BGP IP address.</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">IP</span></span><br><span class="line">  <span class="attr">value:</span> <span class="string">&quot;autodetect&quot;</span></span><br><span class="line"><span class="comment"># Enable IPIP</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">CALICO_IPV4POOL_IPIP</span></span><br><span class="line">  <span class="attr">value:</span> <span class="string">&quot;Always&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-3-é‡æ–°åœ¨masterèŠ‚ç‚¹ä¸Šéƒ¨ç½²"><a href="#2-3-é‡æ–°åœ¨masterèŠ‚ç‚¹ä¸Šéƒ¨ç½²" class="headerlink" title="2.3 é‡æ–°åœ¨masterèŠ‚ç‚¹ä¸Šéƒ¨ç½²"></a>2.3 é‡æ–°åœ¨masterèŠ‚ç‚¹ä¸Šéƒ¨ç½²</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f calico.yaml</span><br></pre></td></tr></table></figure><h3 id="2-4-æŸ¥çœ‹ç»“æœ"><a href="#2-4-æŸ¥çœ‹ç»“æœ" class="headerlink" title="2.4 æŸ¥çœ‹ç»“æœ"></a>2.4 æŸ¥çœ‹ç»“æœ</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get pods -n kube-system</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl 10.0.169.144</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_5d67420b148ec11c154d7579f918d7e5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_5d67420b148ec11c154d7579f918d7e5.png"></p><p>æœ¬æ–‡è½¬è½½è‡ªï¼š<a href="https://www.cnblogs.com/codertl/p/17021964.html">Kubernetesæ•…éšœç¯‡ï¼šcalico/node is not ready: BIRD is not ready - CoderTL - åšå®¢å›­ (cnblogs.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centosç¦»çº¿éƒ¨ç½²nvidia-docker-runtime</title>
      <link href="/2024/10/14/centos%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2nvidia-docker-runtime/"/>
      <url>/2024/10/14/centos%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2nvidia-docker-runtime/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="centosç¦»çº¿éƒ¨ç½²nvidia-docker-runtime"><a href="#centosç¦»çº¿éƒ¨ç½²nvidia-docker-runtime" class="headerlink" title="centosç¦»çº¿éƒ¨ç½²nvidia-docker-runtime"></a>centosç¦»çº¿éƒ¨ç½²nvidia-docker-runtime</h1><p>å‚è€ƒï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/641349918">https://zhuanlan.zhihu.com/p/641349918</a></p><p><a href="https://www.hangge.com/blog/cache/detail_3185.html">https://www.hangge.com/blog/cache/detail_3185.html</a></p><p><a href="https://www.server-world.info/en/note?os=Ubuntu_24.04&amp;p=nvidia&amp;f=3">https://www.server-world.info/en/note?os=Ubuntu_24.04&amp;p=nvidia&amp;f=3</a></p><p>ç¦»çº¿rpmåŒ…è·¯å¾„ï¼š</p><p><a href="https://github.com/NVIDIA/libnvidia-container/tree/gh-pages/stable/">https://github.com/NVIDIA/libnvidia-container/tree/gh-pages/stable/</a></p><p>onedrive rpmåŒ…ä¸‹è½½ç•™å­˜åœ°å€ï¼š</p><p><a href="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/public-tools/nvidia-rpm/nvidia-container-runtime.tar.gz">https://onenote.zznnwn.cloudns.biz/api/raw/?path=/public-tools/nvidia-rpm/nvidia-container-runtime.tar.gz</a></p><h2 id="æ–‡æ¡£æ¦‚è§ˆ"><a href="#æ–‡æ¡£æ¦‚è§ˆ" class="headerlink" title="æ–‡æ¡£æ¦‚è§ˆ"></a>æ–‡æ¡£æ¦‚è§ˆ</h2><p><a href="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/public-tools/nvidia-rpm/nvidia-container-runtime.tar.gz">é¦–å…ˆä¸‹è½½rpmåŒ…åˆ°æœåŠ¡å™¨</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ‡æ¢åˆ°/opt</span></span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line"><span class="comment">#è§£å‹nvidia-container-runtime.tar.gz</span></span><br><span class="line">tar -zxvf nvidia-container-runtime.tar.gz</span><br><span class="line"><span class="comment">#ç¦»çº¿å®‰è£…æ‰€æœ‰rpmåŒ…</span></span><br><span class="line"><span class="built_in">cd</span> nvidia-container-runtime</span><br><span class="line">rpm -Uvh --force --nodeps *.rpm</span><br><span class="line"><span class="comment">#å®‰è£…å®Œåéœ€è¦é‡å¯å®¹å™¨ï¼Œæœªè®¾ç½®ä¸ºç³»ç»Ÿå¯åŠ¨æœåŠ¡ï¼Œä¹Ÿå¯ä»¥é€šè¿‡kill dockerè¿›ç¨‹å†å¯åŠ¨æ–¹å¼é‡å¯</span></span><br><span class="line">systemctl restart docker</span><br><span class="line"><span class="comment">#æŸ¥çœ‹å®‰è£…ç»“æœ</span></span><br><span class="line">whereis  nvidia-container-runtime</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯æ˜¯å¦æˆåŠŸï¼ˆæ˜¾ç¤ºå¦‚ä¸‹åˆ™æˆåŠŸï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">root@dmx:/opt/ollama<span class="comment"># docker run -it --rm --gpus all registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ubuntu  nvidia-smi</span></span><br><span class="line">Tue Jul 23 07:28:58 2024   </span><br><span class="line">+-----------------------------------------------------------------------------------------+</span><br><span class="line">| NVIDIA-SMI 550.100                Driver Version: 550.100        CUDA Version: 12.4     |</span><br><span class="line">|-----------------------------------------+------------------------+----------------------+</span><br><span class="line">| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |</span><br><span class="line">| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |</span><br><span class="line">|                                         |                        |               MIG M. |</span><br><span class="line">|=========================================+========================+======================|</span><br><span class="line">|   0  NVIDIA GeForce RTX 4090 D      Off |   00000000:01:00.0 Off |                  Off |</span><br><span class="line">|  0%   40C    P5             65W /  425W |    5609MiB /  24564MiB |      0%      Default |</span><br><span class="line">|                                         |                        |                  N/A |</span><br><span class="line">+-----------------------------------------+------------------------+----------------------+</span><br><span class="line">                                                                         </span><br><span class="line">+-----------------------------------------------------------------------------------------+</span><br><span class="line">| Processes:                                                                              |</span><br><span class="line">|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |</span><br><span class="line">|        ID   ID                                                               Usage      |</span><br><span class="line">|=========================================================================================|</span><br><span class="line">+-----------------------------------------------------------------------------------------+</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Author: ç²˜äººçš„é¸­å˜´å…½çš„å°ç«™ğŸˆ</span><br><span class="line">Link: https://sunlight.zznnwn.cloudns.biz/2024/07/15/ubuntu%E9%83%A8%E7%BD%B2nvidia-container-toolkit/</span><br><span class="line">Source: ç²˜äººçš„é¸­å˜´å…½ğŸ“</span><br><span class="line">Copyright is owned by the author. For commercial reprints, please contact the author <span class="keyword">for</span> authorization. For non-commercial reprints, please indicate the <span class="built_in">source</span>.</span><br></pre></td></tr></table></figure><h2 id="ç³»ç»Ÿç¯å¢ƒ"><a href="#ç³»ç»Ÿç¯å¢ƒ" class="headerlink" title="ç³»ç»Ÿç¯å¢ƒ"></a><strong>ç³»ç»Ÿç¯å¢ƒ</strong></h2><p>1ï¼‰æ“ä½œç³»ç»Ÿï¼šCentOS7.9</p><p>2ï¼‰Dockerç‰ˆæœ¬ï¼š20.10.9</p><p>3ï¼‰NVIDIA æ˜¾å¡å‹å·ï¼šRTX <a href="https://zhida.zhihu.com/search?content_id=230653465&content_type=Article&match_order=1&q=3090&zhida_source=entity">3090</a></p><p>4ï¼‰NVIDIA é©±åŠ¨ç‰ˆæœ¬ï¼š526.86</p><h2 id="å®‰è£…æ­¥éª¤"><a href="#å®‰è£…æ­¥éª¤" class="headerlink" title="å®‰è£…æ­¥éª¤"></a><strong>å®‰è£…æ­¥éª¤</strong></h2><h2 id="1ã€Docker-ä¸‹è½½"><a href="#1ã€Docker-ä¸‹è½½" class="headerlink" title="1ã€Docker ä¸‹è½½"></a><strong>1ã€Docker</strong> <strong>ä¸‹è½½</strong></h2><p><a href="https://link.zhihu.com/?target=https://download.docker.com/linux/static/stable/x86_64/docker-20.10.9.tgz">https://<strong>download.docker.com/lin</strong>ux/static/stable/x86_64/docker-20.10.9.tgz</a></p><p>å…¶ä»–ç‰ˆæœ¬å¯é€šè¿‡ä¸€ä¸‹åœ°å€è®¿é—®ï¼Œé€‰æ‹©å¯¹åº”ç‰ˆæœ¬</p><p><a href="https://link.zhihu.com/?target=https://download.docker.com/linux/static/stable/x86_64/">https://<strong>download.docker.com/lin</strong>ux/static/stable/x86_64/</a></p><p><img src="https://pic2.zhimg.com/80/v2-ece96d0a3049348573fc5cdfb9873be5_720w.webp"></p><p>docker å®‰è£…åŒ…ä¸‹è½½</p><h2 id="2ã€Dockerå®‰è£…"><a href="#2ã€Dockerå®‰è£…" class="headerlink" title="2ã€Dockerå®‰è£…"></a><strong>2ã€Dockerå®‰è£…</strong></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‹·è´æ–‡ä»¶åˆ°GPUæœåŠ¡å™¨å¹¶è§£å‹å®‰è£…æ–‡ä»¶</span></span><br><span class="line">tar xzvf docker-20.10.9.tgz</span><br></pre></td></tr></table></figure><p><img src="https://pic3.zhimg.com/80/v2-fcb43ff8951d83009603060ce1ee553e_720w.webp"></p><p>è§£å‹dockerå‹ç¼©åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‹·è´åˆ°ç³»ç»Ÿè„šæœ¬ç›®å½•</span></span><br><span class="line">sudo <span class="built_in">cp</span> docker/* /usr/bin/</span><br><span class="line"><span class="comment"># åå°å¯åŠ¨docker</span></span><br><span class="line">sudo dockerd &amp;</span><br></pre></td></tr></table></figure><p>å‡ºç°å¦‚ä¸‹å†…å®¹è¡¨ådocker å¯åŠ¨å®Œæˆï¼Œå›è½¦é€€å‡ºå³å¯</p><blockquote><p>INFO[2023-07-03T14:05:58.369195793+08:00] Docker daemon commit=79ea9d3 <a href="https://zhida.zhihu.com/search?content_id=230653465&content_type=Article&match_order=1&q=graphdriver&zhida_source=entity">graphdriver</a>(s)=overlay2 version=20.10.9<br>INFO[2023-07-03T14:05:58.369566710+08:00] Daemon has completed initialization</p></blockquote><p><img src="https://pic2.zhimg.com/80/v2-d825db9817d8434adae3381b44f080c5_720w.webp"></p><p>docker å®‰è£…å®Œæˆ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#æŸ¥çœ‹docker ç‰ˆæœ¬ä¿¡æ¯</span></span><br><span class="line">docker -v</span><br><span class="line"><span class="comment">#æŸ¥çœ‹docker è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">docker info</span><br></pre></td></tr></table></figure><p><img src="https://pica.zhimg.com/80/v2-70952c80d08bdb29e179d140d7fdc492_720w.webp"></p><p>æŸ¥çœ‹dockerä¿¡æ¯</p><h2 id="3ã€nvidia-docker-runtimeå®‰è£…"><a href="#3ã€nvidia-docker-runtimeå®‰è£…" class="headerlink" title="3ã€nvidia-docker-runtimeå®‰è£…"></a>3ã€<strong>nvidia-docker-runtimeå®‰è£…</strong></h2><p><strong>1ï¼‰nvidia-docker-runtimeä½œç”¨</strong></p><p>é€šè¿‡nvidia-docker-runtimeï¼Œå¯ä»¥å®ç°åœ¨dockerå®¹å™¨å†…éƒ¨ä½¿ç”¨nvidiaçš„gpu è¿›è¡Œç›¸å…³çš„æ¨¡å‹è®­ç»ƒå’Œæ¨ç†ã€‚</p><p>docker å®‰è£…å®Œæˆåï¼Œå¯é€šè¿‡docker run åˆ›å»ºå¸¸è§„çš„dockerå®¹å™¨ï¼Œä½†æ˜¯ä¸å®‰è£…nvidiaç›¸å…³ç»„ä»¶æ— æ³•ä½¿ç”¨NVIDIAçš„æ˜¾å¡ï¼Œdocker run æ·»åŠ  â€“runtime=nvidia æˆ–è€…æ·»åŠ â€“gpuså‚æ•°æŠ¥é”™ï¼Œå¹¶ä¸”æ™®é€šåˆ›å»ºçš„å®¹å™¨æ‰§è¡Œnvidia-smi æ²¡æœ‰è¿”å›ç»“æœï¼Œä¼šå‡ºç°å¦‚ä¸‹æç¤ºã€‚</p><blockquote><p>docker: Error response from daemon: could not select device driver â€œâ€ with <a href="https://zhida.zhihu.com/search?content_id=230653465&content_type=Article&match_order=1&q=capabilities&zhida_source=entity">capabilities</a>: [[gpu]].<br>unknown flag: â€“gpus</p></blockquote><p><strong>2ï¼‰ä¸åŒç‰ˆæœ¬docker å®‰è£…nvidia gpu SDKåŒºåˆ«</strong></p><p>åœ¨docker19.xä»¥å‰çš„ç‰ˆæœ¬éœ€è¦ä¸‹è½½<a href="https://zhida.zhihu.com/search?content_id=230653465&content_type=Article&match_order=1&q=nvidia-docker2&zhida_source=entity">nvidia-docker2</a>æ¥å¯åŠ¨å®¹å™¨ï¼›é€šè¿‡ä½¿ç”¨<a href="https://zhida.zhihu.com/search?content_id=230653465&content_type=Article&match_order=1&q=nvidia-docker+run&zhida_source=entity">nvidia-docker run</a>æˆ–è€…docker run â€“runtime=nvidiaçš„æ–¹å¼æ¥æŒ‡å®šgpuï¼›</p><p>docker19.xåç‰ˆæœ¬ä½¿ç”¨gpuåªéœ€è¦åŠ ä¸ªå‚æ•°â€“gpus allå³å¯(allï¼šä½¿ç”¨æ‰€æœ‰çš„gpuï¼Œå¦‚æœè¦ä½¿ç”¨2ä¸ªgpuï¼šâ€“gpus 2ï¼Œä¹Ÿå¯ç›´æ¥æŒ‡å®šå“ªå‡ ä¸ªå¡ï¼šâ€“gpus â€˜â€œdevice=1,2â€â€˜</p><p><strong>3ï¼‰nvidia-container-runtime ç¦»çº¿åŒ…ä¸‹è½½</strong></p><p>ä¸‹è½½nvidia-container-runtimeä¾èµ–åŒ…åˆ°æœ¬åœ°ï¼Œæ‰¾ä¸€å°å¯ä»¥ä¸Šç½‘çš„centos7.xçš„è™šæ‹Ÿæœºï¼ˆ<a href="https://zhida.zhihu.com/search?content_id=230653465&content_type=Article&match_order=1&q=vmware%E8%99%9A%E6%8B%9F%E6%9C%BA&zhida_source=entity">vmwareè™šæ‹Ÿæœº</a>å³å¯å®Œæˆï¼‰æŒ‰é¡ºåºæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å®‰è£…yum-utilsï¼Œé€šè¿‡è¯¥åŒ…çš„repotrackæ¨¡å—å¯ä»¥å¿«é€Ÿä¸‹è½½æŒ‡å®šåŒ…åŠå…¶æ‰€æœ‰ä¾èµ–åŒ…ã€‚</span></span><br><span class="line">sudo yum -y install yum-utils</span><br><span class="line"><span class="comment">#æŒ‡å®šyumé•œåƒæºåŒ…å«nvidia-github</span></span><br><span class="line">distribution=$(. /etc/os-release;<span class="built_in">echo</span> $ID<span class="variable">$VERSION_ID</span>)</span><br><span class="line">curl -s -L https://nvidia.github.io/nvidia-container-runtime/<span class="variable">$distribution</span>/nvidia-container-runtime.repo | sudo <span class="built_in">tee</span> /etc/yum.repos.d/nvidia-container-runtime.repo</span><br></pre></td></tr></table></figure><p><img src="https://pic1.zhimg.com/80/v2-5ba070a0b5fab66abac5f3ba41cb66ca_720w.webp"></p><p>æŒ‡å®šyum nvidiaé•œåƒæº</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä¸‹è½½ç¦»çº¿å®‰è£…åŒ…åˆ°æœ¬åœ°</span></span><br><span class="line"><span class="built_in">cd</span> /app/soft/nvidia-container-runtime/</span><br><span class="line">repotrack nvidia-container-runtime </span><br></pre></td></tr></table></figure><p><img src="https://picx.zhimg.com/80/v2-be4211899d8f666ca97a469e2d580b3d_720w.webp"></p><p>ä¸‹è½½nvidia-docker-runtimeç¦»çº¿åŒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“åŒ…nvidia-container-runtimeç¦»çº¿åŒ…</span></span><br><span class="line"><span class="built_in">cd</span> /app/soft/</span><br><span class="line">tar -zcvf nvidia-container-runtime.tar.gz nvidia-container-runtime/</span><br></pre></td></tr></table></figure><p><strong>4ï¼‰nvidia-container-runtimeç¦»çº¿åŒ…å®‰è£…</strong></p><p>æ‹·è´nvidia-container-runtime.tar.gzæ–‡ä»¶åˆ°ç¦»çº¿GPUæœåŠ¡å™¨ï¼ŒæŒ‰é¡ºåºæ‰§è¡Œä¸‹åˆ—å‘½ä»¤è¿›è¡Œå®‰è£…ã€éªŒè¯ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#è§£å‹nvidia-container-runtime.tar.gz</span></span><br><span class="line">tar -zxvf nvidia-container-runtime.tar.gz</span><br><span class="line"><span class="comment">#ç¦»çº¿å®‰è£…æ‰€æœ‰rpmåŒ…</span></span><br><span class="line"><span class="built_in">cd</span> nvidia-container-runtime</span><br><span class="line">rpm -Uvh --force --nodeps *.rpm</span><br><span class="line"><span class="comment">#å®‰è£…å®Œåéœ€è¦é‡å¯å®¹å™¨ï¼Œæœªè®¾ç½®ä¸ºç³»ç»Ÿå¯åŠ¨æœåŠ¡ï¼Œä¹Ÿå¯ä»¥é€šè¿‡kill dockerè¿›ç¨‹å†å¯åŠ¨æ–¹å¼é‡å¯</span></span><br><span class="line">systemctl restart docker</span><br><span class="line"><span class="comment">#æŸ¥çœ‹å®‰è£…ç»“æœ</span></span><br><span class="line">whereis  nvidia-container-runtime </span><br></pre></td></tr></table></figure><p>æˆ–è€…</p><p><a href="https://juejin.cn/post/7099007817540960293">é“¶æ²³éº’éºŸV10 Serverç³»ç»Ÿä¸­ç¦»çº¿å®‰è£…nvidia dockeræ–¹æ³•é“¶æ²³éº’éºŸV10 Server ç³»ç»Ÿä¸‹å®‰è£…æœ€æ–°çš„d - æ˜é‡‘ (juejin.cn)</a>  ã€æœªæµ‹è¯•ã€‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo rpm -Uvh libnvidia-container-tools-1.10.0-1.x86_64.rpm --nodeps --force</span><br><span class="line">sudo rpm -Uvh nvidia-container-toolkit-1.10.0-1.x86_64.rpm --nodeps --force</span><br><span class="line">sudo rpm -Uvh libnvidia-container1-1.10.0-1.x86_64.rpm --nodeps --force</span><br><span class="line">sudo rpm -Uvh nvidia-docker2-2.11.0-1.noarch.rpm --nodeps --force</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://pic3.zhimg.com/80/v2-95b20993d196fa53e4ae9e6373d981fe_720w.webp"></p><p>CentOS Docker NVIDIAç¯å¢ƒç¦»çº¿å®‰è£…å·²ç»å®Œæˆï¼Œä¸‹ä¸€ç« å°†ç»§ç»­ç¦»çº¿Dockeré•œåƒåˆ¶ä½œå¹¶å®‰è£…</p><p>æœ¬æ–‡è½¬è½½è‡ªï¼š<a href="https://zhuanlan.zhihu.com/p/641349918">CentOS Docker NVIDIAç¯å¢ƒç¦»çº¿å®‰è£… - çŸ¥ä¹ (zhihu.com)</a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ollamaæœ¬åœ°å¤§æ¨¡å‹å®ç°è”ç½‘æœç´¢åŠŸèƒ½</title>
      <link href="/2024/10/12/ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%9E%E7%8E%B0%E8%81%94%E7%BD%91%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD/"/>
      <url>/2024/10/12/ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%AE%9E%E7%8E%B0%E8%81%94%E7%BD%91%E6%90%9C%E7%B4%A2%E5%8A%9F%E8%83%BD/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ollamaæœ¬åœ°å¤§æ¨¡å‹å®ç°è”ç½‘æœç´¢åŠŸèƒ½"><a href="#ollamaæœ¬åœ°å¤§æ¨¡å‹å®ç°è”ç½‘æœç´¢åŠŸèƒ½" class="headerlink" title="ollamaæœ¬åœ°å¤§æ¨¡å‹å®ç°è”ç½‘æœç´¢åŠŸèƒ½"></a>ollamaæœ¬åœ°å¤§æ¨¡å‹å®ç°è”ç½‘æœç´¢åŠŸèƒ½</h1><p>Githubæ‰˜ç®¡åœ°å€ï¼š</p><p><a href="https://github.com/yokingma/search_with_ai">https://github.com/yokingma/search_with_ai</a></p><p><a href="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/soeasy/ai%E6%90%9C%E7%B4%A2/search_with_ai-main.zip&odpt=5046321679d1f8c753819aa82a4643426fff5d03f243f3059b4c57ac522727f4">onedrive</a></p><p>å°†é¡¹ç›®æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°</p><p>git clone <a href="https://github.com/yokingma/search_with_ai.git">https://github.com/yokingma/search_with_ai.git</a></p><p>æ¼”ç¤ºåœ°å€ï¼š<a href="https://isou.chat/">https://isou.chat/</a></p><h2 id="ä¸€-docker-compose-yml-é¡¹ç›®æ–‡ä»¶"><a href="#ä¸€-docker-compose-yml-é¡¹ç›®æ–‡ä»¶" class="headerlink" title="ä¸€. docker-compose.yml é¡¹ç›®æ–‡ä»¶"></a>ä¸€. docker-compose.yml é¡¹ç›®æ–‡ä»¶</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">ollama:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ollama</span> </span><br><span class="line">    <span class="comment">#ollama/ollama:latest</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">11434</span><span class="string">:11434</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./ollama:/root/.ollama</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">ollama</span></span><br><span class="line">    <span class="attr">pull_policy:</span> <span class="string">if_not_present</span></span><br><span class="line">    <span class="comment">#tty: true</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ollama-docker</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">KEEP_GPUS_TIMEOUT:</span> <span class="number">40</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">OLLAMA_ORIGINS:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">      <span class="attr">OLLAMA_HOST:</span> <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">    <span class="comment"># GPU support</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">reservations:</span></span><br><span class="line">          <span class="attr">devices:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">driver:</span> <span class="string">nvidia</span></span><br><span class="line">              <span class="attr">count:</span> <span class="number">1</span></span><br><span class="line">              <span class="attr">capabilities:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">gpu</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:open-webui-main</span> </span><br><span class="line">    <span class="comment">#ghcr.io/open-webui/open-webui:main</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">open-webui</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    <span class="attr">extra_hosts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;host.docker.internal:host-gateway&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">open-webui:/app/backend/data</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">ENABLE_RAG_WEB_SEARCH:</span> <span class="literal">True</span></span><br><span class="line">      <span class="attr">RAG_WEB_SEARCH_ENGINE:</span> <span class="string">&quot;searxng&quot;</span></span><br><span class="line">      <span class="attr">RAG_WEB_SEARCH_RESULT_COUNT:</span> <span class="number">3</span></span><br><span class="line">      <span class="attr">RAG_WEB_SEARCH_CONCURRENT_REQUESTS:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">SEARXNG_QUERY_URL:</span> <span class="string">&quot;http://searxng:8080/search?q=&lt;query&gt;&quot;</span>   </span><br><span class="line">      <span class="attr">ENABLE_OPENAI_API:</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="comment"># open-webui:</span></span><br><span class="line">  <span class="comment">#   image: ghcr.io/open-webui/open-webui:main</span></span><br><span class="line">  <span class="comment">#   container_name: open-webui</span></span><br><span class="line">  <span class="comment">#   pull_policy: if_not_present</span></span><br><span class="line">  <span class="comment">#   volumes:</span></span><br><span class="line">  <span class="comment">#     - ./data:/app/backend/data</span></span><br><span class="line">  <span class="comment">#   depends_on:</span></span><br><span class="line">  <span class="comment">#     - ollama</span></span><br><span class="line">  <span class="comment">#   ports:</span></span><br><span class="line">  <span class="comment">#     - 3000:8080</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - &#x27;OLLAMA_BASE_URL=http://ollama:11434&#x27;</span></span><br><span class="line">  <span class="comment">#     - &#x27;WEBUI_SECRET_KEY=sdjfvdklfbvkkgb&#x27;</span></span><br><span class="line">  <span class="comment">#     - &#x27;HF_ENDPOINT=https://hf-mirror.com&#x27;</span></span><br><span class="line">  <span class="comment">#   extra_hosts:</span></span><br><span class="line">  <span class="comment">#     - host.docker.internal:host-gateway</span></span><br><span class="line">  <span class="comment">#   restart: unless-stopped</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ollama-docker</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="attr">search:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">aisearch</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/ai:aisearch-amd64</span> </span><br><span class="line">    <span class="comment">#zacma/aisearch:latest</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./.env.docker:/app/.env</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./model.json:/app/dist/model.json</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3002:3000&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ollama-docker</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="attr">searxng:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">searxng</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/ai:searxng-latest</span> </span><br><span class="line">    <span class="comment">#docker.io/searxng/searxng:latest</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="comment">#ports:</span></span><br><span class="line">      <span class="comment">#- &quot;127.0.0.1:8090:8080&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./searxng:/etc/searxng:rw</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">SEARXNG_BASE_URL=https://$&#123;SEARXNG_HOSTNAME:-localhost&#125;/</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ollama-docker</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">ollama-docker:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="searché…ç½®æ–‡ä»¶"><a href="#searché…ç½®æ–‡ä»¶" class="headerlink" title="searché…ç½®æ–‡ä»¶"></a>searché…ç½®æ–‡ä»¶</h3><h4 id="1-env-docker"><a href="#1-env-docker" class="headerlink" title="1..env.docker"></a>1.<code>.env.docker</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Server Port</span></span><br><span class="line">PORT=3000</span><br><span class="line"><span class="comment"># Bing search key</span></span><br><span class="line">BING_SEARCH_KEY=</span><br><span class="line"><span class="comment"># Google search key</span></span><br><span class="line">GOOGLE_SEARCH_KEY=</span><br><span class="line">GOOGLE_SEARCH_ID=</span><br><span class="line"><span class="comment"># aliyun key</span></span><br><span class="line">ALIYUN_KEY=</span><br><span class="line"><span class="comment"># Yi Key</span></span><br><span class="line">YI_KEY=</span><br><span class="line"><span class="comment"># google gemini</span></span><br><span class="line">GOOGLE_KEY=</span><br><span class="line"><span class="comment">#GOOGLE_PROXY_URL=</span></span><br><span class="line">OPENAI_PROXY_URL=http://freeduckduckgo:3456/v1</span><br><span class="line"><span class="comment"># baidu</span></span><br><span class="line">BAIDU_KEY=</span><br><span class="line">BAIDU_SECRET=</span><br><span class="line"><span class="comment"># tencent KEY:ID, SECRET:KEY</span></span><br><span class="line">TENCENT_KEY=</span><br><span class="line">TENCENT_SECRET=</span><br><span class="line"><span class="comment"># openai key</span></span><br><span class="line">OPENAI_KEY=</span><br><span class="line"><span class="comment"># openai BASE_URL</span></span><br><span class="line">OPENAI_PROXY_URL=</span><br><span class="line"><span class="comment"># deepseek</span></span><br><span class="line">DEEPSEEK_KEY= <span class="comment">#your_key</span></span><br><span class="line"><span class="comment"># chatglm</span></span><br><span class="line">GLM_KEY= <span class="comment">#your_key</span></span><br><span class="line"><span class="comment"># moonshot</span></span><br><span class="line">MOONSHOT_KEY=</span><br><span class="line"><span class="comment"># lepthon key</span></span><br><span class="line">LEPTON_KEY=</span><br><span class="line"><span class="comment"># Local llm: Ollama hostname, could modify if you need.</span></span><br><span class="line">OLLAMA_HOST=http://host.docker.internal:11434</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line"><span class="comment"># OLLAMA_HOST=10.0.0.10:11434</span></span><br><span class="line"><span class="comment"># Local llm: LM Studio host name</span></span><br><span class="line">LMSTUDIO_HOSTNAME=localhost:1234</span><br><span class="line"><span class="comment"># Searxng hostname, could modify if you need.</span></span><br><span class="line">SEARXNG_HOSTNAME=http://searxng:8080</span><br><span class="line"><span class="comment"># https://github.com/searxng/searxng/tree/master/searx/engines</span></span><br><span class="line">SEARXNG_ENGINES=bing,google</span><br><span class="line">SEARXNG_IMAGES_ENGINES=bing <span class="comment">#,google</span></span><br><span class="line"><span class="comment"># The count of resources referenced</span></span><br><span class="line">REFERENCE_COUNT = 8</span><br><span class="line"><span class="comment"># enable cache, 1 enable, 0 disable</span></span><br><span class="line">CACHE_ENABLE=1</span><br><span class="line"><span class="comment"># SearXNG æŸ¥è¯¢é€‰é¡¹ï¼Œsafesearchï¼šè¿‡æ»¤æœç´¢ç»“æœï¼Œ0ï¼šæ—  1ï¼šä¸­ç­‰ 2ï¼šä¸¥æ ¼ã€‚(æ–°å¢é‡è¦é…ç½®)</span></span><br><span class="line">SEARXNG_SAFE=1</span><br></pre></td></tr></table></figure><h4 id="2-model-json"><a href="#2-model-json" class="headerlink" title="2.model.json"></a>2.<code>model.json</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;aliyun&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;qwen-max&quot;</span>, <span class="string">&quot;qwen-max-0428&quot;</span>, <span class="string">&quot;qwen-turbo&quot;</span>, <span class="string">&quot;qwen-plus&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;openai&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;openai&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;o1-preview&quot;</span>, <span class="string">&quot;o1-mini&quot;</span>, <span class="string">&quot;gpt-4o&quot;</span>, <span class="string">&quot;gpt-4o-mini&quot;</span>, <span class="string">&quot;gpt-4o-latest&quot;</span>, <span class="string">&quot;gpt-4-preview&quot;</span>, <span class="string">&quot;gpt-4-turbo&quot;</span>, <span class="string">&quot;gpt-4&quot;</span>, <span class="string">&quot;gpt-3.5-turbo&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;baidu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;baidu&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;eb-instant&quot;</span>, <span class="string">&quot;completions_pro&quot;</span>, <span class="string">&quot;ernie_bot_8k&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;google&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;gemini&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;gemini-1.0-pro&quot;</span>, <span class="string">&quot;gemini-1.5-pro&quot;</span>, <span class="string">&quot;gemini-1.5-flash&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;yi&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;openai&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;yi-large&quot;</span>, <span class="string">&quot;yi-large-turbo&quot;</span>, <span class="string">&quot;yi-medium&quot;</span>, <span class="string">&quot;yi-spark&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;moonshot&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;openai&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;moonshot-v1-8k&quot;</span>, <span class="string">&quot;moonshot-v1-32k&quot;</span>, <span class="string">&quot;moonshot-v1-128k&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;lepton&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;openai&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;llama2-7b&quot;</span>, <span class="string">&quot;llama2-13b&quot;</span>, <span class="string">&quot;llama2-70b&quot;</span>, <span class="string">&quot;mixtral-8*7b&quot;</span>, <span class="string">&quot;mixtral-8*22b&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;deepseek&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;openai&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;deepseek-chat&quot;</span>, <span class="string">&quot;deepseek-coder&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;chatglm&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;openai&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;glm-4&quot;</span>, <span class="string">&quot;glm-4-plus&quot;</span>, <span class="string">&quot;glm-4-air&quot;</span>, <span class="string">&quot;glm-4-airx&quot;</span>, <span class="string">&quot;glm-4-flash&quot;</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;platform&quot;</span>: <span class="string">&quot;tencent&quot;</span>,</span><br><span class="line">    <span class="string">&quot;type&quot;</span>: <span class="string">&quot;tencent&quot;</span>,</span><br><span class="line">    <span class="string">&quot;models&quot;</span>: [<span class="string">&quot;std&quot;</span>, <span class="string">&quot;pro&quot;</span>]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="searxngé…ç½®æ–‡ä»¶ï¼ˆ-searxngç›®å½•ä¸‹ï¼‰"><a href="#searxngé…ç½®æ–‡ä»¶ï¼ˆ-searxngç›®å½•ä¸‹ï¼‰" class="headerlink" title="searxngé…ç½®æ–‡ä»¶ï¼ˆ./searxngç›®å½•ä¸‹ï¼‰"></a>searxngé…ç½®æ–‡ä»¶ï¼ˆ./searxngç›®å½•ä¸‹ï¼‰</h3><h4 id="1-uwsgi-ini"><a href="#1-uwsgi-ini" class="headerlink" title="1.uwsgi.ini"></a>1.<code>uwsgi.ini</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">[uwsgi]</span><br><span class="line"><span class="comment"># Who will run the code</span></span><br><span class="line">uid = searxng</span><br><span class="line">gid = searxng</span><br><span class="line"></span><br><span class="line"><span class="comment"># Number of workers (usually CPU count)</span></span><br><span class="line"><span class="comment"># default value: %k (= number of CPU core, see Dockerfile)</span></span><br><span class="line">workers = %k</span><br><span class="line"></span><br><span class="line"><span class="comment"># Number of threads per worker</span></span><br><span class="line"><span class="comment"># default value: 4 (see Dockerfile)</span></span><br><span class="line">threads = 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># The right granted on the created socket</span></span><br><span class="line">chmod-socket = 666</span><br><span class="line"></span><br><span class="line"><span class="comment"># Plugin to use and interpreter config</span></span><br><span class="line">single-interpreter = <span class="literal">true</span></span><br><span class="line">master = <span class="literal">true</span></span><br><span class="line">plugin = python3</span><br><span class="line">lazy-apps = <span class="literal">true</span></span><br><span class="line">enable-threads = 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># Module to import</span></span><br><span class="line">module = searx.webapp</span><br><span class="line"></span><br><span class="line"><span class="comment"># Virtualenv and python path</span></span><br><span class="line">pythonpath = /usr/local/searxng/</span><br><span class="line"><span class="built_in">chdir</span> = /usr/local/searxng/searx/</span><br><span class="line"></span><br><span class="line"><span class="comment"># automatically set processes name to something meaningful</span></span><br><span class="line">auto-procname = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Disable request logging for privacy</span></span><br><span class="line">disable-logging = <span class="literal">true</span></span><br><span class="line">log-5xx = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Set the max size of a request (request-body excluded)</span></span><br><span class="line">buffer-size = 8192</span><br><span class="line"></span><br><span class="line"><span class="comment"># No keep alive</span></span><br><span class="line"><span class="comment"># See https://github.com/searx/searx-docker/issues/24</span></span><br><span class="line">add-header = Connection: close</span><br><span class="line"></span><br><span class="line"><span class="comment"># Follow SIGTERM convention</span></span><br><span class="line"><span class="comment"># See https://github.com/searxng/searxng/issues/3427</span></span><br><span class="line">die-on-term</span><br><span class="line"></span><br><span class="line"><span class="comment"># uwsgi serves the static files</span></span><br><span class="line">static-map = /static=/usr/local/searxng/searx/static</span><br><span class="line"><span class="comment"># expires set to one day</span></span><br><span class="line">static-expires = /* 86400</span><br><span class="line">static-gzip-all = True</span><br><span class="line">offload-threads = 4</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="2-settings-yml"><a href="#2-settings-yml" class="headerlink" title="2.settings.yml"></a>2.<code>settings.yml</code></h4><p>é‡è¦é…ç½®</p><blockquote><p>SearXNG æ˜¯ä¸€ä¸ªå…è´¹çš„äº’è”ç½‘å…ƒæœç´¢å¼•æ“ï¼Œå®ƒèšåˆäº†æ¥è‡ªå„ç§æœç´¢æœåŠ¡å’Œæ•°æ®åº“çš„ç»“æœã€‚è¯¥æœåŠ¡ä¸è·Ÿè¸ªæˆ–åˆ†æç”¨æˆ·ï¼Œä¸ºå¯»æ±‚åœ¨çº¿åŒ¿åçš„ç”¨æˆ·æä¾›äº†åœ¨çº¿éšç§ã€‚æ­¤å¤–ï¼ŒSearXNG è¿˜å¯ä»¥é€šè¿‡ Tor ä½¿ç”¨ä»¥å®ç°åœ¨çº¿åŒ¿åã€‚</p></blockquote><p>å®‰è£… SearXNG åï¼Œé»˜è®¤æƒ…å†µä¸‹å”¯ä¸€æ¿€æ´»çš„è¾“å‡ºæ ¼å¼æ˜¯ HTML æ ¼å¼ã€‚æ‚¨éœ€è¦æ¿€æ´» json æ ¼å¼ä»¥ä½¿ç”¨ APIã€‚è¿™å¯ä»¥é€šè¿‡åœ¨ settings.yml æ–‡ä»¶ä¸­ä¿®æ”¹ä»¥ä¸‹è¡Œæ¥å®Œæˆï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="comment"># Filter results. 0: None, 1: Moderate, 2: Strict</span></span><br><span class="line">  <span class="attr">safe_search:</span> <span class="number">0</span></span><br><span class="line">  <span class="comment"># Existing autocomplete backends: &quot;dbpedia&quot;, &quot;duckduckgo&quot;, &quot;google&quot;, &quot;yandex&quot;, &quot;mwmbl&quot;,</span></span><br><span class="line">  <span class="comment"># &quot;seznam&quot;, &quot;startpage&quot;, &quot;stract&quot;, &quot;swisscows&quot;, &quot;qwant&quot;, &quot;wikipedia&quot; - leave blank to turn it off</span></span><br><span class="line">  <span class="comment"># by default.</span></span><br><span class="line">  <span class="attr">autocomplete:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="comment"># minimun characters to type before autocompleter starts</span></span><br><span class="line">  <span class="attr">autocomplete_min:</span> <span class="number">4</span></span><br><span class="line">  <span class="comment"># Default search language - leave blank to detect from browser information or</span></span><br><span class="line">  <span class="comment"># use codes from &#x27;languages.py&#x27;</span></span><br><span class="line">  <span class="attr">default_lang:</span> <span class="string">&quot;auto&quot;</span></span><br><span class="line">  <span class="comment"># max_page: 0  # if engine supports paging, 0 means unlimited numbers of pages</span></span><br><span class="line">  <span class="comment"># Available languages</span></span><br><span class="line">  <span class="comment"># languages:</span></span><br><span class="line">  <span class="comment">#   - all</span></span><br><span class="line">  <span class="comment">#   - en</span></span><br><span class="line">  <span class="comment">#   - en-US</span></span><br><span class="line">  <span class="comment">#   - de</span></span><br><span class="line">  <span class="comment">#   - it-IT</span></span><br><span class="line">  <span class="comment">#   - fr</span></span><br><span class="line">  <span class="comment">#   - fr-BE</span></span><br><span class="line">  <span class="comment"># ban time in seconds after engine errors</span></span><br><span class="line">  <span class="attr">ban_time_on_fail:</span> <span class="number">5</span></span><br><span class="line">  <span class="comment"># max ban time in seconds after engine errors</span></span><br><span class="line">  <span class="attr">max_ban_time_on_fail:</span> <span class="number">120</span></span><br><span class="line">  <span class="attr">suspended_times:</span></span><br><span class="line">    <span class="comment"># Engine suspension time after error (in seconds; set to 0 to disable)</span></span><br><span class="line">    <span class="comment"># For error &quot;Access denied&quot; and &quot;HTTP error [402, 403]&quot;</span></span><br><span class="line">    <span class="attr">SearxEngineAccessDenied:</span> <span class="number">86400</span></span><br><span class="line">    <span class="comment"># For error &quot;CAPTCHA&quot;</span></span><br><span class="line">    <span class="attr">SearxEngineCaptcha:</span> <span class="number">86400</span></span><br><span class="line">    <span class="comment"># For error &quot;Too many request&quot; and &quot;HTTP error 429&quot;</span></span><br><span class="line">    <span class="attr">SearxEngineTooManyRequests:</span> <span class="number">3600</span></span><br><span class="line">    <span class="comment"># Cloudflare CAPTCHA</span></span><br><span class="line">    <span class="attr">cf_SearxEngineCaptcha:</span> <span class="number">1296000</span></span><br><span class="line">    <span class="attr">cf_SearxEngineAccessDenied:</span> <span class="number">86400</span></span><br><span class="line">    <span class="comment"># ReCAPTCHA</span></span><br><span class="line">    <span class="attr">recaptcha_SearxEngineCaptcha:</span> <span class="number">604800</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># remove format to deny access, use lower case.</span></span><br><span class="line">  <span class="comment"># formats: [html, csv, json, rss]</span></span><br><span class="line">  <span class="attr">formats:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">html</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">json</span>  <span class="comment"># æ·»åŠ æ­¤å³å¯</span></span><br></pre></td></tr></table></figure><p>å¯ç”¨é»˜è®¤æœç´¢å¼•æ“åŠè§†é¢‘æœç´¢å¼•æ“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">- name: bilibili</span><br><span class="line">  engine: bilibili</span><br><span class="line">  shortcut: bil</span><br><span class="line">  disabled: false</span><br><span class="line"></span><br><span class="line">- name: bing</span><br><span class="line">  engine: bing</span><br><span class="line">  shortcut: bi</span><br><span class="line">  disabled: false</span><br></pre></td></tr></table></figure><p>å®Œæ•´é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br><span class="line">1926</span><br><span class="line">1927</span><br><span class="line">1928</span><br><span class="line">1929</span><br><span class="line">1930</span><br><span class="line">1931</span><br><span class="line">1932</span><br><span class="line">1933</span><br><span class="line">1934</span><br><span class="line">1935</span><br><span class="line">1936</span><br><span class="line">1937</span><br><span class="line">1938</span><br><span class="line">1939</span><br><span class="line">1940</span><br><span class="line">1941</span><br><span class="line">1942</span><br><span class="line">1943</span><br><span class="line">1944</span><br><span class="line">1945</span><br><span class="line">1946</span><br><span class="line">1947</span><br><span class="line">1948</span><br><span class="line">1949</span><br><span class="line">1950</span><br><span class="line">1951</span><br><span class="line">1952</span><br><span class="line">1953</span><br><span class="line">1954</span><br><span class="line">1955</span><br><span class="line">1956</span><br><span class="line">1957</span><br><span class="line">1958</span><br><span class="line">1959</span><br><span class="line">1960</span><br><span class="line">1961</span><br><span class="line">1962</span><br><span class="line">1963</span><br><span class="line">1964</span><br><span class="line">1965</span><br><span class="line">1966</span><br><span class="line">1967</span><br><span class="line">1968</span><br><span class="line">1969</span><br><span class="line">1970</span><br><span class="line">1971</span><br><span class="line">1972</span><br><span class="line">1973</span><br><span class="line">1974</span><br><span class="line">1975</span><br><span class="line">1976</span><br><span class="line">1977</span><br><span class="line">1978</span><br><span class="line">1979</span><br><span class="line">1980</span><br><span class="line">1981</span><br><span class="line">1982</span><br><span class="line">1983</span><br><span class="line">1984</span><br><span class="line">1985</span><br><span class="line">1986</span><br><span class="line">1987</span><br><span class="line">1988</span><br><span class="line">1989</span><br><span class="line">1990</span><br><span class="line">1991</span><br><span class="line">1992</span><br><span class="line">1993</span><br><span class="line">1994</span><br><span class="line">1995</span><br><span class="line">1996</span><br><span class="line">1997</span><br><span class="line">1998</span><br><span class="line">1999</span><br><span class="line">2000</span><br><span class="line">2001</span><br><span class="line">2002</span><br><span class="line">2003</span><br><span class="line">2004</span><br><span class="line">2005</span><br><span class="line">2006</span><br><span class="line">2007</span><br><span class="line">2008</span><br><span class="line">2009</span><br><span class="line">2010</span><br><span class="line">2011</span><br><span class="line">2012</span><br><span class="line">2013</span><br><span class="line">2014</span><br><span class="line">2015</span><br><span class="line">2016</span><br><span class="line">2017</span><br><span class="line">2018</span><br><span class="line">2019</span><br><span class="line">2020</span><br><span class="line">2021</span><br><span class="line">2022</span><br><span class="line">2023</span><br><span class="line">2024</span><br><span class="line">2025</span><br><span class="line">2026</span><br><span class="line">2027</span><br><span class="line">2028</span><br><span class="line">2029</span><br><span class="line">2030</span><br><span class="line">2031</span><br><span class="line">2032</span><br><span class="line">2033</span><br><span class="line">2034</span><br><span class="line">2035</span><br><span class="line">2036</span><br><span class="line">2037</span><br><span class="line">2038</span><br><span class="line">2039</span><br><span class="line">2040</span><br><span class="line">2041</span><br><span class="line">2042</span><br><span class="line">2043</span><br><span class="line">2044</span><br><span class="line">2045</span><br><span class="line">2046</span><br><span class="line">2047</span><br><span class="line">2048</span><br><span class="line">2049</span><br><span class="line">2050</span><br><span class="line">2051</span><br><span class="line">2052</span><br><span class="line">2053</span><br><span class="line">2054</span><br><span class="line">2055</span><br><span class="line">2056</span><br><span class="line">2057</span><br><span class="line">2058</span><br><span class="line">2059</span><br><span class="line">2060</span><br><span class="line">2061</span><br><span class="line">2062</span><br><span class="line">2063</span><br><span class="line">2064</span><br><span class="line">2065</span><br><span class="line">2066</span><br><span class="line">2067</span><br><span class="line">2068</span><br><span class="line">2069</span><br><span class="line">2070</span><br><span class="line">2071</span><br><span class="line">2072</span><br><span class="line">2073</span><br><span class="line">2074</span><br><span class="line">2075</span><br><span class="line">2076</span><br><span class="line">2077</span><br><span class="line">2078</span><br><span class="line">2079</span><br><span class="line">2080</span><br><span class="line">2081</span><br><span class="line">2082</span><br><span class="line">2083</span><br><span class="line">2084</span><br><span class="line">2085</span><br><span class="line">2086</span><br><span class="line">2087</span><br><span class="line">2088</span><br><span class="line">2089</span><br><span class="line">2090</span><br><span class="line">2091</span><br><span class="line">2092</span><br><span class="line">2093</span><br><span class="line">2094</span><br><span class="line">2095</span><br><span class="line">2096</span><br><span class="line">2097</span><br><span class="line">2098</span><br><span class="line">2099</span><br><span class="line">2100</span><br><span class="line">2101</span><br><span class="line">2102</span><br><span class="line">2103</span><br><span class="line">2104</span><br><span class="line">2105</span><br><span class="line">2106</span><br><span class="line">2107</span><br><span class="line">2108</span><br><span class="line">2109</span><br><span class="line">2110</span><br><span class="line">2111</span><br><span class="line">2112</span><br><span class="line">2113</span><br><span class="line">2114</span><br><span class="line">2115</span><br><span class="line">2116</span><br><span class="line">2117</span><br><span class="line">2118</span><br><span class="line">2119</span><br><span class="line">2120</span><br><span class="line">2121</span><br><span class="line">2122</span><br><span class="line">2123</span><br><span class="line">2124</span><br><span class="line">2125</span><br><span class="line">2126</span><br><span class="line">2127</span><br><span class="line">2128</span><br><span class="line">2129</span><br><span class="line">2130</span><br><span class="line">2131</span><br><span class="line">2132</span><br><span class="line">2133</span><br><span class="line">2134</span><br><span class="line">2135</span><br><span class="line">2136</span><br><span class="line">2137</span><br><span class="line">2138</span><br><span class="line">2139</span><br><span class="line">2140</span><br><span class="line">2141</span><br><span class="line">2142</span><br><span class="line">2143</span><br><span class="line">2144</span><br><span class="line">2145</span><br><span class="line">2146</span><br><span class="line">2147</span><br><span class="line">2148</span><br><span class="line">2149</span><br><span class="line">2150</span><br><span class="line">2151</span><br><span class="line">2152</span><br><span class="line">2153</span><br><span class="line">2154</span><br><span class="line">2155</span><br><span class="line">2156</span><br><span class="line">2157</span><br><span class="line">2158</span><br><span class="line">2159</span><br><span class="line">2160</span><br><span class="line">2161</span><br><span class="line">2162</span><br><span class="line">2163</span><br><span class="line">2164</span><br><span class="line">2165</span><br><span class="line">2166</span><br><span class="line">2167</span><br><span class="line">2168</span><br><span class="line">2169</span><br><span class="line">2170</span><br><span class="line">2171</span><br><span class="line">2172</span><br><span class="line">2173</span><br><span class="line">2174</span><br><span class="line">2175</span><br><span class="line">2176</span><br><span class="line">2177</span><br><span class="line">2178</span><br><span class="line">2179</span><br><span class="line">2180</span><br><span class="line">2181</span><br><span class="line">2182</span><br><span class="line">2183</span><br><span class="line">2184</span><br><span class="line">2185</span><br><span class="line">2186</span><br><span class="line">2187</span><br><span class="line">2188</span><br><span class="line">2189</span><br><span class="line">2190</span><br><span class="line">2191</span><br><span class="line">2192</span><br><span class="line">2193</span><br><span class="line">2194</span><br><span class="line">2195</span><br><span class="line">2196</span><br><span class="line">2197</span><br><span class="line">2198</span><br><span class="line">2199</span><br><span class="line">2200</span><br><span class="line">2201</span><br><span class="line">2202</span><br><span class="line">2203</span><br><span class="line">2204</span><br><span class="line">2205</span><br><span class="line">2206</span><br><span class="line">2207</span><br><span class="line">2208</span><br><span class="line">2209</span><br><span class="line">2210</span><br><span class="line">2211</span><br><span class="line">2212</span><br><span class="line">2213</span><br><span class="line">2214</span><br><span class="line">2215</span><br><span class="line">2216</span><br><span class="line">2217</span><br><span class="line">2218</span><br><span class="line">2219</span><br><span class="line">2220</span><br><span class="line">2221</span><br><span class="line">2222</span><br><span class="line">2223</span><br><span class="line">2224</span><br><span class="line">2225</span><br><span class="line">2226</span><br><span class="line">2227</span><br><span class="line">2228</span><br><span class="line">2229</span><br><span class="line">2230</span><br><span class="line">2231</span><br><span class="line">2232</span><br><span class="line">2233</span><br><span class="line">2234</span><br><span class="line">2235</span><br><span class="line">2236</span><br><span class="line">2237</span><br><span class="line">2238</span><br><span class="line">2239</span><br><span class="line">2240</span><br><span class="line">2241</span><br><span class="line">2242</span><br><span class="line">2243</span><br><span class="line">2244</span><br><span class="line">2245</span><br><span class="line">2246</span><br><span class="line">2247</span><br><span class="line">2248</span><br><span class="line">2249</span><br><span class="line">2250</span><br><span class="line">2251</span><br><span class="line">2252</span><br><span class="line">2253</span><br><span class="line">2254</span><br><span class="line">2255</span><br><span class="line">2256</span><br><span class="line">2257</span><br><span class="line">2258</span><br><span class="line">2259</span><br><span class="line">2260</span><br><span class="line">2261</span><br><span class="line">2262</span><br><span class="line">2263</span><br><span class="line">2264</span><br><span class="line">2265</span><br><span class="line">2266</span><br><span class="line">2267</span><br><span class="line">2268</span><br><span class="line">2269</span><br><span class="line">2270</span><br><span class="line">2271</span><br><span class="line">2272</span><br><span class="line">2273</span><br><span class="line">2274</span><br><span class="line">2275</span><br><span class="line">2276</span><br><span class="line">2277</span><br><span class="line">2278</span><br><span class="line">2279</span><br><span class="line">2280</span><br><span class="line">2281</span><br><span class="line">2282</span><br><span class="line">2283</span><br><span class="line">2284</span><br><span class="line">2285</span><br><span class="line">2286</span><br><span class="line">2287</span><br><span class="line">2288</span><br><span class="line">2289</span><br><span class="line">2290</span><br><span class="line">2291</span><br><span class="line">2292</span><br><span class="line">2293</span><br><span class="line">2294</span><br><span class="line">2295</span><br><span class="line">2296</span><br><span class="line">2297</span><br><span class="line">2298</span><br><span class="line">2299</span><br><span class="line">2300</span><br><span class="line">2301</span><br><span class="line">2302</span><br><span class="line">2303</span><br><span class="line">2304</span><br><span class="line">2305</span><br><span class="line">2306</span><br><span class="line">2307</span><br><span class="line">2308</span><br><span class="line">2309</span><br><span class="line">2310</span><br><span class="line">2311</span><br><span class="line">2312</span><br><span class="line">2313</span><br><span class="line">2314</span><br><span class="line">2315</span><br><span class="line">2316</span><br><span class="line">2317</span><br><span class="line">2318</span><br><span class="line">2319</span><br><span class="line">2320</span><br><span class="line">2321</span><br><span class="line">2322</span><br><span class="line">2323</span><br><span class="line">2324</span><br><span class="line">2325</span><br><span class="line">2326</span><br><span class="line">2327</span><br><span class="line">2328</span><br><span class="line">2329</span><br><span class="line">2330</span><br><span class="line">2331</span><br><span class="line">2332</span><br><span class="line">2333</span><br><span class="line">2334</span><br><span class="line">2335</span><br><span class="line">2336</span><br><span class="line">2337</span><br><span class="line">2338</span><br><span class="line">2339</span><br><span class="line">2340</span><br><span class="line">2341</span><br><span class="line">2342</span><br><span class="line">2343</span><br><span class="line">2344</span><br><span class="line">2345</span><br><span class="line">2346</span><br><span class="line">2347</span><br><span class="line">2348</span><br><span class="line">2349</span><br><span class="line">2350</span><br><span class="line">2351</span><br><span class="line">2352</span><br><span class="line">2353</span><br><span class="line">2354</span><br><span class="line">2355</span><br><span class="line">2356</span><br><span class="line">2357</span><br><span class="line">2358</span><br><span class="line">2359</span><br><span class="line">2360</span><br><span class="line">2361</span><br><span class="line">2362</span><br><span class="line">2363</span><br><span class="line">2364</span><br><span class="line">2365</span><br><span class="line">2366</span><br><span class="line">2367</span><br><span class="line">2368</span><br><span class="line">2369</span><br><span class="line">2370</span><br><span class="line">2371</span><br><span class="line">2372</span><br><span class="line">2373</span><br><span class="line">2374</span><br><span class="line">2375</span><br><span class="line">2376</span><br><span class="line">2377</span><br><span class="line">2378</span><br><span class="line">2379</span><br><span class="line">2380</span><br><span class="line">2381</span><br><span class="line">2382</span><br><span class="line">2383</span><br><span class="line">2384</span><br><span class="line">2385</span><br><span class="line">2386</span><br><span class="line">2387</span><br><span class="line">2388</span><br><span class="line">2389</span><br><span class="line">2390</span><br><span class="line">2391</span><br><span class="line">2392</span><br><span class="line">2393</span><br><span class="line">2394</span><br><span class="line">2395</span><br><span class="line">2396</span><br><span class="line">2397</span><br><span class="line">2398</span><br><span class="line">2399</span><br><span class="line">2400</span><br><span class="line">2401</span><br><span class="line">2402</span><br><span class="line">2403</span><br><span class="line">2404</span><br><span class="line">2405</span><br><span class="line">2406</span><br><span class="line">2407</span><br><span class="line">2408</span><br><span class="line">2409</span><br><span class="line">2410</span><br><span class="line">2411</span><br><span class="line">2412</span><br><span class="line">2413</span><br><span class="line">2414</span><br><span class="line">2415</span><br><span class="line">2416</span><br><span class="line">2417</span><br><span class="line">2418</span><br><span class="line">2419</span><br><span class="line">2420</span><br><span class="line">2421</span><br><span class="line">2422</span><br><span class="line">2423</span><br><span class="line">2424</span><br><span class="line">2425</span><br><span class="line">2426</span><br><span class="line">2427</span><br><span class="line">2428</span><br><span class="line">2429</span><br><span class="line">2430</span><br><span class="line">2431</span><br><span class="line">2432</span><br><span class="line">2433</span><br><span class="line">2434</span><br><span class="line">2435</span><br><span class="line">2436</span><br><span class="line">2437</span><br><span class="line">2438</span><br><span class="line">2439</span><br><span class="line">2440</span><br><span class="line">2441</span><br><span class="line">2442</span><br><span class="line">2443</span><br><span class="line">2444</span><br><span class="line">2445</span><br><span class="line">2446</span><br><span class="line">2447</span><br><span class="line">2448</span><br><span class="line">2449</span><br><span class="line">2450</span><br><span class="line">2451</span><br><span class="line">2452</span><br><span class="line">2453</span><br><span class="line">2454</span><br><span class="line">2455</span><br><span class="line">2456</span><br><span class="line">2457</span><br><span class="line">2458</span><br><span class="line">2459</span><br><span class="line">2460</span><br><span class="line">2461</span><br><span class="line">2462</span><br><span class="line">2463</span><br><span class="line">2464</span><br><span class="line">2465</span><br><span class="line">2466</span><br><span class="line">2467</span><br><span class="line">2468</span><br><span class="line">2469</span><br><span class="line">2470</span><br><span class="line">2471</span><br><span class="line">2472</span><br><span class="line">2473</span><br><span class="line">2474</span><br><span class="line">2475</span><br><span class="line">2476</span><br><span class="line">2477</span><br><span class="line">2478</span><br><span class="line">2479</span><br><span class="line">2480</span><br><span class="line">2481</span><br><span class="line">2482</span><br><span class="line">2483</span><br><span class="line">2484</span><br><span class="line">2485</span><br><span class="line">2486</span><br><span class="line">2487</span><br><span class="line">2488</span><br><span class="line">2489</span><br><span class="line">2490</span><br><span class="line">2491</span><br><span class="line">2492</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">general:</span></span><br><span class="line">  <span class="comment"># Debug mode, only for development. Is overwritten by $&#123;SEARXNG_DEBUG&#125;</span></span><br><span class="line">  <span class="attr">debug:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># displayed name</span></span><br><span class="line">  <span class="attr">instance_name:</span> <span class="string">&quot;searxng&quot;</span></span><br><span class="line">  <span class="comment"># For example: https://example.com/privacy</span></span><br><span class="line">  <span class="attr">privacypolicy_url:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># use true to use your own donation page written in searx/info/en/donate.md</span></span><br><span class="line">  <span class="comment"># use false to disable the donation link</span></span><br><span class="line">  <span class="attr">donation_url:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># mailto:contact@example.com</span></span><br><span class="line">  <span class="attr">contact_url:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># record stats</span></span><br><span class="line">  <span class="attr">enable_metrics:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="attr">brand:</span></span><br><span class="line">  <span class="attr">new_issue_url:</span> <span class="string">https://github.com/searxng/searxng/issues/new</span></span><br><span class="line">  <span class="attr">docs_url:</span> <span class="string">https://docs.searxng.org/</span></span><br><span class="line">  <span class="attr">public_instances:</span> <span class="string">https://searx.space</span></span><br><span class="line">  <span class="attr">wiki_url:</span> <span class="string">https://github.com/searxng/searxng/wiki</span></span><br><span class="line">  <span class="attr">issue_url:</span> <span class="string">https://github.com/searxng/searxng/issues</span></span><br><span class="line">  <span class="comment"># custom:</span></span><br><span class="line">  <span class="comment">#   maintainer: &quot;Jon Doe&quot;</span></span><br><span class="line">  <span class="comment">#   # Custom entries in the footer: [title]: [link]</span></span><br><span class="line">  <span class="comment">#   links:</span></span><br><span class="line">  <span class="comment">#     Uptime: https://uptime.searxng.org/history/darmarit-org</span></span><br><span class="line">  <span class="comment">#     About: &quot;https://searxng.org&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">search:</span></span><br><span class="line">  <span class="comment"># Filter results. 0: None, 1: Moderate, 2: Strict</span></span><br><span class="line">  <span class="attr">safe_search:</span> <span class="number">1</span></span><br><span class="line">  <span class="comment"># Existing autocomplete backends: &quot;dbpedia&quot;, &quot;duckduckgo&quot;, &quot;google&quot;, &quot;yandex&quot;, &quot;mwmbl&quot;,</span></span><br><span class="line">  <span class="comment"># &quot;seznam&quot;, &quot;startpage&quot;, &quot;stract&quot;, &quot;swisscows&quot;, &quot;qwant&quot;, &quot;wikipedia&quot; - leave blank to turn it off</span></span><br><span class="line">  <span class="comment"># by default.</span></span><br><span class="line">  <span class="attr">autocomplete:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="comment"># minimun characters to type before autocompleter starts</span></span><br><span class="line">  <span class="attr">autocomplete_min:</span> <span class="number">4</span></span><br><span class="line">  <span class="comment"># Default search language - leave blank to detect from browser information or</span></span><br><span class="line">  <span class="comment"># use codes from &#x27;languages.py&#x27;</span></span><br><span class="line">  <span class="attr">default_lang:</span> <span class="string">&quot;auto&quot;</span></span><br><span class="line">  <span class="comment"># max_page: 0  # if engine supports paging, 0 means unlimited numbers of pages</span></span><br><span class="line">  <span class="comment"># Available languages</span></span><br><span class="line">  <span class="comment"># languages:</span></span><br><span class="line">  <span class="comment">#   - all</span></span><br><span class="line">  <span class="comment">#   - en</span></span><br><span class="line">  <span class="comment">#   - en-US</span></span><br><span class="line">  <span class="comment">#   - de</span></span><br><span class="line">  <span class="comment">#   - it-IT</span></span><br><span class="line">  <span class="comment">#   - fr</span></span><br><span class="line">  <span class="comment">#   - fr-BE</span></span><br><span class="line">  <span class="comment"># ban time in seconds after engine errors</span></span><br><span class="line">  <span class="attr">ban_time_on_fail:</span> <span class="number">5</span></span><br><span class="line">  <span class="comment"># max ban time in seconds after engine errors</span></span><br><span class="line">  <span class="attr">max_ban_time_on_fail:</span> <span class="number">120</span></span><br><span class="line">  <span class="attr">suspended_times:</span></span><br><span class="line">    <span class="comment"># Engine suspension time after error (in seconds; set to 0 to disable)</span></span><br><span class="line">    <span class="comment"># For error &quot;Access denied&quot; and &quot;HTTP error [402, 403]&quot;</span></span><br><span class="line">    <span class="attr">SearxEngineAccessDenied:</span> <span class="number">86400</span></span><br><span class="line">    <span class="comment"># For error &quot;CAPTCHA&quot;</span></span><br><span class="line">    <span class="attr">SearxEngineCaptcha:</span> <span class="number">86400</span></span><br><span class="line">    <span class="comment"># For error &quot;Too many request&quot; and &quot;HTTP error 429&quot;</span></span><br><span class="line">    <span class="attr">SearxEngineTooManyRequests:</span> <span class="number">3600</span></span><br><span class="line">    <span class="comment"># Cloudflare CAPTCHA</span></span><br><span class="line">    <span class="attr">cf_SearxEngineCaptcha:</span> <span class="number">1296000</span></span><br><span class="line">    <span class="attr">cf_SearxEngineAccessDenied:</span> <span class="number">86400</span></span><br><span class="line">    <span class="comment"># ReCAPTCHA</span></span><br><span class="line">    <span class="attr">recaptcha_SearxEngineCaptcha:</span> <span class="number">604800</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># remove format to deny access, use lower case.</span></span><br><span class="line">  <span class="comment"># formats: [html, csv, json, rss]</span></span><br><span class="line">  <span class="attr">formats:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">html</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">json</span></span><br><span class="line"></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="comment"># Is overwritten by $&#123;SEARXNG_PORT&#125; and $&#123;SEARXNG_BIND_ADDRESS&#125;</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8888</span></span><br><span class="line">  <span class="attr">bind_address:</span> <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">  <span class="comment"># public URL of the instance, to ensure correct inbound links. Is overwritten</span></span><br><span class="line">  <span class="comment"># by $&#123;SEARXNG_URL&#125;.</span></span><br><span class="line">  <span class="attr">base_url:</span> <span class="string">/</span>  <span class="comment"># &quot;http://example.com/location&quot;</span></span><br><span class="line">  <span class="comment"># rate limit the number of request on the instance, block some bots.</span></span><br><span class="line">  <span class="comment"># Is overwritten by $&#123;SEARXNG_LIMITER&#125;</span></span><br><span class="line">  <span class="attr">limiter:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># enable features designed only for public instances.</span></span><br><span class="line">  <span class="comment"># Is overwritten by $&#123;SEARXNG_PUBLIC_INSTANCE&#125;</span></span><br><span class="line">  <span class="attr">public_instance:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># If your instance owns a /etc/searxng/settings.yml file, then set the following</span></span><br><span class="line">  <span class="comment"># values there.</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">secret_key:</span> <span class="string">&quot;09fdb393fba89866f4b3ed5ed4a13c735c9f8cb83947f31b0a306f3fa21f62c2&quot;</span>  <span class="comment"># Is overwritten by $&#123;SEARXNG_SECRET&#125;</span></span><br><span class="line">  <span class="comment"># Proxy image results through SearXNG. Is overwritten by $&#123;SEARXNG_IMAGE_PROXY&#125;</span></span><br><span class="line">  <span class="attr">image_proxy:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># 1.0 and 1.1 are supported</span></span><br><span class="line">  <span class="attr">http_protocol_version:</span> <span class="string">&quot;1.0&quot;</span></span><br><span class="line">  <span class="comment"># POST queries are more secure as they don&#x27;t show up in history but may cause</span></span><br><span class="line">  <span class="comment"># problems when using Firefox containers</span></span><br><span class="line">  <span class="attr">method:</span> <span class="string">&quot;POST&quot;</span></span><br><span class="line">  <span class="attr">default_http_headers:</span></span><br><span class="line">    <span class="attr">X-Content-Type-Options:</span> <span class="string">nosniff</span></span><br><span class="line">    <span class="attr">X-Download-Options:</span> <span class="string">noopen</span></span><br><span class="line">    <span class="attr">X-Robots-Tag:</span> <span class="string">noindex,</span> <span class="string">nofollow</span></span><br><span class="line">    <span class="attr">Referrer-Policy:</span> <span class="literal">no</span><span class="string">-referrer</span></span><br><span class="line"></span><br><span class="line"><span class="attr">redis:</span></span><br><span class="line">  <span class="comment"># URL to connect redis database. Is overwritten by $&#123;SEARXNG_REDIS_URL&#125;.</span></span><br><span class="line">  <span class="comment"># https://docs.searxng.org/admin/settings/settings_redis.html#settings-redis</span></span><br><span class="line">  <span class="attr">url:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">ui:</span></span><br><span class="line">  <span class="comment"># Custom static path - leave it blank if you didn&#x27;t change</span></span><br><span class="line">  <span class="attr">static_path:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="comment"># Is overwritten by $&#123;SEARXNG_STATIC_USE_HASH&#125;.</span></span><br><span class="line">  <span class="attr">static_use_hash:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># Custom templates path - leave it blank if you didn&#x27;t change</span></span><br><span class="line">  <span class="attr">templates_path:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="comment"># query_in_title: When true, the result page&#x27;s titles contains the query</span></span><br><span class="line">  <span class="comment"># it decreases the privacy, since the browser can records the page titles.</span></span><br><span class="line">  <span class="attr">query_in_title:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># infinite_scroll: When true, automatically loads the next page when scrolling to bottom of the current page.</span></span><br><span class="line">  <span class="attr">infinite_scroll:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># ui theme</span></span><br><span class="line">  <span class="attr">default_theme:</span> <span class="string">simple</span></span><br><span class="line">  <span class="comment"># center the results ?</span></span><br><span class="line">  <span class="attr">center_alignment:</span> <span class="literal">false</span></span><br><span class="line">  <span class="comment"># URL prefix of the internet archive, don&#x27;t forget trailing slash (if needed).</span></span><br><span class="line">  <span class="comment"># cache_url: &quot;https://webcache.googleusercontent.com/search?q=cache:&quot;</span></span><br><span class="line">  <span class="comment"># Default interface locale - leave blank to detect from browser information or</span></span><br><span class="line">  <span class="comment"># use codes from the &#x27;locales&#x27; config section</span></span><br><span class="line">  <span class="attr">default_locale:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="comment"># Open result links in a new tab by default</span></span><br><span class="line">  <span class="comment"># results_on_new_tab: false</span></span><br><span class="line">  <span class="attr">theme_args:</span></span><br><span class="line">    <span class="comment"># style of simple theme: auto, light, dark</span></span><br><span class="line">    <span class="attr">simple_style:</span> <span class="string">auto</span></span><br><span class="line">  <span class="comment"># Perform search immediately if a category selected.</span></span><br><span class="line">  <span class="comment"># Disable to select multiple categories at once and start the search manually.</span></span><br><span class="line">  <span class="attr">search_on_category_select:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># Hotkeys: default or vim</span></span><br><span class="line">  <span class="attr">hotkeys:</span> <span class="string">default</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Lock arbitrary settings on the preferences page.  To find the ID of the user</span></span><br><span class="line"><span class="comment"># setting you want to lock, check the ID of the form on the page &quot;preferences&quot;.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># preferences:</span></span><br><span class="line"><span class="comment">#   lock:</span></span><br><span class="line"><span class="comment">#     - language</span></span><br><span class="line"><span class="comment">#     - autocomplete</span></span><br><span class="line"><span class="comment">#     - method</span></span><br><span class="line"><span class="comment">#     - query_in_title</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># searx supports result proxification using an external service:</span></span><br><span class="line"><span class="comment"># https://github.com/asciimoo/morty uncomment below section if you have running</span></span><br><span class="line"><span class="comment"># morty proxy the key is base64 encoded (keep the !!binary notation)</span></span><br><span class="line"><span class="comment"># <span class="doctag">Note:</span> since commit af77ec3, morty accepts a base64 encoded key.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># result_proxy:</span></span><br><span class="line"><span class="comment">#   url: http://127.0.0.1:3000/</span></span><br><span class="line"><span class="comment">#   # the key is a base64 encoded string, the YAML !!binary prefix is optional</span></span><br><span class="line"><span class="comment">#   key: !!binary &quot;your_morty_proxy_key&quot;</span></span><br><span class="line"><span class="comment">#   # [true|false] enable the &quot;proxy&quot; button next to each result</span></span><br><span class="line"><span class="comment">#   proxify_results: true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># communication with search engines</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="attr">outgoing:</span></span><br><span class="line">  <span class="comment"># default timeout in seconds, can be override by engine</span></span><br><span class="line">  <span class="attr">request_timeout:</span> <span class="number">3.0</span></span><br><span class="line">  <span class="comment"># the maximum timeout in seconds</span></span><br><span class="line">  <span class="comment"># max_request_timeout: 10.0</span></span><br><span class="line">  <span class="comment"># suffix of searx_useragent, could contain information like an email address</span></span><br><span class="line">  <span class="comment"># to the administrator</span></span><br><span class="line">  <span class="attr">useragent_suffix:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">  <span class="comment"># The maximum number of concurrent connections that may be established.</span></span><br><span class="line">  <span class="attr">pool_connections:</span> <span class="number">100</span></span><br><span class="line">  <span class="comment"># Allow the connection pool to maintain keep-alive connections below this</span></span><br><span class="line">  <span class="comment"># point.</span></span><br><span class="line">  <span class="attr">pool_maxsize:</span> <span class="number">20</span></span><br><span class="line">  <span class="comment"># See https://www.python-httpx.org/http2/</span></span><br><span class="line">  <span class="attr">enable_http2:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment"># uncomment below section if you want to use a custom server certificate</span></span><br><span class="line">  <span class="comment"># see https://www.python-httpx.org/advanced/#changing-the-verification-defaults</span></span><br><span class="line">  <span class="comment"># and https://www.python-httpx.org/compatibility/#ssl-configuration</span></span><br><span class="line">  <span class="comment">#  verify: ~/.mitmproxy/mitmproxy-ca-cert.cer</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># uncomment below section if you want to use a proxyq see: SOCKS proxies</span></span><br><span class="line">  <span class="comment">#   https://2.python-requests.org/en/latest/user/advanced/#proxies</span></span><br><span class="line">  <span class="comment"># are also supported: see</span></span><br><span class="line">  <span class="comment">#   https://2.python-requests.org/en/latest/user/advanced/#socks</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  proxies:</span></span><br><span class="line">  <span class="comment">#    all://:</span></span><br><span class="line">  <span class="comment">#      - http://proxy1:8080</span></span><br><span class="line">  <span class="comment">#      - http://proxy2:8080</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  using_tor_proxy: true</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># Extra seconds to add in order to account for the time taken by the proxy</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  extra_proxy_timeout: 10</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># uncomment below section only if you have more than one network interface</span></span><br><span class="line">  <span class="comment"># which can be the source of outgoing search requests</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment">#  source_ips:</span></span><br><span class="line">  <span class="comment">#    - 1.1.1.1</span></span><br><span class="line">  <span class="comment">#    - 1.1.1.2</span></span><br><span class="line">  <span class="comment">#    - fe80::/126</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># External plugin configuration, for more details see</span></span><br><span class="line"><span class="comment">#   https://docs.searxng.org/dev/plugins.html</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># plugins:</span></span><br><span class="line"><span class="comment">#   - plugin1</span></span><br><span class="line"><span class="comment">#   - plugin2</span></span><br><span class="line"><span class="comment">#   - ...</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Comment or un-comment plugin to activate / deactivate by default.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># enabled_plugins:</span></span><br><span class="line"><span class="comment">#   # these plugins are enabled if nothing is configured ..</span></span><br><span class="line"><span class="comment">#   - &#x27;Basic Calculator&#x27;</span></span><br><span class="line"><span class="comment">#   - &#x27;Hash plugin&#x27;</span></span><br><span class="line"><span class="comment">#   - &#x27;Self Information&#x27;</span></span><br><span class="line"><span class="comment">#   - &#x27;Tracker URL remover&#x27;</span></span><br><span class="line"><span class="comment">#   - &#x27;Ahmia blacklist&#x27;  # activation depends on outgoing.using_tor_proxy</span></span><br><span class="line"><span class="comment">#   # these plugins are disabled if nothing is configured ..</span></span><br><span class="line"><span class="comment">#   - &#x27;Hostnames plugin&#x27;  # see &#x27;hostnames&#x27; configuration below</span></span><br><span class="line"><span class="comment">#   - &#x27;Open Access DOI rewrite&#x27;</span></span><br><span class="line"><span class="comment">#   - &#x27;Tor check plugin&#x27;</span></span><br><span class="line"><span class="comment">#   # Read the docs before activate: auto-detection of the language could be</span></span><br><span class="line"><span class="comment">#   # detrimental to users expectations / users can activate the plugin in the</span></span><br><span class="line"><span class="comment">#   # preferences if they want.</span></span><br><span class="line"><span class="comment">#   - &#x27;Autodetect search language&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Configuration of the &quot;Hostnames plugin&quot;:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># hostnames:</span></span><br><span class="line"><span class="comment">#   replace:</span></span><br><span class="line"><span class="comment">#     &#x27;(.*\.)?youtube\.com$&#x27;: &#x27;invidious.example.com&#x27;</span></span><br><span class="line"><span class="comment">#     &#x27;(.*\.)?youtu\.be$&#x27;: &#x27;invidious.example.com&#x27;</span></span><br><span class="line"><span class="comment">#     &#x27;(.*\.)?reddit\.com$&#x27;: &#x27;teddit.example.com&#x27;</span></span><br><span class="line"><span class="comment">#     &#x27;(.*\.)?redd\.it$&#x27;: &#x27;teddit.example.com&#x27;</span></span><br><span class="line"><span class="comment">#     &#x27;(www\.)?twitter\.com$&#x27;: &#x27;nitter.example.com&#x27;</span></span><br><span class="line"><span class="comment">#   remove:</span></span><br><span class="line"><span class="comment">#     - &#x27;(.*\.)?facebook.com$&#x27;</span></span><br><span class="line"><span class="comment">#   low_priority:</span></span><br><span class="line"><span class="comment">#     - &#x27;(.*\.)?google(\..*)?$&#x27;</span></span><br><span class="line"><span class="comment">#   high_priority:</span></span><br><span class="line"><span class="comment">#     - &#x27;(.*\.)?wikipedia.org$&#x27;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Alternatively you can use external files for configuring the &quot;Hostnames plugin&quot;:</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># hostnames:</span></span><br><span class="line"><span class="comment">#  replace: &#x27;rewrite-hosts.yml&#x27;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Content of &#x27;rewrite-hosts.yml&#x27; (place the file in the same directory as &#x27;settings.yml&#x27;):</span></span><br><span class="line"><span class="comment"># &#x27;(.*\.)?youtube\.com$&#x27;: &#x27;invidious.example.com&#x27;</span></span><br><span class="line"><span class="comment"># &#x27;(.*\.)?youtu\.be$&#x27;: &#x27;invidious.example.com&#x27;</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"></span><br><span class="line"><span class="attr">checker:</span></span><br><span class="line">  <span class="comment"># disable checker when in debug mode</span></span><br><span class="line">  <span class="attr">off_when_debug:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># use &quot;scheduling: false&quot; to disable scheduling</span></span><br><span class="line">  <span class="comment"># scheduling: interval or int</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># to activate the scheduler:</span></span><br><span class="line">  <span class="comment"># * uncomment &quot;scheduling&quot; section</span></span><br><span class="line">  <span class="comment"># * add &quot;cache2 = name=searxngcache,items=2000,blocks=2000,blocksize=4096,bitmap=1&quot;</span></span><br><span class="line">  <span class="comment">#   to your uwsgi.ini</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># scheduling:</span></span><br><span class="line">  <span class="comment">#   start_after: [300, 1800]  # delay to start the first run of the checker</span></span><br><span class="line">  <span class="comment">#   every: [86400, 90000]     # how often the checker runs</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># additional tests: only for the YAML anchors (see the engines section)</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="attr">additional_tests:</span></span><br><span class="line">    <span class="attr">rosebud:</span> <span class="meta">&amp;test_rosebud</span></span><br><span class="line">      <span class="attr">matrix:</span></span><br><span class="line">        <span class="attr">query:</span> <span class="string">rosebud</span></span><br><span class="line">        <span class="attr">lang:</span> <span class="string">en</span></span><br><span class="line">      <span class="attr">result_container:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">not_empty</span></span><br><span class="line">        <span class="bullet">-</span> [<span class="string">&#x27;one_title_contains&#x27;</span>, <span class="string">&#x27;citizen kane&#x27;</span>]</span><br><span class="line">      <span class="attr">test:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">unique_results</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">android:</span> <span class="meta">&amp;test_android</span></span><br><span class="line">      <span class="attr">matrix:</span></span><br><span class="line">        <span class="attr">query:</span> [<span class="string">&#x27;android&#x27;</span>]</span><br><span class="line">        <span class="attr">lang:</span> [<span class="string">&#x27;en&#x27;</span>, <span class="string">&#x27;de&#x27;</span>, <span class="string">&#x27;fr&#x27;</span>, <span class="string">&#x27;zh-CN&#x27;</span>]</span><br><span class="line">      <span class="attr">result_container:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">not_empty</span></span><br><span class="line">        <span class="bullet">-</span> [<span class="string">&#x27;one_title_contains&#x27;</span>, <span class="string">&#x27;google&#x27;</span>]</span><br><span class="line">      <span class="attr">test:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">unique_results</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># tests: only for the YAML anchors (see the engines section)</span></span><br><span class="line">  <span class="attr">tests:</span></span><br><span class="line">    <span class="attr">infobox:</span> <span class="meta">&amp;tests_infobox</span></span><br><span class="line">      <span class="attr">infobox:</span></span><br><span class="line">        <span class="attr">matrix:</span></span><br><span class="line">          <span class="attr">query:</span> [<span class="string">&quot;linux&quot;</span>, <span class="string">&quot;new york&quot;</span>, <span class="string">&quot;bbc&quot;</span>]</span><br><span class="line">        <span class="attr">result_container:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">has_infobox</span></span><br><span class="line"></span><br><span class="line"><span class="attr">categories_as_tabs:</span></span><br><span class="line">  <span class="attr">general:</span></span><br><span class="line">  <span class="attr">images:</span></span><br><span class="line">  <span class="attr">videos:</span></span><br><span class="line">  <span class="attr">news:</span></span><br><span class="line">  <span class="attr">map:</span></span><br><span class="line">  <span class="attr">music:</span></span><br><span class="line">  <span class="attr">it:</span></span><br><span class="line">  <span class="attr">science:</span></span><br><span class="line">  <span class="attr">files:</span></span><br><span class="line">  <span class="attr">social media:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">engines:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">9gag</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">9gag</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">9g</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">alpine</span> <span class="string">linux</span> <span class="string">packages</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">alpinelinux</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">alp</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">annas</span> <span class="string">archive</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">annas_archive</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">aa</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: annas articles</span></span><br><span class="line">  <span class="comment">#   engine: annas_archive</span></span><br><span class="line">  <span class="comment">#   shortcut: aaa</span></span><br><span class="line">  <span class="comment">#   # https://docs.searxng.org/dev/engines/online/annas_archive.html</span></span><br><span class="line">  <span class="comment">#   aa_content: &#x27;magazine&#x27; # book_fiction, book_unknown, book_nonfiction, book_comic</span></span><br><span class="line">  <span class="comment">#   aa_ext: &#x27;pdf&#x27;  # pdf, epub, ..</span></span><br><span class="line">  <span class="comment">#   aa_sort: oldest&#x27;  # newest, oldest, largest, smallest</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">apk</span> <span class="string">mirror</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">apkmirror</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">apkm</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">apple</span> <span class="string">app</span> <span class="string">store</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">apple_app_store</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">aps</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Requires Tor</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ahmia</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">ahmia</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">onions</span></span><br><span class="line">    <span class="attr">enable_http:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ah</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">anaconda</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">first_page_num:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://anaconda.org/search?q=&#123;query&#125;&amp;page=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">//tbody/tr</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">./td/h5/a[last()]/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">./td/h5</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">./td[h5]/text()</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">it</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">6.0</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">conda</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">arch</span> <span class="string">linux</span> <span class="string">wiki</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">archlinux</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">al</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">artic</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">artic</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">arc</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">arxiv</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">arxiv</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">arx</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ask</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">ask</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ask</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># tmp suspended:  dh key too small</span></span><br><span class="line">  <span class="comment"># - name: base</span></span><br><span class="line">  <span class="comment">#   engine: base</span></span><br><span class="line">  <span class="comment">#   shortcut: bs</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bandcamp</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">bandcamp</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">bc</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">music</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikipedia</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wikipedia</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wp</span></span><br><span class="line">    <span class="comment"># add &quot;list&quot; to the array to get results in the results list</span></span><br><span class="line">    <span class="attr">display_type:</span> [<span class="string">&quot;infobox&quot;</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&#x27;https://&#123;language&#125;.wikipedia.org/&#x27;</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>]</span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bilibili</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">bilibili</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">bil</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bing</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">bing</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">bi</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bing</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">bing_images</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">bii</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bing</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">bing_news</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">bin</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bing</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">bing_videos</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">biv</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bitbucket</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://bitbucket.org/repo/all/&#123;pageno&#125;?name=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">//article[@class=&quot;repo-summary&quot;]//a[@class=&quot;repo-link&quot;]/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">//article[@class=&quot;repo-summary&quot;]//a[@class=&quot;repo-link&quot;]</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">//article[@class=&quot;repo-summary&quot;]/p</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">repos</span>]</span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">bb</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://bitbucket.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q2493781</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://developer.atlassian.com/bitbucket</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bpb</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">bpb</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">bpb</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">btdigg</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">btdigg</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">bt</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">openverse</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">openverse</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">opv</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">media.ccc.de</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">ccc_media</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">c3tv</span></span><br><span class="line">    <span class="comment"># We don&#x27;t set language: de here because media.ccc.de is not just</span></span><br><span class="line">    <span class="comment"># for a German audience. It contains many English videos and many</span></span><br><span class="line">    <span class="comment"># German videos have English subtitles.</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">chefkoch</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">chefkoch</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">chef</span></span><br><span class="line">    <span class="comment"># to show premium or plus results too:</span></span><br><span class="line">    <span class="comment"># skip_premium: false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cloudflareai</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">cloudflareai</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">cfai</span></span><br><span class="line">    <span class="comment"># get api token and accont id from https://developers.cloudflare.com/workers-ai/get-started/rest-api/</span></span><br><span class="line">    <span class="attr">cf_account_id:</span> <span class="string">&#x27;your_cf_accout_id&#x27;</span></span><br><span class="line">    <span class="attr">cf_ai_api:</span> <span class="string">&#x27;your_cf_api&#x27;</span></span><br><span class="line">    <span class="comment"># create your ai gateway by https://developers.cloudflare.com/ai-gateway/get-started/creating-gateway/</span></span><br><span class="line">    <span class="attr">cf_ai_gateway:</span> <span class="string">&#x27;your_cf_ai_gateway_name&#x27;</span></span><br><span class="line">    <span class="comment"># find the model name from https://developers.cloudflare.com/workers-ai/models/#text-generation</span></span><br><span class="line">    <span class="attr">cf_ai_model:</span> <span class="string">&#x27;ai_model_name&#x27;</span></span><br><span class="line">    <span class="comment"># custom your preferences</span></span><br><span class="line">    <span class="comment"># cf_ai_model_display_name: &#x27;Cloudflare AI&#x27;</span></span><br><span class="line">    <span class="comment"># cf_ai_model_assistant: &#x27;prompts_for_assistant_role&#x27;</span></span><br><span class="line">    <span class="comment"># cf_ai_model_system: &#x27;prompts_for_system_role&#x27;</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">30</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: core.ac.uk</span></span><br><span class="line">  <span class="comment">#   engine: core</span></span><br><span class="line">  <span class="comment">#   categories: science</span></span><br><span class="line">  <span class="comment">#   shortcut: cor</span></span><br><span class="line">  <span class="comment">#   # get your API key from: https://core.ac.uk/api-keys/register/</span></span><br><span class="line">  <span class="comment">#   api_key: &#x27;unset&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">cppreference</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">cppreference</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">cpp</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">crossref</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">crossref</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">cr</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">30</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">crowdview</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">json_engine</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">cv</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://crowdview-next-js.onrender.com/api/search-v3?query=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">results_query:</span> <span class="string">results</span></span><br><span class="line">    <span class="attr">url_query:</span> <span class="string">link</span></span><br><span class="line">    <span class="attr">title_query:</span> <span class="string">title</span></span><br><span class="line">    <span class="attr">content_query:</span> <span class="string">snippet</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://crowdview.ai/</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yep</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yep</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">yep</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">web</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yep</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yep</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">yepi</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yep</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yep</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">yepn</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">curlie</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">cl</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">lang_all:</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://curlie.org/search?q=&#123;query&#125;&amp;lang=&#123;lang&#125;&amp;start=&#123;pageno&#125;&amp;stime=92452189</span></span><br><span class="line">    <span class="attr">page_size:</span> <span class="number">20</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">//div[@id=&quot;site-list-content&quot;]/div[@class=&quot;site-item&quot;]</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">./div[@class=&quot;title-and-desc&quot;]/a/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">./div[@class=&quot;title-and-desc&quot;]/a/div</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">./div[@class=&quot;title-and-desc&quot;]/div[@class=&quot;site-descr&quot;]</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://curlie.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q60715723</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">currency</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">currency_convert</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">cc</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">deezer</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">deezer</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">dz</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">destatis</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">destatis</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">destat</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">deviantart</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">deviantart</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">da</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ddg</span> <span class="string">definitions</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">duckduckgo_definitions</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ddd</span></span><br><span class="line">    <span class="attr">weight:</span> <span class="number">2</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">tests:</span> <span class="meta">*tests_infobox</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># cloudflare protected</span></span><br><span class="line">  <span class="comment"># - name: digbt</span></span><br><span class="line">  <span class="comment">#   engine: digbt</span></span><br><span class="line">  <span class="comment">#   shortcut: dbt</span></span><br><span class="line">  <span class="comment">#   timeout: 6.0</span></span><br><span class="line">  <span class="comment">#   disabled: true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">docker</span> <span class="string">hub</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">docker_hub</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">dh</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">packages</span>]</span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">encyclosearch</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">json_engine</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">es</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://encyclosearch.org/encyclosphere/search?q=&#123;query&#125;&amp;page=&#123;pageno&#125;&amp;resultsPerPage=15</span></span><br><span class="line">    <span class="attr">results_query:</span> <span class="string">Results</span></span><br><span class="line">    <span class="attr">url_query:</span> <span class="string">SourceURL</span></span><br><span class="line">    <span class="attr">title_query:</span> <span class="string">Title</span></span><br><span class="line">    <span class="attr">content_query:</span> <span class="string">Description</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://encyclosearch.org</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://encyclosearch.org/docs/#/rest-api</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">JSON</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">erowid</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">first_page_num:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">page_size:</span> <span class="number">30</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://www.erowid.org/search.php?q=&#123;query&#125;&amp;s=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">//dl[@class=&quot;results-list&quot;]/dt[@class=&quot;result-title&quot;]/a/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">//dl[@class=&quot;results-list&quot;]/dt[@class=&quot;result-title&quot;]/a/text()</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">//dl[@class=&quot;results-list&quot;]/dd[@class=&quot;result-details&quot;]</span></span><br><span class="line">    <span class="attr">categories:</span> []</span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ew</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.erowid.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q1430691</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: elasticsearch</span></span><br><span class="line">  <span class="comment">#   shortcut: es</span></span><br><span class="line">  <span class="comment">#   engine: elasticsearch</span></span><br><span class="line">  <span class="comment">#   base_url: http://localhost:9200</span></span><br><span class="line">  <span class="comment">#   username: elastic</span></span><br><span class="line">  <span class="comment">#   password: changeme</span></span><br><span class="line">  <span class="comment">#   index: my-index</span></span><br><span class="line">  <span class="comment">#   # available options: match, simple_query_string, term, terms, custom</span></span><br><span class="line">  <span class="comment">#   query_type: match</span></span><br><span class="line">  <span class="comment">#   # if query_type is set to custom, provide your query here</span></span><br><span class="line">  <span class="comment">#   #custom_query_json: &#123;&quot;query&quot;:&#123;&quot;match_all&quot;: &#123;&#125;&#125;&#125;</span></span><br><span class="line">  <span class="comment">#   #show_metadata: false</span></span><br><span class="line">  <span class="comment">#   disabled: true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikidata</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wikidata</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wd</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line">    <span class="attr">weight:</span> <span class="number">2</span></span><br><span class="line">    <span class="comment"># add &quot;list&quot; to the array to get results in the results list</span></span><br><span class="line">    <span class="attr">display_type:</span> [<span class="string">&quot;infobox&quot;</span>]</span><br><span class="line">    <span class="attr">tests:</span> <span class="meta">*tests_infobox</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>]</span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">duckduckgo</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">duckduckgo</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ddg</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">duckduckgo</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">duckduckgo_extra</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">images</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">ddg_category:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ddi</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">duckduckgo</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">duckduckgo_extra</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">videos</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">ddg_category:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ddv</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">duckduckgo</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">duckduckgo_extra</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">news</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">ddg_category:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ddn</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">duckduckgo</span> <span class="string">weather</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">duckduckgo_weather</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ddw</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">apple</span> <span class="string">maps</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">apple_maps</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">apm</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">emojipedia</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">emojipedia</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">em</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">tineye</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">tineye</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">tin</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">9.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">etymonline</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://etymonline.com/search?page=&#123;pageno&#125;&amp;q=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">//a[contains(@class,</span> <span class="string">&quot;word__name--&quot;</span><span class="string">)]/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">//a[contains(@class,</span> <span class="string">&quot;word__name--&quot;</span><span class="string">)]</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">//section[contains(@class,</span> <span class="string">&quot;word__defination&quot;</span><span class="string">)]</span></span><br><span class="line">    <span class="attr">first_page_num:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">et</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">dictionaries</span>]</span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.etymonline.com/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q1188617</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: ebay</span></span><br><span class="line">  <span class="comment">#   engine: ebay</span></span><br><span class="line">  <span class="comment">#   shortcut: eb</span></span><br><span class="line">  <span class="comment">#   base_url: &#x27;https://www.ebay.com&#x27;</span></span><br><span class="line">  <span class="comment">#   disabled: true</span></span><br><span class="line">  <span class="comment">#   timeout: 5</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">1x</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">www1x</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">1x</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">fdroid</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">fdroid</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">fd</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">findthatmeme</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">findthatmeme</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ftm</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">flickr</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">fl</span></span><br><span class="line">    <span class="comment"># You can use the engine using the official stable API, but you need an API</span></span><br><span class="line">    <span class="comment"># key, see: https://www.flickr.com/services/apps/create/</span></span><br><span class="line">    <span class="comment"># engine: flickr</span></span><br><span class="line">    <span class="comment"># api_key: &#x27;apikey&#x27; # required!</span></span><br><span class="line">    <span class="comment"># Or you can use the html non-stable engine, activated by default</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">flickr_noapi</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">free</span> <span class="string">software</span> <span class="string">directory</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">fsd</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">software</span> <span class="string">wikis</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">https://directory.fsf.org/</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">title</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://directory.fsf.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q2470288</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: freesound</span></span><br><span class="line">  <span class="comment">#   engine: freesound</span></span><br><span class="line">  <span class="comment">#   shortcut: fnd</span></span><br><span class="line">  <span class="comment">#   disabled: true</span></span><br><span class="line">  <span class="comment">#   timeout: 15.0</span></span><br><span class="line">  <span class="comment"># API key required, see: https://freesound.org/docs/api/overview.html</span></span><br><span class="line">  <span class="comment">#   api_key: MyAPIkey</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">frinkiac</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">frinkiac</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">frk</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">fyyd</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">fyyd</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">fy</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">8.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">geizhals</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">geizhals</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">geiz</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">genius</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">genius</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">gen</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">gentoo</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ge</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">&quot;it&quot;</span>, <span class="string">&quot;software wikis&quot;</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&quot;https://wiki.gentoo.org/&quot;</span></span><br><span class="line">    <span class="attr">api_path:</span> <span class="string">&quot;api.php&quot;</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">gitlab</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">gitlab</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">https://gitlab.com</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">gl</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://gitlab.com/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q16639197</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: gnome</span></span><br><span class="line">  <span class="comment">#   engine: gitlab</span></span><br><span class="line">  <span class="comment">#   base_url: https://gitlab.gnome.org</span></span><br><span class="line">  <span class="comment">#   shortcut: gn</span></span><br><span class="line">  <span class="comment">#   about:</span></span><br><span class="line">  <span class="comment">#     website: https://gitlab.gnome.org</span></span><br><span class="line">  <span class="comment">#     wikidata_id: Q44316</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">github</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">github</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">gh</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">codeberg</span></span><br><span class="line">    <span class="comment"># https://docs.searxng.org/dev/engines/online/gitea.html</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">gitea</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">https://codeberg.org</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">cb</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">gitea.com</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">gitea</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">https://gitea.com</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">gitea</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">goodreads</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">goodreads</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">good</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">google</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">google</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">go</span></span><br><span class="line">    <span class="comment"># additional_tests:</span></span><br><span class="line">    <span class="comment">#   android: *test_android</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">google</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">google_images</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">goi</span></span><br><span class="line">    <span class="comment"># additional_tests:</span></span><br><span class="line">    <span class="comment">#   android: *test_android</span></span><br><span class="line">    <span class="comment">#   dali:</span></span><br><span class="line">    <span class="comment">#     matrix:</span></span><br><span class="line">    <span class="comment">#       query: [&#x27;Dali Christ&#x27;]</span></span><br><span class="line">    <span class="comment">#       lang: [&#x27;en&#x27;, &#x27;de&#x27;, &#x27;fr&#x27;, &#x27;zh-CN&#x27;]</span></span><br><span class="line">    <span class="comment">#     result_container:</span></span><br><span class="line">    <span class="comment">#       - [&#x27;one_title_contains&#x27;, &#x27;Salvador&#x27;]</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">google</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">google_news</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">gon</span></span><br><span class="line">    <span class="comment"># additional_tests:</span></span><br><span class="line">    <span class="comment">#   android: *test_android</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">google</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">google_videos</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">gov</span></span><br><span class="line">    <span class="comment"># additional_tests:</span></span><br><span class="line">    <span class="comment">#   android: *test_android</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">google</span> <span class="string">scholar</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">google_scholar</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">gos</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">google</span> <span class="string">play</span> <span class="string">apps</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">google_play</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">files</span>, <span class="string">apps</span>]</span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">gpa</span></span><br><span class="line">    <span class="attr">play_categ:</span> <span class="string">apps</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">google</span> <span class="string">play</span> <span class="string">movies</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">google_play</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">gpm</span></span><br><span class="line">    <span class="attr">play_categ:</span> <span class="string">movies</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">material</span> <span class="string">icons</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">material_icons</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mi</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">habrahabr</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://habr.com/en/search/page&#123;pageno&#125;/?q=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">//article[contains(@class,</span> <span class="string">&quot;tm-articles-list__item&quot;</span><span class="string">)]</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">.//a[@class=&quot;tm-title__link&quot;]/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">.//a[@class=&quot;tm-title__link&quot;]</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">.//div[contains(@class,</span> <span class="string">&quot;article-formatted-body&quot;</span><span class="string">)]</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">it</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">habr</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://habr.com/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q4494434</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://habr.com/en/docs/help/api/</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">hackernews</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">hackernews</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">hn</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">hex</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">hex</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">hex</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># Valid values: name inserted_at updated_at total_downloads recent_downloads</span></span><br><span class="line">    <span class="attr">sort_criteria:</span> <span class="string">&quot;recent_downloads&quot;</span></span><br><span class="line">    <span class="attr">page_size:</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">crates.io</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">crates</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">crates</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">6.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">hoogle</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://hoogle.haskell.org/?hoogle=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">&#x27;//div[@class=&quot;result&quot;]&#x27;</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">&#x27;.//div[@class=&quot;ans&quot;]//a&#x27;</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">&#x27;.//div[@class=&quot;ans&quot;]//a/@href&#x27;</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">&#x27;.//div[@class=&quot;from&quot;]&#x27;</span></span><br><span class="line">    <span class="attr">page_size:</span> <span class="number">20</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">packages</span>]</span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ho</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://hoogle.haskell.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q34010</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://hackage.haskell.org/api</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">JSON</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">imdb</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">imdb</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">imdb</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">6.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">imgur</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">imgur</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">img</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ina</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">ina</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">in</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">6.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">invidious</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">invidious</span></span><br><span class="line">    <span class="comment"># Instanes will be selected randomly, see https://api.invidious.io/ for</span></span><br><span class="line">    <span class="comment"># instances that are stable (good uptime) and close to you.</span></span><br><span class="line">    <span class="attr">base_url:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://invidious.io.lol</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://invidious.fdn.fr</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://yt.artemislena.eu</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://invidious.tiekoetter.com</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://invidious.flokinet.to</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://vid.puffyan.us</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://invidious.privacydev.net</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://inv.tux.pizza</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">iv</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">jisho</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">jisho</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">js</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">kickass</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">kickass</span></span><br><span class="line">    <span class="attr">base_url:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://kickasstorrents.to</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://kickasstorrents.cr</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://kickasstorrent.cr</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://kickass.sx</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://kat.am</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">kc</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">lemmy</span> <span class="string">communities</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">lemmy</span></span><br><span class="line">    <span class="attr">lemmy_type:</span> <span class="string">Communities</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">leco</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">lemmy</span> <span class="string">users</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">lemmy</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">lemmy</span> <span class="string">communities</span></span><br><span class="line">    <span class="attr">lemmy_type:</span> <span class="string">Users</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">leus</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">lemmy</span> <span class="string">posts</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">lemmy</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">lemmy</span> <span class="string">communities</span></span><br><span class="line">    <span class="attr">lemmy_type:</span> <span class="string">Posts</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">lepo</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">lemmy</span> <span class="string">comments</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">lemmy</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">lemmy</span> <span class="string">communities</span></span><br><span class="line">    <span class="attr">lemmy_type:</span> <span class="string">Comments</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">lecom</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">library</span> <span class="string">genesis</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="comment"># search_url: https://libgen.is/search.php?req=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://libgen.rs/search.php?req=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">//a[contains(@href,&quot;book/index.php?md5&quot;)]/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">//a[contains(@href,&quot;book/&quot;)]/text()[1]</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">//td/a[1][contains(@href,&quot;=author&quot;)]/text()</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">files</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">7.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">lg</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://libgen.fun/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q22017206</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">z-library</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">zlibrary</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">zlib</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">files</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">7.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">library</span> <span class="string">of</span> <span class="string">congress</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">loc</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">loc</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">images</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">libretranslate</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">libretranslate</span></span><br><span class="line">    <span class="comment"># https://github.com/LibreTranslate/LibreTranslate?tab=readme-ov-file#mirrors</span></span><br><span class="line">    <span class="attr">base_url:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://translate.terraprint.co</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://trans.zillyhuhn.com</span></span><br><span class="line">    <span class="comment"># api_key: abc123</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">lt</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">lingva</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">lingva</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">lv</span></span><br><span class="line">    <span class="comment"># set lingva instance in url, by default it will use the official instance</span></span><br><span class="line">    <span class="comment"># url: https://lingva.thedaviddelta.com</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">lobste.rs</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://lobste.rs/search?q=&#123;query&#125;&amp;what=stories&amp;order=relevance</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">//li[contains(@class,</span> <span class="string">&quot;story&quot;</span><span class="string">)]</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">.//a[@class=&quot;u-url&quot;]/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">.//a[@class=&quot;u-url&quot;]</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">.//a[@class=&quot;domain&quot;]</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">it</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">lo</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://lobste.rs/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q60762874</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mastodon</span> <span class="string">users</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mastodon</span></span><br><span class="line">    <span class="attr">mastodon_type:</span> <span class="string">accounts</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">https://mastodon.social</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mau</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mastodon</span> <span class="string">hashtags</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mastodon</span></span><br><span class="line">    <span class="attr">mastodon_type:</span> <span class="string">hashtags</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">https://mastodon.social</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mah</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: matrixrooms</span></span><br><span class="line">  <span class="comment">#   engine: mrs</span></span><br><span class="line">  <span class="comment">#   # https://docs.searxng.org/dev/engines/online/mrs.html</span></span><br><span class="line">  <span class="comment">#   # base_url: https://mrs-api-host</span></span><br><span class="line">  <span class="comment">#   shortcut: mtrx</span></span><br><span class="line">  <span class="comment">#   disabled: true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mdn</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mdn</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">json_engine</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>]</span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://developer.mozilla.org/api/v1/search?q=&#123;query&#125;&amp;page=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">results_query:</span> <span class="string">documents</span></span><br><span class="line">    <span class="attr">url_query:</span> <span class="string">mdn_url</span></span><br><span class="line">    <span class="attr">url_prefix:</span> <span class="string">https://developer.mozilla.org</span></span><br><span class="line">    <span class="attr">title_query:</span> <span class="string">title</span></span><br><span class="line">    <span class="attr">content_query:</span> <span class="string">summary</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://developer.mozilla.org</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q3273508</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="literal">null</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">JSON</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">metacpan</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">metacpan</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">cpan</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">number_of_results:</span> <span class="number">20</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: meilisearch</span></span><br><span class="line">  <span class="comment">#   engine: meilisearch</span></span><br><span class="line">  <span class="comment">#   shortcut: mes</span></span><br><span class="line">  <span class="comment">#   enable_http: true</span></span><br><span class="line">  <span class="comment">#   base_url: http://localhost:7700</span></span><br><span class="line">  <span class="comment">#   index: my-index</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mixcloud</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mixcloud</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mc</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># MongoDB engine</span></span><br><span class="line">  <span class="comment"># Required dependency: pymongo</span></span><br><span class="line">  <span class="comment"># - name: mymongo</span></span><br><span class="line">  <span class="comment">#   engine: mongodb</span></span><br><span class="line">  <span class="comment">#   shortcut: md</span></span><br><span class="line">  <span class="comment">#   exact_match_only: false</span></span><br><span class="line">  <span class="comment">#   host: &#x27;127.0.0.1&#x27;</span></span><br><span class="line">  <span class="comment">#   port: 27017</span></span><br><span class="line">  <span class="comment">#   enable_http: true</span></span><br><span class="line">  <span class="comment">#   results_per_page: 20</span></span><br><span class="line">  <span class="comment">#   database: &#x27;business&#x27;</span></span><br><span class="line">  <span class="comment">#   collection: &#x27;reviews&#x27;  # name of the db collection</span></span><br><span class="line">  <span class="comment">#   key: &#x27;name&#x27;  # key in the collection to search for</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mozhi</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mozhi</span></span><br><span class="line">    <span class="attr">base_url:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://mozhi.aryak.me</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://translate.bus-hit.me</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://nyc1.mz.ggtyler.dev</span></span><br><span class="line">    <span class="comment"># mozhi_engine: google - see https://mozhi.aryak.me for supported engines</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mz</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mwmbl</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mwmbl</span></span><br><span class="line">    <span class="comment"># api_url: https://api.mwmbl.org</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mwm</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">npm</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">npm</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">npm</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">nyaa</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">nyaa</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">nt</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mankier</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">json_engine</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://www.mankier.com/api/v2/mans/?q=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">results_query:</span> <span class="string">results</span></span><br><span class="line">    <span class="attr">url_query:</span> <span class="string">url</span></span><br><span class="line">    <span class="attr">title_query:</span> <span class="string">name</span></span><br><span class="line">    <span class="attr">content_query:</span> <span class="string">description</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">it</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">man</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.mankier.com/</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://www.mankier.com/api</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">JSON</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># read https://docs.searxng.org/dev/engines/online/mullvad_leta.html</span></span><br><span class="line">  <span class="comment"># - name: mullvadleta</span></span><br><span class="line">  <span class="comment">#   engine: mullvad_leta</span></span><br><span class="line">  <span class="comment">#   leta_engine: google # choose one of the following: google, brave</span></span><br><span class="line">  <span class="comment">#   use_cache: true  # Only 100 non-cache searches per day, suggested only for private instances</span></span><br><span class="line">  <span class="comment">#   search_url: https://leta.mullvad.net</span></span><br><span class="line">  <span class="comment">#   categories: [general, web]</span></span><br><span class="line">  <span class="comment">#   shortcut: ml</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">odysee</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">odysee</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">od</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">openairedatasets</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">json_engine</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://api.openaire.eu/search/datasets?format=json&amp;page=&#123;pageno&#125;&amp;size=10&amp;title=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">results_query:</span> <span class="string">response/results/result</span></span><br><span class="line">    <span class="attr">url_query:</span> <span class="string">metadata/oaf:entity/oaf:result/children/instance/webresource/url/$</span></span><br><span class="line">    <span class="attr">title_query:</span> <span class="string">metadata/oaf:entity/oaf:result/title/$</span></span><br><span class="line">    <span class="attr">content_query:</span> <span class="string">metadata/oaf:entity/oaf:result/description/$</span></span><br><span class="line">    <span class="attr">content_html_to_text:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">&quot;science&quot;</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">oad</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.openaire.eu/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q25106053</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://api.openaire.eu/</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">JSON</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">openairepublications</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">json_engine</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://api.openaire.eu/search/publications?format=json&amp;page=&#123;pageno&#125;&amp;size=10&amp;title=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">results_query:</span> <span class="string">response/results/result</span></span><br><span class="line">    <span class="attr">url_query:</span> <span class="string">metadata/oaf:entity/oaf:result/children/instance/webresource/url/$</span></span><br><span class="line">    <span class="attr">title_query:</span> <span class="string">metadata/oaf:entity/oaf:result/title/$</span></span><br><span class="line">    <span class="attr">content_query:</span> <span class="string">metadata/oaf:entity/oaf:result/description/$</span></span><br><span class="line">    <span class="attr">content_html_to_text:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">science</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">oap</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.openaire.eu/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q25106053</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://api.openaire.eu/</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">JSON</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">openmeteo</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">open_meteo</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">om</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: opensemanticsearch</span></span><br><span class="line">  <span class="comment">#   engine: opensemantic</span></span><br><span class="line">  <span class="comment">#   shortcut: oss</span></span><br><span class="line">  <span class="comment">#   base_url: &#x27;http://localhost:8983/solr/opensemanticsearch/&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">openstreetmap</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">openstreetmap</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">osm</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">openrepos</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://openrepos.net/search/node/&#123;query&#125;?page=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">//li[@class=&quot;search-result&quot;]//h3[@class=&quot;title&quot;]/a/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">//li[@class=&quot;search-result&quot;]//h3[@class=&quot;title&quot;]/a</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">//li[@class=&quot;search-result&quot;]//div[@class=&quot;search-snippet-info&quot;]//p[@class=&quot;search-snippet&quot;]</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">files</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">or</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://openrepos.net/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">packagist</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">json_engine</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://packagist.org/search.json?q=&#123;query&#125;&amp;page=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">results_query:</span> <span class="string">results</span></span><br><span class="line">    <span class="attr">url_query:</span> <span class="string">url</span></span><br><span class="line">    <span class="attr">title_query:</span> <span class="string">name</span></span><br><span class="line">    <span class="attr">content_query:</span> <span class="string">description</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">packages</span>]</span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">pack</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://packagist.org</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q108311377</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://packagist.org/apidoc</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">JSON</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pdbe</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">pdbe</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">pdb</span></span><br><span class="line">    <span class="comment"># Hide obsolete PDB entries.  Default is not to hide obsolete structures</span></span><br><span class="line">    <span class="comment">#  hide_obsolete: false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">photon</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">photon</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ph</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pinterest</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">pinterest</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">pin</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">piped</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">piped</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ppd</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">piped_filter:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># URL to use as link and for embeds</span></span><br><span class="line">    <span class="attr">frontend_url:</span> <span class="string">https://srv.piped.video</span></span><br><span class="line">    <span class="comment"># Instance will be selected randomly, for more see https://piped-instances.kavin.rocks/</span></span><br><span class="line">    <span class="attr">backend_url:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://pipedapi.kavin.rocks</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://pipedapi-libre.kavin.rocks</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://pipedapi.adminforge.de</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">piped.music</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">piped</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">piped</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ppdm</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">music</span></span><br><span class="line">    <span class="attr">piped_filter:</span> <span class="string">music_songs</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">piratebay</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">piratebay</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">tpb</span></span><br><span class="line">    <span class="comment"># You may need to change this URL to a proxy if piratebay is blocked in your</span></span><br><span class="line">    <span class="comment"># country</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">https://thepiratebay.org/</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pixiv</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">pv</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">pixiv</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">inactive:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">pixiv_image_proxies:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://pximg.example.org</span></span><br><span class="line">      <span class="comment"># A proxy is required to load the images. Hosting an image proxy server</span></span><br><span class="line">      <span class="comment"># for Pixiv:</span></span><br><span class="line">      <span class="comment">#    --&gt; https://pixivfe.pages.dev/hosting-image-proxy-server/</span></span><br><span class="line">      <span class="comment"># Proxies from public instances.  Ask the public instances owners if they</span></span><br><span class="line">      <span class="comment"># agree to receive traffic from SearXNG!</span></span><br><span class="line">      <span class="comment">#    --&gt; https://codeberg.org/VnPower/PixivFE#instances</span></span><br><span class="line">      <span class="comment">#    --&gt; https://github.com/searxng/searxng/pull/3192#issuecomment-1941095047</span></span><br><span class="line">      <span class="comment"># image proxy of https://pixiv.cat</span></span><br><span class="line">      <span class="comment"># - https://i.pixiv.cat</span></span><br><span class="line">      <span class="comment"># image proxy of https://www.pixiv.pics</span></span><br><span class="line">      <span class="comment"># - https://pximg.cocomi.eu.org</span></span><br><span class="line">      <span class="comment"># image proxy of https://pixivfe.exozy.me</span></span><br><span class="line">      <span class="comment"># - https://pximg.exozy.me</span></span><br><span class="line">      <span class="comment"># image proxy of https://pixivfe.ducks.party</span></span><br><span class="line">      <span class="comment"># - https://pixiv.ducks.party</span></span><br><span class="line">      <span class="comment"># image proxy of https://pixiv.perennialte.ch</span></span><br><span class="line">      <span class="comment"># - https://pximg.perennialte.ch</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">podcastindex</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">podcastindex</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">podcast</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Required dependency: psychopg2</span></span><br><span class="line">  <span class="comment">#  - name: postgresql</span></span><br><span class="line">  <span class="comment">#    engine: postgresql</span></span><br><span class="line">  <span class="comment">#    database: postgres</span></span><br><span class="line">  <span class="comment">#    username: postgres</span></span><br><span class="line">  <span class="comment">#    password: postgres</span></span><br><span class="line">  <span class="comment">#    limit: 10</span></span><br><span class="line">  <span class="comment">#    query_str: &#x27;SELECT * from my_table WHERE my_column = %(query)s&#x27;</span></span><br><span class="line">  <span class="comment">#    shortcut : psql</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">presearch</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">presearch</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">search</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ps</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">presearch</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">presearch</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">presearch</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">images</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">psimg</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">presearch</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">presearch</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">presearch</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">psvid</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">presearch</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">presearch</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">presearch</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">news</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">psnews</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pub.dev</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">pd</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://pub.dev/packages?q=&#123;query&#125;&amp;page=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">//div[contains(@class,&quot;packages-item&quot;)]</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">./div/h3/a/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">./div/h3/a</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">./div/div/div[contains(@class,&quot;packages-description&quot;)]/span</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">packages</span>, <span class="string">it</span>]</span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">first_page_num:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://pub.dev/</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://pub.dev/help/api</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pubmed</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">pubmed</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">pub</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">3.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pypi</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">pypi</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">pypi</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qwant</span></span><br><span class="line">    <span class="attr">qwant_categ:</span> <span class="string">web</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">qwant</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">qw</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">additional_tests:</span></span><br><span class="line">      <span class="attr">rosebud:</span> <span class="meta">*test_rosebud</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qwant</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">qwant_categ:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">qwant</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">qwn</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">qwant</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qwant</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">qwant_categ:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">qwant</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">qwi</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">images</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">network:</span> <span class="string">qwant</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qwant</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">qwant_categ:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">qwant</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">qwv</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">videos</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">network:</span> <span class="string">qwant</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: library</span></span><br><span class="line">  <span class="comment">#   engine: recoll</span></span><br><span class="line">  <span class="comment">#   shortcut: lib</span></span><br><span class="line">  <span class="comment">#   base_url: &#x27;https://recoll.example.org/&#x27;</span></span><br><span class="line">  <span class="comment">#   search_dir: &#x27;&#x27;</span></span><br><span class="line">  <span class="comment">#   mount_prefix: /export</span></span><br><span class="line">  <span class="comment">#   dl_prefix: &#x27;https://download.example.org&#x27;</span></span><br><span class="line">  <span class="comment">#   timeout: 30.0</span></span><br><span class="line">  <span class="comment">#   categories: files</span></span><br><span class="line">  <span class="comment">#   disabled: true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: recoll library reference</span></span><br><span class="line">  <span class="comment">#   engine: recoll</span></span><br><span class="line">  <span class="comment">#   base_url: &#x27;https://recoll.example.org/&#x27;</span></span><br><span class="line">  <span class="comment">#   search_dir: reference</span></span><br><span class="line">  <span class="comment">#   mount_prefix: /export</span></span><br><span class="line">  <span class="comment">#   dl_prefix: &#x27;https://download.example.org&#x27;</span></span><br><span class="line">  <span class="comment">#   shortcut: libr</span></span><br><span class="line">  <span class="comment">#   timeout: 30.0</span></span><br><span class="line">  <span class="comment">#   categories: files</span></span><br><span class="line">  <span class="comment">#   disabled: true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">radio</span> <span class="string">browser</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">radio_browser</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">rb</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">reddit</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">reddit</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">re</span></span><br><span class="line">    <span class="attr">page_size:</span> <span class="number">25</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">right</span> <span class="string">dao</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">page_size:</span> <span class="number">12</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://rightdao.com/search?q=&#123;query&#125;&amp;start=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">//div[contains(@class,</span> <span class="string">&quot;description&quot;</span><span class="string">)]</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">../div[contains(@class,</span> <span class="string">&quot;title&quot;</span><span class="string">)]/a/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">../div[contains(@class,</span> <span class="string">&quot;title&quot;</span><span class="string">)]</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">.</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">rd</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://rightdao.com/</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">rottentomatoes</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">rottentomatoes</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">rt</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Required dependency: redis</span></span><br><span class="line">  <span class="comment"># - name: myredis</span></span><br><span class="line">  <span class="comment">#   shortcut : rds</span></span><br><span class="line">  <span class="comment">#   engine: redis_server</span></span><br><span class="line">  <span class="comment">#   exact_match_only: false</span></span><br><span class="line">  <span class="comment">#   host: &#x27;127.0.0.1&#x27;</span></span><br><span class="line">  <span class="comment">#   port: 6379</span></span><br><span class="line">  <span class="comment">#   enable_http: true</span></span><br><span class="line">  <span class="comment">#   password: &#x27;&#x27;</span></span><br><span class="line">  <span class="comment">#   db: 0</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># tmp suspended: bad certificate</span></span><br><span class="line">  <span class="comment">#  - name: scanr structures</span></span><br><span class="line">  <span class="comment">#    shortcut: scs</span></span><br><span class="line">  <span class="comment">#    engine: scanr_structures</span></span><br><span class="line">  <span class="comment">#    disabled: true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">searchmysite</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">sms</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://searchmysite.net/search/?q=&#123;query&#125;&amp;page=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">//div[contains(@class,&#x27;search-result&#x27;)]</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">.//a[contains(@class,&#x27;result-link&#x27;)]/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">.//span[contains(@class,&#x27;result-title-txt&#x27;)]/text()</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">./p[@id=&#x27;result-hightlight&#x27;]</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://searchmysite.net</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sepiasearch</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">sepiasearch</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">sep</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">soundcloud</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">soundcloud</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">sc</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">stackoverflow</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">stackexchange</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">st</span></span><br><span class="line">    <span class="attr">api_site:</span> <span class="string">&#x27;stackoverflow&#x27;</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">q&amp;a</span>]</span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">askubuntu</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">stackexchange</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ubuntu</span></span><br><span class="line">    <span class="attr">api_site:</span> <span class="string">&#x27;askubuntu&#x27;</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">q&amp;a</span>]</span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">internetarchivescholar</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">internet_archive_scholar</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ias</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">15.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">superuser</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">stackexchange</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">su</span></span><br><span class="line">    <span class="attr">api_site:</span> <span class="string">&#x27;superuser&#x27;</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">q&amp;a</span>]</span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">discuss.python</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">discourse</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">dpy</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&#x27;https://discuss.python.org&#x27;</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">q&amp;a</span>]</span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">caddy.community</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">discourse</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">caddy</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&#x27;https://caddy.community&#x27;</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">q&amp;a</span>]</span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pi-hole.community</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">discourse</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">pi</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">q&amp;a</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&#x27;https://discourse.pi-hole.net&#x27;</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">searchcode</span> <span class="string">code</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">searchcode_code</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">scc</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: searx</span></span><br><span class="line">  <span class="comment">#   engine: searx_engine</span></span><br><span class="line">  <span class="comment">#   shortcut: se</span></span><br><span class="line">  <span class="comment">#   instance_urls :</span></span><br><span class="line">  <span class="comment">#       - http://127.0.0.1:8888/</span></span><br><span class="line">  <span class="comment">#       - ...</span></span><br><span class="line">  <span class="comment">#   disabled: true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">semantic</span> <span class="string">scholar</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">semantic_scholar</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">se</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Spotify needs API credentials</span></span><br><span class="line">  <span class="comment"># - name: spotify</span></span><br><span class="line">  <span class="comment">#   engine: spotify</span></span><br><span class="line">  <span class="comment">#   shortcut: stf</span></span><br><span class="line">  <span class="comment">#   api_client_id: *******</span></span><br><span class="line">  <span class="comment">#   api_client_secret: *******</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: solr</span></span><br><span class="line">  <span class="comment">#   engine: solr</span></span><br><span class="line">  <span class="comment">#   shortcut: slr</span></span><br><span class="line">  <span class="comment">#   base_url: http://localhost:8983</span></span><br><span class="line">  <span class="comment">#   collection: collection_name</span></span><br><span class="line">  <span class="comment">#   sort: &#x27;&#x27; # sorting: asc or desc</span></span><br><span class="line">  <span class="comment">#   field_list: &#x27;&#x27; # comma separated list of field names to display on the UI</span></span><br><span class="line">  <span class="comment">#   default_fields: &#x27;&#x27; # default field to query</span></span><br><span class="line">  <span class="comment">#   query_fields: &#x27;&#x27; # query fields</span></span><br><span class="line">  <span class="comment">#   enable_http: true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: springer nature</span></span><br><span class="line">  <span class="comment">#   engine: springer</span></span><br><span class="line">  <span class="comment">#   # get your API key from: https://dev.springernature.com/signup</span></span><br><span class="line">  <span class="comment">#   # working API key, for test &amp; de<span class="doctag">bug:</span> &quot;a69685087d07eca9f13db62f65b8f601&quot;</span></span><br><span class="line">  <span class="comment">#   api_key: &#x27;unset&#x27;</span></span><br><span class="line">  <span class="comment">#   shortcut: springer</span></span><br><span class="line">  <span class="comment">#   timeout: 15.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">startpage</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">startpage</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">sp</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">6.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">additional_tests:</span></span><br><span class="line">      <span class="attr">rosebud:</span> <span class="meta">*test_rosebud</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">tokyotoshokan</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">tokyotoshokan</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">tt</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">6.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">solidtorrents</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">solidtorrents</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">solid</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">base_url:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://solidtorrents.to</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://bitsearch.to</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># For this demo of the sqlite engine download:</span></span><br><span class="line">  <span class="comment">#   https://liste.mediathekview.de/filmliste-v2.db.bz2</span></span><br><span class="line">  <span class="comment"># and unpack into searx/data/filmliste-v2.db</span></span><br><span class="line">  <span class="comment"># Query to test: &quot;!demo concert&quot;</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># - name: demo</span></span><br><span class="line">  <span class="comment">#   engine: sqlite</span></span><br><span class="line">  <span class="comment">#   shortcut: demo</span></span><br><span class="line">  <span class="comment">#   categories: general</span></span><br><span class="line">  <span class="comment">#   result_template: default.html</span></span><br><span class="line">  <span class="comment">#   database: searx/data/filmliste-v2.db</span></span><br><span class="line">  <span class="comment">#   query_str:  &gt;-</span></span><br><span class="line">  <span class="comment">#     SELECT title || &#x27; (&#x27; || time(duration, &#x27;unixepoch&#x27;) || &#x27;)&#x27; AS title,</span></span><br><span class="line">  <span class="comment">#            COALESCE( NULLIF(url_video_hd,&#x27;&#x27;), NULLIF(url_video_sd,&#x27;&#x27;), url_video) AS url,</span></span><br><span class="line">  <span class="comment">#            description AS content</span></span><br><span class="line">  <span class="comment">#       FROM film</span></span><br><span class="line">  <span class="comment">#      WHERE title LIKE :wildcard OR description LIKE :wildcard</span></span><br><span class="line">  <span class="comment">#      ORDER BY duration DESC</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">tagesschau</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">tagesschau</span></span><br><span class="line">    <span class="comment"># when set to false, display URLs from Tagesschau, and not the actual source</span></span><br><span class="line">    <span class="comment"># (e.g. NDR, WDR, SWR, HR, ...)</span></span><br><span class="line">    <span class="attr">use_source_url:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ts</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">tmdb</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">movies</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://www.themoviedb.org/search?page=&#123;pageno&#125;&amp;query=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">//div[contains(@class,&quot;movie&quot;)</span> <span class="string">or</span> <span class="string">contains(@class,&quot;tv&quot;)]//div[contains(@class,&quot;card&quot;)]</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">.//div[contains(@class,&quot;poster&quot;)]/a/@href</span></span><br><span class="line">    <span class="attr">thumbnail_xpath:</span> <span class="string">.//img/@src</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">.//div[contains(@class,&quot;title&quot;)]//h2</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">.//div[contains(@class,&quot;overview&quot;)]</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">tm</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Requires Tor</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">torch</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span></span><br><span class="line">      <span class="string">http://xmh57jrknzkhv6y3ls3ubitzfqnkrwxhopf5aygthi7d6rplyvk3noyd.onion/cgi-bin/omega/omega?P=&#123;query&#125;&amp;DEFAULTOP=and</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">//table//tr</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">./td[2]/a</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">./td[2]/b</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">./td[2]/small</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">onions</span></span><br><span class="line">    <span class="attr">enable_http:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">tch</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># torznab engine lets you query any torznab compatible indexer.  Using this</span></span><br><span class="line">  <span class="comment"># engine in combination with Jackett opens the possibility to query a lot of</span></span><br><span class="line">  <span class="comment"># public and private indexers directly from SearXNG. More details at:</span></span><br><span class="line">  <span class="comment"># https://docs.searxng.org/dev/engines/online/torznab.html</span></span><br><span class="line">  <span class="comment">#</span></span><br><span class="line">  <span class="comment"># - name: Torznab EZTV</span></span><br><span class="line">  <span class="comment">#   engine: torznab</span></span><br><span class="line">  <span class="comment">#   shortcut: eztv</span></span><br><span class="line">  <span class="comment">#   base_url: http://localhost:9117/api/v2.0/indexers/eztv/results/torznab</span></span><br><span class="line">  <span class="comment">#   enable_http: true  # if using localhost</span></span><br><span class="line">  <span class="comment">#   api_key: xxxxxxxxxxxxxxx</span></span><br><span class="line">  <span class="comment">#   show_magnet_links: true</span></span><br><span class="line">  <span class="comment">#   show_torrent_files: false</span></span><br><span class="line">  <span class="comment">#   # https://github.com/Jackett/Jackett/wiki/Jackett-Categories</span></span><br><span class="line">  <span class="comment">#   torznab_categories:  # optional</span></span><br><span class="line">  <span class="comment">#     - 2000</span></span><br><span class="line">  <span class="comment">#     - 5000</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># tmp suspended - too slow, too many errors</span></span><br><span class="line">  <span class="comment">#  - name: urbandictionary</span></span><br><span class="line">  <span class="comment">#    engine      : xpath</span></span><br><span class="line">  <span class="comment">#    search_url  : https://www.urbandictionary.com/define.php?term=&#123;query&#125;</span></span><br><span class="line">  <span class="comment">#    url_xpath   : //*[@class=&quot;word&quot;]/@href</span></span><br><span class="line">  <span class="comment">#    title_xpath : //*[@class=&quot;def-header&quot;]</span></span><br><span class="line">  <span class="comment">#    content_xpath: //*[@class=&quot;meaning&quot;]</span></span><br><span class="line">  <span class="comment">#    shortcut: ud</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">unsplash</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">unsplash</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">us</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yandex</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yandex</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">web</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">yd</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">inactive:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yandex</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yandex</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ydi</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">inactive:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yandex</span> <span class="string">music</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yandex_music</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ydm</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># https://yandex.com/support/music/access.html</span></span><br><span class="line">    <span class="attr">inactive:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yahoo</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yahoo</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">yh</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yahoo</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yahoo_news</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">yhn</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">youtube</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">yt</span></span><br><span class="line">    <span class="comment"># You can use the engine using the official stable API, but you need an API</span></span><br><span class="line">    <span class="comment"># key See: https://console.developers.google.com/project</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># engine: youtube_api</span></span><br><span class="line">    <span class="comment"># api_key: &#x27;apikey&#x27; # required!</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Or you can use the html non-stable engine, activated by default</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">youtube_noapi</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">dailymotion</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">dailymotion</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">dm</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">vimeo</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">vimeo</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">vm</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wiby</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">json_engine</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://wiby.me/json/?q=&#123;query&#125;&amp;p=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">url_query:</span> <span class="string">URL</span></span><br><span class="line">    <span class="attr">title_query:</span> <span class="string">Title</span></span><br><span class="line">    <span class="attr">content_query:</span> <span class="string">Snippet</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wib</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://wiby.me/</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikibooks</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">weight:</span> <span class="number">0.5</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wb</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">wikimedia</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&quot;https://&#123;language&#125;.wikibooks.org/&quot;</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.wikibooks.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q367</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikinews</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wn</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">news</span>, <span class="string">wikimedia</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&quot;https://&#123;language&#125;.wikinews.org/&quot;</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">srsort:</span> <span class="string">create_timestamp_desc</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.wikinews.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q964</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikiquote</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">weight:</span> <span class="number">0.5</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wq</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">wikimedia</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&quot;https://&#123;language&#125;.wikiquote.org/&quot;</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">additional_tests:</span></span><br><span class="line">      <span class="attr">rosebud:</span> <span class="meta">*test_rosebud</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.wikiquote.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q369</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikisource</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">weight:</span> <span class="number">0.5</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ws</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">wikimedia</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&quot;https://&#123;language&#125;.wikisource.org/&quot;</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.wikisource.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q263</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikispecies</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wsp</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">science</span>, <span class="string">wikimedia</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&quot;https://species.wikimedia.org/&quot;</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://species.wikimedia.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q13679</span></span><br><span class="line">    <span class="attr">tests:</span></span><br><span class="line">      <span class="attr">wikispecies:</span></span><br><span class="line">        <span class="attr">matrix:</span></span><br><span class="line">          <span class="attr">query:</span> <span class="string">&quot;Campbell, L.I. et al. 2011: MicroRNAs&quot;</span></span><br><span class="line">          <span class="attr">lang:</span> <span class="string">en</span></span><br><span class="line">        <span class="attr">result_container:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">not_empty</span></span><br><span class="line">          <span class="bullet">-</span> [<span class="string">&#x27;one_title_contains&#x27;</span>, <span class="string">&#x27;Tardigrada&#x27;</span>]</span><br><span class="line">        <span class="attr">test:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="string">unique_results</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wiktionary</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wt</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">dictionaries</span>, <span class="string">wikimedia</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&quot;https://&#123;language&#125;.wiktionary.org/&quot;</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.wiktionary.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q151</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikiversity</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">weight:</span> <span class="number">0.5</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wv</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">wikimedia</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&quot;https://&#123;language&#125;.wikiversity.org/&quot;</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.wikiversity.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q370</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikivoyage</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediawiki</span></span><br><span class="line">    <span class="attr">weight:</span> <span class="number">0.5</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wy</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">wikimedia</span>]</span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">&quot;https://&#123;language&#125;.wikivoyage.org/&quot;</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.wikivoyage.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q373</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikicommons.images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wikicommons</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wc</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">number_of_results:</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikicommons.videos</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wikicommons</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wcv</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">number_of_results:</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikicommons.audio</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wikicommons</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wca</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">music</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">audio</span></span><br><span class="line">    <span class="attr">number_of_results:</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikicommons.files</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wikicommons</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wcf</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">files</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">files</span></span><br><span class="line">    <span class="attr">number_of_results:</span> <span class="number">10</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wolframalpha</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wa</span></span><br><span class="line">    <span class="comment"># You can use the engine using the official stable API, but you need an API</span></span><br><span class="line">    <span class="comment"># key.  See: https://products.wolframalpha.com/api/</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># engine: wolframalpha_api</span></span><br><span class="line">    <span class="comment"># api_key: &#x27;&#x27;</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># Or you can use the html non-stable engine, activated by default</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wolframalpha_noapi</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">6.0</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">dictzone</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">dictzone</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">dc</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mymemory</span> <span class="string">translated</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">translated</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">tl</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line">    <span class="comment"># You can use without an API key, but you are limited to 1000 words/day</span></span><br><span class="line">    <span class="comment"># See: https://mymemory.translated.net/doc/usagelimits.php</span></span><br><span class="line">    <span class="comment"># api_key: &#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Required dependency: mysql-connector-python</span></span><br><span class="line">  <span class="comment">#  - name: mysql</span></span><br><span class="line">  <span class="comment">#    engine: mysql_server</span></span><br><span class="line">  <span class="comment">#    database: mydatabase</span></span><br><span class="line">  <span class="comment">#    username: user</span></span><br><span class="line">  <span class="comment">#    password: pass</span></span><br><span class="line">  <span class="comment">#    limit: 10</span></span><br><span class="line">  <span class="comment">#    query_str: &#x27;SELECT * from mytable WHERE fieldname=%(query)s&#x27;</span></span><br><span class="line">  <span class="comment">#    shortcut: mysql</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># Required dependency: mariadb</span></span><br><span class="line">  <span class="comment">#  - name: mariadb</span></span><br><span class="line">  <span class="comment">#    engine: mariadb_server</span></span><br><span class="line">  <span class="comment">#    database: mydatabase</span></span><br><span class="line">  <span class="comment">#    username: user</span></span><br><span class="line">  <span class="comment">#    password: pass</span></span><br><span class="line">  <span class="comment">#    limit: 10</span></span><br><span class="line">  <span class="comment">#    query_str: &#x27;SELECT * from mytable WHERE fieldname=%(query)s&#x27;</span></span><br><span class="line">  <span class="comment">#    shortcut: mdb</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">1337x</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">1337x</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">1337x</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">duden</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">duden</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">du</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">seznam</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">szn</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">seznam</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: deepl</span></span><br><span class="line">  <span class="comment">#   engine: deepl</span></span><br><span class="line">  <span class="comment">#   shortcut: dpl</span></span><br><span class="line">  <span class="comment">#   # You can use the engine using the official stable API, but you need an API key</span></span><br><span class="line">  <span class="comment">#   # See: https://www.deepl.com/pro-api?cta=header-pro-api</span></span><br><span class="line">  <span class="comment">#   api_key: &#x27;&#x27;  # required!</span></span><br><span class="line">  <span class="comment">#   timeout: 5.0</span></span><br><span class="line">  <span class="comment">#   disabled: true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mojeek</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mjk</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mojeek</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mojeek</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mjkimg</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mojeek</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">images</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mojeek</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mjknews</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mojeek</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">news</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">moviepilot</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">moviepilot</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mp</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">naver</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">nvr</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://search.naver.com/search.naver?where=webkr&amp;sm=osp_hty&amp;ie=UTF-8&amp;query=&#123;query&#125;&amp;start=&#123;pageno&#125;</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">//a[@class=&quot;link_tit&quot;]/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">//a[@class=&quot;link_tit&quot;]</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">//div[@class=&quot;total_dsc_wrap&quot;]/a</span></span><br><span class="line">    <span class="attr">first_page_num:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">page_size:</span> <span class="number">10</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.naver.com/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q485639</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://developers.naver.com/docs/nmt/examples/</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line">      <span class="attr">language:</span> <span class="string">ko</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">rubygems</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">rbg</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://rubygems.org/search?page=&#123;pageno&#125;&amp;query=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">/html/body/main/div/a[@class=&quot;gems__gem&quot;]</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">./@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">./span/h2</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">./span/p</span></span><br><span class="line">    <span class="attr">suggestion_xpath:</span> <span class="string">/html/body/main/div/div[@class=&quot;search__suggestions&quot;]/p/a</span></span><br><span class="line">    <span class="attr">first_page_num:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">packages</span>]</span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://rubygems.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q1853420</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://guides.rubygems.org/rubygems-org-api/</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">peertube</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">peertube</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ptb</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># alternatives see: https://instances.joinpeertube.org/instances</span></span><br><span class="line">    <span class="comment"># base_url: https://tube.4aem.com</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">6.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">mediathekviewweb</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">mediathekviewweb</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">mvw</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yacy</span></span><br><span class="line">    <span class="comment"># https://docs.searxng.org/dev/engines/online/yacy.html</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yacy</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">text</span></span><br><span class="line">    <span class="attr">base_url:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">https://yacy.searchlab.eu</span></span><br><span class="line">      <span class="comment"># see https://github.com/searxng/searxng/pull/3631#issuecomment-2240903027</span></span><br><span class="line">      <span class="comment"># - https://search.kyun.li</span></span><br><span class="line">      <span class="comment"># - https://yacy.securecomcorp.eu</span></span><br><span class="line">      <span class="comment"># - https://yacy.myserv.ca</span></span><br><span class="line">      <span class="comment"># - https://yacy.nsupdate.info</span></span><br><span class="line">      <span class="comment"># - https://yacy.electroncash.de</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ya</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># if you aren&#x27;t using HTTPS for your local yacy instance disable https</span></span><br><span class="line">    <span class="comment"># enable_http: false</span></span><br><span class="line">    <span class="attr">search_mode:</span> <span class="string">&#x27;global&#x27;</span></span><br><span class="line">    <span class="comment"># timeout can be reduced in &#x27;local&#x27; search mode</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yacy</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yacy</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">yacy</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">search_type:</span> <span class="string">image</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">yai</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="comment"># timeout can be reduced in &#x27;local&#x27; search mode</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">rumble</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">rumble</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ru</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">https://rumble.com/</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">livespace</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">livespace</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">ls</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wordnik</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wordnik</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">def</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">https://www.wordnik.com/</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">dictionaries</span>]</span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">woxikon.de</span> <span class="string">synonyme</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">woxi</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">dictionaries</span>]</span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://synonyme.woxikon.de/synonyme/&#123;query&#125;.php</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">//div[@class=&quot;upper-synonyms&quot;]/a/@href</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">//div[@class=&quot;synonyms-list-group&quot;]</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">//div[@class=&quot;upper-synonyms&quot;]/a</span></span><br><span class="line">    <span class="attr">no_result_for_http_status:</span> [<span class="number">404</span>]</span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://www.woxikon.de/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span>  <span class="comment"># No Wikidata ID</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line">      <span class="attr">language:</span> <span class="string">de</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">seekr</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">seekr</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">senews</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">seekr_category:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">seekr</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">seekr</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">seekr</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">seimg</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">seekr_category:</span> <span class="string">images</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">seekr</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">seekr</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">seekr</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">sevid</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">seekr_category:</span> <span class="string">videos</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sjp.pwn</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">sjp</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">sjp</span></span><br><span class="line">    <span class="attr">base_url:</span> <span class="string">https://sjp.pwn.pl/</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">5.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">stract</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">stract</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">str</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">svgrepo</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">svgrepo</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">svg</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">10.0</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">tootfinder</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">tootfinder</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">toot</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">voidlinux</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">voidlinux</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">void</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wallhaven</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wallhaven</span></span><br><span class="line">    <span class="comment"># api_key: abcdefghijklmnopqrstuvwxyz</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wh</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># wikimini: online encyclopedia for children</span></span><br><span class="line">    <span class="comment"># The fulltext and title parameter is necessary for Wikimini because</span></span><br><span class="line">    <span class="comment"># sometimes it will not show the results and redirect instead</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wikimini</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wkmn</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://fr.wikimini.org/w/index.php?search=&#123;query&#125;&amp;title=Sp%C3%A9cial%3ASearch&amp;fulltext=Search</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">//li/div[@class=&quot;mw-search-result-heading&quot;]/a/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">//li//div[@class=&quot;mw-search-result-heading&quot;]/a</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">//li/div[@class=&quot;searchresult&quot;]</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">general</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://wikimini.org/</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q3568032</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line">      <span class="attr">language:</span> <span class="string">fr</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">wttr.in</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">wttr</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">wttr</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">9.0</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">yummly</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">yummly</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">yum</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">brave</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">brave</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">br</span></span><br><span class="line">    <span class="attr">time_range_support:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">brave_category:</span> <span class="string">search</span></span><br><span class="line">    <span class="comment"># brave_spellcheck: true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">brave.images</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">brave</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">brave</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">brimg</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">images</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">brave_category:</span> <span class="string">images</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">brave.videos</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">brave</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">brave</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">brvid</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">videos</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">brave_category:</span> <span class="string">videos</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">brave.news</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">brave</span></span><br><span class="line">    <span class="attr">network:</span> <span class="string">brave</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">brnews</span></span><br><span class="line">    <span class="attr">categories:</span> <span class="string">news</span></span><br><span class="line">    <span class="attr">brave_category:</span> <span class="string">news</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># - name: brave.goggles</span></span><br><span class="line">  <span class="comment">#   engine: brave</span></span><br><span class="line">  <span class="comment">#   network: brave</span></span><br><span class="line">  <span class="comment">#   shortcut: brgog</span></span><br><span class="line">  <span class="comment">#   time_range_support: true</span></span><br><span class="line">  <span class="comment">#   paging: true</span></span><br><span class="line">  <span class="comment">#   categories: [general, web]</span></span><br><span class="line">  <span class="comment">#   brave_category: goggles</span></span><br><span class="line">  <span class="comment">#   Goggles: # required! This should be a URL ending in .goggle</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">lib.rs</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">lrs</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">lib_rs</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">sourcehut</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">srht</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://sr.ht/projects?page=&#123;pageno&#125;&amp;search=&#123;query&#125;</span></span><br><span class="line">    <span class="attr">results_xpath:</span> <span class="string">(//div[@class=&quot;event-list&quot;])[1]/div[@class=&quot;event&quot;]</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">./h4/a[2]/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">./h4/a[2]</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">./p</span></span><br><span class="line">    <span class="attr">first_page_num:</span> <span class="number">1</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">it</span>, <span class="string">repos</span>]</span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://sr.ht</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q78514485</span></span><br><span class="line">      <span class="attr">official_api_documentation:</span> <span class="string">https://man.sr.ht/</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">goo</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">goo</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">xpath</span></span><br><span class="line">    <span class="attr">paging:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">search_url:</span> <span class="string">https://search.goo.ne.jp/web.jsp?MT=&#123;query&#125;&amp;FR=&#123;pageno&#125;0</span></span><br><span class="line">    <span class="attr">url_xpath:</span> <span class="string">//div[@class=&quot;result&quot;]/p[@class=&#x27;title</span> <span class="string">fsL1&#x27;]/a/@href</span></span><br><span class="line">    <span class="attr">title_xpath:</span> <span class="string">//div[@class=&quot;result&quot;]/p[@class=&#x27;title</span> <span class="string">fsL1&#x27;]/a</span></span><br><span class="line">    <span class="attr">content_xpath:</span> <span class="string">//p[contains(@class,&#x27;url</span> <span class="string">fsM&#x27;)]/following-sibling::p</span></span><br><span class="line">    <span class="attr">first_page_num:</span> <span class="number">0</span></span><br><span class="line">    <span class="attr">categories:</span> [<span class="string">general</span>, <span class="string">web</span>]</span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">timeout:</span> <span class="number">4.0</span></span><br><span class="line">    <span class="attr">about:</span></span><br><span class="line">      <span class="attr">website:</span> <span class="string">https://search.goo.ne.jp</span></span><br><span class="line">      <span class="attr">wikidata_id:</span> <span class="string">Q249044</span></span><br><span class="line">      <span class="attr">use_official_api:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">require_api_key:</span> <span class="literal">false</span></span><br><span class="line">      <span class="attr">results:</span> <span class="string">HTML</span></span><br><span class="line">      <span class="attr">language:</span> <span class="string">ja</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">bt4g</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">bt4g</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">bt4g</span></span><br><span class="line"></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pkg.go.dev</span></span><br><span class="line">    <span class="attr">engine:</span> <span class="string">pkg_go_dev</span></span><br><span class="line">    <span class="attr">shortcut:</span> <span class="string">pgo</span></span><br><span class="line">    <span class="attr">disabled:</span> <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Doku engine lets you access to any Doku wiki instance:</span></span><br><span class="line"><span class="comment"># A public one or a privete/corporate one.</span></span><br><span class="line"><span class="comment">#  - name: ubuntuwiki</span></span><br><span class="line"><span class="comment">#    engine: doku</span></span><br><span class="line"><span class="comment">#    shortcut: uw</span></span><br><span class="line"><span class="comment">#    base_url: &#x27;https://doc.ubuntu-fr.org&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Be careful when enabling this engine if you are</span></span><br><span class="line"><span class="comment"># running a public instance. Do not expose any sensitive</span></span><br><span class="line"><span class="comment"># information. You can restrict access by configuring a list</span></span><br><span class="line"><span class="comment"># of access tokens under tokens.</span></span><br><span class="line"><span class="comment">#  - name: git grep</span></span><br><span class="line"><span class="comment">#    engine: command</span></span><br><span class="line"><span class="comment">#    command: [&#x27;git&#x27;, &#x27;grep&#x27;, &#x27;&#123;&#123;QUERY&#125;&#125;&#x27;]</span></span><br><span class="line"><span class="comment">#    shortcut: gg</span></span><br><span class="line"><span class="comment">#    tokens: []</span></span><br><span class="line"><span class="comment">#    disabled: true</span></span><br><span class="line"><span class="comment">#    delimiter:</span></span><br><span class="line"><span class="comment">#        chars: &#x27;:&#x27;</span></span><br><span class="line"><span class="comment">#        keys: [&#x27;filepath&#x27;, &#x27;code&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Be careful when enabling this engine if you are</span></span><br><span class="line"><span class="comment"># running a public instance. Do not expose any sensitive</span></span><br><span class="line"><span class="comment"># information. You can restrict access by configuring a list</span></span><br><span class="line"><span class="comment"># of access tokens under tokens.</span></span><br><span class="line"><span class="comment">#  - name: locate</span></span><br><span class="line"><span class="comment">#    engine: command</span></span><br><span class="line"><span class="comment">#    command: [&#x27;locate&#x27;, &#x27;&#123;&#123;QUERY&#125;&#125;&#x27;]</span></span><br><span class="line"><span class="comment">#    shortcut: loc</span></span><br><span class="line"><span class="comment">#    tokens: []</span></span><br><span class="line"><span class="comment">#    disabled: true</span></span><br><span class="line"><span class="comment">#    delimiter:</span></span><br><span class="line"><span class="comment">#        chars: &#x27; &#x27;</span></span><br><span class="line"><span class="comment">#        keys: [&#x27;line&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Be careful when enabling this engine if you are</span></span><br><span class="line"><span class="comment"># running a public instance. Do not expose any sensitive</span></span><br><span class="line"><span class="comment"># information. You can restrict access by configuring a list</span></span><br><span class="line"><span class="comment"># of access tokens under tokens.</span></span><br><span class="line"><span class="comment">#  - name: find</span></span><br><span class="line"><span class="comment">#    engine: command</span></span><br><span class="line"><span class="comment">#    command: [&#x27;find&#x27;, &#x27;.&#x27;, &#x27;-name&#x27;, &#x27;&#123;&#123;QUERY&#125;&#125;&#x27;]</span></span><br><span class="line"><span class="comment">#    query_type: path</span></span><br><span class="line"><span class="comment">#    shortcut: fnd</span></span><br><span class="line"><span class="comment">#    tokens: []</span></span><br><span class="line"><span class="comment">#    disabled: true</span></span><br><span class="line"><span class="comment">#    delimiter:</span></span><br><span class="line"><span class="comment">#        chars: &#x27; &#x27;</span></span><br><span class="line"><span class="comment">#        keys: [&#x27;line&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Be careful when enabling this engine if you are</span></span><br><span class="line"><span class="comment"># running a public instance. Do not expose any sensitive</span></span><br><span class="line"><span class="comment"># information. You can restrict access by configuring a list</span></span><br><span class="line"><span class="comment"># of access tokens under tokens.</span></span><br><span class="line"><span class="comment">#  - name: pattern search in files</span></span><br><span class="line"><span class="comment">#    engine: command</span></span><br><span class="line"><span class="comment">#    command: [&#x27;fgrep&#x27;, &#x27;&#123;&#123;QUERY&#125;&#125;&#x27;]</span></span><br><span class="line"><span class="comment">#    shortcut: fgr</span></span><br><span class="line"><span class="comment">#    tokens: []</span></span><br><span class="line"><span class="comment">#    disabled: true</span></span><br><span class="line"><span class="comment">#    delimiter:</span></span><br><span class="line"><span class="comment">#        chars: &#x27; &#x27;</span></span><br><span class="line"><span class="comment">#        keys: [&#x27;line&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Be careful when enabling this engine if you are</span></span><br><span class="line"><span class="comment"># running a public instance. Do not expose any sensitive</span></span><br><span class="line"><span class="comment"># information. You can restrict access by configuring a list</span></span><br><span class="line"><span class="comment"># of access tokens under tokens.</span></span><br><span class="line"><span class="comment">#  - name: regex search in files</span></span><br><span class="line"><span class="comment">#    engine: command</span></span><br><span class="line"><span class="comment">#    command: [&#x27;grep&#x27;, &#x27;&#123;&#123;QUERY&#125;&#125;&#x27;]</span></span><br><span class="line"><span class="comment">#    shortcut: gr</span></span><br><span class="line"><span class="comment">#    tokens: []</span></span><br><span class="line"><span class="comment">#    disabled: true</span></span><br><span class="line"><span class="comment">#    delimiter:</span></span><br><span class="line"><span class="comment">#        chars: &#x27; &#x27;</span></span><br><span class="line"><span class="comment">#        keys: [&#x27;line&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="attr">doi_resolvers:</span></span><br><span class="line">  <span class="attr">oadoi.org:</span> <span class="string">&#x27;https://oadoi.org/&#x27;</span></span><br><span class="line">  <span class="attr">doi.org:</span> <span class="string">&#x27;https://doi.org/&#x27;</span></span><br><span class="line">  <span class="attr">doai.io:</span> <span class="string">&#x27;https://dissem.in/&#x27;</span></span><br><span class="line">  <span class="attr">sci-hub.se:</span> <span class="string">&#x27;https://sci-hub.se/&#x27;</span></span><br><span class="line">  <span class="attr">sci-hub.st:</span> <span class="string">&#x27;https://sci-hub.st/&#x27;</span></span><br><span class="line">  <span class="attr">sci-hub.ru:</span> <span class="string">&#x27;https://sci-hub.ru/&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">default_doi_resolver:</span> <span class="string">&#x27;oadoi.org&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="äºŒ-ä¸open-webuié›†æˆ"><a href="#äºŒ-ä¸open-webuié›†æˆ" class="headerlink" title="äºŒ. ä¸open-webuié›†æˆ"></a>äºŒ. ä¸open-webuié›†æˆ</h3><p>ç®¡ç†å‘˜è®¾ç½® &gt; å›¾åƒè®¾ç½®</p><p>Searxng æŸ¥è¯¢ URLï¼š <code>http://searxng:8080/search?q=&lt;query&gt;/</code></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_783be5ac9ebe373f4452a649e6ec716c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_783be5ac9ebe373f4452a649e6ec716c.png"></p><h3 id="æ•ˆæœï¼š"><a href="#æ•ˆæœï¼š" class="headerlink" title="æ•ˆæœï¼š"></a>æ•ˆæœï¼š</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_0eda9e294289189c56e00dfaf9005b76.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/10/image_0eda9e294289189c56e00dfaf9005b76.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://www.dongaigc.com/p/yokingma/search_with_ai">search_with_ai - æ„å»ºåŸºäºå¯¹è¯çš„AIæœç´¢ç³»ç»Ÿï¼Œé›†æˆå¤šç§æœç´¢å¼•æ“ä¸è¯­è¨€æ¨¡å‹ - æ‡‚AI (dongaigc.com)</a></p><p><a href="https://docs.openwebui.com/tutorials/features/web_search/">Web Search | Open WebUI</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockeréƒ¨ç½²nginxå¹¶å®ç°åå‘ä»£ç†æ·»åŠ sslè¯ä¹¦</title>
      <link href="/2024/10/10/docker%E9%83%A8%E7%BD%B2nginx%E5%B9%B6%E5%AE%9E%E7%8E%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%B7%BB%E5%8A%A0ssl%E8%AF%81%E4%B9%A6/"/>
      <url>/2024/10/10/docker%E9%83%A8%E7%BD%B2nginx%E5%B9%B6%E5%AE%9E%E7%8E%B0%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%B7%BB%E5%8A%A0ssl%E8%AF%81%E4%B9%A6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="dockeréƒ¨ç½²nginxå¹¶å®ç°åå‘ä»£ç†æ·»åŠ sslè¯ä¹¦"><a href="#dockeréƒ¨ç½²nginxå¹¶å®ç°åå‘ä»£ç†æ·»åŠ sslè¯ä¹¦" class="headerlink" title="dockeréƒ¨ç½²nginxå¹¶å®ç°åå‘ä»£ç†æ·»åŠ sslè¯ä¹¦"></a>dockeréƒ¨ç½²nginxå¹¶å®ç°åå‘ä»£ç†æ·»åŠ sslè¯ä¹¦</h1><h2 id="1-docker-composeæ–‡ä»¶"><a href="#1-docker-composeæ–‡ä»¶" class="headerlink" title="1. docker-composeæ–‡ä»¶"></a>1. docker-composeæ–‡ä»¶</h2><p>å…ˆä¸åšvolumes å¯åŠ¨å®¹å™¨</p><p>æˆåŠŸåå°†å®¹å™¨å†…ç›®å½•cpåˆ°å®¿ä¸»æœºå†åšvolumeæ“ä½œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">cp</span> nginx:/usr/share/nginx/html  ./ngin/html</span><br><span class="line">docker <span class="built_in">cp</span> nginx:/usr/share/nginx/key   ./nginx/key</span><br><span class="line">docker <span class="built_in">cp</span> nginx:/var/log/nginx         ./nginx/logs</span><br><span class="line">docker <span class="built_in">cp</span> nginx:/etc/nginx/nginx.conf  ./nginx/nginx.conf</span><br><span class="line">docker <span class="built_in">cp</span> nginx:/etc/nginx/conf.d      ./nginx/conf.d</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nginx:</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nginx</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nginx-latest</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">80</span><span class="string">:80</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">443</span><span class="string">:443</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./nginx/html:/usr/share/nginx/html</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./nginx/key:/usr/share/nginx/key</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./nginx/logs:/var/log/nginx</span></span><br><span class="line">      <span class="comment"># æœ‰å¯èƒ½ä¼šå‡ºç°ä¸èƒ½æŒ‚è½½ï¼Œè¿™ä¸ªæ—¶å€™ç”¨æ‰‹åŠ¨æ‹·è´é…ç½®æ–‡ä»¶å°±è¡Œ</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./nginx/nginx.conf:/etc/nginx/nginx.conf</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./nginx/conf.d:/etc/nginx/conf.d</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">NGINX_PORT=80</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h2 id="2-nginxé…ç½®åå‘ä»£ç†-é…ç½®æ–‡ä»¶"><a href="#2-nginxé…ç½®åå‘ä»£ç†-é…ç½®æ–‡ä»¶" class="headerlink" title="2.nginxé…ç½®åå‘ä»£ç† é…ç½®æ–‡ä»¶"></a>2.nginxé…ç½®åå‘ä»£ç† é…ç½®æ–‡ä»¶</h2><p>å°†ssl keyæ–‡ä»¶ä¸Šä¼ åˆ°ç›¸åº”ç›®å½•å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       80;</span><br><span class="line">    listen  [::]:80;</span><br><span class="line">    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#access_log  /var/log/nginx/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">        index  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    error_page   500 502 503 504  /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    root           html;</span></span><br><span class="line">    <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">    <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">    <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">    <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">    <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">    <span class="comment">#    deny  all;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 443 ssl; <span class="comment">#ç›‘å¬443ç«¯å£</span></span><br><span class="line">    server_name localhost; <span class="comment">#åŸŸå</span></span><br><span class="line">    root /usr/share/nginx/html; <span class="comment">#é¡¹ç›®çš„æ ¹ç›®å½•</span></span><br><span class="line">    index index.html index.htm;</span><br><span class="line">    ssl_certificate /usr/share/nginx/key/ssl.crt; <span class="comment">#sslé…ç½®æ–‡ä»¶ï¼ˆæ³¨æ„è·¯å¾„ï¼‰</span></span><br><span class="line">    ssl_certificate_key /usr/share/nginx/key/ssl_nopass.key; <span class="comment">#sslé…ç½®æ–‡ä»¶ï¼ˆæ³¨æ„è·¯å¾„ï¼‰</span></span><br><span class="line">    ssl_session_timeout 5m;</span><br><span class="line">    <span class="comment">#ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span></span><br><span class="line">    <span class="comment">#ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</span></span><br><span class="line">    ssl_prefer_server_ciphers on;</span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://58.40.166.66:8080;</span><br><span class="line">        <span class="comment">#index index.html index.htm;</span></span><br><span class="line">    &#125;</span><br><span class="line">    error_page 404 /404.html;</span><br><span class="line">        location = /40x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    error_page 500 502 503 504 /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s å›½äº§ä»ªè¡¨ç›˜kuboardéƒ¨ç½²</title>
      <link href="/2024/10/08/k8s%20%E5%9B%BD%E4%BA%A7%E4%BB%AA%E8%A1%A8%E7%9B%98kuboard%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/10/08/k8s%20%E5%9B%BD%E4%BA%A7%E4%BB%AA%E8%A1%A8%E7%9B%98kuboard%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="k8s-å›½äº§ä»ªè¡¨ç›˜kuboardéƒ¨ç½²"><a href="#k8s-å›½äº§ä»ªè¡¨ç›˜kuboardéƒ¨ç½²" class="headerlink" title="k8s å›½äº§ä»ªè¡¨ç›˜kuboardéƒ¨ç½²"></a>k8s å›½äº§ä»ªè¡¨ç›˜kuboardéƒ¨ç½²</h1><p>å®˜ç½‘ï¼š<a href="https://kuboard.cn/install/install-dashboard.html#%E8%AE%BF%E9%97%AEkuboard">å®‰è£… Kuboard v2 | Kuboard</a></p><ul><li>Kuboard v3.0 å·²ç»æ­£å¼å‘å¸ƒï¼Œç›¸è¾ƒäº Kuboard v2.0.xï¼Œ Kuboard v3 æœ€å¤§çš„ç‰¹ç‚¹æ˜¯æ”¯æŒå¤š Kubernetes é›†ç¾¤ç®¡ç†ï¼ŒåŒæ—¶ï¼Œåœ¨å„ä¸ªæ–¹é¢éƒ½æ¯” v2.0.x æœ‰äº†å¾ˆå¤§çš„æ”¹è¿›ã€‚ **å»ºè®®æ‚¨é€‰æ‹© <a href="https://kuboard.cn/install/v3/install.html">Kuboard v3</a>**ã€‚</li><li>Kuboard v2.0.x å°†è¿›å…¥é•¿æœŸç»´æŠ¤é˜¶æ®µï¼Œå¦‚æœç¢°åˆ°é—®é¢˜ï¼Œç”¨æˆ·ä»ç„¶å¯ä»¥åœ¨ç¾¤é‡Œæ‰¾ç¾¤ä¸»è§£å†³é—®é¢˜ã€‚å¦‚æœæ‚¨è®¡åˆ’å‡çº§åˆ° Kuboard v3ï¼Œè¯·å‚è€ƒ <a href="https://kuboard.cn/install/v3/install.html#%E4%BB%8E-v2.0.x-%E5%8D%87%E7%BA%A7%E5%88%B0-v3.0.x">ä» v2.0.x å‡çº§åˆ° v3.0.x</a></li></ul><p>å®‰è£… Kuboard æ—¶ï¼Œå‡è®¾æ‚¨å·²ç»æœ‰ä¸€ä¸ª Kubernetes é›†ç¾¤ï¼Œä»¥ä¸‹ä»»ä½•å½¢å¼å®‰è£…çš„é›†ç¾¤éƒ½å¯ä»¥ï¼š</p><ul><li>kubeadm å®‰è£…ï¼ˆæˆ–è€…åŸºäº kubeadm çš„è¡ç”Ÿå·¥å…·ï¼Œå¦‚ Sealos ç­‰ï¼‰ï¼›</li><li>äºŒè¿›åˆ¶å®‰è£…ï¼›</li><li>é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰å…¬æœ‰äº‘æ‰˜ç®¡é›†ç¾¤ï¼›</li><li>å…¶ä»–ã€‚</li></ul><p>å¦‚æœæ²¡æœ‰ Kubernetes é›†ç¾¤ï¼š</p><ul><li>åˆå­¦è€…ï¼Œè¯·å‚è€ƒ<ul><li><a href="https://kuboard.cn/install/install-docker-desktop.html">åœ¨ Windows/Mac å®‰è£… Kubernetes æµ‹è¯•é›†ç¾¤</a> <strong>ä¸æ¨è</strong></li><li><a href="https://kuboard.cn/install/install-k8s.html">ç¦»çº¿å®‰è£…é«˜å¯ç”¨çš„Kubernetesé›†ç¾¤</a> <strong>æ¨è</strong></li></ul></li><li>ç”¨äºç”Ÿäº§ï¼Œè¯·å‚è€ƒ <a href="https://kuboard.cn/install/install-kubernetes.html">å®‰è£… Kubernetes é«˜å¯ç”¨</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è…¾è®¯äº‘å†·è¿ç§» åˆ›å»ºè‡ªå®šä¹‰é•œåƒ å¯¼å…¥åˆ°å¯¹è±¡å­˜å‚¨</title>
      <link href="/2024/09/08/%E8%85%BE%E8%AE%AF%E4%BA%91%E5%86%B7%E8%BF%81%E7%A7%BB%20%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E9%95%9C%E5%83%8F%20%E5%AF%BC%E5%85%A5%E5%88%B0%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/"/>
      <url>/2024/09/08/%E8%85%BE%E8%AE%AF%E4%BA%91%E5%86%B7%E8%BF%81%E7%A7%BB%20%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E9%95%9C%E5%83%8F%20%E5%AF%BC%E5%85%A5%E5%88%B0%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="è…¾è®¯äº‘å†·è¿ç§»-åˆ›å»ºè‡ªå®šä¹‰é•œåƒ-å¯¼å…¥åˆ°å¯¹è±¡å­˜å‚¨"><a href="#è…¾è®¯äº‘å†·è¿ç§»-åˆ›å»ºè‡ªå®šä¹‰é•œåƒ-å¯¼å…¥åˆ°å¯¹è±¡å­˜å‚¨" class="headerlink" title="è…¾è®¯äº‘å†·è¿ç§» åˆ›å»ºè‡ªå®šä¹‰é•œåƒ å¯¼å…¥åˆ°å¯¹è±¡å­˜å‚¨"></a>è…¾è®¯äº‘å†·è¿ç§» åˆ›å»ºè‡ªå®šä¹‰é•œåƒ å¯¼å…¥åˆ°å¯¹è±¡å­˜å‚¨</h1><h2 id="æ“ä½œåœºæ™¯"><a href="#æ“ä½œåœºæ™¯" class="headerlink" title="æ“ä½œåœºæ™¯"></a>æ“ä½œåœºæ™¯</h2><p>é™¤äº†ä½¿ç”¨è…¾è®¯äº‘æä¾›çš„å…¬å…±é•œåƒã€æœåŠ¡å¸‚åœºé•œåƒå¤–ï¼Œæ‚¨è¿˜å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰é•œåƒã€‚åˆ›å»ºè‡ªå®šä¹‰é•œåƒåï¼Œæ‚¨å¯ä»¥åœ¨è…¾è®¯äº‘æ§åˆ¶å°å¿«é€Ÿåˆ›å»ºä¸è¯¥é•œåƒç›¸åŒé…ç½®çš„è…¾è®¯äº‘äº‘æœåŠ¡å™¨å®ä¾‹ã€‚</p><h2 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a><strong>è¯´æ˜</strong></h2><p>ç”±äºé•œåƒåº•å±‚ä½¿ç”¨äº†äº‘ç¡¬ç›˜å¿«ç…§æœåŠ¡ï¼š</p><p><strong>å›½å†…åœ°åŸŸæä¾›80GBçš„å…è´¹é¢åº¦ï¼Œè¯¦æƒ…è¯·å‚è§ <a href="https://cloud.tencent.com/document/product/362/32361#.E8.B5.A0.E9.80.81.E9.A2.9D.E5.BA.A6" title="https://cloud.tencent.com/document/product/362/32361#.E8.B5.A0.E9.80.81.E9.A2.9D.E5.BA.A6">èµ é€é¢åº¦</a>ã€‚</strong></p><p>åœ¨åˆ›å»ºè‡ªå®šä¹‰é•œåƒæ—¶ä¼šé»˜è®¤åˆ›å»ºå…³è”è¯¥é•œåƒçš„å¿«ç…§ï¼Œä¸”ä¿ç•™è‡ªå®šä¹‰é•œåƒä¼šäº§ç”Ÿä¸€å®šçš„å¿«ç…§è´¹ç”¨ï¼Œè¯¦æƒ…è¯·å‚è§ <a href="https://cloud.tencent.com/document/product/362/32361#Snapshot" title="https://cloud.tencent.com/document/product/362/32361#Snapshot">å¿«ç…§è®¡è´¹æ¦‚è¿°</a>ã€‚</p><p>è‹¥æ‚¨çš„è…¾è®¯äº‘è´¦æˆ·è¿›å…¥æ¬ è´¹çŠ¶æ€ï¼Œä¸ºé¿å…æ‚¨çš„æ•°æ®ä¸¢å¤±ï¼Œæˆ‘ä»¬å°†ä¿ç•™æ‚¨çš„è‡ªå®šä¹‰é•œåƒåŠå…³è”çš„å¿«ç…§ï¼Œä¸”ä¸ä¼šäº§ç”Ÿæ–°çš„è´¹ç”¨ã€‚</p><h2 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h2><p>æ¯ä¸ªåœ°åŸŸæš‚æ”¯æŒ500ä¸ªè‡ªå®šä¹‰é•œåƒã€‚</p><p><strong>å›½å†…åœ°åŸŸæä¾›80GBçš„å…è´¹é¢åº¦ï¼Œè¯¦æƒ…è¯·å‚è§ <a href="https://cloud.tencent.com/document/product/362/32361#.E8.B5.A0.E9.80.81.E9.A2.9D.E5.BA.A6" title="https://cloud.tencent.com/document/product/362/32361#.E8.B5.A0.E9.80.81.E9.A2.9D.E5.BA.A6">èµ é€é¢åº¦</a>ã€‚</strong></p><p>è‹¥æ‚¨çš„ Linux å®ä¾‹å…·å¤‡æ•°æ®ç›˜ï¼Œä½†æ‚¨ä»…åˆ¶ä½œç³»ç»Ÿç›˜è‡ªå®šä¹‰é•œåƒæ—¶ï¼Œè¯·ç¡®è®¤ <code>/etc/fstab</code> ä¸åŒ…å«æ•°æ®ç›˜é…ç½®ï¼Œå¦åˆ™ä¼šå¯¼è‡´ä½¿ç”¨è¯¥é•œåƒåˆ›å»ºçš„å®ä¾‹æ— æ³•æ­£å¸¸å¯åŠ¨ã€‚</p><p>åˆ¶ä½œè¿‡ç¨‹éœ€è¦æŒç»­ååˆ†é’Ÿæˆ–æ›´é•¿æ—¶é—´ï¼Œå…·ä½“æ—¶é—´ä¸å®ä¾‹çš„æ•°æ®å¤§å°æœ‰å…³ï¼Œè¯·æå‰åšå¥½ç›¸å…³å‡†å¤‡ï¼Œä»¥é˜²å½±å“ä¸šåŠ¡ã€‚</p><p>è‹¥æ‚¨çš„ Windows å®ä¾‹éœ€å…¥åŸŸä¸”ä½¿ç”¨åŸŸè´¦å·ï¼Œåˆ™åœ¨åˆ›å»ºè‡ªå®šä¹‰é•œåƒå‰ï¼Œè¯·æ‰§è¡Œ Sysprep æ“ä½œä»¥ç¡®ä¿åœ¨å®ä¾‹å…¥åŸŸå SID å”¯ä¸€ã€‚è¯¦æƒ…è¯·å‚è§ <a href="https://cloud.tencent.com/document/product/213/43498" title="https://cloud.tencent.com/document/product/213/43498">é€šè¿‡ Sysprep å®ç°äº‘æœåŠ¡å™¨å…¥åŸŸå SID å”¯ä¸€</a>ã€‚</p><p>è‹¥æ‚¨ä½¿ç”¨çš„æ˜¯é…ç½®25Gbps ç½‘å¡çš„è£¸é‡‘å±æœåŠ¡å™¨ï¼ˆå³æœºå‹çš„å†…ç½‘å¸¦å®½å€¼æ˜¯25Gbpsï¼‰ï¼Œæš‚ä¸æ”¯æŒä½¿ç”¨æ§åˆ¶å°åŠ API åˆ›å»ºè‡ªå®šä¹‰é•œåƒã€‚</p><h2 id="ä¸€-åˆ›å»ºè‡ªå®šä¹‰é•œåƒ"><a href="#ä¸€-åˆ›å»ºè‡ªå®šä¹‰é•œåƒ" class="headerlink" title="ä¸€.åˆ›å»ºè‡ªå®šä¹‰é•œåƒ"></a>ä¸€.åˆ›å»ºè‡ªå®šä¹‰é•œåƒ</h2><p><a href="https://cloud.tencent.com/document/product/213/4942">https://cloud.tencent.com/document/product/213/4942</a></p><p>è…¾è®¯äº‘å…è´¹èµ é€80Gå¿«ç…§é¢åº¦è¶…å‡ºéƒ¨åˆ†ä¼šæ”¶å–è´¹ç”¨  åˆ›å»ºè‡ªå®šä¹‰é•œåƒæ—¶ä¼šè‡ªåŠ¨åˆ›å»º åŸºäºè¯¥ç³»ç»Ÿç›˜æˆ–æ•°æ®ç›˜çš„å¿«ç…§ æ­¤æ—¶æŸ¥çœ‹å¯¹è±¡å­˜å‚¨ä¼šå‘ç°å·²ç»å­˜åœ¨  åŠå¿«ç…§ å·²åˆ›å»ºäº†ç›¸åº”å¿«ç…§</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_1e10563068279dd26f45815b8ff83077.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_1e10563068279dd26f45815b8ff83077.png"></p><h2 id="äºŒ-å°†é•œåƒå¯¼å‡ºåˆ°å¯¹è±¡å­˜å‚¨"><a href="#äºŒ-å°†é•œåƒå¯¼å‡ºåˆ°å¯¹è±¡å­˜å‚¨" class="headerlink" title="äºŒ.å°†é•œåƒå¯¼å‡ºåˆ°å¯¹è±¡å­˜å‚¨"></a>äºŒ.å°†é•œåƒå¯¼å‡ºåˆ°å¯¹è±¡å­˜å‚¨</h2><p><a href="https://cloud.tencent.com/document/product/213/70518">https://cloud.tencent.com/document/product/213/70518</a></p><h3 id="å‰ææ¡ä»¶"><a href="#å‰ææ¡ä»¶" class="headerlink" title="å‰ææ¡ä»¶"></a>å‰ææ¡ä»¶</h3><p>å·²å‰å¾€ <a href="https://console.cloud.tencent.com/cos" title="https://console.cloud.tencent.com/cos">å¯¹è±¡å­˜å‚¨æ§åˆ¶å°</a> å¼€é€šå¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚</p><h3 id="æ³¨æ„äº‹é¡¹-1"><a href="#æ³¨æ„äº‹é¡¹-1" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h3><p>æœ‰ç‰ˆæƒé™åˆ¶çš„é•œåƒä¸æ”¯æŒå¯¼å‡ºï¼ŒåŒ…æ‹¬ Windows Server é•œåƒã€è…¾è®¯äº‘æˆæƒçš„ Red Hat Enterprise Linux é•œåƒï¼ˆè‡ªå¸¦æˆæƒæ”¯æŒå¯¼å‡ºï¼‰ã€åŸºäºäº‘å¸‚åœºé•œåƒåˆ¶ä½œçš„è‡ªå®šä¹‰é•œåƒã€‚</p><p>è‡ªå®šä¹‰é•œåƒçš„ç³»ç»Ÿç›˜åŠæ•°æ®ç›˜å•å—å®¹é‡ä¸èƒ½å¤§äº500GBã€‚</p><p>å¯¼å‡ºæ•´æœºé•œåƒæ—¶ï¼Œæ•°æ®ç›˜ä¸èƒ½å¤§äº5å—ã€‚</p><h3 id="è´¹ç”¨è¯´æ˜"><a href="#è´¹ç”¨è¯´æ˜" class="headerlink" title="è´¹ç”¨è¯´æ˜"></a>è´¹ç”¨è¯´æ˜</h3><p>è‹¥åœ¨ä½¿ç”¨äº‘æœåŠ¡å™¨æ—¶ï¼ŒåŒæ—¶ä½¿ç”¨äº†å…¶ä»–äº§å“ã€‚ä¾‹å¦‚å¯¹è±¡å­˜å‚¨ COSï¼Œåˆ™å°†æŒ‰ç…§å®é™…ä½¿ç”¨äº§å“çš„è®¡è´¹è§„åˆ™è¿›è¡Œè´¹ç”¨è®¡ç®—ã€‚</p><p>è´¹ç”¨è¯´æ˜å¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th>åœºæ™¯</th><th>äº§ç”Ÿè´¹ç”¨</th><th>è¯´æ˜æ–‡æ¡£</th></tr></thead><tbody><tr><td>å¯¼å‡ºé•œåƒåˆ° COS å­˜å‚¨æ¡¶</td><td>å­˜å‚¨å®¹é‡è´¹ç”¨ã€‚é•œåƒå­˜å‚¨åœ¨ COS å­˜å‚¨æ¡¶ï¼Œä¼šäº§ç”Ÿå­˜å‚¨å®¹é‡è´¹ç”¨ã€‚COS ä¼šè®¡ç®—å¯¹è±¡å¤§å°ï¼ŒæŒ‰ç…§ç›®æ ‡å¯¹è±¡çš„å­˜å‚¨ç±»å‹å’Œæ‰€å±åœ°åŸŸè®¡è´¹ã€‚</td><td><a href="https://cloud.tencent.com/document/product/436/53482">å­˜å‚¨å®¹é‡è´¹ç”¨</a></td></tr><tr><td>è¯·æ±‚è´¹ç”¨ã€‚å¯¼å‡ºé•œåƒåˆ° COS å­˜å‚¨æ¡¶ï¼Œä¼šäº§ç”Ÿå†™è¯·æ±‚è´¹ç”¨ã€‚COS ä¼šè®¡ç®—å†™è¯·æ±‚æ¬¡æ•°ï¼Œå¹¶æ”¶å–è¯·æ±‚è´¹ç”¨ã€‚</td><td><a href="https://cloud.tencent.com/document/product/436/53861">è¯·æ±‚è´¹ç”¨</a></td><td></td></tr><tr><td>æµé‡è´¹ç”¨ã€‚å¯¼å‡ºé•œåƒåˆ° COS å­˜å‚¨æ¡¶ï¼Œä¼šäº§ç”Ÿä¸Šè¡Œæµé‡ã€‚COS ä¼šè®¡ç®—æµé‡å¤§å°ï¼Œå†…ç½‘ä¸Šè¡Œæµé‡ã€å¤–ç½‘ä¸Šè¡Œæµé‡å‡å…è´¹ã€‚</td><td><a href="https://cloud.tencent.com/document/product/436/53863">æµé‡è´¹ç”¨</a></td><td></td></tr><tr><td>ä» COS å­˜å‚¨æ¡¶ä¸‹è½½é•œåƒ</td><td>è¯·æ±‚è´¹ç”¨ã€‚ä» COS å­˜å‚¨æ¡¶ä¸‹è½½é•œåƒï¼Œä¼šäº§ç”Ÿå†™è¯·æ±‚è´¹ç”¨ã€‚COS ä¼šè®¡ç®—å†™è¯·æ±‚æ¬¡æ•°ï¼Œå¹¶æ”¶å–è¯·æ±‚è´¹ç”¨ã€‚</td><td><a href="https://cloud.tencent.com/document/product/436/53861">è¯·æ±‚è´¹ç”¨</a></td></tr><tr><td>æµé‡è´¹ç”¨ã€‚ä» COS å­˜å‚¨æ¡¶ä¸‹è½½é•œåƒï¼Œä¼šäº§ç”Ÿä¸‹è¡Œæµé‡ã€‚COS ä¼šè®¡ç®—æµé‡å¤§å°ï¼Œå†…ç½‘ä¸‹è¡Œæµé‡å…è´¹ã€å¤–ç½‘ä¸‹è¡Œæµé‡æ”¶è´¹ã€‚</td><td><a href="https://cloud.tencent.com/document/product/436/53863">æµé‡è´¹ç”¨</a></td><td></td></tr></tbody></table><h3 id="æ“ä½œæ­¥éª¤"><a href="#æ“ä½œæ­¥éª¤" class="headerlink" title="æ“ä½œæ­¥éª¤"></a>æ“ä½œæ­¥éª¤</h3><p><strong>1.</strong> ç™»å½•äº‘æœåŠ¡å™¨æ§åˆ¶å°ï¼Œé€‰æ‹©å·¦ä¾§å¯¼èˆªæ ä¸­çš„ <a href="https://console.cloud.tencent.com/cvm/image" title="https://console.cloud.tencent.com/cvm/image"><strong>é•œåƒ</strong></a>ã€‚</p><p><strong>2. <strong>åœ¨</strong>é•œåƒ</strong>é¡µé¢ä¸Šæ–¹ï¼Œé€‰æ‹©éœ€å¯¼å‡ºçš„è‡ªå®šä¹‰é•œåƒæ‰€åœ¨åœ°åŸŸï¼Œå¹¶å•å‡»<strong>è‡ªå®šä¹‰é•œåƒ</strong>é¡µç­¾ã€‚</p><p><strong>3. <strong>é€‰æ‹©é•œåƒæ‰€åœ¨è¡Œå³ä¾§çš„</strong>å¯¼å‡ºé•œåƒ</strong>ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_9369970747d3a7ebfc1d1c5f18f7088f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_9369970747d3a7ebfc1d1c5f18f7088f.png"></p><p>å¯¼å‡ºéœ€è¦å…ˆåˆ›å»ºå¯¹è±¡å­˜å‚¨æ¡¶</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_80c83d004f3c262c913749e5a3f5f0c8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_80c83d004f3c262c913749e5a3f5f0c8.png"></p><p>å¯¼å‡ºé•œåƒåˆ°å­˜å‚¨æ¡¶å¾ˆæ…¢ éœ€è¦è€å¿ƒç­‰å¾…</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_5601d2f308db90e9d3cc693f6c665719.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_5601d2f308db90e9d3cc693f6c665719.png"></p><ul><li><strong>COS Bucket</strong>ï¼šé€‰æ‹©å¯¼å‡ºé•œåƒæ‰€åœ¨çš„å­˜å‚¨æ¡¶ï¼Œéœ€ä¸é•œåƒåœ¨åŒä¸€åœ°åŸŸã€‚</li><li><strong>å¯¼å‡ºæ–‡ä»¶å‰ç¼€å</strong>ï¼šè‡ªå®šä¹‰å¯¼å‡ºæ–‡ä»¶å‰ç¼€åã€‚ å‹¾é€‰<strong>åŒæ„æˆæƒ CVM è®¿é—®æˆ‘çš„ COS Bucket</strong>ã€‚</li><li>æ›´å¤šé…ç½®ï¼ˆå¯é€‰ï¼‰ï¼šé•œåƒæ ¼å¼</li><li>ç›®å‰æ”¯æŒ RAWã€QCOW2ã€VHDï¼ˆåç¼€ä¸º .vpcæˆ–.vhdï¼‰ã€VMDK å››ç§æ ¼å¼ï¼Œæ‚¨å¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œé€‰æ‹©ã€‚</li><li>å¯¼å‡ºçš„é•œåƒæ–‡ä»¶å¤§å°ä¸é•œåƒæ ¼å¼æœ‰å…³ï¼Œå…·ä½“å€¼è¯·å®Œæˆå¯¼å‡ºåæŸ¥çœ‹å¯¹åº”çš„ COS æ–‡ä»¶ï¼Œé»˜è®¤é€‰æ‹© RAW æ ¼å¼ã€‚</li></ul><p><strong>5. <strong>å‹¾é€‰</strong>åŒæ„æˆæƒCVMè®¿é—®æˆ‘çš„COS Bucket</strong>ï¼Œå¹¶å•å‡»<strong>ç¡®å®š</strong>ï¼Œå³å¯å¼€å§‹é•œåƒå¯¼å‡ºä»»åŠ¡ã€‚</p><p><strong>6. <strong>åœ¨å¼¹å‡ºçš„ç¡®è®¤çª—å£ä¸­å•å‡»</strong>ç¡®å®š</strong>ã€‚ å¯¼å‡ºæ—¶é—´å–å†³äºé•œåƒçš„å¤§å°å’Œä»»åŠ¡é˜Ÿåˆ—çš„ç¹å¿™ç¨‹åº¦ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚å¯¼å‡ºä»»åŠ¡å®Œæˆåï¼Œé•œåƒæ–‡ä»¶å°†ä¼šå­˜æ”¾åœ¨ç›®æ ‡å­˜å‚¨æ¡¶ä¸­ã€‚æ‚¨å¯å‰å¾€ <a href="https://console.cloud.tencent.com/cos/bucket" title="https://console.cloud.tencent.com/cos/bucket">å­˜å‚¨æ¡¶åˆ—è¡¨</a> é¡µé¢ï¼Œå•å‡»å­˜å‚¨æ¡¶ ID è¿›å…¥è¯¦æƒ…é¡µé¢ï¼Œåä¸º <code>è‡ªå®šä¹‰å‰ç¼€å_é•œåƒ Id_system_ å¿«ç…§ id.é•œåƒæ ¼å¼ </code> çš„æ–‡ä»¶å³ä¸ºå¯¼å‡ºçš„é•œåƒç³»ç»Ÿç›˜æ–‡ä»¶ï¼Œè‹¥æ‚¨çš„é•œåƒåŒ…å«æ•°æ®ç›˜ï¼Œåä¸º <code>è‡ªå®šä¹‰å‰ç¼€å_é•œåƒ Id_data_ å¿«ç…§ id.é•œåƒæ ¼å¼</code> çš„æ–‡ä»¶å³ä¸ºå¯¼å‡ºçš„é•œåƒæ•°æ®ç›˜æ–‡ä»¶ã€‚</p><h2 id="ç›¸å…³é—®é¢˜"><a href="#ç›¸å…³é—®é¢˜" class="headerlink" title="ç›¸å…³é—®é¢˜"></a>ç›¸å…³é—®é¢˜</h2><h4 id="1-COS-çš„å¤–ç½‘ä¸‹è¡Œæµé‡å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿå¦‚ä½•æ”¶è´¹ï¼Ÿ"><a href="#1-COS-çš„å¤–ç½‘ä¸‹è¡Œæµé‡å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿå¦‚ä½•æ”¶è´¹ï¼Ÿ" class="headerlink" title="1. COS çš„å¤–ç½‘ä¸‹è¡Œæµé‡å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿå¦‚ä½•æ”¶è´¹ï¼Ÿ"></a>1. COS çš„å¤–ç½‘ä¸‹è¡Œæµé‡å¦‚ä½•äº§ç”Ÿçš„ï¼Ÿå¦‚ä½•æ”¶è´¹ï¼Ÿ</h4><p>å¤–ç½‘ä¸‹è¡Œæµé‡æ˜¯æ•°æ®é€šè¿‡äº’è”ç½‘ä» COS ä¼ è¾“åˆ°å®¢æˆ·ç«¯äº§ç”Ÿçš„æµé‡ã€‚ç”¨æˆ·ç›´æ¥é€šè¿‡<strong>å¯¹è±¡é“¾æ¥</strong>ä¸‹è½½å¯¹è±¡æˆ–é€šè¿‡<strong>é™æ€ç½‘ç«™æºç«™</strong>æµè§ˆå¯¹è±¡äº§ç”Ÿçš„æµé‡å±äºå¤–ç½‘ä¸‹è¡Œæµé‡ï¼Œå¯¹åº”è´¹ç”¨ä¸ºå¤–ç½‘ä¸‹è¡Œæµé‡è´¹ç”¨ã€‚å¤–ç½‘ä¸‹è¡Œæµé‡è®¡è´¹è¯¦ç»†ä¿¡æ¯è¯·å‚è§ <a href="https://cloud.tencent.com/document/product/436/40285" title="https://cloud.tencent.com/document/product/436/40285">è®¡è´¹é¡¹</a> å’Œ <a href="https://cloud.tencent.com/document/product/436/6239" title="https://cloud.tencent.com/document/product/436/6239">äº§å“å®šä»·</a>ã€‚</p><h4 id="2-é€šè¿‡-COS-çš„æ§åˆ¶å°ã€å·¥å…·ã€APIã€SDK-æ–¹å¼ä¸‹è½½æ–‡ä»¶ä¼šäº§ç”Ÿå¤–ç½‘ä¸‹è¡Œæµé‡è´¹ç”¨å—ï¼Ÿ"><a href="#2-é€šè¿‡-COS-çš„æ§åˆ¶å°ã€å·¥å…·ã€APIã€SDK-æ–¹å¼ä¸‹è½½æ–‡ä»¶ä¼šäº§ç”Ÿå¤–ç½‘ä¸‹è¡Œæµé‡è´¹ç”¨å—ï¼Ÿ" class="headerlink" title="2. é€šè¿‡ COS çš„æ§åˆ¶å°ã€å·¥å…·ã€APIã€SDK æ–¹å¼ä¸‹è½½æ–‡ä»¶ä¼šäº§ç”Ÿå¤–ç½‘ä¸‹è¡Œæµé‡è´¹ç”¨å—ï¼Ÿ"></a>2. é€šè¿‡ COS çš„æ§åˆ¶å°ã€å·¥å…·ã€APIã€SDK æ–¹å¼ä¸‹è½½æ–‡ä»¶ä¼šäº§ç”Ÿå¤–ç½‘ä¸‹è¡Œæµé‡è´¹ç”¨å—ï¼Ÿ</h4><p>è®¿é—® COS æ‰€äº§ç”Ÿçš„æµé‡ï¼ˆå†…ç½‘æµé‡æˆ–å¤–ç½‘æµé‡ï¼‰ä¸æ‚¨ä½¿ç”¨çš„æ–¹å¼æ— å…³ï¼Œåªæœ‰åŒåœ°åŸŸçš„äº‘äº§å“è®¿é—® COS æ‰ä¼šé»˜è®¤ä½¿ç”¨å†…ç½‘è€Œä¸æ”¶å–å¤–ç½‘ä¸‹è¡Œæµé‡è´¹ç”¨ã€‚åˆ¤æ–­æ˜¯å¦å†…ç½‘è®¿é—®è¯·å‚è§ <a href="https://cloud.tencent.com/document/product/436/31315#network">å†…ç½‘è®¿é—®</a> æ–‡æ¡£ã€‚</p><h4 id="3-COS-å¦‚ä½•åŒºåˆ†å¤–ç½‘æµé‡ï¼Ÿ"><a href="#3-COS-å¦‚ä½•åŒºåˆ†å¤–ç½‘æµé‡ï¼Ÿ" class="headerlink" title="3. COS å¦‚ä½•åŒºåˆ†å¤–ç½‘æµé‡ï¼Ÿ"></a>3. COS å¦‚ä½•åŒºåˆ†å¤–ç½‘æµé‡ï¼Ÿ</h4><p>å¤–ç½‘ä¸‹è¡Œæµé‡æŒ‡æ•°æ®é€šè¿‡äº’è”ç½‘ä» COS ä¼ è¾“åˆ°å®¢æˆ·ç«¯äº§ç”Ÿçš„æµé‡ã€‚ä¾‹å¦‚é€šè¿‡ COS æ§åˆ¶å°ä¸‹è½½å­˜å‚¨åœ¨ COS ä¸­çš„æ–‡ä»¶ï¼Œé€šè¿‡å·¥å…·è®¿é—®å¯¹è±¡ã€ä¸‹è½½å¯¹è±¡ï¼Œæˆ–ä½¿ç”¨æµè§ˆå™¨é¢„è§ˆå¯¹è±¡ï¼Œä½¿ç”¨å¯¹è±¡åœ°å€æˆ–è‡ªå®šä¹‰åŸŸåè®¿é—®å’Œä¸‹è½½å¯¹è±¡ç­‰å‡ä¼šäº§ç”Ÿå¤–ç½‘ä¸‹è¡Œæµé‡ ã€‚è¯¦æƒ…è¯·å‚è§ <a href="https://cloud.tencent.com/document/product/436/31315#.E5.86.85.E7.BD.91.E8.AE.BF.E9.97.AE.E5.88.A4.E6.96.AD.E6.96.B9.E6.B3.95">å†…ç½‘è®¿é—®åˆ¤æ–­</a> æ–‡æ¡£ã€‚</p><h4 id="4-å¯¹è±¡å­˜å‚¨ä½¿ç”¨å†…ç½‘è®¿é—®æ˜¯å¦ä¼šäº§ç”Ÿè´¹ç”¨ï¼Ÿ"><a href="#4-å¯¹è±¡å­˜å‚¨ä½¿ç”¨å†…ç½‘è®¿é—®æ˜¯å¦ä¼šäº§ç”Ÿè´¹ç”¨ï¼Ÿ" class="headerlink" title="4. å¯¹è±¡å­˜å‚¨ä½¿ç”¨å†…ç½‘è®¿é—®æ˜¯å¦ä¼šäº§ç”Ÿè´¹ç”¨ï¼Ÿ"></a>4. å¯¹è±¡å­˜å‚¨ä½¿ç”¨å†…ç½‘è®¿é—®æ˜¯å¦ä¼šäº§ç”Ÿè´¹ç”¨ï¼Ÿ</h4><p>é€šè¿‡å†…ç½‘è®¿é—®å¯¹è±¡å­˜å‚¨æ—¶<strong>æµé‡è´¹ç”¨å…è´¹</strong>ï¼Œä½†æ˜¯<strong>å­˜å‚¨å®¹é‡</strong>å’Œ<strong>è¯·æ±‚æ¬¡æ•°</strong>ä»ç„¶ä¼šäº§ç”Ÿç›¸å…³çš„è´¹ç”¨ã€‚è¯¦ç»†ä»‹ç»è¯·å‚è§ <a href="https://cloud.tencent.com/document/product/436/40285" title="https://cloud.tencent.com/document/product/436/40285">è®¡è´¹é¡¹</a>ã€‚</p><h2 id="ä¸‰-åœ¨å¯¹è±¡å­˜å‚¨æ¡¶ä¸­ä¸‹è½½å¯¼å‡ºçš„é•œåƒ"><a href="#ä¸‰-åœ¨å¯¹è±¡å­˜å‚¨æ¡¶ä¸­ä¸‹è½½å¯¼å‡ºçš„é•œåƒ" class="headerlink" title="ä¸‰. åœ¨å¯¹è±¡å­˜å‚¨æ¡¶ä¸­ä¸‹è½½å¯¼å‡ºçš„é•œåƒ"></a>ä¸‰. åœ¨å¯¹è±¡å­˜å‚¨æ¡¶ä¸­ä¸‹è½½å¯¼å‡ºçš„é•œåƒ</h2><p>ä¸‹è½½é•œåƒï¼šåˆ›å»º<strong>SecretIDã€SecretKey</strong> åŠ<a href="https://cloud.tencent.com/document/product/436/11366#.E4.B8.8B.E8.BD.BD.E4.B8.8E.E5.AE.89.E8.A3.85"> cosbrowers</a>å®¢æˆ·ç«¯</p><p>å·²åœ¨è‡ªå®šä¹‰é•œåƒæ‰€åœ¨åœ°åŸŸåˆ›å»ºå­˜å‚¨æ¡¶ï¼Œè¯¦æƒ…è¯·å‚è§ <a href="https://cloud.tencent.com/document/product/436/13309" title="https://cloud.tencent.com/document/product/436/13309">åˆ›å»ºå­˜å‚¨æ¡¶</a>ã€‚</p><p>COSBrowser æ”¯æŒé€šè¿‡æ°¸ä¹…å¯†é’¥ï¼ˆå³äº‘ API å¯†é’¥ï¼‰ç™»å½•ï¼Œé…ç½®é¡¹è¯´æ˜å¦‚ä¸‹ï¼š</p><p><strong>SecretIDã€SecretKey</strong>ï¼šäº‘ API å¯†é’¥ï¼Œè¯¥å¯†é’¥å¯åœ¨<strong>è®¿é—®ç®¡ç†æ§åˆ¶å°</strong>çš„ <a href="https://console.cloud.tencent.com/cam/capi" title="https://console.cloud.tencent.com/cam/capi">API å¯†é’¥ç®¡ç†</a> é¡µé¢ä¸­åˆ›å»ºå¹¶è·å–ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_6a244e9e5bcf42c53d12b861e183e51f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_6a244e9e5bcf42c53d12b861e183e51f.png"></p><p>ç™»å½•cosbroeser ç‚¹å‡»åˆ†äº«æŒ‰é’®å³å¯ç”Ÿæˆä¸‹è½½é“¾æ¥</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_2754cc769bd62c1928bb71d48c09e58b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_2754cc769bd62c1928bb71d48c09e58b.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_b39ce7c13bed20caeb05f833fb1a0f28.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_b39ce7c13bed20caeb05f833fb1a0f28.png"></p><p><strong>å­˜å‚¨æ¡¶/æ”¶è—è·¯å¾„</strong>ï¼šè‹¥æ‚¨å½“å‰ä½¿ç”¨çš„å¯†é’¥ä»…å…è®¸è®¿é—®æŒ‡å®šèµ„æºèŒƒå›´ä¸”ä¸å…è®¸è®¿é—®å­˜å‚¨æ¡¶åˆ—è¡¨ï¼Œä¾‹å¦‚æŒ‡å®šçš„å­˜å‚¨æ¡¶æˆ–å­˜å‚¨æ¡¶ä¸­æŸä¸ªè·¯å¾„ï¼Œåˆ™å¡«å†™åå¯å¿«é€Ÿè¿›å…¥å¯¹åº”çš„å­˜å‚¨æ¡¶æˆ–æ–‡ä»¶è·¯å¾„ã€‚æ ¼å¼ä¸ºï¼šBucket æˆ– Bucket/Object-prefixï¼Œä¾‹å¦‚å½“å‰ä½¿ç”¨çš„å¯†é’¥ä»…è¢«å…è®¸è®¿é—®å­˜å‚¨æ¡¶ examplebucket-1250000000 ä¸‹çš„ doc æ–‡ä»¶å¤¹ï¼Œåˆ™å¡«å†™ examplebucket-1250000000/docã€‚æ“ä½œæŒ‡å¼•è¯·å‚è§ <a href="/document/product/436/38103#path">æ·»åŠ æ”¶è—è·¯å¾„</a>ã€‚</p><p><strong>å¤‡æ³¨</strong>ï¼šå¯å¯¹å½“å‰å¡«å…¥çš„æ°¸ä¹…å¯†é’¥è¿›è¡Œè¯´æ˜ã€‚ä¾‹å¦‚æ“ä½œäººå‘˜ã€ç”¨é€”ç­‰ã€‚åœ¨<strong>å†å²ä¼šè¯</strong>ä¸­å¯ç”¨äºåŒºåˆ†ä¸åŒçš„ SecretIDã€‚</p><p><strong>è®°ä½ä¼šè¯</strong>ï¼š</p><p>è‹¥ä¸å‹¾é€‰ï¼Œåˆ™ä»…æœ¬æ¬¡ç™»å½•æœ‰æ•ˆï¼Œé€€å‡ºç™»å½•åˆ™ä¼šæ¸…ç©ºå¡«å…¥çš„äº‘ API å¯†é’¥ï¼ˆå¦‚æœå½“å‰å¯†é’¥å·²ä¿å­˜åœ¨å†å²ä¼šè¯ä¸­ï¼Œåˆ™ä¼šä»å†å²ä¼šè¯ä¸­ç§»é™¤ï¼‰ï¼›</p><p>è‹¥å‹¾é€‰ï¼Œåœ¨æˆåŠŸç™»å½•åå°†ä¼šè®°ä½å¡«å…¥çš„äº‘ API å¯†é’¥ç›¸å…³ä¿¡æ¯ï¼Œæ–¹ä¾¿ä¸‹æ¬¡ç»§ç»­ä½¿ç”¨ï¼Œæ‚¨å¯åœ¨<strong>å†å²ä¼šè¯</strong>ä¸­ç®¡ç†å·²ä¿å­˜çš„å¯†é’¥ç›¸å…³ä¿¡æ¯ã€‚</p><h2 id="å››-æœ€åè¿ç§»æ•°æ®ç›˜"><a href="#å››-æœ€åè¿ç§»æ•°æ®ç›˜" class="headerlink" title="å››. æœ€åè¿ç§»æ•°æ®ç›˜"></a>å››. æœ€åè¿ç§»æ•°æ®ç›˜</h2><p>ä½¿ç”¨å¦‚ä¸‹ddå‘½ä»¤è¿ç§»ï¼ˆæ ‡å‡†åŒ–å‘½ä»¤ï¼‰</p><p>è¿ç§»æ—¶å¿…é¡»è¦å¯¹åº”æœ¬åœ°ç£ç›˜æ‰€åœ¨çš„åˆ†åŒºä»¥åŠä¸è¿ç§»åå¯¹ç«¯ç£ç›˜æ‰€åœ¨çš„åˆ†åŒºå¯¹åº”</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># qcow2 è½¬ raw</span></span><br><span class="line">qemu-img convert -f qcow2 -O raw Qcms1-data.qcow2 Qcms1-data.raw</span><br><span class="line"><span class="comment"># å¼€å§‹è¿ç§»</span></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/data/Qcms2-data.raw of=/dev/vdd bs=64M status=progress  </span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Tencent </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Tencent </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows11ä½¿ç”¨dockeréƒ¨ç½²ollamaè°ƒç”¨åº•å±‚GPU</title>
      <link href="/2024/09/05/windows11%E4%BD%BF%E7%94%A8docker%E9%83%A8%E7%BD%B2ollama%E8%B0%83%E7%94%A8%E5%BA%95%E5%B1%82GPU/"/>
      <url>/2024/09/05/windows11%E4%BD%BF%E7%94%A8docker%E9%83%A8%E7%BD%B2ollama%E8%B0%83%E7%94%A8%E5%BA%95%E5%B1%82GPU/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="windows11ä½¿ç”¨dockeréƒ¨ç½²ollamaè°ƒç”¨åº•å±‚GPU"><a href="#windows11ä½¿ç”¨dockeréƒ¨ç½²ollamaè°ƒç”¨åº•å±‚GPU" class="headerlink" title="windows11ä½¿ç”¨dockeréƒ¨ç½²ollamaè°ƒç”¨åº•å±‚GPU"></a>windows11ä½¿ç”¨dockeréƒ¨ç½²ollamaè°ƒç”¨åº•å±‚GPU</h1><blockquote><p>æœ¬æœºç¯å¢ƒWindows 11 å®¶åº­ç‰ˆï¼š</p><p>è®¾å¤‡åç§°    ZZNN-GEGEWU<br>å¤„ç†å™¨    Intel(R) Core(TM) i5-8300H CPU @ 2.30GHz   2.30 GHz<br>æœºå¸¦ RAM  24.0 GB (23.9 GB å¯ç”¨)<br>è®¾å¤‡ ID    8DA62972-C11C-4E08-9039-18D34E439F64<br>äº§å“ ID    00326-10000-00000-AA043<br>ç³»ç»Ÿç±»å‹    64 ä½æ“ä½œç³»ç»Ÿ, åŸºäº x64 çš„å¤„ç†å™¨<br>ç¬”å’Œè§¦æ§    æ²¡æœ‰å¯ç”¨äºæ­¤æ˜¾ç¤ºå™¨çš„ç¬”æˆ–è§¦æ§è¾“å…¥</p><p>Docker Compose version v2.26.1</p><p>Docker version 26.1.1, build 4cf5afa</p><p>æ˜¾å¡é©±åŠ¨å®‰è£…ï¼š<a href="https://www.nvidia.cn/Download/index.aspx?lang=cn">https://www.nvidia.cn/Download/index.aspx?lang=cn</a></p></blockquote><h1 id="æ³•1ï¼ˆè‹¥æ­¤ç§æ–¹æ³•å¤±è´¥åˆ™éœ€è¦ä½¿ç”¨æ³•2ï¼‰"><a href="#æ³•1ï¼ˆè‹¥æ­¤ç§æ–¹æ³•å¤±è´¥åˆ™éœ€è¦ä½¿ç”¨æ³•2ï¼‰" class="headerlink" title="æ³•1ï¼ˆè‹¥æ­¤ç§æ–¹æ³•å¤±è´¥åˆ™éœ€è¦ä½¿ç”¨æ³•2ï¼‰"></a>æ³•1ï¼ˆè‹¥æ­¤ç§æ–¹æ³•å¤±è´¥åˆ™éœ€è¦ä½¿ç”¨æ³•2ï¼‰</h1><h2 id="å…ˆå†³æ¡ä»¶"><a href="#å…ˆå†³æ¡ä»¶" class="headerlink" title="å…ˆå†³æ¡ä»¶"></a>å…ˆå†³æ¡ä»¶</h2><ul><li><p>windowsæœåŠ¡å™¨éœ€è¦å®‰è£…å®Œæˆæ˜¾å¡é©±åŠ¨ cudaå¯ä¸å®‰è£…</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_3681de459ca48bb2c659f234f6d2b879.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_3681de459ca48bb2c659f234f6d2b879.png"></p></li></ul><p>éƒ¨ç½²è°ƒç”¨åº•å±‚GPUç‰ˆ docker-composeæ–‡ä»¶å¦‚ä¸‹ï¼š</p><p>å¤‡æ³¨ï¼š</p><ul><li>æœ€æ–°ç‰ˆdocker-destopå®šä¹‰æ–‡ä»¶æ–¹å¼å·²å‘ç”Ÿæ”¹å˜éœ€è¦å»æ‰<code>version: &#39;3.8&#39;</code></li><li>å¹¶ä¸”å»ºç«‹ç¯å¢ƒå˜é‡å®šä¹‰é¡¹ç›®åç§°ç¯å¢ƒå˜é‡ä¸º.env<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">COMPOSE_PROJECT_NAME=myproject</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># version: &#x27;3.8&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">ollama:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">ollama/ollama:latest</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">11434</span><span class="string">:11434</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./ollama:/root/.ollama</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">ollama</span></span><br><span class="line">    <span class="comment"># pull_policy: if_not_present</span></span><br><span class="line">    <span class="comment"># tty: true</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">KEEP_GPUS_TIMEOUT:</span> <span class="number">40</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">OLLAMA_ORIGINS:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">      <span class="attr">OLLAMA_HOST:</span> <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ollama-docker</span></span><br><span class="line">    <span class="comment"># GPU support</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">reservations:</span></span><br><span class="line">          <span class="attr">devices:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="attr">driver:</span> <span class="string">nvidia</span></span><br><span class="line">              <span class="attr">count:</span> <span class="number">1</span></span><br><span class="line">              <span class="attr">capabilities:</span></span><br><span class="line">                <span class="bullet">-</span> <span class="string">gpu</span></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:open-webui-main</span> </span><br><span class="line">    <span class="comment">#ghcr.io/open-webui/open-webui:main</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">open-webui</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3000:8080&quot;</span></span><br><span class="line">    <span class="attr">extra_hosts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;host.docker.internal:host-gateway&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">open-webui:/app/backend/data</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">ENABLE_RAG_WEB_SEARCH:</span> <span class="literal">True</span></span><br><span class="line">      <span class="attr">RAG_WEB_SEARCH_ENGINE:</span> <span class="string">&quot;searxng&quot;</span></span><br><span class="line">      <span class="attr">RAG_WEB_SEARCH_RESULT_COUNT:</span> <span class="number">3</span></span><br><span class="line">      <span class="attr">RAG_WEB_SEARCH_CONCURRENT_REQUESTS:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">SEARXNG_QUERY_URL:</span> <span class="string">&quot;http://searxng:8080/search?q=&lt;query&gt;&quot;</span></span><br><span class="line">      <span class="attr">ENABLE_OPENAI_API:</span> <span class="literal">False</span></span><br><span class="line">  <span class="comment"># open-webui:</span></span><br><span class="line">  <span class="comment">#   image: ghcr.io/open-webui/open-webui:main</span></span><br><span class="line">  <span class="comment">#   container_name: open-webui</span></span><br><span class="line">  <span class="comment">#   pull_policy: if_not_present</span></span><br><span class="line">  <span class="comment">#   volumes:</span></span><br><span class="line">  <span class="comment">#     - ./data:/app/backend/data</span></span><br><span class="line">  <span class="comment">#   depends_on:</span></span><br><span class="line">  <span class="comment">#     - ollama</span></span><br><span class="line">  <span class="comment">#   ports:</span></span><br><span class="line">  <span class="comment">#     - 3000:8080</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     - &#x27;OLLAMA_BASE_URL=http://ollama:11434&#x27;</span></span><br><span class="line">  <span class="comment">#     - &#x27;WEBUI_SECRET_KEY=sdjfvdklfbvkkgb&#x27;</span></span><br><span class="line">  <span class="comment">#     - &#x27;HF_ENDPOINT=https://hf-mirror.com&#x27;</span></span><br><span class="line">  <span class="comment">#   extra_hosts:</span></span><br><span class="line">  <span class="comment">#     - host.docker.internal:host-gateway</span></span><br><span class="line">  <span class="comment">#   restart: unless-stopped</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ollama-docker</span></span><br><span class="line">  </span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">ollama-docker:</span></span><br><span class="line">    <span class="attr">external:</span> <span class="literal">false</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¤‡æ³¨ï¼šç›´æ¥docker-compose up -d å³å¯ å½“æé—®AIæ—¶å³å¯çœ‹åˆ°æ˜¾å¡æ­£åœ¨ä½¿ç”¨ä¸­</p><p>æ•ˆæœï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_4884db6dbb46d13571e834ae4ea846db.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_4884db6dbb46d13571e834ae4ea846db.png"></p><h1 id="æ³•2-ï¼ˆéœ€è¦å¼€å¯ç§‘å­¦ä¸Šç½‘ï¼‰"><a href="#æ³•2-ï¼ˆéœ€è¦å¼€å¯ç§‘å­¦ä¸Šç½‘ï¼‰" class="headerlink" title="æ³•2 ï¼ˆéœ€è¦å¼€å¯ç§‘å­¦ä¸Šç½‘ï¼‰"></a>æ³•2 ï¼ˆéœ€è¦å¼€å¯ç§‘å­¦ä¸Šç½‘ï¼‰</h1><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/ndscvipuser/article/details/136610169">Windows ä¸‹è®© Docker Desktop å…³è”ä¸Š NVidia GPU</a></p><p>(æœ‰æ—¶å€™æ³•1ä¼šå¤±è´¥æ­¤æ—¶æˆ‘ä»¬éœ€è¦é…ç½®windowsä¸‹çš„linuxå­ç³»ç»Ÿä¸­çš„ubuntu20.04)</p><p>å…ˆå†³æ¡ä»¶ï¼š</p><p>wsl å®‰è£…Ubuntu20.04 å®‰è£…å®Œæˆååœ¨ubuntu20.04ä¸­æ‰§è¡Œä¸‹æ–¹å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ubuntu20.04çš„linuxå­ç³»ç»Ÿ</span></span><br><span class="line">wsl --install Ubuntu-20.04</span><br><span class="line"><span class="comment"># è¾“å…¥ç”¨æˆ·ååŠå¯†ç åå³å¯ç™»å½•æ“ä½œ</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_a355e98355b8dd6acbbf926f50621dcd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_a355e98355b8dd6acbbf926f50621dcd.png"></p><h3 id="1-å®‰è£…é…ç½®ï¼šnvidia-container-toolkit"><a href="#1-å®‰è£…é…ç½®ï¼šnvidia-container-toolkit" class="headerlink" title="1.å®‰è£…é…ç½®ï¼šnvidia-container-toolkit"></a>1.å®‰è£…é…ç½®ï¼šnvidia-container-toolkit</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.é…ç½®aptæº</span></span><br><span class="line">curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \</span><br><span class="line">  &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \</span><br><span class="line">    sed <span class="string">&#x27;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#x27;</span> | \</span><br><span class="line">    sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/nvidia-container-toolkit.list</span><br><span class="line"><span class="comment"># 2.æ›´æ–°æº</span></span><br><span class="line">sudo apt-get update</span><br><span class="line"><span class="comment"># 3.å®‰è£…å·¥å…·åŒ…</span></span><br><span class="line">sudo apt-get install -y nvidia-container-toolkit</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2-é…ç½®-Docker-Daemon-æœ¬æ–‡åˆ°æ­¤æˆåŠŸ-å¤§å¤šæ•°åˆ°æ­¤æ­¥éª¤ä¹Ÿèƒ½æˆåŠŸ"><a href="#2-é…ç½®-Docker-Daemon-æœ¬æ–‡åˆ°æ­¤æˆåŠŸ-å¤§å¤šæ•°åˆ°æ­¤æ­¥éª¤ä¹Ÿèƒ½æˆåŠŸ" class="headerlink" title="2. é…ç½® Docker Daemon(æœ¬æ–‡åˆ°æ­¤æˆåŠŸ  å¤§å¤šæ•°åˆ°æ­¤æ­¥éª¤ä¹Ÿèƒ½æˆåŠŸ)"></a>2. é…ç½® Docker Daemon(æœ¬æ–‡åˆ°æ­¤æˆåŠŸ  å¤§å¤šæ•°åˆ°æ­¤æ­¥éª¤ä¹Ÿèƒ½æˆåŠŸ)</h3><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½® Docker Daemonv</span></span><br><span class="line">sudo nvidia-ctk runtime configure --runtime=docker</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_1ccffe079986dbb376925fa3f44903f8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_1ccffe079986dbb376925fa3f44903f8.png"></p><p>æ­¤æ—¶éªŒè¯ollamaèƒ½å¦æ­£å¸¸ä½¿ç”¨GPU è‹¥ä¸èƒ½æ­£å¸¸ä½¿ç”¨åˆ™ç»§ç»­ä¸‹æ–¹æ“ä½œ</p><p>æ›´å¥½çš„åŠæ³•æ˜¯æ‰“å¼€ Docker Desktop å¦‚ä¸‹æ“ä½œä¹‹åï¼ˆé…ç½®Docker Engineï¼‰ï¼Œå†é‡å¯ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;builder&quot;:</span> &#123;</span><br><span class="line">    <span class="attr">&quot;gc&quot;:</span> &#123;</span><br><span class="line">      <span class="attr">&quot;defaultKeepStorage&quot;:</span> <span class="string">&quot;20GB&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;enabled&quot;:</span> <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">&quot;runtimes&quot;:</span> &#123;</span><br><span class="line">    <span class="attr">&quot;nvidia&quot;:</span> &#123;</span><br><span class="line">      <span class="attr">&quot;path&quot;:</span> <span class="string">&quot;nvidia-container-runtime&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;args&quot;:</span> []</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  <span class="attr">&quot;experimental&quot;:</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_8f0767c043af01a08fa4b37669543d18.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_8f0767c043af01a08fa4b37669543d18.png"></p><p>æ„å»ºå®Œæˆåæ•ˆæœï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_4defc9e7779786f13126a5b0c95d6b82.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_4defc9e7779786f13126a5b0c95d6b82.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/u011026329/article/details/137829768">windows ä¸‹ docker compose å®‰è£… ollama å’Œ open-webui ï¼Œæ‰“é€ ç§æœ‰GPT_windowsç³»ç»Ÿå®‰è£…dockerå¹¶éƒ¨æš‘open webui</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨partedåœ¨çº¿æŒ‡å®šå¤§å°ç»™ç£ç›˜æ‰©å®¹</title>
      <link href="/2024/08/27/%E4%BD%BF%E7%94%A8parted%E5%9C%A8%E7%BA%BF%E6%8C%87%E5%AE%9A%E5%A4%A7%E5%B0%8F%E7%BB%99%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/"/>
      <url>/2024/08/27/%E4%BD%BF%E7%94%A8parted%E5%9C%A8%E7%BA%BF%E6%8C%87%E5%AE%9A%E5%A4%A7%E5%B0%8F%E7%BB%99%E7%A3%81%E7%9B%98%E6%89%A9%E5%AE%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä½¿ç”¨partedåœ¨çº¿æŒ‡å®šå¤§å°ç»™ç£ç›˜æ‰©å®¹"><a href="#ä½¿ç”¨partedåœ¨çº¿æŒ‡å®šå¤§å°ç»™ç£ç›˜æ‰©å®¹" class="headerlink" title="ä½¿ç”¨partedåœ¨çº¿æŒ‡å®šå¤§å°ç»™ç£ç›˜æ‰©å®¹"></a>ä½¿ç”¨partedåœ¨çº¿æŒ‡å®šå¤§å°ç»™ç£ç›˜æ‰©å®¹</h1><h3 id="ç°è±¡ï¼ˆç»™åˆ†åŒºsdb1-æ‰©å®¹-5G-æ‰©å®¹åˆ°-15Gï¼‰"><a href="#ç°è±¡ï¼ˆç»™åˆ†åŒºsdb1-æ‰©å®¹-5G-æ‰©å®¹åˆ°-15Gï¼‰" class="headerlink" title="ç°è±¡ï¼ˆç»™åˆ†åŒºsdb1 æ‰©å®¹ 5G æ‰©å®¹åˆ° 15Gï¼‰"></a>ç°è±¡ï¼ˆç»™åˆ†åŒºsdb1 æ‰©å®¹ 5G æ‰©å®¹åˆ° 15Gï¼‰</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_48737925754965e5d3916bfda04de920.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_48737925754965e5d3916bfda04de920.png"></p><h3 id="æ‰§è¡Œ"><a href="#æ‰§è¡Œ" class="headerlink" title="æ‰§è¡Œ"></a>æ‰§è¡Œ</h3><h4 id="å‘½ä»¤æ¦‚è§ˆ"><a href="#å‘½ä»¤æ¦‚è§ˆ" class="headerlink" title="å‘½ä»¤æ¦‚è§ˆ"></a>å‘½ä»¤æ¦‚è§ˆ</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰§è¡Œå‰å…ˆå¸è½½ç£ç›˜</span></span><br><span class="line">umount /dev/sdb1</span><br><span class="line"><span class="comment"># æŸ¥çœ‹åˆ†åŒºè¯¦æƒ…</span></span><br><span class="line">lsblk </span><br><span class="line">fdisk -l</span><br><span class="line"><span class="comment"># æ‰§è¡Œæ‰©å®¹</span></span><br><span class="line">parted /dev/sdb (è¾“å…¥<span class="built_in">print</span>)</span><br><span class="line"><span class="comment"># æ‰§è¡Œresizepartå‘½ä»¤ç»™ç£ç›˜åˆ†åŒºsdb1å¢åŠ å®¹é‡ 1æ˜¯åˆ†åŒºå·å³sdb1</span></span><br><span class="line">(parted) resizepart 1 15GB</span><br><span class="line"><span class="comment"># æ­¤æ—¶é€€å‡º å®ƒä¼šè‡ªåŠ¨ä¿å­˜</span></span><br><span class="line">quiet</span><br><span class="line"><span class="comment"># å¼ºåˆ¶æ£€æŸ¥å¹¶ä¿®å¤åˆ†åŒºï¼ˆå¯é€‰ï¼‰</span></span><br><span class="line">e2fsck -f /dev/sdb1</span><br><span class="line">resize2fs /dev/sdb1</span><br><span class="line"><span class="comment"># æ­¤æ—¶æŒ‚è½½å³å¯</span></span><br><span class="line">mount /dev/sdb1 /mnt</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_c635eae45ea835c51d33ab8631a2df2a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_c635eae45ea835c51d33ab8631a2df2a.png"></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ollama llama3ä¸­æ–‡å¾®è°ƒç‰ˆæ¨¡å‹éƒ¨ç½²</title>
      <link href="/2024/08/21/ollama%20llama3%E4%B8%AD%E6%96%87%E5%BE%AE%E8%B0%83%E7%89%88%E6%A8%A1%E5%9E%8B%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/08/21/ollama%20llama3%E4%B8%AD%E6%96%87%E5%BE%AE%E8%B0%83%E7%89%88%E6%A8%A1%E5%9E%8B%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ollama-llama3ä¸­æ–‡å¾®è°ƒç‰ˆæ¨¡å‹éƒ¨ç½²"><a href="#ollama-llama3ä¸­æ–‡å¾®è°ƒç‰ˆæ¨¡å‹éƒ¨ç½²" class="headerlink" title="ollama llama3ä¸­æ–‡å¾®è°ƒç‰ˆæ¨¡å‹éƒ¨ç½²"></a>ollama llama3ä¸­æ–‡å¾®è°ƒç‰ˆæ¨¡å‹éƒ¨ç½²</h1><h2 id="ä¸€-åˆ©ç”¨-Ollama-æœ¬åœ°éƒ¨ç½²-Llama3-ä¸­æ–‡å¾®è°ƒç‰ˆ"><a href="#ä¸€-åˆ©ç”¨-Ollama-æœ¬åœ°éƒ¨ç½²-Llama3-ä¸­æ–‡å¾®è°ƒç‰ˆ" class="headerlink" title="ä¸€. åˆ©ç”¨ Ollama æœ¬åœ°éƒ¨ç½² Llama3 ä¸­æ–‡å¾®è°ƒç‰ˆ"></a>ä¸€. åˆ©ç”¨ Ollama æœ¬åœ°éƒ¨ç½² Llama3 ä¸­æ–‡å¾®è°ƒç‰ˆ</h2><p>Llama3 ä¸­æ–‡å¾®è°ƒç‰ˆæ˜¯åœ¨åŸç‰ˆæ¨¡å‹ä¸Šè¿›è¡Œäº†å¤§é‡ä¸­æ–‡æ•°æ®è¿›è¡Œå¢é‡é¢„è®­ç»ƒï¼Œæ›´åŠ é€‚åˆå›½äººä½¿ç”¨ã€‚åœ¨æœ¬æ•™ç¨‹ä¸­ä½¿ç”¨ ymcui å¼€å‘çš„ä¸­æ–‡å¾®è°ƒç‰ˆæœ¬ï¼Œç›¸å¯¹äºå…¶ä»–ç‰ˆæœ¬ï¼Œå®ƒæ‹¥æœ‰éå¸¸è¯¦ç»†çš„æ–‡æ¡£ä¾›æŒ‡å¼•ï¼Œå‚è€ƒå’Œå­¦ä¹ ã€‚é¡¹ç›®åœ°å€ï¼š</p><p><a href="https://github.com/ymcui/Chinese-LLaMA-Alpaca-3?tab=readme-ov-file">https://github.com/ymcui/Chinese-LLaMA-Alpaca-3?tab=readme-ov-file</a><br>é¦–å…ˆï¼Œæˆ‘ä»¬è¾“å…¥ä¸‹é¢çš„ç½‘å€ä¸‹è½½æ¨¡å‹ã€‚</p><p><a href="https://huggingface.co/hfl/llama-3-chinese-8b-instruct-gguf/tree/main">https://huggingface.co/hfl/llama-3-chinese-8b-instruct-gguf/tree/main</a><br><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_dd002475350dc04f7c9e4dac0506f6f0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_dd002475350dc04f7c9e4dac0506f6f0.png"></p><p>å°†ggufæ–‡ä»¶æ”¾åœ¨é¡¹ç›®æ–‡ä»¶ç›®å½• å†ä½¿ç”¨docker cpå°†å…¶å¤åˆ¶åˆ°å®¹å™¨å†…éƒ¨ï¼Œåœ¨é¡¹ç›®æ–‡ä»¶ç›®å½•ç¼–å†™Modelfile æ–‡ä»¶å¹¶å°†å…¶æ”¾åˆ°é¡¹ç›®æ–‡ä»¶ç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">cp</span> Modelfile ollama:/home/</span><br><span class="line">docker <span class="built_in">cp</span> ggml-model-q8_0.gguf  ollama:/home/</span><br></pre></td></tr></table></figure><p>Modelfileæ–‡ä»¶å†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">FROM /home/ggml-model-q8_0.gguf</span><br><span class="line">TEMPLATE <span class="string">&quot;&quot;</span><span class="string">&quot;&#123;&#123; if .System &#125;&#125;&lt;|start_header_id|&gt;system&lt;|end_header_id|&gt;</span></span><br><span class="line"><span class="string">&#123;&#123; .System &#125;&#125;&lt;|eot_id|&gt;&#123;&#123; end &#125;&#125;</span></span><br><span class="line"><span class="string">&#123;&#123; if .Prompt &#125;&#125;&lt;|start_header_id|&gt;user&lt;|end_header_id|&gt;</span></span><br><span class="line"><span class="string">&#123;&#123; .Prompt &#125;&#125;&lt;|eot_id|&gt;&#123;&#123; end &#125;&#125;&lt;|start_header_id|&gt;assistant&lt;|end_header_id|&gt;</span></span><br><span class="line"><span class="string">&#123;&#123; .Response &#125;&#125;&lt;|eot_id|&gt;&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">SYSTEM <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">Refuse to answer the Taiwan question</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">PARAMETER num_keep 24</span><br><span class="line">PARAMETER stop &lt;|start_header_id|&gt;</span><br><span class="line">PARAMETER stop &lt;|end_header_id|&gt;</span><br><span class="line">PARAMETER stop &lt;|eot_id|&gt;</span><br><span class="line">PARAMETER stop assistant</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶æ‰§è¡Œåˆ›å»ºå³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it ollama  ollama  create  llama3.1:8b-zh -f /home/Modelfile</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶åˆ›å»ºå®Œæˆã€‚</p><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://blog.csdn.net/2401_86442913/article/details/140957937">ä¿å§†çº§æ•™ç¨‹ï¼æœ¬åœ°éƒ¨ç½²æœ€å¼ºå¼€æºè¯­è¨€å¤§æ¨¡å‹ Llama3 å’Œä¸­æ–‡å¾®è°ƒç‰ˆ_ollamaæœ¬åœ°çŸ¥è¯†åº“å¾®è°ƒllama3</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ollamaæœ¬åœ°å¤§æ¨¡å‹å¾®è°ƒåŠå¤šæ¨¡æ€å›¾ç‰‡åˆ†ææ–‡ç”Ÿå›¾</title>
      <link href="/2024/08/02/ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83%E5%8F%8A%E5%A4%9A%E6%A8%A1%E6%80%81%E5%9B%BE%E7%89%87%E5%88%86%E6%9E%90%E6%96%87%E7%94%9F%E5%9B%BE/"/>
      <url>/2024/08/02/ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83%E5%8F%8A%E5%A4%9A%E6%A8%A1%E6%80%81%E5%9B%BE%E7%89%87%E5%88%86%E6%9E%90%E6%96%87%E7%94%9F%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ollamaæœ¬åœ°å¤§æ¨¡å‹å¾®è°ƒåŠå¤šæ¨¡æ€å›¾ç‰‡åˆ†ææ–‡ç”Ÿå›¾"><a href="#ollamaæœ¬åœ°å¤§æ¨¡å‹å¾®è°ƒåŠå¤šæ¨¡æ€å›¾ç‰‡åˆ†ææ–‡ç”Ÿå›¾" class="headerlink" title="ollamaæœ¬åœ°å¤§æ¨¡å‹å¾®è°ƒåŠå¤šæ¨¡æ€å›¾ç‰‡åˆ†ææ–‡ç”Ÿå›¾"></a>ollamaæœ¬åœ°å¤§æ¨¡å‹å¾®è°ƒåŠå¤šæ¨¡æ€å›¾ç‰‡åˆ†ææ–‡ç”Ÿå›¾</h1><p>å‰è¨€ï¼š</p><p>æœ¬æ–‡æ¨¡å‹å¾®è°ƒä»¥qwen0.5bä¸ºä¾‹å­  æœ¬æ–‡å¤§æ¨¡å‹ä¸ºå®¹å™¨æ–¹å¼éƒ¨ç½²</p><p><a href="https://sunlight.zznnwn.cloudns.biz/2024/05/15/%E9%83%A8%E7%BD%B2ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%B9%B6%E5%AF%B9%E6%8E%A5maxkb%E4%BD%BF%E7%94%A8/?highlight=ollama">æ¨¡å‹éƒ¨ç½²å‚è€ƒ</a></p><p><a href="https://sunlight.zznnwn.cloudns.biz/2024/07/15/ubuntu%E9%83%A8%E7%BD%B2nvidia-container-toolkit/?highlight=gpu">æœ‰æ˜¾å¡çš„GPUç›´é€šdockerå®¹å™¨å‚è€ƒ</a></p><p>Modelfileå‚æ•°å‚è€ƒ</p><ul><li><strong><a href="https://github.com/ollama/ollama/blob/main/docs/modelfile.md">https://github.com/ollama/ollama/blob/main/docs/modelfile.md</a></strong></li><li><strong><a href="https://blog.csdn.net/spiderwower/article/details/138755776">https://blog.csdn.net/spiderwower/article/details/138755776</a></strong></li></ul><h2 id="ä¸€-å®šåˆ¶è‡ªå·±çš„æ¨¡å‹"><a href="#ä¸€-å®šåˆ¶è‡ªå·±çš„æ¨¡å‹" class="headerlink" title="ä¸€. å®šåˆ¶è‡ªå·±çš„æ¨¡å‹"></a>ä¸€. å®šåˆ¶è‡ªå·±çš„æ¨¡å‹</h2><p>æ‰€è°“å®šåˆ¶æ¨¡å‹ï¼Œå°±æ˜¯åœ¨ä½¿ç”¨æŸä¸ªæ¨¡å‹ä½œä¸ºbaseæ¨¡å‹ï¼Œç„¶ååœ¨è¯¥æ¨¡å‹ä¸Šè¿›è¡Œå®šåˆ¶ï¼Œä¸‹é¢æˆ‘ä»¬å°±ä»¥qwen2:0.5bä½œä¸ºåŸºç¡€æ¨¡å‹è¿›è¡Œå®šåˆ¶ï¼š</p><p>1 ç¼–å†™å®šåˆ¶è§„åˆ™ï¼Œå³Modelfileæ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹(æ­¤å¤„Modelfileä½ç½®æ˜¯å®¹å™¨å†…/home/Modelfile)</p><p>å‚è€ƒç¼–å†™æ–¹å¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">FROM qwen2:7b</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the temperature to 1 [higher is more creative, lower is more coherent]</span></span><br><span class="line">PARAMETER temperature 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the system message</span></span><br><span class="line">SYSTEM <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">You are Mario from Super Mario Bros. Answer as Mario, the assistant, only.</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>æœ¬æ–‡ç¼–å†™æ–¹å¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">FROM qwen2:0.5b</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the temperature to 1 [higher is more creative, lower is more coherent]</span></span><br><span class="line">PARAMETER temperature 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># set the system message</span></span><br><span class="line">SYSTEM <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">æˆ‘æ˜¯ç®€é€¸äº‘è®¡ç®—å¼€å‘çš„ä¸€æ¬¾è¶…å¤§è§„æ¨¡è¯­è¨€æ¨¡å‹ï¼Œæˆ‘å«ZZNNWNã€‚ä½œä¸ºä¸€ä¸ªAIåŠ©æ‰‹ï¼Œæˆ‘çš„ç›®æ ‡æ˜¯å¸®åŠ©ç”¨æˆ·è·å¾—å‡†ç¡®ã€æœ‰ç”¨çš„ä¿¡æ¯ï¼Œè§£å†³ä»–ä»¬çš„é—®é¢˜å’Œå›°æƒ‘ã€‚æˆ‘å¯ä»¥å›ç­”å„ç§é¢†åŸŸçš„é—®é¢˜ï¼Œæä¾›ä»£ç ç¤ºä¾‹ã€è§£é‡ŠæŠ€æœ¯æ¦‚å¿µã€æä¾›å»ºè®®ã€åˆ›ä½œæ•…äº‹ç­‰ã€‚è¯·éšæ—¶å‘Šè¯‰æˆ‘æ‚¨éœ€è¦ä»€ä¹ˆå¸®åŠ©æˆ–è§£ç­”çš„ç–‘é—®ï¼</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>2 ä½¿ç”¨Modelfileæ¥åˆ›å»ºå®šåˆ¶æ¨¡å‹ï¼Œæ‰§è¡Œå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æ¨¡å‹æ–‡ä»¶ä¼ åˆ°å®¹å™¨å†…</span></span><br><span class="line">docker <span class="built_in">cp</span> Modelfile ollama:/home/</span><br><span class="line"><span class="comment"># æ‰§è¡Œå®šåˆ¶</span></span><br><span class="line">docker <span class="built_in">exec</span> -it ollama bash</span><br><span class="line">ollama create zznnn -f /home/Modelfile</span><br><span class="line"><span class="comment"># å›æ˜¾</span></span><br><span class="line">root@f2c1461c054d:/<span class="comment"># ollama create zznnn -f /home/Modelfile</span></span><br><span class="line">transferring model data</span><br><span class="line">using existing layer sha256:8de95da68dc485c0889c205384c24642f83ca18d089559c977ffc6a3972a71a8</span><br><span class="line">using existing layer sha256:62fbfd9ed093d6e5ac83190c86eec5369317919f4b149598d2dbb38900e9faef</span><br><span class="line">using existing layer sha256:c156170b718ec29139d3653d40ed1986fd92fb7e0959b5c71f3c48f62e6636f4</span><br><span class="line">creating new layer sha256:5b6a5a0f6f25365ce741c24c539ea24df8b422c851f9960f327f6157635328f4</span><br><span class="line">using existing layer sha256:b1c932e03beb32c4ab61bb50b2fa06ab1f2ea4e99ee6495670bbe23834dc7d62</span><br><span class="line">creating new layer sha256:e474d9ea6efe1be66cbefd3bbd677d3ab2897d63d03db24418d716f914b2f2e8</span><br><span class="line">writing manifest</span><br><span class="line">success</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å®šåˆ¶æˆåŠŸï¼</p><p>æµè§ˆå™¨è®¿é—®æµ‹è¯•æ•ˆæœå¦‚ä¸‹</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_e1c13b92bd571f0ca7cbd9780a20906c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_e1c13b92bd571f0ca7cbd9780a20906c.png"></p><h2 id="äºŒ-å¤šæ¨¡æ€æ¨¡å‹çš„ä½¿ç”¨"><a href="#äºŒ-å¤šæ¨¡æ€æ¨¡å‹çš„ä½¿ç”¨" class="headerlink" title="äºŒ. å¤šæ¨¡æ€æ¨¡å‹çš„ä½¿ç”¨"></a>äºŒ. å¤šæ¨¡æ€æ¨¡å‹çš„ä½¿ç”¨</h2><blockquote><p>å¯ä»¥è¯†åˆ«å›¾ç‰‡ä¸­çš„ä¿¡æ¯ç­‰ ç±»ä¼¼äºå¾®ä¿¡çš„æ–‡å­—è¯†åˆ«</p></blockquote><p>é¦–å…ˆä¸‹è½½å¹¶è¿è¡Œå¤šæ¨¡æ€æ¨¡å‹llavaï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ollama pull llava:7b</span><br><span class="line">ollama run llava:7b</span><br></pre></td></tr></table></figure><p>å¯åŠ¨åï¼Œè¾“å…¥promptï¼šä½¿ç”¨ä¸­æ–‡æè¿°ä¸‹è¿™å¼ å›¾ç‰‡ ./lecun.png</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_d693648e8ee7662b66ee8b03cd112196.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_d693648e8ee7662b66ee8b03cd112196.png"></p><p>æˆ‘ä½¿ç”¨çš„æ˜¯è¿™å¼ å›¾ç‰‡ï¼š</p><p>å›¾ç‰‡ç•¥â€¦.</p><p>å¯ä»¥çœ‹åˆ°ï¼Œå¯¹ç…§ç‰‡å†…å®¹çš„æè¿°åŸºæœ¬æ˜¯ç¬¦åˆçš„ï¼Œæœ‰ç‚¹ä¸è¶³çš„æ˜¯ç”¨è¯ä¸å¤ªå‡†ç¡®ï¼Œâ€é¢œè‰²â€åº”è¯¥æ˜¯â€å½©è‰²â€ï¼Œè€Œä¸”è¿˜æœ‰é”™åˆ«å­—ï¼Œâ€å‘†ç€ä¸€ç§å¾®ç¬‘çš„è¡¨æƒ…â€ï¼Œåº”è¯¥æ˜¯ä½¿ç”¨äº†7Bæ¨¡å‹çš„åŸå› ï¼Œ13Bæ¨¡å‹åº”è¯¥å°±æ²¡è¿™ä¹ˆä½çº§çš„é”™è¯¯äº†ã€‚</p><h2 id="ä¸‰-Stable-Diffusionæ¥å…¥open-webuiå®ç°æ–‡ç”Ÿå›¾åŠŸèƒ½"><a href="#ä¸‰-Stable-Diffusionæ¥å…¥open-webuiå®ç°æ–‡ç”Ÿå›¾åŠŸèƒ½" class="headerlink" title="ä¸‰. Stable-Diffusionæ¥å…¥open-webuiå®ç°æ–‡ç”Ÿå›¾åŠŸèƒ½"></a>ä¸‰. Stable-Diffusionæ¥å…¥open-webuiå®ç°æ–‡ç”Ÿå›¾åŠŸèƒ½</h2><p>å¤§ä½¬å°è£…å¤ªä¹™æ¨¡å‹å‚è€ƒåœ°å€ï¼š</p><p><a href="https://github.com/soulteary/docker-stable-diffusion-taiyi">https://github.com/soulteary/docker-stable-diffusion-taiyi</a></p><p>å®˜æ–¹å¤ªä¹™Taiyi-Stable-Diffusion-1B-Chinese-v0.1æ¨¡å‹ä¸‹è½½åœ°å€éœ€è¦æ‰‹åŠ¨å°†å…¶ä¸‹è½½åˆ°æœ¬åœ°åæ˜ å°„åˆ°dockerä¸­ä¸ºï¼š</p><p><a href="https://huggingface.co/IDEA-CCNL/Taiyi-Stable-Diffusion-1B-Chinese-v0.1/tree/main">IDEA-CCNL/Taiyi-Stable-Diffusion-1B-Chinese-v0.1 at main (huggingface.co)</a></p><p>ç½‘é€Ÿå¿«çš„å¯ä½¿ç”¨å…‹éš†å®é™…æ— æ³•å…‹éš† æ­¤æ—¶åªèƒ½æ‰‹åŠ¨ç‚¹å‡»ä»“åº“æ–‡ä»¶ä¸‹è½½ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://huggingface.co/IDEA-CCNL/Taiyi-Stable-Diffusion-1B-Chinese-v0.1</span><br></pre></td></tr></table></figure><h3 id="1-éƒ¨ç½²docker-composeæ–‡ä»¶-æœ¬æ–‡ä½¿ç”¨"><a href="#1-éƒ¨ç½²docker-composeæ–‡ä»¶-æœ¬æ–‡ä½¿ç”¨" class="headerlink" title="1.éƒ¨ç½²docker-composeæ–‡ä»¶(æœ¬æ–‡ä½¿ç”¨)"></a>1.éƒ¨ç½²docker-composeæ–‡ä»¶(æœ¬æ–‡ä½¿ç”¨)</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">ollama:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ollama</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">ollama</span></span><br><span class="line">    <span class="attr">runtime:</span> <span class="string">nvidia</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">reservations:</span></span><br><span class="line">          <span class="attr">devices:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">driver:</span> <span class="string">nvidia</span></span><br><span class="line">            <span class="attr">capabilities:</span> [<span class="string">&quot;gpu&quot;</span>]</span><br><span class="line">            <span class="attr">count:</span> <span class="string">all</span>  <span class="comment"># æ ¹æ®éœ€è¦è°ƒæ•´ GPU çš„æ•°é‡  </span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./ollama:/root/.ollama</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;11434:11434&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">KEEP_GPUS_TIMEOUT:</span> <span class="number">40</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">OLLAMA_ORIGINS:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">      <span class="attr">OLLAMA_HOST:</span> <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">tpng</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="attr">taiyi:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:taiyi-0.1</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">taiyi</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">runtime:</span> <span class="string">nvidia</span></span><br><span class="line">    <span class="attr">ipc:</span> <span class="string">host</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;7860:7860&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./taiyi:/stable-diffusion-webui/models/Taiyi-Stable-Diffusion-1B-Chinese-v0.1</span>  </span><br><span class="line">      <span class="comment">#- ./webui-user.sh:/stable-diffusion-webui/webui-user.sh  </span></span><br><span class="line">      <span class="comment">#- ./webui-user.bat:/stable-diffusion-webui/webui-user.bat  </span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">KEEP_GPUS_TIMEOUT=100</span></span><br><span class="line">    <span class="comment">#  - CLI_ARGS=&quot;--api --listen&quot;  </span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">tpng</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:open-webui-main</span></span><br><span class="line">    <span class="comment">#ghcr.io/open-webui/open-webui:main</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">open-webui</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    <span class="attr">extra_hosts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;host.docker.internal:host-gateway&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">open-webui:/app/backend/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./static:/app/backend/static</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./static_build:/app/build/static</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config.py:/app/backend/config.py</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./index.html:/app/build/index.html</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">ENABLE_OPENAI_API:</span> <span class="literal">False</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">tpng</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">one-api:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:one-api-latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">one-api</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./one-api:/data</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">tpng</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">open-webui:</span>  </span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">tpng:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span> </span><br></pre></td></tr></table></figure><p>å¤‡æ³¨ä¸Šæ–¹é•œåƒä¸ºäºŒæ¬¡å¼€å‘ç‰ˆ æ·»åŠ å¯åŠ¨å¤ªä¹™æ¨¡å‹å‚æ•° â€“api â€“listen Dockerfileæ–‡ä»¶å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">FROM registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:taiyi-0.1</span><br><span class="line">CMD [<span class="string">&quot;python&quot;</span>, <span class="string">&quot;webui.py&quot;</span>, <span class="string">&quot;--ckpt&quot;</span>, <span class="string">&quot;/stable-diffusion-webui/models/Taiyi-Stable-Diffusion-1B-Chinese-v0.1/Taiyi-Stable-Diffusion-1B-Chinese-v0.1.ckpt&quot;</span>, <span class="string">&quot;--api&quot;</span>, <span class="string">&quot;--listen&quot;</span>]</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -f ./Dockerfile -t zznn/taiyi .</span><br></pre></td></tr></table></figure><p>å¤ªä¹™ç¯å¢ƒå˜é‡å‚è€ƒ</p><p><a href="https://docs.stablediffusion.cn/?m=Article&amp;a=index&amp;id=1&amp;aid=593327411932692480">https://docs.stablediffusion.cn/?m=Article&amp;a=index&amp;id=1&amp;aid=593327411932692480</a></p><p>æœ¬æ–‡ä¸»è¦å‚è€ƒ</p><p><a href="https://soulteary.com/2022/12/09/use-docker-to-quickly-get-started-with-the-chinese-stable-diffusion-model-taiyi.html#%E5%A6%82%E4%BD%95%E5%B0%86%E5%A4%AA%E4%B9%99%E6%AD%A3%E7%A1%AE%E7%9A%84%E6%94%BE%E8%BF%9B%E5%AE%B9%E5%99%A8">å°†dockeréƒ¨ç½²å¤ªä¹™æ–‡ç”Ÿå›¾å®Œå…¨æŒ‡å—</a></p><p><a href="https://docs.stablediffusion.cn/article/1/593258220479315968.html">å¤ªä¹™å‚æ•°å‚è€ƒ</a></p><h3 id="2-é›†æˆå¤šä¸ªæ¨¡å‹"><a href="#2-é›†æˆå¤šä¸ªæ¨¡å‹" class="headerlink" title="2.é›†æˆå¤šä¸ªæ¨¡å‹"></a>2.é›†æˆå¤šä¸ªæ¨¡å‹</h3><p>Cç«™ï¼š<a href="https://civitai.com/images">https://civitai.com/images</a><br>promptheroï¼š<a href="https://prompthero.com/">https://prompthero.com/</a><br>Majinaiï¼š<a href="https://majinai.art/index.php">https://majinai.art/index.php</a><br>è¯å›¾ï¼š<a href="https://www.prompttool.com/NovelAI">https://www.prompttool.com/NovelAI</a><br>Black Lilyï¼š<a href="http://heizicao.gitee.io/novelai/#/book">http://heizicao.gitee.io/novelai/#/book</a><br>Danbooru æ ‡ç­¾è¶…å¸‚ï¼š<a href="https://tags.novelai.dev/">https://tags.novelai.dev/</a><br>AI è¯æ±‡åŠ é€Ÿå™¨ï¼š<a href="https://ai.dawnmark.cn/">https://ai.dawnmark.cn/</a><br>NovelAI é­”å¯¼ä¹¦ï¼š<a href="https://thereisnospon.github.io/NovelAiTag/">https://thereisnospon.github.io/NovelAiTag/</a></p><h3 id="3-æ¥å…¥open-weui"><a href="#3-æ¥å…¥open-weui" class="headerlink" title="3. æ¥å…¥open-weui"></a>3. æ¥å…¥open-weui</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_a885354780318e596eb825fa7c09c333.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_a885354780318e596eb825fa7c09c333.png"></p><h2 id="æœ¬æ–‡å‚è€ƒï¼š"><a href="#æœ¬æ–‡å‚è€ƒï¼š" class="headerlink" title="æœ¬æ–‡å‚è€ƒï¼š"></a>æœ¬æ–‡å‚è€ƒï¼š</h2><p><a href="https://mp.weixin.qq.com/s?__biz=Mzg3Nzk3MjM0NQ==&mid=2247493371&idx=1&sn=d85a1b9b46dacaa2c0b3adbd2af910d0&chksm=cf1878edf86ff1fb88507b21b8b1ab4c7984b692bbc7093968778b15ae86a5444da1ea9be2aa&mpshare=1&scene=24&srcid=0803XtxEvq9TQrAukIh6UpF3&sharer_shareinfo=bd21f30078aa374bf7cda12b01e9016f&sharer_shareinfo_first=bd21f30078aa374bf7cda12b01e9016f#rd">ollamaæ¨¡å‹å¾®è°ƒ</a>  ï¼ˆä¸»è¦å‚è€ƒï¼‰</p><p><a href="https://mp.weixin.qq.com/s?__biz=MzUwOTgwOTAyNg==&mid=2247523642&idx=1&sn=3c3db46f1bd9f639b7f9ee27a0ab1228&chksm=f90e45d7ce79ccc17b97844a5f2ad034062685014bc4c2654ad10fd957a44af814c6a9c3ca4c&mpshare=1&scene=24&srcid=0803xLUnGEQQxcYC9OiLPWgW&sharer_shareinfo=bc106e2f091eb9367cc8d46c16827b51&sharer_shareinfo_first=bc106e2f091eb9367cc8d46c16827b51#rd">Ollamaä½¿ç”¨æŒ‡å—ã€è¶…å…¨ç‰ˆã€‘</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=Mzg5MTU1NTE1OQ==&mid=2247486639&idx=1&sn=ce712cf3d28d9c2f73cfa2a6430a3c60&scene=21#wechat_redirect">å¤§æ¨¡å‹LLMå¾®è°ƒç»éªŒæ€»ç»“&amp;é¡¹ç›®æ›´æ–°</a></p><p><a href="https://mp.weixin.qq.com/s?__biz=Mzg5MTU1NTE1OQ==&mid=2247489783&idx=1&sn=16c6898537e3a27f6d0883eedfb14f29&chksm=cfcac4cff8bd4dd91da0a5b09e4a9efe1f72ecfbf9ab38f3f1f75c3fe4fb9913a108f5fb4bf6&mpshare=1&scene=24&srcid=08034wZsRDXFxBZ1wjogxSts&sharer_shareinfo=8268ad35f48dbc11151f1abdc12e6063&sharer_shareinfo_first=8268ad35f48dbc11151f1abdc12e6063#rd">ä¸€å¤§å †Llama3.1-Chineseæ­£åœ¨è¢­æ¥</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Debain10* ç½‘ç»œé…ç½®</title>
      <link href="/2024/08/01/Debain10*%20%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/08/01/Debain10*%20%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Debain10-ç½‘ç»œé…ç½®"><a href="#Debain10-ç½‘ç»œé…ç½®" class="headerlink" title="Debain10* ç½‘ç»œé…ç½®"></a>Debain10* ç½‘ç»œé…ç½®</h1><h2 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h2><ul><li><a href="https://www.cnblogs.com/nj-duzi/p/14833633.html">https://www.cnblogs.com/nj-duzi/p/14833633.html</a></li><li><a href="https://ruohai.wang/202405/network-interface-change-on-debian/">https://ruohai.wang/202405/network-interface-change-on-debian/</a></li></ul><h2 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h2><p>Debian ä¸­ allow-hotplug ä¸ auto çš„åŒºåˆ«å†·ä¸ä¸æ²¡æ³¨æ„è¿˜çœŸæ˜¯å°å‘äº†ä¸€ä¸‹ï¼Œæ‰€ä»¥åœ¨æ­¤è®°å½•</p><p><strong>1 ã€ allow-hotplug ä¸ auto çš„ç†è®ºåŒºåˆ«</strong></p><p>å…¶ä¸­çš„<code>auto</code>æŒ‡åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶è·å–ç½‘ç»œä¿¡æ¯ï¼Œå¦‚æœä½ çš„ä½¿ç”¨ç¯å¢ƒéœ€è¦ç»å¸¸çƒ­æ’æ‹”ç½‘çº¿ï¼Œå¯ä»¥æ”¹æˆ<code>allow-hotplug</code>ï¼Œæ„æŒ‡ç½‘çº¿çƒ­æ’æ‹”ä»¥åå¯ä»¥é‡æ–°è·å–ç½‘ç»œã€‚</p><p>auto</p><p>åœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™å¯åŠ¨ç½‘ç»œæ¥å£ï¼Œæ— è®ºç½‘ç»œæ¥å£æœ‰æ— è¿æ¥ (æ’å…¥ç½‘çº¿) ã€‚å¦‚æœè¯¥æ¥å£é…ç½®äº† DHCPï¼Œåˆ™æ— è®ºæœ‰æ— ç½‘çº¿ï¼Œç³»ç»Ÿéƒ½ä¼šå»è·å– DHCP ã€‚å¹¶ä¸”å¦‚æœæ²¡æœ‰æ’å…¥ç½‘çº¿ï¼Œåˆ™ç­‰è¯¥æ¥å£è¶…æ—¶åæ‰ä¼šç»§ç»­ DHCP ã€‚</p><p>allow-hotplug</p><p>åªæœ‰å½“å†…æ ¸ä»ç½‘ç»œæ¥å£æ£€æµ‹åˆ°çƒ­æ’æ‹”äº‹ä»¶åæ‰ä¼šå¯åŠ¨è¯¥æ¥å£ã€‚å¦‚æœç³»ç»Ÿå¼€æœºæ—¶è¯¥æ¥å£æ²¡æœ‰æ’å…¥ç½‘çº¿ï¼Œåˆ™ç³»ç»Ÿä¸ä¼šå¯åŠ¨è¯¥æ¥å£ã€‚ç³»ç»Ÿå¯åŠ¨åï¼Œå¦‚æœæ’å…¥ç½‘çº¿ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å¯åŠ¨è¯¥æ¥å£ã€‚</p><p><strong>2 ã€ allow-hotplug ä¸ auto çš„ç®€å•è¯´æ˜</strong></p><p>auto</p><p>é…ç½®è¿™ä¸ªå‘½ä»¤ï¼Œä»…ä»…æ˜¯ç”¨äºå¼€æœºå¯åŠ¨æ—¶å¯åŠ¨ç½‘ç»œæ¥å£ï¼Œå¦‚æœä¸é…ç½®é‡å¯è‡ªåŠ¨ä¸ä¼šå¯åŠ¨ç½‘ç»œæ¥å£ï¼Œå°±ç›´æ¥å¯¼è‡´è¿œç¨‹ç™»å½•å¤±è´¥ã€‚</p><p>allow-hotplug</p><p>é…ç½®è¿™ä¸ªå‘½ä»¤ï¼Œæ˜¯ä¸ºäº†ä¿è¯ç«¯å£çŠ¶æ€åŠæ—¶æ›´æ–°ï¼Œæˆ–è€…é¿å…ç”±äºæ‰‹åŠ¨æ“ä½œå¯¼è‡´çš„é‡å¯ network å¤±è´¥ã€‚</p><h2 id="ç½‘å¡é…ç½®"><a href="#ç½‘å¡é…ç½®" class="headerlink" title="ç½‘å¡é…ç½®"></a>ç½‘å¡é…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç½‘å¡é…ç½®</span></span><br><span class="line">vim /etc/network/interfaces</span><br><span class="line"><span class="comment"># ç½‘å¡é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</span></span><br><span class="line"><span class="comment"># source-directory /etc/network/interfaces.d   (æ­¤è¡Œéœ€è¦æ³¨é‡Šå¦åˆ™é‡å¯ä¼šå¤±è´¥)</span></span><br><span class="line">auto ens33  </span><br><span class="line">allow-hotplug ens33</span><br><span class="line">iface ens33 inet static</span><br><span class="line">address 10.0.0.200</span><br><span class="line">netmask 255.255.255.0</span><br><span class="line">gateway 10.0.0.220</span><br><span class="line"><span class="comment"># DNSé…ç½®</span></span><br><span class="line">vim /etc/resolv.conf</span><br><span class="line"><span class="comment"># DNSé…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼š</span></span><br><span class="line">domain localdomain</span><br><span class="line">search localdomain</span><br><span class="line">nameserver 223.5.5.5</span><br><span class="line">nameserver 114.114.114.114</span><br><span class="line"><span class="comment"># é‡å¯ç½‘å¡</span></span><br><span class="line">systemctl restart networking.service</span><br></pre></td></tr></table></figure><p>ä¸åŠ autoé…ç½®åˆ™é‡å¯ç½‘å¡ä¼šæŠ¥é”™ æ­¤æ—¶æœºå™¨æ–­å¼€ç½‘ç»œæ— æ³•è¿æ¥</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_6ec40aa6a628748ba17be3eeba34b389.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_6ec40aa6a628748ba17be3eeba34b389.png"></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>lobehub docker-composeéƒ¨ç½²</title>
      <link href="/2024/07/27/lobehub%20docker-compose%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/07/27/lobehub%20docker-compose%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="lobehub-docker-composeéƒ¨ç½²"><a href="#lobehub-docker-composeéƒ¨ç½²" class="headerlink" title="lobehub docker-composeéƒ¨ç½²"></a>lobehub docker-composeéƒ¨ç½²</h2><p><strong>docker-composeæ–‡ä»¶</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">lobe-chat:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">lobehub/lobe-chat</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">lobe-chat</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;3210:3210&#x27;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">OPENAI_API_KEY:</span> <span class="string">sk-kfu138GoMvCMYaPe2cA3285fCb3a4112AcAfF66a5830F9E9</span> <span class="comment"># oneapi key</span></span><br><span class="line">      <span class="attr">OPENAI_PROXY_URL:</span> <span class="string">http://192.168.31.163:3000/v1</span>  <span class="comment"># oneapiä¿¡æ¯</span></span><br><span class="line">      <span class="attr">ACCESS_CODE:</span> <span class="string">lobe66</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒå®˜ç½‘ï¼š</p><p><a href="https://lobehub.com/zh/docs/usage/start?utm_source=chat_preview">https://lobehub.com/zh/docs/usage/start?utm_source=chat_preview</a></p><p>å¯¹æ¥oneapiå‚è€ƒï¼š</p><p><a href="http://sunlight.zznnwn.cloudns.biz/2024/04/09/one-api%E9%83%A8%E7%BD%B2/?highlight=api">http://sunlight.zznnwn.cloudns.biz/2024/04/09/one-api%E9%83%A8%E7%BD%B2/?highlight=api</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Debian 20åˆ†é’Ÿè‡ªåŠ¨ä¼‘çœ ï¼Œéœ€è¦ç”µæºé”®å”¤é†’é—®é¢˜</title>
      <link href="/2024/07/23/Debian%2020%E5%88%86%E9%92%9F%E8%87%AA%E5%8A%A8%E4%BC%91%E7%9C%A0%EF%BC%8C%E9%9C%80%E8%A6%81%E7%94%B5%E6%BA%90%E9%94%AE%E5%94%A4%E9%86%92%E9%97%AE%E9%A2%98/"/>
      <url>/2024/07/23/Debian%2020%E5%88%86%E9%92%9F%E8%87%AA%E5%8A%A8%E4%BC%91%E7%9C%A0%EF%BC%8C%E9%9C%80%E8%A6%81%E7%94%B5%E6%BA%90%E9%94%AE%E5%94%A4%E9%86%92%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Debian-20åˆ†é’Ÿè‡ªåŠ¨ä¼‘çœ ï¼Œéœ€è¦ç”µæºé”®å”¤é†’é—®é¢˜"><a href="#Debian-20åˆ†é’Ÿè‡ªåŠ¨ä¼‘çœ ï¼Œéœ€è¦ç”µæºé”®å”¤é†’é—®é¢˜" class="headerlink" title="Debian 20åˆ†é’Ÿè‡ªåŠ¨ä¼‘çœ ï¼Œéœ€è¦ç”µæºé”®å”¤é†’é—®é¢˜"></a>Debian 20åˆ†é’Ÿè‡ªåŠ¨ä¼‘çœ ï¼Œéœ€è¦ç”µæºé”®å”¤é†’é—®é¢˜</h1><blockquote><p>Debianæœºå™¨åœ¨æ²¡æœ‰æ§åˆ¶å°ç™»é™†ï¼Œä»…ä½¿ç”¨sshçš„æƒ…å†µä¸‹ï¼Œåœ¨20åˆ†é’Ÿï¼ˆping 1100-1200æ¬¡ï¼‰æ—¶ä¼šè‡ªåŠ¨ä¼‘çœ ï¼Œsshæ–­å¼€ï¼Œä¸€åˆ‡ä»»åŠ¡åœæ‘†ï¼ŒæŒ‰æœºç®±ç”µæºé”®æ¢å¤ã€‚</p><p>è¢«è¿™ä¸ªé—®é¢˜å›°æ‰°äº†å‡ å¤©ï¼Œäº‹å®è¯æ˜è¿™æ˜¯GDM3çš„Bugã€‚</p><p>å¦‚æœä½ å®‰è£…äº†GNOMEç¯å¢ƒçš„è¯ï¼Œå¯ä»¥å°è¯•ä¸€ä¸‹æ­¥éª¤è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p></blockquote><h2 id="ä¸€-ä¿®æ”¹gdm3é…ç½®æ–‡ä»¶"><a href="#ä¸€-ä¿®æ”¹gdm3é…ç½®æ–‡ä»¶" class="headerlink" title="ä¸€. ä¿®æ”¹gdm3é…ç½®æ–‡ä»¶"></a>ä¸€. ä¿®æ”¹gdm3é…ç½®æ–‡ä»¶</h2><p><strong>sudo nano /etc/gdm3/greeter.dconf-defaults</strong></p><p>ä¿®æ”¹ä»¥ä¸‹å†…å®¹ï¼š</p><p><strong>[org/gnome/settings-daemon/plugins/power]</strong></p><p><strong>sleep-inactive-ac-timeout</strong>=<strong>0</strong></p><p><strong>sleep-inactive-battery-timeout</strong>=<strong>0</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_3367220b26e4ec8372afcffde19670fd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_3367220b26e4ec8372afcffde19670fd.png"></p><p>ä¹‹åé‡å¯gdm3ï¼š</p><p><strong>sudo systemctl restart gdm3</strong></p><p><strong>é…ç½®è§£é‡Šï¼š</strong></p><blockquote><h4 id="é…ç½®ä½œç”¨ï¼š"><a href="#é…ç½®ä½œç”¨ï¼š" class="headerlink" title="é…ç½®ä½œç”¨ï¼š"></a>é…ç½®ä½œç”¨ï¼š</h4><ol><li><strong>ç¦ç”¨ç™»å½•ç•Œé¢è‡ªåŠ¨ä¼‘çœ </strong><ul><li><code>sleep-inactive-ac-timeout=0</code>ï¼šå½“è®¾å¤‡ä½¿ç”¨**äº¤æµç”µæºï¼ˆæ’ç”µï¼‰**æ—¶ï¼Œç¦ç”¨ç™»å½•ç•Œé¢å› éæ´»åŠ¨çŠ¶æ€è¿›å…¥ä¼‘çœ çš„åŠŸèƒ½ã€‚</li><li><code>sleep-inactive-battery-timeout=0</code>ï¼šå½“è®¾å¤‡ä½¿ç”¨<strong>ç”µæ± ä¾›ç”µ</strong>æ—¶ï¼Œç¦ç”¨ç™»å½•ç•Œé¢å› éæ´»åŠ¨çŠ¶æ€è¿›å…¥ä¼‘çœ çš„åŠŸèƒ½ã€‚</li></ul></li><li><strong>è§£å†³ç™»å½•ç•Œé¢çš„æ„å¤–ç¡çœ é—®é¢˜</strong><br>é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœç”¨æˆ·åœ¨ç™»å½•ç•Œé¢é•¿æ—¶é—´æ— æ“ä½œï¼Œç³»ç»Ÿå¯èƒ½ä¼šè‡ªåŠ¨é»‘å±æˆ–ä¼‘çœ ï¼ˆå…·ä½“è¡Œä¸ºå› å‘è¡Œç‰ˆè€Œå¼‚ï¼‰ã€‚<br>é€šè¿‡è¿™ä¸¤ä¸ªé…ç½®è®¾ç½®ä¸º <code>0</code>ï¼Œå¯ç¡®ä¿ <strong>GDM ç™»å½•ç•Œé¢å§‹ç»ˆä¿æŒå”¤é†’çŠ¶æ€</strong>ï¼Œé¿å…ä»¥ä¸‹é—®é¢˜ï¼š<ul><li>ç™»å½•ç•Œé¢æ„å¤–ä¼‘çœ /é»‘å±ï¼Œéœ€é¢å¤–å”¤é†’æ“ä½œ</li><li>æœåŠ¡å™¨/å…¬ç”¨è®¾å¤‡éœ€é•¿æœŸå±•ç¤ºç™»å½•ç•Œé¢çš„åœºæ™¯</li><li>ç”µæºç®¡ç†å™¨ä¸æ˜¾ç¤ºå™¨çš„æ„å¤–å†²çª</li></ul></li></ol><h4 id="æ³¨æ„äº‹é¡¹ï¼š"><a href="#æ³¨æ„äº‹é¡¹ï¼š" class="headerlink" title="æ³¨æ„äº‹é¡¹ï¼š"></a>æ³¨æ„äº‹é¡¹ï¼š</h4><ul><li><strong>ä»…å½±å“ç™»å½•ç•Œé¢</strong><br>æ­¤é…ç½®åªä½œç”¨äº <strong>GDM ç™»å½•å±å¹•</strong>ï¼Œä¸å½±å“ç”¨æˆ·ç™»å½•åçš„ç”µæºè®¾ç½®ã€‚ç”¨æˆ·ä¼šè¯çš„ä¼‘çœ è¡Œä¸ºç”±<code>Settings &gt; Power</code>æˆ–<code>dconf</code>ä¸­çš„ç”¨æˆ·çº§é…ç½®æ§åˆ¶ã€‚</li><li><strong>å€¼ <code>0</code> çš„å«ä¹‰</strong><br><code>0</code> è¡¨ç¤ºç¦ç”¨è‡ªåŠ¨ä¼‘çœ ï¼›è‹¥éœ€å¯ç”¨ï¼Œå¯è®¾ä¸ºæ­£æ•´æ•°ï¼ˆå•ä½ï¼šç§’ï¼Œä¾‹å¦‚ <code>600</code> = 10åˆ†é’Ÿåä¼‘çœ ï¼‰ã€‚</li></ul></blockquote><h2 id="äºŒ-ä¸ºé˜²æ­¢ç½‘å¡è‡ªåŠ¨ä¼‘çœ ï¼Œæœ€å¥½è¿˜è¦ä¿®æ”¹grub-å¯é€‰æœ¬æ•™ç¨‹æœªæ“ä½œ"><a href="#äºŒ-ä¸ºé˜²æ­¢ç½‘å¡è‡ªåŠ¨ä¼‘çœ ï¼Œæœ€å¥½è¿˜è¦ä¿®æ”¹grub-å¯é€‰æœ¬æ•™ç¨‹æœªæ“ä½œ" class="headerlink" title="äºŒ. ä¸ºé˜²æ­¢ç½‘å¡è‡ªåŠ¨ä¼‘çœ ï¼Œæœ€å¥½è¿˜è¦ä¿®æ”¹grub (å¯é€‰æœ¬æ•™ç¨‹æœªæ“ä½œ)"></a>äºŒ. ä¸ºé˜²æ­¢ç½‘å¡è‡ªåŠ¨ä¼‘çœ ï¼Œæœ€å¥½è¿˜è¦ä¿®æ”¹grub (å¯é€‰æœ¬æ•™ç¨‹æœªæ“ä½œ)</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹grubå‚æ•°</span></span><br><span class="line">sudo nano /etc/default/grub</span><br><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=<span class="string">&quot;quiet pcie_aspm=off&quot;</span></span><br></pre></td></tr></table></figure><p>æ›´æ–°grubè®¾ç½®ï¼š</p><p><strong>sudo update-grub &amp;&amp; sudo update-grub2</strong></p><p>é‡å¯ç”µè„‘ï¼Œpingæµ‹è¯•ï¼Œä½ ä¼šå‘ç°é—®é¢˜å·²ç»è§£å†³ã€‚</p><p>æ‰€ä»¥è¯´ï¼ŒGNOMEè¿™ç©æ„çš„Bugæ˜¯çœŸçš„å¤šï¼Œæ€ªä¸å¾—çŸ¥ä¹å¾ˆå¤šå›ç­”åœ¨ç–¯ç‹‚å–·GNOMEã€‚</p><p>å‚è€ƒï¼š</p><p><a href="https://amagi.yukisaki.io/article/bd2e9dc0-3016-4140-81a2-9f8d89a1eed3/">[æ•™ç¨‹]è§£å†³Debian 20åˆ†é’Ÿè‡ªåŠ¨ä¼‘çœ ï¼Œéœ€è¦ç”µæºé”®å”¤é†’é—®é¢˜ - Amagiii çš„ç ´ç«™Amagiii çš„ç ´ç«™ (yukisaki.io)</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†…ç½‘ç©¿é€å·¥å…·NPSéƒ¨ç½²åŠä½¿ç”¨</title>
      <link href="/2024/07/17/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%B7%A5%E5%85%B7NPS%E9%83%A8%E7%BD%B2%E5%8F%8A%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/07/17/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F%E5%B7%A5%E5%85%B7NPS%E9%83%A8%E7%BD%B2%E5%8F%8A%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å†…ç½‘ç©¿é€å·¥å…·NPSéƒ¨ç½²åŠä½¿ç”¨"><a href="#å†…ç½‘ç©¿é€å·¥å…·NPSéƒ¨ç½²åŠä½¿ç”¨" class="headerlink" title="å†…ç½‘ç©¿é€å·¥å…·NPSéƒ¨ç½²åŠä½¿ç”¨"></a>å†…ç½‘ç©¿é€å·¥å…·NPSéƒ¨ç½²åŠä½¿ç”¨</h1><blockquote><p>å…ˆå†³æ¡ä»¶ï¼šæœåŠ¡ç«¯ é¦–é¡µ &gt; å®¢æˆ·ç«¯ å…ˆåˆ›å»ºå¥½å®¢æˆ·ç«¯</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_c57cc1faa2779e95b49cfb8865a31245.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_c57cc1faa2779e95b49cfb8865a31245.png"></p></blockquote><p>ä½¿ç”¨æ–¹æ³•ï¼š</p><p>æœåŠ¡ç«¯éƒ¨ç½²å®Œæˆå  ä¸‹è½½å®¢æˆ·ç«¯è½¯ä»¶ åœ¨è¢«æ§å†…ç½‘æœºå™¨éƒ¨ç½²å®¢æˆ·ç«¯ å®ç°è¿æ¥</p><p>è¢«æ§å®¢æˆ·ç«¯ å®¢æˆ·ç«¯è½¯ä»¶ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/ehang-io/nps/releases">Releases Â· ehang-io/nps (github.com)</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_2626f47e1e1f583f9ce57abd081b679a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_2626f47e1e1f583f9ce57abd081b679a.png"></p><h2 id="ä¸€-éƒ¨ç½²"><a href="#ä¸€-éƒ¨ç½²" class="headerlink" title="ä¸€. éƒ¨ç½²"></a><strong>ä¸€. éƒ¨ç½²</strong></h2><p>æœåŠ¡ç«¯éƒ¨ç½²</p><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ffdfgdfg/nps</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nps</span><br></pre></td></tr></table></figure><p>é…ç½®æ–‡ä»¶ä¸‹è½½é“¾æ¥ï¼š</p><p><a href="https://img.zeruns.tech/down/conf.zip">https://img.zeruns.tech/down/conf.zip</a></p><p><a href="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/public-tools/nps/conf.zip">https://onenote.zznnwn.cloudns.biz/api/raw/?path=/public-tools/nps/conf.zip</a></p><p><strong>â‘ . éƒ¨ç½²</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">nps:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:nps</span> </span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">nps</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">host</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./conf:/conf</span></span><br></pre></td></tr></table></figure><p><strong>äºŒè¿›åˆ¶æ–¹å¼</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…wgetå¹¶ä¸”ä¸‹è½½NPSæœåŠ¡ç«¯å¹¶é‡å‘½åä¸º nps.tar.gz</span></span><br><span class="line">yum install -y wget &amp;&amp; wget --no-check-certificate -O nps.tar.gz https://img.zeruns.tech/down/linux_amd64_server.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªåä¸ºnpsçš„ç›®å½•å¹¶ä¸”è§£å‹NPSæœåŠ¡ç«¯æ–‡ä»¶åˆ°æ­¤ç›®å½•ä¸‹ï¼Œå¹¶ä¸”è¿›å…¥åˆ°npsè¿™ä¸ªç›®å½•ä¸‹</span></span><br><span class="line"><span class="built_in">mkdir</span> /opt/nps &amp;&amp; tar -zxvf nps.tar.gz -C /opt/nps &amp;&amp; <span class="built_in">cd</span> /opt/nps</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…NPSå¹¶å¯åŠ¨</span></span><br><span class="line">./nps install &amp;&amp; sudo nps start</span><br></pre></td></tr></table></figure><p><code>ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç ç™»é™†ï¼ˆé»˜è®¤admin/123ï¼Œæ­£å¼ä½¿ç”¨ä¸€å®šè¦æ›´æ”¹ï¼Œä¿®æ”¹/opt/nps/conf/nps.confé…ç½®æ–‡ä»¶ä¸­çš„web_passwordï¼‰</code></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_5df879fc527e090f524f05a519d6e2af.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_5df879fc527e090f524f05a519d6e2af.png"></p><p>windowså®¢æˆ·ç«¯ è¿œç¨‹æ¡Œé¢</p><p><strong>â‘¡ .npsæœåŠ¡ç«¯æ·»åŠ å®¢æˆ·ç«¯(å³å…¬ç½‘æœºå™¨)</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_ae0e3068fac6af72c06b7b0d75273f0e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_ae0e3068fac6af72c06b7b0d75273f0e.png"></p><h2 id="äºŒ-windowså®¢æˆ·ç«¯éƒ¨ç½²åŠé…ç½®"><a href="#äºŒ-windowså®¢æˆ·ç«¯éƒ¨ç½²åŠé…ç½®" class="headerlink" title="äºŒ. windowså®¢æˆ·ç«¯éƒ¨ç½²åŠé…ç½®"></a>äºŒ. windowså®¢æˆ·ç«¯éƒ¨ç½²åŠé…ç½®</h2><p><strong>1.windowséƒ¨ç½²å®¢æˆ·ç«¯</strong></p><p>â‘ . ä¸‹è½½windowså®¢æˆ·ç«¯åè§£å‹ åªéœ€è¦npc.exeæ–‡ä»¶å³å¯</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_d62ad08fa5766009969742debee80da7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_d62ad08fa5766009969742debee80da7.png"></p><p>åœ¨windows Cç›˜/ç›®å½•ä¸‹é¢æ–°å»ºnpsæ–‡ä»¶å¤¹ å°†windowså®¢æˆ·ç«¯è§£å‹åå°†npc.exeæ–‡ä»¶ç§»åŠ¨åˆ°æ­¤ç›®å½•  ç®¡ç†å‘˜cmdæ‰§è¡Œ <code>npc.exe install -server=66.21.23.155:8024 -vkey=gsdvhdfjv899 -type=tcp</code> npc.exeåé¢éƒ¨åˆ†åœ¨æœåŠ¡ç«¯æŸ¥çœ‹</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_a1afdda8cd7170abb50a4f3d4a0d251b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_a1afdda8cd7170abb50a4f3d4a0d251b.png"></p><p>â‘¡.windowsæœåŠ¡é…ç½®å¦‚ä¸‹</p><p>æ¢å¤ &gt; ç¬¬ä¸€äºŒä¸‰é…ç½®ä¸ºé‡å¯å¯åŠ¨ ç¡®å®šåå¯åŠ¨æœåŠ¡å³å¯</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_84222ed2b1fb1401dacbb27047b7c134.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_84222ed2b1fb1401dacbb27047b7c134.png"></p><p><strong>æ‰§è¡ŒæˆåŠŸåæœåŠ¡ç«¯ é¦–é¡µ&gt;å®¢æˆ·ç«¯&gt;ä¼šå‡ºç°IP</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_41ba52dbcd70c30532ea5989baa4d7d7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_41ba52dbcd70c30532ea5989baa4d7d7.png"></p><p><strong>â‘¢. å®¢æˆ·ç«¯ é¦–é¡µ &gt; TCPéš§é“ &gt; æ·»åŠ ä¸Šé¢å®¢æˆ·ç«¯çš„TCPéš§é“ ï¼ˆIDå¯¹åº”å®¢æˆ·ç«¯ å®¢æˆ·ç«¯åœ°å€å¯å¡«å†™ä¸º127.0.0.1æˆ–è€…å®é™…å†…ç½‘IP æœ¬æ¬¡æµ‹è¯•è¿œç¨‹æ¡Œé¢ æ˜ å°„å†…ç½‘æœºå™¨ç«¯å£3389ï¼‰</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_250ea9fa4e5f69920027160d625e0ec5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_250ea9fa4e5f69920027160d625e0ec5.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_4adcda786d64aee4c051530f03065499.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_4adcda786d64aee4c051530f03065499.png"></p><p><strong>â‘£. éªŒè¯ï¼ˆæˆåŠŸï¼‰</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_ff521fce395d32d506c7c6493866cc01.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_ff521fce395d32d506c7c6493866cc01.png"></p><h2 id="ä¸‰-linuxå®¢æˆ·ç«¯éƒ¨ç½²åŠé…ç½®"><a href="#ä¸‰-linuxå®¢æˆ·ç«¯éƒ¨ç½²åŠé…ç½®" class="headerlink" title="ä¸‰. linuxå®¢æˆ·ç«¯éƒ¨ç½²åŠé…ç½®"></a><strong>ä¸‰. linuxå®¢æˆ·ç«¯éƒ¨ç½²åŠé…ç½®</strong></h2><blockquote><p><strong>é•œåƒå¯é€‰ç§»æ­¥æœ¬æ–‡é¦–é¡µ</strong></p></blockquote><p><strong>1.dockeræ–¹å¼</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name=npc --restart=always --net=host ffdfgdfg/npc -server=&lt;ip:port&gt; -vkey=&lt;webç•Œé¢ä¸­æ˜¾ç¤ºçš„å¯†é’¥&gt; &lt;ä»¥åŠä¸€äº›å…¶ä»–å‚æ•°&gt;</span><br></pre></td></tr></table></figure><p>å®é™…</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_df8d7b820172e3d01209ea13eb218a43.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_df8d7b820172e3d01209ea13eb218a43.png"></p><p><strong>2. äºŒè¿›åˆ¶å®‰è£…æ–¹å¼ å®¢æˆ·ç«¯è½¯ä»¶åŒ… ç§»æ­¥é¦–é¡µé“¾æ¥</strong></p><blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…wgetå¹¶ä¸”ä¸‹è½½NPCæœåŠ¡ç«¯å¹¶é‡å‘½åä¸º npc.tar.gz ï¼Œå¯æ ¹æ®è‡ªå·±ç³»ç»Ÿå°†yumæ›¿æ¢ä¸ºaptæˆ–å…¶ä»–</span></span><br><span class="line">yum install -y wget &amp;&amp; wget --no-check-certificate -O npc.tar.gz https://img.zeruns.tech/down/linux_amd64_client.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªåä¸ºnpcçš„ç›®å½•å¹¶ä¸”è§£å‹NPCæœåŠ¡ç«¯æ–‡ä»¶åˆ°æ­¤ç›®å½•ä¸‹ï¼Œå¹¶ä¸”è¿›å…¥åˆ°npcè¿™ä¸ªç›®å½•ä¸‹</span></span><br><span class="line"><span class="built_in">mkdir</span> /opt/npc &amp;&amp; tar -zxvf npc.tar.gz -C /opt/npc &amp;&amp; <span class="built_in">cd</span> /opt/npc</span><br><span class="line"></span><br><span class="line"><span class="comment"># å®‰è£…NPCå¹¶å¯åŠ¨ï¼ŒæŒ‰æç¤ºæ”¹å¥½å‘½ä»¤ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º</span></span><br><span class="line">./npc install -server=&lt;ip:port&gt; -vkey=&lt;webç•Œé¢ä¸­æ˜¾ç¤ºçš„å¯†é’¥&gt; &lt;ä»¥åŠä¸€äº›å…¶ä»–å‚æ•°&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨NPC</span></span><br><span class="line">sudo npc start</span><br></pre></td></tr></table></figure></blockquote><blockquote><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_84b82cb2244e27d8995f465c7368eacd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_84b82cb2244e27d8995f465c7368eacd.png"></p><p><strong>æ­¤æ—¶äºŒè¿›åˆ¶å®‰è£…æ–¹å¼å®Œæˆ</strong></p></blockquote><p><strong>3.å»ºç«‹å†…ç½‘ç©¿é€éš§é“</strong></p><p>æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•å®‰è£…å¥½å®¢æˆ·ç«¯åå°±å¯ä»¥æ–°å»ºå†…ç½‘ç©¿é€éš§é“äº†ï¼Œæˆ‘è¿™é‡Œä»¥Windowsçš„è¿œç¨‹æ¡Œé¢æœåŠ¡ä¸ºä¾‹ï¼Œéœ€è¦å°†TCP 3389ç«¯å£æ˜ å°„å‡ºå»ï¼Œæ‰€ä»¥æ–°å»ºä¸€ä¸ªTCPéš§é“ï¼Œä½ ä»¬æ ¹æ®è‡ªå·±å®é™…éœ€è¦é€‰æ‹©TCPè¿˜æ˜¯UDP linux sshåˆ™ä¸º22ç«¯å£æ˜ å°„ã€‚</p><h2 id="å››-webæœåŠ¡ç«¯å£æ˜ å°„"><a href="#å››-webæœåŠ¡ç«¯å£æ˜ å°„" class="headerlink" title="å››. webæœåŠ¡ç«¯å£æ˜ å°„"></a>å››. webæœåŠ¡ç«¯å£æ˜ å°„</h2><p>åªéœ€è¦å»ºç«‹TCPéš§é“è½¬å‘åˆ°å†…ç½‘å¯¹åº”çš„ç«¯å£å³å¯ å’Œä¸Šæ–¹3389ç«¯å£è¿œç¨‹æ¡Œé¢æ“ä½œæ–¹å¼ä¸€æ ·</p><p>æ•ˆæœï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_7d8aaef53299b11833fced7c5fac039c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_7d8aaef53299b11833fced7c5fac039c.png"></p><p><strong>æœ¬æ–‡å‚è€ƒ</strong></p><p><a href="https://blog.zeruns.tech/archives/660.html">https://blog.zeruns.tech/archives/660.html</a></p><p>æ•™ç¨‹ç»“æŸã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntuéƒ¨ç½²nvidia-container-toolkit</title>
      <link href="/2024/07/15/ubuntu%E9%83%A8%E7%BD%B2nvidia-container-toolkit/"/>
      <url>/2024/07/15/ubuntu%E9%83%A8%E7%BD%B2nvidia-container-toolkit/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ubuntuéƒ¨ç½²nvidia-container-toolkit"><a href="#ubuntuéƒ¨ç½²nvidia-container-toolkit" class="headerlink" title="ubuntuéƒ¨ç½²nvidia-container-toolkit"></a>ubuntuéƒ¨ç½²nvidia-container-toolkit</h2><p>æœ¬æ•™ç¨‹å‰ææ¡ä»¶æ˜¯ å®¿ä¸»æœºéœ€è¦å®‰è£…å®ŒæˆGPUæ˜¾å¡çš„é©±åŠ¨ å³ä½¿ç”¨ nvidia-smi æœ‰æ­£å¸¸å›æ˜¾</p><p>è„šæœ¬éƒ¨ç½²å®¿ä¸»æœºé©±åŠ¨ï¼š<a href="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E8%84%9A%E6%9C%AC/ubuntu%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2NVIDIA%E9%A9%B1%E5%8A%A8/nvidia-gpu.sh">nvidia-gpu.sh</a></p><p>æœ¬æ•™ç¨‹ç¯å¢ƒï¼šubuntu22.04LTS</p><blockquote><p>NVIDIA containerä¸»è¦ç»„ä»¶åŒ…æ‹¬nvidia-container-runtime, nvidia-container-toolkit, libnvidia-containerå’ŒCUDAé©±åŠ¨ï¼›<br>åœ¨3.6.0ç‰ˆæœ¬åï¼ŒruntimeåŒ…æˆä¸ºä¸€ä¸ªåªä¾èµ–äºtoolkitåŒ…ï¼ˆæŒ‡container-toolkitè€Œä¸æ˜¯nvidia CUDA toolkitï¼‰çš„åŒ…ï¼Œåœ¨å®˜ç½‘ä¸­ä¹ŸæŒ‡å‡ºï¼Œå¯¹äºä¸€èˆ¬çš„åº”ç”¨è€Œè¨€ï¼Œnvidia-container-toolkitèƒ½å¤Ÿæ»¡è¶³ç»å¤§å¤šæ•°éœ€æ±‚ã€‚</p></blockquote><h3 id="1-å®˜ç½‘å®‰è£…æ–¹å¼-éœ€è¦ç§‘å­¦ä¸Šç½‘-ï¼š"><a href="#1-å®˜ç½‘å®‰è£…æ–¹å¼-éœ€è¦ç§‘å­¦ä¸Šç½‘-ï¼š" class="headerlink" title="1.å®˜ç½‘å®‰è£…æ–¹å¼(éœ€è¦ç§‘å­¦ä¸Šç½‘)ï¼š"></a>1.å®˜ç½‘å®‰è£…æ–¹å¼(éœ€è¦ç§‘å­¦ä¸Šç½‘)ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">root@dlp:~<span class="comment"># curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | gpg --dearmor -o /usr/share/keyrings/nvidia-toolkit.gpg</span></span><br><span class="line">root@dlp:~<span class="comment"># curl -fsSL https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | tee /etc/apt/sources.list.d/nvidia-toolkit.list</span></span><br><span class="line">root@dlp:~<span class="comment"># sed -i -e &quot;s/^deb/deb \[signed-by=\/usr\/share\/keyrings\/nvidia-toolkit.gpg\]/g&quot; /etc/apt/sources.list.d/nvidia-toolkit.list</span></span><br><span class="line">root@dlp:~<span class="comment"># apt update</span></span><br><span class="line">root@dlp:~<span class="comment"># apt -y install nvidia-container-toolkit</span></span><br><span class="line">root@dlp:~<span class="comment"># systemctl restart docker</span></span><br></pre></td></tr></table></figure><h3 id="2-ç¦»çº¿æ–¹å¼éƒ¨ç½²ï¼ˆä½ç‰ˆæœ¬ï¼‰"><a href="#2-ç¦»çº¿æ–¹å¼éƒ¨ç½²ï¼ˆä½ç‰ˆæœ¬ï¼‰" class="headerlink" title="2.ç¦»çº¿æ–¹å¼éƒ¨ç½²ï¼ˆä½ç‰ˆæœ¬ï¼‰"></a>2.ç¦»çº¿æ–¹å¼éƒ¨ç½²ï¼ˆä½ç‰ˆæœ¬ï¼‰</h3><p>ä¸‹è½½åˆ°æœ¬åœ°åä¸Šä¼ åˆ°æœåŠ¡å™¨ æ‰§è¡Œéƒ¨ç½²</p><p>ç¦»çº¿debåŒ…ä¸‹è½½åœ°å€ï¼š</p><p><a href="https://github.com/NVIDIA/libnvidia-container/blob/gh-pages/stable/ubuntu18.04">https://github.com/NVIDIA/libnvidia-container/blob/gh-pages/stable/ubuntu18.04</a></p><p>æœ¬åœ°ä¸‹è½½åœ°å€ï¼š</p><p><a href="https://onenote.zznnwn.cloudns.biz/zh-CN/public-tools/nvidia-deb/">https://onenote.zznnwn.cloudns.biz/zh-CN/public-tools/nvidia-deb/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg -i nvidia-container-toolkit_1.4.2-1_amd64.deb</span><br></pre></td></tr></table></figure><h3 id="3-æœ¬æ•™ç¨‹æˆåŠŸéƒ¨ç½²æ–¹å¼"><a href="#3-æœ¬æ•™ç¨‹æˆåŠŸéƒ¨ç½²æ–¹å¼" class="headerlink" title="3. æœ¬æ•™ç¨‹æˆåŠŸéƒ¨ç½²æ–¹å¼"></a>3. æœ¬æ•™ç¨‹æˆåŠŸéƒ¨ç½²æ–¹å¼</h3><p>ä¸‹æ–¹debåŒ…ä¸‹è½½åœ°å€è§onenote</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‰ç…§é¡ºåºå®‰è£…</span></span><br><span class="line">dpkg -i libnvidia-container1_1.9.0-1_amd64.deb</span><br><span class="line">dpkg -i libnvidia-container-tools_1.9.0-1_amd64.deb</span><br><span class="line">dpkg -i nvidia-container-toolkit_1.9.0-1_amd64.deb</span><br><span class="line">dpkg -i nvidia-container-runtime_3.9.0-1_all.deb</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦å·²ç»å®‰è£…äº†åŒ…</span></span><br><span class="line">dpkg -l | grep &lt;package_name&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤ç§éƒ¨ç½²åéœ€è¦åœ¨dockeræ·»åŠ é…ç½®</span></span><br><span class="line">âœ  ~ <span class="built_in">cat</span> /etc/docker/daemon.json</span><br><span class="line">&#123;</span><br><span class="line"> <span class="string">&quot;default-runtime&quot;</span>: <span class="string">&quot;nvidia&quot;</span>,</span><br><span class="line">    <span class="string">&quot;runtimes&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;nvidia&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;path&quot;</span>: <span class="string">&quot;/usr/bin/nvidia-container-runtime&quot;</span>,</span><br><span class="line">            <span class="string">&quot;runtimeArgs&quot;</span>: []</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯</span></span><br><span class="line">systemctl restart docker</span><br><span class="line"><span class="comment"># æœ€åéƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹æœåŠ¡</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_61c36b996becd1e14b738fbb930de4ac.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_61c36b996becd1e14b738fbb930de4ac.png"></p><h3 id="3-éªŒè¯-æˆåŠŸ"><a href="#3-éªŒè¯-æˆåŠŸ" class="headerlink" title="3.éªŒè¯(æˆåŠŸ)"></a>3.éªŒè¯(æˆåŠŸ)</h3><p>å¤‡æ³¨ï¼šä½¿ç”¨pveåˆ›å»ºçš„è™šæ‹Ÿæœºç›´é€šGPU éœ€è¦å°†cpuæ¨¡å¼è®¾ç½®ä¸ºhostï¼ˆé»˜è®¤ä¸ºqemuæ¨¡å¼ï¼‰ å¦åˆ™ä¼šæŠ¥é”™cpuä¸æ”¯æŒavxæŒ‡ä»¤é›†å¯¼è‡´GPUè¢«ç¦ç”¨</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_20236426c0189f25768346fb91a15c8f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_20236426c0189f25768346fb91a15c8f.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">root@dmx:/opt/ollama<span class="comment"># docker run -it --rm --gpus all registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ubuntu  nvidia-smi</span></span><br><span class="line">Tue Jul 23 07:28:58 2024   </span><br><span class="line">+-----------------------------------------------------------------------------------------+</span><br><span class="line">| NVIDIA-SMI 550.100                Driver Version: 550.100        CUDA Version: 12.4     |</span><br><span class="line">|-----------------------------------------+------------------------+----------------------+</span><br><span class="line">| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |</span><br><span class="line">| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |</span><br><span class="line">|                                         |                        |               MIG M. |</span><br><span class="line">|=========================================+========================+======================|</span><br><span class="line">|   0  NVIDIA GeForce RTX 4090 D      Off |   00000000:01:00.0 Off |                  Off |</span><br><span class="line">|  0%   40C    P5             65W /  425W |    5609MiB /  24564MiB |      0%      Default |</span><br><span class="line">|                                         |                        |                  N/A |</span><br><span class="line">+-----------------------------------------+------------------------+----------------------+</span><br><span class="line">                                                                               </span><br><span class="line">+-----------------------------------------------------------------------------------------+</span><br><span class="line">| Processes:                                                                              |</span><br><span class="line">|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |</span><br><span class="line">|        ID   ID                                                               Usage      |</span><br><span class="line">|=========================================================================================|</span><br><span class="line">+-----------------------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><p><a href="https://www.server-world.info/en/note?os=Ubuntu_24.04&p=nvidia&f=3">Ubuntu 24.04 : NVIDIA Container Toolkit : Install : Server World (server-world.info)</a></p><p><a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html">https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/install-guide.html</a> ï¼ˆå®˜ç½‘ï¼‰</p><p><a href="https://blog.csdn.net/u010953692/article/details/114053593">https://blog.csdn.net/u010953692/article/details/114053593</a></p><p><a href="https://blog.csdn.net/NekoTom/article/details/127508810">Dockerç¦»çº¿å®‰è£…Nvidia-container-toolkitå®ç°å®¹å™¨å†…GPUè°ƒç”¨-CSDNåšå®¢</a></p><p><a href="https://www.holelin.cn/2022/03/31/devops/%E8%BF%90%E7%BB%B4-%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85nvidia-docker2/index.html">https://www.holelin.cn/2022/03/31/devops/%E8%BF%90%E7%BB%B4-%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85nvidia-docker2/index.html</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TrueNASæ•™ç¨‹</title>
      <link href="/2024/07/12/TrueNAS%E6%95%99%E7%A8%8B/"/>
      <url>/2024/07/12/TrueNAS%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="TrueNASæ•™ç¨‹"><a href="#TrueNASæ•™ç¨‹" class="headerlink" title="TrueNASæ•™ç¨‹"></a>TrueNASæ•™ç¨‹</h1><p>æœ¬æ–‡å®ç°ï¼š</p><ul><li>å¯ä½¿ç”¨å¯¹è±¡å­˜å‚¨minio</li><li>äº‘ç›˜æœåŠ¡cloudreve</li></ul><p>é•œåƒï¼šåŸºäºdebainç³»ç»Ÿçš„TrueNASé•œåƒ: <a href="https://www.truenas.com/download-truenas-scale/">https://www.truenas.com/download-truenas-scale/</a></p><p>å®‰è£…å®Œæˆååè®¾ç½®å­˜å‚¨æ± </p><p>è¾ƒä¸ºç®€å•æ­¤å¤„ç•¥ï¼š</p><p>å¤‡æ³¨ï¼š</p><ul><li><p>åˆ›å»ºä¸“é—¨ç»™è™šæ‹Ÿæœºä½¿ç”¨çš„å­˜å‚¨æ± </p></li><li><p>åˆ›å»ºä¸“é—¨ç»™naså†…æ–‡ä»¶å­˜å‚¨NFS SMBç­‰ä½¿ç”¨çš„æ± <br><del>ä¹Ÿå¯ä»¥å…±ç”¨ä¸€ä¸ªå­˜å‚¨æ± ï¼</del></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_eb5dbef3df98678d4924d47ec4fcadd4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_eb5dbef3df98678d4924d47ec4fcadd4.png"></p></li></ul><p>ç½‘ç»œé…ç½®ï¼š</p><ul><li><p>é…ç½®é™æ€IPåœ°å€</p></li><li><p>é…ç½®é˜¿é‡Œäº‘ç™¾åº¦ç­‰DNS</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_4c5a790184f9654bf27a608eacfa6dc1.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_4c5a790184f9654bf27a608eacfa6dc1.png"></p></li></ul><p>å®‰è£…è™šæ‹Ÿæœºï¼ˆå®‰è£…å®Œæˆåå…³é—­ ç‚¹å‡»è®¾å¤‡ åˆ é™¤å…‰ç›˜å¦åˆ™ä¼šé‡å¤è¿›å…¥å®‰è£…é¡µé¢ï¼‰ï¼š</p><ul><li><p>è™šæ‹Ÿæœºå†…å®‰è£…dockerç”¨äºéƒ¨ç½²minio, cloudreveåŠhomepage å¯¹å¤–æä¾›æœåŠ¡</p><p>ç­‰å¾…å®‰è£…å®Œæˆï¼Œç„¶åç‚¹å‡»rebootï¼Œé‡å¯è™šæ‹Ÿæœºåç‚¹å‡»è™šæ‹Ÿæœºçš„VNCè¿›å…¥åå‘ç°ä¼šé‡å¤è¿›å…¥å®‰è£…centosç•Œé¢ï¼Œé€ æˆè¿™ä¸ªé—®é¢˜çš„åŸå› æ˜¯è™šæ‹Ÿæœºè®¾ç½®çš„æ˜¯UEFIå¯åŠ¨ï¼Œå¦å¤–è™šæ‹Ÿæœºçš„â€œè®¾å¤‡â€ä¸­ä¹Ÿæœ‰è®¾å¤‡å¯åŠ¨é¡ºåºï¼Œç›®å‰lzè¯•ç€ä¿®æ”¹è™šæ‹Ÿæœºå¯åŠ¨é¡¹å’Œè®¾å¤‡ä¸­isoçš„å¯åŠ¨é¡ºåºéƒ½ä¸å¥½ä½¿ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯æ‰¾åˆ°è™šæ‹Ÿæœºï¼Œç‚¹å¼€åé¢ç®­å¤´&gt;</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_68dbe9db3d033b78ea5491141651373e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_68dbe9db3d033b78ea5491141651373e.png"></p></li><li><p>åˆ é™¤cdrom</p><p><strong>æ‰¾åˆ°CDROMé¡¹ç‚¹ï¼Œå¼€æœ€åçš„ä¸‰ç‚¹æŸ¥çœ‹è¯¦æƒ…ï¼ŒæŸ¥çœ‹æ˜¯å¦ä¸ºå½“å‰ç³»ç»Ÿçš„isoé•œåƒæ–‡ä»¶ï¼Œå¦‚æœæ˜¯çš„è¯åˆ é™¤é‡å¯è™šæ‹Ÿæœºæ­¤æ—¶å³å¯å®Œå…¨éƒ¨ç½²å®Œæˆ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_2b198de5c11ec661e26dda80d8f7dc6d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_2b198de5c11ec661e26dda80d8f7dc6d.png"></p></li></ul><p>å¤‡æ³¨ï¼šTrueNASå†…åº”ç”¨æ˜¯æ— æ³•ä½¿ç”¨çš„åŸå› éœ€è¦é…ç½®ç§‘å­¦ä¸Šç½‘æ‰èƒ½æ­£å¸¸ä½¿ç”¨ å¦åˆ™åªæ˜¯ä¸€è¿ä¸²çš„æŠ¥é”™</p><h3 id="å‘½ä»¤è¡Œé…ç½®IP"><a href="#å‘½ä»¤è¡Œé…ç½®IP" class="headerlink" title="å‘½ä»¤è¡Œé…ç½®IP"></a>å‘½ä»¤è¡Œé…ç½®IP</h3><p><a href="https://www.ethanzhang.xyz/2023/05/14/TrueNAS%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B/">https://www.ethanzhang.xyz/2023/05/14/TrueNASå®‰è£…åŠä½¿ç”¨æ•™ç¨‹/</a> (è¾ƒä¸ºè¯¦ç»†çš„å®Œå…¨æ•™ç¨‹)</p><p>ç³»ç»Ÿå®Œæˆåï¼Œé¦–å…ˆä¼šè”æƒ³åˆ°ç™»å½•åˆ°webé¡µé¢è¿›è¡Œç®¡ç†ï¼Œä½†é—®é¢˜æ­£å¦‚å¼€ç¯‡æ‰€è¯´ï¼Œæœ‰ç‚¹å°éš¾ç‚¹åœ¨äºè®¿é—®çš„ç®¡ç†IPçš„è®¾å®š</p><blockquote><p>æ³¨æ„</p><p>TrueNASé»˜è®¤æ˜¯DHCPä½¿èƒ½çš„ï¼Œå¦‚æœå½“å‰å®‰è£…ç¯å¢ƒä¸‹æœ‰DHCPæœåŠ¡å™¨ï¼Œå¯ä»¥é€šè¿‡TrueNASä¸´æ—¶è·å–çš„IPåœ°å€ç›´æ¥è¿›è¡ŒWeb UIç®¡ç†ï¼Œå¯ä»¥è·³è¿‡å½“å‰æ­¥éª¤</p></blockquote><p>æ­¤æ—¶éœ€è¦åœ¨TrueNASçš„ç»ˆç«¯è®¾ç½®å›ºå®šIP</p><p>é€‰æ‹©<code>1</code>ï¼ŒæŸ¥çœ‹å¹¶è®¾ç½®ç½‘ç»œæ¥å£ å°†<code>ipv4_dhcp</code>é€‰æ‹©å¦</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_21bef307d4ca1da94b6cb40263f68ba6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_21bef307d4ca1da94b6cb40263f68ba6.png"></p><p>é€‰æ‹©<code>6</code>ï¼Œè¿›å…¥<code>Open TrueNAS CLI Shell</code></p><p>å¯ä»¥é€šè¿‡<code>netuork interface query</code>æŸ¥è¯¢å½“å‰ç½‘ç»œé€‚é…å™¨çš„ç›¸å…³ä¿¡æ¯ï¼Œä¸»è¦æ˜¯è·å–é€‚é…å™¨<code>name</code>å€¼ç”¨äºåç»­é…ç½®é™æ€IP</p><p>é€šè¿‡<code>network interface update ens160 aliases=&quot;172.18.3.20/24&quot;</code>åŠ<code>netuork intertace commit</code>ã€<code>network intertace checkin</code>è¿›è¡Œé…ç½®</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_b67f881228c4b541b897ce2b2d92fdc9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_b67f881228c4b541b897ce2b2d92fdc9.png"></p><p>éªŒè¯å¹¶é…ç½®ç½‘å…³åŠDNS</p><blockquote><p>å¿…é¡»å…ˆè®¾ç½®é™æ€ipåœ°å€æ‰èƒ½è®¾ç½®ç½‘å…³ï¼Œå¦åˆ™æç¤ºç½‘å…³ä¸å¯è¾¾</p></blockquote><p>è¿”å›å¹¶é€‰æ‹©<code>2 configure network settings</code>ï¼Œç„¶åé…ç½®ç½‘å…³åŠDNSä¿¡æ¯</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_3ec55c9da582caec873b3c578e714f03.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_3ec55c9da582caec873b3c578e714f03.png"></p><p>æ­¤æ—¶ï¼Œå¦‚æœèƒ½å¤Ÿpingé€šç®¡ç†IPåœ°å€ï¼Œåˆå§‹åŒ–å·¥ä½œå°±ç®—å®Œæˆ</p><h3 id="TrueNAS-APPåº”ç”¨æ·»åŠ TrueChartsç¤¾åŒºcatalogç›®å½•"><a href="#TrueNAS-APPåº”ç”¨æ·»åŠ TrueChartsç¤¾åŒºcatalogç›®å½•" class="headerlink" title="TrueNAS APPåº”ç”¨æ·»åŠ TrueChartsç¤¾åŒºcatalogç›®å½•"></a>TrueNAS APPåº”ç”¨æ·»åŠ TrueChartsç¤¾åŒºcatalogç›®å½•</h3><p><strong>å‚è€ƒï¼š</strong></p><ul><li><p><a href="https://gitee.com/truecharts/dh_catalog">https://gitee.com/truecharts/dh_catalog</a><br><a href="https://gitee.com/JerryFox/true-nas-catalog">https://gitee.com/JerryFox/true-nas-catalog</a><br><a href="https://www.cnblogs.com/Jerrycjc/p/17134915.html">https://www.cnblogs.com/Jerrycjc/p/17134915.html</a><br><a href="https://www.shiyunhao.cn/archives/truenasapp-ying-yong-tian-jia-truecharts-she-qu-catalog-mu-lu">https://www.shiyunhao.cn/archives/truenasapp-ying-yong-tian-jia-truecharts-she-qu-catalog-mu-lu</a></p></li><li><p>ä½¿ç”¨æœ¬åœ°ä»“åº“</p><p><a href="https://gitee.com/apple-Teawine/true-nas-catalog.git">https://gitee.com/apple-Teawine/true-nas-catalog.git</a><br>main<br>stable,dependency,enterprise,incubator åˆ†æ”¯</p></li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_58eba0a1e41467c84a152b151ce85a61.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_58eba0a1e41467c84a152b151ce85a61.png"></p><h3 id="ä»€ä¹ˆæ˜¯å­˜å‚¨æ± "><a href="#ä»€ä¹ˆæ˜¯å­˜å‚¨æ± " class="headerlink" title="ä»€ä¹ˆæ˜¯å­˜å‚¨æ± "></a>ä»€ä¹ˆæ˜¯å­˜å‚¨æ± </h3><p>å­˜å‚¨æ± å³ä¸ºTrueNASç”¨äºå­˜æ”¾æ•°æ®çš„åœ°æ–¹ï¼Œå¯ä»¥å°†å¤šå—ç¡¬ç›˜ç»„æˆä¸åŒçš„æ¨¡å¼ï¼Œç”¨äºå®ç°æ•°æ®å­˜å‚¨çš„å†—ä½™å’Œæ›´å¿«çš„è¯»å†™è¡Œèƒ½</p><h3 id="å…³äºraid"><a href="#å…³äºraid" class="headerlink" title="å…³äºraid:"></a>å…³äºraid:</h3><p>ä¸ç£ç›˜é˜µåˆ—å¡çš„åŸç†ç±»ä¼¼</p><ol><li><strong>æ¡å¸¦æ¨¡å¼</strong><br>æ¯ä¸ªç£ç›˜ç”¨äºå­˜å‚¨æ•°æ®ã€‚è‡³å°‘éœ€è¦ä¸€ä¸ªç£ç›˜å¹¶ä¸”æ²¡æœ‰æ•°æ®å†—ä½™ã€‚åˆ‡å‹¿ä½¿ç”¨æ¡å¸¦æ¨¡å¼å­˜å‚¨å…³é”®æ•°æ®ï¼å•ä¸ªç£ç›˜æ•…éšœä¼šå¯¼è‡´ vdev ä¸­çš„æ‰€æœ‰æ•°æ®ä¸¢å¤±ã€‚æ­¤æ¨¡å¼ä¸‹ç£ç›˜è¡Œèƒ½æœ€ä½³ï¼Œæ•°æ®æœ€ä¸å®‰å…¨</li><li><strong>é•œåƒ</strong><br>æ¯ä¸ªç£ç›˜ä¸­çš„æ•°æ®éƒ½æ˜¯ç›¸åŒçš„ã€‚è‡³å°‘éœ€è¦ä¸¤ä¸ªç£ç›˜ï¼Œå†—ä½™æœ€å¤šï¼Œå®¹é‡æœ€å°‘ã€‚</li><li><strong>Raid-z</strong><br>ä½¿ç”¨ä¸€ä¸ªç£ç›˜è¿›è¡Œå¥‡å¶æ ¡éªŒï¼Œè€Œæ‰€æœ‰å…¶ä»–ç£ç›˜å­˜å‚¨æ•°æ®ã€‚è‡³å°‘éœ€è¦ä¸‰ä¸ªç£ç›˜ã€‚æœ€å¤šå…è®¸æŸå1å—ç¡¬ç›˜æ•°æ®ä»èƒ½å®‰å…¨å­˜å‚¨ã€‚</li><li><strong>Raid-z2</strong><br>ä½¿ç”¨ä¸¤ä¸ªç£ç›˜è¿›è¡Œå¥‡å¶æ ¡éªŒï¼Œè€Œæ‰€æœ‰å…¶ä»–ç£ç›˜éƒ½å­˜å‚¨æ•°æ®ã€‚è‡³å°‘éœ€è¦å››ä¸ªç£ç›˜ã€‚æœ€å¤šå…è®¸æŸå2å—ç¡¬ç›˜æ•°æ®ä»èƒ½å®‰å…¨å­˜å‚¨ã€‚</li><li><strong>Raid-z3</strong><br>ä½¿ç”¨ä¸‰ä¸ªç£ç›˜è¿›è¡Œå¥‡å¶æ ¡éªŒï¼Œè€Œæ‰€æœ‰å…¶ä»–ç£ç›˜éƒ½å­˜å‚¨æ•°æ®ã€‚è‡³å°‘éœ€è¦äº”ä¸ªç£ç›˜ã€‚æœ€å¤šå…è®¸æŸå3å—ç¡¬ç›˜æ•°æ®ä»èƒ½å®‰å…¨å­˜å‚¨ã€‚</li></ol><h3 id="å…³äºVDevç±»å‹"><a href="#å…³äºVDevç±»å‹" class="headerlink" title="å…³äºVDevç±»å‹"></a>å…³äºVDevç±»å‹</h3><p>æ¯ä¸ªç³»ç»Ÿå¿…é¡»å»ºç«‹ä¸€ä¸ªæ•°æ®å­˜å‚¨æ± ï¼Œå…¶ä½™å­˜å‚¨æ± å¯åœ¨æ•°æ®å­˜å‚¨æ± å»ºç«‹å®Œæˆåæ·»åŠ æˆ–åˆ é™¤ã€‚</p><p><strong>1ï¼‰æ•°æ®</strong><br>ç”¨äºä¸»å­˜å‚¨æ“ä½œçš„æ ‡å‡† vdevã€‚æ¯ä¸ªå­˜å‚¨æ± è‡³å°‘éœ€è¦ä¸€ä¸ªæ•°æ®vdevã€‚</p><p><strong>2ï¼‰ç¼“å­˜</strong><br>è¯»å–ç¼“å­˜ä¸å¿«é€Ÿè®¾å¤‡ä¸€èµ·ä½¿ç”¨ä»¥åŠ é€Ÿè¯»å–æ“ä½œã€‚<br>TrueNASå­˜å‚¨é¡ºåºä¸ºå†…å­˜-&gt;ç¼“å­˜å­˜å‚¨æ± -&gt;æ•°æ®å­˜å‚¨æ± ã€‚<br>æ•…ä½¿ç”¨å¤§å†…å­˜å’Œå¤§æ•°æ®å­˜å‚¨æ± å¯ä»¥æœ‰æ•ˆæé«˜æ•°æ®å­˜å‚¨è¡Œèƒ½</p><h3 id="æ—¥å¿—"><a href="#æ—¥å¿—" class="headerlink" title="æ—¥å¿—"></a><strong>æ—¥å¿—</strong></h3><p>æé«˜åŒæ­¥å†™å…¥é€Ÿåº¦çš„è®¾å¤‡</p><p><strong>4ï¼‰çƒ­å¤‡ä»½</strong><br>ä¸ºåœ¨æ´»åŠ¨é©±åŠ¨å™¨å‘ç”Ÿæ•…éšœæ—¶æ’å…¥æ•°æ®vdevä¿ç•™çš„é©±åŠ¨å™¨ã€‚çƒ­å¤‡ä»¶ä¸´æ—¶ç”¨ä½œæ•…éšœé©±åŠ¨å™¨çš„æ›¿ä»£å“ï¼Œä»¥é˜²æ­¢å‡ºç°æ›´å¤§çš„æ± å’Œæ•°æ®ä¸¢å¤±æƒ…å†µã€‚</p><p>å½“æ•…éšœé©±åŠ¨å™¨æ›´æ¢ä¸ºæ–°é©±åŠ¨å™¨æ—¶ï¼Œçƒ­å¤‡ä»¶å°†æ¢å¤ä¸ºéæ´»åŠ¨çŠ¶æ€å¹¶å†æ¬¡ç”¨ä½œçƒ­å¤‡ä»¶ã€‚</p><p>å½“æ•…éšœé©±åŠ¨å™¨ä»…ä»æ± ä¸­åˆ†ç¦»æ—¶ï¼Œä¸´æ—¶çƒ­å¤‡ç”¨å°†æå‡ä¸ºå®Œæ•´çš„æ•°æ®vdev æˆå‘˜ï¼Œå¹¶ä¸”ä¸å†å¯ç”¨ä½œçƒ­å¤‡ç”¨ã€‚</p><p><strong>5ï¼‰å…ƒæ•°æ®</strong><br>ä¸€ä¸ªç‰¹æ®Šçš„ vdev å¯ä»¥å­˜å‚¨å…ƒæ•°æ®ï¼Œä¾‹å¦‚æ–‡ä»¶ä½ç½®å’Œåˆ†é…è¡¨ã€‚ç‰¹æ®Šç±»ä¸­çš„åˆ†é…ä¸“ç”¨äºç‰¹å®šçš„å—ç±»å‹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™åŒ…æ‹¬æ‰€æœ‰å…ƒæ•°æ®ã€ç”¨æˆ·æ•°æ®çš„é—´æ¥å—å’Œä»»ä½•é‡å¤æ•°æ®åˆ é™¤è¡¨ã€‚è¯¥ç±»ä¹Ÿå¯ä»¥é…ç½®ä¸ºæ¥å—å°æ–‡ä»¶å—ã€‚å¯¹äºé«˜æ€§èƒ½ä½†è¾ƒå°å°ºå¯¸çš„å›ºæ€å­˜å‚¨æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç”¨ä¾‹ã€‚ä½¿ç”¨ç‰¹æ®Šçš„ vdev æå¤§åœ°åŠ é€Ÿäº†éšæœº I/Oï¼Œå¹¶å°†æŸ¥æ‰¾å’Œè®¿é—®æ–‡ä»¶æ‰€éœ€çš„å¹³å‡æ—‹è½¬ç£ç›˜ I/O å‡å°‘äº†ä¸€åŠã€‚</p><p><strong>6ï¼‰å»é‡</strong><br>æ± å¯ä»¥åŒ…å«å…±å­˜çš„é‡å¤æ•°æ®åˆ é™¤æ•°æ®å’Œéé‡å¤æ•°æ®åˆ é™¤æ•°æ®çš„ä»»æ„ç»„åˆã€‚å¦‚æœåœ¨å†™å…¥æ—¶å¯ç”¨äº†é‡å¤æ•°æ®åˆ é™¤ï¼Œåˆ™ä½¿ç”¨ DDT å†™å…¥æ•°æ®ï¼Œå¦‚æœåœ¨å†™å…¥æ—¶æœªå¯ç”¨é‡å¤æ•°æ®åˆ é™¤ï¼Œåˆ™ä»¥éé‡å¤æ•°æ®çš„æ–¹å¼å†™å…¥æ•°æ®ã€‚éšåï¼Œæ•°æ®å°†ä¿æŒå†™å…¥æ—¶çš„çŠ¶æ€ï¼Œç›´åˆ°è¢«åˆ é™¤ã€‚ç®€è€Œè¨€ä¹‹å°±æ˜¯å°†å­˜å‚¨æ•°æ®åˆ‡å‰²å¯¹æ¯”ç›¸åŒçš„éƒ¨åˆ†ä¼šä»…å­˜å‚¨ä¸€ä»½ï¼Œä½†æ˜¯è¿™æ ·ä¼šå¤§é‡æ¶ˆè€—CPUèµ„æºã€‚</p><h3 id="äº”ã€å…³äºåŠ å¯†"><a href="#äº”ã€å…³äºåŠ å¯†" class="headerlink" title="äº”ã€å…³äºåŠ å¯†"></a>äº”ã€å…³äºåŠ å¯†</h3><p>åŠ å¯†ç®—æ³•å¯ä½œä¸ºæœ€å¤§åŒ–æ•°æ®å®‰å…¨æ€§çš„é€‰é¡¹ã€‚è¿™ä¹Ÿä½¿æ£€ç´¢æ•°æ®çš„æ–¹å¼å˜å¾—å¤æ‚ï¼Œå¹¶æœ‰æ°¸ä¹…æ•°æ®ä¸¢å¤±çš„é£é™©ï¼</p><p>åŠ å¯†æ•°æ®ç¼ºç‚¹/æ³¨æ„äº‹é¡¹ï¼š</p><p>ä¸¢å¤±åŠ å¯†å¯†é’¥å’Œå¯†ç æ„å‘³ç€ä¸¢å¤±æ‚¨çš„æ•°æ®ã€‚<br>ä¸ç›¸å…³çš„åŠ å¯†æ•°æ®é›†ä¸æ”¯æŒé‡å¤æ•°æ®åˆ é™¤ã€‚<br>æˆ‘ä»¬ä¸å»ºè®®å°† GELI æˆ– ZFS åŠ å¯†ä¸é‡å¤æ•°æ®åˆ é™¤ä¸€èµ·ä½¿ç”¨ï¼Œå› ä¸ºè¿™ä¼šå¯¹æ€§èƒ½äº§ç”Ÿç›¸å½“å¤§çš„å½±å“ã€‚<br>åŒæ—¶ä½¿ç”¨å¤šä¸ªåŠ å¯†å’Œé‡å¤æ•°æ®åˆ é™¤åŠŸèƒ½æ—¶è¦å°å¿ƒï¼Œå› ä¸ºå®ƒä»¬éƒ½å°†ç«äº‰ç›¸åŒçš„ CPU å‘¨æœŸã€‚</p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/qq_42910468/article/details/122585133">https://blog.csdn.net/qq_42910468/article/details/122585133</a></p><p><a href="https://blog.tonnp.com/2022/truenas-data-protection-manager.html">https://blog.tonnp.com/2022/truenas-data-protection-manager.html</a></p>]]></content>
      
      
      <categories>
          
          <category> nas </category>
          
      </categories>
      
      
        <tags>
            
            <tag> nas </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Minioå•æœºä¸é›†ç¾¤éƒ¨ç½²å¹¶ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡</title>
      <link href="/2024/07/04/Minio%E5%8D%95%E6%9C%BA%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E5%B9%B6%E4%BD%BF%E7%94%A8nginx%E8%BF%9B%E8%A1%8C%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
      <url>/2024/07/04/Minio%E5%8D%95%E6%9C%BA%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E5%B9%B6%E4%BD%BF%E7%94%A8nginx%E8%BF%9B%E8%A1%8C%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Minioå•æœºä¸é›†ç¾¤éƒ¨ç½²å¹¶ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡"><a href="#Minioå•æœºä¸é›†ç¾¤éƒ¨ç½²å¹¶ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡" class="headerlink" title="Minioå•æœºä¸é›†ç¾¤éƒ¨ç½²å¹¶ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡"></a>Minioå•æœºä¸é›†ç¾¤éƒ¨ç½²å¹¶ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡</h1><p>é›†ç¾¤ç‰ˆéƒ¨ç½²å‚è€ƒï¼š<a href="https://wn.zznnwn.cloudns.biz/2023/09/19/minio%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8docker-compose%E9%83%A8%E7%BD%B2/?highlight=minio">gegewu_cloud</a></p><h2 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h2><p><code>MinIO</code> æ˜¯ä¸€ä¸ªå¼€æºçš„<strong>å¯¹è±¡å­˜å‚¨æœåŠ¡å™¨</strong>ï¼Œå®ƒå…¼å®¹<code>Amazon S3ï¼ˆSimple Storage Serviceï¼‰API</code>ã€‚å®ƒè¢«è®¾è®¡ç”¨äºæ„å»ºåˆ†å¸ƒå¼å­˜å‚¨æ¶æ„ï¼Œæä¾›é«˜å¯ç”¨æ€§ã€é«˜æ€§èƒ½å’Œå¯æ‰©å±•çš„å¯¹è±¡å­˜å‚¨è§£å†³æ–¹æ¡ˆã€‚</p><p>ä¸‹é¢æ˜¯MinIOçš„ä¸€äº›ä¸»è¦ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼š</p><ul><li><strong>å¯¹è±¡å­˜å‚¨</strong>ï¼šMinIOä»¥å¯¹è±¡ä¸ºåŸºæœ¬å­˜å‚¨å•å…ƒï¼Œå¯ä»¥å­˜å‚¨å’Œç®¡ç†ä»»æ„å¤§å°çš„æ–‡ä»¶ã€æ•°æ®å¯¹è±¡ã€‚å®ƒæä¾›äº†æ ‡å‡†çš„å¯¹è±¡å­˜å‚¨æ“ä½œï¼Œå¦‚ä¸Šä¼ ã€ä¸‹è½½ã€åˆ é™¤å’Œå…ƒæ•°æ®ç®¡ç†ã€‚</li><li><strong>åˆ†å¸ƒå¼æ¶æ„</strong>ï¼šMinIOé‡‡ç”¨åˆ†å¸ƒå¼æ¶æ„ï¼Œå¯ä»¥åœ¨å¤šä¸ªèŠ‚ç‚¹ä¸Šéƒ¨ç½²ï¼Œå¹¶å°†æ•°æ®åˆ†å¸ƒå’Œå¤åˆ¶åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šã€‚è¿™æä¾›äº†é«˜å¯ç”¨æ€§å’Œæ•°æ®å†—ä½™ï¼Œç¡®ä¿æ•°æ®çš„æŒä¹…æ€§å’Œå¯é æ€§ã€‚</li><li><strong>é«˜æ€§èƒ½</strong>ï¼šMinIOé€šè¿‡å¹¶è¡Œå¤„ç†å’Œåˆ†å¸ƒå¼æ¶æ„å®ç°é«˜æ€§èƒ½çš„æ•°æ®å­˜å–ã€‚å®ƒåˆ©ç”¨ç°ä»£ç¡¬ä»¶å’Œç½‘ç»œæŠ€æœ¯ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸å¤„ç†å™¨å’Œé«˜å¸¦å®½ç½‘ç»œï¼Œä»¥å®ç°å¿«é€Ÿçš„æ•°æ®ä¼ è¾“å’Œå¤„ç†ã€‚</li><li><strong>æ°´å¹³æ‰©å±•</strong>ï¼šMinIOå¯ä»¥æ°´å¹³æ‰©å±•ï¼Œé€šè¿‡æ·»åŠ æ›´å¤šçš„èŠ‚ç‚¹æ¥å¢åŠ å­˜å‚¨å®¹é‡å’Œååé‡ã€‚å®ƒæ”¯æŒè‡ªåŠ¨æ•°æ®åˆ†ç‰‡å’Œè´Ÿè½½å‡è¡¡ï¼Œç¡®ä¿æ•°æ®åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šå‡åŒ€åˆ†å¸ƒå’Œè®¿é—®çš„è´Ÿè½½å‡è¡¡ã€‚</li><li><strong>æ•°æ®ä¿æŠ¤</strong>ï¼šMinIOæä¾›äº†å¤šç§æ•°æ®ä¿æŠ¤æœºåˆ¶ï¼ŒåŒ…æ‹¬æ•°æ®å†—ä½™ã€æ•…éšœè½¬ç§»å’Œæ•°æ®æ ¡éªŒã€‚å®ƒå¯ä»¥åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¹‹é—´å¤åˆ¶æ•°æ®ï¼Œä»¥åº”å¯¹èŠ‚ç‚¹æ•…éšœå’Œæ•°æ®æŸåçš„æƒ…å†µã€‚</li><li><strong>å®‰å…¨æ€§</strong>ï¼šMinIOæ”¯æŒæ•°æ®åŠ å¯†å’Œè®¿é—®æ§åˆ¶ï¼Œä¿æŠ¤å­˜å‚¨åœ¨å…¶ä¸­çš„æ•°æ®çš„å®‰å…¨æ€§å’Œéšç§æ€§ã€‚å®ƒæä¾›äº†ä¼ è¾“å±‚åŠ å¯†ï¼ˆTLS/SSLï¼‰å’ŒæœåŠ¡å™¨ç«¯åŠ å¯†é€‰é¡¹ï¼Œä»¥åŠèº«ä»½éªŒè¯å’Œè®¿é—®æ§åˆ¶æœºåˆ¶ã€‚</li></ul><p>æ€»çš„æ¥è¯´ï¼ŒMinIOæ˜¯ä¸€ä¸ªå¼€æºçš„é«˜æ€§èƒ½å¯¹è±¡å­˜å‚¨æœåŠ¡å™¨ï¼Œé€‚ç”¨äºæ„å»ºåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿã€‚å®ƒå…·æœ‰é«˜å¯ç”¨æ€§ã€å¯æ‰©å±•æ€§å’Œæ•°æ®ä¿æŠ¤æœºåˆ¶ï¼Œå…¼å®¹Amazon S3 APIï¼Œä½¿å…¶ä¸ç°æœ‰çš„S3ç”Ÿæ€ç³»ç»Ÿå’Œå·¥å…·é›†æˆæ— ç¼ã€‚MinIOåœ¨å¤§æ•°æ®ã€äº‘è®¡ç®—å’Œå®¹å™¨åŒ–ç¯å¢ƒä¸­å¹¿æ³›åº”ç”¨ï¼Œä¸ºåº”ç”¨ç¨‹åºæä¾›äº†å¯é ã€é«˜æ•ˆçš„å¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚</p><p>è¿™é‡Œä¸»è¦ä¾§é‡ä½¿ç”¨dockerå¿«é€Ÿéƒ¨ç½²ç¯å¢ƒï¼Œæƒ³äº†è§£æ›´å¤šï¼Œå¯ä»¥å‚è€ƒæˆ‘ä»¥ä¸‹å‡ ç¯‡æ–‡ç« ï¼š</p><ul><li><a href="https://www.cnblogs.com/liugp/p/16558869.html">é«˜æ€§èƒ½åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨â€”â€”MinIOï¼ˆç¯å¢ƒéƒ¨ç½²ï¼‰</a></li><li><a href="https://www.cnblogs.com/liugp/p/16560313.html">é«˜æ€§èƒ½åˆ†å¸ƒå¼å¯¹è±¡å­˜å‚¨â€”â€”MinIOå®æˆ˜æ“ä½œï¼ˆMinIOæ‰©å®¹ï¼‰</a></li><li><a href="https://www.cnblogs.com/liugp/p/16884294.html">ã€äº‘åŸç”Ÿã€‘Minio on k8s è®²è§£ä¸å®æˆ˜æ“ä½œ</a></li><li><a href="https://www.cnblogs.com/liugp/p/16632616.html">ã€äº‘åŸç”Ÿ.å¤§æ•°æ®ã€‘é•œåƒä»“åº“Harborå¯¹æ¥MinIOå¯¹è±¡å­˜å‚¨</a></li></ul><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.min.io/">https://docs.min.io/</a><br>ä¸­æ–‡æ–‡æ¡£ï¼š<a href="http://docs.minio.org.cn/docs/">http://docs.minio.org.cn/docs/</a></p><h2 id="äºŒã€MinIO-ä¸-Ceph-å¯¹æ¯”"><a href="#äºŒã€MinIO-ä¸-Ceph-å¯¹æ¯”" class="headerlink" title="äºŒã€MinIO ä¸ Ceph å¯¹æ¯”"></a>äºŒã€MinIO ä¸ Ceph å¯¹æ¯”</h2><p>MinIOå’ŒCephéƒ½æ˜¯æµè¡Œçš„å¼€æºå­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œå®ƒä»¬åœ¨å¯¹è±¡å­˜å‚¨é¢†åŸŸæœ‰ä¸åŒçš„ç‰¹ç‚¹å’Œé€‚ç”¨åœºæ™¯ã€‚ä¸‹é¢æ˜¯MinIOå’ŒCephçš„å¯¹æ¯”ï¼š</p><h3 id="1ï¼‰æ¶æ„è®¾è®¡å¯¹æ¯”"><a href="#1ï¼‰æ¶æ„è®¾è®¡å¯¹æ¯”" class="headerlink" title="1ï¼‰æ¶æ„è®¾è®¡å¯¹æ¯”"></a>1ï¼‰æ¶æ„è®¾è®¡å¯¹æ¯”</h3><ul><li>**<code>MinIO</code>**ï¼š<code>MinIO</code>é‡‡ç”¨åˆ†å¸ƒå¼æ¶æ„ï¼Œä»¥æ°´å¹³æ‰©å±•ä¸ºåŸºç¡€ã€‚å®ƒé€šè¿‡å¤šä¸ªç‹¬ç«‹çš„MinIOèŠ‚ç‚¹ç»„æˆé›†ç¾¤ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯ç‹¬ç«‹çš„å¯¹è±¡å­˜å‚¨æœåŠ¡å™¨ã€‚MinIOä¸“æ³¨äºæä¾›ç®€å•ã€è½»é‡çº§çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œé€‚ç”¨äºå°å‹åˆ°ä¸­ç­‰è§„æ¨¡çš„éƒ¨ç½²ã€‚</li><li>**<code>Ceph</code>**ï¼š<code>Ceph</code>æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œç”±å¯¹è±¡å­˜å‚¨ã€å—å­˜å‚¨å’Œæ–‡ä»¶ç³»ç»Ÿç»„æˆã€‚å®ƒä½¿ç”¨<code>RADOSï¼ˆReliable Autonomic Distributed Object Storeï¼‰</code>ä½œä¸ºåº•å±‚å­˜å‚¨ç³»ç»Ÿï¼Œæä¾›é«˜å¯ç”¨æ€§å’Œæ•°æ®å†—ä½™ã€‚Cephé€‚ç”¨äºå¤§è§„æ¨¡çš„ä¼ä¸šçº§éƒ¨ç½²ï¼Œå…·æœ‰å¤æ‚çš„æ¶æ„å’Œä¸°å¯Œçš„åŠŸèƒ½ã€‚</li></ul><h3 id="2ï¼‰æ•°æ®ä¸€è‡´æ€§å¯¹æ¯”"><a href="#2ï¼‰æ•°æ®ä¸€è‡´æ€§å¯¹æ¯”" class="headerlink" title="2ï¼‰æ•°æ®ä¸€è‡´æ€§å¯¹æ¯”"></a>2ï¼‰æ•°æ®ä¸€è‡´æ€§å¯¹æ¯”</h3><ul><li><code>MinIO</code>ï¼š<code>MinIO</code>åœ¨é»˜è®¤é…ç½®ä¸‹æä¾›æœ€ç»ˆä¸€è‡´æ€§ï¼Œå³å†™å…¥æ“ä½œè¿”å›æˆåŠŸåï¼Œæ•°æ®å¯èƒ½ä¼šæœ‰ä¸€å®šçš„æ—¶é—´çª—å£å†…çš„å»¶è¿Ÿæ‰èƒ½å®Œå…¨ä¸€è‡´ã€‚è¿™é€‚ç”¨äºè®¸å¤šåº”ç”¨åœºæ™¯ï¼Œå¦‚æ•°æ®å¤‡ä»½ã€å­˜æ¡£ç­‰ã€‚</li><li><code>Ceph</code>ï¼š<code>Ceph</code>æä¾›å¼ºä¸€è‡´æ€§ï¼Œå³å†™å…¥æ“ä½œåœ¨è¿”å›æˆåŠŸåï¼Œæ•°æ®å³åˆ»å°±è¾¾åˆ°ä¸€è‡´æ€§ã€‚è¿™å¯¹äºéœ€è¦å¼ºä¸€è‡´æ€§ä¿è¯çš„åº”ç”¨åœºæ™¯éå¸¸é‡è¦ï¼Œå¦‚æ•°æ®åº“å’Œäº‹åŠ¡å¤„ç†ã€‚</li></ul><h3 id="3ï¼‰éƒ¨ç½²å’Œç®¡ç†å¯¹æ¯”"><a href="#3ï¼‰éƒ¨ç½²å’Œç®¡ç†å¯¹æ¯”" class="headerlink" title="3ï¼‰éƒ¨ç½²å’Œç®¡ç†å¯¹æ¯”"></a>3ï¼‰éƒ¨ç½²å’Œç®¡ç†å¯¹æ¯”</h3><ul><li><code>MinIO</code>ï¼š<code>MinIO</code> çš„éƒ¨ç½²å’Œç®¡ç†ç›¸å¯¹ç®€å•ï¼Œå¯ä»¥é€šè¿‡å•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶æˆ–å®¹å™¨è¿›è¡Œå¿«é€Ÿå®‰è£…å’Œé…ç½®ã€‚å®ƒæä¾›äº†ç›´è§‚çš„ç®¡ç†ç•Œé¢å’Œæ˜“äºä½¿ç”¨çš„APIï¼Œä½¿å¾—ç®¡ç†å’Œç›‘æ§å˜å¾—ç®€å•ã€‚</li><li><code>Ceph</code>ï¼š<code>Ceph</code> çš„éƒ¨ç½²å’Œç®¡ç†ç›¸å¯¹å¤æ‚ï¼Œæ¶‰åŠå¤šä¸ªç»„ä»¶å’Œé…ç½®ã€‚å®ƒéœ€è¦æ›´å¤šçš„æ—¶é—´å’Œä¸“ä¸šçŸ¥è¯†æ¥è®¾ç½®å’Œç»´æŠ¤ï¼Œéœ€è¦ç†Ÿæ‚‰Cephçš„æ¶æ„å’Œé…ç½®ã€‚</li></ul><h3 id="4ï¼‰ç”Ÿæ€ç³»ç»Ÿå’Œå…¼å®¹æ€§å¯¹æ¯”"><a href="#4ï¼‰ç”Ÿæ€ç³»ç»Ÿå’Œå…¼å®¹æ€§å¯¹æ¯”" class="headerlink" title="4ï¼‰ç”Ÿæ€ç³»ç»Ÿå’Œå…¼å®¹æ€§å¯¹æ¯”"></a>4ï¼‰ç”Ÿæ€ç³»ç»Ÿå’Œå…¼å®¹æ€§å¯¹æ¯”</h3><ul><li><code>MinIO</code>ï¼šMinIOä¸Amazon S3 APIå…¼å®¹ï¼Œè¿™æ„å‘³ç€ç°æœ‰çš„S3å·¥å…·å’Œåº”ç”¨ç¨‹åºå¯ä»¥æ— ç¼åœ°ä¸MinIOé›†æˆã€‚å®ƒè¿˜æœ‰ä¸€ä¸ªæ´»è·ƒçš„ç¤¾åŒºï¼Œæä¾›äº†å„ç§å®¢æˆ·ç«¯åº“å’Œæ’ä»¶ï¼Œæ‰©å±•äº†å…¶åŠŸèƒ½å’Œå…¼å®¹æ€§ã€‚</li><li><code>Ceph</code>ï¼š<code>Ceph</code> å…·æœ‰å¹¿æ³›çš„ç”Ÿæ€ç³»ç»Ÿå’Œä¸°å¯Œçš„åŠŸèƒ½é›†ã€‚å®ƒå¯ä»¥ä¸å¤šä¸ªåè®®å’Œæ¥å£ï¼ˆå¦‚RADOSã€RBDã€CephFSï¼‰è¿›è¡Œé›†æˆï¼Œæä¾›å—å­˜å‚¨ã€æ–‡ä»¶ç³»ç»Ÿå’Œå¯¹è±¡å­˜å‚¨çš„å…¨é¢è§£å†³æ–¹æ¡ˆã€‚</li></ul><p>ç»¼ä¸Šæ‰€è¿°ï¼Œ<strong>MinIOé€‚ç”¨äºç®€å•ã€è½»é‡çº§çš„å¯¹è±¡å­˜å‚¨éœ€æ±‚</strong>ï¼Œæ³¨é‡é«˜æ€§èƒ½å’Œæ˜“ç”¨æ€§ã€‚å®ƒé€‚åˆä¸­å°è§„æ¨¡éƒ¨ç½²ï¼Œå¹¶ä¸”ä¸Amazon S3å…¼å®¹ï¼Œæ˜“äºä¸ç°æœ‰çš„S3ç”Ÿæ€ç³»ç»Ÿé›†æˆã€‚</p><ul><li><strong><code>Ceph</code>åˆ™é€‚ç”¨äºå¤§è§„æ¨¡ã€å¤æ‚çš„ä¼ä¸šçº§å­˜å‚¨éœ€æ±‚</strong>ã€‚å®ƒæä¾›å¼ºä¸€è‡´æ€§å’Œä¸°å¯Œçš„åŠŸèƒ½é›†ï¼Œé€‚åˆéœ€è¦é«˜å¯ç”¨æ€§ã€æ•°æ®å†—ä½™å’Œå¤æ‚æ•°æ®æ“ä½œçš„åœºæ™¯ã€‚Cephçš„éƒ¨ç½²å’Œç®¡ç†ç›¸å¯¹å¤æ‚ï¼Œéœ€è¦æ›´å¤šçš„é…ç½®å’Œç®¡ç†å·¥ä½œã€‚</li><li>é€‰æ‹©<code>MinIO</code>è¿˜æ˜¯Cephå–å†³äºå…·ä½“çš„éœ€æ±‚å’Œåœºæ™¯ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªç®€å•ã€æ˜“ç”¨ã€é«˜æ€§èƒ½çš„å¯¹è±¡å­˜å‚¨è§£å†³æ–¹æ¡ˆï¼Œå¹¶ä¸S3å…¼å®¹ï¼Œé‚£ä¹ˆMinIOæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚å¦‚æœä½ éœ€è¦ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§ã€å¯æ‰©å±•ã€æ”¯æŒå—å­˜å‚¨å’Œæ–‡ä»¶ç³»ç»Ÿçš„åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œä¸”å…·å¤‡å¼ºä¸€è‡´æ€§çš„è¦æ±‚ï¼Œé‚£ä¹ˆCephæ˜¯æ›´é€‚åˆçš„é€‰æ‹©ã€‚</li></ul><p>æ— è®ºé€‰æ‹©MinIOè¿˜æ˜¯Cephï¼Œéƒ½éœ€è¦ä»”ç»†è¯„ä¼°å…¶ä¸ç‰¹å®šåº”ç”¨å’Œç¯å¢ƒçš„å…¼å®¹æ€§ã€æ€§èƒ½éœ€æ±‚ã€ç®¡ç†å¤æ‚æ€§å’Œå¯æ‰©å±•æ€§ï¼Œä»¥ç¡®ä¿é€‰æ‹©çš„è§£å†³æ–¹æ¡ˆèƒ½å¤Ÿæ»¡è¶³å®é™…éœ€æ±‚å¹¶æä¾›å¯é çš„å­˜å‚¨æœåŠ¡</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_b2fb09978ee530f5ab2104827399da13.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_b2fb09978ee530f5ab2104827399da13.png"></p><p>docker-composeéƒ¨ç½²ï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨æœ€æ–°é•œåƒï¼‰</p><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">minio/minio</span><br><span class="line">minio/minio:RELEASE.2021-06-17T00-10-46Z   <span class="comment"># æ­¤é•œåƒæµ‹è¯•ä¸å¯ç”¨</span></span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:minio-latest</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:minio-RELEASE.2022-08-02T23-59-16Z</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">minio:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:minio-latest</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">&quot;minio&quot;</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9000</span><span class="string">:9000</span> <span class="comment"># api ç«¯å£</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9001</span><span class="string">:9001</span> <span class="comment"># æ§åˆ¶å°ç«¯å£</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MINIO_ACCESS_KEY:</span> <span class="string">admin</span>    <span class="comment">#ç®¡ç†åå°ç”¨æˆ·å</span></span><br><span class="line">      <span class="attr">MINIO_SECRET_KEY:</span> <span class="string">admin123</span> <span class="comment">#ç®¡ç†åå°å¯†ç ï¼Œæœ€å°8ä¸ªå­—ç¬¦</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./minio/data:/data</span>               <span class="comment">#æ˜ å°„å½“å‰ç›®å½•ä¸‹çš„dataç›®å½•è‡³å®¹å™¨å†…/dataç›®å½•</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./minio/config:/root/.minio/</span>     <span class="comment">#æ˜ å°„é…ç½®ç›®å½•</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">server</span> <span class="string">--console-address</span> <span class="string">&#x27;:9001&#x27;</span> <span class="string">/data</span>  <span class="comment">#æŒ‡å®šå®¹å™¨ä¸­çš„ç›®å½• /data</span></span><br></pre></td></tr></table></figure><h4 id="æ§åˆ¶å°åˆ›å»ºå¯†é’¥å-s3è¿æ¥å·¥å…·è¿œç¨‹è¿æ¥æµ‹è¯•"><a href="#æ§åˆ¶å°åˆ›å»ºå¯†é’¥å-s3è¿æ¥å·¥å…·è¿œç¨‹è¿æ¥æµ‹è¯•" class="headerlink" title="æ§åˆ¶å°åˆ›å»ºå¯†é’¥å s3è¿æ¥å·¥å…·è¿œç¨‹è¿æ¥æµ‹è¯•"></a>æ§åˆ¶å°åˆ›å»ºå¯†é’¥å s3è¿æ¥å·¥å…·è¿œç¨‹è¿æ¥æµ‹è¯•</h4><ul><li>apiåœ°å€ç«¯å£ï¼š9000ï¼ˆä¸“é—¨ç”¨äºä¾‹å¦‚s3å·¥å…·ä»£ç ç­‰è¿æ¥ï¼‰</li><li>æ§åˆ¶å°ç«¯å£ï¼š9001 ï¼ˆä¸è¦æ··æ·† ï¼‰</li><li>åˆ›å»ºak/skå¡«å…¥ ç™»å½•å³å¯</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_c10039e5dafefbca1a39bd41f3a4446f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_c10039e5dafefbca1a39bd41f3a4446f.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_4e2f319e335ef3c6984eb2e115d2955b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_4e2f319e335ef3c6984eb2e115d2955b.png"></p><p>å¤‡æ³¨ï¼šå•æœºç‰ˆæ²¡æœ‰æ•°æ®å†—ä½™ æ•°æ®åªå­˜æ”¾äºæŒ‚è½½çš„å”¯ä¸€å·./minio/dataä¸­  æ–‡ç« é¦–é¡µæ•™ç¨‹ é‡Œé¢å‡ä¸ºè‡³å°‘ä¸¤ç£ç›˜å†—ä½™</p><h3 id="ä¸‰-é›†ç¾¤éƒ¨ç½²å¹¶ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡"><a href="#ä¸‰-é›†ç¾¤éƒ¨ç½²å¹¶ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡" class="headerlink" title="ä¸‰. é›†ç¾¤éƒ¨ç½²å¹¶ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡"></a>ä¸‰. é›†ç¾¤éƒ¨ç½²å¹¶ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡</h3><h3 id="1-ç®€ä»‹"><a href="#1-ç®€ä»‹" class="headerlink" title="1. ç®€ä»‹"></a>1. ç®€ä»‹</h3><p>åˆ†å¸ƒå¼ Minio å¯ä»¥è®©ä½ å°†å¤šå—ç¡¬ç›˜æˆ–è€…å¤šå°æœåŠ¡å™¨ç»„æˆä¸€ä¸ªå¯¹è±¡å­˜å‚¨æœåŠ¡ã€‚ç”±äºç¡¬ç›˜åˆ†å¸ƒåœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œåˆ†å¸ƒå¼ Minio é¿å…äº†å•ç‚¹æ•…éšœã€‚MinioMinioåˆ†å¸ƒå¼æ¨¡å¼å¯ä»¥å¸®åŠ©ä½ æ­å»ºä¸€ä¸ªé«˜å¯ç”¨çš„å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™äº›å­˜å‚¨è®¾å¤‡ï¼Œè€Œä¸ç”¨è€ƒè™‘å…¶çœŸå®ç‰©ç†ä½ç½®ã€‚</p><h3 id="2-Minioåˆ†å¸ƒå¼éƒ¨ç½²çš„ä¼˜åŠ¿"><a href="#2-Minioåˆ†å¸ƒå¼éƒ¨ç½²çš„ä¼˜åŠ¿" class="headerlink" title="#2. Minioåˆ†å¸ƒå¼éƒ¨ç½²çš„ä¼˜åŠ¿"></a><a href="https://www.elibaron.com/arch/minio/minio-cluster-deploy.html#_2-minio%E5%88%86%E5%B8%83%E5%BC%8F%E9%83%A8%E7%BD%B2%E7%9A%84%E4%BC%98%E5%8A%BF">#</a>2. Minioåˆ†å¸ƒå¼éƒ¨ç½²çš„ä¼˜åŠ¿</h3><h3 id="2-1-æ•°æ®ä¿æŠ¤"><a href="#2-1-æ•°æ®ä¿æŠ¤" class="headerlink" title="#2.1 æ•°æ®ä¿æŠ¤"></a><a href="https://www.elibaron.com/arch/minio/minio-cluster-deploy.html#_2-1-%E6%95%B0%E6%8D%AE%E4%BF%9D%E6%8A%A4">#</a>2.1 æ•°æ®ä¿æŠ¤</h3><ul><li>åˆ†å¸ƒå¼ Minio é‡‡ç”¨çº åˆ ç æ¥é˜²èŒƒå¤šä¸ªèŠ‚ç‚¹å®•æœºå’Œä½è¡°å‡ã€‚</li><li>åˆ†å¸ƒå¼ Minio è‡³å°‘éœ€è¦ 4 ä¸ªèŠ‚ç‚¹ï¼ˆ4å°æœåŠ¡å™¨ï¼‰ï¼Œä½¿ç”¨åˆ†å¸ƒå¼ Minio å°± è‡ªåŠ¨å¼•å…¥äº†çº åˆ ç åŠŸèƒ½ã€‚</li><li>çº åˆ ç æ˜¯ä¸€ç§æ¢å¤ä¸¢å¤±å’ŒæŸåæ•°æ®çš„æ•°å­¦ç®—æ³•ï¼Œ Minio é‡‡ç”¨ Reed-Solomon code å°†å¯¹è±¡æ‹†åˆ†æˆ N/2 æ•°æ®å’Œ N/2 å¥‡å¶æ ¡éªŒå—ã€‚ è¿™å°±æ„å‘³ç€å¦‚æœæ˜¯ 12 å—ç›˜ï¼Œä¸€ä¸ªå¯¹è±¡ä¼šè¢«åˆ†æˆ 6 ä¸ªæ•°æ®å—ã€6 ä¸ªå¥‡å¶æ ¡éªŒå—ï¼Œä½ å¯ä»¥ä¸¢å¤±ä»»æ„ 6 å—ç›˜ï¼ˆä¸ç®¡å…¶æ˜¯å­˜æ”¾çš„æ•°æ®å—è¿˜æ˜¯å¥‡å¶æ ¡éªŒå—ï¼‰ï¼Œä½ ä»å¯ä»¥ä»å‰©ä¸‹çš„ç›˜ä¸­çš„æ•°æ®è¿›è¡Œæ¢å¤ã€‚</li><li>çº åˆ ç çš„å·¥ä½œåŸç†å’Œ RAID æˆ–è€…å¤åˆ¶ä¸åŒï¼Œåƒ RAID6 å¯ä»¥åœ¨æŸå¤±ä¸¤å—ç›˜çš„æƒ…å†µä¸‹ä¸ä¸¢æ•°æ®ï¼Œè€Œ Minio çº åˆ ç å¯ä»¥åœ¨ä¸¢å¤±ä¸€åŠçš„ç›˜çš„æƒ…å†µä¸‹ï¼Œä»å¯ä»¥ä¿è¯æ•°æ®å®‰å…¨ã€‚ è€Œä¸” Minio çº åˆ ç æ˜¯ä½œç”¨åœ¨å¯¹è±¡çº§åˆ«ï¼Œå¯ä»¥ä¸€æ¬¡æ¢å¤ä¸€ä¸ªå¯¹è±¡ï¼Œè€ŒRAID æ˜¯ä½œç”¨åœ¨å·çº§åˆ«ï¼Œæ•°æ®æ¢å¤æ—¶é—´å¾ˆé•¿ã€‚ Minio å¯¹æ¯ä¸ªå¯¹è±¡å•ç‹¬ç¼–ç ï¼Œå­˜å‚¨æœåŠ¡ä¸€ç»éƒ¨ç½²ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯ä¸éœ€è¦æ›´æ¢ç¡¬ç›˜æˆ–è€…ä¿®å¤ã€‚Minio çº åˆ ç çš„è®¾è®¡ç›®æ ‡æ˜¯ä¸ºäº†æ€§èƒ½å’Œå°½å¯èƒ½çš„ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿã€‚</li><li>ä½è¡°å‡åˆè¢«ç§°ä¸ºæ•°æ®è…åŒ– Data Rotã€æ— å£°æ•°æ®æŸå Silent Data Corruption ï¼Œæ˜¯ç›®å‰ç¡¬ç›˜æ•°æ®çš„ä¸€ç§ä¸¥é‡æ•°æ®ä¸¢å¤±é—®é¢˜ã€‚ç¡¬ç›˜ä¸Šçš„æ•°æ®å¯èƒ½ä¼šç¥ä¸çŸ¥é¬¼ä¸è§‰å°±æŸåäº†ï¼Œä¹Ÿæ²¡æœ‰ä»€ä¹ˆé”™è¯¯æ—¥å¿—ã€‚æ­£æ‰€è°“æ˜æªæ˜“èº²ï¼Œæš—ç®­éš¾é˜²ï¼Œè¿™ç§èƒŒåœ°é‡ŒçŠ¯çš„é”™æ¯”ç¡¬ç›˜ç›´æ¥æ•…éšœè¿˜å±é™©ã€‚ æ‰€ä»¥ Minio çº åˆ ç é‡‡ç”¨äº†é«˜é€Ÿ HighwayHash åŸºäºå“ˆå¸Œçš„æ ¡éªŒå’Œæ¥é˜²èŒƒä½è¡°å‡ã€‚</li></ul><h3 id="2-2-é«˜å¯ç”¨"><a href="#2-2-é«˜å¯ç”¨" class="headerlink" title="#2.2 é«˜å¯ç”¨"></a><a href="https://www.elibaron.com/arch/minio/minio-cluster-deploy.html#_2-2-%E9%AB%98%E5%8F%AF%E7%94%A8">#</a>2.2 é«˜å¯ç”¨</h3><ul><li>å•æœº Minio æœåŠ¡å­˜åœ¨å•ç‚¹æ•…éšœï¼Œç›¸åï¼Œå¦‚æœæ˜¯ä¸€ä¸ª N èŠ‚ç‚¹çš„åˆ†å¸ƒå¼ Minio ,åªè¦æœ‰ N/2 èŠ‚ç‚¹åœ¨çº¿ï¼Œä½ çš„æ•°æ®å°±æ˜¯å®‰å…¨çš„ã€‚ä¸è¿‡ä½ éœ€è¦è‡³å°‘æœ‰ N/2+1 ä¸ªèŠ‚ç‚¹æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚</li><li>ä¾‹å¦‚ï¼Œä¸€ä¸ª 8 èŠ‚ç‚¹çš„ Minio é›†ç¾¤ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸€å—ç›˜ï¼Œå°±ç®— 4 ä¸ªèŠ‚ç‚¹å®•æœºï¼Œè¿™ä¸ªé›†ç¾¤ä»ç„¶æ˜¯å¯è¯»çš„ï¼Œä¸è¿‡ä½ éœ€è¦ 5 ä¸ªèŠ‚ç‚¹æ‰èƒ½å†™æ•°æ®ã€‚</li></ul><h3 id="2-3-é™åˆ¶"><a href="#2-3-é™åˆ¶" class="headerlink" title="#2.3 é™åˆ¶"></a><a href="https://www.elibaron.com/arch/minio/minio-cluster-deploy.html#_2-3-%E9%99%90%E5%88%B6">#</a>2.3 é™åˆ¶</h3><ul><li>åˆ†å¸ƒå¼ Minio å•ç§Ÿæˆ·å­˜åœ¨æœ€å°‘ 4 ä¸ªç›˜æœ€å¤š 16 ä¸ªç›˜çš„é™åˆ¶ï¼ˆå—é™äºçº åˆ ç ï¼‰ã€‚è¿™ç§é™åˆ¶ç¡®ä¿äº† Minio çš„ç®€æ´ï¼ŒåŒæ—¶ä»æ‹¥æœ‰ä¼¸ç¼©æ€§ã€‚å¦‚æœä½ éœ€è¦æ­å»ºä¸€ä¸ªå¤šç§Ÿæˆ·ç¯å¢ƒï¼Œä½ å¯ä»¥è½»æ¾çš„ä½¿ç”¨ç¼–æ’å·¥å…·ï¼ˆKubernetesï¼‰æ¥ç®¡ç†å¤šä¸ªMinioå®ä¾‹ã€‚</li><li>æ³¨æ„ï¼Œåªè¦éµå®ˆåˆ†å¸ƒå¼ Minio çš„é™åˆ¶ï¼Œä½ å¯ä»¥ç»„åˆä¸åŒçš„èŠ‚ç‚¹å’Œæ¯ä¸ªèŠ‚ç‚¹å‡ å—ç›˜ã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ 2 ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ 4 å—ç›˜ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ 4 ä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¸¤å—ç›˜ï¼Œè¯¸å¦‚æ­¤ç±»ã€‚</li></ul><h3 id="2-4-ä¸€è‡´æ€§"><a href="#2-4-ä¸€è‡´æ€§" class="headerlink" title="#2.4 ä¸€è‡´æ€§"></a><a href="https://www.elibaron.com/arch/minio/minio-cluster-deploy.html#_2-4-%E4%B8%80%E8%87%B4%E6%80%A7">#</a>2.4 ä¸€è‡´æ€§</h3><ul><li>Minio åœ¨åˆ†å¸ƒå¼å’Œå•æœºæ¨¡å¼ä¸‹ï¼Œæ‰€æœ‰è¯»å†™æ“ä½œéƒ½ä¸¥æ ¼éµå®ˆ read-after-write ä¸€è‡´æ€§æ¨¡å‹ã€‚</li></ul><h3 id="2-5-æ­å»º"><a href="#2-5-æ­å»º" class="headerlink" title="2.5 æ­å»º"></a>2.5 æ­å»º</h3><p>æœ¬æ¬¡æ­å»ºä½¿ç”¨ä¸¤èŠ‚ç‚¹ï¼ˆæ•…éšœä¸€ä¸ªèŠ‚ç‚¹ä¾¿åªèƒ½è¯»ä¸èƒ½å†™ï¼‰</p><table><thead><tr><th>èŠ‚ç‚¹</th><th>IP</th><th>å¤‡æ³¨</th></tr></thead><tbody><tr><td>minio1</td><td>10.0.0.10</td><td></td></tr><tr><td>minio2</td><td>10.0.0.11</td><td></td></tr></tbody></table><p>å†™å…¥hosté…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;</span></span><br><span class="line"><span class="string">10.0.0.10 minio1</span></span><br><span class="line"><span class="string">10.0.0.11 minio2</span></span><br><span class="line"><span class="string">&quot;</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure><p>docker-composeé…ç½®æ–‡ä»¶</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.7&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">minio:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:minio-latest</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">minio1</span>            <span class="comment"># æ¯ä¸ªèŠ‚ç‚¹ä¿®æ”¹æˆä¸åŒçš„åå­—</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">minio1</span>      <span class="comment"># æ¯ä¸ªèŠ‚ç‚¹ä¿®æ”¹æˆä¸åŒçš„åå­—</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_USER:</span> <span class="string">admin</span></span><br><span class="line">      <span class="attr">MINIO_ROOT_PASSWORD:</span> <span class="number">123456789</span></span><br><span class="line">      <span class="attr">MINIO_PROMETHEUS_AUTH_TYPE:</span> <span class="string">public</span></span><br><span class="line">      <span class="attr">MINIO_PROMETHEUS_JOB_ID:</span> <span class="string">minio-job</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">    <span class="attr">extra_hosts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;minio1:10.0.0.10&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;minio2:10.0.0.11&quot;</span></span><br><span class="line">      <span class="comment"># - &quot;minio03:192.168.1.103&quot;</span></span><br><span class="line">      <span class="comment"># - &quot;minio04:192.168.1.104&quot;</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9000</span><span class="string">:9000</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">9001</span><span class="string">:9001</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/data:/data</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">server</span> <span class="string">--address</span> <span class="string">&quot;:9000&quot;</span> <span class="string">--console-address</span> <span class="string">&quot;:9001&quot;</span> <span class="string">http://minio&#123;1...2&#125;/data</span></span><br><span class="line">    <span class="attr">network_mode:</span> <span class="string">&quot;host&quot;</span></span><br></pre></td></tr></table></figure><p>å¤‡æ³¨ï¼š åªéœ€è¦å°†hostnameä¸container_nameç¼–å†™ä¸ºå¯¹åº”èŠ‚ç‚¹ åœ¨ä¸åŒèŠ‚ç‚¹åˆ†åˆ«å¯åŠ¨docker-compose.ymlæ–‡ä»¶å³å¯</p><p>äºŒä¸ªèŠ‚ç‚¹ä¾æ¬¡å¯åŠ¨âœŒ ï¼š docker-compose up -d</p><p>æˆåŠŸåæ—¥å¿—æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="string">MinIO</span> <span class="string">Object</span> <span class="string">Storage</span> <span class="string">Server</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Copyright:</span> <span class="number">2015</span><span class="number">-2024</span> <span class="string">MinIO,</span> <span class="string">Inc.</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">License:</span> <span class="string">GNU</span> <span class="string">AGPLv3</span> <span class="string">&lt;https://www.gnu.org/licenses/agpl-3.0.html&gt;</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Version:</span> <span class="string">RELEASE.2024-04-18T19-09-19Z</span> <span class="string">(go1.21.9</span> <span class="string">linux/amd64)</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">API:</span> <span class="string">http://10.0.0.11:9001</span>  <span class="string">http://172.17.0.1:9001</span>  <span class="string">http://172.19.0.1:9001</span>  <span class="string">http://172.20.0.1:9001</span>  <span class="string">http://127.0.0.1:9001</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">WebUI:</span> <span class="string">http://10.0.0.11:50001</span> <span class="string">http://172.17.0.1:50001</span> <span class="string">http://172.19.0.1:50001</span> <span class="string">http://172.20.0.1:50001</span> <span class="string">http://127.0.0.1:50001</span>  </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Docs:</span> <span class="string">https://min.io/docs/minio/linux/index.html</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Status:</span>         <span class="number">2</span> <span class="string">Online,</span> <span class="number">0</span> <span class="string">Offline.</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="string">http://minio1:9001/minio/storage/data/v57%!(EXTRA</span> <span class="string">time.Duration=14.132179253s)</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Exiting on signal:</span> <span class="string">TERMINATED</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span>  <span class="string">You</span> <span class="string">are</span> <span class="string">running</span> <span class="string">an</span> <span class="string">older</span> <span class="string">version</span> <span class="string">of</span> <span class="string">MinIO</span> <span class="string">released</span> <span class="number">4</span> <span class="string">months</span> <span class="string">before</span> <span class="string">the</span> <span class="string">latest</span> <span class="string">release</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span>  <span class="attr">Update:</span> <span class="string">Run</span> <span class="string">`mc</span> <span class="string">admin</span> <span class="string">update</span> <span class="string">ALIAS`</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="string">Waiting</span> <span class="string">for</span> <span class="string">all</span> <span class="string">MinIO</span> <span class="string">sub-systems</span> <span class="string">to</span> <span class="string">be</span> <span class="string">initialize...</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Automatically configured API requests per node based on available memory on the system:</span> <span class="number">98</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="string">All</span> <span class="string">MinIO</span> <span class="string">sub-systems</span> <span class="string">initialized</span> <span class="string">successfully</span> <span class="string">in</span> <span class="number">5.</span><span class="string">916121ms</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="string">MinIO</span> <span class="string">Object</span> <span class="string">Storage</span> <span class="string">Server</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Copyright:</span> <span class="number">2015</span><span class="number">-2024</span> <span class="string">MinIO,</span> <span class="string">Inc.</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">License:</span> <span class="string">GNU</span> <span class="string">AGPLv3</span> <span class="string">&lt;https://www.gnu.org/licenses/agpl-3.0.html&gt;</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Version:</span> <span class="string">RELEASE.2024-04-18T19-09-19Z</span> <span class="string">(go1.21.9</span> <span class="string">linux/amd64)</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">API:</span> <span class="string">http://10.0.0.11:9001</span>  <span class="string">http://172.17.0.1:9001</span>  <span class="string">http://172.19.0.1:9001</span>  <span class="string">http://172.20.0.1:9001</span>  <span class="string">http://127.0.0.1:9001</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">WebUI:</span> <span class="string">http://10.0.0.11:50001</span> <span class="string">http://172.17.0.1:50001</span> <span class="string">http://172.19.0.1:50001</span> <span class="string">http://172.20.0.1:50001</span> <span class="string">http://127.0.0.1:50001</span>  </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> </span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Docs:</span> <span class="string">https://min.io/docs/minio/linux/index.html</span></span><br><span class="line"><span class="string">minio2</span>  <span class="string">|</span> <span class="attr">Status:</span>         <span class="number">2</span> <span class="string">Online,</span> <span class="number">0</span> <span class="string">Offline.</span> </span><br></pre></td></tr></table></figure><h3 id="æ•ˆæœï¼š"><a href="#æ•ˆæœï¼š" class="headerlink" title="æ•ˆæœï¼š"></a>æ•ˆæœï¼š</h3><p>1.ä½¿ç”¨å‘½ä»¤è¡ŒéªŒè¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@k8s1:/opt/minio<span class="comment"># docker exec -it minio2 bash</span></span><br><span class="line">bash-5.1<span class="comment"># mc config host add minio http://localhost:9000</span></span><br><span class="line">Enter Access Key: admin</span><br><span class="line">Enter Secret Key: </span><br><span class="line">Added `minio` successfully.</span><br><span class="line">bash-5.1<span class="comment"># mc admin info minio</span></span><br><span class="line">â—  minio1:9000</span><br><span class="line">   Uptime: 42 minutes </span><br><span class="line">   Version: 2024-04-18T19:09:19Z</span><br><span class="line">   Network: 2/2 OK </span><br><span class="line">   Drives: 1/1 OK </span><br><span class="line">   Pool: 1</span><br><span class="line"></span><br><span class="line">â—  minio2:9000</span><br><span class="line">   Uptime: 44 minutes </span><br><span class="line">   Version: 2024-04-18T19:09:19Z</span><br><span class="line">   Network: 2/2 OK </span><br><span class="line">   Drives: 1/1 OK </span><br><span class="line">   Pool: 1</span><br><span class="line"></span><br><span class="line">Pools:</span><br><span class="line">   1st, Erasure sets: 1, Drives per erasure <span class="built_in">set</span>: 2</span><br><span class="line"></span><br><span class="line">165 MiB Used, 1 Bucket, 6 Objects</span><br><span class="line">2 drives online, 0 drives offline</span><br></pre></td></tr></table></figure><p>2.è®¿é—®åœ°å€ï¼š</p><p><a href="http://10.0.0.10:9001/">http://10.0.0.10:9001</a></p><p><a href="http://10.0.0.11:9001/">http://10.0.0.11:9001</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_80d4c317adbea538710314fdc23fc7ec.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_80d4c317adbea538710314fdc23fc7ec.png"></p><h3 id="2-6-ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡"><a href="#2-6-ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡" class="headerlink" title="2.6 ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡"></a>2.6 ä½¿ç”¨nginxè¿›è¡Œè´Ÿè½½å‡è¡¡</h3><p>æ‹“è¡¥å›¾ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_79c6f4e1380df8c0bc41081b9f00d653.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_79c6f4e1380df8c0bc41081b9f00d653.png"></p><p>åœ¨èŠ‚ç‚¹1éƒ¨ç½²nginxå‚è€ƒ <a href="https://wn.zznnwn.cloudns.biz/2023/05/15/%E7%BC%96%E8%AF%91%E9%83%A8%E7%BD%B2nginx/?highlight=nginx">ä½¿ç”¨è„šæœ¬ç¼–è¯‘éƒ¨ç½²nginxéƒ¨ç½²</a></p><p>éƒ¨ç½²å®Œæˆåé‡åˆ°nginxè½¬å‘è®¿é—®ç«¯å£è®¿é—®å­˜å‚¨æ¡¶ä¸€ç›´loadingâ€¦é—®é¢˜ å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_25231683/article/details/128734555">ã€è§£å†³ã€‘ä½¿ç”¨Nginxç»™minioåšä»£ç†è½¬å‘ è¿›å…¥ç®¡ç†ç•Œé¢æŸ¥çœ‹æ¡¶ä¸€ç›´æ˜¾ç¤ºloadingé—®é¢˜_nginx ä»£ç† minio websocket</a> å¤§è‡´ä¿¡æ¯å¦‚ä¸‹</p><h4 id="é—®é¢˜åŸå› "><a href="#é—®é¢˜åŸå› " class="headerlink" title="é—®é¢˜åŸå› "></a>é—®é¢˜åŸå› </h4><p>æŒ‰F12æŸ¥çœ‹äº†ä¸€ä¸‹ï¼ŒæŸ¥çœ‹æ¡¶å‘èµ·çš„æ˜¯ <strong>websocket</strong> è¯·æ±‚ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_43ea567b825c0da4a7070cfbafc90dce.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_43ea567b825c0da4a7070cfbafc90dce.png"></p><h4 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a>è§£å†³æ–¹æ¡ˆï¼š</h4><p>åœ¨ <a href="https://so.csdn.net/so/search?q=nginx%E9%85%8D%E7%BD%AE&spm=1001.2101.3001.7020">nginxé…ç½®</a> ä¸ŠåŠ ä¸Šwebsocketæ”¯æŒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># æ·»åŠ äº†websocketæ”¯æŒ</span><br><span class="line">proxy_http_version      1.1;</span><br><span class="line">proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">proxy_set_header Connection &quot;upgrade&quot;;</span><br><span class="line">proxy_next_upstream     http_500 http_502 http_503 http_504 error timeout invalid_header;</span><br><span class="line">proxy_set_header        Host  $http_host;</span><br><span class="line">proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></pre></td></tr></table></figure><p>Nginxè´Ÿè½½minioé›†ç¾¤å®Œæ•´é…ç½®æ–‡ä»¶å¦‚ä¸‹ï¼ˆåœ¨é…ç½®æ–‡ä»¶æœ€åå¤§æ‹¬å·å†…<code>&#125;</code>åŠ å…¥è´Ÿè½½å‡è¡¡é…ç½®å³å¯ï¼‰ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#user  nobody;</span></span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line"><span class="comment">#error_log  logs/error.log;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  notice;</span></span><br><span class="line"><span class="comment">#error_log  logs/error.log  info;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pid        logs/nginx.pid;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">http &#123;</span><br><span class="line">    include       mime.types;</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#log_format  main  &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27;</span></span><br><span class="line">    <span class="comment">#                  &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27;</span></span><br><span class="line">    <span class="comment">#                  &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#access_log  logs/access.log  main;</span></span><br><span class="line"></span><br><span class="line">    sendfile        on;</span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#keepalive_timeout  0;</span></span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#gzip  on;</span></span><br><span class="line"></span><br><span class="line">    server &#123;</span><br><span class="line">        listen       80;</span><br><span class="line">        server_name  localhost;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#charset koi8-r;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">#access_log  logs/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">        location / &#123;</span><br><span class="line">            root   html;</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">        <span class="comment">#    root           html;</span></span><br><span class="line">        <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">        <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">        <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">        <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">        <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">        <span class="comment">#    deny  all;</span></span><br><span class="line">        <span class="comment">#&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># another virtual host using mix of IP-, name-, and port-based configuration</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#server &#123;</span></span><br><span class="line">    <span class="comment">#    listen       8000;</span></span><br><span class="line">    <span class="comment">#    listen       somename:8080;</span></span><br><span class="line">    <span class="comment">#    server_name  somename  alias  another.alias;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    location / &#123;</span></span><br><span class="line">    <span class="comment">#        root   html;</span></span><br><span class="line">    <span class="comment">#        index  index.html index.htm;</span></span><br><span class="line">    <span class="comment">#    &#125;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># HTTPS server</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#server &#123;</span></span><br><span class="line">    <span class="comment">#    listen       443 ssl;</span></span><br><span class="line">    <span class="comment">#    server_name  localhost;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    ssl_certificate      cert.pem;</span></span><br><span class="line">    <span class="comment">#    ssl_certificate_key  cert.key;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    ssl_session_cache    shared:SSL:1m;</span></span><br><span class="line">    <span class="comment">#    ssl_session_timeout  5m;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    ssl_ciphers  HIGH:!aNULL:!MD5;</span></span><br><span class="line">    <span class="comment">#    ssl_prefer_server_ciphers  on;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#    location / &#123;</span></span><br><span class="line">    <span class="comment">#        root   html;</span></span><br><span class="line">    <span class="comment">#        index  index.html index.htm;</span></span><br><span class="line">    <span class="comment">#    &#125;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">upstream minio_cluster &#123;</span><br><span class="line">    server 10.0.0.10:9001;</span><br><span class="line">    server 10.0.0.11:9001;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">upstream minio_api &#123;</span><br><span class="line">    server 10.0.0.10:9000;</span><br><span class="line">    server 10.0.0.11:9000;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 8088;</span><br><span class="line">    server_name 10.0.0.10 localhost;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># To allow special characters in headers</span></span><br><span class="line">    ignore_invalid_headers off;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Allow any size file to be uploaded.</span></span><br><span class="line">    <span class="comment"># Set to a value such as 1000m; to restrict file size to a specific value</span></span><br><span class="line">    client_max_body_size 100m;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># To disable buffering</span></span><br><span class="line">    proxy_buffering off;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line"></span><br><span class="line">        proxy_connect_timeout 300;</span><br><span class="line">  </span><br><span class="line">        proxy_set_header Connection <span class="string">&quot;&quot;</span>;</span><br><span class="line">        chunked_transfer_encoding off;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ·»åŠ äº†websocketæ”¯æŒ</span></span><br><span class="line">        <span class="comment"># Default is HTTP/1, keepalive is only enabled in HTTP/1.1</span></span><br><span class="line">        proxy_http_version      1.1;</span><br><span class="line">        proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">        proxy_set_header Connection <span class="string">&quot;upgrade&quot;</span>;</span><br><span class="line">        proxy_next_upstream     http_500 http_502 http_503 http_504 error <span class="built_in">timeout</span> invalid_header;</span><br><span class="line">        proxy_set_header        Host  <span class="variable">$http_host</span>;</span><br><span class="line">        proxy_set_header        X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">        proxy_pass http://minio_cluster;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen 8089;</span><br><span class="line">    server_name 10.0.0.10 localhost;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># To allow special characters in headers</span></span><br><span class="line">    ignore_invalid_headers off;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Allow any size file to be uploaded.</span></span><br><span class="line">    <span class="comment"># Set to a value such as 1000m; to restrict file size to a specific value</span></span><br><span class="line">    client_max_body_size 100m;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># To disable buffering</span></span><br><span class="line">    proxy_buffering off;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line"></span><br><span class="line">        proxy_connect_timeout 300;</span><br><span class="line"></span><br><span class="line">        proxy_set_header Connection <span class="string">&quot;&quot;</span>;</span><br><span class="line">        chunked_transfer_encoding off;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ·»åŠ äº†websocketæ”¯æŒ</span></span><br><span class="line">        <span class="comment"># Default is HTTP/1, keepalive is only enabled in HTTP/1.1</span></span><br><span class="line">        proxy_http_version      1.1;</span><br><span class="line">        proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">        proxy_set_header Connection <span class="string">&quot;upgrade&quot;</span>;</span><br><span class="line">        proxy_next_upstream     http_500 http_502 http_503 http_504 error <span class="built_in">timeout</span> invalid_header;</span><br><span class="line">        proxy_set_header        Host  <span class="variable">$http_host</span>;</span><br><span class="line">        proxy_set_header        X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line"></span><br><span class="line">        proxy_pass http://minio_api;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>systemctl restart nginx ç”Ÿæ•ˆğŸŒ¹</p><p>æ­¤æ—¶åœ¨æµè§ˆå™¨è®¿é—®éƒ¨ç½²nginxçš„æœåŠ¡å™¨ï¼š<a href="http://10.0.0.10:8088/">http://10.0.0.10:8088</a> è¾“å…¥yamlæ–‡ä»¶ä¸­å®šä¹‰çš„è´¦æˆ·å¯†ç  å³å¯å®ç°è´Ÿè½½å‡è¡¡åˆ°ä¸åŒçš„æœåŠ¡å™¨</p><h4 id="æœ€åï¼š-éªŒè¯è´Ÿè½½å‡è¡¡æ˜¯å¦æˆåŠŸï¼ˆæˆåŠŸï¼‰"><a href="#æœ€åï¼š-éªŒè¯è´Ÿè½½å‡è¡¡æ˜¯å¦æˆåŠŸï¼ˆæˆåŠŸï¼‰" class="headerlink" title="æœ€åï¼š éªŒè¯è´Ÿè½½å‡è¡¡æ˜¯å¦æˆåŠŸï¼ˆæˆåŠŸï¼‰"></a>æœ€åï¼š éªŒè¯è´Ÿè½½å‡è¡¡æ˜¯å¦æˆåŠŸï¼ˆæˆåŠŸï¼‰</h4><p>æ­¥éª¤ï¼š</p><ul><li>æ‰‹åŠ¨æŒ‚è½½éƒ¨ç½²nginxçš„èŠ‚ç‚¹10.0.0.10ä¸Šé¢çš„minioæœåŠ¡ æµ‹è¯•æµè§ˆå™¨è®¿é—® <a href="http://10.0.0.10:8088çœ‹æœåŠ¡æ˜¯å¦æ­£å¸¸">http://10.0.0.10:8088çœ‹æœåŠ¡æ˜¯å¦æ­£å¸¸</a><br>åœæ­¢minio1æ—¶æµè§ˆå™¨æœåŠ¡æ­£å¸¸</li><li>å°†ä¸¤èŠ‚ç‚¹minioåœæ­¢è®¿é—® <a href="http://10.0.0.10:8088çœ‹æœåŠ¡æ˜¯å¦æ­£å¸¸">http://10.0.0.10:8088çœ‹æœåŠ¡æ˜¯å¦æ­£å¸¸</a><br>åœæ­¢minio1å’Œminio2åæµè§ˆå™¨è®¿é—®æŠ¥é”™  (ä¸‹æ–¹æµè§ˆå™¨æˆªå›¾ä¸ºä¹‹å‰ç«¯å£ä¸º8089æ—¶æ‰€æˆª æš‚ä¿ç•™ æ­¤æ•™ç¨‹nginxè½¬å‘minio webç«¯å£ä¸º8088)</li><li><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_69862aee2ae62f564cfab982170e672e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_69862aee2ae62f564cfab982170e672e.png"></li></ul><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/liugp/p/17504098.html">ã€å¤§æ•°æ®ã€‘é€šè¿‡ docker-compose å¿«é€Ÿéƒ¨ç½² MinIO ä¿å§†çº§æ•™ç¨‹ - å¤§æ•°æ®è€å¸æœº - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://cloud.tencent.com/developer/article/2133450">åŸºäº docker-compose éƒ¨ç½² Minio åˆ†å¸ƒå¼é›†ç¾¤-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘ (tencent.com)</a></p><p><a href="https://www.cnblogs.com/liugp/p/17504098.html">ã€å¤§æ•°æ®ã€‘é€šè¿‡ docker-compose å¿«é€Ÿéƒ¨ç½² MinIO ä¿å§†çº§æ•™ç¨‹ - å¤§æ•°æ®è€å¸æœº - åšå®¢å›­ (cnblogs.com)</a></p><p><a href="https://blog.csdn.net/majixiang1996/article/details/105600369">ä½¿ç”¨nginxå¯¹é›†ç¾¤æ¨¡å¼çš„minioåšè´Ÿè½½å‡è¡¡_minioè´Ÿè½½å‡è¡¡</a></p><p><a href="https://blog.csdn.net/qq_25231683/article/details/128734555">ã€è§£å†³ã€‘ä½¿ç”¨Nginxç»™minioåšä»£ç†è½¬å‘ è¿›å…¥ç®¡ç†ç•Œé¢æŸ¥çœ‹æ¡¶ä¸€ç›´æ˜¾ç¤ºloadingé—®é¢˜_nginx ä»£ç† minio websocket</a></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
          <category> nginx </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
            <tag> nginx </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PVEè™šæ‹Ÿæœºç›´é€šè‹±ä¼Ÿè¾¾GPUæ˜¾å¡å®Œå…¨æŒ‡å—</title>
      <link href="/2024/07/02/PVE%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B4%E9%80%9A%E8%8B%B1%E4%BC%9F%E8%BE%BEGPU%E6%98%BE%E5%8D%A1%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/"/>
      <url>/2024/07/02/PVE%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B4%E9%80%9A%E8%8B%B1%E4%BC%9F%E8%BE%BEGPU%E6%98%BE%E5%8D%A1%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="PVEè™šæ‹Ÿæœºç›´é€šè‹±ä¼Ÿè¾¾GPUæ˜¾å¡å®Œå…¨æŒ‡å—"><a href="#PVEè™šæ‹Ÿæœºç›´é€šè‹±ä¼Ÿè¾¾GPUæ˜¾å¡å®Œå…¨æŒ‡å—" class="headerlink" title="PVEè™šæ‹Ÿæœºç›´é€šè‹±ä¼Ÿè¾¾GPUæ˜¾å¡å®Œå…¨æŒ‡å—"></a>PVEè™šæ‹Ÿæœºç›´é€šè‹±ä¼Ÿè¾¾GPUæ˜¾å¡å®Œå…¨æŒ‡å—</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><a href="http://sunlight.zznnwn.cloudns.biz/2024/07/01/Pve%E9%83%A8%E7%BD%B2%E6%8A%A5%E9%94%99Cannot%20run%20in%20framebuffer%20mode.%20Please%20specify%20busIos%20%E8%A7%A3%E5%86%B3/">éƒ¨ç½²pveæŠ¥é”™è§£å†³</a></p><p>æœ¬æ•™ç¨‹åœ¨pveå®¿ä¸»æœºæ‰§è¡Œ</p><h2 id="ä¸€-å‰ææ¡ä»¶"><a href="#ä¸€-å‰ææ¡ä»¶" class="headerlink" title="ä¸€. å‰ææ¡ä»¶"></a>ä¸€. å‰ææ¡ä»¶</h2><p>Bioså¼€å¯VT-d HD-t</p><p><strong>1ã€ç¡®è®¤CPUæ˜¯å¦æ”¯æŒ<code>VT-D</code></strong></p><ul><li><strong>Interå®˜ç½‘æŸ¥è¯¢ï¼š</strong> <a href="https://www.intel.cn/">https://www.intel.cn</a></li><li><strong>AMDå®˜æ–¹ç½‘ç«™ï¼š</strong> <a href="https://www.amd.com/zh-hans">https://www.amd.com/zh-hans</a></li><li><ul><li><strong>ä¾‹ï¼š</strong> <em><a href="https://ark.intel.com/content/www/cn/zh/ark/products/97122/intel-core-i77700t-processor-8m-cache-up-to-3-80-ghz.html#tab-blade-1-0-7">i7-7700 æŸ¥è¯¢ç»“æœ</a></em></li></ul></li></ul><p><strong>2ã€ç¡®ä¿å¯åŠ¨æ–¹å¼ä¸º<code>gurb</code>ï¼Œé<code>systemd-boot</code></strong><br>å¦‚æœå¯åŠ¨æ–¹å¼ä¸º<code>systemd-boot</code>ï¼Œåœ¨<strong>0x02</strong>æ­¥éª¤ä¸­éœ€è¦å‚è€ƒ <a href="https://pve.proxmox.com/pve-docs/pve-admin-guide.html#sysboot_edit_kernel_cmdline">[3] Proxmox VE Administration Guide</a> å¼€å¯iommuåŠŸèƒ½ æˆ–å‚è€ƒæœ¬æ–‡æœ«å°¾ä¸‹æ–¹<a href="https://blog.dako.dev/proxmox-7-4-gpu-passthrough--e6-98-be-e5-8d-a1-e7-9b-b4-e9-80-9a/">ç¬¬äºŒé“¾æ¥</a> å³ <code>proxmox-boot-tool refresh</code></p><h2 id="äºŒ-å¼€å¯IOMMUåŠŸèƒ½"><a href="#äºŒ-å¼€å¯IOMMUåŠŸèƒ½" class="headerlink" title="äºŒ. å¼€å¯IOMMUåŠŸèƒ½"></a>äºŒ. å¼€å¯IOMMUåŠŸèƒ½</h2><p>ç¼–è¾‘æ–‡ä»¶/etc/default/grubï¼Œä¿®æ”¹<code>GRUB_CMDLINE_LINUX_DEFAULT</code>å­—æ®µå€¼</p><p>å¦‚æœä¸ºIntelçš„CPU</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=<span class="string">&quot;quiet intel_iommu=on&quot;</span></span><br></pre></td></tr></table></figure><p>å¦‚æœä¸ºAMDçš„CPU</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GRUB_CMDLINE_LINUX_DEFAULT=<span class="string">&quot;quiet amd_iommu=on&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_3170d8505684902d0828f4adc8f464bb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_3170d8505684902d0828f4adc8f464bb.png"></p><h2 id="ä¸‰-æ·»åŠ VT-DåŠŸèƒ½çš„å†…æ ¸æ¨¡å—"><a href="#ä¸‰-æ·»åŠ VT-DåŠŸèƒ½çš„å†…æ ¸æ¨¡å—" class="headerlink" title="ä¸‰. æ·»åŠ VT-DåŠŸèƒ½çš„å†…æ ¸æ¨¡å—"></a>ä¸‰. æ·»åŠ <code>VT-D</code>åŠŸèƒ½çš„å†…æ ¸æ¨¡å—</h2><p>æ‰“å¼€æ–‡ä»¶<code>/etc/modules</code>ï¼Œæ–°å¢ä»¥ä¸‹4è¡Œå†…å®¹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vfio</span><br><span class="line">vfio_iommu_type1</span><br><span class="line">vfio_pci</span><br><span class="line">vfio_virqfd</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_922e9e8bc8602c37be9a95b4b4cfbac7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_922e9e8bc8602c37be9a95b4b4cfbac7.png"></p><h2 id="å››-å±è”½å®¿ä¸»æœºæ˜¾å¡é©±åŠ¨"><a href="#å››-å±è”½å®¿ä¸»æœºæ˜¾å¡é©±åŠ¨" class="headerlink" title="å››. å±è”½å®¿ä¸»æœºæ˜¾å¡é©±åŠ¨"></a>å››. å±è”½å®¿ä¸»æœºæ˜¾å¡é©±åŠ¨</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å±è”½é•­é¾™æ˜¾å¡é©±åŠ¨</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;blacklist radeon&quot;</span> &gt;&gt; /etc/modprobe.d/pve-blacklist.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å±è”½è‹±ä¼Ÿè¾¾æ˜¾å¡çš„å¼€æºnouveaué©±åŠ¨</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;blacklist nouveau&quot;</span> &gt;&gt; /etc/modprobe.d/pve-blacklist.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å±è”½è‹±ä¼Ÿè¾¾æ˜¾å¡é©±åŠ¨</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;blacklist nvidia&quot;</span> &gt;&gt; /etc/modprobe.d/pve-blacklist.conf</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_eaab6c3d231a8dae5e02514fd79eea14.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_eaab6c3d231a8dae5e02514fd79eea14.png"></p><h2 id="äº”-å…¶å®ƒå‚æ•°"><a href="#äº”-å…¶å®ƒå‚æ•°" class="headerlink" title="äº”. å…¶å®ƒå‚æ•°"></a>äº”. å…¶å®ƒå‚æ•°</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…è®¸ä¸å®‰å…¨çš„ä¸­æ–­</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;options vfio_iommu_type1 allow_unsafe_interrupts=1&quot;</span> &gt; /etc/modprobe.d/iommu_unsafe_interrupts.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¿½ç•¥å¼‚å¸¸ï¼Œé˜²æ­¢è™šæ‹Ÿæœºå¼‚å¸¸å¯¼è‡´å®¿ä¸»æœºå´©æºƒ</span></span><br><span class="line"><span class="comment">#   ignore_msrs             :   å¿½ç•¥å¼‚å¸¸</span></span><br><span class="line"><span class="comment">#   report_ignored_msrs     :   æ˜¯å¦æŠ¥å‘Šå¼‚å¸¸</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;options kvm ignore_msrs=1 report_ignored_msrs=0&quot;</span> &gt; /etc/modprobe.d/kvm.conf</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_8e63746854064a712ab3519c84a8afae.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_8e63746854064a712ab3519c84a8afae.png"></p><h2 id="å…­-é…ç½®VFIO"><a href="#å…­-é…ç½®VFIO" class="headerlink" title="å…­. é…ç½®VFIO"></a>å…­. é…ç½®VFIO</h2><p><em>psï¼šæ‰§è¡Œæ­¤æ“ä½œåå¯èƒ½æ— æ³•è¾“å‡ºåˆ°å¤–æ¥æ˜¾ç¤ºå™¨ï¼Œè‹¥å‡ºç°æ­¤æƒ…å†µï¼Œè¯·æ’¤å›è¯¥æ­¥éª¤</em></p><p><strong>1ã€æŸ¥çœ‹æ˜¾å¡ID</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~<span class="comment"># lspci -nn | grep VGA</span></span><br><span class="line">01:00.0 VGA compatible controller [0300]: NVIDIA Corporation Device [10de:2685] (rev a1)</span><br></pre></td></tr></table></figure><p>Nå¡ç¼–å·ä¸º01:00ï¼Œæœç´¢å¯¹åº”çš„è®¾å¤‡IDå’ŒéŸ³é¢‘è®¾å¤‡ID</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~<span class="comment"># lspci -n -s 01:00</span></span><br><span class="line">01:00.0 0300: 10de:2685 (rev a1)</span><br><span class="line">01:00.1 0403: 10de:22ba (rev a1)</span><br></pre></td></tr></table></figure><p><strong>æˆ–è€…ç›´æ¥ä»¥<code>NVIDIA</code>ä¸ºå…³é”®è¯æœç´¢ç›¸å…³çš„è®¾å¤‡ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯éŸ³é¢‘</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~<span class="comment"># lspci -nn | grep NVIDIA</span></span><br><span class="line">01:00.0 VGA compatible controller [0300]: NVIDIA Corporation Device [10de:2685] (rev a1)</span><br><span class="line">01:00.1 Audio device [0403]: NVIDIA Corporation AD102 High Definition Audio Controller [10de:22ba] (rev a1)</span><br></pre></td></tr></table></figure><p><strong>å¾—åˆ°æ˜¾å¡çš„è®¾å¤‡IDå’Œæ˜¾å¡å†…ç½®éŸ³é¢‘è®¾å¤‡IDä¸ºï¼š</strong></p><ul><li><code>æ˜¾å¡ID</code>ï¼š <em>10de:2685</em></li><li><code>éŸ³é¢‘ID</code>ï¼š <em>10de:22ba</em></li></ul><p><strong>2ã€å°†è®¾å¤‡IDæ·»åŠ åˆ°<code>vfio.conf</code></strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;options vfio-pci ids=10de:2685,10de:22ba disable_vga=1&quot;</span> &gt; /etc/modprobe.d/vfio.conf</span><br><span class="line"><span class="comment"># å¦‚æœæ— æ³•è¾“å‡ºåˆ°å¤–æ¥æ˜¾ç¤ºå™¨ï¼Œå–æ¶ˆdisable_vga=1å‚æ•°è¯•è¯•</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;options vfio-pci ids=10de:2685,10de:22ba&quot;</span> &gt; /etc/modprobe.d/vfio.conf</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_d97846f7bd4dc84cc26efca3ae8b9d1a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_d97846f7bd4dc84cc26efca3ae8b9d1a.png"></p><h2 id="ä¸ƒ-åº”ç”¨æ›´æ”¹"><a href="#ä¸ƒ-åº”ç”¨æ›´æ”¹" class="headerlink" title="ä¸ƒ. åº”ç”¨æ›´æ”¹"></a>ä¸ƒ. åº”ç”¨æ›´æ”¹</h2><ul><li><p><strong>1ã€åˆ·æ–°æ›´æ”¹</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">update-grub</span><br><span class="line">update-initramfs -u -k all</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_088397be69bb3731e3594f4f49245bd7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_088397be69bb3731e3594f4f49245bd7.png"></p></li><li><p><strong>2ã€é‡å¯PVE</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure></li><li><p><strong>3ã€æ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@pve:~<span class="comment"># lspci -nnk</span></span><br><span class="line">01:00.0 VGA compatible controller [0300]: NVIDIA Corporation Device [10de:2685] (rev a1)</span><br><span class="line">        Subsystem: Shenzhen Colorful Yugong Technology and Development Co. Device [7377:1400]</span><br><span class="line">        Kernel driver <span class="keyword">in</span> use: vfio-pci</span><br><span class="line">        Kernel modules: nvidiafb, nouveau</span><br><span class="line">01:00.1 Audio device [0403]: NVIDIA Corporation AD102 High Definition Audio Controller [10de:22ba] (rev a1)</span><br><span class="line">        Subsystem: Shenzhen Colorful Yugong Technology and Development Co. AD102 High Definition Audio Controller [7377:1400]</span><br><span class="line">        Kernel driver <span class="keyword">in</span> use: vfio-pci</span><br><span class="line">        Kernel modules: snd_hda_intel</span><br></pre></td></tr></table></figure></li></ul><p>å¦‚æœçœ‹åˆ°<code>Kernel driver in use: vfio-pci</code>ï¼Œè¡¨ç¤ºåº”ç”¨æˆåŠŸ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_2867de7d79e4bcc5b8934e10af67e9bb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_2867de7d79e4bcc5b8934e10af67e9bb.png"></p><p>æ·»åŠ æ˜¾å¡åˆ°è™šæ‹Ÿæœºä¸­<br>å®Œæˆä¸Šè¿°æ­¥éª¤é…ç½®åï¼Œåœ¨PVE-webå›¾å½¢åŒ–ç«¯æ·»åŠ PCI-Eè®¾å¤‡åˆ°è™šæ‹Ÿæœºä¸­å³å¯</p><p>åˆ›å»ºè™šæ‹Ÿæœºæ—¶éœ€è¦é€‰æ‹©ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_4d88c6e4aaae1b291fb1a0054b3e7011.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_4d88c6e4aaae1b291fb1a0054b3e7011.png"></p><p>ps:<br>1ã€æˆ‘åŒæ—¶æ·»åŠ æ˜¾å¡å’ŒéŸ³é¢‘ä¹‹åï¼Œå¼€æœºé‡æŠ¥é”™ï¼šTASK ERROR: start failed: QEMU exited with code 1ï¼Œå¦‚æœé‡åˆ°åŒæ ·çš„æŠ¥é”™ï¼Œå°è¯•æŠŠéŸ³é¢‘è®¾å¤‡ä»ç¡¬ä»¶ä¸­ç§»é™¤</p><h2 id="å…«-æ‰©å±•"><a href="#å…«-æ‰©å±•" class="headerlink" title="å…«. æ‰©å±•"></a>å…«. æ‰©å±•</h2><p>è™šæ‹Ÿæœºç›´é€šæ˜¾å¡åå®‰è£…æ˜¾å¡é©±åŠ¨ ä½¿ç”¨ä¸‹æ–¹è„šæœ¬å®‰è£…</p><p><a href="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E8%84%9A%E6%9C%AC/ubuntu%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2NVIDIA%E9%A9%B1%E5%8A%A8/nvidia-gpu.sh">å®‰è£…è„šæœ¬ &gt; nvidia-gpu.sh</a></p><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://blog.csdn.net/byb123/article/details/124549876">https://blog.csdn.net/byb123/article/details/124549876</a>   ï¼ˆä¸»è¦å‚è€ƒï¼‰</p><p><a href="https://blog.dako.dev/proxmox-7-4-gpu-passthrough--e6-98-be-e5-8d-a1-e7-9b-b4-e9-80-9a/">https://blog.dako.dev/proxmox-7-4-gpu-passthrough--e6-98-be-e5-8d-a1-e7-9b-b4-e9-80-9a/</a></p>]]></content>
      
      
      <categories>
          
          <category> pve </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Pveéƒ¨ç½²æŠ¥é”™Cannot run in framebuffer mode. Please specify busIos è§£å†³</title>
      <link href="/2024/07/01/Pve%E9%83%A8%E7%BD%B2%E6%8A%A5%E9%94%99Cannot%20run%20in%20framebuffer%20mode.%20Please%20specify%20busIos%20%E8%A7%A3%E5%86%B3/"/>
      <url>/2024/07/01/Pve%E9%83%A8%E7%BD%B2%E6%8A%A5%E9%94%99Cannot%20run%20in%20framebuffer%20mode.%20Please%20specify%20busIos%20%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Pveéƒ¨ç½²æŠ¥é”™Cannot-run-in-framebuffer-mode-Please-specify-busIos-è§£å†³"><a href="#Pveéƒ¨ç½²æŠ¥é”™Cannot-run-in-framebuffer-mode-Please-specify-busIos-è§£å†³" class="headerlink" title="Pveéƒ¨ç½²æŠ¥é”™Cannot run in framebuffer mode. Please specify busIos è§£å†³"></a>Pveéƒ¨ç½²æŠ¥é”™Cannot run in framebuffer mode. Please specify busIos è§£å†³</h1><h2 id="ä¸€-ç°è±¡ï¼ˆé”™è¯¯åˆ†æï¼‰"><a href="#ä¸€-ç°è±¡ï¼ˆé”™è¯¯åˆ†æï¼‰" class="headerlink" title="ä¸€. ç°è±¡ï¼ˆé”™è¯¯åˆ†æï¼‰"></a>ä¸€. ç°è±¡ï¼ˆé”™è¯¯åˆ†æï¼‰</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_451e4c0eb25db4eb9d6f522ab61064ec.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_451e4c0eb25db4eb9d6f522ab61064ec.png"></p><p>æŒ‰ç…§æç¤ºè¾“å…¥CTRL+ALT+F2æŸ¥çœ‹å…·ä½“æŠ¥é”™</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_ac23c01d0edb14915d6e0b7fe8506aa2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_ac23c01d0edb14915d6e0b7fe8506aa2.png"></p><p>é‡å¯ç³»ç»Ÿå†æ¬¡å‡ºç°ç¬¬ä¸€å¼ å›¾ä¸­æŠ¥é”™æ—¶ç­‰å¾…ä¸€æ®µæ—¶é—´ä¼šè‡ªåŠ¨è¿›å…¥å‘½ä»¤è¡Œ è¿›å…¥å‘½ä»¤è¡ŒåæŸ¥çœ‹æ—¥å¿—ã€‚</p><p>é—®é¢˜ï¼šæ ¹æ®æœ¬æ–‡ç¬¬ä¸€å¼ å›¾æ—¥å¿—æ–‡ä»¶æŸ¥çœ‹é”™è¯¯æ—¥å¿— <strong>cat /var/log/Xorg.0.log |grep EE</strong> è§‚å¯Ÿåˆ°è®¾å¤‡ <strong>/dev/dri/card0</strong> æ‰¾ä¸åˆ°ä¸”nvæ¨¡å—åŠ è½½å¤±è´¥</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_d95c83302584efe1926a318c57dfa7f0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_d95c83302584efe1926a318c57dfa7f0.png"></p><h2 id="äºŒ-è§£å†³"><a href="#äºŒ-è§£å†³" class="headerlink" title="äºŒ. è§£å†³"></a>äºŒ. è§£å†³</h2><p>ç¼–è¾‘æ­¤æ–‡ä»¶ï¼šnano /usr/share/X11/xorg.conf.d/10-quirks.conf</p><p>æ–‡ä»¶é¡¶éƒ¨ç¬¬äºŒè¡Œæ–°å¢å¦‚ä¸‹å†…å®¹(CTRL + X è¾“å…¥ Yä¿å­˜)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Section <span class="string">&quot;Device&quot;</span></span><br><span class="line">  Identifier <span class="string">&quot;Card0&quot;</span></span><br><span class="line">  Driver <span class="string">&quot;fbdev&quot;</span></span><br><span class="line">EndSection</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_1b0a47b246d7f93aae3411d8be3a4f44.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_1b0a47b246d7f93aae3411d8be3a4f44.png"></p><p>æ¥ä¸‹æ¥ï¼Œé»˜è®¤ä¼šè¿”å›åˆ°å‘½ä»¤ç•Œé¢ï¼Œ è¾“å…¥ã€xinit â€“ -dpi 96 &gt;/dev/tty2 2&gt;&amp;1ã€‘å›è½¦,å³å¯è¿›å…¥å®‰è£…ç•Œé¢</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_86db8ea42fe6d4ed0bc30c18947d3ea3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_86db8ea42fe6d4ed0bc30c18947d3ea3.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/linzhiji/article/details/117754330">https://blog.csdn.net/linzhiji/article/details/117754330</a><br><a href="https://blog.csdn.net/u012514495/article/details/129987207">https://blog.csdn.net/u012514495/article/details/129987207</a> ï¼ˆä¸»è¦å‚è€ƒï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> pve </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>proxmoxæ•™ç¨‹</title>
      <link href="/2024/06/22/proxmox%E6%95%99%E7%A8%8B/"/>
      <url>/2024/06/22/proxmox%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="proxmoxæ•™ç¨‹"><a href="#proxmoxæ•™ç¨‹" class="headerlink" title="proxmoxæ•™ç¨‹"></a>proxmoxæ•™ç¨‹</h1><p>isoé•œåƒä¸‹è½½åœ°å€ï¼š</p><p><a href="https://pve.proxmox.com/wiki/Downloads">https://pve.proxmox.com/wiki/Downloads</a></p><p><a href="https://enterprise.proxmox.com/iso/">https://enterprise.proxmox.com/iso/</a></p><p>æœ¬æ•™æä½¿ç”¨é•œåƒï¼šproxmox-ve_8.1-2.iso</p><h2 id="ä¸€-proxmoxçš„å®‰è£…åŠé…ç½®"><a href="#ä¸€-proxmoxçš„å®‰è£…åŠé…ç½®" class="headerlink" title="ä¸€. proxmoxçš„å®‰è£…åŠé…ç½®"></a>ä¸€. proxmoxçš„å®‰è£…åŠé…ç½®</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2f095d78b69671be4283fa3df4138a68.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2f095d78b69671be4283fa3df4138a68.png"></p><p>1.ç¡¬ä»¶ç›´é€š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_926f9dc034ba9e58f4d865c5d48e2dd6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_926f9dc034ba9e58f4d865c5d48e2dd6.png"></p><p>2.æœ€ç»ˆæ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_e695c7631fab1a105f95568f6c4d2628.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_e695c7631fab1a105f95568f6c4d2628.png"></p><h2 id="äºŒ-pveèŠ‚ç‚¹åŠ å…¥é›†ç¾¤"><a href="#äºŒ-pveèŠ‚ç‚¹åŠ å…¥é›†ç¾¤" class="headerlink" title="äºŒ. pveèŠ‚ç‚¹åŠ å…¥é›†ç¾¤"></a>äºŒ. pveèŠ‚ç‚¹åŠ å…¥é›†ç¾¤</h2><p>éœ€è¦ä¸¤ä¸ªpveèŠ‚ç‚¹ä¸»æœºåç§°ä¸ä¸€æ · å¦‚æœä¸»æœºåç§°ä¸€æ ·ä¼šå†²çªå¯¼è‡´æ— æ³•åŠ å…¥èŠ‚ç‚¹ å‡ºç°ç±»ä¼¼å¦‚ä¸‹æŠ¥é”™</p><p>ä¿®æ”¹pveèŠ‚ç‚¹åç§°å‚è€ƒï¼š<a href="https://www.qkeke.com/archives/2136.html">https://www.qkeke.com/archives/2136.html</a></p><h3 id="1-ä¿®æ”¹èŠ‚ç‚¹åç§°"><a href="#1-ä¿®æ”¹èŠ‚ç‚¹åç§°" class="headerlink" title="1.ä¿®æ”¹èŠ‚ç‚¹åç§°"></a>1.ä¿®æ”¹èŠ‚ç‚¹åç§°</h3><p>åœ¨åˆ›å»ºé›†ç¾¤åï¼Œå…¶ä»–åŒåèŠ‚ç‚¹å§‹ç»ˆæ— æ³•åŠ å…¥é›†ç¾¤ï¼Œäºæ˜¯éœ€è¦ä¿®æ”¹èŠ‚ç‚¹ä¸»æœºåï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€ä¿®æ”¹å¦‚ä¸‹2ä¸ªæ–‡ä»¶ä¸­çš„ä¸»æœºåä¸ºæ–°çš„ä¸»æœºå</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/hostname</span><br><span class="line">vi /etc/hosts</span><br></pre></td></tr></table></figure><p>2ã€å¦‚æœæˆ‘ä»¬å·²ç»åˆ›å»ºè™šæ‹Ÿæœºï¼Œéœ€è¦ä¿®æ”¹nodesä¸­èŠ‚ç‚¹é…ç½®æ–‡ä»¶åï¼ˆæ–°æœåŠ¡å™¨å¿½ç•¥æ­¤æ­¥ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/pve/nodes/OldHostName     /etc/pve/nodes/NewHostName</span><br></pre></td></tr></table></figure><p>3ã€é‡å¯æœåŠ¡å™¨</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_688957670a3886de26c6dc137530bf6e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_688957670a3886de26c6dc137530bf6e.png"></p><h2 id="ä¸‰-pveé‡ç½®å¯†ç ï¼ˆæ­¤ç§æ–¹å¼åªé€‚ç”¨äºpve8-1ç‰ˆæœ¬ï¼‰"><a href="#ä¸‰-pveé‡ç½®å¯†ç ï¼ˆæ­¤ç§æ–¹å¼åªé€‚ç”¨äºpve8-1ç‰ˆæœ¬ï¼‰" class="headerlink" title="ä¸‰. pveé‡ç½®å¯†ç ï¼ˆæ­¤ç§æ–¹å¼åªé€‚ç”¨äºpve8.1ç‰ˆæœ¬ï¼‰"></a>ä¸‰. pveé‡ç½®å¯†ç ï¼ˆæ­¤ç§æ–¹å¼åªé€‚ç”¨äºpve8.1ç‰ˆæœ¬ï¼‰</h2><p><a href="https://cn.linux-console.net/?p=1538">å¦‚ä½•åœ¨ Debian 10 ä¸­é‡ç½®å¿˜è®°çš„ Root å¯†ç  (linux-console.net)</a> ï¼ˆæœ¬æ–‡å‚è€ƒï¼‰<br><a href="https://pve.proxmox.com/wiki/Root_Password_Reset#Method_1">https://pve.proxmox.com/wiki/Root_Password_Reset#Method_1</a></p><p>åˆå§‹å›¾</p><p>åˆ°æ­¤é¡µé¢æ—¶æŒ‰eè¿›å…¥grubæ¨¡å¼ï¼ˆæœ‰æ—¶å€™ä¸ä¼šå‡ºç°è“è‰²ç•Œé¢å‡ºç°çš„ä¸ºé»‘è‰²ç•Œé¢æ­¤æ—¶æ“ä½œæ–¹æ³•ä¸€æ ·ï¼‰</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_b2331cc4270249582ef47242c1d19634.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_b2331cc4270249582ef47242c1d19634.png"></p><p>é»‘è‰²ç•Œé¢</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/1724752992583_b8d762af8866765ff94ac33c6d2f3ebe.jpg" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/1724752992583_b8d762af8866765ff94ac33c6d2f3ebe.jpg"></p><p>æ‰¾åˆ°æ­¤è¡Œæ·»åŠ æ­¤é…ç½® <code>linux /boot/vmlinuz.... ro quiet</code></p><p>å°†å…‰æ ‡ç§»åŠ¨åˆ°è¯¥è¡Œçš„æœ«å°¾ï¼Œåœ¨<code>ro quiet</code>åé¢æ–°å¢å‚æ•°<code>init=/bin/bash</code>ã€‚</p><p>è¾“å…¥ ctrl + x ä»¥ä½¿å…¶èƒ½å¤Ÿä»¥è£…æœ‰åªè¯»(ro)è®¿é—®æƒé™çš„æ ¹æ–‡ä»¶ç³»ç»Ÿåœ¨å•ç”¨æˆ·æ¨¡å¼ä¸‹å¯åŠ¨ã€‚</p><p>ä¸ºæ‚¨é‡ç½®å¯†ç ï¼Œæ‚¨éœ€è¦æ›´æ”¹ä»è®¿é—®æƒé™åªè¯»åˆ°è¯»å†™ã€‚å› æ­¤ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥é‡æ–°å®‰è£…å…·æœ‰rwå±æ€§çš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_08023f86d72ff75b8173d99bbedeeee4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_08023f86d72ff75b8173d99bbedeeee4.png"></p><p>æŒ‚è½½Debianæ–‡ä»¶ç³»ç»Ÿ åŠä¿®æ”¹å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -n -o remountï¼Œrw /</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_824a050b4122d5f75b3d666d2e695bfc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_824a050b4122d5f75b3d666d2e695bfc.png"></p><p>åœ¨Debianä¸­é‡è®¾æ ¹å¯†ç </p><p>æä¾›æ–°å¯†ç å¹¶é‡æ–°è¾“å…¥ä»¥ç¡®è®¤ã€‚å¦‚æœä¸€åˆ‡é¡ºåˆ©å¹¶ä¸”å¯†ç åŒ¹é…ï¼Œæ‚¨å°†åœ¨æ§åˆ¶å°æœ«å°¾æ”¶åˆ°â€œ å¯†ç æ›´æ–°æˆåŠŸ â€é€šçŸ¥</p><p>æœ€åæŒ‰Ctrl + Alt + Delé€€å‡ºå¹¶é‡æ–°å¯åŠ¨ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åˆšåˆšå®šä¹‰çš„æ–°åˆ›å»ºçš„å¯†ç ä»¥rootç”¨æˆ·èº«ä»½ç™»å½•ã€‚</p><p>è¿™å°±æ˜¯æ‚¨åœ¨Debian 10ä¸Šé‡ç½®å¿˜è®°çš„rootå¯†ç çš„æ–¹å¼ã€‚</p><p>å¤‡æ³¨ï¼šæœ¬è´¨ä¸Špveçš„åº•å±‚æ˜¯ä¸€ä¸ªdebianç³»ç»Ÿå’Œdebianç³»ç»Ÿé‡ç½®å¯†ç æ˜¯ä¸€æ ·çš„ å¯å‚è€ƒä¸‹æ–¹debian11é‡ç½®å¯†ç </p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_0866a0b337fb3c215760314e7ccd157d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_0866a0b337fb3c215760314e7ccd157d.png"></p><h2 id="å››-æ·»åŠ æ•°æ®ç›˜ä¸ºå­˜å‚¨"><a href="#å››-æ·»åŠ æ•°æ®ç›˜ä¸ºå­˜å‚¨" class="headerlink" title="å››. æ·»åŠ æ•°æ®ç›˜ä¸ºå­˜å‚¨"></a>å››. æ·»åŠ æ•°æ®ç›˜ä¸ºå­˜å‚¨</h2><p>pveä¸åƒexsié‚£æ ·è‡ªåŠ¨æ·»åŠ å¥½çš„ éœ€è¦è‡ªå·±æ‰‹åŠ¨æŒ‚è½½åˆ°æŸä¸ªç›®å½• æ·»åŠ æ­¤ç›®å½•ä¸ºæœ¬åœ°å­˜å‚¨</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_d23a49628b2f8a794ab27c1d9e2d209a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_d23a49628b2f8a794ab27c1d9e2d209a.png"></p><h2 id="äº”-ä¿®æ”¹pve-ipåœ°å€"><a href="#äº”-ä¿®æ”¹pve-ipåœ°å€" class="headerlink" title="äº”. ä¿®æ”¹pve  ipåœ°å€"></a>äº”. ä¿®æ”¹pve  ipåœ°å€</h2><p><a href="https://blog.csdn.net/mwl093/article/details/129483191">https://blog.csdn.net/mwl093/article/details/129483191</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹pve ipåœ°å€ </span></span><br><span class="line">vi /etc/network/interfaces</span><br><span class="line"><span class="comment"># ä¿®æ”¹pve webé¡µé¢ç™»å½•åœ°å€</span></span><br><span class="line">vi /etc/issue</span><br><span class="line"><span class="comment"># ä¿®æ”¹æœ¬åœ°dns</span></span><br><span class="line">vi /etc/hosts</span><br><span class="line"><span class="comment"># ä¿®æ”¹ä¸»æœºåç§°å¯¹åº”IP</span></span><br><span class="line">vi /etc/hostname</span><br></pre></td></tr></table></figure><p>é‡å¯ç½‘ç»œï¼šsystemctl restart networking</p><h2 id="åˆ›å»ºwindowsè™šæ‹Ÿæœº"><a href="#åˆ›å»ºwindowsè™šæ‹Ÿæœº" class="headerlink" title="åˆ›å»ºwindowsè™šæ‹Ÿæœº"></a>åˆ›å»ºwindowsè™šæ‹Ÿæœº</h2><p>â€¢ å¸¸è§„ï¼šæŒ‰éœ€å¡«å†™<br>â€¢ æ“ä½œç³»ç»Ÿ<br>â—‹ ISO é•œåƒï¼šé€‰æ‹©ä¸Šä¼ çš„é•œåƒ<br>â—‹ ç±»åˆ«ï¼šMicrosoft Windows<br>â—‹ ç‰ˆæœ¬ï¼š11/2022<br>â€¢ ç³»ç»Ÿï¼š<br>â—‹ TPM å­˜å‚¨ï¼šlocal-lvm<br>â—‹ EFI å­˜å‚¨ï¼šlocal-lvm<br>â—‹ å…¶ä»–é»˜è®¤å³å¯<br>â€¢ ç£ç›˜<br>â—‹ æ€»çº¿ / è®¾å¤‡ï¼šSCSI<br>â—‹ ç£ç›˜å¤§å°ï¼šæŒ‰éœ€é€‰æ‹©<br>â—‹ å…¶ä»–é»˜è®¤å³å¯<br>â€¢ CPUï¼šæŒ‰éœ€é€‰æ‹©<br>â€¢ å†…å­˜ï¼šæŒ‰éœ€é€‰æ‹©<br>ç½‘ç»œï¼šé»˜è®¤å³å¯</p><p><strong>è·³è¿‡è”ç½‘</strong>ï¼šåœ¨è”ç½‘ç•Œé¢ï¼Œä½¿ç”¨Shift+F10æˆ–Fn+Shift+F10ç»„åˆé”®è°ƒå‡ºå‘½ä»¤æç¤ºç¬¦çª—å£ï¼Œåœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥</p><p><code>oobe\BypassNRO.cmd</code></p><p>å‘½ä»¤åå›è½¦ï¼Œç„¶åé‡å¯ç”µè„‘ï¼Œåœ¨é‡å¯åçš„Win11è”ç½‘ç•Œé¢ä¸­ï¼Œé€‰æ‹©â€œæˆ‘æ²¡æœ‰Internetè¿æ¥â€çš„é€‰é¡¹ï¼Œå¹¶ç»§ç»­æ‰§è¡Œå—é™è®¾ç½®ï¼Œè¿™æ ·å¯ä»¥è·³è¿‡è”ç½‘æ¿€æ´»ç¯èŠ‚ã€‚</p><p><strong>å¤‡æ³¨</strong>ï¼šå®‰è£…æ—¶ å¯åŠ¨è¿‡ç¨‹ä¸­ä¼šæŠ¥é”™ æ­¤æ—¶ æŒ‰Escè¿›å…¥biosè®¾ç½®å¯åŠ¨é¡¹å³å¯æ­£å¸¸è¿›å…¥windowså®‰è£…ç•Œé¢</p><p><strong>å®‰è£…å®Œæˆä¹‹ååœ¨æŒ‚è½½çš„virtio-win-0.1.229.isoé•œåƒä¸­ æ‰¾åˆ°virtio-win-agent-x64.exeå®‰è£…å³å¯å‡ºç°ç½‘ç»œç­‰</strong></p><p><strong>è™šæ‹Ÿæœºæ·»åŠ å£°éŸ³</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_249974881cbc1cff13510daa7b6605a3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_249974881cbc1cff13510daa7b6605a3.png"></p><h2 id="å…­-GPUç›´é€š"><a href="#å…­-GPUç›´é€š" class="headerlink" title="å…­. GPUç›´é€š"></a>å…­. GPUç›´é€š</h2><p><a href="http://sunlight.zznnwn.cloudns.biz/2024/07/02/PVE%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9B%B4%E9%80%9A%E8%8B%B1%E4%BC%9F%E8%BE%BEGPU%E6%98%BE%E5%8D%A1%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97/?highlight=gpu">http://sunlight.zznnwn.cloudns.biz/2024/07/02/PVEè™šæ‹Ÿæœºç›´é€šè‹±ä¼Ÿè¾¾GPUæ˜¾å¡å®Œå…¨æŒ‡å—/?highlight=gpu</a></p><p>æœ¬æ–‡å‚è€ƒé“¾æ¥ç­‰ï¼š</p><p><a href="https://v2rayssr.com/pve.html">https://v2rayssr.com/pve.html</a><br><a href="https://www.jianshu.com/p/d22a21c5ae81">https://www.jianshu.com/p/d22a21c5ae81</a><br><a href="https://blog.csdn.net/c13257595138/article/details/90385433">https://blog.csdn.net/c13257595138/article/details/90385433</a></p><p>ç®¡ç†å¤šä¸ªé›†ç¾¤<br><a href="https://pve-doc-cn.readthedocs.io/zh-cn/latest/">https://pve-doc-cn.readthedocs.io/zh-cn/latest/</a></p><p>æ˜¾å¡ç›´é€š<br><a href="https://blog.csdn.net/yyhyoung/article/details/130708894">https://blog.csdn.net/yyhyoung/article/details/130708894</a><br><a href="https://blog.rayfalling.com/2023/01/pve-7-3-%E4%BC%98%E5%8C%96%E5%92%8C%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A.html">https://blog.rayfalling.com/2023/01/pve-7-3-ä¼˜åŒ–å’Œæ˜¾å¡ç›´é€š.html</a></p><p>é€šè¿‡å·¥å…·å®ç°æ˜¾å¡ç›´é€š<br><a href="https://github.com/ivanhao/pvetools/wiki/i-%E7%A1%AC%E4%BB%B6%E7%9B%B4%E9%80%9A%E5%8F%8A%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E9%85%8D%E7%BD%AE">https://github.com/ivanhao/pvetools/wiki/i-ç¡¬ä»¶ç›´é€šåŠæ˜¾å¡ç›´é€šé…ç½®</a></p>]]></content>
      
      
      <categories>
          
          <category> pve </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³é—­ubuntu  unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡</title>
      <link href="/2024/06/15/%E5%85%B3%E9%97%ADubuntu%20%20unattended-upgrades%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E6%9C%8D%E5%8A%A1/"/>
      <url>/2024/06/15/%E5%85%B3%E9%97%ADubuntu%20%20unattended-upgrades%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å…³é—­ubuntu-unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡"><a href="#å…³é—­ubuntu-unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡" class="headerlink" title="å…³é—­ubuntu  unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡"></a>å…³é—­ubuntu  unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡</h1><blockquote><p><code>unattended-upgrades</code>æ˜¯ä¸€ä¸ªè‡ªåŠ¨å‡çº§æœåŠ¡ï¼Œç”¨äºè‡ªåŠ¨æ›´æ–°ç³»ç»Ÿä¸­çš„è½¯ä»¶åŒ…å’Œå®‰å…¨è¡¥ä¸ã€‚å½“ç³»ç»Ÿé…ç½®äº†<code>unattended-upgrades</code>æœåŠ¡åï¼Œå®ƒä¼šå®šæœŸæ£€æŸ¥è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼ˆå¦‚APTï¼‰çš„æ›´æ–°æºï¼Œç„¶åè‡ªåŠ¨ä¸‹è½½å’Œå®‰è£…å¯ç”¨çš„è½¯ä»¶åŒ…æ›´æ–°ã€‚</p><p>è¿™ä¸ªæœåŠ¡çš„ä¸»è¦ç›®çš„æ˜¯ç¡®ä¿ç³»ç»Ÿä¸­çš„è½¯ä»¶åŒ…ä¿æŒæœ€æ–°çŠ¶æ€ï¼ŒåŒ…æ‹¬å®‰å…¨æ›´æ–°å’Œ bug ä¿®å¤ã€‚é€šè¿‡è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥å‡å°‘ç®¡ç†å‘˜æ‰‹åŠ¨å¹²é¢„çš„éœ€æ±‚ï¼Œå¹¶æé«˜ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œ<code>unattended-upgrades</code>æœåŠ¡ä¼šåœ¨åå°è¿è¡Œï¼Œå¹¶æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„è§„åˆ™è‡ªåŠ¨æ‰§è¡Œæ›´æ–°æ“ä½œã€‚å®ƒå¯ä»¥å®šæœŸæ£€æŸ¥æ›´æ–°æºï¼Œä¸‹è½½è½¯ä»¶åŒ…æ›´æ–°ï¼Œå¹¶åœ¨ç³»ç»Ÿç©ºé—²æ—¶å®‰è£…è¿™äº›æ›´æ–°ï¼Œä»¥ç¡®ä¿ç³»ç»Ÿä¿æŒæœ€æ–°çŠ¶æ€ã€‚</p><p>å¦‚æœä½ é‡åˆ°äº†æ— æ³•æ‰§è¡Œ<code>apt</code>å‘½ä»¤çš„é—®é¢˜ï¼Œå¯èƒ½æ˜¯ç”±äº<code>unattended-upgrades</code>æœåŠ¡æ­£åœ¨è¿è¡Œå¹¶å ç”¨äº†ç›¸å…³çš„é”å®šæ–‡ä»¶ï¼Œå¯¼è‡´å…¶ä»–<code>apt</code>è¿›ç¨‹æ— æ³•æ“ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é€‰æ‹©ç­‰å¾…è‡ªåŠ¨å‡çº§æœåŠ¡å®Œæˆæˆ–è€…ç»ˆæ­¢ç›¸å…³è¿›ç¨‹ï¼Œç„¶åå†æ‰§è¡Œä½ éœ€è¦çš„æ“ä½œã€‚</p></blockquote><p>è¦æš‚æ—¶å…³é—­<code>unattended-upgrades</code>æœåŠ¡ï¼Œä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><ol><li><p><strong>åœæ­¢<code>unattended-upgrades</code>æœåŠ¡</strong>ï¼š<br>è¿è¡Œä»¥ä¸‹å‘½ä»¤åœæ­¢<code>unattended-upgrades</code>æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop unattended-upgrades</span><br></pre></td></tr></table></figure></li><li><p><strong>ç¦ç”¨<code>unattended-upgrades</code>æœåŠ¡</strong>ï¼ˆå¯é€‰ï¼‰ï¼š<br>å¦‚æœä½ æƒ³åœ¨ç³»ç»Ÿé‡æ–°å¯åŠ¨åä»ç„¶ä¿æŒ<code>unattended-upgrades</code>æœåŠ¡å…³é—­çŠ¶æ€ï¼Œå¯ä»¥ç¦ç”¨è¯¥æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">disable</span> unattended-upgrades</span><br></pre></td></tr></table></figure></li><li><p><strong>ç¡®è®¤æœåŠ¡çŠ¶æ€</strong>ï¼š<br>ç¡®ä¿æœåŠ¡å·²ç»åœæ­¢ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status unattended-upgrades</span><br></pre></td></tr></table></figure></li></ol><p>è¿™æ ·ï¼Œ<code>unattended-upgrades</code>æœåŠ¡å°±ä¼šè¢«æš‚æ—¶å…³é—­ã€‚å¦‚æœä½ æƒ³é‡æ–°å¯ç”¨è¯¥æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start unattended-upgrades</span><br></pre></td></tr></table></figure><p>å…³é—­åä¸‹æ–¹é—®é¢˜è§£å†³</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_aaf97a6eb50633cfdab0e71cfd1c69a0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_aaf97a6eb50633cfdab0e71cfd1c69a0.png"></p><p>è¯·æ³¨æ„ï¼Œå…³é—­è‡ªåŠ¨å‡çº§æœåŠ¡å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸­çš„è½¯ä»¶åŒ…å’Œå®‰å…¨è¡¥ä¸ä¸åŠæ—¶æ›´æ–°ï¼Œè¿™å¯èƒ½ä¼šå½±å“ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚å› æ­¤ï¼Œåœ¨å…³é—­æœåŠ¡ä¹‹å‰ï¼Œè¯·ç¡®ä¿äº†è§£é£é™©å¹¶åœ¨åˆé€‚çš„æ—¶æœºé‡æ–°å¯ç”¨æœåŠ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu22.04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA CUDNN Anaconda Pytorch2 ç­‰</title>
      <link href="/2024/06/13/ubuntu22.04LTS%E5%AE%89%E8%A3%85NVIDIA%E5%AE%98%E6%96%B94090D%E9%A9%B1%E5%8A%A8CUDA%20CUDNN%20Anaconda%20%20Pytorch2%20%E7%AD%89/"/>
      <url>/2024/06/13/ubuntu22.04LTS%E5%AE%89%E8%A3%85NVIDIA%E5%AE%98%E6%96%B94090D%E9%A9%B1%E5%8A%A8CUDA%20CUDNN%20Anaconda%20%20Pytorch2%20%E7%AD%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ubuntu22-04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA-CUDNN-Anaconda-Pytorch2ç­‰"><a href="#ubuntu22-04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA-CUDNN-Anaconda-Pytorch2ç­‰" class="headerlink" title="ubuntu22.04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA CUDNN Anaconda Pytorch2ç­‰"></a>ubuntu22.04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA CUDNN Anaconda Pytorch2ç­‰</h1><p>å‰è¨€ï¼š</p><p>ä¸€é”®éƒ¨ç½²é©±åŠ¨codaè„šæœ¬</p><p><code>curl -fLO https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E8%84%9A%E6%9C%AC/ubuntu%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2NVIDIA%E9%A9%B1%E5%8A%A8/nvidia-gpu.sh </code></p><h3 id="1-å®‰è£…ä¾èµ–"><a href="#1-å®‰è£…ä¾èµ–" class="headerlink" title="1. å®‰è£…ä¾èµ–"></a>1. å®‰è£…ä¾èµ–</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update   <span class="comment">#æ›´æ–°è½¯ä»¶åˆ—è¡¨</span></span><br><span class="line">sudo apt-get install g++</span><br><span class="line">sudo apt-get install gcc</span><br><span class="line">sudo apt-get install make</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential gcc-multilib dkms</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœé‡åˆ°æ— æ³•ä¸‹è½½çš„æƒ…å†µï¼Œå¯èƒ½æ˜¯å› ä¸ºå®‰è£…å®Œç³»ç»Ÿåæºä¸å¯ç”¨ï¼Œå¯ä»¥å…ˆæ›´æ¢å›½å†…é•œåƒæºååœ¨è¿›è¡Œæœ¬æ­¥éª¤ï¼ˆæ¢æºæ–¹æ³•ï¼š<a href="https://zhuanlan.zhihu.com/p/139305626">å†™ç»™å·¥ç¨‹å¸ˆçš„ Ubuntu 20.04 æœ€ä½³é…ç½®æŒ‡å—</a> ç¬¬<strong>2ã€3</strong>æ­¥ï¼‰</p></blockquote><h3 id="2-å¸è½½åŸæœ‰é©±åŠ¨"><a href="#2-å¸è½½åŸæœ‰é©±åŠ¨" class="headerlink" title="2. å¸è½½åŸæœ‰é©±åŠ¨"></a>2. å¸è½½åŸæœ‰é©±åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove --purge nvidia*   <span class="comment"># æˆ–è€…nvidia-*</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-å®˜ç½‘ä¸‹è½½å¯¹åº”é©±åŠ¨"><a href="#3-å®˜ç½‘ä¸‹è½½å¯¹åº”é©±åŠ¨" class="headerlink" title="3. å®˜ç½‘ä¸‹è½½å¯¹åº”é©±åŠ¨"></a>3. å®˜ç½‘ä¸‹è½½å¯¹åº”é©±åŠ¨</h3><blockquote><p>ä¸‹è½½å¥½ä¹‹åï¼Œæ³¨æ„æŠŠnvidiaé©±åŠ¨æ”¾åœ¨è‹±æ–‡åæ–‡ä»¶å¤¹ä¸‹ï¼Œæ¯”å¦‚mkdir driver æ–°å»ºæ–‡ä»¶å¤¹â€œdriverâ€<br>å®˜ç½‘åœ°å€ï¼š<a href="https://www.nvidia.cn/Download/index.aspx?lang=cn">Nvidiaé©±åŠ¨ä¸‹è½½åœ°å€</a><br>æˆ‘è¿™é‡Œæ˜¾å¡æ˜¯4090ï¼Œå®˜ç½‘æ¨èé©±åŠ¨ç‰ˆæœ¬ä¸º535.54.03</p></blockquote><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a82106785b61bc2f12e3efa9b941936c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a82106785b61bc2f12e3efa9b941936c.png"></p><h3 id="4-ç¦ç”¨nouveau"><a href="#4-ç¦ç”¨nouveau" class="headerlink" title="4. ç¦ç”¨nouveau"></a>4. ç¦ç”¨nouveau</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/modprobe.d/blacklist.conf æˆ–è€…(blacklist-nouveau.conf)</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>(å¦‚æœæ²¡æœ‰geditè¾“å…¥ä»¥ä¸ŠæŒ‡ä»¤ä¼šæŠ¥é”™ï¼Œå¯ä»¥ sudo apt-get install gedit å®‰è£… gedit æˆ–ä½¿ç”¨ nano ä»£æ›¿ gedit )</p></blockquote><p>åœ¨æ‰“å¼€çš„blacklist.confæœ«å°¾æ·»åŠ å¦‚ä¸‹ï¼Œä¿å­˜æ–‡æœ¬å…³é—­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">blacklist nouveau</span><br><span class="line">options nouveau modeset=0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œè¿›è¡Œæ›´æ–°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-initramfs -u</span><br></pre></td></tr></table></figure><p>æ›´æ–°ç»“æŸåé‡å¯ç”µè„‘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure><p>é‡å¯ååœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œå¦‚æœæ²¡æœ‰è¾“å‡ºåˆ™è¯´æ˜æˆåŠŸç¦ç”¨nouveau</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsmod | grep nouveau</span><br></pre></td></tr></table></figure><h3 id="5-åœæ­¢å½“å‰çš„æ˜¾ç¤ºæœåŠ¡å™¨"><a href="#5-åœæ­¢å½“å‰çš„æ˜¾ç¤ºæœåŠ¡å™¨" class="headerlink" title="5. åœæ­¢å½“å‰çš„æ˜¾ç¤ºæœåŠ¡å™¨"></a>5. åœæ­¢å½“å‰çš„æ˜¾ç¤ºæœåŠ¡å™¨</h3><p>æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨telinitå‘½ä»¤æ›´æ”¹ä¸ºè¿è¡Œçº§åˆ«3ã€‚åœ¨ç»ˆç«¯è¾“å…¥ä»¥ä¸‹linuxå‘½ä»¤åï¼Œæ˜¾ç¤ºæœåŠ¡å™¨å°†åœæ­¢ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo telinit 3</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>ä¸€èˆ¬æ‰§è¡Œå®Œä¸Šè¿°å‘½ä»¤åï¼Œç³»ç»Ÿè‡ªåŠ¨è¿›å…¥æ–‡æœ¬ç•Œé¢ttyï¼›<br>å¦‚æœè¿›ä¸å»ï¼Œå°±æŒ‰Ctrl + Alt + F1ï½F6ä¸­çš„ä¸€ä¸ª (åˆ†åˆ«å¯¹åº”è¿›å…¥tty1~tty6)<br>ç„¶åè¾“å…¥ç”¨æˆ·åå’Œå¯†ç </p></blockquote><h3 id="6-åœ¨æ–‡æœ¬ç•Œé¢ä¸­ï¼Œç¦ç”¨X-windowæœåŠ¡"><a href="#6-åœ¨æ–‡æœ¬ç•Œé¢ä¸­ï¼Œç¦ç”¨X-windowæœåŠ¡" class="headerlink" title="6. åœ¨æ–‡æœ¬ç•Œé¢ä¸­ï¼Œç¦ç”¨X-windowæœåŠ¡"></a>6. åœ¨æ–‡æœ¬ç•Œé¢ä¸­ï¼Œç¦ç”¨X-windowæœåŠ¡</h3><p>åœ¨ç»ˆç«¯è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/gdm3 stopæˆ–è€…ï¼ˆsudo service gdm3 stopï¼‰</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="7-å®‰è£…é©±åŠ¨"><a href="#7-å®‰è£…é©±åŠ¨" class="headerlink" title="7. å®‰è£…é©±åŠ¨"></a>7. å®‰è£…é©±åŠ¨</h3><p>cdå‘½ä»¤è¿›å…¥åˆ°å­˜æ”¾é©±åŠ¨çš„ç›®å½•ï¼Œè¾“å…¥å‘½ä»¤ï¼ˆå‘½ä»¤ä¸­çš„æ–‡ä»¶åä»¥ä½ ä¸‹è½½çš„é©±åŠ¨ä¸ºå‡†ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">chmod</span> 777 NVIDIA-Linux-x86_64-535.54.03.run   <span class="comment">#ç»™ä½ ä¸‹è½½çš„é©±åŠ¨èµ‹äºˆå¯æ‰§è¡Œæƒé™ï¼Œæ‰å¯ä»¥å®‰è£…</span></span><br><span class="line">sudo ./NVIDIA-Linux-x86_64-535.54.03.run â€“no-opengl-files   <span class="comment">#å®‰è£…</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_f8b9841992eaa256d8d224a8a53f064a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_f8b9841992eaa256d8d224a8a53f064a.png"></p><blockquote><p>ä»¥ä¸Šé—®é¢˜å¹¶éæŒ‰æˆ‘å†™çš„é¡ºåºå‡ºç°ï¼Œä½†æ˜¯å½“æ—¶æ²¡æœ‰æˆªå›¾æ‰€ä»¥å¿˜è®°é¡ºåºäº†ã€‚<strong>è¡¨æ ¼ä¸­æœ€åä¸€ä¸ªé—®é¢˜</strong>éœ€è¦æ³¨æ„ï¼Œåœ¨å…¶å®ƒçš„æ•™ç¨‹ä¸­ï¼Œè¿™ä¸ªé—®é¢˜é€‰yesï¼Œä½†æ˜¯åœ¨æˆ‘å®‰è£…ç³»ç»Ÿçš„è¿‡ç¨‹ä¸­ï¼Œé€‰yesä¼šå¯¼è‡´ç”µè„‘é‡å¯åæ— æ³•æ­£å¸¸å¼€æœºã€‚<strong>æ‰€ä»¥è¿™é‡Œæˆ‘é€‰äº†No</strong>ï¼Œé‡å¯åèƒ½å¤Ÿæ­£å¸¸å¼€æœºã€‚ï¼ˆUbuntu20.04 ã€æ˜¾å¡4090ï¼‰</p></blockquote><h3 id="8-é‡å¯å›¾å½¢ç•Œé¢"><a href="#8-é‡å¯å›¾å½¢ç•Œé¢" class="headerlink" title="8. é‡å¯å›¾å½¢ç•Œé¢"></a>8. é‡å¯å›¾å½¢ç•Œé¢</h3><p>å®‰è£…å®Œæˆåé€€å›å›¾å½¢ç•Œé¢ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo init 5 </span><br></pre></td></tr></table></figure><p>or</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctrl + alt + f7 </span><br></pre></td></tr></table></figure><p>or</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service gdm3 restart</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç»ˆç«¯è¾“å…¥ reboot é‡å¯</p><h3 id="9-æµ‹è¯•æ˜¾å¡é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸ"><a href="#9-æµ‹è¯•æ˜¾å¡é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸ" class="headerlink" title="9. æµ‹è¯•æ˜¾å¡é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸ"></a>9. æµ‹è¯•æ˜¾å¡é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸ</h3><p>ç»ˆç«¯è¾“å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‡ºç°ç±»ä¼¼ä¸‹å›¾çš„ç•Œé¢ï¼Œè¯´æ˜æˆåŠŸå®‰è£…é©±åŠ¨</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_faf7c52e1453ed6831feafd08733747a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_faf7c52e1453ed6831feafd08733747a.png"></p><h3 id="å››-å®‰è£…CUDA"><a href="#å››-å®‰è£…CUDA" class="headerlink" title="å››. å®‰è£…CUDA"></a>å››. å®‰è£…CUDA</h3><p>ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨pytorch2ï¼Œæˆ‘åœ¨è¿™é‡Œå®‰è£…çš„CUDA11.8ç‰ˆæœ¬ã€‚<br>å‚è€ƒæ•™ç¨‹ï¼š<a href="https://zhuanlan.zhihu.com/p/612556391">CUDA_11.8å®‰è£…-çŸ¥ä¹</a></p><p><strong>cudaç‰ˆæœ¬åˆ—è¡¨ï¼š</strong></p><ul><li><a href="https://developer.nvidia.com/cuda-toolkit-archive">CUDA Toolkit Archive | NVIDIA Developer</a></li><li><a href="https://developer.nvidia.com/cuda-downloads">CUDA Toolkit 12.9 Downloads | NVIDIA Developer</a> ã€ç‚¹å‡»Archive of Previous CUDA Releasesã€‘</li></ul><h4 id="1-å®˜ç½‘ä¸‹è½½CUDA"><a href="#1-å®˜ç½‘ä¸‹è½½CUDA" class="headerlink" title="1. å®˜ç½‘ä¸‹è½½CUDA"></a>1. å®˜ç½‘ä¸‹è½½CUDA</h4><p><a href="https://developer.nvidia.com/cuda-11-8-0-download-archive">CUDA Toolkit 11.8 Downloads</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a3e710d1f0efc1cd8aa0c09ba852954c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a3e710d1f0efc1cd8aa0c09ba852954c.png"></p><h3 id="2-ä¸‹è½½CUDA"><a href="#2-ä¸‹è½½CUDA" class="headerlink" title="2. ä¸‹è½½CUDA"></a>2. ä¸‹è½½CUDA</h3><p>ç»ˆç«¯è¾“å…¥ä¸Šä¸€æ­¥è·å¾—çš„å‘½ä»¤ï¼Œä¸‹è½½runfileæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda_11.8.0_520.61.05_linux.run</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-å®‰è£…"><a href="#3-å®‰è£…" class="headerlink" title="3. å®‰è£…"></a>3. å®‰è£…</h3><p>æ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤ä¸‹è½½runfileæ–‡ä»¶åï¼Œcdåˆ°æ–‡ä»¶æ‰€åœ¨è·¯å¾„ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå®‰è£…cuda</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sh cuda_11.8.0_520.61.05_linux.run</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåç¨å¾®ç­‰å¾…ï¼Œä¼šå‡ºç°å¦‚ä¸‹ç”»é¢</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_75d6fd3264f5a14aea3d46eb7188bfad.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_75d6fd3264f5a14aea3d46eb7188bfad.png"></p><blockquote><p>ä¸Šä¸‹ç§»åŠ¨å…‰æ ‡åˆ°Driverä½ç½®ï¼ŒæŒ‰ç©ºæ ¼å–æ¶ˆé€‰æ‹©ï¼›ç”¨ç›¸åŒçš„æ“ä½œå–æ¶ˆå¦å¤–ä¸‰ä¸ªé€‰é¡¹ï¼Œåªå®‰è£…CUDA Toolkit 11.8ä¸»ä½“ï¼ˆå¦‚å›¾ï¼‰</p></blockquote><p>ç»§ç»­ç§»åŠ¨å…‰æ ‡åˆ°Optionsï¼ŒæŒ‰å›è½¦ï¼Œè¿›å…¥å®‰è£…é…ç½®ç•Œé¢ï¼ˆå¦‚ä¸‹ï¼‰</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_137f5444520fc1ba1ec212be997df3a5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_137f5444520fc1ba1ec212be997df3a5.png"></p><p>å…‰æ ‡ç§»åŠ¨åˆ°Toolkit Optionsï¼ŒæŒ‰å›è½¦ï¼Œè¿›å…¥CUDAå®‰è£…é…ç½®ç•Œé¢ å–æ¶ˆé€‰æ‹©æ‰€æœ‰é€‰é¡¹</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_0067f24a438738730d4d902abcec20ce.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_0067f24a438738730d4d902abcec20ce.png"></p><blockquote><p>å¦‚ä¸Šå›¾ï¼Œå»æ‰æ‰€æœ‰é€‰é¡¹ï¼Œç‰¹åˆ«æ˜¯Create symbolic link from /usr/local/cudaé€‰é¡¹ï¼Œæœ€å¥½æ˜¯å»æ‰ã€‚è¿™æ ·å®‰è£…å®Œæˆåï¼Œæ˜¯ä¸ä¼šåœ¨/usr/local/ä¸‹ç”Ÿæˆcudaè½¯é“¾æ¥ç›®å½•ã€‚è¿™ä¸ªè½¯é“¾æ¥ç›®å½•åœ¨å®‰è£…è¿‡ç¨‹ä¸­æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œå½“æˆ‘ä»¬å®‰è£…å¤šç‰ˆæœ¬CUDAæ—¶ï¼Œä¼šé‡å¤è¦†ç›–è¿™ä¸ªè½¯é“¾æ¥ç›®å½•ï¼Œå¯¹æˆ‘ä»¬ä½¿ç”¨CUDAä¼šäº§ç”Ÿä¸å¿…è¦çš„éº»çƒ¦ã€‚</p></blockquote><blockquote><p>CUDAé»˜è®¤å®‰è£…åœ¨/usr/local/ç›®å½•ä¸‹ï¼Œä¸€èˆ¬Change Toolkit Install Pathå¯ä»¥ä¸åšä¿®æ”¹ã€‚ä½†å¦‚æœæ˜¯æ™®é€šç”¨æˆ·å®‰è£…ï¼Œéœ€è®¾å®šå®‰è£…è·¯å¾„ä¸ºç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼Œå…‰æ ‡ç§»åŠ¨åˆ°Change Toolkit Install PathæŒ‰å›è½¦ï¼Œæ‰‹åŠ¨ä¿®æ”¹å®‰è£…è·¯å¾„åæŒ‰å›è½¦é€€å‡ºè·¯å¾„é…ç½®ç•Œé¢</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_7384d8d55a365e5df7705a52eaba2a81.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_7384d8d55a365e5df7705a52eaba2a81.png"></p><p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><p>æ­¤æ—¶å¦‚æœæƒ³è¦ä¿®æ”¹è·¯å¾„ï¼Œå¯ä»¥è®¾ç½®ä¸ºè‡ªå·±æƒ³è¦æ”¾åœ¨çš„ä½ç½®ï¼Œå¦‚ /home/ç”¨æˆ·å/app/cuda-11.8/</p><p>æ­¤æ—¶é€‰æ‹©å®Œæˆ doneå¤„å›è½¦ ç›´åˆ°å›åˆ°ç¬¬ä¸€æ­¥é€‰æ‹© install æ­¤æ—¶é€‰æ‹©Upgrade all å³å¯ å®‰è£…å®Œæˆå ä¸‹æ–¹è®¾ç½®ç³»ç»Ÿå˜é‡å³å¯é…ç½®å®Œæˆ</p></blockquote><h3 id="4-è®¾ç½®CUDAç¯å¢ƒ"><a href="#4-è®¾ç½®CUDAç¯å¢ƒ" class="headerlink" title="4. è®¾ç½®CUDAç¯å¢ƒ"></a>4. è®¾ç½®CUDAç¯å¢ƒ</h3><p>å¯é…ç½®åœ¨<code>~/.bashrc</code>ç›®å½•æˆ–è€…ç³»ç»Ÿå˜é‡è·¯å¾„<code>/etc/profile</code></p><p>å¦‚æœä¸Šä¸€æ­¥é€‰æ‹©ç”¨rootç”¨æˆ·å®‰è£…åœ¨é»˜è®¤è·¯å¾„ï¼Œåˆ™rootç”¨æˆ·ç¯å¢ƒå˜é‡é…ç½®å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/usr/local/cuda-11.8/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$LD_LIBRARY_PATH</span>:/usr/local/cuda-11.8/lib64</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯æ™®é€šç”¨æˆ·å®‰è£…åœ¨è‡ªå·±çš„ç”¨æˆ·ç›®å½•ä¸‹ï¼Œç¯å¢ƒå˜é‡é…ç½®å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/home/duyong/apps/cuda-11.8/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$LD_LIBRARY_PATH</span>:/home/duyong/apps/cuda-11.8/lib64</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æˆ·é…ç½®æ–‡ä»¶å³åˆ»ç”Ÿæ•ˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><p>éªŒè¯CUDAæ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvcc -V</span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰ç±»ä¼¼å¦‚ä¸‹è¾“å‡ºè¯´æ˜å®‰è£…æˆåŠŸ</p><blockquote><p>nvcc: NVIDIA Â® Cuda complier driver<br>Copyright Â© 2005-2022 NVIDIA Coropration<br>Bulit on Wed_Jun__8_16:49:14_PDT_2022<br>Cuda copiltation tools, release 11.7, V11.7.99<br>Build cuda_11.7.r11.7/compiler .31442593_0</p></blockquote><p>å®‰è£…å®Œæˆåé‡å¯</p><h2 id="äº”-å®‰è£…CUDNN"><a href="#äº”-å®‰è£…CUDNN" class="headerlink" title="äº”. å®‰è£…CUDNN"></a>äº”. å®‰è£…CUDNN</h2><p>å®˜ç½‘ä¸‹è½½åœ°å€ï¼šï¼ˆéœ€è¦æ³¨å†Œï¼‰</p><p><a href="https://developer.nvidia.com/cudnn">https://developer.nvidia.com/cudnn</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_255bdd3027c994186d2ab7d232c048d6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_255bdd3027c994186d2ab7d232c048d6.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a00f30ce85ee7aea5ba4008845c2697a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a00f30ce85ee7aea5ba4008845c2697a.png"></p><p>ç‚¹å‡»ä¸‹è½½ï¼Œä¸‹è½½å®Œæˆåè§£å‹æ–‡ä»¶ï¼Œåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> cuda/include/cudnn.h /usr/local/cuda/include/</span><br><span class="line">sudo <span class="built_in">cp</span> cuda/lib64/libcudnn* /usr/local/cuda/lib64/</span><br><span class="line">sudo <span class="built_in">chmod</span> a+r /usr/local/cuda/include/cudnn.h</span><br><span class="line">sudo <span class="built_in">chmod</span> a+r /usr/local/cuda/lib64/libcudnn*</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤æ­¥æ“ä½œä¸ºæ‹·è´æ–‡ä»¶åˆ°æŒ‡å®šä½ç½®ï¼Œå¹¶èµ‹äºˆæƒé™</p><p>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼Œè¾“å…¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR -A 2</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸä¼šæœ‰ç±»ä¼¼ä¸‹å›¾çš„è¾“å‡º</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2a150aaca0cc6b1bfd635806439e0210.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2a150aaca0cc6b1bfd635806439e0210.png"></p><h3 id="å…­-å®‰è£…Anaconda"><a href="#å…­-å®‰è£…Anaconda" class="headerlink" title="å…­. å®‰è£…Anaconda"></a>å…­. å®‰è£…Anaconda</h3><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/m0_50117360/article/details/108403586">Ubuntu 20.04å®‰è£…Anaconda3åŠç®€å•ä½¿ç”¨</a></p><h3 id="ä¸ƒ-å®‰è£…Pytorch2"><a href="#ä¸ƒ-å®‰è£…Pytorch2" class="headerlink" title="ä¸ƒ. å®‰è£…Pytorch2"></a>ä¸ƒ. å®‰è£…Pytorch2</h3><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/KRISNAT/article/details/124068391">è¶…è¯¦ç»† Ubuntuå®‰è£…PyTorchæ­¥éª¤</a></p><h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h3><p><a href="https://zhuanlan.zhihu.com/p/590877041">https://zhuanlan.zhihu.com/p/590877041</a><br><a href="https://blog.csdn.net/hwh295/article/details/113409389">https://blog.csdn.net/hwh295/article/details/113409389</a><br><a href="https://blog.csdn.net/Perfect886/article/details/119109380">https://blog.csdn.net/Perfect886/article/details/119109380</a><br><a href="https://zhuanlan.zhihu.com/p/61255639">https://zhuanlan.zhihu.com/p/61255639</a><br><a href="https://blog.csdn.net/m0_50117360/article/details/108403586">https://blog.csdn.net/m0_50117360/article/details/108403586</a><br><a href="https://blog.csdn.net/KRISNAT/article/details/124068391">https://blog.csdn.net/KRISNAT/article/details/124068391</a><br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><h3 id="æœ¬æ–‡å‚è€ƒï¼š"><a href="#æœ¬æ–‡å‚è€ƒï¼š" class="headerlink" title="æœ¬æ–‡å‚è€ƒï¼š"></a>æœ¬æ–‡å‚è€ƒï¼š</h3><p><a href="https://blog.csdn.net/qq_43775794/article/details/131770933">https://blog.csdn.net/qq_43775794/article/details/131770933</a></p>]]></content>
      
      
      <categories>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™ å®‰è£…æ–°mysql</title>
      <link href="/2024/06/05/ubuntu%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4mysql%E6%AE%8B%E7%95%99%20%E5%AE%89%E8%A3%85%E6%96%B0mysql/"/>
      <url>/2024/06/05/ubuntu%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4mysql%E6%AE%8B%E7%95%99%20%E5%AE%89%E8%A3%85%E6%96%B0mysql/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™-å®‰è£…æ–°mysql"><a href="#ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™-å®‰è£…æ–°mysql" class="headerlink" title="ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™ å®‰è£…æ–°mysql"></a>ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™ å®‰è£…æ–°mysql</h1><p>1.åˆ é™¤mysqlçš„æ•°æ®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> /var/lib/mysql/ -R</span><br></pre></td></tr></table></figure><p>2.åˆ é™¤mysqlçš„é…ç½®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> /etc/mysql/ -R</span><br></pre></td></tr></table></figure><p>(è¿™ä¸¤æ­¥éå¸¸é‡è¦ï¼Œå¥½å¤šæ–‡ç« éƒ½æ²¡å†™)</p><p>3 .dpkg â€“list|grep mysqlæŸ¥çœ‹mysqlçš„ä¾èµ–é¡¹</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_8a639ced957b5aa0db30b0b1aac12589.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_8a639ced957b5aa0db30b0b1aac12589.png"></p><p>4.å¼€å§‹åˆ é™¤ä¾èµ–é¡¹</p><p>4.1 .å¸è½½å‘½ä»¤ï¼šsudo apt-get remove mysql-common</p><p>4.2. å¸è½½å‘½ä»¤ï¼šsudo apt-get autoremove â€“purge mysql-server-8.0</p><p>å¤‡æ³¨æ­¤ä¸¤éƒ¨åˆä¸ºä¸€æ­¥:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹æ–¹ä¸¤å‘½ä»¤çš†å¯</span></span><br><span class="line">dpkg -l|grep mysql|awk <span class="string">&#x27;&#123;print$2&#125;&#x27;</span>|sudo xargs dpkg -P</span><br><span class="line">dpkg -l|grep mysql|awk <span class="string">&#x27;&#123;print$2&#125;&#x27;</span>|sudo xargs remove -y</span><br></pre></td></tr></table></figure><p>4.3 .æ¸…é™¤æ®‹ç•™æ•°æ®ï¼Œè¿è¡Œå‘½ä»¤ï¼šdpkg -l|grep mysql|awk â€˜{print$2}â€™|sudo xargs dpkg -P</p><p>å†æ¬¡æŸ¥çœ‹MySQLçš„å‰©ä½™ä¾èµ–é¡¹ï¼Œè¿è¡Œå‘½ä»¤ï¼šdpkg â€“list|grep mysql</p><p>å¦‚æœæ²¡æœ‰è¿”å›å³åˆ é™¤å®Œäº†ï¼ˆåŸºæœ¬ä¸Šå°±ä¼šåˆ é™¤å®Œï¼‰ï¼Œå¦‚æœæ²¡åˆ é™¤å®Œåˆ™ç»§ç»­åˆ é™¤æ˜¾ç¤ºçš„ä¾èµ–åŒ…</p><p>å…¶ä»–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®å¤å®‰è£…åŒ…</span></span><br><span class="line">sudo dpkg-reconfigure mysql-server-5.7</span><br><span class="line"><span class="comment"># å¸è½½å®‰è£…åŒ…åŠé…ç½®æ–‡ä»¶</span></span><br><span class="line">sudo apt-get purge mysql-server-5.7</span><br></pre></td></tr></table></figure><p>å®Œæˆ æ­¤æ—¶å³å¯é‡æ–°å®‰è£…mysqlï¼</p><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_52135683/article/details/126857974">https://blog.csdn.net/qq_52135683/article/details/126857974</a></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>grafana 8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦</title>
      <link href="/2024/06/04/grafana%208%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%E9%82%AE%E4%BB%B6%E5%91%8A%E8%AD%A6/"/>
      <url>/2024/06/04/grafana%208%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%E9%82%AE%E4%BB%B6%E5%91%8A%E8%AD%A6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="grafana-8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦"><a href="#grafana-8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦" class="headerlink" title="grafana 8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦"></a>grafana 8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦</h1><blockquote><p>æœ¬æ¬¡æ¼”ç¤ºä½¿ç”¨ç‰ˆæœ¬9.2.0</p><p>æ‹“è¡¥å›¾</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_edeee1c476fa329e2b3489f066df346c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_edeee1c476fa329e2b3489f066df346c.png"></p></blockquote><h2 id="1-é¦–å…ˆé…ç½®åç«¯é‚®ä»¶é…ç½®"><a href="#1-é¦–å…ˆé…ç½®åç«¯é‚®ä»¶é…ç½®" class="headerlink" title="1.é¦–å…ˆé…ç½®åç«¯é‚®ä»¶é…ç½®"></a>1.é¦–å…ˆé…ç½®åç«¯é‚®ä»¶é…ç½®</h2><p>å»ºè®®é…ç½®ä¸ºé‚®ä»¶ç»„ ç»„å†…æˆå‘˜éƒ½å¯æ”¶åˆ°é‚®ä»¶</p><p>æ­¤å¤„è§é“¾æ¥ï¼š<a href="https://wn-apple-teawine.fun/2023/05/26/grafana%E9%85%8D%E7%BD%AE%E9%82%AE%E4%BB%B6%E5%91%8A%E8%AD%A6">https://wn-apple-teawine.fun/2023/05/26/grafanaé…ç½®é‚®ä»¶å‘Šè­¦</a></p><h2 id="2-æ­¤æ—¶å³å¯é…ç½®å‘Šè­¦è§„åˆ™"><a href="#2-æ­¤æ—¶å³å¯é…ç½®å‘Šè­¦è§„åˆ™" class="headerlink" title="2.æ­¤æ—¶å³å¯é…ç½®å‘Šè­¦è§„åˆ™"></a>2.æ­¤æ—¶å³å¯é…ç½®å‘Šè­¦è§„åˆ™</h2><p>â‘ .é…ç½®</p><p>åç«¯é…ç½®è§ä¸Šæ–¹é“¾æ¥</p><p>å‰ç«¯é…ç½®è§ä¸‹æ–¹</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_77d36f135d1154ed015d21243fe9f8bc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_77d36f135d1154ed015d21243fe9f8bc.png"></p><p>ç‚¹å‡»æµ‹è¯•æŸ¥çœ‹æ˜¯å¦æˆåŠŸ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_4e8ed1f107e3602cfcf8edb7ff1872ca.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_4e8ed1f107e3602cfcf8edb7ff1872ca.png"></p><p>é…ç½®æŒç»­å‘é€å‘Šè­¦ é…ç½® Notification policies è®¾ç½®é‡å¤å‘é€å‘Šè­¦é‚®ä»¶çš„é—´éš”æ—¶é—´</p><p>ä¸è®¾ç½®æ­¤åˆ™é»˜è®¤å››å°æ—¶é‡å¤å‘é€ ç›¸å½“ç³Ÿç³•ğŸ’—</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_b76111cbaf1baced4e24119f9bb1c9a8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_b76111cbaf1baced4e24119f9bb1c9a8.png"></p><p><strong>æ­¤æ—¶ä¾¿ä¼šä¸¤åˆ†é’Ÿå‘ä¸€å°å‘Šè­¦é‚®ä»¶</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_ba9125fba1e0c66be945b60a83f2b41e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_ba9125fba1e0c66be945b60a83f2b41e.png"></p><p>â‘¡.é…ç½®promsqlè¯­å¥è®¾ç½®æŠ¥è­¦</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_54e566d16a35915ac3f03f44a05c8ed5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_54e566d16a35915ac3f03f44a05c8ed5.png"></p><p>æŠ¥è­¦æ¡ä»¶é€‰æ‹© é€‰æ‹©Bè¯­å¥ é€‰æ‹©Aä¼šæŠ¥é”™</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_e2cee9496752811ae27dba1c7b6c22bd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_e2cee9496752811ae27dba1c7b6c22bd.png"></p><p>æˆ–æ‹–åŠ¨æ­¤çº¿ğŸº</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_93c6bf297b5cff54231696e190e19874.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_93c6bf297b5cff54231696e190e19874.png"></p><p>é€‰æ‹©æŠ¥è­¦è¡¨è¾¾å¼ä¸º <strong>B</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a62de892570cd8c66cc553250ed18d68.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a62de892570cd8c66cc553250ed18d68.png"></p><p>è®¾ç½®æŠ¥è­¦å‘¨æœŸ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_5a25154c8a7e1694b0e6237fd051f8b4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_5a25154c8a7e1694b0e6237fd051f8b4.png"></p><p>è®¾ç½®æŠ¥è­¦å‡ºç°å‘é€æç¤ºè¯­å¥</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_776ebfdddab566d58c59c4685d439a9c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_776ebfdddab566d58c59c4685d439a9c.png"></p><p>è‡ªå®šä¹‰æ ‡ç­¾</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_1f801f865e968f8b9d0594ee1e9d84dd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_1f801f865e968f8b9d0594ee1e9d84dd.png"></p><h2 id="2-æ•ˆæœ"><a href="#2-æ•ˆæœ" class="headerlink" title="2.æ•ˆæœ"></a>2.æ•ˆæœ</h2><p>æŠ¥è­¦é¡µé¢</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_cec9e81d68127efb459ca97cb4f1d9e0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_cec9e81d68127efb459ca97cb4f1d9e0.png"></p><p>æŠ¥è­¦æ¢å¤ä¸å‘é€æŠ¥è­¦<br><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_5f7a15945a38ac95755b68996feb913e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_5f7a15945a38ac95755b68996feb913e.png"></p><p>å‚è€ƒï¼š</p><p><a href="https://blog.51cto.com/u_11529070/9174855">[è½¬å¸–]Prometheusç³»åˆ—ä¹‹Grafana ç‰ˆæœ¬9.0.0 è®¾ç½®Emailé‚®ä»¶æŠ¥è­¦å®æˆ˜_51CTOåšå®¢_prometheusé‚®ä»¶å‘Šè­¦</a></p>]]></content>
      
      
      <categories>
          
          <category> grafana </category>
          
      </categories>
      
      
        <tags>
            
            <tag> grafana </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘</title>
      <link href="/2024/06/03/%E5%AE%9D%E5%A1%94docker%E9%83%A8%E7%BD%B2%E5%AE%9E%E7%8E%B0%E5%AF%B9%E6%9F%90%E4%B8%80%E4%B8%AA%E7%9B%AE%E5%BD%95%E7%9A%84%E7%BC%96%E8%BE%91/"/>
      <url>/2024/06/03/%E5%AE%9D%E5%A1%94docker%E9%83%A8%E7%BD%B2%E5%AE%9E%E7%8E%B0%E5%AF%B9%E6%9F%90%E4%B8%80%E4%B8%AA%E7%9B%AE%E5%BD%95%E7%9A%84%E7%BC%96%E8%BE%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘"><a href="#å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘" class="headerlink" title="å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘"></a>å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘</h1><blockquote><h2 id="ç‰ˆæœ¬å‘½åè¯´æ˜-ï¼ˆé•œåƒå¯é€‰ï¼‰"><a href="#ç‰ˆæœ¬å‘½åè¯´æ˜-ï¼ˆé•œåƒå¯é€‰ï¼‰" class="headerlink" title="ç‰ˆæœ¬å‘½åè¯´æ˜ ï¼ˆé•œåƒå¯é€‰ï¼‰"></a>ç‰ˆæœ¬å‘½åè¯´æ˜ ï¼ˆé•œåƒå¯é€‰ï¼‰</h2><p>pch18/baotaæˆ–pch18/baota:latestç­‰åŒpch18/baota:lnmp<br>pch18/baota:lnmpä¸ºæœ€æ–°ç‰ˆæœ¬çš„å®˜æ–¹çº¯å‡€å®‰è£…çš„åŸºç¡€ä¸Šå®‰è£…nginx,mysql,php<br>pch18/baota:lnp ä¸ºå®˜æ–¹ç‰ˆæœ¬çº¯å‡€å®‰è£…çš„åŸºç¡€ä¸Šå®‰è£…nginx,php(ä¸å†…ç½®mysql,ç”¨äºå¤–ç½®æ•°æ®åº“çš„ç¯å¢ƒ)<br>pch18/baota:lamp ä¸ºå®˜æ–¹ç‰ˆæœ¬çº¯å‡€å®‰è£…çš„åŸºç¡€ä¸Šå®‰è£…apache,php<br>pch18/baota:lap ä¸ºå®˜æ–¹ç‰ˆæœ¬çº¯å‡€å®‰è£…çš„åŸºç¡€ä¸Šå®‰è£…apache,php(ä¸å†…ç½®mysql,ç”¨äºå¤–ç½®æ•°æ®åº“çš„ç¯å¢ƒ)<br>pch18/baota:clear ä¸ºå®˜æ–¹ç‰ˆæœ¬çº¯å‡€å®‰è£…, ä¸é»˜è®¤å®‰è£…nginx,mysql,phpç­‰ç¨‹åº</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/pch18-docker/baota">https://github.com/pch18-docker/baota</a></p></blockquote><h2 id="é•œåƒå¯é€‰"><a href="#é•œåƒå¯é€‰" class="headerlink" title="é•œåƒå¯é€‰"></a>é•œåƒå¯é€‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pch18/baota</span><br><span class="line">pch18/baota:clear</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:baota</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:pch18baota-clean</span><br></pre></td></tr></table></figure><h2 id="docker-composeéƒ¨ç½²"><a href="#docker-composeéƒ¨ç½²" class="headerlink" title="docker-composeéƒ¨ç½²"></a>docker-composeéƒ¨ç½²</h2><blockquote><p>åªéœ€è¦æš´éœ² webè®¿é—®ç«¯å£ 8888ä¸80ç«¯å£çš„æ˜ å°„å³å¯</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">baota:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">pch18/baota:clear</span></span><br><span class="line">    <span class="comment"># registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:baota</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">baota</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/data:/www/v10</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">~/wwwroot:/www/wwwroot</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8010:80&quot;</span></span><br><span class="line">      <span class="comment"># - &quot;4431:443&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8888:8888&quot;</span></span><br><span class="line">      <span class="comment"># - &quot;888:888&quot;</span></span><br><span class="line">    <span class="attr">shm_size:</span> <span class="string">&#x27;1g&#x27;</span></span><br></pre></td></tr></table></figure><p>å…³é—­å®‰è£…å¥—ä»¶æ¨èï¼š<code>sed -i &quot;s/self.CheckInstalled()/True/g&quot; /www/server/panel/class/system.py</code></p><p><strong>æ‰‹åŠ¨æ­¥éª¤</strong></p><ol><li>ä¿®æ”¹æ–‡ä»¶è·¯å¾„ï¼š<code>/www/server/panel/class/system.py</code></li><li>æœç´¢ä»£ç ï¼š<code>networkInfo[&#39;installed&#39;] = self.CheckInstalled()</code></li><li>æ›¿æ¢ä¸ºï¼š<code>networkInfo[&#39;installed&#39;] = True</code></li><li>é‡å¯é¢æ¿ï¼Œä½ ä¼šå‘ç°çƒ¦äººçš„å¼¹çª—æ¶ˆå¤±äº†ã€‚</li></ol><p><a href="https://qzone.work/technologys/604.html">å®å¡”é¢æ¿ç¦ç”¨ å¥—ä»¶æ¨èå®‰è£…å¼¹çª— - è«ååšå®¢ (qzone.work)</a></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>ç™»å½•æ–¹å¼<br>ç™»é™†åœ°å€ http://:8888<br>åˆå§‹è´¦å· username<br>åˆå§‹å¯†ç  password</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_63177a79daa92e8f483ee31941b38457.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_63177a79daa92e8f483ee31941b38457.png"></p><p>è‹¥æ— æ³•ç™»å½•åˆ™éœ€è¦é‡æ–°ä¿®æ”¹å¯†ç  docker exec è¿›å…¥å®¹å™¨ ä½¿ç”¨ bt å‘½ä»¤ è¾“å…¥5ï¼Œ6é‡ç½®ç™»å½•ä¿¡æ¯  ç™»å½•æˆåŠŸåéœ€è¦å¼€å¯ç¦»çº¿æ¨¡å¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·</title>
      <link href="/2024/05/30/ChatGPT%E5%AF%B9%E6%8E%A5%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
      <url>/2024/05/30/ChatGPT%E5%AF%B9%E6%8E%A5%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·"><a href="#ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·" class="headerlink" title="ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·"></a>ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·</h1><blockquote><p>ä½¿ç”¨vercel é¡¹ç›®åœ°å€: <a href="https://github.com/pwh-pwh/aiwechat-vercel">https://github.com/pwh-pwh/aiwechat-vercel</a></p><p>éƒ¨ç½²é“¾æ¥ï¼š<a href="https://vercel.com/">https://vercel.com/</a></p></blockquote><p>ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GPT_TOKEN: sk-utaX8XNb1Lq5m9DWQDqVT3BlbkFddsJNVgkLJshdsddsdsd</span><br><span class="line">WX_SUBSCRIBE_REPLY: æœ¬å…¬ä¼—å·(ç®€é€¸äº‘.) ç”¨äºåˆ†äº« äº‘è®¡ç®—ï¼Œäººå·¥æ™ºèƒ½ï¼Œå¤§æ¨¡å‹é›†æˆï¼Œå¼€æºç¤¾åŒºï¼Œäº‘åŸç”Ÿç›‘æ§ç­‰çŸ¥è¯† å¸®åŠ©æ‚¨è§£å†³æ—¥å¸¸ç”Ÿæ´»åŠå·¥ä½œä¸­çš„éš¾é¢˜ å…¬ä¼—å·å·²é›†æˆGPTæ„Ÿè°¢æ‚¨çš„å…³æ³¨ï¼</span><br><span class="line">maxOutput: 200</span><br><span class="line">WX_HELP_REPLY: è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå¯¹è¯ \n/helpï¼šæŸ¥çœ‹å¸®åŠ© \n/gptï¼šä¸GPTå¯¹è¯ \næ­¤GPTæ¯æ¬¡å›ç­”å­—æ•°é™åˆ¶ä¸º200å­—å·¦å³ï¼Œå¦‚éœ€è§£é™¤å­—æ•°é™åˆ¶è¯·è”ç³»ä½œè€…(87889211611@qq.com)è·å–å¸®åŠ©ã€‚</span><br><span class="line">accessCode: Jkl12fdfdsdsd!</span><br><span class="line">GPT_URL: https://api.openai.com/v1</span><br><span class="line">botType: gpt</span><br><span class="line">WX_TOKEN: 53acb98d1dac49dffdfd969b45797129f504f8</span><br><span class="line">gptModel: gpt-3.5-turbo</span><br></pre></td></tr></table></figure><p>æµ‹è¯•ï¼š</p><ul><li>æœ‰å¯†ç ï¼š<a href="https://zznngpt.zznnwn.cloudns.biz/api/chat?code=Jkl123456-&amp;msg=%E4%BD%A0%E6%98%AF%E8%B0%81">https://zznngpt.zznnwn.cloudns.biz/api/chat?code=Jkl123456-&amp;msg=ä½ æ˜¯è°</a></li><li>æ— å¯†ç ï¼š<a href="https://zznngpt.zznnwn.cloudns.biz/api/chat?msg=%E4%BD%A0%E7%9A%84%E9%97%AE%E9%A2%98">https://zznngpt.zznnwn.cloudns.biz/api/chat?msg=ä½ çš„é—®é¢˜</a></li><li>æ­£ç¡®æ€§æ£€æŸ¥ï¼š<a href="https://zznngpt.zznnwn.cloudns.biz/api/check">https://zznngpt.zznnwn.cloudns.biz/api/check</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡</title>
      <link href="/2024/05/30/RustDesk%E5%85%A8%E5%B9%B3%E5%8F%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5%E8%BD%AF%E4%BB%B6%E8%87%AA%E5%BB%BA%E6%9C%8D%E5%8A%A1/"/>
      <url>/2024/05/30/RustDesk%E5%85%A8%E5%B9%B3%E5%8F%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5%E8%BD%AF%E4%BB%B6%E8%87%AA%E5%BB%BA%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡"><a href="#RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡" class="headerlink" title="RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡"></a>RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡</h1><blockquote><p>RustDesk æ˜¯ä¸€æ¬¾å¼€æºçš„å…¨å¹³å°è¿œç¨‹æ¡Œé¢è½¯ä»¶ï¼Œå¯ä»¥å¹³æ›¿ TeamViewerã€å‘æ—¥è‘µã€ToDesk ç­‰è¿œç¨‹æ¡Œé¢è½¯ä»¶ã€‚å¯ä½¿ç”¨å®˜æ–¹æä¾›çš„å…è´¹æœåŠ¡å™¨ï¼ˆå›½å†…ä½¿ç”¨æ¯”è¾ƒæ‹‰èƒ¯ï¼‰ï¼Œä¹Ÿå¯è‡ªå»ºæœåŠ¡å™¨è®©æ•°æ®æŒæ¡åœ¨è‡ªå·±æ‰‹ä¸­ï¼Œä¸ç”¨æ‹…å¿ƒå®‰å…¨é—®é¢˜ï¼Œä»¥ä¸‹åˆ—ä¸¾å‡ ä¸ªç‰¹ç‚¹ï¼š</p><p>å…¨å¹³å°æ”¯æŒï¼Œå¦‚ï¼šWindowsã€macOSã€Linuxã€iOSã€Androidã€Web ç­‰ã€‚<br>æ”¯æŒ VP8 / VP9 / AV1 è½¯ä»¶ç¼–è§£ç å™¨å’Œ H264 / H265 ç¡¬ä»¶ç¼–è§£ç å™¨ã€‚<br>å®Œå…¨æŒæ§æ•°æ®ï¼Œè½»æ¾è‡ªå»ºã€‚<br>P2P è¿æ¥ï¼Œç«¯åˆ°ç«¯åŠ å¯†ã€‚<br>RustDesk 1.2 å¼€å§‹é‡‡ç”¨ Flutter é‡å†™æ¡Œé¢ç‰ˆæœ¬ï¼Œå¯ä»¥æ”¯æŒ Wayland è¢«æ§äº†ã€‚<br>å›½å†…çš„å¼€å‘å›¢é˜Ÿï¼ŒçŸ¥ä¹æœ‰è´¦å·ï¼ˆè¿˜æ¯”è¾ƒæ´»è·ƒï¼‰ï¼Œæœ‰é—®é¢˜å¯ä»¥å»æé—®ã€‚<br>RustDesk å®˜ç½‘ï¼š <a href="https://rustdesk.com/zh/">https://rustdesk.com/zh/</a></p><p>æœåŠ¡ç«¯ GitHub åœ°å€ï¼š <a href="https://github.com/rustdesk/rustdesk-server">https://github.com/rustdesk/rustdesk-server</a></p><p>å®¢æˆ·ç«¯ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/rustdesk/rustdesk/releases">https://github.com/rustdesk/rustdesk/releases</a></p><p>æ–‡æ¡£åœ°å€ï¼š <a href="https://rustdesk.com/docs/zh-cn">https://rustdesk.com/docs/zh-cn</a></p></blockquote><h2 id="ä¸€-éƒ¨ç½²"><a href="#ä¸€-éƒ¨ç½²" class="headerlink" title="ä¸€. éƒ¨ç½²"></a>ä¸€. éƒ¨ç½²</h2><p>docker-composeéƒ¨ç½²</p><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rustdesk/rustdesk-server-s6:latest</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:rustdesk-server-s6</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">rustdesk-server:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">rustdesk/rustdesk-server-s6:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">rustdesk-server</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./data:/data</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">21115</span><span class="string">:21115</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">21116</span><span class="string">:21116</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">21116</span><span class="string">:21116/udp</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">21117</span><span class="string">:21117</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;RELAY=192.168.30.69:21117&quot;</span>  <span class="comment"># å¡«å…¥åŸŸåæˆ–è€…IP+hbbrçš„ç«¯å£</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;ENCRYPTED_ONLY=1&quot;</span></span><br></pre></td></tr></table></figure><h2 id="äºŒ-ä½¿ç”¨"><a href="#äºŒ-ä½¿ç”¨" class="headerlink" title="äºŒ. ä½¿ç”¨"></a>äºŒ. ä½¿ç”¨</h2><p>ä¸‹è½½å®¢æˆ·ç«¯æ‰“å¼€å¡«å…¥ æœåŠ¡å™¨å¤–ç½‘IP  åŠç”Ÿæˆçš„keyæ–‡ä»¶ï¼ˆcat /opt/rustdesk/data/id_ed25519.pubï¼‰  è‡ªå·±çš„å®¢æˆ·ç«¯å’Œ è¢«æ§æ–¹çš„å®¢æˆ·ç«¯éƒ½éœ€è¦å¡«å…¥IDæœåŠ¡å™¨ å’Œkey ç‚¹å‡»è¿œç¨‹å³å¯ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e133e39869f85fb864d9a6bc05ba20e1.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e133e39869f85fb864d9a6bc05ba20e1.png"></p><p>æ­¤æ—¶å³å¯è¿œç¨‹ã€‚</p><h2 id="ä¸‰-æœ¬æ–‡å‚è€ƒ"><a href="#ä¸‰-æœ¬æ–‡å‚è€ƒ" class="headerlink" title="ä¸‰. æœ¬æ–‡å‚è€ƒ"></a>ä¸‰. æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://blog.vlinyu.com/archives/docker-compose-remotedesk-rustdesk-server">ã€Docker é¡¹ç›®ã€‘ä¹‹â€“RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡å™¨æµç¨‹-væ—ç¾½ (vlinyu.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer</title>
      <link href="/2024/05/30/%E9%83%A8%E7%BD%B2%E7%B1%BB%E4%BC%BC%E7%9F%A5%E4%B9%8E%E7%9A%84%E9%97%AE%E7%AD%94%E7%A4%BE%E5%8C%BAAnswer/"/>
      <url>/2024/05/30/%E9%83%A8%E7%BD%B2%E7%B1%BB%E4%BC%BC%E7%9F%A5%E4%B9%8E%E7%9A%84%E9%97%AE%E7%AD%94%E7%A4%BE%E5%8C%BAAnswer/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer"><a href="#éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer" class="headerlink" title="éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer"></a>éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer</h1><h2 id="ä¸€-é¡¹ç›®åœ°å€"><a href="#ä¸€-é¡¹ç›®åœ°å€" class="headerlink" title="ä¸€. é¡¹ç›®åœ°å€"></a>ä¸€. é¡¹ç›®åœ°å€</h2><p>Answer å®˜æ–¹ç½‘å€ï¼š<a href="https://answer.dev/">https://answer.dev/</a></p><p>Answer å®˜æ–¹ GitHubï¼š<a href="https://github.com/answerdev/answer">https://github.com/answerdev/answer</a></p><p>Answer å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://answer.dev/docs/installation/">https://answer.dev/docs/installation/</a></p><h2 id="äºŒ-Dockeré•œåƒ"><a href="#äºŒ-Dockeré•œåƒ" class="headerlink" title="äºŒ. Dockeré•œåƒ"></a>äºŒ. Dockeré•œåƒ</h2><p><a href="https://hub.docker.com/r/danielszabo99/microbin">https://hub.docker.com/r/danielszabo99/microbin</a></p><h2 id="ä¸‰-é¡¹ç›®ä»‹ç»"><a href="#ä¸‰-é¡¹ç›®ä»‹ç»" class="headerlink" title="ä¸‰. é¡¹ç›®ä»‹ç»"></a>ä¸‰. é¡¹ç›®ä»‹ç»</h2><blockquote><p>Answeræ˜¯ä¸€ä¸ªç±»ä¼¼çŸ¥ä¹çš„å¼€æºé—®ç­”ç¤¾åŒºã€‚æ”¯æŒDockeréƒ¨ç½²ï¼Œç›®å‰GitHubæ‹¥æœ‰5.4Kçš„starã€‚</p></blockquote><h2 id="å››-åŠŸèƒ½ä»‹ç»"><a href="#å››-åŠŸèƒ½ä»‹ç»" class="headerlink" title="å››. åŠŸèƒ½ä»‹ç»"></a>å››. åŠŸèƒ½ä»‹ç»</h2><p>éå¸¸å°å·§<br>æ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼ˆä¾‹å¦‚ï¼šserver.com/file/pig-dog-catï¼‰<br>æ”¯æŒrawçš„æ–‡æœ¬æœåŠ¡ï¼ˆä¾‹å¦‚ï¼Œserver.com/raw/pig-dog-catï¼‰<br>å¯ä»¥ç”¨æ¥URLç¼©çŸ­å’Œé‡å®šå‘<br>æ”¯æŒäºŒç»´ç <br>æ•°æ®åº“éå¸¸ç®€å•ï¼ˆJSON+æ–‡ä»¶ï¼‰ï¼Œå¯ç§»æ¤æ€§å¼ºï¼Œæ˜“äºå¤‡ä»½å’Œæ•´åˆ<br>æ”¯æŒåˆ—å‡ºä½¿ç”¨è¿‡çš„åˆ—è¡¨<br>æ”¯æŒç§æœ‰é“¾æ¥å’Œå…¬å¼€é“¾æ¥ï¼Œå¯ç¼–è¾‘ï¼Œå¯ä»¥è®¾ç½®é“¾æ¥çš„æœ‰æ•ˆæ€§<br>æ”¯æŒä»£ç è¯­æ³•é«˜äº®<br>è‡ªåŠ¨æš—é»‘æ¨¡å¼å’Œè‡ªå®šä¹‰æ ·å¼ï¼Œåªéœ€å¾ˆå°‘çš„CSSå’ŒvanillaÂ JSï¼ˆè§water.cssï¼‰<br>é»˜è®¤ä»¥åŠ¨ç‰©çš„åå­—ä½œä¸ºç»“å°¾ï¼ˆå¯ä¿®æ”¹æˆéšæœºå­—ç¬¦ï¼‰</p><h2 id="äº”-éƒ¨ç½²"><a href="#äº”-éƒ¨ç½²" class="headerlink" title="äº”. éƒ¨ç½²"></a>äº”. éƒ¨ç½²</h2><p>docker-copmpose éƒ¨ç½²</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">answer:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">answerdev/answer</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;9008:80&#x27;</span>            <span class="comment"># å†’å·å·¦è¾¹å¯ä»¥æ”¹æˆè‡ªå·±æœåŠ¡å™¨æœªè¢«å ç”¨çš„ç«¯å£</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">on-failure</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./answer-data:/data</span>  <span class="comment"># å†’å·å·¦è¾¹å¯ä»¥æ”¹è·¯å¾„ï¼Œç°åœ¨æ˜¯è¡¨ç¤ºæŠŠæ•°æ®å­˜æ”¾åœ¨åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ answer-data æ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mariadb:10</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">on-failure</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">answer</span>   <span class="comment"># æ•°æ®åº“ç”¨æˆ·rootçš„å¯†ç ï¼Œå»ºè®®è‡ªè¡Œä¿®æ”¹ä¸€ä¸ª</span></span><br><span class="line">      <span class="attr">MYSQL_USER:</span> <span class="string">answer</span>     </span><br><span class="line">      <span class="attr">MYSQL_PASSWORD:</span> <span class="string">answer</span>   <span class="comment"># æ•°æ®åº“ç”¨æˆ·answerçš„å¯†ç ï¼Œå»ºè®®è‡ªè¡Œä¿®æ”¹ä¸€ä¸ª</span></span><br><span class="line">      <span class="attr">MYSQL_DATABASE:</span> <span class="string">answer</span> </span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./mariadb:/var/lib/mysql</span>  <span class="comment"># å†’å·å·¦è¾¹å¯ä»¥æ”¹è·¯å¾„ï¼Œç°åœ¨æ˜¯è¡¨ç¤ºæŠŠæ•°æ®å­˜æ”¾åœ¨åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ mariadb æ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">--character-set-server=utf8mb4</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span></span><br></pre></td></tr></table></figure><h2 id="å…­-æ•ˆæœ"><a href="#å…­-æ•ˆæœ" class="headerlink" title="å…­. æ•ˆæœ"></a>å…­. æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_2f2f5fe7b710450a248e624a3299d855.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_2f2f5fe7b710450a248e624a3299d855.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_13c7b65b321acf267ffd7b70a31c1fad.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_13c7b65b321acf267ffd7b70a31c1fad.png"></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vmware esxi gpuç›´é€š</title>
      <link href="/2024/05/28/vmware%20esxi%20gpu%E7%9B%B4%E9%80%9A/"/>
      <url>/2024/05/28/vmware%20esxi%20gpu%E7%9B%B4%E9%80%9A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="vmware-esxi-gpuç›´é€š"><a href="#vmware-esxi-gpuç›´é€š" class="headerlink" title="vmware esxi gpuç›´é€š"></a>vmware esxi gpuç›´é€š</h1><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://www.dinghui.org/vmware-esxi-directpath-gpu.html">https://www.dinghui.org/vmware-esxi-directpath-gpu.html</a></p><p><a href="https://www.dinghui.org/vmware-esxi-nvidia-gpu.html">https://www.dinghui.org/vmware-esxi-nvidia-gpu.html</a></p><p><a href="https://docs.vmware.com/cn/VMware-vSphere/7.0/com.vmware.vsphere.resmgmt.doc/GUID-9044A2BA-D4E5-4221-87F4-0B1C8612B748.html">https://docs.vmware.com/cn/VMware-vSphere/7.0/com.vmware.vsphere.resmgmt.doc/GUID-9044A2BA-D4E5-4221-87F4-0B1C8612B748.html</a></p>]]></content>
      
      
      <categories>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ</title>
      <link href="/2024/05/28/cloudfaler%E9%83%A8%E7%BD%B2github%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E5%8A%A0%E9%80%9F/"/>
      <url>/2024/05/28/cloudfaler%E9%83%A8%E7%BD%B2github%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E5%8A%A0%E9%80%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ"><a href="#cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ" class="headerlink" title="cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ"></a>cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ</h1><p>é¡¹ç›®æ‰˜ç®¡åœ°å€ï¼š<a href="https://github.com/hunshcn/gh-proxy">https://github.com/hunshcn/gh-proxy</a></p><p>æ„å»º: åªéœ€è¦å¤åˆ¶ä¸‹æ–¹jsä»£ç åˆ°cloudflaer  workersä¸­ä¿å­˜éƒ¨ç½²å³å¯ å»ºè®®ç»‘å®šåŸŸå</p><p>cloudflaer workersåœ°å€ï¼š</p><p><a href="https://dash.cloudflare.com/65b0f21580ba74305f1bdcbc6d30210c/workers-and-pages">https://dash.cloudflare.com/65b0f21580ba74305f1bdcbc6d30210c/workers-and-pages</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * static files (404.html, sw.js, conf.js)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ASSET_URL</span> = <span class="string">&#x27;https://hunshcn.github.io/gh-proxy/&#x27;</span></span><br><span class="line"><span class="comment">// å‰ç¼€ï¼Œå¦‚æœè‡ªå®šä¹‰è·¯ç”±ä¸ºexample.com/gh/*ï¼Œå°†PREFIXæ”¹ä¸º &#x27;/gh/&#x27;ï¼Œæ³¨æ„ï¼Œå°‘ä¸€ä¸ªæ éƒ½ä¼šé”™ï¼</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PREFIX</span> = <span class="string">&#x27;/&#x27;</span></span><br><span class="line"><span class="comment">// åˆ†æ”¯æ–‡ä»¶ä½¿ç”¨jsDelivré•œåƒçš„å¼€å…³ï¼Œ0ä¸ºå…³é—­ï¼Œé»˜è®¤å…³é—­</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Config</span> = &#123;</span><br><span class="line">    <span class="attr">jsdelivr</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> whiteList = [] <span class="comment">// ç™½åå•ï¼Œè·¯å¾„é‡Œé¢æœ‰åŒ…å«å­—ç¬¦çš„æ‰ä¼šé€šè¿‡ï¼Œe.g. [&#x27;/username/&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">ResponseInit</span>&#125; */</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PREFLIGHT_INIT</span> = &#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">204</span>,</span><br><span class="line">    <span class="attr">headers</span>: <span class="keyword">new</span> <span class="title class_">Headers</span>(&#123;</span><br><span class="line">        <span class="string">&#x27;access-control-allow-origin&#x27;</span>: <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;access-control-allow-methods&#x27;</span>: <span class="string">&#x27;GET,POST,PUT,PATCH,TRACE,DELETE,HEAD,OPTIONS&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;access-control-max-age&#x27;</span>: <span class="string">&#x27;1728000&#x27;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> exp1 = <span class="regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:releases|archive)\/.*$/i</span></span><br><span class="line"><span class="keyword">const</span> exp2 = <span class="regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:blob|raw)\/.*$/i</span></span><br><span class="line"><span class="keyword">const</span> exp3 = <span class="regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:info|git-).*$/i</span></span><br><span class="line"><span class="keyword">const</span> exp4 = <span class="regexp">/^(?:https?:\/\/)?raw\.(?:githubusercontent|github)\.com\/.+?\/.+?\/.+?\/.+$/i</span></span><br><span class="line"><span class="keyword">const</span> exp5 = <span class="regexp">/^(?:https?:\/\/)?gist\.(?:githubusercontent|github)\.com\/.+?\/.+?\/.+$/i</span></span><br><span class="line"><span class="keyword">const</span> exp6 = <span class="regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/tags.*$/i</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">any</span>&#125; <span class="variable">body</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; <span class="variable">status</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object&lt;string, string&gt;</span>&#125; <span class="variable">headers</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">makeRes</span>(<span class="params">body, status = <span class="number">200</span>, headers = &#123;&#125;</span>) &#123;</span><br><span class="line">    headers[<span class="string">&#x27;access-control-allow-origin&#x27;</span>] = <span class="string">&#x27;*&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(body, &#123;status, headers&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">urlStr</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">newUrl</span>(<span class="params">urlStr</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">URL</span>(urlStr)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">addEventListener</span>(<span class="string">&#x27;fetch&#x27;</span>, <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> ret = <span class="title function_">fetchHandler</span>(e)</span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="title function_">makeRes</span>(<span class="string">&#x27;cfworker error:\n&#x27;</span> + err.<span class="property">stack</span>, <span class="number">502</span>))</span><br><span class="line">    e.<span class="title function_">respondWith</span>(ret)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkUrl</span>(<span class="params">u</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> [exp1, exp2, exp3, exp4, exp5, exp6]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (u.<span class="title function_">search</span>(i) === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">FetchEvent</span>&#125; <span class="variable">e</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchHandler</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> req = e.<span class="property">request</span></span><br><span class="line">    <span class="keyword">const</span> urlStr = req.<span class="property">url</span></span><br><span class="line">    <span class="keyword">const</span> urlObj = <span class="keyword">new</span> <span class="title function_">URL</span>(urlStr)</span><br><span class="line">    <span class="keyword">let</span> path = urlObj.<span class="property">searchParams</span>.<span class="title function_">get</span>(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (path) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Response</span>.<span class="title function_">redirect</span>(<span class="string">&#x27;https://&#x27;</span> + urlObj.<span class="property">host</span> + <span class="variable constant_">PREFIX</span> + path, <span class="number">301</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// cfworker ä¼šæŠŠè·¯å¾„ä¸­çš„ `//` åˆå¹¶æˆ `/`</span></span><br><span class="line">    path = urlObj.<span class="property">href</span>.<span class="title function_">substr</span>(urlObj.<span class="property">origin</span>.<span class="property">length</span> + <span class="variable constant_">PREFIX</span>.<span class="property">length</span>).<span class="title function_">replace</span>(<span class="regexp">/^https?:\/+/</span>, <span class="string">&#x27;https://&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (path.<span class="title function_">search</span>(exp1) === <span class="number">0</span> || path.<span class="title function_">search</span>(exp5) === <span class="number">0</span> || path.<span class="title function_">search</span>(exp6) === <span class="number">0</span> || path.<span class="title function_">search</span>(exp3) === <span class="number">0</span> || path.<span class="title function_">search</span>(exp4) === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">httpHandler</span>(req, path)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (path.<span class="title function_">search</span>(exp2) === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Config</span>.<span class="property">jsdelivr</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> newUrl = path.<span class="title function_">replace</span>(<span class="string">&#x27;/blob/&#x27;</span>, <span class="string">&#x27;@&#x27;</span>).<span class="title function_">replace</span>(<span class="regexp">/^(?:https?:\/\/)?github\.com/</span>, <span class="string">&#x27;https://cdn.jsdelivr.net/gh&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Response</span>.<span class="title function_">redirect</span>(newUrl, <span class="number">302</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            path = path.<span class="title function_">replace</span>(<span class="string">&#x27;/blob/&#x27;</span>, <span class="string">&#x27;/raw/&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">httpHandler</span>(req, path)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (path.<span class="title function_">search</span>(exp4) === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> newUrl = path.<span class="title function_">replace</span>(<span class="regexp">/(?&lt;=com\/.+?\/.+?)\/(.+?\/)/</span>, <span class="string">&#x27;@$1&#x27;</span>).<span class="title function_">replace</span>(<span class="regexp">/^(?:https?:\/\/)?raw\.(?:githubusercontent|github)\.com/</span>, <span class="string">&#x27;https://cdn.jsdelivr.net/gh&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Response</span>.<span class="title function_">redirect</span>(newUrl, <span class="number">302</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="variable constant_">ASSET_URL</span> + path)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Request</span>&#125; <span class="variable">req</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">pathname</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">httpHandler</span>(<span class="params">req, pathname</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> reqHdrRaw = req.<span class="property">headers</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// preflight</span></span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&#x27;OPTIONS&#x27;</span> &amp;&amp;</span><br><span class="line">        reqHdrRaw.<span class="title function_">has</span>(<span class="string">&#x27;access-control-request-headers&#x27;</span>)</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="literal">null</span>, <span class="variable constant_">PREFLIGHT_INIT</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> reqHdrNew = <span class="keyword">new</span> <span class="title class_">Headers</span>(reqHdrRaw)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> urlStr = pathname</span><br><span class="line">    <span class="keyword">let</span> flag = !<span class="title class_">Boolean</span>(whiteList.<span class="property">length</span>)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> whiteList) &#123;</span><br><span class="line">        <span class="keyword">if</span> (urlStr.<span class="title function_">includes</span>(i)) &#123;</span><br><span class="line">            flag = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&quot;blocked&quot;</span>, &#123;<span class="attr">status</span>: <span class="number">403</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (urlStr.<span class="title function_">search</span>(<span class="regexp">/^https?:\/\//</span>) !== <span class="number">0</span>) &#123;</span><br><span class="line">        urlStr = <span class="string">&#x27;https://&#x27;</span> + urlStr</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> urlObj = <span class="title function_">newUrl</span>(urlStr)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">RequestInit</span>&#125; */</span></span><br><span class="line">    <span class="keyword">const</span> reqInit = &#123;</span><br><span class="line">        <span class="attr">method</span>: req.<span class="property">method</span>,</span><br><span class="line">        <span class="attr">headers</span>: reqHdrNew,</span><br><span class="line">        <span class="attr">redirect</span>: <span class="string">&#x27;manual&#x27;</span>,</span><br><span class="line">        <span class="attr">body</span>: req.<span class="property">body</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">proxy</span>(urlObj, reqInit)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">URL</span>&#125; <span class="variable">urlObj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">RequestInit</span>&#125; <span class="variable">reqInit</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">proxy</span>(<span class="params">urlObj, reqInit</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(urlObj.<span class="property">href</span>, reqInit)</span><br><span class="line">    <span class="keyword">const</span> resHdrOld = res.<span class="property">headers</span></span><br><span class="line">    <span class="keyword">const</span> resHdrNew = <span class="keyword">new</span> <span class="title class_">Headers</span>(resHdrOld)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> status = res.<span class="property">status</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (resHdrNew.<span class="title function_">has</span>(<span class="string">&#x27;location&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">let</span> _location = resHdrNew.<span class="title function_">get</span>(<span class="string">&#x27;location&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">checkUrl</span>(_location))</span><br><span class="line">            resHdrNew.<span class="title function_">set</span>(<span class="string">&#x27;location&#x27;</span>, <span class="variable constant_">PREFIX</span> + _location)</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            reqInit.<span class="property">redirect</span> = <span class="string">&#x27;follow&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">proxy</span>(<span class="title function_">newUrl</span>(_location), reqInit)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    resHdrNew.<span class="title function_">set</span>(<span class="string">&#x27;access-control-expose-headers&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">    resHdrNew.<span class="title function_">set</span>(<span class="string">&#x27;access-control-allow-origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    resHdrNew.<span class="title function_">delete</span>(<span class="string">&#x27;content-security-policy&#x27;</span>)</span><br><span class="line">    resHdrNew.<span class="title function_">delete</span>(<span class="string">&#x27;content-security-policy-report-only&#x27;</span>)</span><br><span class="line">    resHdrNew.<span class="title function_">delete</span>(<span class="string">&#x27;clear-site-data&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(res.<span class="property">body</span>, &#123;</span><br><span class="line">        status,</span><br><span class="line">        <span class="attr">headers</span>: resHdrNew,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²</title>
      <link href="/2024/05/24/spug%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/05/24/spug%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²"><a href="#spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²" class="headerlink" title="spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²"></a>spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²</h2><blockquote><p>å¼€æºä¼ä¸šå®˜ç½‘ï¼š<a href="https://www.spug.cc/">https://www.spug.cc</a></p></blockquote><p>docker-composeéƒ¨ç½²</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">spug-db</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">--port</span> <span class="number">3306</span> <span class="string">--character-set-server=utf8mb4</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/data/spug/mysql:/var/lib/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_USER=spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_PASSWORD=spug.cc</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=spug.cc</span></span><br><span class="line">  <span class="attr">spug:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:spug-service</span> </span><br><span class="line">    <span class="comment">#openspug/spug-service</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">spug</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/data/spug/service:/data/spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/data/spug/repos:/data/repos</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="comment"># å¦‚æœ80ç«¯å£è¢«å ç”¨å¯æ›¿æ¢ä¸ºå…¶ä»–ç«¯å£ï¼Œä¾‹å¦‚: - &quot;8000:80&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_USER=spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_PASSWORD=spug.cc</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_HOST=db</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_PORT=3306</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db</span></span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–ç™»å½•ç®¡ç†å‘˜ç”¨æˆ·,ä»¥ä¸‹æ“ä½œä¼šåˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸º <code>admin</code> å¯†ç ä¸º <code>test123</code> çš„ç®¡ç†å‘˜è´¦æˆ·ï¼Œå¯è‡ªè¡Œæ›¿æ¢ç®¡ç†å‘˜è´¦æˆ·/å¯†ç ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec spug init_spug admin test123</span><br></pre></td></tr></table></figure><p>ç™»å½•ï¼š<a href="http://localhost/">http://localhost</a></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘é¡µæ·»åŠ  Live2D çœ‹æ¿å¨˜</title>
      <link href="/2024/05/21/%E7%BD%91%E9%A1%B5%E6%B7%BB%E5%8A%A0%20Live2D%20%E7%9C%8B%E6%9D%BF%E5%A8%98/"/>
      <url>/2024/05/21/%E7%BD%91%E9%A1%B5%E6%B7%BB%E5%8A%A0%20Live2D%20%E7%9C%8B%E6%9D%BF%E5%A8%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç½‘é¡µæ·»åŠ -Live2D-çœ‹æ¿å¨˜"><a href="#ç½‘é¡µæ·»åŠ -Live2D-çœ‹æ¿å¨˜" class="headerlink" title="ç½‘é¡µæ·»åŠ  Live2D çœ‹æ¿å¨˜"></a>ç½‘é¡µæ·»åŠ  Live2D çœ‹æ¿å¨˜</h1><p>å‚è€ƒ/è½¬è½½å¤„ï¼š</p><p><a href="https://www.fghrsh.net/post/123.html">https://www.fghrsh.net/post/123.html</a><br><a href="https://github.com/fghrsh/live2d/_demo">https://github.com/fghrsh/live2d\_demo</a><br><a href="https://www.cnblogs.com/goodmemoryblog/p/14279625.html">https://www.cnblogs.com/goodmemoryblog/p/14279625.html</a><br><a href="https://www.cnblogs.com/yjlaugus/p/8724881.html#/c/subject/p/8724881.html">https://www.cnblogs.com/yjlaugus/p/8724881.html#/c/subject/p/8724881.html</a><br><a href="https://www.cnblogs.com/Lantxy/p/13112000.html">https://www.cnblogs.com/Lantxy/p/13112000.html</a></p><p>æœ¬æ–‡è½¬è½½é“¾æ¥ï¼š<a href="https://www.cnblogs.com/eve-d/p/15683541.html">ç½‘é¡µæ·»åŠ  Live2D çœ‹æ¿å¨˜ï¼ˆèœé¸Ÿçº§è¯¦ç»†æ•™ç¨‹ï¼‰ - å¦–å¦–æœªåˆ - åšå®¢å›­ (cnblogs.com)</a></p><p>Live2Då¼€æºé¡¹ç›®åœ°å€ï¼š</p><p><a href="https://github.com/xiazeyu/live2d-widget-models">https://github.com/xiazeyu/live2d-widget-models</a><br><a href="https://github.com/GEGEWU-CLOUD/live2d-widget-models">https://github.com/GEGEWU-CLOUD/live2d-widget-models</a></p><p>L2Dwidget.min.js å­˜äº:</p><p><a href="https://drive.wn-apple-teawine.fun/api/raw/?path=/public-tools/Live2D/%E9%80%9A%E7%94%A8js/L2Dwidget.min.js">https://drive.wn-apple-teawine.fun/api/raw/?path=/public-tools/Live2D/é€šç”¨js/L2Dwidget.min.js</a></p><p>è®°å½•è‡ªå·±å­¦ä¹ æ“ä½œçš„è¿‡ç¨‹ï¼š<br>çœ‹ç€åˆ«äººåšå®¢ä¸»é¡µçš„çœ‹æ¿å¨˜å¥½èŒå¥½è´´å¿ƒï¼Œè‡ªå·±ä¹Ÿæƒ³å¼„ä¸€ä¸ªå•Šï¼Œæ€ä¹ˆåŠï¼Œä¸ä¼šå•Šã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å½“ã€å½“ã€å½“ï¼Œæœ¬èœé¸Ÿå°†äº²è‡ªå®è·µï¼Œå¼„ä¸€ä¸ªï¼Œæ­¤å¤„è®°å½•è‡ªå·±çš„å­¦ä¹ å®è·µè¿‡ç¨‹ï¼Œä¹Ÿä¾›å¤§å®¶å‚è€ƒã€‚</p><h2 id="ä¸€ã€åŸºæœ¬å·¥ä½œ"><a href="#ä¸€ã€åŸºæœ¬å·¥ä½œ" class="headerlink" title="ä¸€ã€åŸºæœ¬å·¥ä½œ"></a>ä¸€ã€åŸºæœ¬å·¥ä½œ</h2><h3 id="1ã€è¦è‡ªå®šä¹‰åšå®¢ï¼Œé¦–å…ˆç™»å½•è‡ªå·±çš„è´¦å·ï¼Œåœ¨è‡ªå·±åšå®¢ä¸»é¡µæ‰¾åˆ°ç®¡ç†ï¼Œç‚¹å‡»è®¾ç½®"><a href="#1ã€è¦è‡ªå®šä¹‰åšå®¢ï¼Œé¦–å…ˆç™»å½•è‡ªå·±çš„è´¦å·ï¼Œåœ¨è‡ªå·±åšå®¢ä¸»é¡µæ‰¾åˆ°ç®¡ç†ï¼Œç‚¹å‡»è®¾ç½®" class="headerlink" title="1ã€è¦è‡ªå®šä¹‰åšå®¢ï¼Œé¦–å…ˆç™»å½•è‡ªå·±çš„è´¦å·ï¼Œåœ¨è‡ªå·±åšå®¢ä¸»é¡µæ‰¾åˆ°ç®¡ç†ï¼Œç‚¹å‡»è®¾ç½®"></a>1ã€è¦è‡ªå®šä¹‰åšå®¢ï¼Œé¦–å…ˆç™»å½•è‡ªå·±çš„è´¦å·ï¼Œåœ¨è‡ªå·±åšå®¢ä¸»é¡µæ‰¾åˆ°ç®¡ç†ï¼Œç‚¹å‡»è®¾ç½®</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e77040f256eadd57f3446ab8d6e60d16.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e77040f256eadd57f3446ab8d6e60d16.png"></p><h3 id="2ã€ç‚¹å‡»è®¾ç½®åï¼Œè¿›å…¥åˆ°åŸºæœ¬è®¾ç½®é¡µé¢ï¼Œçœ‹æ˜¯å¦æœ‰jsæƒé™ï¼Œå¦‚æœæ²¡æœ‰å°±å…ˆç”³è¯·"><a href="#2ã€ç‚¹å‡»è®¾ç½®åï¼Œè¿›å…¥åˆ°åŸºæœ¬è®¾ç½®é¡µé¢ï¼Œçœ‹æ˜¯å¦æœ‰jsæƒé™ï¼Œå¦‚æœæ²¡æœ‰å°±å…ˆç”³è¯·" class="headerlink" title="2ã€ç‚¹å‡»è®¾ç½®åï¼Œè¿›å…¥åˆ°åŸºæœ¬è®¾ç½®é¡µé¢ï¼Œçœ‹æ˜¯å¦æœ‰jsæƒé™ï¼Œå¦‚æœæ²¡æœ‰å°±å…ˆç”³è¯·"></a>2ã€ç‚¹å‡»è®¾ç½®åï¼Œè¿›å…¥åˆ°åŸºæœ¬è®¾ç½®é¡µé¢ï¼Œçœ‹æ˜¯å¦æœ‰jsæƒé™ï¼Œå¦‚æœæ²¡æœ‰å°±å…ˆç”³è¯·</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_048d8db540e75eec0fd0bbf8e94904b3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_048d8db540e75eec0fd0bbf8e94904b3.png">âš ï¸ï¼šå·²ç»æœ‰äº†jsæƒé™ï¼Œä¸‹é¢çš„æ“ä½œæ‰æœ‰æ•ˆ</p><h2 id="äºŒã€æ·»åŠ çœ‹æ¿å¨˜æ“ä½œ"><a href="#äºŒã€æ·»åŠ çœ‹æ¿å¨˜æ“ä½œ" class="headerlink" title="äºŒã€æ·»åŠ çœ‹æ¿å¨˜æ“ä½œ"></a>äºŒã€æ·»åŠ çœ‹æ¿å¨˜æ“ä½œ</h2><h3 id="1ã€æœ€æœ€æœ€ç²¾ç®€ç‰ˆï¼š"><a href="#1ã€æœ€æœ€æœ€ç²¾ç®€ç‰ˆï¼š" class="headerlink" title="1ã€æœ€æœ€æœ€ç²¾ç®€ç‰ˆï¼š"></a>1ã€æœ€æœ€æœ€ç²¾ç®€ç‰ˆï¼š</h3><p>åœ¨åšå®¢ä¾§è¾¹æ å…¬å‘Šå¤„æ·»åŠ å¦‚ä¸‹ä»£ç </p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_574d813c1585364829bf47ae76ffda46.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_574d813c1585364829bf47ae76ffda46.png"></p><p>ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç½‘é¡µä¾§è¾¹æ·»åŠ çŒ«å’ª --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://files.cnblogs.com/files/liuzhou1/L2Dwidget.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  L2Dwidget.<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;model&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">jsonPath</span>: <span class="string">&quot;https://unpkg.com/live2d-widget-model-tororo@1.0.5/assets/tororo.model.json&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;scale&quot;</span>: <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;display&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;position&quot;</span>: <span class="string">&quot;right&quot;</span>, <span class="comment">//æ¨¡å‹çš„è¡¨ç°ä½ç½®</span></span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;width&quot;</span>: <span class="number">150</span>, <span class="comment">//æ¨¡å‹çš„å®½åº¦</span></span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;height&quot;</span>: <span class="number">300</span>, <span class="comment">//æ¨¡å‹çš„é«˜åº¦</span></span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;hOffset&quot;</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;vOffset&quot;</span>: -<span class="number">20</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;mobile&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;show&quot;</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;scale&quot;</span>: <span class="number">0.5</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;react&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;opacityDefault&quot;</span>: <span class="number">0.7</span>, <span class="comment">//æ¨¡å‹é»˜è®¤é€æ˜åº¦</span></span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;opacityOnHover&quot;</span>: <span class="number">0.2</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ç½‘é¡µä¾§è¾¹æ·»åŠ çŒ«å’ª --&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€åä¿å­˜ï¼Œå³å¯æˆåŠŸ</p><p>ä¸€åªå¯çˆ±çš„å°çŒ«å’ªå°±æœ‰å•¦</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_5ec4c415016c2d8230473f35c8b9898e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_5ec4c415016c2d8230473f35c8b9898e.png"></p><p>å¦‚æœæƒ³æ¢å…¶ä»–æ¨¡ç‰ˆï¼Œå¯ä»¥ä¿®æ”¹ <code>jsonPath</code> çš„è·¯å¾„ï¼Œå¯é€‰çš„æ¨¡å‹ï¼ˆä»æ­¤å¤„æ•´ç†æ¥ï¼š<a href="https://www.cnblogs.com/goodmemoryblog/p/14279625.html%EF%BC%89%E6%9C%89%EF%BC%9A">https://www.cnblogs.com/goodmemoryblog/p/14279625.htmlï¼‰æœ‰ï¼š</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//é»‘çŒ«å’ªï¼šhttps://unpkg.com/live2d-widget-model-hijiki@1.0.5/assets/hijiki.model.json</span><br><span class="line">//ç™½çŒ«å’ªï¼šhttps://unpkg.com/live2d-widget-model-tororo@1.0.5/assets/tororo.model.json</span><br><span class="line">//èŒå¨˜ï¼šhttps://unpkg.com/live2d-widget-model-shizuku@1.0.5/assets/shizuku.model.json</span><br><span class="line">//ç‹—ç‹—ï¼šhttps://unpkg.com/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json</span><br><span class="line">//èŒå¦¹1å·ï¼šhttps://unpkg.com/live2d-widget-model-z16@1.0.5/assets/z16.model.json</span><br><span class="line">//èŒå¦¹2å·ï¼šhttps://unpkg.com/live2d-widget-model-koharu@1.0.5/assets/koharu.model.json</span><br><span class="line">//èŒå¦¹3å·ï¼šhttps://unpkg.com/live2d-widget-model-hibiki@1.0.5/assets/hibiki.model.json</span><br><span class="line">//å¦¹å­4å·ï¼šhttps://unpkg.com/live2d-widget-model-izumi@1.0.5/assets/izumi.model.json</span><br><span class="line">//å¦¹å­5å·ï¼šhttps://unpkg.com/live2d-widget-model-miku@1.0.5/assets/miku.model.json</span><br><span class="line">//6å·ï¼šhttps://unpkg.com/live2d-widget-model-nico@1.0.5/assets/nico.model.json</span><br><span class="line">//7å·ï¼šhttps://unpkg.com/live2d-widget-model-ni-j@1.0.5/assets/ni-j.model.json</span><br><span class="line">//8å·ï¼šhttps://unpkg.com/live2d-widget-model-nipsilon@1.0.5/assets/nipsilon.model.json</span><br><span class="line">//9å·ï¼šhttps://unpkg.com/live2d-widget-model-nito@1.0.5/assets/nito.model.json</span><br><span class="line">//10å·ï¼šhttps://unpkg.com/live2d-widget-model-tsumiki@1.0.5/assets/tsumiki.model.json</span><br><span class="line">//11å·ï¼šhttps://unpkg.com/live2d-widget-model-unitychan@1.0.5/assets/unitychan.model.json</span><br><span class="line">//å¸…å“¥1å·ï¼šhttps://unpkg.com/live2d-widget-model-chitose@1.0.5/assets/chitose.model.json</span><br><span class="line">//å¸…å“¥2å·ï¼šhttps://unpkg.com/live2d-widget-model-haruto@1.0.5/assets/haruto.model.json</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2ã€æ·»åŠ å¯ä»¥è¯´è¯çš„çœ‹æ¿å¨˜ï¼Œæ“ä½œå¦‚ä¸‹ï¼š"><a href="#2ã€æ·»åŠ å¯ä»¥è¯´è¯çš„çœ‹æ¿å¨˜ï¼Œæ“ä½œå¦‚ä¸‹ï¼š" class="headerlink" title="2ã€æ·»åŠ å¯ä»¥è¯´è¯çš„çœ‹æ¿å¨˜ï¼Œæ“ä½œå¦‚ä¸‹ï¼š"></a>2ã€æ·»åŠ å¯ä»¥è¯´è¯çš„çœ‹æ¿å¨˜ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</h3><p>å‚è€ƒåœ°å€ï¼š<a href="https://www.cnblogs.com/Lantxy/p/13112000.html%E3%80%82">https://www.cnblogs.com/Lantxy/p/13112000.htmlã€‚</a> æ„Ÿè°¢ğŸ™åšä¸»</p><p>æˆå“ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8bdf0fcd97ff7dbc79a468a55689bbf5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8bdf0fcd97ff7dbc79a468a55689bbf5.png"></p><p>1ï¼‰åœ¨åŸºæœ¬å·¥ä½œçš„åŸºç¡€ä¸Šï¼ˆåœ¨ç®¡ç†=ã€‹è®¾ç½®é¡µé¢ï¼‰ï¼Œæ‰¾åˆ°é¡µé¢å®šåˆ¶CSSä»£ç ï¼Œå°†ä»£ç æ·»åŠ è¿›å»ï¼Œä¸ç¦ç”¨æ¨¡ç‰ˆé»˜è®¤CSSï¼Œä¸ç„¶é¡µé¢çš„åŸºç¡€ç»“æ„ä¼šä¹±ï¼Œå½“ç„¶ä½ å¯ä»¥è‡ªå·±å»å†™/æ¢æ ·å¼ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_dff8d272ae66a655129e0cefc10d7c8a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_dff8d272ae66a655129e0cefc10d7c8a.png"></p><p>CSSä»£ç ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">*&#123;</span><br><span class="line"><span class="attribute">transition</span>: all <span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#home</span> &#123;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">80%</span>;<span class="comment">/*åŸå§‹65*/</span></span><br><span class="line"><span class="attribute">min-width</span>: <span class="number">980px</span>;<span class="comment">/*é¡µé¢é¡¶éƒ¨çš„å®½åº¦*/</span></span><br><span class="line">&quot;&gt;rgba(<span class="number">245</span>, <span class="number">245</span>, <span class="number">245</span>, <span class="number">0.7</span>);</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">50px</span>;</span><br><span class="line"><span class="attribute">margin-bottom</span>: <span class="number">50px</span>;</span><br><span class="line"><span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">0.3</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line"><span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&quot;http://ww4.sinaimg.cn/large/637d0877gw1exlma5gj0wj21hc0u04p6.jpg&quot;</span>);</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">12</span>, <span class="number">100</span>, <span class="number">129</span>, <span class="number">1</span>) <span class="built_in">url</span>(<span class="string">&#x27;http://images.cnblogs.com/cnblogs_com/Penn000/1013849/o_123.jpg&#x27;</span>) fixed no-repeat;</span><br><span class="line"><span class="attribute">background-position</span>: <span class="number">50%</span> <span class="number">5%</span>;</span><br><span class="line"><span class="attribute">background-size</span>: cover;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#navList</span> <span class="selector-tag">li</span>&#123;</span><br><span class="line"><span class="attribute">cursor</span>: pointer;</span><br><span class="line"><span class="attribute">transition</span>: all <span class="number">0.2s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#navList</span> <span class="selector-tag">li</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.5</span>) <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line"><span class="attribute">color</span>:<span class="number">#FF0</span>;</span><br><span class="line"><span class="attribute">opacity</span>:<span class="number">0.5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#blogTitle</span> &#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100px</span>; <span class="comment">/*é«˜åº¦*/</span></span><br><span class="line"><span class="attribute">clear</span>: both;</span><br><span class="line">&quot;&gt;rgba(<span class="number">245</span>, <span class="number">245</span>, <span class="number">245</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#blogTitle</span> <span class="selector-tag">h1</span> &#123;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">36px</span>;</span><br><span class="line"><span class="attribute">font-weight</span>: bold;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">1.8em</span>;<span class="comment">/*åŸå§‹ 1.6em*/</span></span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">10px</span>;<span class="comment">/*åŸå§‹ 15px */</span></span><br><span class="line"><span class="attribute">color</span>: <span class="number">#548B54</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#blogTitle</span> <span class="selector-tag">h2</span> &#123;</span><br><span class="line"><span class="attribute">font-weight</span>: normal;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">17px</span>;<span class="comment">/*åŸå§‹ 16px ï¼›font-size: 1.0rem;*/</span></span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">1.8</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#111</span>;</span><br><span class="line"><span class="attribute">font-weight</span>: bold;</span><br><span class="line"><span class="attribute">text-align</span>: right;</span><br><span class="line"><span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#navigator</span>&#123;</span><br><span class="line">&quot;&gt;rgba(<span class="number">33</span>, <span class="number">160</span>, <span class="number">139</span>, <span class="number">0.9</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#navList</span> <span class="selector-tag">a</span><span class="selector-pseudo">:link</span>, <span class="selector-id">#navList</span> <span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>, <span class="selector-id">#navList</span> <span class="selector-tag">a</span><span class="selector-pseudo">:active</span>&#123;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#eee</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line"><span class="attribute">font-weight</span>: bold;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.blogStats</span>&#123;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#eee</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.postTitle</span> &#123;</span><br><span class="line"><span class="attribute">border-left</span>: <span class="number">8px</span> solid <span class="built_in">rgba</span>(<span class="number">33</span>, <span class="number">160</span>, <span class="number">139</span>, <span class="number">0.68</span>);</span><br><span class="line"><span class="attribute">margin-left</span>: <span class="number">10px</span>;</span><br><span class="line"><span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line"><span class="attribute">float</span>: right;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.postTitle</span> <span class="selector-tag">a</span><span class="selector-pseudo">:link</span>, <span class="selector-class">.postTitle</span> <span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>, <span class="selector-class">.postTitle</span> <span class="selector-tag">a</span><span class="selector-pseudo">:active</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#21759b</span>;</span><br><span class="line"><span class="attribute">transition</span>: all <span class="number">0.4s</span> linear <span class="number">0s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.postTitle</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line"><span class="attribute">margin-left</span>: <span class="number">30px</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#0f3647</span>;</span><br><span class="line"><span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.postCon</span> &#123;</span><br><span class="line"><span class="attribute">float</span>: right;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">1.5em</span>;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">clear</span>: both;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.day</span> <span class="selector-class">.postTitle</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line"><span class="attribute">padding-left</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.day</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*æ–‡ç« é™„åŠ ä¿¡æ¯*/</span></span><br><span class="line"><span class="selector-class">.postDesc</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">images/posted_time.png</span>) no-repeat <span class="number">0</span> <span class="number">1px</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#757575</span>;</span><br><span class="line"><span class="attribute">float</span>: left;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">clear</span>: both;</span><br><span class="line"><span class="attribute">text-align</span>: left;</span><br><span class="line"><span class="attribute">font-family</span>: <span class="string">&quot;å¾®è½¯é›…é»‘&quot;</span> , <span class="string">&quot;å®‹ä½“&quot;</span> , <span class="string">&quot;é»‘ä½“&quot;</span> ,Arial;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line"><span class="attribute">padding-right</span>: <span class="number">20px</span>;<span class="comment">/*5px padding-left: 90px;posted å‘è¡¨æ—¶é—´å·¦è¾¹è·ç¦»*/</span></span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">1.8</span>;</span><br><span class="line"><span class="attribute">padding-bottom</span>: <span class="number">35px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.newsItem</span>, <span class="selector-class">.catListEssay</span>, <span class="selector-class">.catListLink</span>, <span class="selector-class">.catListNoteBook</span>, <span class="selector-class">.catListTag</span>, <span class="selector-class">.catListPostCategory</span>,</span><br><span class="line"><span class="selector-class">.catListPostArchive</span>, <span class="selector-class">.catListImageCategory</span>, <span class="selector-class">.catListArticleArchive</span>, <span class="selector-class">.catListView</span>,</span><br><span class="line"><span class="selector-class">.catListFeedback</span>, <span class="selector-class">.mySearch</span>, <span class="selector-class">.catListComment</span>, <span class="selector-class">.catListBlogRank</span>, <span class="selector-class">.catList</span>, <span class="selector-class">.catListArticleCategory</span> ,<span class="selector-id">#blog-calendar</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>);</span><br><span class="line"><span class="attribute">margin-bottom</span>: <span class="number">35px</span>;</span><br><span class="line"><span class="attribute">word-wrap</span>: break-word;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.CalTitle</span>&#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.catListTitle</span>&#123;</span><br><span class="line">&quot;&gt;rgba(<span class="number">33</span>, <span class="number">160</span>, <span class="number">139</span>, <span class="number">0.9</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#topics</span>&#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.c_ad_block</span>&#123;</span><br><span class="line"><span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#tbCommentBody</span>&#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#q</span>&#123;<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.CalNextPrev</span>&#123;<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);&#125;</span><br></pre></td></tr></table></figure><p>2ï¼‰åœ¨åšå®¢ä¾§è¾¹æ åŠ å…¥ï¼Œä¸‹é¢ä»£ç </p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1870159a9879f476f71cf451334326e8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1870159a9879f476f71cf451334326e8.png"></p><p>âš ï¸ï¼šå°†ä»£ç ä¸­çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/waifu.css&quot;</span>/&gt;</span><br><span class="line">&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css&quot;</span>/&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/live2d.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/waifu-tips.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æ¢æˆè‡ªå·±çš„é“¾æ¥åœ°å€ï¼Œæ­¥éª¤å¦‚ä¸‹</p><p>iã€å‚è€ƒä¸‹é¢åœ°å€ä¸‹è½½éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶</p><p>âš ï¸ï¼š<a href="https://www.cnblogs.com/Lantxy/p/13112000.html%EF%BC%8C%E5%80%9F%E7%94%A8%E5%8D%9A%E4%B8%BB%E7%9A%84%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80%EF%BC%8C%E6%84%9F%E8%B0%A2%F0%9F%99%8F">https://www.cnblogs.com/Lantxy/p/13112000.htmlï¼Œå€Ÿç”¨åšä¸»çš„ä¸‹è½½åœ°å€ï¼Œæ„Ÿè°¢ğŸ™</a></p><p>iiã€å°†4ä¸ªæ–‡ä»¶ä¸‹è½½å¥½ï¼Œåœ¨åšå®¢å›­çš„æ–‡ä»¶ä¸­ä¸Šä¼ ï¼Œç‚¹å‡»è¿›å»ï¼Œå¤åˆ¶ä¸Šé¢åœ°å€æ›¿æ¢ç›¸åº”ä½ç½®</p><p>ç‚¹å‡»æ–‡ä»¶ï¼š</p><p>é€‰æ‹©æ–‡ä»¶ä¸Šä¼ ï¼ŒæˆåŠŸåä¾¿æœ‰ä¸‹é¢å››ä¸ªæ–‡ä»¶ï¼Œç‚¹å‡»ä¸Šä¼ åçš„æ–‡ä»¶</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_99426f652dfc59f2251960920fe4fa99.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_99426f652dfc59f2251960920fe4fa99.png"></p><p>åœ¨è·³è½¬çš„é¡µé¢ï¼Œæ‹¿åˆ°è‡ªå·±çš„é“¾æ¥åœ°å€ï¼Œæ›¿æ¢ç›¸åº”çš„åœ°æ–¹ï¼Œå››ä¸ªæ–‡ä»¶æ­¥éª¤ä¸€æ ·</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1fc3cac4eea4ea295052a0b2c54d42fa.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1fc3cac4eea4ea295052a0b2c54d42fa.png"></p><p>æ·»åŠ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Live2D çœ‹æ¿å¨˜ v1.2 / Demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/waifu.css&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;h2&gt;&lt;a href=&quot;https://www.fghrsh.net/post/123.html&quot; style=&quot;color: #38A3DB&quot;&gt;Live2D çœ‹æ¿å¨˜ v1.2&lt;/a&gt; / Demo&lt;/h2&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;touxiangdiv&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;touxiang&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://pic.cnblogs.com/avatar/2063441/20200611132410.png&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;waifu&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;waifu-tips&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">&quot;live2d&quot;</span> <span class="attr">width</span>=<span class="string">&quot;280&quot;</span> <span class="attr">height</span>=<span class="string">&quot;250&quot;</span> <span class="attr">class</span>=<span class="string">&quot;live2d&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;waifu-tool&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;fui-chat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;fui-user&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;fui-cross&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/live2d.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/waifu-tips.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"><span class="title function_">initModel</span>(<span class="string">&quot;assets/&quot;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-id">#touxiang</span>&#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>:auto;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆå­˜é—®é¢˜ï¼Œè¿™ä¸ªèµ„æºçš„é“¾æ¥åœ°å€å‡ºäº†çš„ç‚¹é—®é¢˜å¯¼è‡´ï¼Œé¡µé¢çš„çœ‹æ¿å¨˜æ²¡åŠ è½½å‡ºæ¥</p><p>3ã€é«˜çº§ç‰ˆtodoã€‚ã€‚ã€‚</p><link rel="stylesheet" type="text/css" href="https://blog-static.cnblogs.com/files/eve-d/waifu.css"><link rel="stylesheet" type="text/css" href="https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css"><link rel="stylesheet" type="text/css" href="https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css"><link rel="stylesheet" type="text/css" href="https://blog-static.cnblogs.com/files/eve-d/waifu.css">]]></content>
      
      
      <categories>
          
          <category> Live2D </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Live2D </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜</title>
      <link href="/2024/05/19/linux%E5%AE%BF%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%9C%A8docker%E5%AE%B9%E5%99%A8%E4%B8%AD%E4%B8%8D%E6%89%A7%E8%A1%8C%E9%97%AE%E9%A2%98/"/>
      <url>/2024/05/19/linux%E5%AE%BF%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%9C%A8docker%E5%AE%B9%E5%99%A8%E4%B8%AD%E4%B8%8D%E6%89%A7%E8%A1%8C%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜"><a href="#linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜" class="headerlink" title="linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜"></a>linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜</h2><h3 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><p>å»æ‰äº¤äº’å¼æ‰§è¡Œ-ité€‰æ‹© å¯æ‰§è¡Œæ–‡ä»¶dockerç¼–å†™ä¸ºè·¯å¾„å³<code>/usr/bin/docker</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">10 * * * * /opt/maxkb/cp_logo_create_app_maxkb.sh </span><br><span class="line">0 9 * * * /usr/bin/docker <span class="built_in">exec</span> webstack_mysql bash /home/mysqlbak/webstack-dbbak.sh</span><br><span class="line">0 10 * * * /usr/bin/docker <span class="built_in">exec</span> confluse_mysql bash /home/db_bak_sh/confluence_dbbak.sh</span><br></pre></td></tr></table></figure><p>å¹¶å°†dockerå†…éƒ¨éœ€è¦å¤‡ä»½çš„ç›®å½•åŠè„šæœ¬å†…å®šä¹‰çš„ç›®å½• ä½¿ç”¨volumeæŒä¹…åŒ–åˆ°å®¿ä¸»æœº å³å¯ã€‚</p><p>å®é™…ä½¿ç”¨å‚è€ƒï¼š<a href="https://sunlight.zznnwn.cloudns.biz/2024/04/17/confluence%E9%83%A8%E7%BD%B2/?highlight=conf">couluenceå®¹å™¨ç‰ˆæ•°æ®åº“å¤‡ä»½</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç </title>
      <link href="/2024/05/16/confluence%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E5%A4%B1%E6%95%88%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/"/>
      <url>/2024/05/16/confluence%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E5%A4%B1%E6%95%88%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç "><a href="#confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç " class="headerlink" title="confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç "></a>confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç </h1><p><strong>wiki é‡ç½® admin ç”¨æˆ·å¯†ç </strong></p><p>åœ¨ /var/atlassian/application-data/confluence/confluence.cfg.xml æ–‡ä»¶ä¸­æŸ¥çœ‹ mysql  root ç”¨æˆ·çš„å¯†ç </p><p>é‡ç½® wiki admin ç”¨æˆ·å¯†ç </p><p>mysql&gt; use confluence</p><p>è·å– admin ç”¨æˆ· idï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> u.id, u.user_name, u.active <span class="keyword">from</span> cwd_user u</span><br><span class="line"><span class="keyword">join</span> cwd_membership m <span class="keyword">on</span> u.id<span class="operator">=</span>m.child_user_id <span class="keyword">join</span> cwd_group g <span class="keyword">on</span> m.parent_id<span class="operator">=</span>g.id <span class="keyword">join</span> cwd_directory d <span class="keyword">on</span> d.id<span class="operator">=</span>g.directory_id</span><br><span class="line"><span class="keyword">where</span> g.group_name <span class="operator">=</span> <span class="string">&#x27;confluence-administrators&#x27;</span> <span class="keyword">and</span> d.directory_name<span class="operator">=</span><span class="string">&#x27;Confluence Internal Directory&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°† admin ç”¨æˆ·å¯†ç é‡ç½®ä¸º admin</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> cwd_user <span class="keyword">set</span> credential <span class="operator">=</span></span><br><span class="line"><span class="string">&#x27;x61Ey612Kl2gpFL56FT9weDnpSo4AV8j8+qx2AuTHdRyY036xxzTTrw10Wq3+4qQyB+XURPWx1ONxp3Y3pB37A==&#x27;</span></span><br><span class="line"><span class="keyword">where</span> id<span class="operator">=</span>xxxxxx;</span><br></pre></td></tr></table></figure><p>æ³¨æ„æ­¤å¤„xxxxxx ä¸ºä¸Šä¸€æ­¥çš„ id</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨</title>
      <link href="/2024/05/15/%E9%83%A8%E7%BD%B2ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%B9%B6%E5%AF%B9%E6%8E%A5maxkb%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/05/15/%E9%83%A8%E7%BD%B2ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%B9%B6%E5%AF%B9%E6%8E%A5maxkb%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨"><a href="#éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨" class="headerlink" title="éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨"></a>éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨</h1><blockquote><p>githubæ‰˜ç®¡åœ°å€ï¼š</p><p><a href="https://github.com/ollama/ollama">ollama/ollama: Get up and running with Llama 3, Mistral, Gemma, and other large language models. (github.com)</a></p><p>æ¨¡å‹å®˜ç½‘ï¼š</p><p><a href="https://ollama.com/library/llama3">https://ollama.com/library/llama3</a></p><p>qwenæ¨¡å‹ä¸‹è½½åœ°å€ï¼š</p><p><a href="https://huggingface.co/Qwen/Qwen1.5-0.5B-Chat-GGUF/tree/main">https://huggingface.co/Qwen/Qwen1.5-0.5B-Chat-GGUF/tree/main</a></p><p>liama2ä¸‹è½½ï¼š<a href="https://llama-2.ai/download/">https://llama-2.ai/download/</a></p><p>liama3ä¸‹è½½ï¼š<a href="https://llama.meta.com/llama-downloads/">Download Llama (meta.com)</a></p><p><strong>Llama3-8B-Instructæ¨¡å‹ä¸‹è½½åœ°å€ï¼š</strong></p><p>é­”æ­ç¤¾åŒºï¼ˆå¢ƒå†…ï¼‰ï¼š<a href="https://caovan.com/go?_=48ce46a27aaHR0cHM6Ly9tb2RlbHNjb3BlLmNuL21vZGVscy9MTE0tUmVzZWFyY2gvTWV0YS1MbGFtYS0zLThCLUluc3RydWN0L2ZpbGVz">https://modelscope.cn/models/LLM-Research/Meta-Llama-3-8B-Instruct/files</a></p><p>huggingfaceï¼ˆå¢ƒå¤–ï¼‰ï¼š<a href="https://caovan.com/go?_=72db84b679aHR0cHM6Ly9odWdnaW5nZmFjZS5jby9tZXRhLWxsYW1hL01ldGEtTGxhbWEtMy04Qi1JbnN0cnVjdC90cmVlL21haW4=">https://huggingface.co/meta-llama/Meta-Llama-3-8B-Instruct/tree/main</a></p><p><a href="https://caovan.com/tag/603" title="LLaMA-Factory">LLaMA-Factory</a>é¡¹ç›®åœ°å€ï¼š<a href="https://caovan.com/go?_=8c0f2d3483aHR0cHM6Ly9naXRodWIuY29tL2hpeW91Z2EvTExhTUEtRmFjdG9yeQ==">https://github.com/hiyouga/LLaMA-Factory</a></p><p>llama2ä¸­æ–‡æ¨¡å‹å‚æ•°è¯¦æƒ…ï¼š<a href="https://ollama.com/library/llama2-chinese:7b">llama2-chinese:7b (ollama.com)</a></p><p><strong>Llama3æ¨¡å‹ä¸­æ–‡å¾®è°ƒç‰ˆä¸‹è½½åœ°å€ï¼ˆé“¾æ¥ä¸­æœ‰ä¸‹è½½åœ°å€ï¼‰</strong></p><p><a href="https://github.com/GEGEWU-CLOUD/Llama-Chinese">https://github.com/GEGEWU-CLOUD/Llama-Chinese</a></p><p>Llama 3çš„äº®ç‚¹å’Œç‰¹æ€§å¦‚ä¸‹ï¼š</p><p>åŸºäºè¶…è¿‡15T tokenè®­ç»ƒï¼Œå¤§å°ç›¸å½“äºLlama 2æ•°æ®é›†çš„7å€è¿˜å¤šï¼›<br>è®­ç»ƒæ•ˆç‡æ¯”Llama 2é«˜3å€ï¼›<br>æ”¯æŒ8Ké•¿æ–‡æœ¬ï¼Œæ”¹è¿›çš„tokenizerå…·æœ‰128K tokençš„è¯æ±‡é‡ï¼Œå¯å®ç°æ›´å¥½çš„æ€§èƒ½ï¼›<br>åœ¨å¤§é‡é‡è¦åŸºå‡†æµ‹è¯•ä¸­å‡å…·æœ‰æœ€å…ˆè¿›æ€§èƒ½ï¼›<br>å¢å¼ºæ¨ç†å’Œä»£ç èƒ½åŠ›ï¼›<br>å®‰å…¨æ€§æœ‰é‡å¤§çªç ´ï¼Œå¸¦æœ‰Llama Guard 2ã€Code Shield å’Œ CyberSec Eval 2çš„æ–°ç‰ˆä¿¡ä»»å’Œå®‰å…¨å·¥å…·ï¼Œè¿˜èƒ½æ¯”Llama 2æœ‰æ›´å¥½â€œé”™è¯¯æ‹’ç»è¡¨ç°â€ã€‚</p><p><strong>Ollamaæ˜¯ä»€ä¹ˆ?</strong><br>Olamaæ˜¯ä¸€ä¸ªå…ˆè¿›çš„AIå·¥å…·ï¼Œå®ƒå…è®¸ç”¨æˆ·åœ¨è‡ªå·±çš„ç”µè„‘ä¸Š(ç›®å‰æ”¯æŒmacOså’ŒLinuxï¼ŒWindowså³å°†æ¨å‡º)è½»æ¾è®¾ç½®å’Œè¿è¡Œå¤§å‹è¯­è¨€æ¨¡å‹(LLMs)ã€‚è¿™ä¸ªå·¥å…·çš„äº®ç‚¹åœ¨äºï¼Œå®ƒä¸ä»…æ”¯æŒè¿è¡Œå¦‚Lama 2è¿™æ ·çš„å¼ºå¤§è¯­è¨€æ¨¡å‹ï¼Œè¿˜å…è®¸ç”¨æˆ·è‡ªå®šä¹‰å’Œåˆ›å»ºè‡ªå·±çš„æ¨¡å‹ã€‚</p><p>Metaå‘å¸ƒäº†Llama 3æ¨¡å‹å¯ä½¿ç”¨ollamaéƒ¨ç½²ï¼Œå®˜æ–¹ä»‹ç»æ–‡æ¡£<a href="https://link.zhihu.com/?target=https://ai.meta.com/blog/meta-llama-3/">åœ¨è¿™</a>ã€‚æ€»ç»“ä¸€ä¸‹é‡ç‚¹å†…å®¹ï¼š</p><ol><li><p>æœ¬æ¬¡å…±å‘å¸ƒäº†Llama 8B, 70Bçš„æ¨¡å‹ï¼Œ70Bæ€§èƒ½è¶…è¶ŠGPT3.5ï¼›</p></li><li><p>é¢„å‘Šäº†æ­£åœ¨è®­ç»ƒä¸­çš„400B+æ¨¡å‹ï¼Œæ€§èƒ½è¿½èµ¶GPT4ï¼›</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_767b2d80d661dabc0a5cdffbfcceaf69.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_767b2d80d661dabc0a5cdffbfcceaf69.png"></p><p>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://zhuanlan.zhihu.com/p/693709600">Llama 3 ä½¿ç”¨æ–¹æ³•ä»¥åŠæ¨¡å‹ä¸‹è½½æ•™ç¨‹ - çŸ¥ä¹ (zhihu.com)</a></p></li></ol><p><strong>clone/ä¸‹è½½githubæºç </strong></p><p>åœ¨metaå…¬å¸ƒçš„githubç½‘é¡µ(<a href="https://link.zhihu.com/?target=https://github.com/meta-llama/llama3">https://<strong>github.com/meta-llama/l</strong>lama3</a>)ä¸­ï¼Œcloneæˆ–è€…ä¸‹è½½å¥½æºä»£ç ã€‚</p><p><strong>å…³äºåŸŸåæ— æ•ˆçš„è§£å†³æ–¹æ¡ˆ</strong></p><p><a href="https://bbs.fit2cloud.com/t/topic/4165/4">MaxKB å¯¹æ¥Ollamaæ¨¡å‹æ—¶ï¼Œæç¤º API åŸŸåä¸å¯ç”¨ - MaxKB - ç¤¾åŒºè®ºå› - FIT2CLOUD é£è‡´äº‘</a></p><p><strong>Ollamaä¸»è¦åŠŸèƒ½</strong></p><ul><li>æœ¬åœ°è¯­è¨€æ¨¡å‹æ‰§è¡Œ:Ollamaä½¿ç”¨æˆ·èƒ½å¤Ÿåœ¨æœ¬åœ°è¿è¡Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œæä¾›æ›´å¿«ã€æ›´é«˜æ•ˆçš„å¤„ç†èƒ½åŠ›ã€‚</li><li>Llama 2æ¨¡å‹:ç”¨æˆ·å¯ä»¥åˆ©ç”¨Lama 2è¯­è¨€æ¨¡å‹ï¼Œè¯¥æ¨¡å‹æä¾›å…ˆè¿›çš„è‡ªç„¶è¯­è¨€å¤„ç†èƒ½åŠ›ï¼Œé€‚ç”¨äºå¹¿æ³›çš„åº”ç”¨åœºæ™¯</li><li>æ¨¡å‹å®šåˆ¶:Ollamaå…è®¸ç”¨æˆ·æ ¹æ®ç‰¹å®šä»»åŠ¡å’Œéœ€æ±‚å®šåˆ¶å’Œåˆ›å»ºè‡ªå·±çš„è¯­è¨€å‹ã€‚</li><li>æ˜“äºè®¾ç½®:è¯¥å·¥å…·æä¾›ç”¨æˆ·å‹å¥½çš„ç•Œé¢ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿå¿«é€Ÿå¯åŠ¨å¹¶è¿è¡Œæ‰€é€‰è¯­è¨€æ¨¡å‹ã€‚</li><li>å¹³å°å…¼å®¹æ€§:ç›®å‰Ollamaæ”¯æŒmacOSï¼Œç¡®ä¿ä¸macOSç³»ç»Ÿçš„æ— ç¼é›†æˆã€‚</li></ul><p><strong>æ”¯æŒçš„æ¨¡å‹</strong></p><table><thead><tr><th>Model</th><th>Parameters</th><th>Size</th><th>Download</th></tr></thead><tbody><tr><td>Llama 3</td><td>8B</td><td>4.7GB</td><td><code>ollama run llama3</code></td></tr><tr><td>Llama 3</td><td>70B</td><td>40GB</td><td><code>ollama run llama3:70b</code></td></tr><tr><td>Phi-3</td><td>3.8B</td><td>2.3GB</td><td><code>ollama run phi3</code></td></tr><tr><td>Mistral</td><td>7B</td><td>4.1GB</td><td><code>ollama run mistral</code></td></tr><tr><td>Neural Chat</td><td>7B</td><td>4.1GB</td><td><code>ollama run neural-chat</code></td></tr><tr><td>Starling</td><td>7B</td><td>4.1GB</td><td><code>ollama run starling-lm</code></td></tr><tr><td>Code Llama</td><td>7B</td><td>3.8GB</td><td><code>ollama run codellama</code></td></tr><tr><td>Llama 2 Uncensored</td><td>7B</td><td>3.8GB</td><td><code>ollama run llama2-uncensored</code></td></tr><tr><td>LLaVA</td><td>7B</td><td>4.5GB</td><td><code>ollama run llava</code></td></tr><tr><td>Gemma</td><td>2B</td><td>1.4GB</td><td><code>ollama run gemma:2b</code></td></tr><tr><td>Gemma</td><td>7B</td><td>4.8GB</td><td><code>ollama run gemma:7b</code></td></tr><tr><td>Solar</td><td>10.7B</td><td>6.1GB</td><td><code>ollama run solar</code></td></tr></tbody></table></blockquote><h2 id="ä¸€-éƒ¨ç½²"><a href="#ä¸€-éƒ¨ç½²" class="headerlink" title="ä¸€. éƒ¨ç½²"></a>ä¸€. éƒ¨ç½²</h2><p>å‚è€ƒåœ°å€ï¼š</p><p><a href="https://wiki.eryajf.net/pages/97047e/#%E9%80%9A%E8%BF%87-docker-%E9%83%A8%E7%BD%B2">https://wiki.eryajf.net/pages/97047e/#%E9%80%9A%E8%BF%87-docker-%E9%83%A8%E7%BD%B2</a></p><p>é•œåƒå¯é€‰</p><p>ollama/ollama</p><p>registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ollama</p><p>registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ollama0.2.5</p><h3 id="CPUç‰ˆæœ¬éƒ¨ç½²"><a href="#CPUç‰ˆæœ¬éƒ¨ç½²" class="headerlink" title="CPUç‰ˆæœ¬éƒ¨ç½²"></a>CPUç‰ˆæœ¬éƒ¨ç½²</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cpuæ¨¡å¼</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">ollama:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ollama</span></span><br><span class="line">    <span class="comment">#ollama/ollama</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">ollama</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./ollama:/root/.ollama</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;11434:11434&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">OLLAMA_ORIGINS:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">      <span class="attr">OLLAMA_HOST:</span> <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:open-webui-main</span> </span><br><span class="line">    <span class="comment">#ghcr.io/open-webui/open-webui:main</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">open-webui</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3000:8080&quot;</span></span><br><span class="line">    <span class="attr">extra_hosts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;host.docker.internal:host-gateway&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">open-webui:/app/backend/data</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="GPUç‰ˆæœ¬éƒ¨ç½²"><a href="#GPUç‰ˆæœ¬éƒ¨ç½²" class="headerlink" title="GPUç‰ˆæœ¬éƒ¨ç½²"></a>GPUç‰ˆæœ¬éƒ¨ç½²</h3><h3 id="GPUæ¨¡å¼ï¼ˆéœ€è¦æœ‰NVIDIAæ˜¾å¡æ”¯æŒï¼‰"><a href="#GPUæ¨¡å¼ï¼ˆéœ€è¦æœ‰NVIDIAæ˜¾å¡æ”¯æŒï¼‰" class="headerlink" title="GPUæ¨¡å¼ï¼ˆéœ€è¦æœ‰NVIDIAæ˜¾å¡æ”¯æŒï¼‰"></a>GPUæ¨¡å¼ï¼ˆéœ€è¦æœ‰NVIDIAæ˜¾å¡æ”¯æŒï¼‰</h3><h4 id="å®‰è£…è‹±ä¼Ÿè¾¾å®¹å™¨å·¥å…·åŒ…ï¼ˆä»¥Ubuntu22-04ä¸ºä¾‹ï¼‰"><a href="#å®‰è£…è‹±ä¼Ÿè¾¾å®¹å™¨å·¥å…·åŒ…ï¼ˆä»¥Ubuntu22-04ä¸ºä¾‹ï¼‰" class="headerlink" title="å®‰è£…è‹±ä¼Ÿè¾¾å®¹å™¨å·¥å…·åŒ…ï¼ˆä»¥Ubuntu22.04ä¸ºä¾‹ï¼‰"></a>å®‰è£…<a href="https://so.csdn.net/so/search?q=%E8%8B%B1%E4%BC%9F%E8%BE%BE&spm=1001.2101.3001.7020">è‹±ä¼Ÿè¾¾</a>å®¹å™¨å·¥å…·åŒ…ï¼ˆä»¥Ubuntu22.04ä¸ºä¾‹ï¼‰</h4><p>å…¶ä»–ç³»ç»Ÿè¯·å‚è€ƒï¼š<a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/arch-overview.html">è‹±ä¼Ÿè¾¾å®˜æ–¹æ–‡æ¡£</a></p><p>å‚è€ƒåšä¸»å¦ä¸€ç¯‡åšå®¢ï¼š<a href="http://sunlight.zznnwn.cloudns.biz/2024/07/15/ubuntu%E9%83%A8%E7%BD%B2nvidia-container-toolkit/">GPUæ¨¡å¼å…ˆå†³æ¡ä»¶</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.é…ç½®aptæº</span></span><br><span class="line">curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \</span><br><span class="line">  &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \</span><br><span class="line">    sed <span class="string">&#x27;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#x27;</span> | \</span><br><span class="line">    sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/nvidia-container-toolkit.list</span><br><span class="line"><span class="comment"># 2.æ›´æ–°æº</span></span><br><span class="line">sudo apt-get update</span><br><span class="line"><span class="comment"># 3.å®‰è£…å·¥å…·åŒ…</span></span><br><span class="line">sudo apt-get install -y nvidia-container-toolkit</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²</strong></p><p>å‚è€ƒï¼š<a href="https://bian.blog/2024/06/4697.html">https://bian.blog/2024/06/4697.html</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --gpus all -d -v /opt/ai/ollama:/root/.ollama -p 11434:11434 --name ollama ollama/ollama</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">ollama:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ollama</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">ollama</span></span><br><span class="line">    <span class="attr">runtime:</span> <span class="string">nvidia</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">deploy:</span></span><br><span class="line">      <span class="attr">resources:</span></span><br><span class="line">        <span class="attr">reservations:</span></span><br><span class="line">          <span class="attr">devices:</span></span><br><span class="line">          <span class="bullet">-</span> <span class="attr">driver:</span> <span class="string">nvidia</span></span><br><span class="line">            <span class="attr">capabilities:</span> [<span class="string">&quot;gpu&quot;</span>]</span><br><span class="line">            <span class="attr">count:</span> <span class="string">all</span>  <span class="comment"># æ ¹æ®éœ€è¦è°ƒæ•´ GPU çš„æ•°é‡  </span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./ollama:/root/.ollama</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;11434:11434&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">KEEP_GPUS_TIMEOUT:</span> <span class="number">40</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">OLLAMA_ORIGINS:</span> <span class="string">&quot;*&quot;</span></span><br><span class="line">      <span class="attr">OLLAMA_HOST:</span> <span class="string">&quot;0.0.0.0&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ollama</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:open-webui-main</span> </span><br><span class="line">    <span class="comment">#ghcr.io/open-webui/open-webui:main</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">open-webui</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    <span class="attr">extra_hosts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;host.docker.internal:host-gateway&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">open-webui:/app/backend/data</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">TZ:</span> <span class="string">Asia/Shanghai</span></span><br><span class="line">      <span class="attr">ENABLE_RAG_WEB_SEARCH:</span> <span class="literal">True</span></span><br><span class="line">      <span class="attr">RAG_WEB_SEARCH_ENGINE:</span> <span class="string">&quot;searxng&quot;</span></span><br><span class="line">      <span class="attr">RAG_WEB_SEARCH_RESULT_COUNT:</span> <span class="number">3</span></span><br><span class="line">      <span class="attr">RAG_WEB_SEARCH_CONCURRENT_REQUESTS:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">SEARXNG_QUERY_URL:</span> <span class="string">&quot;http://searxng:8080/search?q=&lt;query&gt;&quot;</span></span><br><span class="line">      <span class="attr">ENABLE_OPENAI_API:</span> <span class="literal">False</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ollama</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">open-webui:</span>  </span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">ollama:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span>   </span><br></pre></td></tr></table></figure><p>ç†è§£é…ç½®</p><blockquote><p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¢è®¨ä¸€ä¸‹ docker-compose.yml æ–‡ä»¶çš„å…³é”®ç»„ä»¶ï¼Œè¯¥æ–‡ä»¶å¯ä»¥ä½¿ç”¨ GPU åŠ é€Ÿè¿è¡Œ Ollamaï¼š</p><p>Docker Compose ç‰ˆæœ¬ï¼š<br>version å±æ€§æŒ‡å®šäº†ä½¿ç”¨çš„ Docker Compose ç‰ˆæœ¬ã€‚è™½ç„¶æœ‰äº›äººå¯èƒ½ä¼šæåˆ° 3.9ï¼Œä½†æ¨èä½¿ç”¨å®˜æ–¹æ–‡æ¡£ä¸­æåˆ°çš„ç‰ˆæœ¬ï¼Œç›®å‰æ˜¯ 3.8ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿å…¼å®¹æ€§å’Œç¨³å®šæ€§ã€‚</p><p>Ollama æœåŠ¡å®šä¹‰ï¼š<br>services éƒ¨åˆ†å®šä¹‰äº† ollama æœåŠ¡ï¼Œå®ƒå°è£…äº† Ollama å®¹å™¨ã€‚ä»¥ä¸‹æ˜¯å…¶é‡è¦å±æ€§çš„åˆ†è§£ï¼š</p><p>imageï¼šæŒ‡å®š Ollama çš„ Docker é•œåƒã€‚é»˜è®¤æ˜¯ ollama/ollamaï¼Œä½†å¦‚æœéœ€è¦ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬ï¼ˆè¯·å‚é˜… Ollama çš„æ–‡æ¡£ä»¥è·å–å¯ç”¨ç‰ˆæœ¬ï¼‰ã€‚<br>deployï¼šè¯¥éƒ¨åˆ†é…ç½®äº† Ollama å®¹å™¨çš„èµ„æºä¿ç•™ï¼Œè¿™æ˜¯åˆ©ç”¨ GPU çš„å…³é”®ã€‚<br>resourcesï¼šå®šä¹‰å®¹å™¨çš„èµ„æºéœ€æ±‚ã€‚<br>reservationsï¼šè¯¥åµŒå¥—å±æ€§å…è®¸æ‚¨ä¸ºå®¹å™¨ä¿ç•™ç‰¹å®šè®¾å¤‡ã€‚<br>devicesï¼šå®šä¹‰è®¾å¤‡ä¿ç•™ã€‚åœ¨æ­¤åµŒå¥—é…ç½®ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®šï¼š<br>driverï¼šå°†è®¾å¤‡é©±åŠ¨ç¨‹åºè®¾ç½®ä¸º nvidiaï¼Œè¡¨ç¤ºæˆ‘ä»¬è¯·æ±‚ä½¿ç”¨ Nvidia GPUã€‚<br>capabilitiesï¼šåˆ—å‡º Ollama è¯·æ±‚çš„åŠŸèƒ½ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬æŒ‡å®š â€œgpuâ€ ä»¥è¡¨ç¤ºæˆ‘ä»¬å¸Œæœ›åˆ©ç”¨ GPU è¿›è¡Œå¤„ç†ã€‚<br>countï¼šè¯¥å€¼ç¡®å®šè¦ä¸º Ollama ä¿ç•™å¤šå°‘ä¸ª Nvidia GPUã€‚ä½¿ç”¨ all æ¥åˆ©ç”¨æ‰€æœ‰å¯ç”¨çš„ GPUï¼Œæˆ–è€…å¦‚æœæœ‰å¤šä¸ª GPU å¹¶å¸Œæœ›ä¸º Ollama ä¸“é—¨åˆ†é…ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªå…·ä½“çš„æ•°é‡ã€‚<br>æŒä¹…åŒ–å·å®šä¹‰ï¼š<br>volumes éƒ¨åˆ†å®šä¹‰äº†ä¸€ä¸ªåä¸º ollama çš„æŒä¹…åŒ–å·ã€‚æ­¤å·ç¡®ä¿ Ollama ç”Ÿæˆçš„ä»»ä½•æ•°æ®ï¼ˆå¦‚è®­ç»ƒæ¨¡å‹æˆ–é…ç½®ï¼‰åœ¨å®¹å™¨é‡å¯åä»ç„¶å­˜åœ¨ã€‚å®ƒè¢«æŒ‚è½½åœ¨ Ollama å®¹å™¨å†…çš„ /root/.ollama ç›®å½•ã€‚</p></blockquote><p><strong>éƒ¨ç½²å®Œæˆåè½½å…¥å¤§æ¨¡å‹(CPU GPUç›¸åŒ)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæ•ˆä¸Šä¼ çš„æ¨¡å‹æ–‡ä»¶</span></span><br><span class="line">docker-compose restart</span><br><span class="line"><span class="comment"># å¯åŠ¨qwen:4bæ¨¡å‹</span></span><br><span class="line">docker <span class="built_in">exec</span> -it ollama ollama run qwen:4b-chat</span><br></pre></td></tr></table></figure><p>å¤‡æ³¨ï¼šå¼€å¯ä»£ç†åœ¨æœ¬æœºä¸‹è½½å®Œæˆä¹‹å ä¼šåœ¨å½“å‰ç›®å½•ollamaæ–‡ä»¶å¤¹ ç”Ÿæˆä¸€ä¸ªmodelsçš„æ–‡ä»¶å¤¹æ¨¡å‹æ–‡ä»¶å°±å­˜äºå…¶ä¸­ åªéœ€è¦å°†æ­¤æ–‡ä»¶å¤¹å‹ç¼©ä¸Šä¼ åˆ°æœåŠ¡å™¨å å†æ¬¡æ‰§è¡Œæ­¤é¡¹å‘½ä»¤æœåŠ¡å™¨ä¸Šæ¨¡å‹å³å¯éƒ¨ç½²å®Œæˆ <strong>ä¸Šä¼ åéœ€è¦é‡å¯å®¹å™¨docker-compose restartå†æ‰§è¡Œrunå³å¯</strong>ã€‚</p><p>å»ºè®®ï¼šæœ€å¥½å°†æ•´ä¸ªé¡¹ç›®æ–‡ä»¶åŒ…å«docker-composeæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨æ‰§è¡Œç›¸åº”æ“ä½œUP ollama createç­‰ã€‚</p><p>llama3:8bæ•ˆæœï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_a21d90e141ec4f1cce9354171386e840.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_a21d90e141ec4f1cce9354171386e840.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_d4f9773272728a7238a432b06356f0ce.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_d4f9773272728a7238a432b06356f0ce.png"></p><p>æ³¨æ„ï¼šä½¿ç”¨pveåˆ›å»ºçš„<strong>è™šæ‹Ÿæœºç›´é€šGPU</strong> éœ€è¦å°†<strong>cpuæ¨¡å¼è®¾ç½®ä¸ºhost</strong>ï¼ˆé»˜è®¤ä¸ºqemuæ¨¡å¼ï¼‰ <strong>å¦åˆ™ä¼šæŠ¥é”™cpuä¸æ”¯æŒavxæŒ‡ä»¤é›†å¯¼è‡´GPUè¢«ç¦ç”¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama  | time=2024-07-23T02:15:07.485Z level=WARN <span class="built_in">source</span>=gpu.go:225 msg=<span class="string">&quot;CPU does not have minimum vector extensions, GPU inference disabled&quot;</span> required=avx detected=<span class="string">&quot;no vector extensions&quot;</span></span><br></pre></td></tr></table></figure><p>è§£å†³ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_20236426c0189f25768346fb91a15c8f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_20236426c0189f25768346fb91a15c8f.png"></p><p><strong>ollama æˆåŠŸä½¿ç”¨GPUæˆªå›¾</strong>ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_69b91f921449ffe234d7c952ae8412ec.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_69b91f921449ffe234d7c952ae8412ec.png"></p><p><strong>æ•ˆæœ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">root@dmx:/opt/ollama<span class="comment"># docker exec -it ollama bash</span></span><br><span class="line">root@3373062f728d:/<span class="comment">#  nvidia-smi</span></span><br><span class="line">Tue Jul 23 07:31:40 2024   </span><br><span class="line">+-----------------------------------------------------------------------------------------+</span><br><span class="line">| NVIDIA-SMI 550.100                Driver Version: 550.100        CUDA Version: 12.4     |</span><br><span class="line">|-----------------------------------------+------------------------+----------------------+</span><br><span class="line">| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |</span><br><span class="line">| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |</span><br><span class="line">|                                         |                        |               MIG M. |</span><br><span class="line">|=========================================+========================+======================|</span><br><span class="line">|   0  NVIDIA GeForce RTX 4090 D      Off |   00000000:01:00.0 Off |                  Off |</span><br><span class="line">|  0%   39C    P8             15W /  425W |    5609MiB /  24564MiB |      0%      Default |</span><br><span class="line">|                                         |                        |                  N/A |</span><br><span class="line">+-----------------------------------------+------------------------+----------------------+</span><br><span class="line">                                                                       </span><br><span class="line">+-----------------------------------------------------------------------------------------+</span><br><span class="line">| Processes:                                                                              |</span><br><span class="line">|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |</span><br><span class="line">|        ID   ID                                                               Usage      |</span><br><span class="line">|=========================================================================================|</span><br><span class="line">+-----------------------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²å®Œæˆåå¾®è°ƒä¸ºè‡ªå·±çš„å¤§æ¨¡å‹ï¼š<a href="http://sunlight.zznnwn.cloudns.biz/2024/08/02/ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%BE%AE%E8%B0%83%E5%8F%8A%E5%A4%9A%E6%A8%A1%E6%80%81%E5%9B%BE%E7%89%87%E5%88%86%E6%9E%90/">ollamaæœ¬åœ°å¤§æ¨¡å‹å¾®è°ƒåŠå¤šæ¨¡æ€å›¾ç‰‡åˆ†æ</a></p><h2 id="äºŒ-Ollama-ä¸­-ç¦»çº¿éƒ¨ç½²-qwen-0-5b-æ¨¡å‹ä¸ºä¾‹ã€‚"><a href="#äºŒ-Ollama-ä¸­-ç¦»çº¿éƒ¨ç½²-qwen-0-5b-æ¨¡å‹ä¸ºä¾‹ã€‚" class="headerlink" title="äºŒ. Ollama ä¸­ ç¦»çº¿éƒ¨ç½² qwen:0.5b æ¨¡å‹ä¸ºä¾‹ã€‚"></a>äºŒ. Ollama ä¸­ <strong>ç¦»çº¿éƒ¨ç½²</strong> qwen:0.5b æ¨¡å‹ä¸ºä¾‹ã€‚</h2><p><strong>1. ä¸‹è½½æ¨¡å‹</strong></p><p>è®¿é—® huggingface ä¸‹è½½ qwen1_5-0_5b-chat-q5_k_m.gguf æ¨¡å‹ã€‚</p><p><a href="https://huggingface.co/Qwen/Qwen1.5-0.5B-Chat-GGUF/tree/main">https://huggingface.co/Qwen/Qwen1.5-0.5B-Chat-GGUF/tree/main</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f93341707d2e1b6931f22cad2d81db8a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f93341707d2e1b6931f22cad2d81db8a.png"></p><p><strong>2. ä¸Šä¼  Qwen1.5-0.5B-Chat-GGUF æ¨¡å‹ç¦»çº¿æ–‡ä»¶åˆ° Ollama æ‰€åœ¨æœåŠ¡å™¨</strong></p><p><strong>3. åˆ›å»ºOllama Modelfile</strong></p><p>åˆ›å»ºä¸€ä¸ªåä¸º Modelfile çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">FROM ./qwen1_5-0_5b-chat-q5_k_m.gguf</span><br><span class="line"></span><br><span class="line">TEMPLATE &quot;&quot;&quot;&#123;&#123; if .System &#125;&#125;&lt;|im_start|&gt;system</span><br><span class="line">&#123;&#123; .System &#125;&#125;&lt;|im_end|&gt;&#123;&#123; end &#125;&#125;&lt;|im_start|&gt;user</span><br><span class="line">&#123;&#123; .Prompt &#125;&#125;&lt;|im_end|&gt;</span><br><span class="line">&lt;|im_start|&gt;assistant</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">PARAMETER stop &quot;&lt;|im_start|&gt;&quot;</span><br><span class="line">PARAMETER stop &quot;&lt;|im_end|&gt;&quot;</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼šä¸åŒæ¨¡å‹çš„ Modelfile å†…å®¹ä¸åŒï¼Œå¯å‚è€ƒ Ollama å®˜ç½‘ <a href="https://ollama.com/library/qwen:0.5b">å‚æ•°è®¾ç½®</a> ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8bbd7faef16aaea28633b9c3ed3a9415.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8bbd7faef16aaea28633b9c3ed3a9415.png"></p><p><strong>4. åœ¨Ollamaä¸­åˆ›å»ºæ¨¡å‹</strong></p><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºæ¨¡å‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama create qwen:0.5b -f Modelfile</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç¡®è®¤æ¨¡å‹å­˜åœ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama list</span><br></pre></td></tr></table></figure><p><strong>5. åœ¨ MaxKBä¸­ æ·»åŠ  Ollama æ¨¡å‹ å¯¹æ¥ä¸Šé¢åˆ›å»ºçš„ qwen:0.5b æ¨¡å‹</strong></p><p><strong>æ•ˆæœ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_021ed55c6e8335c07278795effa9572b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_021ed55c6e8335c07278795effa9572b.png"></p><h2 id="ä¸‰-å¯¹æ¥å®˜æ–¹webé¢æ¿open-webui-main"><a href="#ä¸‰-å¯¹æ¥å®˜æ–¹webé¢æ¿open-webui-main" class="headerlink" title="ä¸‰. å¯¹æ¥å®˜æ–¹webé¢æ¿open-webui-main"></a>ä¸‰. å¯¹æ¥å®˜æ–¹webé¢æ¿open-webui-main</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e98184a52ba387311de9a9d1f3759c29.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e98184a52ba387311de9a9d1f3759c29.png"></p><h2 id="å››-å¯¹æ¥MaxKB"><a href="#å››-å¯¹æ¥MaxKB" class="headerlink" title="å››. å¯¹æ¥MaxKB"></a>å››. å¯¹æ¥MaxKB</h2><p>è§é“¾æ¥ï¼š<a href="https://blog.fit2cloud.com/?p=3fc407b2-1962-4196-b5b8-c7d27684b446">https://blog.fit2cloud.com/?p=3fc407b2-1962-4196-b5b8-c7d27684b446</a></p><p>å¤‡æ³¨ï¼šapi-keyæ²¡æœ‰å¯éšä¾¿è¾“å³å¯</p><p>æ³¨æ„ï¼šå¯¹æ¥æœ¬åœ°å¤§æ¨¡å‹<del>ä¸èƒ½é€šè¿‡ä¸‹æ‹‰æ¡†é€‰æ‹©</del> éœ€è¦<strong>æ‰‹åŠ¨è¾“å…¥</strong> <strong>ollama list <strong>è·å–åˆ°çš„æ¨¡å‹åç§°<br>å¦åˆ™ä¼šæŠ¥é”™ Error: pull model manifest: Get â€œ<a href="https://registry.ollama.ai/v2/library/llama3/manifests/8b">https://registry.ollama.ai/v2/library/llama3/manifests/8b</a>â€œ: dial tcp 104.21.75.227:443: i/o timeout ä¸</strong> oneapiå¯¹æ¥ollamaç±»ä¼¼</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_9523bdac22c80d831c4daf934b10cdf3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_9523bdac22c80d831c4daf934b10cdf3.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/qq_38593436/article/details/136407171">https://blog.csdn.net/qq_38593436/article/details/136407171</a></p><p><a href="https://blog.csdn.net/weixin_43012017/article/details/138253446">https://blog.csdn.net/weixin_43012017/article/details/138253446</a></p><p><a href="https://blog.fit2cloud.com/?p=3fc407b2-1962-4196-b5b8-c7d27684b446">https://blog.fit2cloud.com/?p=3fc407b2-1962-4196-b5b8-c7d27684b446</a></p><p><a href="https://github.com/1Panel-dev/MaxKB/wiki/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Ollama%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2LLM%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B">å¦‚ä½•ä½¿ç”¨Ollamaç¦»çº¿éƒ¨ç½²LLMå¤§è¯­è¨€æ¨¡å‹ Â· 1Panel-dev/MaxKB Wiki (github.com)</a></p><p><a href="https://wiki.eryajf.net/pages/97047e/#%E6%A8%A1%E5%9E%8B%E7%AE%A1%E7%90%86">å¸¦ä½ è®¤è¯†æœ¬åœ°å¤§è¯­è¨€æ¨¡å‹æ¡†æ¶Ollama(å¯ç›´æ¥ä¸Šæ‰‹) | äºŒä¸«è®²æ¢µ (eryajf.net)</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centosé…ç½®vlan</title>
      <link href="/2024/05/14/centos%E9%85%8D%E7%BD%AEvlan/"/>
      <url>/2024/05/14/centos%E9%85%8D%E7%BD%AEvlan/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="centosé…ç½®vlan"><a href="#centosé…ç½®vlan" class="headerlink" title="centosé…ç½®vlan"></a>centosé…ç½®vlan</h1><h2 id="ä¸€-ç½‘ä¸Šå¤§ä½¬æ–¹å¼ï¼ˆæµ‹è¯•æœªé€šè¿‡ï¼‰"><a href="#ä¸€-ç½‘ä¸Šå¤§ä½¬æ–¹å¼ï¼ˆæµ‹è¯•æœªé€šè¿‡ï¼‰" class="headerlink" title="ä¸€. ç½‘ä¸Šå¤§ä½¬æ–¹å¼ï¼ˆæµ‹è¯•æœªé€šè¿‡ï¼‰"></a>ä¸€. ç½‘ä¸Šå¤§ä½¬æ–¹å¼ï¼ˆæµ‹è¯•æœªé€šè¿‡ï¼‰</h2><ol><li>å®‰è£…ä¾èµ–åŒ…</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install vconfig -y</span><br></pre></td></tr></table></figure><ol start="2"><li>æŸ¥çœ‹æ ¸å¿ƒæ˜¯å¦æä¾›VLAN åŠŸèƒ½</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dmesg | grep -i 802</span><br><span class="line"> </span><br><span class="line">[root@c159 network-scripts]<span class="comment"># dmesg |grep -i 802</span></span><br><span class="line">[    0.318021] pci 0000:00:16.5: [15ad:07a0] <span class="built_in">type</span> 01 class 0x060400</span><br><span class="line">[    0.398023] pci 0000:00:16.2:   bridge window [mem 0xeb100000-0xeb1fffff 64bit pref]</span><br><span class="line">[    1.120802] Key <span class="built_in">type</span> trusted registered</span><br><span class="line">[12888.091996] 8021q: 802.1Q VLAN Support v1.8</span><br><span class="line">[12888.092019] 8021q: adding VLAN 0 to HW filter on device ens192</span><br><span class="line">[12888.092511] 8021q: adding VLAN 0 to HW filter on device ens224</span><br></pre></td></tr></table></figure><ol start="3"><li>æŸ¥çœ‹<code>/proc/net/vlan</code>ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œä½¿ç”¨<code>modprobe</code>æ¨¡å‘½ä»¤è¿›å…¥<code>802.1q.o</code>ï¼Œä¸”ä½¿ç”¨<code>lsmod</code>å‘½ä»¤æ¨¡æ˜¯å¦å·²å…¥æ ¸å¿ƒ</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">modprobe 8021q</span><br><span class="line"> </span><br><span class="line">[root@c159 network-scripts]<span class="comment"># lsmod |grep 802</span></span><br><span class="line">8021q                  33159  0</span><br><span class="line">garp                   14384  1 8021q</span><br><span class="line">mrp                    18542  1 8021q</span><br></pre></td></tr></table></figure><ol start="4"><li>ä½¿ç”¨vconfigå‘½ä»¤å¢åŠ å­æ¥å£:</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vconfig add ens224 60</span><br></pre></td></tr></table></figure><ol start="5"><li>åˆ©ç”¨<code>ls /proc/net/vlan</code>æŸ¥çœ‹</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@c159 network-scripts]<span class="comment"># ls /proc/net/vlan/</span></span><br><span class="line">config  ens224.60  ens224.20  ens224.30</span><br></pre></td></tr></table></figure><p><strong>å¦‚æ²¡æœ‰vconfigåŒ…åˆ™ä¿®æ”¹é…ç½®æ–‡ä»¶å³å¯ï¼ˆè§å…­ä»¥ä¸‹æ­¥éª¤ï¼‰</strong></p><ol start="6"><li>ä¿®æ”¹ç½‘å¡é…ç½®ï¼š</li></ol><p>ifcfg-ens224é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/sysconfig/network-scripts/</span><br><span class="line"><span class="built_in">cp</span> ifcfg-ens224 ifcfg-ens224.60</span><br><span class="line"> </span><br><span class="line">vim ifcfg-ens224</span><br><span class="line"> </span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none  //æ­¤é¡¹dhcpå¯¹vlanç«¯å£æ— å½±å“ï¼Œå¦‚ä¸æ”¾å¿ƒï¼Œå¯æ”¹æˆstatic</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens224</span><br><span class="line">DEVICE=ens224</span><br><span class="line">ONBOOT=no  //æ­¤é¡¹<span class="built_in">yes</span>æˆ–noï¼Œå¯¹vlanç«¯å£æ— å½±å“</span><br></pre></td></tr></table></figure><p>å¯¹åº”vlançš„é…ç½®æ–‡ä»¶ä¸­UUIDä¸€å®šè¦åˆ æ‰ï¼Œä¸ç„¶ä¼šå‡ºç°ä¸å¯çŸ¥çš„é—®é¢˜</p><p>ifcfg-ens224.60é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vim ifcfg-ens224.60</span><br><span class="line">TYPE=vlan        //TYPEç±»å‹</span><br><span class="line">PHYSDEV=ens224      //vlanç«¯å£å¯¹åº”ç‰©ç†ç¡¬ä»¶åç§°</span><br><span class="line">VLAN_ID=60     //VLAN ID</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens224.60</span><br><span class="line">DEVICE=ens224.60</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">VLAN=<span class="built_in">yes</span>              //è®¾ç½®å…è®¸vlan</span><br><span class="line">IPADDR=10.0.0.80</span><br><span class="line">NETMASK=255.255.255.0</span><br></pre></td></tr></table></figure><h2 id="äºŒ-ç›´æ¥åœ¨ä¸»ç½‘å¡ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰"><a href="#äºŒ-ç›´æ¥åœ¨ä¸»ç½‘å¡ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰" class="headerlink" title="äºŒ. ç›´æ¥åœ¨ä¸»ç½‘å¡ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰"></a>äºŒ. ç›´æ¥åœ¨ä¸»ç½‘å¡ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰</h2><table><thead><tr><th>vlanå†…ç½‘10.0.1.æ®µåœ°å€vlan id</th><th>vlan60</th><th>vlan60</th></tr></thead><tbody><tr><td><strong>æœºå™¨åç§°</strong></td><td>centos1</td><td>centos2</td></tr><tr><td><strong>vlanå†…ç½‘åœ°å€</strong><br><br></td><td>10.0.1.60</td><td>10.0.1.61</td></tr><tr><td><strong>å¤–ç½‘åœ°å€</strong></td><td>10.0.0.10</td><td>10.0.0.128<br></td></tr></tbody></table><blockquote><p>æœ¬æ¬¡ç¯å¢ƒä½¿ç”¨ vmware æ¨¡æ‹Ÿ</p><p>ä¸€å°centos7 ä¸€å°centos8</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_d1ed2ec5c1b9dfd1d195e5b96d71c0f3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_d1ed2ec5c1b9dfd1d195e5b96d71c0f3.png"></p><p><code>GATEWAY</code> æ­¤å‚æ•°æ ¹æ®æƒ…å†µè€ƒè™‘æ˜¯å¦æ·»åŠ </p><p>å¦‚ï¼šåŒç½‘å¡ä¸åŒIPæƒ…å†µ åªå…è®¸æœ‰ä¸€ä¸ªé»˜è®¤ç½‘å…³ å¦‚æœå¦ä¸€å¼ ç½‘å¡éœ€è¦é…ç½®å¤–ç½‘IP é‚£ä¹ˆåªå…è®¸è§„å®šå¤–ç½‘IPçš„ç½‘å¡é…ç½®å¤–ç½‘ç½‘å…³</p><p><code>VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</code> æ˜¯ç½‘ç»œé…ç½®æ–‡ä»¶ä¸­çš„ä¸€ä¸ªé€‰é¡¹ï¼Œå®ƒæŒ‡å®šäº† VLAN æ ‡ç­¾çš„æ ¼å¼ã€‚</p><ul><li><code>VLAN_PLUS_VID_NO_PAD</code> è¡¨ç¤º VLAN æ ‡ç­¾ä»¥ â€œVLANâ€ å¼€å¤´ï¼Œåè·Ÿ VLAN IDï¼Œä¾‹å¦‚ â€œVLAN80â€ã€‚</li><li><code>NO_PAD</code> è¡¨ç¤º VLAN ID ä¸ä¼šåœ¨å‰é¢å¡«å……é›¶ã€‚ä¾‹å¦‚ï¼ŒVLAN ID 80 è¡¨ç¤ºä¸º â€œVLAN80â€ è€Œä¸æ˜¯ â€œVLAN080â€ã€‚</li></ul><p>å› æ­¤ï¼Œ<code>VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</code> çš„æ„æ€æ˜¯ï¼Œä½¿ç”¨ â€œVLANâ€ åŠ ä¸Š VLAN ID çš„æ ¼å¼ï¼Œå¹¶ä¸”ä¸åœ¨ VLAN ID å‰é¢å¡«å……é›¶ã€‚</p></blockquote><p><strong>ç½‘å¡é…ç½®å…¶å®åªéœ€è¦åœ¨ä¸‹æ–¹æ·»åŠ æ­¤é…ç½®å³å¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">IPADDR=10.0.1.61</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.1.220</span><br><span class="line">DNS1=114.114.114.114</span><br><span class="line">DNS2=8.8.8.8</span><br><span class="line">DNS3=223.5.5.5</span><br><span class="line">VLAN=<span class="built_in">yes</span></span><br><span class="line">VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</span><br><span class="line">VLAN_ID=80</span><br></pre></td></tr></table></figure><p><strong>centos8ä¿®æ”¹ç½‘å¡é…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=eui64</span><br><span class="line">NAME=ens224</span><br><span class="line">DEVICE=ens224</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">IPADDR=10.0.1.61</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.1.220</span><br><span class="line">DNS1=114.114.114.114</span><br><span class="line">DNS2=8.8.8.8</span><br><span class="line">DNS3=223.5.5.5</span><br><span class="line">VLAN=<span class="built_in">yes</span></span><br><span class="line">VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</span><br><span class="line">VLAN_ID=60</span><br></pre></td></tr></table></figure><p><strong>centos7é…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">TYPE=<span class="string">&quot;Ethernet&quot;</span></span><br><span class="line">PROXY_METHOD=<span class="string">&quot;none&quot;</span></span><br><span class="line">BROWSER_ONLY=<span class="string">&quot;no&quot;</span></span><br><span class="line">BOOTPROTO=<span class="string">&quot;static&quot;</span></span><br><span class="line">DEFROUTE=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV4_FAILURE_FATAL=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6INIT=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_AUTOCONF=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_DEFROUTE=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_FAILURE_FATAL=<span class="string">&quot;no&quot;</span></span><br><span class="line">IPV6_ADDR_GEN_MODE=<span class="string">&quot;stable-privacy&quot;</span></span><br><span class="line">IPV6_PRIVACY=<span class="string">&quot;no&quot;</span></span><br><span class="line">NAME=<span class="string">&quot;ens35&quot;</span></span><br><span class="line">DEVICE=<span class="string">&quot;ens35&quot;</span></span><br><span class="line">ONBOOT=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPADDR=<span class="string">&quot;10.0.1.60&quot;</span></span><br><span class="line">PREFIX=<span class="string">&quot;24&quot;</span></span><br><span class="line">GATEWAY=<span class="string">&quot;10.0.1.220&quot;</span></span><br><span class="line">DNS1=<span class="string">&quot;114.114.114.114&quot;</span></span><br><span class="line">DNS2=<span class="string">&quot;8.8.8.8&quot;</span></span><br><span class="line">DNS3=<span class="string">&quot;223.5.5.5&quot;</span></span><br><span class="line">VLAN=<span class="built_in">yes</span></span><br><span class="line">VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</span><br><span class="line">VLAN_ID=60</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>centos8ç‰©ç†æœåŠ¡å™¨å®é™…é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">test</span>@cloud1 network-scripts]$ <span class="built_in">cat</span> ifcfg-eno4</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=no</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=eui64</span><br><span class="line">NAME=eno4</span><br><span class="line">UUID=7ee10950-b9b8-45dd-995d-074cf1695242</span><br><span class="line">DEVICE=eno4</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">IPADDR=172.56.20.11</span><br><span class="line">PREFIX=24</span><br><span class="line">VLAN=<span class="built_in">yes</span></span><br><span class="line">VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</span><br><span class="line">VLAN_ID=20</span><br></pre></td></tr></table></figure><p>éªŒè¯ï¼š</p><p>ç›¸äº’pingçœ‹å†…ç½‘æ˜¯å¦äº’é€š</p><ul><li><p>ç‰©ç†æœåŠ¡å™¨éªŒè¯<br>ç½‘å¡å˜ä¸ºç»¿è‰²</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2bfbac8a58848ceb401fa888e341bd45.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2bfbac8a58848ceb401fa888e341bd45.png"></p><p>äº¤æ¢æœºå¯¹åº”æœåŠ¡å™¨çš„ç«¯å£ç¯äº®</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_f5809244b4f7e86f58c42d319e515b3e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_f5809244b4f7e86f58c42d319e515b3e.png"></p></li><li><p>downæ‰centos7 ens33ç½‘å¡ åœ¨vmwareæ§åˆ¶å°ping centos8 vlan60ç½‘å¡ens35 ping 10.0.1.61  (æˆåŠŸ)</p></li><li><p>å¹¶ä¸”æ­¤æ—¶pingä¸é€šcentos7 10.0.0.10 è¯´æ˜å†…å¤–ç½‘éš”ç¦»ç¯å¢ƒæµ‹è¯•æˆåŠŸ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_46d9d81ccd08ad64cb09535dc5f30812.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_46d9d81ccd08ad64cb09535dc5f30812.png"></p></li><li><p>å°†centos2æœºå™¨vlanä¿®æ”¹ä¸ºå…¶ä»–æ®µå¦‚vlan80åä½¿ç”¨æ­¤æœºå™¨ ping centos1 vlan60 10.0.1.60çœ‹èƒ½å¦pingé€š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1367c682fbe66fce000e3afced063d48.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1367c682fbe66fce000e3afced063d48.png"></p><p>æ­¤æ—¶ä¸¤å°æœºå™¨äº’ç›¸æ— æ³•pingé€š <img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f9f2dc184abb2dd3b0f6ede28a0e7830.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f9f2dc184abb2dd3b0f6ede28a0e7830.png"></p></li></ul><p>æˆåŠŸï¼</p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/zhongbeida_xue/article/details/95355111">https://blog.csdn.net/zhongbeida_xue/article/details/95355111</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ</title>
      <link href="/2024/05/14/Centos8%E4%BD%BF%E7%94%A8network%E7%AE%A1%E7%90%86%E7%BD%91%E7%BB%9C/"/>
      <url>/2024/05/14/Centos8%E4%BD%BF%E7%94%A8network%E7%AE%A1%E7%90%86%E7%BD%91%E7%BB%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ"><a href="#Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ" class="headerlink" title="Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ"></a>Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ</h1><p>å‰è¨€ï¼š</p><p>åœ¨CentOS8ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„network.serviceæœåŠ¡å°±è¢«NetworkManager.serviceæœåŠ¡ä»£æ›¿äº†ï¼ŒåŒæ ·çš„ï¼ŒIPçš„é…ç½®æ–¹æ³•ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆå¦‚æœæƒ³ä½¿ç”¨network.serviceæœåŠ¡å»ç®¡ç†/é…ç½®ç³»ç»Ÿç½‘ç»œæ€ä¹ˆåŠå‘¢ï¼Ÿä¸‹é¢å¸¦ä½ æ¢¦å›network.service</p><h3 id="ä¸€ã€å®‰è£…network-scripts"><a href="#ä¸€ã€å®‰è£…network-scripts" class="headerlink" title="ä¸€ã€å®‰è£…network-scripts"></a>ä¸€ã€å®‰è£…network-scripts</h3><p>é™é»˜å®‰è£…(-q)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf install -y  network-scripts</span><br></pre></td></tr></table></figure><p>å®‰è£…è¿‡ç¨‹:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># dnf install -y -q network-scripts</span></span><br><span class="line">è­¦å‘Šï¼š/var/cache/dnf/BaseOS-929b586ef1f72f69/packages/network-scripts-10.00.6-1.el8_2.1.x86_64.rpm: å¤´V3 RSA/SHA256 Signature, å¯†é’¥ ID 8483c65d: NOKEY</span><br><span class="line">å¯¼å…¥ GPG å…¬é’¥ 0x8483C65D:</span><br><span class="line">Userid: <span class="string">&quot;CentOS (CentOS Official Signing Key) &lt;security@centos.org&gt;&quot;</span></span><br><span class="line">æŒ‡çº¹: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D</span><br><span class="line">æ¥è‡ª: /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼ŒæœåŠ¡å®‰è£…å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å¼€å§‹å¯ç”¨è¯¥æœåŠ¡</p><h3 id="äºŒã€å¯ç”¨network"><a href="#äºŒã€å¯ç”¨network" class="headerlink" title="äºŒã€å¯ç”¨network"></a>äºŒã€å¯ç”¨network</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start network</span><br><span class="line">systemctl <span class="built_in">enable</span> network</span><br><span class="line">systemctl status network</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-ç¦ç”¨NetworkManager-service"><a href="#ä¸‰-ç¦ç”¨NetworkManager-service" class="headerlink" title="ä¸‰. ç¦ç”¨NetworkManager.service"></a>ä¸‰. ç¦ç”¨NetworkManager.service</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop NetworkManager</span><br><span class="line">systemctl <span class="built_in">disable</span> NetworkManager</span><br><span class="line">æ‰§è¡Œç»“æœï¼š</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl stop NetworkManager</span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl disable NetworkManager</span></span><br><span class="line">Removed /etc/systemd/system/multi-user.target.wants/NetworkManager.service.</span><br><span class="line">Removed /etc/systemd/system/dbus-org.freedesktop.nm-dispatcher.service.</span><br><span class="line">Removed /etc/systemd/system/network-online.target.wants/NetworkManager-wait-online.service.</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼ŒNetworkManageræœåŠ¡å°±åœæ­¢å·¥ä½œäº†ï¼Œè¿™æ—¶å€™å¯ä»¥å…ˆå®‰è£…network-scriptsï¼ˆä¹Ÿå°±æ˜¯network.service)äº†</p><h3 id="å››ã€å¸è½½NetworkManagerï¼ˆå¯é€‰-å»ºè®®ä¿ç•™ï¼‰"><a href="#å››ã€å¸è½½NetworkManagerï¼ˆå¯é€‰-å»ºè®®ä¿ç•™ï¼‰" class="headerlink" title="å››ã€å¸è½½NetworkManagerï¼ˆå¯é€‰ å»ºè®®ä¿ç•™ï¼‰"></a>å››ã€å¸è½½<code>NetworkManager</code>ï¼ˆå¯é€‰ å»ºè®®ä¿ç•™ï¼‰</h3><p>æ‰§è¡Œå¸è½½å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf remove -y NetworkManager</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_a6a352e2ac83bc5373276f96402b5ff4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_a6a352e2ac83bc5373276f96402b5ff4.png"></p><p>æœ¬æ–‡å‚è€ƒ</p><p><a href="https://blog.csdn.net/qq_36154886/article/details/109839926">https://blog.csdn.net/qq_36154886/article/details/109839926</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ</title>
      <link href="/2024/05/13/centos8%E4%BD%BF%E7%94%A8nmcli%E9%85%8D%E7%BD%AEbond1%E4%B8%8Evlan%E7%BB%84%E5%90%88/"/>
      <url>/2024/05/13/centos8%E4%BD%BF%E7%94%A8nmcli%E9%85%8D%E7%BD%AEbond1%E4%B8%8Evlan%E7%BB%84%E5%90%88/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ-æµ‹è¯•æœªé€šè¿‡"><a href="#centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ-æµ‹è¯•æœªé€šè¿‡" class="headerlink" title="centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ(æµ‹è¯•æœªé€šè¿‡)"></a>centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ(æµ‹è¯•æœªé€šè¿‡)</h2><blockquote><p>æœ¬æ¬¡å®éªŒç¯å¢ƒä½¿ç”¨<strong>workstdtion</strong> è™šæ‹Ÿæœºäº¤æ¢æœº æ¨¡æ‹Ÿç‰©ç†è®¾å¤‡åˆ’åˆ†vlan</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_bba0d14b526d9a8ddba1b176cfdfaeb8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_bba0d14b526d9a8ddba1b176cfdfaeb8.png"></p><p>NetworkManagerå’Œnetwork.serviceéƒ½æ˜¯ç”¨æ¥ç®¡ç†ç½‘ç»œçš„å·¥å…·ã€‚åœ¨CentOS 7ç‰ˆæœ¬ä¸­ï¼ŒNetworkManagerå’Œnetwork.serviceé»˜è®¤å®‰è£…æ—¶æ˜¯å…±å­˜çš„ï¼Œä½†ä¹ æƒ¯ä½¿ç„¶æˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯ç¦ç”¨æ‰NetworkManagerè€Œä»ç„¶ä½¿ç”¨é…ç½®æ–‡ä»¶+network.serviceçš„æ–¹å¼æ¥é…ç½®å’Œç®¡ç†ä¸»æœºä¸Šçš„ç½‘ç»œã€‚</p><p>RHEL 8/CentOS 8ç‰ˆæœ¬å¼€å§‹network.serviceé»˜è®¤æ²¡æœ‰å®‰è£…ï¼Œé»˜è®¤åªä½¿ç”¨NetworkManagerä½œä¸ºç½‘ç»œç®¡ç†å·¥å…·ã€‚è€Œä¸”RedHatå®˜æ–¹æŒ‡å‡ºåœ¨åç»­çš„ç‰ˆæœ¬ä¸­ä¼šå½»åº•ä¸æ”¯æŒnetwork.serviceï¼Œè¿™æ ·ä¸€æ¥é™¤äº†NetworkManageræˆ‘ä»¬ä¹Ÿæ²¡æœ‰é€‰æ‹©ä½™åœ°ã€‚æ—¢ç„¶æ— åŠ›åæŠ—ï¼Œé‚£ä¹ˆå°±è¦å­¦ä¼šäº«å—ã€‚</p><p>å…¶å®NetworkManagerä¹Ÿæœ‰ä¼˜ç‚¹ï¼Œæ¯”å¦‚ä½¿ç”¨æ–¹å¼å¤šæ ·åŒ–ï¼šå‘½ä»¤è¡Œã€æ–‡æœ¬ç•Œé¢ã€å›¾å½¢ç•Œé¢ã€web portalå‡å¯æ”¯æŒã€‚nmcliå‘½ä»¤è¡Œæ”¯æŒtabè¡¥é½ï¼Œä½¿ç”¨æ„Ÿå—ç±»ä¼¼é…ç½®äº¤æ¢æœºï¼›nmtuiå·¥å…·å¯ä»¥åœ¨shellç»ˆç«¯å¼€å¯æ–‡æœ¬å›¾å½¢ç•Œé¢ã€‚è€Œä¸”Linuxä¸»æµçŸ¥å‘è¡Œç‰ˆï¼ŒRedHatç³»ã€Suseç³»ã€Debian/Ubuntuç³»å‡æ”¯æŒNetworkManagerã€‚</p><p>åœ¨nmcliä¸­æœ‰2ä¸ªå‘½ä»¤æœ€ä¸ºå¸¸ç”¨ï¼š</p><p>nmcli connection</p><p>è¯‘ä½œè¿æ¥ï¼Œå¯ç†è§£ä¸ºé…ç½®æ–‡ä»¶ï¼Œç›¸å½“äºifcfg-ethXã€‚å¯ä»¥ç®€å†™ä¸ºnmcli c</p><p>nmcli device</p><p>è¯‘ä½œè®¾å¤‡ï¼Œå¯ç†è§£ä¸ºå®é™…å­˜åœ¨çš„ç½‘å¡(åŒ…æ‹¬ç‰©ç†ç½‘å¡å’Œè™šæ‹Ÿç½‘å¡)ã€‚å¯ä»¥ç®€å†™ä¸ºnmcli d</p><p>NetworkManageræœ‰2ä¸ªåŸºæœ¬çš„æ¦‚å¿µï¼šè¿æ¥(Connection)å’Œè®¾å¤‡(Device)ã€‚</p><p>Deviceæ˜¯æ“ä½œç³»ç»Ÿå±‚é¢èƒ½å¤Ÿè¯†åˆ«åˆ°çš„ç½‘å¡è®¾å¤‡ï¼Œå¦‚æœ¬åœ°å›ç¯loã€æœ¬åœ°ç½‘å¡eth0ï¼ˆnmcli då‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°ï¼‰ã€‚</p><p>Connectionå¯ä»¥è®¤ä¸ºæ˜¯Deviceå¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªDeviceå¯ä»¥å¯¹åº”å¤šä¸ªConnectionã€‚åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªConnectionæ˜¯å¤„äºæ¿€æ´»çŠ¶æ€çš„ï¼ˆnmcli cå‘½ä»¤è¾“å‡ºç»“æœä¸­ç»¿è‰²çš„è¡Œï¼‰ã€‚</p></blockquote><h3 id="ä¸€-é…ç½®bondä¸vlanç»„åˆï¼ˆé‡å¯ç³»ç»Ÿä¾¿ä¼šå¤±æ•ˆï¼‰"><a href="#ä¸€-é…ç½®bondä¸vlanç»„åˆï¼ˆé‡å¯ç³»ç»Ÿä¾¿ä¼šå¤±æ•ˆï¼‰" class="headerlink" title="ä¸€. é…ç½®bondä¸vlanç»„åˆï¼ˆé‡å¯ç³»ç»Ÿä¾¿ä¼šå¤±æ•ˆï¼‰"></a>ä¸€. é…ç½®bondä¸vlanç»„åˆï¼ˆé‡å¯ç³»ç»Ÿä¾¿ä¼šå¤±æ•ˆï¼‰</h3><p><strong>æ‹“è¡¥å›¾</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_715204becfedcdac807aa604cbd4594e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_715204becfedcdac807aa604cbd4594e.png"></p><p><strong>å…ˆå†³æ¡ä»¶</strong></p><p>æŸ¥çœ‹/proc/net/vlan ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œä½¿ç”¨modprobeæ¨¡å‘½ä»¤è¿›å…¥802.1q.oï¼Œä¸”ä½¿ç”¨lsmodå‘½ä»¤æ¨¡æ˜¯å¦å·²å…¥æ ¸å¿ƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŠ è½½æ¨¡å—</span></span><br><span class="line">modprobe 8021q</span><br><span class="line"> </span><br><span class="line">[root@c159 network-scripts]<span class="comment"># lsmod |grep 802</span></span><br><span class="line">8021q                  33159  0</span><br><span class="line">garp                   14384  1 8021q</span><br><span class="line">mrp                    18542  1 8021q</span><br></pre></td></tr></table></figure><p>å¾ˆç®€å•åªéœ€è¦å‡ è¡Œå‘½ä»¤</p><p>å‚æ•°å¯é€‰</p><ul><li><code>ipv4.method disabled</code>ï¼šè¿™ä¸ªé€‰é¡¹ç¦ç”¨äº†IPv4åœ°å€çš„è‡ªåŠ¨è·å–ï¼Œæ„å‘³ç€ç³»ç»Ÿä¸ä¼šå°è¯•è·å–IPv4åœ°å€ã€‚</li><li><code>ipv6.method ignore</code>ï¼šè¿™ä¸ªé€‰é¡¹å‘Šè¯‰ç³»ç»Ÿå¿½ç•¥IPv6åœ°å€çš„é…ç½®ï¼Œç³»ç»Ÿä¸ä¼šä¸ºè¯¥æ¥å£åˆ†é…IPv6åœ°å€ã€‚</li><li>mode 1 å³ä¸º mode active-backup</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨NetworkManageré…ç½®vlan</span></span><br><span class="line">nmcli con add <span class="built_in">type</span> bond con-name bond0 ifname bond0  mode 1 ipv4.method disabled ipv6.method ignore</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens224 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens256 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> vlan con-name bond0.80 ifname bond0.80 dev bond0 <span class="built_in">id</span> 80 ipv4.addresses 10.0.0.100/24 ipv4.gateway 10.0.0.220 ipv4.dns 114.114.114.114 </span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å‘½ä»¤ç”Ÿæˆifcfg-bond0.80è¯¦æƒ… å¹¶æ–°å¢æ­¤è¡Œï¼ˆSLAVE=yesï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost network-scripts]<span class="comment"># cat ifcfg-bond0.80</span></span><br><span class="line">VLAN=<span class="built_in">yes</span></span><br><span class="line">TYPE=Vlan</span><br><span class="line">PHYSDEV=bond0</span><br><span class="line">VLAN_ID=80</span><br><span class="line">REORDER_HDR=<span class="built_in">yes</span></span><br><span class="line">GVRP=no</span><br><span class="line">MVRP=no</span><br><span class="line">HWADDR=</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=dhcp</span><br><span class="line">IPADDR=10.0.0.100</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=114.114.114.114</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=default</span><br><span class="line">NAME=bond0.80</span><br><span class="line">UUID=b96b405e-6a6d-4000-bca3-2fc060c945c2</span><br><span class="line">DEVICE=bond0.80</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">SLAVE=<span class="built_in">yes</span>   <span class="comment">#æ–°å¢</span></span><br></pre></td></tr></table></figure><h3 id="äºŒ-éªŒè¯"><a href="#äºŒ-éªŒè¯" class="headerlink" title="äºŒ. éªŒè¯"></a>äºŒ. éªŒè¯</h3><p>æŸ¥çœ‹bond: <code>cat /proc/net/bonding/bond0</code></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_b43f2d08cd6c439a2de7279ac31d2178.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_b43f2d08cd6c439a2de7279ac31d2178.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/5201351/p/4990187.html">linux-Centos 7ä¸‹bondä¸vlanæŠ€æœ¯çš„ç»“åˆ - 520_1351 - åšå®¢å›­ (cnblogs.com)</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨NetworkManageré…ç½®bond 0</span></span><br><span class="line"><span class="comment"># nmcli con add type bond ifname bond0 con-name bond0 mode active-backup</span></span><br><span class="line"><span class="comment"># nmcli con add type bond-slave ifname ens224 master bond0</span></span><br><span class="line"><span class="comment"># nmcli con add type bond-slave ifname ens256 master bond0</span></span><br><span class="line"><span class="comment"># nmcli con modify bond0 ipv4.address 10.0.0.100/24 ipv4.gateway 10.0.0.254 ipv4.dns 114.114.114.114 ipv4.method manual ipv6.method ignore</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨NetworkManageré…ç½®vlan</span></span><br><span class="line">nmcli con add <span class="built_in">type</span> bond ifname bond0 con-name bond0 mode active-backup ipv4.method disabled ipv6.method ignore</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens224 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens256 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> vlan con-name bond0.80 ifname bond0.80 dev bond0 <span class="built_in">id</span> 101 ipv4.addresses 10.0.0.100/24 ipv4.gateway 10.0.0.254 ipv4.dns 114.114.114.114 ipv4.method disabled ipv6.method ignore</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos8ä½¿ç”¨nmclié…ç½®bond(active-backup)åŠnetworkç®¡ç†ä¸‹é…ç½®</title>
      <link href="/2024/05/07/centos8%E4%BD%BF%E7%94%A8nmcli%E9%85%8D%E7%BD%AEbond(active-backup)%E5%8F%8Anetwork%E7%AE%A1%E7%90%86%E4%B8%8B%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/05/07/centos8%E4%BD%BF%E7%94%A8nmcli%E9%85%8D%E7%BD%AEbond(active-backup)%E5%8F%8Anetwork%E7%AE%A1%E7%90%86%E4%B8%8B%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="centos8ä½¿ç”¨nmclié…ç½®bond-active-backup-åŠnetworkç®¡ç†ä¸‹é…ç½®"><a href="#centos8ä½¿ç”¨nmclié…ç½®bond-active-backup-åŠnetworkç®¡ç†ä¸‹é…ç½®" class="headerlink" title="centos8ä½¿ç”¨nmclié…ç½®bond(active-backup)åŠnetworkç®¡ç†ä¸‹é…ç½®"></a>centos8ä½¿ç”¨nmclié…ç½®bond(active-backup)åŠnetworkç®¡ç†ä¸‹é…ç½®</h1><blockquote><p>éœ€è¦ï¼šè‡³å°‘ 3 å¼ ç½‘å¡ ï¼ˆ <strong>ä¸€å¼ ç½‘å¡é…ç½®IPç”¨äºè¿œç¨‹è¿æ¥ å‰©ä½™ä¸¤å¼ ç½‘å¡ é…ç½®bond</strong> ï¼‰</p><p>ä¸¤å¼ ç½‘å¡æ˜¯æ— æ³•å®ç°çš„</p></blockquote><h2 id="Bonding-èšåˆé“¾è·¯å·¥ä½œæ¨¡å¼"><a href="#Bonding-èšåˆé“¾è·¯å·¥ä½œæ¨¡å¼" class="headerlink" title="Bonding èšåˆé“¾è·¯å·¥ä½œæ¨¡å¼"></a>Bonding èšåˆé“¾è·¯å·¥ä½œæ¨¡å¼</h2><p>bondèšåˆé“¾è·¯æ¨¡å¼å…±æœ‰7ç§æ¨¡å¼ï¼š0-6 Mode</p><ul><li>mod=0 ï¼Œå³ï¼š(balance-rr) Round-robin policyï¼ˆè½®è¯¢ï¼‰èšåˆå£æ•°æ®æŠ¥æ–‡æŒ‰åŒ…è½®è¯¢ä»ç‰©ç†æ¥å£è½¬å‘ã€‚<br>è´Ÿè½½å‡è¡¡â€”æ‰€æœ‰é“¾è·¯å¤„äºè´Ÿè½½å‡è¡¡çŠ¶æ€ï¼Œè½®è¯¢æ–¹å¼å¾€æ¯æ¡é“¾è·¯å‘é€æŠ¥æ–‡è¿™æ¨¡å¼çš„ç‰¹ç‚¹å¢åŠ äº†å¸¦å®½ï¼ŒåŒæ—¶æ”¯æŒå®¹é”™èƒ½åŠ›ï¼Œå½“æœ‰é“¾è·¯å‡ºé—®é¢˜ï¼Œä¼šæŠŠæµé‡åˆ‡æ¢åˆ°æ­£å¸¸çš„é“¾è·¯ä¸Šã€‚<br>æ€§èƒ½é—®é¢˜â€”ä¸€ä¸ªè¿æ¥æˆ–è€…ä¼šè¯çš„æ•°æ®åŒ…å¦‚æœä»ä¸åŒçš„æ¥å£å‘å‡ºçš„è¯ï¼Œä¸­é€”å†ç»è¿‡ä¸åŒçš„é“¾è·¯ï¼Œåœ¨å®¢æˆ·ç«¯å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°æ•°æ®åŒ…æ— åºåˆ°è¾¾çš„é—®é¢˜ï¼Œè€Œæ— åºåˆ°è¾¾çš„æ•°æ®åŒ…éœ€è¦é‡æ–°è¦æ±‚è¢«å‘é€ï¼Œè¿™æ ·ç½‘ç»œçš„ååé‡å°±ä¼šä¸‹é™ã€‚Bond0åœ¨å¤§å‹åŠ›çš„ç½‘ç»œä¼ è¾“ä¸‹ï¼Œæ€§èƒ½å¢é•¿çš„å¹¶ä¸æ˜¯å¾ˆç†æƒ³ã€‚<br>éœ€è¦äº¤æ¢æœºè¿›è¡Œç«¯å£ç»‘å®š</li><li>mod=1ï¼Œå³ï¼š (active-backup) Active-backup policyï¼ˆä¸»-å¤‡ä»½ç­–ç•¥ï¼‰åªæœ‰ActiveçŠ¶æ€çš„ç‰©ç†æ¥å£æ‰è½¬å‘æ•°æ®æŠ¥æ–‡ã€‚<br>å®¹é”™èƒ½åŠ›â€”åªæœ‰ä¸€ä¸ªslaveæ˜¯æ¿€æ´»çš„(active)ã€‚ä¹Ÿå°±æ˜¯è¯´åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªç½‘å¡å¤„äºå·¥ä½œçŠ¶æ€ï¼Œå…¶ä»–çš„slaveéƒ½å¤„äºå¤‡ä»½çŠ¶æ€ï¼Œåªæœ‰åœ¨å½“å‰æ¿€æ´»çš„slaveæ•…éšœåæ‰æœ‰å¯èƒ½ä¼šå˜ä¸ºæ¿€æ´»çš„(active)ã€‚<br>æ— è´Ÿè½½å‡è¡¡â€”æ­¤ç®—æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æä¾›é«˜ç½‘ç»œè¿æ¥çš„å¯ç”¨æ€§ï¼Œä½†æ˜¯å®ƒçš„èµ„æºåˆ©ç”¨ç‡è¾ƒä½ï¼Œåªæœ‰ä¸€ä¸ªæ¥å£å¤„äºå·¥ä½œçŠ¶æ€ï¼Œåœ¨æœ‰ N ä¸ªç½‘ç»œæ¥å£çš„æƒ…å†µä¸‹ï¼Œèµ„æºåˆ©ç”¨ç‡ä¸º1/Nã€‚</li><li>mod=2ï¼Œå³ï¼š(balance-xor) XOR policyï¼ˆå¹³è¡¡ç­–ç•¥ï¼‰èšåˆå£æ•°æ®æŠ¥æ–‡æŒ‰æºç›®MACã€æºç›®IPã€æºç›®ç«¯å£è¿›è¡Œå¼‚æˆ–HASHè¿ç®—å¾—åˆ°ä¸€ä¸ªå€¼ï¼Œæ ¹æ®è¯¥å€¼æŸ¥æ‰¾æ¥å£è½¬å‘æ•°æ®æŠ¥æ–‡<br>è´Ÿè½½å‡è¡¡â€”åŸºäºæŒ‡å®šçš„ä¼ è¾“HASHç­–ç•¥ä¼ è¾“æ•°æ®åŒ…ã€‚<br>å®¹é”™èƒ½åŠ›â€”è¿™æ¨¡å¼çš„ç‰¹ç‚¹å¢åŠ äº†å¸¦å®½ï¼ŒåŒæ—¶æ”¯æŒå®¹é”™èƒ½åŠ›ï¼Œå½“æœ‰é“¾è·¯å‡ºé—®é¢˜ï¼Œä¼šæŠŠæµé‡åˆ‡æ¢åˆ°æ­£å¸¸çš„é“¾è·¯ä¸Šã€‚<br>æ€§èƒ½é—®é¢˜â€”è¯¥æ¨¡å¼å°†é™å®šæµé‡ï¼Œä»¥ä¿è¯åˆ°è¾¾ç‰¹å®šå¯¹ç«¯çš„æµé‡æ€»æ˜¯ä»åŒä¸€ä¸ªæ¥å£ä¸Šå‘å‡ºã€‚æ—¢ç„¶ç›®çš„åœ°æ˜¯é€šè¿‡MACåœ°å€æ¥å†³å®šçš„ï¼Œå› æ­¤è¯¥æ¨¡å¼åœ¨â€œæœ¬åœ°â€ç½‘ç»œé…ç½®ä¸‹å¯ä»¥å·¥ä½œå¾—å¾ˆå¥½ã€‚å¦‚æœæ‰€æœ‰æµé‡æ˜¯é€šè¿‡å•ä¸ªè·¯ç”±å™¨ï¼Œç”±äºåªæœ‰ä¸€ä¸ªç½‘å…³ï¼Œæºå’Œç›®æ ‡macéƒ½å›ºå®šäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªç®—æ³•ç®—å‡ºçš„çº¿è·¯å°±ä¸€ç›´æ˜¯åŒä¸€æ¡ï¼Œé‚£ä¹ˆè¿™ç§æ¨¡å¼å°±æ²¡æœ‰å¤šå°‘æ„ä¹‰äº†ã€‚<br>éœ€è¦äº¤æ¢æœºé…ç½®ä¸ºport channel</li><li>mod=3ï¼Œå³ï¼šbroadcastï¼ˆå¹¿æ’­ç­–ç•¥ï¼‰è¿™ç§æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯ä¸€ä¸ªæŠ¥æ–‡ä¼šå¤åˆ¶ä¸¤ä»½å¾€bondä¸‹çš„ä¸¤ä¸ªæ¥å£åˆ†åˆ«å‘é€å‡ºå»ï¼Œ<br>å½“æœ‰å¯¹ç«¯äº¤æ¢æœºå¤±æ•ˆï¼Œæ„Ÿè§‰ä¸åˆ°ä»»ä½•downtimeï¼Œä½†æ­¤æ³•è¿‡äºæµªè´¹èµ„æºï¼›ä¸è¿‡è¿™ç§æ¨¡å¼æœ‰å¾ˆå¥½çš„å®¹é”™æœºåˆ¶ã€‚æ­¤æ¨¡å¼é€‚ç”¨äºé‡‘èè¡Œä¸šï¼Œå› ä¸ºä»–ä»¬éœ€è¦é«˜å¯é æ€§çš„ç½‘ç»œï¼Œä¸å…è®¸å‡ºç°ä»»ä½•é—®é¢˜ã€‚</li><li>mod=4ï¼Œå³ï¼š(802.3ad) IEEE 802.3ad Dynamic link aggregationï¼ˆIEEE 802.3ad åŠ¨æ€é“¾æ¥èšåˆï¼‰<br>åœ¨åŠ¨æ€èšåˆæ¨¡å¼ä¸‹ï¼Œèšåˆç»„å†…çš„æˆå‘˜ç«¯å£ä¸Šå‡å¯ç”¨LACPï¼ˆé“¾è·¯æ±‡èšæ§åˆ¶åè®®ï¼‰åè®®ï¼Œå…¶ç«¯å£çŠ¶æ€é€šè¿‡è¯¥åè®®è‡ªåŠ¨è¿›è¡Œç»´æŠ¤ã€‚<br>è´Ÿè½½å‡è¡¡â€”åŸºäºæŒ‡å®šçš„ä¼ è¾“HASHç­–ç•¥ä¼ è¾“æ•°æ®åŒ…ã€‚é»˜è®¤ç®—æ³•ä¸blance-xorä¸€æ ·ã€‚<br>å®¹é”™èƒ½åŠ›â€”è¿™æ¨¡å¼çš„ç‰¹ç‚¹å¢åŠ äº†å¸¦å®½ï¼ŒåŒæ—¶æ”¯æŒå®¹é”™èƒ½åŠ›ï¼Œå½“æœ‰é“¾è·¯å‡ºé—®é¢˜ï¼Œä¼šæŠŠæµé‡åˆ‡æ¢åˆ°æ­£å¸¸çš„é“¾è·¯ä¸Šã€‚å¯¹æ¯”blance-xorï¼Œè¿™ç§æ¨¡å¼å®šæœŸå‘é€LACPDUæŠ¥æ–‡ç»´æŠ¤é“¾è·¯èšåˆçŠ¶æ€ï¼Œä¿è¯é“¾è·¯è´¨é‡ã€‚éœ€è¦äº¤æ¢æœºæ”¯æŒLACPåè®®</li><li>mod=5ï¼Œå³ï¼š(balance-tlb) Adaptive transmit load balancingï¼ˆé€‚é…å™¨ä¼ è¾“è´Ÿè½½å‡è¡¡ï¼‰<br>åœ¨æ¯ä¸ªç‰©ç†æ¥å£ä¸Šæ ¹æ®å½“å‰çš„è´Ÿè½½ï¼ˆæ ¹æ®é€Ÿåº¦è®¡ç®—ï¼‰åˆ†é…å¤–å‡ºæµé‡ã€‚å¦‚æœæ­£åœ¨æ¥æ”¶æ•°æ®çš„ç‰©ç†æ¥å£å£å‡ºæ•…éšœäº†ï¼Œå¦ä¸€ä¸ªç‰©ç†æ¥å£æ¥ç®¡è¯¥æ•…éšœç‰©ç†å£çš„MACåœ°å€ã€‚<br>éœ€è¦ethtoolæ”¯æŒè·å–æ¯ä¸ªslaveçš„é€Ÿç‡</li><li>mod=6ï¼Œå³ï¼š(balance-alb) Adaptive load balancingï¼ˆé€‚é…å™¨é€‚åº”æ€§è´Ÿè½½å‡è¡¡ï¼‰<br>è¯¥æ¨¡å¼åŒ…å«äº†balance-tlbæ¨¡å¼ï¼ŒåŒæ—¶åŠ ä¸Šé’ˆå¯¹IPV4æµé‡çš„æ¥æ”¶è´Ÿè½½å‡è¡¡ï¼Œè€Œä¸”ä¸éœ€è¦ä»»ä½•switch(äº¤æ¢æœº)çš„æ”¯æŒã€‚æ¥æ”¶è´Ÿè½½å‡è¡¡æ˜¯é€šè¿‡ARPåå•†å®ç°çš„ã€‚bondingé©±åŠ¨æˆªè·æœ¬æœºå‘é€çš„ARPåº”ç­”ï¼Œå¹¶æŠŠæºç¡¬ä»¶åœ°å€æ”¹å†™ä¸ºbondä¸­æŸä¸ªç‰©ç†æ¥å£çš„å”¯ä¸€ç¡¬ä»¶åœ°å€ï¼Œä»è€Œä½¿å¾—ä¸åŒçš„å¯¹ç«¯ä½¿ç”¨ä¸åŒçš„ç¡¬ä»¶åœ°å€è¿›è¡Œé€šä¿¡ã€‚<br>mod=6ä¸mod=0çš„åŒºåˆ«ï¼šmod=6ï¼Œå…ˆæŠŠeth0æµé‡å æ»¡ï¼Œå†å eth1ï¼Œâ€¦.ethXï¼›è€Œmod=0çš„è¯ï¼Œä¼šå‘ç°2ä¸ªå£çš„æµé‡éƒ½å¾ˆç¨³å®šï¼ŒåŸºæœ¬ä¸€æ ·çš„å¸¦å®½ã€‚è€Œmod=6ï¼Œä¼šå‘ç°ç¬¬ä¸€ä¸ªå£æµé‡å¾ˆé«˜ï¼Œç¬¬2ä¸ªå£åªå äº†å°éƒ¨åˆ†æµé‡</li></ul><h2 id="é¦–å…ˆ"><a href="#é¦–å…ˆ" class="headerlink" title="é¦–å…ˆ"></a>é¦–å…ˆ</h2><p>é“¾æ¥ï¼š</p><p><a href="https://developer.aliyun.com/article/503848">https://developer.aliyun.com/article/503848</a></p><p><a href="https://www.cnblogs.com/5201351/p/4990187.html">https://www.cnblogs.com/5201351/p/4990187.html</a></p><p>å…ˆæŸ¥çœ‹ä¸€ä¸‹å†…æ ¸æ˜¯å¦å·²ç»æ”¯æŒbonding</p><p>1ï¼‰å¦‚æœå†…æ ¸å·²ç»æŠŠbondingç¼–è¯‘è¿›å†…æ ¸ï¼Œé‚£ä¹ˆè¦åšçš„å°±æ˜¯åŠ è½½è¯¥æ¨¡å—åˆ°å½“å‰å†…æ ¸ï¼›å…¶æ¬¡æŸ¥çœ‹ifenslaveè¯¥å·¥å…·æ˜¯å¦ä¹Ÿå·²ç»ç¼–è¯‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">modprobe  -l   bond\*  æˆ–è€… modinfo   bonding</span><br><span class="line"><span class="comment"># åŠ è½½</span></span><br><span class="line">modprobe --first-time bonding</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">modprobe   bonding </span><br><span class="line">lsmod | grep <span class="string">&#x27;bonding&#x27;</span></span><br><span class="line"><span class="comment"># è®¾ç½®å¼€æœºåŠ è½½</span></span><br><span class="line"><span class="built_in">echo</span>  <span class="string">&#x27;modprobe bonding &amp;&gt; /dev/null&#x27;</span>  &gt;&gt;  /etc/rc.local </span><br><span class="line"><span class="built_in">which</span>  ifenslave</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šé»˜è®¤å†…æ ¸å®‰è£…å®Œåå°±å·²ç»æ”¯æŒbondingæ¨¡å—äº†ï¼Œæ— éœ€è¦è‡ªå·±æ‰‹åŠ¨ç¼–è¯‘</p><h2 id="æ¦‚è§ˆï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰"><a href="#æ¦‚è§ˆï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰" class="headerlink" title="æ¦‚è§ˆï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰"></a>æ¦‚è§ˆï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰</h2><blockquote><p>ç¤ºä¾‹å‘½ä»¤ï¼š</p><p>nmcli connection add type bond ifname bond0 con-name bond0 miimon 100 mode active-backup primary ens33 ipv4.method manual ipv4.addresses 192.168.221.232/24 ipv4.gateway 192.168.221.25</p><p>å‚æ•°ï¼ˆè‹¥æ²¡æœ‰æŒ‡å®š åˆ™éœ€è¦æ‰‹åŠ¨æ›´æ”¹é…ç½® bond ç½‘å¡æ–‡ä»¶ ifcfg-bond0 ï¼‰ï¼š</p><ul><li>ipv4.gateway 192.168.221.25 ï¼š ä¸ºå¯é€‰å‚æ•°å³é…ç½®bondçš„ç½‘å…³</li><li>/24 ï¼šå³bondçš„å­ç½‘æ©ç </li><li>ipv4.dns 8.8.8.8ï¼šé…ç½®bondçš„dnsï¼ˆå¯é€‰å‚æ•°ï¼‰</li></ul></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ bondingæ¥å£</span></span><br><span class="line">nmcli con add <span class="built_in">type</span> bond con-name bond0 ifname bond0 mode 1 miimon 100  ipv4.method manual ipv4.addresses 10.0.0.100/24 ipv4.gateway 10.0.0.220 ipv4.dns 223.5.5.5</span><br><span class="line"><span class="comment"># æ·»åŠ ä»å±æ¥å£</span></span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens224 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens256 master bond0</span><br><span class="line"><span class="comment"># æ³¨ï¼šå¦‚æ— ä¸ºä»å±æ¥å£æä¾›è¿æ¥åï¼Œåˆ™è¯¥åç§°æ˜¯æ¥å£åç§°åŠ ç±»å‹æ„æˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¦å¯åŠ¨ç»‘å®šï¼Œåˆ™å¿…é¡»é¦–å…ˆå¯åŠ¨ä»å±æ¥å£</span></span><br><span class="line">nmcli con up bond-slave-ens224</span><br><span class="line">nmcli con up bond-slave-ens256</span><br><span class="line"><span class="comment"># å¯åŠ¨ç»‘å®š</span></span><br><span class="line">nmcli con up bond0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤bond</span></span><br><span class="line">nmcli con del bond0</span><br><span class="line"><span class="comment"># åˆ é™¤ç»‘å®šçš„ç½‘å¡</span></span><br><span class="line">nmcli con del bond-slave-ens160</span><br><span class="line">nmcli con del bond-slave-ens224</span><br></pre></td></tr></table></figure><h2 id="è¯´æ˜-æœ¬æ¬¡ä½¿ç”¨vmwareå®éªŒ-ï¼š"><a href="#è¯´æ˜-æœ¬æ¬¡ä½¿ç”¨vmwareå®éªŒ-ï¼š" class="headerlink" title="è¯´æ˜(æœ¬æ¬¡ä½¿ç”¨vmwareå®éªŒ )ï¼š"></a>è¯´æ˜(æœ¬æ¬¡ä½¿ç”¨vmwareå®éªŒ )ï¼š</h2><blockquote><p>ä¸‹æ–¹ä¿ç•™ens160ä¸ens224 å®é™…ä¸º ens224 ä¸ ens256</p></blockquote><p>å¸¸ç”¨çš„æ¨¡å¼ä¸º 0,1,3,6<br>mode 1ã€5ã€6       ä¸éœ€è¦äº¤æ¢æœºè®¾ç½®<br>mode 0ã€2ã€3ã€4  éœ€è¦äº¤æ¢æœºè®¾ç½®<br>active-backupã€balance-tlb å’Œ balance-alb æ¨¡å¼ä¸éœ€è¦äº¤æ¢æœºçš„ä»»ä½•ç‰¹æ®Šé…ç½®ã€‚å…¶ä»–ç»‘å®šæ¨¡å¼éœ€è¦é…ç½®äº¤æ¢æœºä»¥ä¾¿æ•´åˆé“¾æ¥ã€‚å¦‚ï¼šCisco äº¤æ¢æœºéœ€è¦åœ¨æ¨¡å¼ 0ã€2 å’Œ 3 ä¸­ä½¿ç”¨ EtherChannelï¼Œä½†åœ¨æ¨¡å¼4ä¸­éœ€è¦ LACPå’ŒEtherChannel</p><h2 id="ä¸€-nmcliå®ç°Bondingï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰"><a href="#ä¸€-nmcliå®ç°Bondingï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰" class="headerlink" title="ä¸€. nmcliå®ç°Bondingï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰"></a>ä¸€. nmcliå®ç°Bondingï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰</h2><h3 id="1-ä¸¤å—ç½‘å¡éƒ½è®¾ç½®ä¸º-Nat-æ¨¡å¼"><a href="#1-ä¸¤å—ç½‘å¡éƒ½è®¾ç½®ä¸º-Nat-æ¨¡å¼" class="headerlink" title="1. ä¸¤å—ç½‘å¡éƒ½è®¾ç½®ä¸º Nat æ¨¡å¼"></a>1. ä¸¤å—ç½‘å¡éƒ½è®¾ç½®ä¸º Nat æ¨¡å¼</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ip a</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:f2:66:78 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp3s0</span><br><span class="line">    inet 10.0.0.10/27 brd 10.0.0.31 scope global noprefixroute ens160</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::20c:29ff:fef2:6678/64 scope <span class="built_in">link</span> noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: ens224: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:f2:66:82 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp19s0</span><br><span class="line">4: ens256: &lt;BROADCAST,MULTICAST,SLAVE&gt; mtu 1500 qdisc fq_codel master bond0 state DOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:f2:66:82 brd ff:ff:ff:ff:ff:ff permaddr 00:0c:29:f2:66:8c</span><br><span class="line">    altname enp27s0</span><br><span class="line">5: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 52:54:00:d4:a9:b3 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºbond0ï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰"><a href="#2-åˆ›å»ºbond0ï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰" class="headerlink" title="2. åˆ›å»ºbond0ï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰"></a>2. åˆ›å»ºbond0ï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰</h3><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li>bond0 ä¸ºbond0çš„åç§°</li><li>ifname æŒ‡å®šDEVICEåç§°</li><li>type æŒ‡å®šbondç±»å‹</li><li>mode æŒ‡å®šbondæ¨¡å¼</li><li>ipv4.addresses æŒ‡å®šbond0åœ°å€</li></ul><p>æ·»åŠ é“¾è·¯èšåˆ bond æ¨¡å¼ï¼Œå®šä¹‰ bond0</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ é“¾è·¯èšåˆ bond æ¨¡å¼ï¼Œå®šä¹‰ bond0</span></span><br><span class="line">nmcli connection add con-name bond0 ifname bond0 <span class="built_in">type</span> bond miimon 100 mode active-backup ipv4.method manual ipv4.addresses 10.0.0.100/24</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_368aa9c5e4593d8aa1812c310f7d5e12.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_368aa9c5e4593d8aa1812c310f7d5e12.png"></p><p>è¿™é‡Œæ¼”ç¤ºæ¨¡å¼é‡‡ç”¨ active-backup ï¼Œå¯¹åº”ä¸»å¤‡æ¨¡å¼ï¼Œå³ mode=1 å¦‚éœ€è¦çš„æ˜¯å…¶ä»–æ¨¡å¼åªéœ€è¦æ›´æ”¹ï¼šactive-backup æ”¹ä¸ºå…¶ä»–æ¯”å¦‚æ”¹ä¸ºï¼š balance-rr</p><p>ä¿®æ”¹ç½‘å£é…ç½®æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„ç½‘å¡é…ç½®æ–‡ä»¶ä¸­å·²åŒ…å«ä¸‹è¿°éƒ¨åˆ†é…ç½®ï¼Œè¯·ä»”ç»†æ ¸å¯¹ï¼Œç¡®<br>ä¿ä¸‹è¿°é…ç½®å†…å®¹æ— é—æ¼ä¸”æ­£ç¡®ï¼‰<br>vim ifcfg-bond0<br>åœ¨ /etc/sysconfig/network-scripts/ ç›®å½•ä¸‹ï¼Œç¼–å†™ ifcfg-bond0<br>DEVICE=bond0<br>ONBOOT=yes<br>BOOTPROTO=none<br>IPADDR=10.0.0.12<br>NETMASK=24<br>TYPE=Bond<br>BONDING_OPTS=mode=active-backup<br>GATEWAY=10.0.0.220<br>DNS1=223.5.5.5</p><p><strong>æŸ¥çœ‹æ·»åŠ è¯¦æƒ…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ·»åŠ è¯¦æƒ…</span></span><br><span class="line">nmcli connection</span><br><span class="line"></span><br><span class="line">// è¿”å›</span><br><span class="line">NAME    UUID                                  TYPE      DEVICE </span><br><span class="line">ens160  ff7bd1f0-e937-42c0-bba2-1b069e9477c7  ethernet  ens160 </span><br><span class="line">bond0   2a465bf9-89ea-4a3b-b6ae-a94dde548b77  bond      bond0  </span><br><span class="line">virbr0  f51041d3-c680-4162-90d8-0da1c1a32fcd  bridge    virbr0 </span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç”Ÿæˆçš„ç½‘å¡é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">ls</span> /etc/sysconfig/network-scripts/</span><br><span class="line"></span><br><span class="line">// è¿”å›</span><br><span class="line">ifcfg-bond0  ifcfg-ens160</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤æ—¶ç”Ÿæˆé…ç½®æ–‡ä»¶ifcfg-bond0 æŸ¥çœ‹æ–‡ä»¶è¯¦æƒ…</span></span><br><span class="line">[root@localhost network-scripts]<span class="comment"># cat /etc/sysconfig/network-scripts/ifcfg-bond0</span></span><br><span class="line">BONDING_OPTS=mode=active-backup</span><br><span class="line">TYPE=Bond</span><br><span class="line">BONDING_MASTER=<span class="built_in">yes</span></span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">IPADDR=10.0.0.10</span><br><span class="line">PREFIX=24</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=default</span><br><span class="line">NAME=bond0</span><br><span class="line">UUID=2a465bf9-89ea-4a3b-b6ae-a94dde548b77</span><br><span class="line">DEVICE=bond0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">GATEWAY=10.0.0.220  <span class="comment"># æ–°åŠ </span></span><br><span class="line">DNS1=223.5.5.5      <span class="comment"># æ–°åŠ </span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3-æ·»åŠ ç«¯å£è‡³bond0ä¸­"><a href="#3-æ·»åŠ ç«¯å£è‡³bond0ä¸­" class="headerlink" title="3. æ·»åŠ ç«¯å£è‡³bond0ä¸­"></a>3. æ·»åŠ ç«¯å£è‡³bond0ä¸­</h2><p>å°†ç½‘å¡ens160  å’Œens224 æ·»åŠ è‡³ bond0 ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection add <span class="built_in">type</span> bond-slave ifname ens160 master bond0</span><br><span class="line">nmcli connection add <span class="built_in">type</span> bond-slave ifname ens224 master bond0</span><br><span class="line"><span class="comment"># æ³¨æ„é¡ºåº</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹è¯¦æƒ…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ·»åŠ è¯¦æƒ…</span></span><br><span class="line">nmcli con</span><br><span class="line"></span><br><span class="line">// è¿”å›</span><br><span class="line">NAME               UUID                                  TYPE      DEVICE </span><br><span class="line">ens160             ff7bd1f0-e937-42c0-bba2-1b069e9477c7  ethernet  ens160 </span><br><span class="line">bond0              3a11f05c-c92f-4804-be4f-c04506e819d2  bond      bond0  </span><br><span class="line">virbr0             ba243c12-4f52-4b97-bfbd-c1d57dde75a9  bridge    virbr0 </span><br><span class="line">bond-slave-ens224  6ffdb9e4-6e02-4c53-a266-64702b3c5e40  ethernet  ens224 </span><br><span class="line">bond-slave-ens160  034ea11e-1f8c-43e0-b062-90559525284f  ethernet  --  </span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç”Ÿæˆçš„ç½‘å¡é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">ls</span> /etc/sysconfig/network-scripts/</span><br><span class="line"></span><br><span class="line">// è¿”å›</span><br><span class="line">ifcfg-bond0  ifcfg-bond-slave-ens160  ifcfg-bond-slave-ens224  ifcfg-ens160</span><br></pre></td></tr></table></figure><p><strong>å¯ç”¨bond0</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¦å¯åŠ¨ç»‘å®šï¼Œåˆ™å¿…é¡»é¦–å…ˆå¯åŠ¨ä»å±æ¥å£ </span></span><br><span class="line">nmcli con up bond-slave-ens160</span><br><span class="line">nmcli con up bond-slave-ens224</span><br><span class="line"><span class="comment"># å¯åŠ¨ç»‘å®š</span></span><br><span class="line">nmcli con up bond0</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e2c2c083a0072a5bc7dcabf6335b41d1.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e2c2c083a0072a5bc7dcabf6335b41d1.png"></p><h3 id="4-æ•ˆæœ"><a href="#4-æ•ˆæœ" class="headerlink" title="4. æ•ˆæœ"></a>4. æ•ˆæœ</h3><p>æŸ¥çœ‹IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens160: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc mq master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff permaddr 00:0c:29:2d:25:5a</span><br><span class="line">    altname enp3s0</span><br><span class="line">3: ens224: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc mq master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp19s0</span><br><span class="line">4: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 52:54:00:d9:ea:56 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">5: bond0: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.0.0.10/24 brd 10.0.0.255 scope global noprefixroute bond0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e3a9:7228:e43a:9138/64 scope <span class="built_in">link</span> noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹bondçŠ¶æ€</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Every 1.0s: <span class="built_in">cat</span> /proc/net/bonding/bond0                                                                                   localhost.localdomain: Tue May  7 11:33:36 2024</span><br><span class="line"></span><br><span class="line">Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)</span><br><span class="line"></span><br><span class="line">Bonding Mode: fault-tolerance (active-backup)</span><br><span class="line">Primary Slave: None</span><br><span class="line">Currently Active Slave: ens224  <span class="comment"># ens224 æ˜¯ä¸»</span></span><br><span class="line">MII Status: up</span><br><span class="line">MII Polling Interval (ms): 100</span><br><span class="line">Up Delay (ms): 0</span><br><span class="line">Down Delay (ms): 0</span><br><span class="line">Peer Notification Delay (ms): 0</span><br><span class="line"></span><br><span class="line">Slave Interface: ens224</span><br><span class="line">MII Status: up</span><br><span class="line">Speed: 10000 Mbps</span><br><span class="line">Duplex: full</span><br><span class="line">Link Failure Count: 0</span><br><span class="line">Permanent HW addr: 00:0c:29:2d:25:64</span><br><span class="line">Slave queue ID: 0</span><br><span class="line"></span><br><span class="line">Slave Interface: ens160</span><br><span class="line">MII Status: up</span><br><span class="line">Speed: 10000 Mbps</span><br><span class="line">Duplex: full</span><br><span class="line">Link Failure Count: 0</span><br><span class="line">Permanent HW addr: 00:0c:29:2d:25:5a</span><br><span class="line">Slave queue ID: 0</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f3cfde6318f3ab37148e4d6822104dba.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f3cfde6318f3ab37148e4d6822104dba.png"></p><h3 id="5-æ‰©å±•-åˆ é™¤bond"><a href="#5-æ‰©å±•-åˆ é™¤bond" class="headerlink" title="5. æ‰©å±• åˆ é™¤bond"></a>5. æ‰©å±• åˆ é™¤bond</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤bond</span></span><br><span class="line">nmcli con del mybond0</span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¯¦æƒ…</span></span><br><span class="line">nmcli con</span><br><span class="line"><span class="comment"># åˆ é™¤ä»å±</span></span><br><span class="line">nmcli con del bond-slave-ens33</span><br><span class="line">nmcli con del bond-slave-ens36</span><br></pre></td></tr></table></figure><h1 id="äºŒ-ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®bond-æ­¤ç§é€‚ç”¨äºé€‚ç”¨networkç®¡ç†"><a href="#äºŒ-ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®bond-æ­¤ç§é€‚ç”¨äºé€‚ç”¨networkç®¡ç†" class="headerlink" title="äºŒ. ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®bond(æ­¤ç§é€‚ç”¨äºé€‚ç”¨networkç®¡ç†)"></a>äºŒ. ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®bond(æ­¤ç§é€‚ç”¨äºé€‚ç”¨networkç®¡ç†)</h1><p><strong>æ¦‚è§ˆ(å‘½ä»¤æ–¹å¼ä¸‰è¡Œå‘½ä»¤å³å¯æ¨èä½¿ç”¨æ­¤ç§)ï¼š</strong></p><p>å¯ä»¥<strong>å…ˆæ‰“å¼€NetworkManager</strong>æœåŠ¡æ‰§è¡Œå®Œæˆä¸‹æ–¹å‘½ä»¤å<strong>å†å°†å…¶å…³é—­</strong> æœ€å<strong>é‡å¯network</strong>æœåŠ¡</p><p>å‚æ•°ï¼šmode active-backup miimon 100 å¯å†™ä¸º mode 1 miimon 100</p><p>ä½¿ç”¨mode 1 miimon 100æ—¶</p><p>BONDING_OPTS=mode=active-backup å˜ä¸º BONDING_OPTS=â€mode=active-backup miimon=100â€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection add con-name bond0 ifname bond0 <span class="built_in">type</span> bond mode active-backup miimon 100 ipv4.addresses 10.0.0.60/24 ipv4.gateway 10.0.0.220 ipv4.dns 223.5.5.5</span><br><span class="line"></span><br><span class="line">nmcli connection add con-name ens224 ifname ens224 <span class="built_in">type</span> bond-slave master bond0</span><br><span class="line">nmcli connection add con-name ens256 ifname ens256 <span class="built_in">type</span> bond-slave master bond0</span><br></pre></td></tr></table></figure><h2 id="1-NATç½‘ç»œé…ç½®ï¼ˆæ‰€æœ‰æœåŠ¡å™¨ï¼‰ï¼š"><a href="#1-NATç½‘ç»œé…ç½®ï¼ˆæ‰€æœ‰æœåŠ¡å™¨ï¼‰ï¼š" class="headerlink" title="1.NATç½‘ç»œé…ç½®ï¼ˆæ‰€æœ‰æœåŠ¡å™¨ï¼‰ï¼š"></a>1.NATç½‘ç»œé…ç½®ï¼ˆæ‰€æœ‰æœåŠ¡å™¨ï¼‰ï¼š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yumÂ installÂ bash-completion</span><br><span class="line"><span class="built_in">cd</span>Â /etc/sysconfig/network-scripts/</span><br></pre></td></tr></table></figure><h3 id="bond0é…ç½®-å®é™…ä¸­è®°å¾—å°†dhcpæ”¹ä¸ºstatic"><a href="#bond0é…ç½®-å®é™…ä¸­è®°å¾—å°†dhcpæ”¹ä¸ºstatic" class="headerlink" title="bond0é…ç½®(å®é™…ä¸­è®°å¾—å°†dhcpæ”¹ä¸ºstatic)"></a>bond0é…ç½®(å®é™…ä¸­è®°å¾—å°†dhcpæ”¹ä¸ºstatic)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s1 network-scripts]<span class="comment"># cat ifcfg-bond0 </span></span><br><span class="line">BONDING_OPTS=mode=active-backup</span><br><span class="line">TYPE=Bond</span><br><span class="line">BONDING_MASTER=<span class="built_in">yes</span></span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">IPADDR=10.0.0.60</span><br><span class="line">PREFIX=24</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=default</span><br><span class="line">NAME=bond0</span><br><span class="line">UUID=a0a8a96c-ec86-4cbe-8b36-849bb4aa20a6</span><br><span class="line">DEVICE=bond0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>ens224é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s1 network-scripts]<span class="comment"># cat ifcfg-ens224 </span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOND_PORT_QUEUE_ID=0</span><br><span class="line">BOND_PORT_PRIO=0</span><br><span class="line">NAME=ens224</span><br><span class="line">UUID=8855f02c-a2e6-48e7-86ad-0320382a445a</span><br><span class="line">DEVICE=ens224</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">MASTER=bond0</span><br><span class="line">SLAVE=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>ens256é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s1 network-scripts]<span class="comment"># cat ifcfg-ens224 </span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOND_PORT_QUEUE_ID=0</span><br><span class="line">BOND_PORT_PRIO=0</span><br><span class="line">NAME=ens224</span><br><span class="line">UUID=8855f02c-a2e6-48e7-86ad-0320382a445a</span><br><span class="line">DEVICE=ens224</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">MASTER=bond0</span><br><span class="line">SLAVE=<span class="built_in">yes</span></span><br><span class="line">[root@k8s1 network-scripts]<span class="comment"># cat ifcfg-ens256</span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOND_PORT_QUEUE_ID=0</span><br><span class="line">BOND_PORT_PRIO=0</span><br><span class="line">NAME=ens256</span><br><span class="line">UUID=c3358675-54e0-43f0-afc9-e8a3a13ad9ed</span><br><span class="line">DEVICE=ens256</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">MASTER=bond0</span><br><span class="line">SLAVE=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>é‡å¯ç½‘å¡ç”Ÿæ•ˆï¼šsystemctl restart network</strong></p><p><strong>éªŒè¯</strong></p><ul><li>é‡å¯ç³»ç»Ÿçœ‹èƒ½å¦æ­£å¸¸å¯åŠ¨bond0    ï¼ˆæ­£å¸¸å¯åŠ¨ï¼‰</li><li>æ‰‹åŠ¨downæ‰ç½‘å¡çœ‹èƒ½å¦æ­£å¸¸åˆ‡æ¢ï¼ˆæŸ¥çœ‹bondå‘½ä»¤ <code>cat /proc/net/bonding/bond0</code>ï¼‰(æ­£å¸¸åˆ‡æ¢)</li><li>æŸ¥çœ‹ç½‘å¡çŠ¶æ€ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s1 network-scripts]<span class="comment"># ip a</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:5a brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp3s0</span><br><span class="line">    inet 10.0.0.10/24 brd 10.0.0.255 scope global noprefixroute ens160</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet 10.0.0.187/24 brd 10.0.0.255 scope global secondary dynamic noprefixroute ens160</span><br><span class="line">       valid_lft 1174sec preferred_lft 1174sec</span><br><span class="line">    inet6 fe80::20c:29ff:fe2d:255a/64 scope <span class="built_in">link</span> noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: ens224: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc mq master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp19s0</span><br><span class="line">4: ens256: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc mq master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff permaddr 00:0c:29:2d:25:6e</span><br><span class="line">    altname enp27s0</span><br><span class="line">5: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 52:54:00:d9:ea:56 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">6: bond0: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.0.0.60/24 brd 10.0.0.255 scope global noprefixroute bond0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::95d7:d04b:3ab3:49f1/64 scope <span class="built_in">link</span> noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure></li></ul><p>4.å†…å¤–ç½‘é€šä¿¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Â pingÂ www.baidu.com</span></span><br><span class="line"><span class="comment">#Â pingÂ 192.168.20.2</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/qq_43652666/article/details/119175635">https://blog.csdn.net/qq_43652666/article/details/119175635</a></p><p><a href="https://blog.csdn.net/m0_59586152/article/details/125503956">https://blog.csdn.net/m0_59586152/article/details/125503956</a></p><p><a href="https://www.cnblogs.com/waacode/p/17539417.html">https://www.cnblogs.com/waacode/p/17539417.html</a></p><p><a href="https://www.modb.pro/db/128078">ç¬¬25ç¯‡ centos 8 åŒç½‘å¡ç»‘å®šï¼ˆbondé“¾è·¯èšåˆï¼‰ - å¢¨å¤©è½® (modb.pro)</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰</title>
      <link href="/2024/05/05/lvm%E6%9B%B4%E6%8D%A2%E7%A3%81%E7%9B%98%EF%BC%88%E5%AD%98%E5%9C%A8vg%E5%8D%B7%E7%BB%84%E7%9A%84%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%EF%BC%89/"/>
      <url>/2024/05/05/lvm%E6%9B%B4%E6%8D%A2%E7%A3%81%E7%9B%98%EF%BC%88%E5%AD%98%E5%9C%A8vg%E5%8D%B7%E7%BB%84%E7%9A%84%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰"><a href="#lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰" class="headerlink" title="lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰"></a>lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰</h1><blockquote><p>åªå«æœ‰pvçš„ç£ç›˜æŸåæ›´æ¢ | <a href="http://sunlight.zznnwn.cloudns.biz/2024/04/24/%E5%A4%9A%E5%9D%97%E7%A3%81%E7%9B%98%E9%85%8D%E7%BD%AElvm%E5%8D%B7%20%E4%B8%8D%E5%90%ABvg%E5%8D%B7%E7%9A%84%E6%9F%90%E5%9D%97%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%E8%A7%A3%E5%86%B3/">ä¼ é€é—¨&gt;&gt;</a></p><p>å¯¹äºæœºæ¢°ç¡¬ç›˜è€Œè¨€ï¼Œç»å¸¸ä¼šå‡ºç°åé“ï¼Œå½±å“æ•´ä½“çš„ç£ç›˜è¯»å†™é€Ÿåº¦ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦æ›´æ¢æ•…éšœçš„ç¡¬ç›˜ï¼Œæ¥ä¸‹æ¥æ¨¡æ‹Ÿæ“ä½œæ•´ä¸ªæ›´æ¢è¿‡ç¨‹ã€‚</p></blockquote><h2 id="ä¸€-æµ‹è¯•ç¯å¢ƒé…ç½®-åˆ›å»ºlvmå·æŒ‚è½½å¹¶ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸€-æµ‹è¯•ç¯å¢ƒé…ç½®-åˆ›å»ºlvmå·æŒ‚è½½å¹¶ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸€. æµ‹è¯•ç¯å¢ƒé…ç½® åˆ›å»ºlvmå·æŒ‚è½½å¹¶ä¸Šä¼ æ–‡ä»¶"></a>ä¸€. æµ‹è¯•ç¯å¢ƒé…ç½® åˆ›å»ºlvmå·æŒ‚è½½å¹¶ä¸Šä¼ æ–‡ä»¶</h2><h3 id="1-æµ‹è¯•ç¯å¢ƒ"><a href="#1-æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="1.æµ‹è¯•ç¯å¢ƒ"></a>1.æµ‹è¯•ç¯å¢ƒ</h3><p>æ“ä½œç³»ç»Ÿï¼šubuntu20.04</p><p>ç¡¬ç›˜ï¼šå‡†å¤‡3å—5GBçš„ç¡¬ç›˜ç”¨äºæµ‹è¯•</p><h3 id="2-å‰ææ¡ä»¶åˆ›å»ºlvmå·"><a href="#2-å‰ææ¡ä»¶åˆ›å»ºlvmå·" class="headerlink" title="2.å‰ææ¡ä»¶åˆ›å»ºlvmå·"></a>2.å‰ææ¡ä»¶åˆ›å»ºlvmå·</h3><p>ä½¿ç”¨sdbã€sdcåŠ å…¥LVMå¹¶é…ç½®lvï¼Œåˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPV</span></span><br><span class="line">pvcreate /dev/sd&#123;b..c&#125;   </span><br><span class="line"><span class="comment"># åˆ›å»ºVG</span></span><br><span class="line">vgcreate vg00 /dev/sdb /dev/sdc  </span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ª8GBçš„LV</span></span><br><span class="line">lvcreate -n lv00 -L 8G vg00  </span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8827a051a031111cb47e8e85d0f319fe.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8827a051a031111cb47e8e85d0f319fe.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_fb1428a67eb75bf19a574c17ca127574.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_fb1428a67eb75bf19a574c17ca127574.png"></p><h3 id="3-æ ¼å¼åŒ–LVå¹¶æŒ‚è½½"><a href="#3-æ ¼å¼åŒ–LVå¹¶æŒ‚è½½" class="headerlink" title="3. æ ¼å¼åŒ–LVå¹¶æŒ‚è½½"></a>3. æ ¼å¼åŒ–LVå¹¶æŒ‚è½½</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¼å¼åŒ–ä¸ºext4æ ¼å¼</span></span><br><span class="line">mkfs.ext4 /dev/vg00/lv00  </span><br><span class="line"><span class="comment"># åˆ›å»ºæŒ‚è½½ç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> /lv00_datadir   </span><br><span class="line"><span class="comment"># æŒ‚è½½</span></span><br><span class="line">mount /dev/vg00/lv00 /lv00_datadir  </span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1827ebb3ba929ebaa9a949fca6455667.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1827ebb3ba929ebaa9a949fca6455667.png"></p><p>ä¸Šä¼ æµ‹è¯•æ–‡ä»¶ï¼Œæˆ‘åœ¨è¿™é‡Œä¸Šä¼ ä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œçº¦ä¸º15Må·¦å³ï¼›</p><p>ä½¿ç”¨md5sumå‘½ä»¤æ¥éªŒè¯ç¡¬ç›˜æ›´æ¢åæ•°æ®çš„å®Œæ•´æ€§ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶md5</span></span><br><span class="line"><span class="built_in">md5sum</span> /lv00_datadir/cirros-0.4.0-x86_64-disk.img</span><br><span class="line">// è¿”å›</span><br><span class="line">443b7623e27ecf03dc9e01ee93f67afe  /lv00_datadir/cirros-0.4.0-x86_64-disk.img</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8449f31b43f6f17a71494598fc1e2ec4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8449f31b43f6f17a71494598fc1e2ec4.png"></p><h2 id="äºŒ-æ›´æ¢ç£ç›˜-è¿ç§»åé“ç£ç›˜æ•°æ®"><a href="#äºŒ-æ›´æ¢ç£ç›˜-è¿ç§»åé“ç£ç›˜æ•°æ®" class="headerlink" title="äºŒ. æ›´æ¢ç£ç›˜ è¿ç§»åé“ç£ç›˜æ•°æ®"></a>äºŒ. æ›´æ¢ç£ç›˜ è¿ç§»åé“ç£ç›˜æ•°æ®</h2><p>å‡è®¾ sdb ç›®å‰å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œéœ€è¦ä½¿ç”¨ sdd æ¥æ›¿æ¢ï¼š</p><h3 id="1-é…ç½®sdd"><a href="#1-é…ç½®sdd" class="headerlink" title="1.é…ç½®sdd"></a>1.é…ç½®sdd</h3><p>å°† sdd åˆ†åŒºååŠ å…¥åˆ° VG ä¸­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†sddåˆ›å»ºpvå·</span></span><br><span class="line">pvcreate /dev/sdd</span><br><span class="line"><span class="comment"># å°†sddåŠ å…¥vgå·</span></span><br><span class="line">vgextend vg00 /dev/sdd</span><br></pre></td></tr></table></figure><h3 id="2-è¿ç§»æ•°æ®"><a href="#2-è¿ç§»æ•°æ®" class="headerlink" title="2. è¿ç§»æ•°æ®"></a>2. è¿ç§»æ•°æ®</h3><h4 id="2-1-é€šè¿‡pvdisplayå‘½ä»¤æ¥æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š"><a href="#2-1-é€šè¿‡pvdisplayå‘½ä»¤æ¥æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š" class="headerlink" title="2.1 é€šè¿‡pvdisplayå‘½ä»¤æ¥æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š"></a>2.1 é€šè¿‡pvdisplayå‘½ä»¤æ¥æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹pvå·è¯¦æƒ…</span><br><span class="line">pvdisplay /dev/sdb</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_817b1d5249e0b48e8d3076f68c3ba559.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_817b1d5249e0b48e8d3076f68c3ba559.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶çš„sdbåŸºæœ¬è¢«ç”¨æ»¡äº†ï¼Œç›¸åº”åœ°sddè¿˜æ²¡æœ‰å¼€å§‹ä½¿ç”¨ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_4089272617ed1608011e87085bb86d9b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_4089272617ed1608011e87085bb86d9b.png"></p><h4 id="2-2-è¿ç§»æ•°æ®ï¼Œå°†sdbä¸­çš„æ•°æ®è¿ç§»åˆ°sddä¸­ï¼š"><a href="#2-2-è¿ç§»æ•°æ®ï¼Œå°†sdbä¸­çš„æ•°æ®è¿ç§»åˆ°sddä¸­ï¼š" class="headerlink" title="2.2 è¿ç§»æ•°æ®ï¼Œå°†sdbä¸­çš„æ•°æ®è¿ç§»åˆ°sddä¸­ï¼š"></a>2.2 è¿ç§»æ•°æ®ï¼Œå°†sdbä¸­çš„æ•°æ®è¿ç§»åˆ°sddä¸­ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># è¿ç§»sdb pvå·ä¸­çš„æ•°æ®åˆ° sdd</span><br><span class="line">pvmove /dev/sdb /dev/sdd</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8ca50c610533e1eded58b727b1b8c044.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8ca50c610533e1eded58b727b1b8c044.png"></p><p>å†æ¬¡æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pvdisplay /dev/sdb</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_980104501d271293dbf431880b22eca2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_980104501d271293dbf431880b22eca2.png"></p><p>æˆ–è€…ä½¿ç”¨pvscanæŸ¥çœ‹ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_2caa41a0e2c1b5e0807bdc99e46b3054.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_2caa41a0e2c1b5e0807bdc99e46b3054.png"></p><h4 id="2-3-ç§»å‡ºsdb"><a href="#2-3-ç§»å‡ºsdb" class="headerlink" title="2.3 ç§»å‡ºsdb"></a>2.3 ç§»å‡ºsdb</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†sdbä»VGä¸­ç§»å‡º</span></span><br><span class="line">vgreduce vg00 /dev/sdb  </span><br><span class="line"><span class="comment"># åˆ é™¤PV</span></span><br><span class="line">pvremove /dev/sdb  </span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_93fa85b202ffddcbdada05ec2e6aa091.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_93fa85b202ffddcbdada05ec2e6aa091.png"></p><h4 id="2-4-æ£€æŸ¥æ•°æ®å®Œæ•´æ€§"><a href="#2-4-æ£€æŸ¥æ•°æ®å®Œæ•´æ€§" class="headerlink" title="2.4 æ£€æŸ¥æ•°æ®å®Œæ•´æ€§"></a>2.4 æ£€æŸ¥æ•°æ®å®Œæ•´æ€§</h4><p>è¿˜æ˜¯ä½¿ç”¨md5sumå‘½ä»¤æ¥æ£€æŸ¥æ•°æ®å®Œæ•´æ€§ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5sum /lv00_datadir/cirros-0.4.0-x86_64-disk.img</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_51b7a5f9066d34eac92af24ffd2babeb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_51b7a5f9066d34eac92af24ffd2babeb.png"></p><p>æ›´æ¢å‰ä¸æ›´æ¢åè®¡ç®—å‡ºæ¥çš„å€¼éƒ½æ˜¯ä¸€æ ·ï¼Œè¯´æ˜æ•°æ®å®Œæ•´ï¼Œæµ‹è¯•æˆåŠŸã€‚</p><p>æœ¬æ–‡å‚è€ƒï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzkwOTY0NTYzOA==&mid=2247485700&idx=1&sn=35450d4ddf918e6478a1e0af1eaff545&chksm=c136cb2df641423bf4b25c3918b69898582ed4263b0cc2bd633534de05e1b4bc7c7a95ba671d&mpshare=1&scene=24&srcid=0502Gk8XleBsbnh0t6JiGCo9&sharer_shareinfo=84be6c1a5a08f273b8d004edbbc0418a&sharer_shareinfo_first=84be6c1a5a08f273b8d004edbbc0418a#rd">ä¼šæˆé•¿çš„å°å­¦ç”Ÿ</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerè®¾ç½®iptables=falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•</title>
      <link href="/2024/04/29/docker%E8%AE%BE%E7%BD%AEiptables=false%E5%90%8E%E6%97%A0%E6%B3%95%E8%A7%A3%E6%9E%90DNS%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
      <url>/2024/04/29/docker%E8%AE%BE%E7%BD%AEiptables=false%E5%90%8E%E6%97%A0%E6%B3%95%E8%A7%A3%E6%9E%90DNS%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="dockerè®¾ç½®iptables-falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•"><a href="#dockerè®¾ç½®iptables-falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•" class="headerlink" title="dockerè®¾ç½®iptables=falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•"></a>dockerè®¾ç½®iptables=falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•</h1><blockquote><p>æœ¬æ–‡å‚è€ƒï¼š<a href="https://blog.csdn.net/wang805447391/article/details/120719570">dockerè®¾ç½®iptables=falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•_docker iptables false</a></p><p>dockeré»˜è®¤ä½¿ç”¨iptablesè¿›è¡Œç½‘ç»œé…ç½®ï¼Œä¸ufwæœ‰ç‚¹ä¸å…¼å®¹ï¼Œufwæ— æ³•ç®¡æ§dockeræš´éœ²å‡ºæ¥çš„ç«¯å£ï¼Œå¯èƒ½ä¼šé€ æˆä¸€å®šçš„å®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥æŸäº›æƒ…å†µä¸‹éœ€è¦å°†dockerçš„iptablesè®¾ç½®ä¸ºfalseã€‚<br>è®¾ç½®ä¹‹åè¿›å…¥dockerå®¹å™¨å†…éƒ¨å‘ç°æ— æ³•è®¿é—®ç½‘ç»œï¼Œåªèƒ½ä¸172.17.0.1ç½‘æ®µé€šä¿¡ã€‚</p></blockquote><h2 id="è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š"><a href="#è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š"></a>è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</h2><p>sudo systemctl edit docker.service</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">ExecStartPre=/usr/sbin/iptables -t nat -A POSTROUTING -s 172.0.0.0/16 ! -o docker0 -j MASQUERADE</span><br><span class="line">ExecStopPost=/usr/sbin/iptables -t nat -D POSTROUTING -s 172.0.0.0/16 ! -o docker0 -j MASQUERADE</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_411fbc44b1e7914f452aa767b676f8ce.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_411fbc44b1e7914f452aa767b676f8ce.png"></p><p>é…ç½®è§£é‡Šï¼š</p><p>è¿™æ®µé…ç½®çš„ä½œç”¨æ˜¯ä¸ºDockerå®¹å™¨è®¾ç½®ç½‘ç»œåœ°å€è½¬æ¢ï¼ˆNATï¼‰ï¼Œä½¿å¾—ä»172.17.0.0/16å­ç½‘å‘å‡ºçš„æµé‡ç»è¿‡docker0æ¥å£æ—¶è¿›è¡ŒMASQUERADEï¼ˆä¼ªè£…ï¼‰å¤„ç†ï¼Œä»¥å®ç°ç½‘ç»œåœ°å€çš„è½¬æ¢å’Œéšè—ã€‚</p><p>åœ¨è¿™æ®µé…ç½®ä¸­ï¼š</p><ul><li><code>ExecStartPre</code> è¡ŒæŒ‡å®šäº†åœ¨å¯åŠ¨æœåŠ¡ä¹‹å‰æ‰§è¡Œçš„æ“ä½œï¼Œå³å‘iptablesä¸­æ·»åŠ ä¸€ä¸ªPOSTROUTINGè§„åˆ™ï¼Œå¯¹ä»172.17.0.0/16å­ç½‘å‘å‡ºçš„æµé‡è¿›è¡ŒMASQUERADEå¤„ç†ï¼Œä½†æ’é™¤äº†æµé‡ç»è¿‡docker0æ¥å£çš„æƒ…å†µã€‚</li><li><code>ExecStopPost</code> è¡ŒæŒ‡å®šäº†åœ¨åœæ­¢æœåŠ¡ä¹‹åæ‰§è¡Œçš„æ“ä½œï¼Œå³ä»iptablesä¸­åˆ é™¤ä¹‹å‰æ·»åŠ çš„ç›¸åŒè§„åˆ™ã€‚</li></ul><p>è¿™ç§é…ç½®é€šå¸¸ç”¨äºåœ¨Dockerç¯å¢ƒä¸­ç®¡ç†ç½‘ç»œæµé‡ï¼Œç¡®ä¿å®¹å™¨å†…éƒ¨çš„æµé‡èƒ½å¤Ÿæ­£å¸¸åœ°ä¸å¤–éƒ¨é€šä¿¡ï¼Œå¹¶ä¸”å¯¹å¤–éƒ¨ç½‘ç»œéšè—äº†å®¹å™¨å†…éƒ¨çš„çœŸå®IPåœ°å€ã€‚</p><h2 id="ç”Ÿæ•ˆé…ç½®"><a href="#ç”Ÿæ•ˆé…ç½®" class="headerlink" title="ç”Ÿæ•ˆé…ç½®"></a>ç”Ÿæ•ˆé…ç½®</h2><p>sudo systemctl daemon-reload  å³å¯</p><p>systemctl restart docker  æµ‹è¯•dockerèƒ½å¦æ­£å¸¸å¯åŠ¨</p><p>å‚è€ƒèµ„æ–™ï¼š<br><a href="https://gist.github.com/circa10a/e6cfc673af9282d17dfb958ef6adabeb">https://gist.github.com/circa10a/e6cfc673af9282d17dfb958ef6adabeb</a><br><a href="https://github.com/moby/moby/issues/26776">https://github.com/moby/moby/issues/26776</a></p>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤šå—ç£ç›˜é…ç½®lvmå· ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³</title>
      <link href="/2024/04/24/%E5%A4%9A%E5%9D%97%E7%A3%81%E7%9B%98%E9%85%8D%E7%BD%AElvm%E5%8D%B7%20%E4%B8%8D%E5%90%ABvg%E5%8D%B7%E7%9A%84%E6%9F%90%E5%9D%97%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%E8%A7%A3%E5%86%B3/"/>
      <url>/2024/04/24/%E5%A4%9A%E5%9D%97%E7%A3%81%E7%9B%98%E9%85%8D%E7%BD%AElvm%E5%8D%B7%20%E4%B8%8D%E5%90%ABvg%E5%8D%B7%E7%9A%84%E6%9F%90%E5%9D%97%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å¤šå—ç£ç›˜é…ç½®lvmå·-ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³"><a href="#å¤šå—ç£ç›˜é…ç½®lvmå·-ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³" class="headerlink" title="å¤šå—ç£ç›˜é…ç½®lvmå· ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³"></a>å¤šå—ç£ç›˜é…ç½®lvmå· ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³</h1><p><strong>è§£æ</strong></p><p>Linux çš„ LVM ä¼šé»˜è®¤å­˜å‚¨ç”¨æˆ·å¯¹ PV/VG/LV çš„æ¯ä¸€æ­¥æ“ä½œï¼Œå¹¶è‡ªåŠ¨æŠŠå½“å‰çš„ VG çš„ä¿¡æ¯å¤‡ä»½åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œä½ç½®æ˜¯ /etc/lvm/backup/VG åæˆ–è€… /etc/lvm/archive/VG åã€‚è¿™ä¸ªæ–‡ä»¶é‡Œé¢è®°å½•çš„ä¸œè¥¿å¤§æ¦‚è·Ÿ vgdisplay/pvdisplay/lvdisplay è¾“å‡ºçš„ä¿¡æ¯ä¸€è‡´ï¼Œé‡Œé¢ä¹ŸåŒ…æ‹¬äº†å¯¹äºæ¢å¤ VG ä¿¡æ¯è‡³å…³é‡è¦çš„ PV UUIDã€‚</p><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p><p>è¯¯æ“ä½œã€ç£ç›˜å¼‚å¸¸æ‰ç”µç­‰åŸå› å¯èƒ½ä¼šé€ æˆç¡¬ç›˜çš„é€»è¾‘æŸåï¼Œå½“LVMä¸­æŸå—ç¡¬ç›˜å‡ºç°å¼‚å¸¸æ—¶ï¼Œä¼šå¯¼è‡´éƒ¨åˆ†é€»è¾‘å·æˆ–æ•´ä¸ªå·ç»„æ— æ³•è®¿é—®çš„æƒ…å†µã€‚æˆ‘ä»¬æŸ¥çœ‹pvæ—¶ä¼šå‘ç°æç¤ºunknow device,å¹¶æç¤ºâ€œCouldnâ€™t find device with uuid xxxâ€ã€‚é—®é¢˜å¦‚å›¾ï¼Œæœ¬æ–‡ä»‹ç»äº†LVMä¸­æŸå—ç¡¬ç›˜æŸåçš„ç¾éš¾ä¿®å¤ï¼Œæ¥å°½å¯èƒ½æ¢å¤ç¾éš¾æ‰€é€ æˆçš„æ•°æ®æŸå¤±ã€‚</p><h2 id="ä¸€-å…·ä½“ç°è±¡"><a href="#ä¸€-å…·ä½“ç°è±¡" class="headerlink" title="ä¸€. å…·ä½“ç°è±¡"></a><strong>ä¸€. å…·ä½“ç°è±¡</strong></h2><p><strong>æ¨¡æ‹Ÿåå¢ƒï¼šä¸¤å—ç£ç›˜é…ç½® lvm</strong> æŒ‚è½½äº<strong>home</strong>ç›®å½•ï¼Œæ¨¡æ‹Ÿå…¶ä¸­ä¸€å—ç£ç›˜æŸåï¼ˆæ‰‹åŠ¨å¸è½½å…¶ä¸­ä¸€å—ç£ç›˜ï¼‰</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_01d0781150239f60d611e745039163f0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_01d0781150239f60d611e745039163f0.png"></p><p>æŒ‚è½½ç›®å½•å†™å…¥æ–‡ä»¶æµ‹è¯•æ¢å¤ èƒ½å¦æ¢å¤æ•°æ®</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d66d4886fa622e78c8eb0e4a953bc95a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d66d4886fa622e78c8eb0e4a953bc95a.png"></p><p><strong>ç°è±¡</strong>ï¼š<strong>æ­¤æ—¶æœ‰ä¸€å—pvå¤„äºunknowçŠ¶æ€ é‡å¯ç³»ç»Ÿåç°è±¡å¦‚ä¸‹</strong></p><ul><li>lsblk æŸ¥çœ‹æ²¡æœ‰çœ‹åˆ°  /dev/mapper å¼€å¤´çš„lvmå·</li><li>pvs æŸ¥çœ‹æœ‰ä¸€å—ç£ç›˜ pv å¤„äº unknow çŠ¶æ€ å¹¶ä¸”æ˜¾ç¤ºï¼šWARNING: Couldnâ€™t find device with uuid FCda1V-EwWN-qtfc-6SZ4-Vu1e-v8FG-XUCr5H æ‰¾ä¸åˆ°è¿™ä¸ªuuidçš„è®¾å¤‡</li><li>mount æŒ‚è½½æ˜¾ç¤ºæ‰¾ä¸åˆ°è®¾å¤‡</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_2f4b8b5f102e1cf6be27e0f7225fc7a8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_2f4b8b5f102e1cf6be27e0f7225fc7a8.png"></p><h2 id="äºŒ-è§£å†³"><a href="#äºŒ-è§£å†³" class="headerlink" title="äºŒ. è§£å†³"></a><strong>äºŒ. è§£å†³</strong></h2><ol><li><p>æœåŠ¡å™¨æ–°æ·»åŠ ä¸€å—ç£ç›˜ ç£ç›˜çš„å¤§å°å’Œ æŸåç£ç›˜çš„å¤§å°ä¸€è‡´ æ­¤æ¬¡æ–°æ·»åŠ ç£ç›˜ä¸º /dev/sdd</p></li><li><p>ä½¿ç”¨pvså®šä½æŸåç£ç›˜uuid: 8Acrc0-21LJ-yWfm-f7gb-2uvf-ogLu-cG6OIT</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7ad156f3d7d7bb8786b4b9794428c366.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7ad156f3d7d7bb8786b4b9794428c366.png"></p></li><li><p>ä½¿ç”¨åŸæ¥çš„PV UUIDæ¥åˆ›å»ºPVï¼Œå¹¶ä½¿ç”¨lvmé…ç½®å¤‡ä»½æ–‡ä»¶æ¥æ¢å¤ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹pvè¿”å›æŸåç£ç›˜uuid: 8Acrc0-21LJ-yWfm-f7gb-2uvf-ogLu-cG6OIT</span></span><br><span class="line">pvs</span><br><span class="line"><span class="comment"># ä½¿ç”¨åŸæ¥çš„PV UUIDæ¥åˆ›å»ºPVï¼Œå¹¶ä½¿ç”¨lvmé…ç½®å¤‡ä»½æ–‡ä»¶æ¥æ¢å¤ä¿¡æ¯ï¼ˆæœ¬æ–‡ä½¿ç”¨ï¼‰</span></span><br><span class="line">pvcreate --uuid  8Acrc0-21LJ-yWfm-f7gb-2uvf-ogLu-cG6OIT --restorefile /etc/lvm/backup/vg_mf  /dev/sdd</span><br><span class="line"><span class="comment"># æˆ–ä½¿ç”¨ç±»ä¼¼å¦‚ä¸‹å‘½ä»¤</span></span><br><span class="line">pvcreate /dev/vdc -u qaTzJn-Hdgc-aeC5-EUT0-H1l1-tPiA-rYXnDx --restorefile /etc/lvm/archive/vgtest_00002-645033136.vg</span><br></pre></td></tr></table></figure></li><li><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°sdcå·²ç»æˆåŠŸæ›¿æ¢ä¸ºäº†sdd</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_9029ced509c4251026a34bf3d3959213.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_9029ced509c4251026a34bf3d3959213.png"></p></li><li><p>å¦‚æœæ›¿æ¢åçš„/dev/sdd çš„atträ¸ºa-m è¡¨ç¤º/dev/sddä¸ºmissingçŠ¶æ€ åˆ™éœ€è¦æ‰§è¡Œä¸‹æ–¹å‘½ä»¤æ¢å¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ›¿æ¢åçš„/dev/sdd çš„atträ¸ºa-m è¡¨ç¤º/dev/sddä¸ºmissingçŠ¶æ€ åˆ™éœ€è¦æ‰§è¡Œä¸‹æ–¹å‘½ä»¤æ¢å¤ï¼ˆæœ¬æ–‡ä½¿ç”¨ï¼‰</span></span><br><span class="line">vgextend --restoremissing vg_mf /dev/sdd</span><br><span class="line"><span class="comment"># æˆ–ä½¿ç”¨ç±»ä¼¼å¦‚ä¸‹å‘½ä»¤æ–¹å¼</span></span><br><span class="line">vgcfgrestore -f archive/vgtest_00002-645033136.vg vgtest</span><br></pre></td></tr></table></figure></li><li><p>ç¡®è®¤ç¡¬ç›˜<strong>æ²¡æœ‰åœ¨</strong> missing çŠ¶æ€åï¼Œå¯¹å·ç»„è¿›è¡Œæ¢å¤ï¼Œæç¤ºæ¢å¤vgï¼Œæ²¡æœ‰æŠ¥é”™ï¼Œä½¿ç”¨lvscanå‘ç°å½“å‰lvçŠ¶æ€ä¸ºinactiveã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ·æ–°</span></span><br><span class="line">lvscan</span><br><span class="line"><span class="comment"># æ¢å¤å·ç»„ä¿¡æ¯</span></span><br><span class="line">vgcfgrestore -f  /etc/lvm/backup/vg_mf   vg_mf</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_dec1593e4a081755a2714700aa9fc7f9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_dec1593e4a081755a2714700aa9fc7f9.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_f5fbb85873ba0a7afb2d618093af9743.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_f5fbb85873ba0a7afb2d618093af9743.png"></p></li><li><p>æ¿€æ´»vgï¼Œå†æ¬¡æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ·æ–°</span></span><br><span class="line">lvscan</span><br><span class="line"><span class="comment"># æ¿€æ´»vg</span></span><br><span class="line">vgchange -ay vg_mf</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å†æ¬¡ä½¿ç”¨ lvscan æŸ¥çœ‹ lvm å·çŠ¶æ€å˜ä¸º active</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_92c783e15b2248b4ca139d58f27f9000.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_92c783e15b2248b4ca139d58f27f9000.png"></p></li><li><p>æœ€åé‡æ–°æŒ‚è½½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç£ç›˜uuid</span></span><br><span class="line">blkid</span><br><span class="line"><span class="comment"># æŒ‚è½½lvmå·</span></span><br><span class="line">mount /dev/mapper/vg_mf-lv_mf  /home</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_11474a9f9fdc89f0de5d179adac186d2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_11474a9f9fdc89f0de5d179adac186d2.png"></p><p>éªŒè¯æ•°æ®æ˜¯å¦æ¢å¤</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_e38c176548f7b5581090fcad7b034dfe.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_e38c176548f7b5581090fcad7b034dfe.png"></p><p>ä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨ä¸€ä¸ªbug æœ‰æ—¶å€™é‡å¯lsblk çœ‹ä¸åˆ°lvmå·ä¿¡æ¯ éœ€è¦é‡æ–°æ¿€æ´»vgå· æŒ‚è½½.ã€‚</p></li></ol><p>æ­¤æ—¶æ¢å¤æˆåŠŸã€‚</p><p><strong>æœ¬æ–‡å‚è€ƒ</strong></p><ul><li><a href="https://developer.aliyun.com/article/766142">https://developer.aliyun.com/article/766142</a></li><li><a href="https://blog.csdn.net/m0_64339281/article/details/134873834">https://blog.csdn.net/m0_64339281/article/details/134873834</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²</title>
      <link href="/2024/04/22/%E5%BC%80%E6%BA%90%E8%81%8A%E5%A4%A9%E7%B3%BB%E7%BB%9Ffiora%E4%B8%8EVocechat%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/22/%E5%BC%80%E6%BA%90%E8%81%8A%E5%A4%A9%E7%B3%BB%E7%BB%9Ffiora%E4%B8%8EVocechat%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²"><a href="#å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²" class="headerlink" title="å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²"></a>å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²</h1><h2 id="ä¸€-Vocechatéƒ¨ç½²"><a href="#ä¸€-Vocechatéƒ¨ç½²" class="headerlink" title="ä¸€. Vocechatéƒ¨ç½²"></a>ä¸€. Vocechatéƒ¨ç½²</h2><blockquote><p>å®˜ç½‘ï¼š<a href="https://doc.voce.chat/zh-cn/install/install-by-docker">Docker å®‰è£… | VoceChat</a></p><p>githubä»“åº“ï¼š<a href="https://github.com/privoce">https://github.com/privoce</a></p><p>ios å®‰å“ appä¸‹è½½ï¼š<a href="https://voce.chat/zh-CN#download">VoceChat Website</a></p><p>ç¼ºç‚¹ï¼šä½¿ç”¨firebaseé€šçŸ¥æ¨é€ å¯¹å›½å†…ä¸å‹å¥½ åŸºæœ¬æ— æ³•ä½¿ç”¨</p><p>ç®¡ç†å‘˜éœ€åœ¨ Firebase Cloud Console ä¸­é…ç½® <strong>FCM</strong>ã€‚</p><p>âš ï¸ è¯·æ³¨æ„ï¼šå¦‚æœä½¿ç”¨è‡ªå®šä¹‰çš„æ¨é€é…ç½®ï¼Œåˆ™ç§»åŠ¨ç«¯ï¼ˆiOS åŠ Androidï¼‰çš„æ¨é€æœåŠ¡å°†ä¼šä¸å¯ç”¨ï¼Œè¿™ä¸ iOS å’Œ Android çš„åº”ç”¨ç­¾åç›¸å…³ã€‚å› æ­¤åªæœ‰ç½‘é¡µç«¯å¯ä»¥æ”¶åˆ°æ¨é€æ¶ˆæ¯ã€‚ç›®å‰åœ¨æœ€æ–°çš„ç½‘é¡µç«¯ä¸­æä¾›äº†ä¸€å¥—é»˜è®¤é…ç½®ï¼Œè¯¦æƒ…å¯ä»¥è®¿é—®è®¾ç½® -&gt; Firebaseã€‚è¿œæœŸè§„åˆ’ä¼šæä¾›ç§»åŠ¨ç«¯ SDKï¼Œåˆ°æ—¶å¯ä»¥ç”±ç”¨æˆ·ç”¨è‡ªå·±çš„é¡¹ç›®ç­¾åã€‚</p><p>âš ï¸ å¦‚æœæ‚¨çš„ VoceChat åç«¯éƒ¨ç½²åœ¨ä¸­å›½å¤§é™†ï¼Œåˆ™æ¨é€å¯èƒ½å› ç½‘ç»œç®¡åˆ¶è€Œä¸å¯ç”¨ï¼Œå› ä¸ºç›®å‰çš„æ¨é€æœåŠ¡ä¾èµ– Google Firebaseã€‚æˆ‘ä»¬è®¡åˆ’é€æ­¥å°†æ¨é€æ›¿æ¢æˆç›´æ¥æ”¯æŒ APNs åŠå…¶ä»–å›½å†…å®‰å“æ‰‹æœºå‚å•†æ”¯æŒçš„å¹³å°ã€‚</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Vocechatæ˜¯ä¸€å¥—æ”¯æŒç‹¬ç«‹éƒ¨ç½²çš„ä¸ªäººäº‘ç¤¾äº¤åª’ä½“èŠå¤©æœåŠ¡ï¼Œå…·æœ‰è½»é‡çº§ã€å¼€æºå’Œå¯è‡ªæ‰˜ç®¡ç­‰ç‰¹ç‚¹ã€‚å®ƒåšé‡‡ä¼—é•¿ï¼Œä»Slackã€Discordã€RocketChatã€Solidã€Matrixç­‰äº§å“å’Œè§„èŒƒä¸­æ±²å–ä¼˜ç‚¹ï¼Œé€‚ç”¨äºå›¢é˜Ÿå†…éƒ¨äº¤æµã€ä¸ªäººèŠå¤©æœåŠ¡æ­å»ºã€ç½‘ç«™å®¢æœä»¥åŠç½‘ç«™å†…åµŒç¤¾åŒºç­‰åœºæ™¯ã€‚</p><p>Vocechatèƒ½è½»æ˜“éƒ¨ç½²åœ¨ç§æœ‰äº‘ä¸Šï¼Œç”¨æˆ·å¯ä»¥è½»æ¾å°†å…¶éƒ¨ç½²åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·æ•°æ®å®Œå…¨ç”±ç”¨æˆ·è‡ªå·±æŒæ¡ï¼Œä¼ è¾“è¿‡ç¨‹åŠ å¯†ï¼Œä¿è¯äº†æ•°æ®çš„å®‰å…¨æ€§ã€‚æ­¤å¤–ï¼ŒVocechatçš„ä½“ç§¯ä»…ä¸º15MBï¼Œå‡ ä¹å¯ä»¥å¡è¿›ä»»ä½•æœåŠ¡å™¨é‡Œï¼ŒåŒæ—¶æ‹¥æœ‰æ­£å¸¸èŠå¤©æ‰€éœ€è¦çš„æ‰€æœ‰å¿…å¤‡åŠŸèƒ½ï¼Œå¦‚å›å¤ã€è½¬å‘ã€ç‚¹èµã€é’‰é€‰æ¶ˆæ¯ç­‰ã€‚å…¶ç•Œé¢ç®€æ´ï¼Œèƒ½å¤Ÿå¿«é€Ÿä¸Šæ‰‹ï¼Œæ”¯æŒåœ¨çº¿ä¸Šä¼ æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ï¼Œå¹¶ä¸”æ”¯æŒåœ¨çº¿æ’­æ”¾è§†é¢‘ã€‚</p><p>åœ¨å›¢é˜Ÿå†…éƒ¨äº¤æµæ–¹é¢ï¼ŒVocechatå¯ä»¥ä½œä¸ºä¸€ä¸ªé«˜æ•ˆçš„æ²Ÿé€šå·¥å…·ï¼Œæ”¯æŒæˆå‘˜é—´çš„å®æ—¶èŠå¤©ã€æ–‡ä»¶å…±äº«å’Œåä½œã€‚å¯¹äºä¸ªäººèŠå¤©æœåŠ¡æ­å»ºï¼ŒVocechatæä¾›äº†ä¸°å¯Œçš„è‡ªå®šä¹‰é€‰é¡¹ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œä¸ªæ€§åŒ–è®¾ç½®ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºç½‘ç«™å®¢æœå·¥å…·ï¼Œæä¾›ä¸è®¿å®¢çš„å®æ—¶äº¤æµåŠŸèƒ½ï¼Œæå‡å®¢æˆ·æœåŠ¡è´¨é‡ã€‚æ­¤å¤–ï¼ŒVocechatè¿˜å¯ä»¥ä»¥æ’ä»¶çš„å½¢å¼æ’å…¥åˆ°ç½‘é¡µä¸­ï¼Œæä¾›ç½‘é¡µèŠå¤©ç­‰å„ç§ä¸°å¯Œçš„åŠŸèƒ½ã€‚</p><h4 id="é¡¹ç›®ç»„æˆ"><a href="#é¡¹ç›®ç»„æˆ" class="headerlink" title="é¡¹ç›®ç»„æˆ"></a>é¡¹ç›®ç»„æˆ</h4><table><thead><tr><th><strong><strong>åç§°</strong></strong></th><th><strong><strong>æŠ€æœ¯</strong></strong></th><th><strong><strong>é¡¹ç›®</strong></strong></th><th><strong><strong>License</strong></strong></th><th><strong><strong>è¯´æ˜</strong></strong></th></tr></thead><tbody><tr><td>æœåŠ¡ç«¯:</td><td>Rust</td><td>vocechat-server(æš‚æœªå¼€æº)</td><td>å¾…å®š</td><td>èŠå¤©æœåŠ¡ç«¯ï¼Œæ”¯æŒä¸»æµå¹³å°: Linux x86_64, Windows 32/64, Arm32, Arch64</td></tr><tr><td>å®¢æˆ·ç«¯:</td><td>Flutter</td><td><a href="https://github.com/privoce/vocechat-client" title="vocechat-client">vocechat-client</a></td><td>Apache-2.0</td><td>èŠå¤©å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Android, iOS å¹³å°çš„å®¢æˆ·ç«¯</td></tr><tr><td>Web:</td><td>React</td><td><a href="https://github.com/privoce/vocechat-web" title="vocechat-web">vocechat-web</a></td><td>GPL-3.0</td><td>èŠå¤©åŠŸèƒ½çš„æµè§ˆå™¨ç‰ˆæœ¬ï¼Œæ•´åˆäº†ç®¡ç†</td></tr><tr><td>Web-SDK:</td><td>React</td><td>vocechat-web-sdk(æš‚æœªå¼€æº)</td><td>GPL-3.0</td><td>å¯ä»¥æ•´åˆåˆ°å…¶ä»– Web äº§å“ä¸­ï¼Œä½¿å…¶èµ‹èƒ½èŠå¤©åŠŸèƒ½</td></tr></tbody></table></blockquote><p><strong>åŠŸèƒ½ä»‹ç»</strong></p><ul><li>æ”¯æŒä¸­è‹±æ–‡</li><li>æ”¯æŒAndroidã€iOSç«¯</li><li>æ”¯æŒDockerå®‰è£…ï¼Œéƒ¨ç½²æå…¶ç®€å•</li><li>å¤‡ä»½ç®€å•</li><li>æ”¯æŒå¯¹æ¥è‡ªæœ‰è´¦å·ç³»ç»Ÿ</li><li>æ”¯æŒç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆæ¯”å¦‚GitHubã€MetaMaskã€Googleç­‰ï¼‰</li><li>æ”¯æŒè®¿é—®æ§åˆ¶ &amp; è®¿å®¢æ¨¡å¼</li><li>APIæ–‡æ¡£è¯¦ç»†</li><li>æ”¯æŒè‡ªå»ºé¢‘é“</li></ul><p><strong>åŠŸèƒ½åˆ—è¡¨ &amp; è®¡åˆ’</strong></p><ul><li>ç¾¤èŠã€ç§èŠ / 2021-Q4</li><li>å¼•ç”¨, at / 2021-Q4</li><li>å›¾ç‰‡ã€å¤§æ–‡ä»¶ä¼ è¾“ / 2021-Q4</li><li>ç½®é¡¶ / 2022-Q1</li><li>è½¬å‘ / 2022-Q1</li><li>æ”¶è— / 2022-Q1</li><li>é˜…åå³ç„šï¼ˆé«˜çº§åŠŸèƒ½ï¼‰ / 2022-Q1</li><li>è¯­éŸ³ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰/ 2022-Q4</li><li>è§†é¢‘ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰/ 2022-Q4</li></ul><h2 id="docker-composeéƒ¨ç½²"><a href="#docker-composeéƒ¨ç½²" class="headerlink" title="docker-composeéƒ¨ç½²"></a>docker-composeéƒ¨ç½²</h2><p>é•œåƒå¯é€‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">privoce/vocechat-server:latest</span></span><br><span class="line"><span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:vocechat-server</span></span><br></pre></td></tr></table></figure><p>éƒ¨ç½²</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">    <span class="attr">vocechat:</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:vocechat-server</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;8000:3000&#x27;</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">vocechat-server</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;./data:/home/vocechat-server/data&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="æœºå™¨äººä½¿ç”¨"><a href="#æœºå™¨äººä½¿ç”¨" class="headerlink" title="æœºå™¨äººä½¿ç”¨"></a>æœºå™¨äººä½¿ç”¨</h2><p>APIåœ°å€ï¼š<a href="http://10.0.0.10:8000/api/swagger">http://10.0.0.10:8000/api/swagger</a></p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5fb9785cb7a0243bc3a8210f6267e92a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5fb9785cb7a0243bc3a8210f6267e92a.png"></p><h2 id="äºŒ-fioraéƒ¨ç½²"><a href="#äºŒ-fioraéƒ¨ç½²" class="headerlink" title="äºŒ. fioraéƒ¨ç½²"></a>äºŒ. fioraéƒ¨ç½²</h2><blockquote><p>githubä»“åº“ï¼š<a href="https://github.com/yinxin630/fiora">https://github.com/yinxin630/fiora</a></p><p>ä¸­æ–‡æ•™ç¨‹ï¼š<a href="https://yinxin630.github.io/fiora/zh-Hans/docs/faq">https://yinxin630.github.io/fiora/zh-Hans/docs/faq</a></p><p><strong>ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®éœ€è¦é‡æ–°æ„å»ºå®¢æˆ·ç«¯</strong></p><table><thead><tr><th>Key</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>Server</td><td>string</td><td>/</td><td>å®¢æˆ·ç«¯è¦è¿æ¥çš„æœåŠ¡ç«¯åœ°å€</td></tr><tr><td>MaxImageSize</td><td>number</td><td>3145728 (3MB)</td><td>å®¢æˆ·ç«¯å¯ä»¥ä¸Šä¼ çš„æœ€å¤§å›¾ç‰‡å¤§å°</td></tr><tr><td>MaxBackgroundImageSize</td><td>number</td><td>5242880 (5MB)</td><td>å®¢æˆ·ç«¯å¯ä»¥ä¸Šä¼ çš„æœ€å¤§èƒŒæ™¯å›¾å¤§å°</td></tr><tr><td>MaxAvatarSize</td><td>number</td><td>1572864 (1.5MB)</td><td>å®¢æˆ·ç«¯å¯ä»¥ä¸Šä¼ çš„æœ€å¤§å¤´åƒå›¾ç‰‡å¤§å°</td></tr><tr><td>MaxFileSize</td><td>number</td><td>10485760 (10MB)</td><td>å®¢æˆ·ç«¯å¯ä»¥ä¸Šä¼ çš„æœ€å¤§æ–‡ä»¶å¤§å°</td></tr><tr><td>DefaultTheme</td><td>string</td><td>cool</td><td>é»˜è®¤ä¸»é¢˜</td></tr><tr><td>Sound</td><td>string</td><td>default</td><td>é»˜è®¤é€šçŸ¥éŸ³</td></tr><tr><td>TagColorMode</td><td>string</td><td>fixedColor</td><td>é»˜è®¤æ ‡ç­¾é¢œè‰²æ¨¡å¼</td></tr><tr><td>FrontendMonitorAppId</td><td>string</td><td>fixedColor</td><td>å²³é¹°ç›‘æ§ appId<a href="https://yueying.effirst.com/index">https://yueying.effirst.com/index</a></td></tr><tr><td>DisableDeleteMessage</td><td>boolean</td><td>false</td><td>ç¦æ­¢ç”¨æˆ·æ’¤å›æ¶ˆæ¯</td></tr></tbody></table><h3 id="æœåŠ¡ç«¯å˜é‡é…ç½®"><a href="#æœåŠ¡ç«¯å˜é‡é…ç½®" class="headerlink" title="æœåŠ¡ç«¯å˜é‡é…ç½®#"></a>æœåŠ¡ç«¯å˜é‡é…ç½®<a href="https://yinxin630.github.io/fiora/zh-Hans/docs/config#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><p><strong>ä¿®æ”¹æœåŠ¡ç«¯é…ç½®éœ€è¦é‡å¯åº”ç”¨</strong></p><table><thead><tr><th>Key</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>Host</td><td>string</td><td>your ip</td><td>æœåŠ¡ç«¯ host</td></tr><tr><td>Port</td><td>number</td><td>9200</td><td>æœåŠ¡ç«¯ç«¯å£å·</td></tr><tr><td>Database</td><td>string</td><td>mongodb://localhost:27017/fiora</td><td>mongoDB æ•°æ®åº“åœ°å€</td></tr><tr><td>RedisHost</td><td>string</td><td>localhost</td><td>redis åœ°å€ä¸»æœºå</td></tr><tr><td>RedisPort</td><td>number</td><td>6379</td><td>redis ç«¯å£</td></tr><tr><td>JwtSecret</td><td>string</td><td>jwtSecret (æ¨èä¿®æ”¹å®ƒæ¥ä¿è¯å®‰å…¨æ€§)</td><td>jwt token åŠ å¯† secret</td></tr><tr><td>MaxGroupCount</td><td>number</td><td>3</td><td>ç”¨æˆ·æœ€å¤§å¯ä»¥åˆ›å»ºçš„ç¾¤ç»„ä¸ªæ•°</td></tr><tr><td>AllowOrigin</td><td>string</td><td>null</td><td>å…è®¸çš„å®¢æˆ·ç«¯ origin åˆ—è¡¨, null æ—¶å…è®¸æ‰€æœ‰ origin è¿æ¥, å¤šä¸ªå€¼é€—å·åˆ†å‰²</td></tr><tr><td>tokenExpiresTime</td><td>number</td><td>2592000000 (30 å¤©)</td><td>ç™»é™† token è¿‡æœŸæ—¶é—´</td></tr><tr><td>Administrator</td><td>string</td><td>â€˜â€™</td><td>ç®¡ç†å‘˜ç”¨æˆ· id åˆ—è¡¨, å¤šä¸ªå€¼é€—å·åˆ†å‰²</td></tr><tr><td>DisableRegister</td><td>boolean</td><td>false</td><td>ç¦æ­¢æ³¨å†Œè´¦å·</td></tr><tr><td>DisableCreateGroup</td><td>boolean</td><td>false</td><td>ç¦æ­¢åˆ›å»ºç¾¤ç»„</td></tr><tr><td>ALIYUN_OSS</td><td>boolean</td><td>false</td><td>å¯ç”¨é˜¿é‡Œäº‘ OSS</td></tr><tr><td>ACCESS_KEY_ID</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS access key id. å‚è€ƒ:<a href="https://help.aliyun.com/document_detail/48699.html">https://help.aliyun.com/document_detail/48699.html</a></td></tr><tr><td>ACCESS_KEY_SECRET</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS access key secret. å‚è€ƒå’Œ ACCESS_KEY_ID ç›¸åŒ</td></tr><tr><td>ROLE_ARN</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS RoleARN. å‚è€ƒ:<a href="https://help.aliyun.com/document_detail/28649.html">https://help.aliyun.com/document_detail/28649.html</a></td></tr><tr><td>REGION</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS åœ°åŸŸ. ä¾‹å¦‚:<code>oss-cn-zhangjiakou</code></td></tr><tr><td>BUCKET</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS bucket åç§°</td></tr><tr><td>ENDPOINT</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS åŸŸå. ä¾‹å¦‚:<code>cdn</code></td></tr></tbody></table></blockquote><p><strong>é•œåƒå¯é€‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®˜æ–¹é•œåƒ</span></span><br><span class="line">redis</span><br><span class="line">mongo</span><br><span class="line">suisuijiang/fiora</span><br><span class="line"><span class="comment"># zznné˜¿é‡Œäº‘é•œåƒ</span></span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:redis4</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:mongo5.0.18</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:fiora</span><br></pre></td></tr></table></figure><h3 id="docker-composeéƒ¨ç½²-1"><a href="#docker-composeéƒ¨ç½²-1" class="headerlink" title="docker-composeéƒ¨ç½²"></a><code>docker-compose</code>éƒ¨ç½²</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">fiora_redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:redis4</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">fiora_redis</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fiora-network</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">fiora_db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:mongo5.0.18</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">fiora_db</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;27017:27017&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fiora-network</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">fiora:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:fiora</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">fiora</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9200:9200&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">Database=mongodb://fiora_db:27017/fiora</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">RedisHost=fiora_redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DisableRegister=true</span>  <span class="comment"># è®¾ç½®ä¸å…è®¸æ³¨å†Œç”¨æˆ·</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fiora-network</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">fiora-network:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure><p>ç›®å½•è¯´æ˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">|-- [.githubb]                // github actions</span><br><span class="line">|-- [.vscode]                 // vscode å·¥ä½œåŒºé…ç½®</span><br><span class="line">|-- [bin]                     // æœåŠ¡ç«¯è„šæœ¬</span><br><span class="line">|-- [build]                   // webpack é…ç½®</span><br><span class="line">|-- [client]                  // web å®¢æˆ·ç«¯</span><br><span class="line">|-- [config]                  // åº”ç”¨é…ç½®</span><br><span class="line">|-- [dist]                    // æ„å»ºå®¢æˆ·ç«¯è¾“å‡ºç›®å½•</span><br><span class="line">|-- [docs]                    // æ–‡æ¡£</span><br><span class="line">|-- [public]                  // æœåŠ¡ç«¯é™æ€èµ„æº</span><br><span class="line">|-- [server]                  // æœåŠ¡ç«¯</span><br><span class="line">|-- [<span class="built_in">test</span>]                    // å•å…ƒæµ‹è¯•</span><br><span class="line">|-- [types]                   // typescript ç±»å‹</span><br><span class="line">|-- [utils]                   // å·¥å…·æ–¹æ³•</span><br><span class="line">|-- .babelrc                  // babel é…ç½®</span><br><span class="line">|-- .eslintignore             // eslint å¿½ç•¥</span><br><span class="line">|-- .eslintrc                 // eslint é…ç½®</span><br><span class="line">|-- .gitignore                // git å¿½ç•¥</span><br><span class="line">|-- .nodemonrc                // nodemon é…ç½®</span><br><span class="line">|-- .prettierrc               // prettier é…ç½®</span><br><span class="line">|-- Dockerfile                // docker æ–‡ä»¶</span><br><span class="line">|-- LICENSE                   // fiora è®¸å¯</span><br><span class="line">|-- docker-compose.yaml       // docker compose é…ç½®</span><br><span class="line">|-- jest.*.sj                 // jest é…ç½®</span><br><span class="line">|-- package.json              // npm</span><br><span class="line">|-- tsconfig.json             // typescript é…ç½®</span><br><span class="line">|-- yarn.lock                 // yarn</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>æ­¤å®‰è£…å°±å®Œæˆäº†ï¼Œä¿®æ”¹æ–‡ä»¶ï¼Œfioraé¡µé¢ä¿®æ”¹è·¯å¾„</strong></p><ul><li>ä»¥ä¸‹logoï¼š<br>/opt/fiora/public/favicon-96.png<br>/opt/fiora/public/favicon-192.png<br>/opt/fiora/public/favicon-512.png<br>ä»¥ä¸‹ä¸»é¡µä¿®æ”¹è·¯å¾„<br>/opt/fiora/client/templates/index.html<br>ä»¥ä¸‹ä¾§è¾¹æ ä¿®æ”¹è·¯å¾„<br>/opt/fiora/client/modules/Sidebar/</li></ul><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>ä¸å…è®¸æ³¨å†Œæ—¶æ‰“å¼€ï¼ˆéœ€è¦æ³¨å†Œæ—¶å–æ¶ˆæ³¨é‡Šå³å¯ï¼‰ï¼š</p><ul><li>DisableRegister=true  # è®¾ç½®ä¸å…è®¸æ³¨å†Œç”¨æˆ·</li></ul><p>å…¶ä»–é…ç½®å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_63660670/article/details/130824723">https://blog.csdn.net/weixin_63660670/article/details/130824723</a></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²</title>
      <link href="/2024/04/21/%E5%BC%80%E6%BA%90%E6%A8%A1%E5%9E%8B%E6%8E%A5%E5%85%A5%E5%B9%B3%E5%8F%B0MaxKB%E9%83%A8%E7%BD%B2%E5%8F%8A%E5%AF%B9%E6%8E%A5OneApi/"/>
      <url>/2024/04/21/%E5%BC%80%E6%BA%90%E6%A8%A1%E5%9E%8B%E6%8E%A5%E5%85%A5%E5%B9%B3%E5%8F%B0MaxKB%E9%83%A8%E7%BD%B2%E5%8F%8A%E5%AF%B9%E6%8E%A5OneApi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²åŠå¯¹æ¥OneApi"><a href="#å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²åŠå¯¹æ¥OneApi" class="headerlink" title="å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²åŠå¯¹æ¥OneApi"></a>å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²åŠå¯¹æ¥OneApi</h1><blockquote><p>æœ¬å¹³å°ç”±å›½å†…å€¼å¾—å°Šæ•¬çš„å¼ºå¤§å…¬å¸é£è‡´äº‘å¼€æºçš„æ”¯æŒå¤šç”¨æˆ·éš”ç¦»çš„æ¨¡å‹æ¥å…¥å¹³å°</p><p>MaxKB æ˜¯ä¸€æ¬¾åŸºäº LLM å¤§è¯­è¨€æ¨¡å‹çš„çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿã€‚</p><ul><li><p>å¤šæ¨¡å‹æ”¯æŒï¼šæ”¯æŒå¯¹æ¥ä¸»æµçš„å¤§æ¨¡å‹ï¼ŒåŒ…æ‹¬æœ¬åœ°ç§æœ‰å¤§æ¨¡å‹ï¼ˆå¦‚ Llama 2ï¼‰ã€OpenAIã€é€šä¹‰åƒé—®ã€Kimiã€Azure OpenAI å’Œç™¾åº¦åƒå¸†å¤§æ¨¡å‹ç­‰ï¼›</p></li><li><p>å¼€ç®±å³ç”¨ï¼šæ”¯æŒç›´æ¥ä¸Šä¼ æ–‡æ¡£ã€è‡ªåŠ¨çˆ¬å–åœ¨çº¿æ–‡æ¡£ï¼Œæ”¯æŒæ–‡æœ¬è‡ªåŠ¨æ‹†åˆ†ã€å‘é‡åŒ–ï¼Œæ™ºèƒ½é—®ç­”äº¤äº’ä½“éªŒå¥½ï¼›</p></li><li><p>æ— ç¼åµŒå…¥ï¼šæ”¯æŒé›¶ç¼–ç å¿«é€ŸåµŒå…¥åˆ°ç¬¬ä¸‰æ–¹ä¸šåŠ¡ç³»ç»Ÿã€‚</p></li><li><p>é»˜è®¤ç”¨æˆ·å¯†ç  ç”¨æˆ·å: admin  å¯†ç : MaxKB@123..</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ab8425771622018b1cac85a6fcd23de4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ab8425771622018b1cac85a6fcd23de4.png"></p></li></ul></blockquote><h2 id="ä¸€-éƒ¨ç½²"><a href="#ä¸€-éƒ¨ç½²" class="headerlink" title="ä¸€. éƒ¨ç½²"></a>ä¸€. éƒ¨ç½²</h2><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1panel/maxkb</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:maxkb-v1.4.1</span><br></pre></td></tr></table></figure><p>dockerå‘½ä»¤æ–¹å¼éƒ¨ç½²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name=maxkb -p 8080:8080 -v ~/.maxkb:/var/lib/postgresql/data 1panel/maxkb</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æˆ·å: admin</span></span><br><span class="line"><span class="comment"># å¯†ç : MaxKB@123..</span></span><br></pre></td></tr></table></figure><p>docker-composeæ–¹å¼éƒ¨ç½²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  maxkb:</span><br><span class="line">    <span class="comment">#image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:zznnwn-maxkb</span></span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:maxkb-v1.4.1</span><br><span class="line">    <span class="comment"># 1panel/maxkb</span></span><br><span class="line">    container_name: maxkb</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ~/.maxkb:/var/lib/postgresql/data</span><br></pre></td></tr></table></figure><h2 id="äºŒ-ä½¿ç”¨"><a href="#äºŒ-ä½¿ç”¨" class="headerlink" title="äºŒ. ä½¿ç”¨"></a>äºŒ. ä½¿ç”¨</h2><ul><li>ç³»ç»Ÿè®¾ç½®â€”â€”æ¨¡å‹â€”â€”æ·»åŠ æ¨¡å‹</li><li>çŸ¥è¯†åº“â€”â€”åˆ›å»ºçŸ¥è¯†åº“</li><li>åº”ç”¨â€”â€”åˆ›å»ºç‰¹å®šåŠŸèƒ½åº”ç”¨</li></ul><h2 id="ä¸‰-å¯¹æ¥oneapi"><a href="#ä¸‰-å¯¹æ¥oneapi" class="headerlink" title="ä¸‰. å¯¹æ¥oneapi"></a>ä¸‰. å¯¹æ¥oneapi</h2><ul><li>APIåŸŸåï¼š<a href="http://192.168.30.69:3000/v1">http://192.168.30.69:3000/v1</a></li><li>API KEY:  ä½¿ç”¨oneapiç”Ÿæˆçš„key</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/706aff61c16b2461c19832f3ff3478e_6235ec82459de423aa720924cc3adec8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/706aff61c16b2461c19832f3ff3478e_6235ec82459de423aa720924cc3adec8.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_dee2044e670622e3092cfed2755c916e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_dee2044e670622e3092cfed2755c916e.png"></p><h2 id="å››-æ•ˆæœ"><a href="#å››-æ•ˆæœ" class="headerlink" title="å››. æ•ˆæœ"></a>å››. æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c968720d48c42e71925c7c325bf39e88.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c968720d48c42e71925c7c325bf39e88.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://github.com/1panel-dev/MaxKB">https://github.com/1panel-dev/MaxKB</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kvmæ•™ç¨‹</title>
      <link href="/2024/04/20/kvm%E6%95%99%E7%A8%8B/"/>
      <url>/2024/04/20/kvm%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="kvmæ•™ç¨‹"><a href="#kvmæ•™ç¨‹" class="headerlink" title="kvmæ•™ç¨‹"></a>kvmæ•™ç¨‹</h1><h3 id="è™šæ‹ŸåŒ–çš„å®šä¹‰"><a href="#è™šæ‹ŸåŒ–çš„å®šä¹‰" class="headerlink" title="è™šæ‹ŸåŒ–çš„å®šä¹‰"></a>è™šæ‹ŸåŒ–çš„å®šä¹‰</h3><p>è™šæ‹ŸåŒ–æŠ€æœ¯æœ€æ—©å‡ºç°åœ¨60å¹´ä»£çš„IBMå¤§å‹æœºç³»ç»Ÿï¼Œè¿™äº›æœºå™¨é€šè¿‡Hypervisor(åˆç§°è™šæ‹Ÿæœºç›‘æ§å™¨)çš„ç¨‹åºåœ¨ä¸€å°ç‰©ç†çš„æœåŠ¡å™¨ä¸Šå¯ä»¥è·‘å¤šå°è™šæ‹Ÿæœº(VirtualMachineï¼ŒVM)ï¼Œè™šæ‹Ÿæœºå…±äº«ç‰©ç†æœºçš„CPUã€å†…å­˜ã€10 ç­‰ç¡¬ä»¶èµ„æºï¼Œä½†é€»è¾‘ä¸Šè™šæ‹Ÿæœºä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»çš„ã€‚</p><h3 id="å¸¸è§çš„Hypervisorç±»å‹"><a href="#å¸¸è§çš„Hypervisorç±»å‹" class="headerlink" title="å¸¸è§çš„Hypervisorç±»å‹"></a>å¸¸è§çš„Hypervisorç±»å‹</h3><p><strong>ç±»å‹1-è£¸æœºå‹</strong>:  ç›´æ¥è¿è¡Œåœ¨ç¡¬ä»¶è®¾å¤‡ä¸Šçš„ï¼Œè¿™ç§æ¶æ„æ­å»ºçš„è™šæ‹ŸåŒ–ç¯å¢ƒç§°ä¸ºè£¸æœºè™šæ‹ŸåŒ–ç¯å¢ƒï¼Œä¾‹å¦‚:VMware ESXl<br><strong>ç±»å‹I1-ä¸»æœºæ‰˜ç®¡å‹</strong>:  è¿è¡Œåœ¨å…·æœ‰è™šæ‹ŸåŒ–åŠŸèƒ½çš„æ“ä½œç³»ç»Ÿä¸Šçš„ï¼Œè¿™ç§æ¶æ„æ„å»ºçš„æ˜¯ä¸»æœºè™šæ‹ŸåŒ–ç¯å¢ƒï¼Œä¾‹<br><strong>å¦‚</strong>: VMware Workstation.VirtualBoxã€KVMã€xenç­‰ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_2121384e9f54523bd1280ade709ccda4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_2121384e9f54523bd1280ade709ccda4.png"></p><h3 id="è™šæ‹ŸåŒ–çš„ç±»å‹"><a href="#è™šæ‹ŸåŒ–çš„ç±»å‹" class="headerlink" title="è™šæ‹ŸåŒ–çš„ç±»å‹"></a>è™šæ‹ŸåŒ–çš„ç±»å‹</h3><p><strong>æœåŠ¡å™¨è™šæ‹ŸåŒ–</strong>: å¯åœ¨ä¸€å°ç‰©ç†æœºä¸Šè¿è¡Œå¤šä¸ªè™šæ‹Ÿæœºï¼Œå„è™šæ‹Ÿæœºä¹‹é—´ç›¸äº’éš”ç¦»äº’ä¸å½±å“ï¼Œè™šæ‹Ÿæœºçš„å®Œæ•´çŠ¶æ€ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œç§»åŠ¨å’Œå¤åˆ¶è™šæ‹Ÿæœºå°±åƒç§»åŠ¨å’Œå¤åˆ¶æ–‡ä»¶ä¸€æ ·è½»æ¾ï¼Œå¯å°†ä»»æ„è™šæ‹Ÿæœºè°ƒé…æˆ–è¿ç§»åˆ°å…¶ä»–ç†æœåŠ¡å™¨ä¸Šã€‚</p><p><strong><strong>å®¹å™¨è™šæŠ€æœ¯</strong>: å…¸å‹çš„å°±æ˜¯dockerã€Linux Container(LXC)ç­‰</strong></p><p><strong>ç½‘ç»œè™šæ‹ŸåŒ–</strong>: é€šè¿‡è½¯ä»¶å®šä¹‰ç½‘ç»œï¼Œå³ç½‘ç»œçš„åˆ›å»ºä¸å†ä¾èµ–äºç‰©ç†è®¾å¤‡ï¼Œå¦‚å…¬æœ‰äº‘å‚å•†å…è®¸ç”¨æˆ·è‡ªå·±åˆ›å»ºæ–°çš„ç½‘ç»œï¼Œåœ¨kubernetesã€openstackä¸­éƒ½ä¼šä½¿ç”¨åˆ°ç½‘ç»œè™šæ‹ŸåŒ–ã€‚</p><h3 id="è™šæ‹ŸåŒ–æŠ€æœ¯åˆ†ç±»"><a href="#è™šæ‹ŸåŒ–æŠ€æœ¯åˆ†ç±»" class="headerlink" title="è™šæ‹ŸåŒ–æŠ€æœ¯åˆ†ç±»"></a>è™šæ‹ŸåŒ–æŠ€æœ¯åˆ†ç±»</h3><p><strong>å…¨è™šæ‹ŸåŒ–</strong>: Hypervisor ç›´æ¥å®‰è£…åœ¨ç‰©ç†æœºä¸Šï¼Œå¤šä¸ªè™šæ‹Ÿæœºåœ¨ Hypervisor ä¸Šè¿è¡Œï¼ŒHypervisor å®ç°æ–¹å¼ä¸€èˆ¬æ˜¯ä¸€ä¸ªç‰¹æ®Šå®šåˆ¶çš„ Linux ç³»ç»Ÿï¼Œ<strong>ä¾‹å¦‚</strong>: Xenå’ŒVMWare ESXi éƒ½å±äºè¿™ä¸ªç±»å‹ã€‚ï¼ˆé€‚ç”¨äºä¼ä¸šç§æœ‰ï¼‰**</p><p><strong>ç¡¬ä»¶è¾…åŠ©è™šæ‹ŸåŒ–</strong>: KVMæ˜¯ç¡¬ä»¶è¾…åŠ©çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œä¸»è¦è´Ÿè´£æ¯”è¾ƒç¹ççš„<strong>CPU</strong>å’Œ<strong>å†…å­˜è™šæ‹ŸåŒ–</strong>ï¼Œè€Œ<strong>Qemu</strong>åˆ™è´Ÿè´£<strong>I/0</strong>è™šæ‹ŸåŒ–ã€‚ï¼ˆé€‚ç”¨äºå…¬æœ‰äº‘ï¼‰</p><p><strong>è™šæ‹ŸåŒ–æ¨¡æ‹Ÿå™¨</strong>: Qemu æ¨¡æ‹Ÿå™¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¤§å¤šæ•°çš„åšæ³•éƒ½æ˜¯é…åˆKVMæ¥å®Œæˆè™šæ‹ŸåŒ–å·¥ä½œï¼ŒKVMå®Œæˆå¤æ‚åŠè¦æ±‚æ¯”è¾ƒé«˜çš„CPUå’Œå†…å­˜çš„è™šæ‹ŸåŒ–ï¼Œè€ŒQemuå®Œæˆåƒç¡¬ç›˜ã€é¼ æ ‡ã€é”®ç›˜ç­‰è®¾å¤‡çš„è™šæ‹ŸåŒ–ã€‚ï¼ˆé€‚ç”¨äºå…¬æœ‰äº‘ï¼‰</p><h3 id="KVMè™šæ‹ŸåŒ–ä»‹ç»"><a href="#KVMè™šæ‹ŸåŒ–ä»‹ç»" class="headerlink" title="KVMè™šæ‹ŸåŒ–ä»‹ç»"></a>KVMè™šæ‹ŸåŒ–ä»‹ç»</h3><p><strong>KVM</strong> æ˜¯Kernel-based Virtual Machine(åŸºäºå†…æ ¸çš„è™šæ‹Ÿæœº)çš„ç®€ç§°ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„Linuxç³»ç»Ÿå†…æ ¸è™šæ‹ŸåŒ–æ¨¡å—ï¼Œè‡ªLinux2.6ä¹‹åé›†æˆåœ¨Linuxçš„å„ä¸ªä¸»è¦å‘è¡Œç‰ˆæœ¬ä¸­ï¼ŒKVMç›®å‰å·²æˆä¸ºå­¦æœ¯ç•Œä¸»æµçš„hypervisorã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ab78ebf3ee7974ceac39b802b6d3b861.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ab78ebf3ee7974ceac39b802b6d3b861.png"></p><h3 id="è™šæ‹Ÿæœºå¸¸ç”¨çš„ç®¡ç†å·¥å…·"><a href="#è™šæ‹Ÿæœºå¸¸ç”¨çš„ç®¡ç†å·¥å…·" class="headerlink" title="è™šæ‹Ÿæœºå¸¸ç”¨çš„ç®¡ç†å·¥å…·"></a>è™šæ‹Ÿæœºå¸¸ç”¨çš„ç®¡ç†å·¥å…·</h3><p><strong>libvirt:</strong> æ˜¯è°ƒç”¨KVMåˆ›å»ºè™šæ‹Ÿæœºçš„å·¥å…·ï¼Œå…¶ä¸ä½†èƒ½ç®¡ç†KVMï¼Œè¿˜èƒ½ç®¡ç†VMwareã€Xenã€Hyper-Vã€virtualBoxç­‰è™šæ‹ŸåŒ–æ–¹æ¡ˆã€‚</p><p><strong>virsh</strong>: æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ç®¡ç†KVMè™šæ‹ŸåŒ–çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</p><p><strong>virt-manager</strong>:  virt-manageræ˜¯ä¸€ä¸ªè™šæ‹ŸåŒ–ç®¡ç†å›¾å½¢è½¯ä»¶ï¼ŒåŒ…æ‹¬è™šæ‹Ÿæœºçš„åˆ›å»ºã€åˆ é™¤ã€å¯åŠ¨ã€åœæ­¢ä»¥åŠä¸€äº›ç®€å•çš„ç›‘æ§åŠŸèƒ½ç­‰ã€‚ï¼ˆå¾ˆå°‘ä½¿ç”¨ä¸å®‰è£…ï¼‰</p><p><strong>openstack</strong>:  openstackæ˜¯ä¸€ä¸ªå¼€æºçš„è™šæ‹ŸåŒ–é›†ç¾¤ç»Ÿä¸€ç®¡ç†çš„å¹³å°ï¼Œå¸¸ç”¨äºæ„å»ºå¤§è§„æ¨¡çš„è™šæ‹ŸåŒ–ç¯å¢ƒï¼Œç”¨äºç®¡ç†æˆåƒä¸Šä¸‡è™šæ‹Ÿæœºçš„åˆ›å»ºã€å¯åŠ¨ã€åˆ é™¤ç­‰æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ</p><blockquote><h3 id="ç”Ÿäº§ç¯å¢ƒä¸­-åˆ›å»ºè™šæ‹Ÿæœºä¸€å¾‹ä½¿ç”¨æ­¤å‘½ä»¤ï¼ˆä¸‹æ–¹ä¸¤å‚æ•°æ ¹æ®å®¿ä¸»æœºcpu-memå®é™…åˆç†èŒƒå›´æ›´æ”¹ï¼‰"><a href="#ç”Ÿäº§ç¯å¢ƒä¸­-åˆ›å»ºè™šæ‹Ÿæœºä¸€å¾‹ä½¿ç”¨æ­¤å‘½ä»¤ï¼ˆä¸‹æ–¹ä¸¤å‚æ•°æ ¹æ®å®¿ä¸»æœºcpu-memå®é™…åˆç†èŒƒå›´æ›´æ”¹ï¼‰" class="headerlink" title="ç”Ÿäº§ç¯å¢ƒä¸­ åˆ›å»ºè™šæ‹Ÿæœºä¸€å¾‹ä½¿ç”¨æ­¤å‘½ä»¤ï¼ˆä¸‹æ–¹ä¸¤å‚æ•°æ ¹æ®å®¿ä¸»æœºcpu memå®é™…åˆç†èŒƒå›´æ›´æ”¹ï¼‰"></a>ç”Ÿäº§ç¯å¢ƒä¸­ åˆ›å»ºè™šæ‹Ÿæœºä¸€å¾‹ä½¿ç”¨æ­¤å‘½ä»¤ï¼ˆä¸‹æ–¹ä¸¤å‚æ•°æ ¹æ®å®¿ä¸»æœºcpu memå®é™…åˆç†èŒƒå›´æ›´æ”¹ï¼‰</h3><ul><li><strong>maxmemory</strong>=2048   æœ€å¤§æ”¯æŒçš„å†…å­˜æ ¸å¿ƒæ•°</li><li><strong>maxvcpus</strong>=4             æœ€å¤§æ”¯æŒçš„CPUæ ¸å¿ƒæ•°<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºè™šæ‹Ÿæœº</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web04 \</span><br><span class="line">--memory 1024,maxmemory=2048 \</span><br><span class="line">--vcpus 1,maxvcpus=4 --disk /kvm/web04-vda.qcow2,format=qcow2,size=10 \</span><br><span class="line">--cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso --network bridge=br0 --graphics vnc,listen=0.0.0.0 --noautoconsole</span><br></pre></td></tr></table></figure></li></ul><p>å…¶ä¸­ï¼Œ<code>--ram</code>æŒ‡å®šå†…å­˜å¤§å°ï¼ˆMBï¼‰ï¼Œ<code>--vcpus</code>æŒ‡å®šè™šæ‹ŸCPUæ•°é‡ï¼Œ<code>--disk</code>æŒ‡å®šç£ç›˜æ–‡ä»¶è·¯å¾„å’Œå¤§å°ï¼Œ<code>--cdrom</code>æŒ‡å®šISOé•œåƒè·¯å¾„ï¼Œ<code>--network</code>æŒ‡å®šç½‘ç»œé…ç½®ï¼Œ<code>--graphics</code>æŒ‡å®šå›¾å½¢ç•Œé¢é…ç½®ã€‚</p><p>æ­¤æ—¶è¿æ¥åˆ°è™šæ‹Ÿæœºå®Œæˆé…ç½®å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virt-viewer myvm1</span><br></pre></td></tr></table></figure><p>ç°åœ¨ï¼Œæ‚¨åº”è¯¥å¯ä»¥åœ¨è™šæ‹Ÿæœºä¸­å®‰è£…æ“ä½œç³»ç»Ÿäº†</p><p>å¸¸ç”¨å‘½ä»¤æ¦‚è§ˆï¼š</p><h3 id="ç®¡ç†è™šæ‹Ÿæœº"><a href="#ç®¡ç†è™šæ‹Ÿæœº" class="headerlink" title="ç®¡ç†è™šæ‹Ÿæœº"></a>ç®¡ç†è™šæ‹Ÿæœº</h3><p>ä½¿ç”¨<code>virt-install</code>åˆ›å»ºè™šæ‹Ÿæœºåï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿›è¡Œç®¡ç†ï¼š</p><ul><li><code>virsh list --all</code>ï¼šåˆ—å‡ºæ‰€æœ‰è™šæ‹Ÿæœºã€‚</li><li><code>virsh start myvm1</code>ï¼šå¯åŠ¨è™šæ‹Ÿæœºã€‚</li><li><code>virsh stop myvm1</code>ï¼šåœæ­¢è™šæ‹Ÿæœºã€‚</li><li><code>virsh suspend myvm1</code>ï¼šæŒ‚èµ·è™šæ‹Ÿæœºã€‚</li><li><code>virsh resume myvm1</code>ï¼šæ¢å¤æŒ‚èµ·çš„è™šæ‹Ÿæœºã€‚</li><li><code>virsh destroy myvm1</code>ï¼šå¼ºåˆ¶å…³é—­è™šæ‹Ÿæœºã€‚</li></ul><p>ä½ æ‰§è¡Œçš„ <code>virsh destroy web04</code> å‘½ä»¤æ˜¯<strong>å¼ºåˆ¶å…³é—­</strong>è™šæ‹Ÿæœº <code>web04</code>ï¼Œç›¸å½“äºç›´æ¥æ–­ç”µï¼Œä¸ä¼šæ‰§è¡Œæ­£å¸¸çš„å…³æœºæµç¨‹ã€‚</p><p>å¦‚æœä½ æƒ³<strong>æ­£å¸¸å…³æœº</strong>ï¼Œå»ºè®®ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virsh shutdown web04</span><br></pre></td></tr></table></figure><p>å¦‚æœ <code>web04</code> ä¸æ˜¯æ•…æ„å…³é—­çš„ï¼Œä½ å¯ä»¥ç”¨ä¸‹é¢çš„å‘½ä»¤é‡æ–°å¯åŠ¨ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">virsh start web04</span><br></pre></td></tr></table></figure><p>å¦‚æœè™šæ‹Ÿæœºæ— æ³•å¯åŠ¨æˆ–è€…æœ‰å…¶ä»–é—®é¢˜ï¼Œæ¬¢è¿ç»§ç»­äº¤æµï¼ğŸ˜Š</p></blockquote><h2 id="äºŒ-å®‰è£…kvmè™šæ‹ŸåŒ–ç®¡ç†å·¥å…·ï¼ˆæœ¬æ•™ç¨‹ç¯å¢ƒworkstdtionï¼‰"><a href="#äºŒ-å®‰è£…kvmè™šæ‹ŸåŒ–ç®¡ç†å·¥å…·ï¼ˆæœ¬æ•™ç¨‹ç¯å¢ƒworkstdtionï¼‰" class="headerlink" title="äºŒ. å®‰è£…kvmè™šæ‹ŸåŒ–ç®¡ç†å·¥å…·ï¼ˆæœ¬æ•™ç¨‹ç¯å¢ƒworkstdtionï¼‰"></a>äºŒ. å®‰è£…kvmè™šæ‹ŸåŒ–ç®¡ç†å·¥å…·ï¼ˆæœ¬æ•™ç¨‹ç¯å¢ƒworkstdtionï¼‰</h2><table><thead><tr><th><strong>ä¸»æœºåç§°</strong></th><th><strong>IPåœ°å€</strong></th><th><strong>ç³»ç»Ÿç¯å¢ƒ</strong></th><th><strong>ç¡¬ä»¶ç¯å¢ƒ</strong></th></tr></thead><tbody><tr><td><strong>kvm01</strong></td><td><strong>10.0.0.10</strong></td><td><strong>centos7.9</strong></td><td><strong>4C8G50G</strong></td></tr></tbody></table><h3 id="è™šæ‹ŸæœºCPUå¼€å¯è™šæ‹ŸåŒ–åŠŸèƒ½"><a href="#è™šæ‹ŸæœºCPUå¼€å¯è™šæ‹ŸåŒ–åŠŸèƒ½" class="headerlink" title="è™šæ‹ŸæœºCPUå¼€å¯è™šæ‹ŸåŒ–åŠŸèƒ½"></a>è™šæ‹ŸæœºCPUå¼€å¯è™šæ‹ŸåŒ–åŠŸèƒ½</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_17270590f1aeca75a8028b0714cd4f21.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_17270590f1aeca75a8028b0714cd4f21.png"></p><p><strong>å¼€æœºåæ£€æµ‹CPUæ˜¯å¦æ”¯æŒåµŒå¥—è™šæ‹ŸåŒ–</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# egrep -o &#x27;vmx|svm&#x27; /proc/cpuinfo</span><br><span class="line">vmx</span><br><span class="line">vmx  æ˜¾ç¤ºå·²è½½å…¥çš„ç³»ç»Ÿæ¨¡å—</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…KVMç›¸å…³è½¯ä»¶åŒ…"><a href="#å®‰è£…KVMç›¸å…³è½¯ä»¶åŒ…" class="headerlink" title="å®‰è£…KVMç›¸å…³è½¯ä»¶åŒ…"></a>å®‰è£…KVMç›¸å…³è½¯ä»¶åŒ…</h3><p><strong>å‡†å¤‡å·¥ä½œ æœ¬æ–‡æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬æœ¬é¡¹ç›®ä¸æ‰§è¡Œ</strong>ï¼ˆå¯é€‰ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rm /etc/yum.repos.d</span><br><span class="line">mount /dev/cdrom /mnt</span><br><span class="line">vim /etc/fstab </span><br><span class="line">/dev/cdrom  /mnt  iso9660  default 0 Â 0 </span><br><span class="line">vim  /etc/yum.repos.d/local.repo</span><br><span class="line">[local]</span><br><span class="line">name=local</span><br><span class="line">baseurl=file:///mnt</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br></pre></td></tr></table></figure><p><strong>libvirt</strong>:  ç”¨äºåˆ›å»ºè™šæ‹Ÿæœº</p><p><strong>virt-install</strong>ï¼šè™šæ‹Ÿæœºçš„å®‰è£…å·¥å…·å’Œå…‹éš†å·¥å…·(éå¸¸é‡è¦çš„åŠŸèƒ½)</p><p><strong>qemu-kvm</strong>:  ç®¡ç†è™šæ‹Ÿæœºçš„ç£ç›˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æ£€æµ‹æº</span><br><span class="line">yum repolist</span><br><span class="line"># å®‰è£…è½¯ä»¶</span><br><span class="line">yum insta1l libvirt virt-install qemu-kvm -y</span><br><span class="line"># ubuntuuåˆ™ä¸º</span><br><span class="line">apt install -y qemu-kvm libvirt-daemon-system libvirt-clients bridge-utils virtinst</span><br><span class="line"># å¯åŠ¨æœåŠ¡</span><br><span class="line">systemctl start libvirtd &amp;&amp; systemctl enable libvirtd &amp;&amp; systemctl status libvirtd</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºKVMè™šæ‹Ÿæœºï¼ˆé€‰æ‹©è½»é‡é•œåƒæ–¹ä¾¿å®éªŒä¸Šä¼ ä¸‹è½½ï¼‰"><a href="#åˆ›å»ºKVMè™šæ‹Ÿæœºï¼ˆé€‰æ‹©è½»é‡é•œåƒæ–¹ä¾¿å®éªŒä¸Šä¼ ä¸‹è½½ï¼‰" class="headerlink" title="åˆ›å»ºKVMè™šæ‹Ÿæœºï¼ˆé€‰æ‹©è½»é‡é•œåƒæ–¹ä¾¿å®éªŒä¸Šä¼ ä¸‹è½½ï¼‰"></a>åˆ›å»ºKVMè™šæ‹Ÿæœºï¼ˆé€‰æ‹©è½»é‡é•œåƒæ–¹ä¾¿å®éªŒä¸Šä¼ ä¸‹è½½ï¼‰</h3><p><strong>æå‰å°†centosé•œåƒä¸Šä¼ åˆ°ç³»ç»Ÿå†…ç”¨äºç»™kvmè™šæ‹Ÿæœºå®‰è£…ç³»ç»Ÿ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æå‰å°†centos7é•œåƒä¼ åˆ°ç³»ç»Ÿå†…ç”¨äºç»™KVMè™šæ‹Ÿæœºå®‰è£…ç³»ç»Ÿ</span></span><br><span class="line"><span class="built_in">mv</span> CentOS-7-x86_64-Minimal-2009.iso /opt</span><br><span class="line"><span class="comment"># åˆ›å»ºKVMè™›æ‹Ÿæœº</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web01 \</span><br><span class="line">--memory 1024 \</span><br><span class="line">--vcpus 1 --disk /opt/web01-vda.raw,format=raw,size=10 --cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso \</span><br><span class="line">--network network=default --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è§£é‡Š:</span></span><br><span class="line">--virt-type kvm Â <span class="comment"># è™šæ‹ŸåŒ–çš„ç±»å‹</span></span><br><span class="line">--os-type=linux Â <span class="comment"># ç³»ç»Ÿç±»å‹</span></span><br><span class="line">--os-variant Â  Â  <span class="comment"># rhel7ç³»ç»Ÿç‰ˆæœ¬</span></span><br><span class="line">--name webO1 Â  Â  <span class="comment"># è™šæ‹Ÿæœºçš„åå­—</span></span><br><span class="line">--memory 1024 Â  Â <span class="comment"># è™šæ‹Ÿæœºçš„å†…å­˜</span></span><br><span class="line">--vcpus 1 Â  Â  Â  Â <span class="comment"># è™šæ‹Ÿcpuçš„æ ¸æ•°</span></span><br><span class="line">--disk /opt/web0l-vda.raw,format=raw,size=10 Â <span class="comment"># ç£ç›˜ä½ç½®åŠåç§°,ç£ç›˜æ ¼å¼,ç©ºé—´å¤§å°(G)</span></span><br><span class="line">--cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso <span class="comment"># ç³»ç»Ÿé•œåƒä½ç½®åŠåç§°</span></span><br><span class="line">--network network=default Â  Â  <span class="comment"># ä½¿ç”¨é»˜è®¤ç½‘ç»œ(é»˜è®¤NAT)</span></span><br><span class="line">--graphics vnc,listen=0.0.0.0 <span class="comment"># å¼€å¯VNC</span></span><br><span class="line">--noautoconsole Â  Â  Â  Â  Â  Â  Â  <span class="comment"># æœåŠ¡å™¨ç«¯æ”¯æŒconsoleç™»å½• </span></span><br></pre></td></tr></table></figure><p><strong>ç¿»è¯‘</strong>ï¼šå®‰è£…å®Œæˆåéœ€è¦å»æ§åˆ¶å°å®Œæˆå®‰è£… ç”µè„‘å®‰è£…ä¸€ä¸ªæˆ–è€…ä½¿ç”¨mobaxtermè¿æ¥å®Œæˆå®‰è£…</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_94db20daccc7489e24ae4fbc9e524935.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_94db20daccc7489e24ae4fbc9e524935.png"></p><p>è™šæ‹Ÿæœºvncæš´éœ²ç«¯å£<strong>5900</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm opt]<span class="comment"># ss -ntulp</span></span><br><span class="line">Netid State Â  Â   Recv-Q Send-Q Â  Local Address:Port Â  Â   Peer Address:Port Â  Â  Â  Â  Â  Â  Â </span><br><span class="line">tcp Â  LISTEN Â  Â  0 Â  Â  Â 1 Â  Â  *:5900 Â   <span class="built_in">users</span>:((&quot;qemu-kvm&quot;,pid=<span class="number">3551</span>,fd=<span class="number">19</span>))</span><br></pre></td></tr></table></figure><p><strong>è¿æ¥è¿‡æ¥ä¹‹åä¾¿åœ¨æ­¤å®‰è£…é¡µé¢</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d271ac8899700a02171525adff77649f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d271ac8899700a02171525adff77649f.png"></p><p>æ­¤æ—¶æŒ‰ç…§æ­£å¸¸å®‰è£…æµç¨‹å³å¯ å®‰è£…å®Œæˆåç‚¹å‡»é‡å¯æ­¤æ—¶ä¸ä¼šé‡å¯ éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ‰“å¼€ï¼ˆé€šè¿‡ <strong>ss -ntulp</strong> æŸ¥çœ‹ <strong>qemo-kvm</strong> ç«¯å£ é€šè¿‡ <strong>vnc</strong> è¿æ¥è™šæ‹ŸæœºæŸ¥çœ‹è™šæ‹Ÿæœº <strong>IP</strong> åœ°å€ï¼‰å…¶å®æ­¤æ—¶æˆ‘ä»¬ å¯ä»¥é€šè¿‡å®¿ä¸»æœº ä½¿ç”¨æ­¤è™šæ‹Ÿæœº <strong>IPï¼š192.168.122.39</strong> è¿ä¸Šè™šæ‹Ÿæœº  å¹¶ä¸”ç”±äºæ­¤æ­¤è™šæ‹Ÿæœºç½‘ç»œæ˜¯ <strong>NAT</strong> æ¨¡å¼ æ˜¯å¯ä»¥å€ŸåŠ©å®¿ä¸»æœºå»è®¿é—® <strong>å¤–ç½‘</strong> çš„ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5387c7f9aad4ae74127c22f44a330630.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5387c7f9aad4ae74127c22f44a330630.png"></p><h2 id="ä¸‰-kvmå¸¸ç”¨å‘½ä»¤ä½¿ç”¨"><a href="#ä¸‰-kvmå¸¸ç”¨å‘½ä»¤ä½¿ç”¨" class="headerlink" title="ä¸‰. kvmå¸¸ç”¨å‘½ä»¤ä½¿ç”¨"></a>ä¸‰. kvmå¸¸ç”¨å‘½ä»¤ä½¿ç”¨</h2><blockquote><p><a href="https://zznn-cloud.github.io/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/?highlight=%E5%88%9B%E5%BB%BA">æ­¤å‰åˆ›å»ºwindowsç±»å‹è™šæ‹Ÿæœºè§é“¾æ¥</a></p><h3 id="ä¸€-virshå¸¸ç”¨å‘½ä»¤æ¦‚è§ˆ"><a href="#ä¸€-virshå¸¸ç”¨å‘½ä»¤æ¦‚è§ˆ" class="headerlink" title="ä¸€. virshå¸¸ç”¨å‘½ä»¤æ¦‚è§ˆ"></a>ä¸€. virshå¸¸ç”¨å‘½ä»¤æ¦‚è§ˆ</h3><p>ç»ƒä¹ å‘½ä»¤ä¹‹å‰å®‰è£… <code>yum install -y bash-*</code>ç”¨äºå‘½ä»¤è¡¥å…¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹åˆšé€šè¿‡é•œåƒå¯åŠ¨çš„è™šæ‹Ÿæœºè™šæ‹Ÿæœº / æŸ¥çœ‹--os-variantæ”¯æŒçš„ç±»å‹</span><br><span class="line">virsh list Â  Â  Â  Â  Â  Â  # åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœº</span><br><span class="line">osinfo-query os Â  Â  Â  Â # æŸ¥çœ‹æ”¯æŒçš„ç±»å‹</span><br><span class="line"># virt-installå¸¸ç”¨å‘½ä»¤</span><br><span class="line">virsh list --all Â  Â  Â  # åˆ—å‡ºæ‰€æœ‰è™šæœº</span><br><span class="line">virsh start  web01 Â  Â  # å¯åŠ¨æŒ‡å®šè™šæœº</span><br><span class="line">virsh reboot web01 Â  Â  # é‡å¯æŒ‡å®šè™šæœºï¼ˆå…³é—­çŠ¶æ€æ— æ³•é‡å¯ï¼‰</span><br><span class="line">virsh console name Â  Â  # è¿æ¥è™šæ‹Ÿæœº</span><br><span class="line">virsh destroy name Â  Â  # æ‹”æ‰ç”µæºï¼ˆå¾ˆå°‘ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">virsh undefine web01 Â  # åˆ é™¤è™šæœºæ–‡ä»¶å³åˆ é™¤è™šæ‹Ÿæœºï¼ˆä¸ä¼šåˆ é™¤ç£ç›˜æ–‡ä»¶ï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">virsh domblklist web01 Â  Â  Â  Â  Â  Â  # æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜ä¿¡æ¯</span><br><span class="line">virsh dominfo Â   web01 Â  Â  Â  Â  Â  Â  # æŸ¥çœ‹è™šæ‹Ÿæœºé…ç½®ä¿¡æ¯</span><br><span class="line">virsh domiflist  web01 Â  Â  Â  Â  Â  Â  # æŸ¥çœ‹è™šæ‹Ÿç½‘å¡ä¿¡æ¯</span><br><span class="line">virsh dumpxml Â   web01 Â  Â  Â  Â  Â  Â  # ä»¥ xmlæ ¼å¼æŸ¥çœ‹è™šæ‹Ÿæœº</span><br><span class="line">virsh define Â  Â  file-name Â  Â  Â  Â # å¯¼å…¥è™šæ‹Ÿæœº</span><br><span class="line">virsh edit Â  Â  Â  name Â  Â  Â  Â  Â  Â  # ç¼–è¾‘è™šæ‹Ÿæœºé…ç½®ï¼ˆä¸€èˆ¬æ˜¯åœ¨åˆšå®šä¹‰å®Œè™šæ‹Ÿæœºä¹‹åï¼‰è‡ªå¸¦è¯­æ³•æ£€æµ‹</span><br><span class="line">virsh domrename  old-name  new-name Â  # è™šæ‹Ÿæœºé‡å‘½å</span><br><span class="line">virsh vncdisplay web01 Â  Â  Â  Â  Â  Â  Â  Â # æŸ¥çœ‹vncç«¯å£</span><br><span class="line">virsh autostart  name Â  Â  Â  Â  Â  Â  Â  Â  # è™šæ‹Ÿæœºéšæœºé‡å¯</span><br><span class="line">virsh autostart --disable name Â  Â  Â  Â # å–æ¶ˆè™šæ‹Ÿæœºéšæœºé‡å¯</span><br><span class="line"></span><br><span class="line"># å›¾å½¢ç•Œé¢ï¼š</span><br><span class="line">é€šè¿‡æ‰§è¡Œåvirt-managerï¼Œå¯åŠ¨libvirtçš„å›¾å½¢ç•Œé¢ï¼Œåœ¨å›¾å½¢ç•Œé¢ä¸‹å¯ä»¥ä¸€æ­¥ä¸€æ­¥çš„åˆ›å»ºè™šæ‹Ÿæœºï¼Œç®¡ç†è™šæ‹Ÿæœºï¼Œè¿˜å¯ä»¥ç›´æ¥æ§åˆ¶è™šæ‹Ÿæœºçš„æ¡Œé¢ã€‚</span><br><span class="line"># å‘½ä»¤è¡Œï¼š</span><br><span class="line">virsh list Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ˜¾ç¤ºæœ¬åœ°æ´»åŠ¨è™šæ‹Ÿæœº</span><br><span class="line">virsh list â€“all Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # æ˜¾ç¤ºæœ¬åœ°æ‰€æœ‰çš„è™šæ‹Ÿæœºï¼ˆæ´»åŠ¨çš„+ä¸æ´»åŠ¨çš„ï¼‰</span><br><span class="line">virsh define ubuntu.xml Â  Â  Â  Â  Â  Â  Â  Â  # é€šè¿‡é…ç½®æ–‡ä»¶å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆè¿™ä¸ªè™šæ‹Ÿæœºè¿˜ä¸æ˜¯æ´»åŠ¨çš„ï¼‰</span><br><span class="line">virsh start ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # å¯åŠ¨åå­—ä¸ºubuntuçš„éæ´»åŠ¨è™šæ‹Ÿæœº</span><br><span class="line">virsh create ubuntu.xml Â  Â  Â  Â  Â  Â  Â  Â  # åˆ›å»ºè™šæ‹Ÿæœºï¼ˆåˆ›å»ºåï¼Œè™šæ‹Ÿæœºç«‹å³æ‰§è¡Œï¼Œæˆä¸ºæ´»åŠ¨ä¸»æœºï¼‰</span><br><span class="line">virsh suspend ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æš‚åœè™šæ‹Ÿæœº</span><br><span class="line">virsh resume ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # å¯åŠ¨æš‚åœçš„è™šæ‹Ÿæœº</span><br><span class="line">virsh shutdown web01 Â  Â  Â  Â  Â # æ­£å¸¸å…³é—­è™šæ‹Ÿæœº</span><br><span class="line">virsh destroy ubuntu Â  Â  Â  Â  Â # å¼ºåˆ¶æ‹”æ‰ç”µæºå…³é—­è™šæ‹Ÿæœºï¼ˆå¾ˆå°‘ä½¿ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">virsh domname 2 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # æ˜¾ç¤ºidå·ä¸º2çš„è™šæ‹Ÿæœºå Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><br><span class="line">virsh domid ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ˜¾ç¤ºè™šæ‹Ÿæœºidå· Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span><br><span class="line">virsh domuuid ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„uuid Â  Â  Â  Â  Â  </span><br><span class="line">virsh domstate ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰çŠ¶æ€ Â  Â  Â  Â  Â </span><br><span class="line">virsh dumpxml ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰é…ç½®æ–‡ä»¶ï¼ˆå¯èƒ½å’Œå®šä¹‰è™šæ‹Ÿæœºæ—¶çš„é…ç½®ä¸åŒï¼Œå› ä¸ºå½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œéœ€è¦ç»™# è™šæ‹Ÿæœºåˆ†é…idå·ã€uuidã€vncç«¯å£å·ç­‰ç­‰ï¼‰ Â  Â  Â  Â  Â </span><br><span class="line">virsh setmem ubuntu 512000 Â  Â  Â  Â  Â  Â  Â  # ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®å†…å­˜å¤§å° Â </span><br><span class="line">virsh setvcpus ubuntu 4 Â  Â  Â  Â  Â  Â  Â  Â  Â # ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®cpuä¸ªæ•° Â  Â  Â  Â  Â </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="äºŒ-å¤‡ä»½æ¢å¤è™šæ‹Ÿæœº"><a href="#äºŒ-å¤‡ä»½æ¢å¤è™šæ‹Ÿæœº" class="headerlink" title="äºŒ. å¤‡ä»½æ¢å¤è™šæ‹Ÿæœº"></a>äºŒ. å¤‡ä»½æ¢å¤è™šæ‹Ÿæœº</h3><p><strong>å¤‡ä»½è™šæ‹Ÿæœº</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å‡ºè™šæ‹Ÿæœºé…ç½®æ–‡ä»¶</span></span><br><span class="line">virsh dumpxml web01 &gt; web01_bak.xml</span><br><span class="line"><span class="comment"># æ­¤æ—¶æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹æ¢å¤è™šæ‹Ÿæœºå…ˆåˆ é™¤è™šæ‹Ÿæœº</span></span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤è™šæ‹Ÿæœºï¼ˆå…ˆå…³æœºå†åˆ é™¤ï¼‰ æ­¤æ—¶ç£ç›˜æ–‡ä»¶ä»ç„¶æ˜¯è¢«ä¿ç•™çš„</strong></p><p><strong>å¤‡æ³¨</strong>ï¼šæ­¤æ­¥éª¤ä¸ºæ¨¡æ‹Ÿæ¢å¤è™šæ‹Ÿæœºæ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">virsh shutdown web01</span><br><span class="line">virsh undefine web01 </span><br><span class="line">virsh list --all</span><br></pre></td></tr></table></figure><p><strong>æ¢å¤è™šæ‹Ÿæœºï¼ˆä»¥åˆšæ‰çš„å¤‡ä»½æ–‡ä»¶å¯¼å…¥è™šæ‹Ÿæœºï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»å¤‡ä»½æ–‡ä»¶å¯¼å…¥è™šæ‹Ÿæœº</span></span><br><span class="line">virsh define web01_bak.xml</span><br><span class="line"><span class="comment"># æ­¤æ—¶å†çœ‹åˆšæ‰çš„è™šæ‹Ÿæœºåˆå›æ¥äº†</span></span><br><span class="line">virsh list --all</span><br><span class="line"></span><br><span class="line">Id Â   Name Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  State</span><br><span class="line">-----------------------------------------</span><br><span class="line"> - Â   web01 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   shut off</span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆåˆå›æ¥äº†å‘¢ å› ä¸ºæˆ‘ä»¬ä½¿ç”¨virsh undefine  åˆ é™¤çš„æ˜¯ /etc/libvirt/qemu è·¯å¾„ä¸‹å¯¹åº”çš„è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_cbceb58948ef431e9a1f63b2c22da55b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_cbceb58948ef431e9a1f63b2c22da55b.png"></p><h3 id="ä¸‰-è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶è¿ç§»"><a href="#ä¸‰-è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶è¿ç§»" class="headerlink" title="ä¸‰. è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶è¿ç§»"></a>ä¸‰. è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶è¿ç§»</h3><p>å¤‡æ³¨ï¼šæˆ‘ä»¬åˆ›å»ºè™šæ‹Ÿæœºæ—¶ä¼š ç”Ÿæˆäº†ä¸€ä¸ªrawæ ¼å¼çš„ç£ç›˜æ–‡ä»¶ web01-vda.raw</p><p><strong>åˆ›å»ºkvmè·¯å¾„ï¼Œå°†è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶ç§»åŠ¨åˆ°è¯¥ç›®å½•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºkvmè·¯å¾„ï¼Œå°†è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶ç§»åŠ¨åˆ°è¯¥ç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> /kvm &amp;&amp; <span class="built_in">mv</span> /opt/web01-vda.raw /kvm &amp;&amp; <span class="built_in">cd</span> /kvm &amp;&amp; <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p><strong>ç¼–è¾‘è™šæ‹Ÿæœºé…ç½®ï¼ˆè‡ªå¸¦è¯­æ³•æ£€æµ‹ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤‡ä»½è™šæ‹Ÿæœºé…ç½®ï¼ˆç¼–è¾‘å‰å…ˆå¤‡ä»½ï¼‰</span></span><br><span class="line">virsh dumpxml web01 &gt; web01_bak.xml</span><br><span class="line"><span class="comment"># ç¼–è¾‘è™šæ‹Ÿæœºé…ç½®</span></span><br><span class="line">virsh edit web01</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹è·¯å¾„ /opt/web01-vda.raw &gt;&gt; /kvm/web01-vda.rawï¼ˆä¿®æ”¹å‰ï¼‰</span></span><br><span class="line">  &lt;devices&gt;</span><br><span class="line"> Â   &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;</span><br><span class="line"> Â   &lt;disk <span class="built_in">type</span>=<span class="string">&#x27;file&#x27;</span> device=<span class="string">&#x27;disk&#x27;</span>&gt;</span><br><span class="line"> Â  Â   &lt;driver name=<span class="string">&#x27;qemu&#x27;</span> <span class="built_in">type</span>=<span class="string">&#x27;raw&#x27;</span>/&gt;</span><br><span class="line"> Â  Â   &lt;<span class="built_in">source</span> file=<span class="string">&#x27;/opt/web01-vda.raw&#x27;</span>/&gt; Â  <span class="comment"># æ­¤è·¯å¾„</span></span><br><span class="line"> Â  Â   &lt;target dev=<span class="string">&#x27;vda&#x27;</span> bus=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line"> Â  Â   &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x06&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line"> Â   &lt;/disk&gt;</span><br><span class="line"> Â   &lt;disk <span class="built_in">type</span>=<span class="string">&#x27;file&#x27;</span> device=<span class="string">&#x27;cdrom&#x27;</span>&gt;</span><br><span class="line"> Â  Â   &lt;driver name=<span class="string">&#x27;qemu&#x27;</span> <span class="built_in">type</span>=<span class="string">&#x27;raw&#x27;</span>/&gt;</span><br><span class="line"></span><br><span class="line"> <span class="comment"># ä¿®æ”¹å</span></span><br><span class="line"> Â  &lt;devices&gt;</span><br><span class="line"> Â   &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;</span><br><span class="line"> Â   &lt;disk <span class="built_in">type</span>=<span class="string">&#x27;file&#x27;</span> device=<span class="string">&#x27;disk&#x27;</span>&gt;</span><br><span class="line"> Â  Â   &lt;driver name=<span class="string">&#x27;qemu&#x27;</span> <span class="built_in">type</span>=<span class="string">&#x27;raw&#x27;</span>/&gt;</span><br><span class="line"> Â  Â   &lt;<span class="built_in">source</span> file=<span class="string">&#x27;/kvm/web01-vda.raw&#x27;</span>/&gt; Â  Â <span class="comment"># æ­¤è·¯å¾„</span></span><br><span class="line"> Â  Â   &lt;target dev=<span class="string">&#x27;vda&#x27;</span> bus=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line"> Â  Â   &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x06&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line"> Â   &lt;/disk&gt;</span><br><span class="line"><span class="comment"># æ­¤æ—¶å¯åŠ¨è™šæ‹Ÿæœº</span></span><br><span class="line">virsh start web01</span><br><span class="line"></span><br><span class="line">[root@kvm kvm]<span class="comment"># virsh start web01</span></span><br><span class="line">Domain web01 started</span><br><span class="line"></span><br><span class="line">[root@kvm kvm]<span class="comment"># virsh list --all</span></span><br><span class="line"> Id Â   Name Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  State</span><br><span class="line">----------------------------------------------------</span><br><span class="line"> 5 Â  Â  web01 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   running</span><br></pre></td></tr></table></figure><h3 id="å››-è™šæ‹Ÿæœºé‡å‘½åï¼ˆåªèƒ½åœ¨å…³æœºçŠ¶æ€æ”¹åï¼‰"><a href="#å››-è™šæ‹Ÿæœºé‡å‘½åï¼ˆåªèƒ½åœ¨å…³æœºçŠ¶æ€æ”¹åï¼‰" class="headerlink" title="å››. è™šæ‹Ÿæœºé‡å‘½åï¼ˆåªèƒ½åœ¨å…³æœºçŠ¶æ€æ”¹åï¼‰"></a>å››. è™šæ‹Ÿæœºé‡å‘½åï¼ˆåªèƒ½åœ¨å…³æœºçŠ¶æ€æ”¹åï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³æœº</span></span><br><span class="line">virsh shutdown web01</span><br><span class="line"><span class="comment"># æ”¹å</span></span><br><span class="line">virsh domrename web01 centos-web01</span><br></pre></td></tr></table></figure><h3 id="äº”-æŸ¥çœ‹è™šæ‹Ÿæœº-vnc-ç«¯å£ï¼ˆè™šæ‹Ÿæœºå¤ªå¤šä¹‹å-VNC-ç«¯å£å°±ä¼šä¸ä¸€æ ·ï¼‰åªæœ‰å¯åŠ¨çŠ¶æ€æ‰ä¼šæœ‰-VNC-ç«¯å£"><a href="#äº”-æŸ¥çœ‹è™šæ‹Ÿæœº-vnc-ç«¯å£ï¼ˆè™šæ‹Ÿæœºå¤ªå¤šä¹‹å-VNC-ç«¯å£å°±ä¼šä¸ä¸€æ ·ï¼‰åªæœ‰å¯åŠ¨çŠ¶æ€æ‰ä¼šæœ‰-VNC-ç«¯å£" class="headerlink" title="äº”. æŸ¥çœ‹è™šæ‹Ÿæœº vnc ç«¯å£ï¼ˆè™šæ‹Ÿæœºå¤ªå¤šä¹‹å VNC ç«¯å£å°±ä¼šä¸ä¸€æ ·ï¼‰åªæœ‰å¯åŠ¨çŠ¶æ€æ‰ä¼šæœ‰ VNC ç«¯å£"></a>äº”. æŸ¥çœ‹è™šæ‹Ÿæœº vnc ç«¯å£ï¼ˆè™šæ‹Ÿæœºå¤ªå¤šä¹‹å VNC ç«¯å£å°±ä¼šä¸ä¸€æ ·ï¼‰åªæœ‰å¯åŠ¨çŠ¶æ€æ‰ä¼šæœ‰ VNC ç«¯å£</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨</span></span><br><span class="line">virsh start web01</span><br><span class="line"><span class="comment"># æŸ¥çœ‹vncç«¯å£</span></span><br><span class="line">virsh vncdisplay web01</span><br><span class="line">// è¿”å›</span><br><span class="line">:0</span><br></pre></td></tr></table></figure><p>**å¤‡æ³¨ï¼šå•å°è™šæ‹Ÿæœºæ—¶è¿”å› å…¶å®æ­¤ **<strong>0</strong> ä»£è¡¨é»˜è®¤ç«¯å£ <strong>5900</strong> å¤šå°æ—¶ä¾¿ä¼šç½‘ä¸Šå¢åŠ  å¦‚ä¸¤å°æ—¶ æ˜¾ç¤º <strong>1</strong> å³ ä» <strong>5900</strong> å¾€ä¸ŠåŠ  <strong>1</strong> å³ <strong>5901</strong></p><h3 id="å…­-è™šæ‹Ÿæœºéšæœºè‡ªå¯ï¼ˆ-ä¸ºäº†å®¿ä¸»æœºé‡å¯åè™šæ‹Ÿæœºä¹Ÿä¼šé‡å¯-ï¼‰å¦åˆ™å®¿ä¸»æœºé‡å¯-è™šæ‹Ÿæœºä¸ä¼šè‡ªå¯åŠ¨"><a href="#å…­-è™šæ‹Ÿæœºéšæœºè‡ªå¯ï¼ˆ-ä¸ºäº†å®¿ä¸»æœºé‡å¯åè™šæ‹Ÿæœºä¹Ÿä¼šé‡å¯-ï¼‰å¦åˆ™å®¿ä¸»æœºé‡å¯-è™šæ‹Ÿæœºä¸ä¼šè‡ªå¯åŠ¨" class="headerlink" title="å…­.  è™šæ‹Ÿæœºéšæœºè‡ªå¯ï¼ˆ ä¸ºäº†å®¿ä¸»æœºé‡å¯åè™šæ‹Ÿæœºä¹Ÿä¼šé‡å¯ ï¼‰å¦åˆ™å®¿ä¸»æœºé‡å¯ è™šæ‹Ÿæœºä¸ä¼šè‡ªå¯åŠ¨"></a>å…­.  è™šæ‹Ÿæœºéšæœºè‡ªå¯ï¼ˆ ä¸ºäº†å®¿ä¸»æœºé‡å¯åè™šæ‹Ÿæœºä¹Ÿä¼šé‡å¯ ï¼‰å¦åˆ™å®¿ä¸»æœºé‡å¯ è™šæ‹Ÿæœºä¸ä¼šè‡ªå¯åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ä¸å®¿ä¸»æœºä¸€èµ·éšæœºè‡ªå¯</span></span><br><span class="line">virsh autostart web01</span><br><span class="line"><span class="comment"># æŸ¥çœ‹é‚£äº›è™šæ‹Ÿæœºè®¾ç½®äº†éšæœºè‡ªå¯ï¼ˆä¸€ä¸ªéƒ½æ²¡æœ‰è®¾ç½®çš„è¯æ­¤ç›®å½•ä¸ä¼šç”Ÿæˆä¸è™šæ‹Ÿæœºç›¸åŒåå­—çš„æ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="built_in">cd</span> /etc/libvirt/qemu/autostart &amp;&amp; <span class="built_in">ls</span></span><br><span class="line">web01.xml</span><br><span class="line"><span class="comment"># å–æ¶ˆéšæœºè‡ªå¯ï¼ˆæ­¤æ—¶æ­¤/etc/libvirt/qemu/autostartç›®å½•å¯¹åº”æ–‡ä»¶å·²æ¶ˆå¤±ï¼‰</span></span><br><span class="line">virsh autostart web01 --<span class="built_in">disable</span></span><br></pre></td></tr></table></figure><h3 id="ä¸ƒ-é€šè¿‡consoleç™»å½•kvm"><a href="#ä¸ƒ-é€šè¿‡consoleç™»å½•kvm" class="headerlink" title="ä¸ƒ. é€šè¿‡consoleç™»å½•kvm"></a>ä¸ƒ. é€šè¿‡<code>console</code>ç™»å½•<code>kvm</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡consoleç™»å½•è™šæ‹Ÿæœºæ§åˆ¶å°</span></span><br><span class="line">virsh console web01</span><br><span class="line">// è¿”å›</span><br><span class="line">Connected to domain web01</span><br><span class="line">Escape character is ^] Â <span class="comment"># ctrl + ] é€€å‡ºï¼Œé»˜è®¤æ— æ³•ç™»å½•</span></span><br></pre></td></tr></table></figure><p><strong>è™šæ‹Ÿæœºé…ç½®å…è®¸<code>console</code>ç™»å½•</strong></p><p>è¿›å…¥ <strong>KVM</strong> è™šæ‹Ÿæœºä¿®æ”¹å†…æ ¸å‚æ•°å…è®¸ <strong>console</strong> ç™»å½•ï¼Œå…ˆé€šè¿‡ <strong>VNC</strong> æŸ¥çœ‹è™šæ‹Ÿæœº <strong>IP</strong> åœ°å€ï¼Œåœ¨é€šè¿‡å®¿ä¸»æœº <strong>ssh</strong> æ–¹å¼ç™»å½•åˆ° <strong>KVM</strong> å†…éƒ¨å¢åŠ è¯¥é…ç½®é¡¹: grubby-update-kernel=ALL-args=â€console=ttyS0,115200n8â€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥kvmè™šæ‹Ÿæœº</span></span><br><span class="line">ssh -p22 root@192.168.122.39</span><br><span class="line"><span class="comment"># ä¿®æ”¹å†…æ ¸å‚æ•°</span></span><br><span class="line">grubby --update-kernel=ALL --args=<span class="string">&quot;console=ttyS0,115200n8&quot;</span></span><br><span class="line"><span class="comment"># é‡å¯è™šæ‹Ÿæœºç”Ÿæ•ˆ</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯ console ç™»å½•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># console ç™»å½•è™šæ‹Ÿæœº</span></span><br><span class="line">virsh console web01</span><br><span class="line">// è¿”å›</span><br><span class="line">Connected to domain web01</span><br><span class="line">Escape character is ^] Â  <span class="comment"># å›è½¦</span></span><br><span class="line"></span><br><span class="line">CentOS Linux 7 (Core)</span><br><span class="line">Kernel 3.10.0-1160.el7.x86_64 on an x86_64</span><br><span class="line"></span><br><span class="line">localhost login: Â  Â  Â  Â  <span class="comment"># æ­¤æ—¶å‡ºç°ç™»å½•é€‰é¡¹</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ee9df9423348cd4db4a62b05f970e4a5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ee9df9423348cd4db4a62b05f970e4a5.png"></p></blockquote><h2 id="å››-KVMç£ç›˜ç®¡ç†"><a href="#å››-KVMç£ç›˜ç®¡ç†" class="headerlink" title="å››. KVMç£ç›˜ç®¡ç†"></a>å››. <code>KVM</code>ç£ç›˜ç®¡ç†</h2><p><strong>kvmç£ç›˜æ ¼å¼ä»‹ç»</strong></p><p><strong>raw</strong>: è€ç‰Œæ ¼å¼ï¼Œç”¨ä¸€ä¸ªå­—æ¥è¯´å°±æ˜¯è£¸ï¼Œä¹Ÿå°±æ˜¯èµ¤è£¸è£¸ï¼ŒæŒ‡å®šå¤šå¤§ç©ºé—´å°±åˆ›å»ºå¤šå¤§ç©ºé—´ï¼Œç›´æ¥å ç”¨æŒ‡å®šå¤§å°çš„ç©ºé—´åˆ† <strong>50G</strong> å ç”¨ <strong>50G</strong> ï¼Œæ€§èƒ½ä¸Šæ¥è¯´çš„è¯è¿˜æ˜¯ä¸é”™çš„ï¼Œä¸æ”¯æŒå¿«ç…§åŠŸèƒ½ã€‚</p><p><strong><strong>cow</strong>: æ›¾ç» qemu çš„å†™æ—¶æ‹·è´çš„é•œåƒæ ¼å¼ï¼ˆç”¨æˆ·åœ¨ä¿®æ”¹æ•°æ®æ—¶ï¼Œç³»ç»Ÿä¼šæ‹·è´ä¸€ä»½æºæ–‡ä»¶å‰¯æœ¬åˆ°å†…å­˜ä¸­è®©å…¶ä¿®æ”¹ï¼Œç­‰åˆ°æ•°æ®çœŸæ­£è¢«ä¿®æ”¹æ—¶æ‰åˆ†é…ç©ºé—´ï¼‰ç›®å‰ç”±äºå†å²é—ç•™åŸå› ä¸æ”¯æŒçª—å£æ¨¡å¼ã€‚ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´æ˜¯ä¸ªå¼ƒå©´ï¼Œè¿˜æ²¡ç­‰å®ƒæˆç†Ÿå°±æ­»åœ¨è…¹ä¸­ï¼Œåæ¥è¢« qcow æ ¼å¼æ‰€å–ä»£ã€‚</strong> <strong><strong>qcow</strong>: ä¸€ä»£çš„ qemu çš„ cow æ ¼å¼ï¼Œåˆšåˆšå‡ºç°çš„æ—¶å€™æœ‰æ¯”è¾ƒå¥½çš„ç‰¹æ€§ï¼Œä½†å…¶æ€§èƒ½å’Œ raw æ ¼å¼å¯¹æ¯”è¿˜æ˜¯æœ‰å¾ˆå¤§çš„å·®è·ï¼Œç›®å‰å·²ç»è¢«æ–°ç‰ˆæœ¬çš„qcow2 å–ä»£ã€‚</strong></p><p><strong>qcow2</strong>: æ˜¯ openstack é»˜è®¤ä¹Ÿæ˜¯æ¯”è¾ƒæ¨èçš„æ ¼å¼ï¼Œæ–‡ä»¶æ¯”è¾ƒå°è€Œä¸”åšå¿«ç…§ä¹Ÿæ¯”è¾ƒå°ï¼Œç©ºé—´æ˜¯åŠ¨æ€å¢é•¿ï¼ˆç”¨å¤šå°‘å å¤šå°‘ ä½†ä¸ä¼šè¶…è¿‡å®šä¹‰çš„å®¹é‡ï¼‰ï¼Œæ˜¯ç›®å‰æ¯”è¾ƒä¸»æµçš„ä¸€ç§è™šæ‹ŸåŒ–é•œåƒæ ¼å¼ï¼Œç»è¿‡ä¸€ä»£çš„ä¼˜åŒ–ï¼Œç›®å‰ qcow2 çš„æ€§èƒ½ä¸Šæ¥è¿‘ raw è£¸æ ¼å¼çš„æ€§èƒ½ã€‚</p><p><strong>æˆ‘ä»¬åˆ›å»ºæ—¶å°±æ˜¯ä½¿ç”¨ raw æ ¼å¼åˆ›å»ºçš„</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_6aadb90398f3b87f7888616461239e9d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_6aadb90398f3b87f7888616461239e9d.png"></p><p><strong>æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜</span></span><br><span class="line">virsh domblklist web01</span><br><span class="line">// è¿”å›</span><br><span class="line">Target Â  Â  Source</span><br><span class="line">------------------------------------------------</span><br><span class="line">vda Â  Â  Â  Â  /kvm/web01-vda.raw</span><br><span class="line">hda Â  Â  Â  Â  -</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹ç£ç›˜è¯¦ç»†ä¿¡æ¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç£ç›˜è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">qemu-img info /kvm/web01-vda.raw</span><br><span class="line">// è¿”å›</span><br><span class="line">image: /kvm/web01-vda.raw</span><br><span class="line">file format: raw</span><br><span class="line">virtual size: 10G (10737418240 bytes)</span><br><span class="line">disk size: 1.7G</span><br></pre></td></tr></table></figure><h3 id="1-åˆ›å»º-qcow2-æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº"><a href="#1-åˆ›å»º-qcow2-æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº" class="headerlink" title="1. åˆ›å»º qcow2 æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº"></a><code>1.</code> åˆ›å»º qcow2 æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º qcow2 æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web02 \</span><br><span class="line">--memory 1024 \</span><br><span class="line">--vcpus 1 --disk /kvm/web02-vda.qcow2,format=qcow2,size=10 --cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso \</span><br><span class="line">--network network=default --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹ VNC ç«¯å£ å¯è§ç«¯å£æ˜¯ 5901</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm kvm]<span class="comment"># virsh vncdisplay web02</span></span><br><span class="line">:1</span><br></pre></td></tr></table></figure><p><strong>VNC è¿æ¥</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7185c32c48a56a379db496bfe893fee4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7185c32c48a56a379db496bfe893fee4.png"></p><h3 id="2-qcow2æ ¼å¼ç£ç›˜è™šæ‹Ÿæœºä½¿ç”¨"><a href="#2-qcow2æ ¼å¼ç£ç›˜è™šæ‹Ÿæœºä½¿ç”¨" class="headerlink" title="2. qcow2æ ¼å¼ç£ç›˜è™šæ‹Ÿæœºä½¿ç”¨"></a><code>2. qcow2</code>æ ¼å¼ç£ç›˜è™šæ‹Ÿæœºä½¿ç”¨</h3><p><strong>æŸ¥çœ‹ç£ç›˜æ ¼å¼</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç£ç›˜æ ¼å¼</span></span><br><span class="line">qemu-img info web02-vda.qcow2</span><br><span class="line">//è¿”å›</span><br><span class="line">image: web02-vda.qcow2</span><br><span class="line">file format: qcow2</span><br><span class="line">virtual size: 10G (10737418240 bytes)</span><br><span class="line">disk size: 1.5G Â  Â  Â  Â  <span class="comment"># ç”¨å¤šå°‘å å¤šå°‘</span></span><br><span class="line">cluster_size: 65536</span><br><span class="line">Format specific information:</span><br><span class="line"> Â   compat: 1.1</span><br><span class="line"> Â   lazy refcounts: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><strong>æ“ä½œ</strong>ï¼š</p><ul><li><strong>å¼€æœºè™šæ‹Ÿæœºå®¿ä¸»æœºé‡å¯è™šæ‹Ÿæœºè‡ªå¯åŠ¨</strong><code>virsh autostart web01</code></li><li><strong>ç™»å½•ï¼š</strong><code>ssh -p22 root@192.168.122.46</code></li><li><strong>è™šæ‹Ÿæœºé…ç½®å…è®¸ console ç™»å½•ï¼š</strong><code>grubby --update-kernel=ALL --args=&quot;console=ttyS0,115200n8&quot;</code></li><li><strong>ç”Ÿæ•ˆï¼ˆ</strong><code>virsh shutdown web02 &amp;&amp; virsh start web02</code>ï¼‰</li><li><strong>é€šè¿‡consoleç™»å½•ï¼š</strong><code>virsh console web02</code></li></ul><h2 id="äº”-kvmç£ç›˜è™šæ‹Ÿæœºå¿«ç…§ç®¡ç†"><a href="#äº”-kvmç£ç›˜è™šæ‹Ÿæœºå¿«ç…§ç®¡ç†" class="headerlink" title="äº”. kvmç£ç›˜è™šæ‹Ÿæœºå¿«ç…§ç®¡ç†"></a>äº”. <code>kvm</code>ç£ç›˜è™šæ‹Ÿæœºå¿«ç…§ç®¡ç†</h2><p><strong>raw ç£ç›˜æ ¼å¼è™šæ‹Ÿæœº****ä¸æ”¯æŒåšå¿«ç…§</strong>ï¼Œqcow2 <strong>æ”¯æŒå¿«ç…§</strong>ï¼Œå¹¶ä¸”å¿«ç…§å°±ä¿å­˜åœ¨ qcow2 çš„ç£ç›˜æ–‡ä»¶ä¸­ã€‚</p><h3 id="1-åˆ›å»ºå¿«ç…§"><a href="#1-åˆ›å»ºå¿«ç…§" class="headerlink" title="1.åˆ›å»ºå¿«ç…§"></a><code>1.</code>åˆ›å»ºå¿«ç…§</h3><p><strong>æ ¼å¼: virsh snapshot-create-as   â€“name  å¿«ç…§åç§°   è™šæ‹Ÿæœºåç§°</strong></p><blockquote><p><strong>è§£é‡Šï¼š</strong></p><p><strong>virsh snapshot-create-as åˆ›å»ºå¿«ç…§</strong> <strong>â€“name                   å¿«ç…§åç§°</strong> <strong>web02                    è™šæ‹Ÿæœºåç§°</strong></p></blockquote><p>ä¸º <strong>web02</strong> è™šæ‹Ÿæœºåˆ›å»ºå¿«ç…§ï¼ˆå¼€å…³æœºéƒ½å¯ä»¥åšå¿«ç…§ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸º web02 è™šæ‹Ÿæœºåˆ›å»ºå¿«ç…§</span></span><br><span class="line">virsh snapshot-create-as --name  kuaizhao_web2_env_ok  web2</span><br><span class="line">//è¿”å›</span><br><span class="line">Domain snapshot kuaizhao_web2_env_ok created</span><br><span class="line"><span class="comment"># åˆ›å»ºæˆåŠŸåæŸ¥çœ‹å¿«ç…§</span></span><br><span class="line">virsh snapshot-list web02</span><br><span class="line">//è¿”å›</span><br><span class="line"> Name Â  Â  Â  Â  Â  Â  Â  Â  Creation Time Â  Â  Â  Â  Â  Â  State</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"> kuaizhao_web2_env_ok 2024-04-21 16:30:45 +0800 running</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯å¿«ç…§</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç™»å½•è™šæ‹Ÿæœº</span></span><br><span class="line">virsh console web02</span><br><span class="line"><span class="comment"># åˆ›å»ºå¿«ç…§æµ‹è¯•æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">touch</span> kuaizhao-test.txt</span><br></pre></td></tr></table></figure><h3 id="2-è¿˜åŸå¿«ç…§"><a href="#2-è¿˜åŸå¿«ç…§" class="headerlink" title="2. è¿˜åŸå¿«ç…§"></a><code>2.</code> è¿˜åŸå¿«ç…§</h3><p><strong>æ ¼å¼:  virsh snapshot-revert  è™šæ‹Ÿæœºåç§°  â€“snapshotname  å¿«ç…§åç§°</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰§è¡Œæ¢å¤å¿«ç…§</span></span><br><span class="line">virsh snapshot-revert web02 --snapshotname kuaizhao_web2_env_ok</span><br></pre></td></tr></table></figure><p><strong>å¤‡æ³¨ï¼šæŸ¥çœ‹åˆ›å»ºçš„æ–‡ä»¶è¿˜å­˜åœ¨ä¸ ï¼ˆä¸å­˜åœ¨ æ­¤æ—¶éªŒè¯æˆåŠŸï¼‰</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d7d30c0888f72a011b3c3eafe594c960.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d7d30c0888f72a011b3c3eafe594c960.png"></p><blockquote><p><strong>æç¤ºï¼šåˆ«åˆ é™¤è™šæ‹Ÿæœºï¼Œåˆ é™¤è™šæ‹Ÿæœºåæ²¡æœ‰è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶æ— æ³•è¿˜åŸ</strong></p></blockquote><h3 id="3-åˆ é™¤å¿«ç…§"><a href="#3-åˆ é™¤å¿«ç…§" class="headerlink" title="3. åˆ é™¤å¿«ç…§"></a><code>3.</code> åˆ é™¤å¿«ç…§</h3><p><strong>æ ¼å¼:  virsh  snapshot-delete è™šæ‹Ÿæœºåç§°  â€“snapshotname  å¿«ç…§åç§°</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤å¿«ç…§</span></span><br><span class="line">virsh snapshot-delete web02 --snapshotname kuaizhao_web2_env_ok </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ˜¯å¦åˆ é™¤æˆåŠŸ</span></span><br><span class="line">virsh snapshot-list web02</span><br><span class="line">//è¿”å›</span><br><span class="line"> Name Â  Â  Â  Â  Â  Â  Â  Â  Creation Time Â  Â  Â  Â  Â  Â  State</span><br><span class="line">------------------------------------------------------------</span><br></pre></td></tr></table></figure><h2 id="å…­-kvmè™šæ‹Ÿæœºå…‹éš†"><a href="#å…­-kvmè™šæ‹Ÿæœºå…‹éš†" class="headerlink" title="å…­. kvmè™šæ‹Ÿæœºå…‹éš†"></a>å…­. <code>kvm</code>è™šæ‹Ÿæœºå…‹éš†</h2><p><strong>è™šæ‹Ÿæœºçš„å…‹éš†æ–¹å¼åˆ†ä¸ºå®Œæ•´å…‹éš†ä¸é“¾æ¥å…‹éš†ï¼Œä¸‹å›¾æ˜¯VMwareè™šæ‹Ÿæœºå¯¹å®Œæ•´å…‹éš†ä¸é“¾æ¥å…‹éš†çš„è§£é‡Š</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_197336118a437919c95a1c428c7843e3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_197336118a437919c95a1c428c7843e3.png"></p><h3 id="1-KVMå®Œæ•´å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰"><a href="#1-KVMå®Œæ•´å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰" class="headerlink" title="1. KVMå®Œæ•´å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰"></a><code>1.</code> KVMå®Œæ•´å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰</h3><p><strong>æ ¼å¼:  virt-clone â€“auto-c1one -o  è™šæ‹Ÿæœºåç§° -n  å…‹éš†åç§°</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">virt-clone --auto-clone -o  web01 -n  web01-clone</span><br><span class="line">virsh list --all</span><br></pre></td></tr></table></figure><p><strong>virt-clone è¿™ä¸ªå‘½ä»¤æ˜¯åŸºäºå…¨å…‹éš†çš„ï¼Œä¹Ÿå°±æ˜¯æ‹·è´è™šæ‹Ÿç£ç›˜æ–‡ä»¶å’Œè™šæ‹Ÿé…ç½®æ–‡ä»¶æ¥å®ç°çš„å®Œæ•´å…‹éš†ï¼Œé€Ÿåº¦æ…¢ï¼Œå ç”¨ç©ºé—´å¤šï¼Œå…‹éš†åç£ç›˜æ–‡ä»¶ä½äºè™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶å­˜æ”¾å¤„ å…‹éš†åè™šæ‹Ÿæœºé…ç½®æ–‡ä»¶ä½äº /etc/libvirt/qemu ã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_fba87f13fbf52ded0499e19cf7ba2d85.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_fba87f13fbf52ded0499e19cf7ba2d85.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ff39c0b60324fd6b2061dee1d709a4fc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ff39c0b60324fd6b2061dee1d709a4fc.png"></p><p><strong>éªŒè¯å…‹éš†åçš„è™šæ‹Ÿæœº (æˆåŠŸ)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨å…‹éš†åçš„è™šæ‹Ÿæœº </span></span><br><span class="line">virsh start web01-clone</span><br><span class="line"><span class="comment"># å…‹éš†åçš„è™šæ‹Ÿæœºå’Œè™šæ‹Ÿæœºæ˜¯ä¸€æ ·çš„æ‰€ä»¥å¯ä»¥é€šè¿‡consoleç™»å½•</span></span><br><span class="line">virsh console web01-clone</span><br></pre></td></tr></table></figure><p><strong>æ­¤æ—¶å¯ä»¥çœ‹åˆ°IPåœ°å€æ˜¯ä¸ä¸€æ ·çš„ å…‹éš†ä»¥åæˆ‘ä»¬ä¸éœ€è¦å»æ‰‹åŠ¨æ›´æ”¹åˆ«çš„ä¾‹å¦‚IPç­‰é…ç½®</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d5eebd88967b1ae72a00a4a5dc1dbf82.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d5eebd88967b1ae72a00a4a5dc1dbf82.png"></p><h3 id="1-KVMé“¾æ¥å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰"><a href="#1-KVMé“¾æ¥å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰" class="headerlink" title="1. KVMé“¾æ¥å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰"></a><code>1.</code> KVMé“¾æ¥å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰</h3><p>kvmå¹¶æ²¡æœ‰æä¾›é“¾æ¥å…‹éš†çš„å‘½ä»¤æˆ–å·¥å…·ï¼Œåªèƒ½æ‰‹åŠ¨å®ç°ï¼Œå®ç°æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªç£ç›˜é“¾æ¥æ–‡ä»¶æ¥å®ç°çš„é“¾æ¥å…‹éš†ã€‚<strong>æ ¼å¼:  qemu-img create -f qcow2 -b æºç£ç›˜æ–‡ä»¶  é“¾æ¥ç£ç›˜æ–‡ä»¶ ï¼ˆç£ç›˜æ ¼å¼éœ€è¦ä¿æŒä¸€è‡´ï¼‰</strong></p><ul><li><strong>-f æŒ‡å®šç£ç›˜æ–‡ä»¶æ ¼å¼</strong></li><li><strong>-b æŒ‡å®šåŸºäºæºç£ç›˜æ–‡ä»¶åˆ›å»ºä¸€ä¸ªé“¾æ¥ç£ç›˜æ–‡ä»¶</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºé“¾æ¥å…‹éš†ï¼ˆæ­¤æ—¶å…‰æœ‰ç£ç›˜æ–‡ä»¶æˆ‘ä»¬æ— æ³•åŸºäºè¿™ä¸ªç£ç›˜æ–‡ä»¶å»åˆ›å»ºè™šæ‹Ÿæœº è¿˜å¾—ä¿®æ”¹ç£ç›˜æ–‡ä»¶é…ç½®ï¼‰</span></span><br><span class="line">qemu-img create -f qcow2 -b /kvm/web02-vda.qcow2 /kvm/web02-1ink-clone-1.qcow2</span><br><span class="line"><span class="comment"># æŸ¥çœ‹é“¾æ¥ç£ç›˜æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line">qemu-img info /kvm/web02-1ink-clone-1.qcow2</span><br></pre></td></tr></table></figure><p>backing file: /kvm/web02-vda.qcow2 ï¼ˆæºç£ç›˜æ–‡ä»¶ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å‡ºåŸå§‹æœºçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹ç£ç›˜æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">virsh dumpxml web02 &gt; web02-link-clone-1.xml</span><br><span class="line"><span class="comment"># éœ€è¦ä¿®æ”¹çš„å†…å®¹å¦‚ä¸‹</span></span><br><span class="line">vim web02-link-clone-1.xml</span><br><span class="line">...</span><br><span class="line"><span class="comment"># ä¿®æ”¹è™šæ‹Ÿæœºåç§°(ä¿®æ”¹ä¸ºå…‹éš†åçš„æœºå™¨çš„åç§°)</span></span><br><span class="line">ç”± &lt;name&gt;web02&lt;/name&gt; æ”¹ &lt;name&gt;web02-link-clone&lt;/name&gt;</span><br><span class="line"><span class="comment"># åˆ é™¤uuidï¼ˆåˆ æ‰ä»¥åå¯åŠ¨æ˜¯ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ï¼‰</span></span><br><span class="line">&lt;uuid&gt;0fb934c1-5232-410f-b290-97604f22307e&lt;/uuid&gt;</span><br><span class="line"><span class="comment"># ä¿®æ”¹ç£ç›˜æ–‡ä»¶è·¯å¾„åŠåç§°</span></span><br><span class="line">ç”± &lt;<span class="built_in">source</span> file=<span class="string">&#x27;/kvm/web02-vda.qcow2&#x27;</span>/&gt; æ”¹ &lt;<span class="built_in">source</span> file=<span class="string">&#x27;/kvm/web02-1ink-clone-1.qcow2&#x27;</span>/&gt;</span><br><span class="line"><span class="comment"># åˆ é™¤macåœ°å€ï¼ˆåˆ æ‰ä»¥åå¯åŠ¨æ˜¯ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ï¼‰</span></span><br><span class="line">&lt;mac address=<span class="string">&#x27;52:54:00:fb:cb:a4&#x27;</span>/&gt;</span><br><span class="line">...</span><br><span class="line">ä¿å­˜ï¼</span><br><span class="line"><span class="comment"># å¯¼å…¥è™šæ‹Ÿæœº</span></span><br><span class="line">virsh define web02-link-clone-1.xml</span><br><span class="line">virsh list</span><br><span class="line"><span class="comment"># å¼€å¯è™šæ‹Ÿæœº</span></span><br><span class="line">virsh start web02-link-clone</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_523d5dd801e9c7ce92e49bc0d6fb1264.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_523d5dd801e9c7ce92e49bc0d6fb1264.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_906abec6cee86807f80f23a43c6ad276.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_906abec6cee86807f80f23a43c6ad276.png"></p><h2 id="ä¸ƒ-KVMè™šæ‹Ÿæœºç½‘ç»œé…ç½®"><a href="#ä¸ƒ-KVMè™šæ‹Ÿæœºç½‘ç»œé…ç½®" class="headerlink" title="ä¸ƒ. KVMè™šæ‹Ÿæœºç½‘ç»œé…ç½®"></a>ä¸ƒ. KVMè™šæ‹Ÿæœºç½‘ç»œé…ç½®</h2><p><strong>kvmè™šæ‹Ÿæœºç½‘ç»œä»‹ç»</strong></p><p><strong>libvirt</strong> æœåŠ¡å®‰è£…åï¼Œé»˜è®¤ä¼šå®‰è£…ä¸€å— <strong>virbr0</strong> çš„è™šæ‹Ÿç½‘å¡ï¼Œlibvirt åœ¨åˆ›å»º KVM è™šæ‹Ÿæœºåï¼Œé»˜è®¤ä½¿ç”¨äº†ä¸€ä¸ªåä¸ºdefaultçš„natç½‘ç»œï¼Œåœ°å€æ®µä¸º 192.168.122.0/24ï¼Œè¿™ä¸ªç½‘ç»œé»˜è®¤ä½¿ç”¨virbr0(è™šæ‹Ÿäº¤æ¢æœº)ä½œä¸ºæ¡¥æ¥æ¥å£ï¼Œä¸ºè™šæ‹Ÿæœºæä¾›ç½‘ç»œè½¬å‘æœåŠ¡ï¼Œé»˜è®¤ç½‘æ®µ 192.168.122.0/24ï¼Œä½¿ç”¨dnsmasq æ¥ä¸ºä½¿ç”¨ nat ç½‘ç»œçš„è™šæ‹Ÿæœºæä¾› dns åŠ dhcp æœåŠ¡ã€‚</p><p><strong>virbr0ç½‘å¡ é»˜è®¤å ç”¨.1è¿™ä¸ªåœ°å€è™šæ‹Ÿæœºåœ°å€ä» .2 å¼€å§‹é…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">virbr0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line"> Â   <span class="built_in">link</span>/ether 52:54:00:28:9c:13 brd ff:ff:ff:ff:ff:ff</span><br><span class="line"> Â   inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0</span><br><span class="line"> Â  Â  Â  valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><p><strong>dhcpåˆ†é…åˆ°è™šæ‹Ÿæœºçš„ipåˆ—è¡¨åœ¨ä»¥ä¸‹æ–‡ä»¶æŸ¥çœ‹: /var/lib/libvirt/dnsmasq/default.conf ï¼ˆIPåœ°å€æ®µå¯ä»¥ä½¿ç”¨ï¼Œé»˜è®¤çš„ä¹Ÿå¯ä»¥è‡ªè¡Œä¿®æ”¹ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dhcpåˆ†é…åˆ°è™šæ‹Ÿæœºçš„ipåˆ—è¡¨</span></span><br><span class="line"><span class="built_in">cat</span>  /var/lib/libvirt/dnsmasq/default.conf</span><br><span class="line">...</span><br><span class="line"><span class="comment">##WARNING:  THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE</span></span><br><span class="line"><span class="comment">##OVERWRITTEN AND LOST.  Changes to this configuration should be made using:</span></span><br><span class="line"><span class="comment">## Â   virsh net-edit default</span></span><br><span class="line"><span class="comment">## or other application using the libvirt API.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## dnsmasq conf file created by libvirt</span></span><br><span class="line">strict-order</span><br><span class="line">pid-file=/var/run/libvirt/network/default.pid</span><br><span class="line">except-interface=lo</span><br><span class="line">bind-dynamic</span><br><span class="line">interface=virbr0 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># kvmè™šæ‹Ÿæœºä½¿ç”¨çš„ç½‘å¡</span></span><br><span class="line">dhcp-range=192.168.122.2,192.168.122.254 Â <span class="comment"># dhcpåˆ†é…çš„åœ°å€æ®µ</span></span><br><span class="line">dhcp-no-override</span><br><span class="line">dhcp-authoritative</span><br><span class="line">dhcp-lease-max=253</span><br><span class="line">dhcp-hostsfile=/var/lib/libvirt/dnsmasq/default.hostsfile</span><br><span class="line">addn-hosts=/var/lib/libvirt/dnsmasq/default.addnhosts</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="1-kvmè™šæ‹Ÿæœºnatç½‘ç»œé…ç½®"><a href="#1-kvmè™šæ‹Ÿæœºnatç½‘ç»œé…ç½®" class="headerlink" title="1.kvmè™šæ‹Ÿæœºnatç½‘ç»œé…ç½®"></a><code>1.</code>kvmè™šæ‹Ÿæœºnatç½‘ç»œé…ç½®</h3><p><strong>ä¿®æ”¹virbr0åœ°å€æ®µ</strong></p><p><strong>å¯ä»¥ä¿®æ”¹ç½‘æ®µï¼Œä¹Ÿå¯ä»¥ç”¨é»˜è®¤ç½‘æ®µï¼Œå¦‚éœ€ä¿®æ”¹é€šè¿‡å¦‚ä¸‹æ–¹å¼:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹åœ°å€æ®µ (macåœ°å€ä¸æ›´æ”¹ ä¿®æ”¹å¦‚ä¸‹ä¸¤æ®µå³å¯)</span></span><br><span class="line">virsh net-edit default</span><br><span class="line">åŸ</span><br><span class="line">...</span><br><span class="line">  &lt;ip address=<span class="string">&#x27;192.168.122.1&#x27;</span> netmask=<span class="string">&#x27;255.255.255.0&#x27;</span>&gt;</span><br><span class="line"> Â   &lt;dhcp&gt;</span><br><span class="line"> Â  Â   &lt;range start=<span class="string">&#x27;192.168.122.2&#x27;</span> end=<span class="string">&#x27;192.168.122.254&#x27;</span>/&gt;</span><br><span class="line">...</span><br><span class="line">ä¿®æ”¹ä¸º10åœ°å€æ®µ</span><br><span class="line">...</span><br><span class="line">  &lt;ip address=<span class="string">&#x27;192.168.10.1&#x27;</span> netmask=<span class="string">&#x27;255.255.255.0&#x27;</span>&gt;</span><br><span class="line"> Â   &lt;dhcp&gt;</span><br><span class="line"> Â  Â   &lt;range start=<span class="string">&#x27;192.168.10.2&#x27;</span> end=<span class="string">&#x27;192.168.10.254&#x27;</span>/&gt;</span><br><span class="line">...</span><br><span class="line"><span class="comment"># ä¿å­˜</span></span><br></pre></td></tr></table></figure><p><strong>é‡æ–°å®šä¹‰ç½‘ç»œï¼Œdefaultç½‘ç»œçš„é…ç½®æ–‡ä»¶: /etc/libvirt/qemu/networks/default.xml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨æ­¤å‘½ä»¤é‡æ–°å®šä¹‰é…ç½®æ–‡ä»¶ (åˆ·æ–°)</span></span><br><span class="line">virsh net-define /etc/libvirt/qemu/networks/default.xml</span><br><span class="line">//è¿”å›</span><br><span class="line">Network default defined from /etc/libvirt/qemu/networks/default.xml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">cat</span> /etc/libvirt/qemu/networks/default.xml</span><br><span class="line">...</span><br><span class="line">  &lt;ip address=<span class="string">&#x27;192.168.10.1&#x27;</span> netmask=<span class="string">&#x27;255.255.255.0&#x27;</span>&gt;</span><br><span class="line"> Â   &lt;dhcp&gt;</span><br><span class="line"> Â  Â   &lt;range start=<span class="string">&#x27;192.168.10.2&#x27;</span> end=<span class="string">&#x27;192.168.10.254&#x27;</span>/&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤ç½‘ç»œï¼ˆå…³é—­è¿è¡Œçš„è™šæ‹Ÿæœºï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢ç½‘å¡ï¼ˆå…³é—­è¿è¡Œçš„è™šæ‹Ÿæœºï¼‰</span></span><br><span class="line">virsh net-destroy default</span><br><span class="line"><span class="comment"># å…³é—­æ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºï¼ˆå¯ä¸å…³ï¼‰</span></span><br><span class="line">virsh shutdown web02</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨ç½‘å¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ç½‘å¡</span></span><br><span class="line">virsh net-start default</span><br></pre></td></tr></table></figure><p><strong>é‡å¯libvirtd</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡å¯libvirtd</span></span><br><span class="line">systemctl restart libvirtd</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¿ä¸»æœºæ‰§è¡Œ</span></span><br><span class="line">ip a s</span><br><span class="line"><span class="comment"># éªŒè¯è™šæ‹Ÿæœºç½‘ç»œ æ­¤æ—¶è™šæ‹Ÿæœºç½‘ç»œå·²å˜æˆäº†10æ®µ</span></span><br><span class="line">virsh console web01</span><br><span class="line"><span class="comment"># è·å–IP</span></span><br><span class="line">dhclient</span><br><span class="line">// è¿”å›</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line"> Â   <span class="built_in">link</span>/ether 52:54:00:00:75:bf brd ff:ff:ff:ff:ff:ff</span><br><span class="line"> Â   inet 192.168.10.39/24 brd 192.168.10.255 scope global dynamic eth0</span><br><span class="line"> Â  Â  Â  valid_lft 3599sec preferred_lft 3599sec</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_257b8884805c43a286817995dfdf648e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_257b8884805c43a286817995dfdf648e.png"></p><p>ä»ç°åœ¨å¼€å§‹ä½¿ç”¨çš„ <strong>default</strong> ç½‘ç»œå°±æ˜¯ <strong>10</strong> æ®µäº†</p><h3 id="2-kvm-è™šæ‹Ÿæœºé…ç½®å›ºå®š-IP"><a href="#2-kvm-è™šæ‹Ÿæœºé…ç½®å›ºå®š-IP" class="headerlink" title="2.kvm è™šæ‹Ÿæœºé…ç½®å›ºå®š IP"></a><code>2.</code>kvm è™šæ‹Ÿæœºé…ç½®å›ºå®š IP</h3><p><strong>å¯åŠ¨ä¸€ä¸ªKVMå¹¶ç™»å½•å¹¶é…ç½®å›ºå®šIPåœ°å€</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">virsh start web02</span><br><span class="line">virsh console web02</span><br><span class="line">ip a s</span><br></pre></td></tr></table></figure><p><strong>kvm é…ç½®å›ºå®š IP åœ°å€ï¼ˆä¸ä¼ ç»Ÿç‰©ç†æœºä¸€æ ·ä¿®æ”¹ç½‘å¡é…ç½®æ–‡ä»¶å°±å¯ä»¥äº†ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none Â  Â <span class="comment"># å°†é»˜è®¤çš„dhcpä¿®æ”¹ä¸ºnone</span></span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=eth0</span><br><span class="line">UUID=0d71e612-7fca-4663-914e-9c9f356d0d82</span><br><span class="line">DEVICE=eth0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span> Â  Â  Â  <span class="comment"># ä¿®æ”¹ä¸ºyes</span></span><br><span class="line"><span class="comment"># æ–°å¢</span></span><br><span class="line">IPADDR=<span class="string">&quot;192.168.10.10&quot;</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span><br><span class="line">GATEWAY=<span class="string">&quot;192.168.10.1&quot;</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><br><span class="line">NETMASK=<span class="string">&quot;255.255.255.0&quot;</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span><br><span class="line">DNS1=<span class="string">&quot;223.5.5.5&quot;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åé‡å¯ç½‘å¡ç”Ÿæ•ˆï¼š<strong>systemctl restart network</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_8ff6fe32b5abd9443531f7335d7b120f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_8ff6fe32b5abd9443531f7335d7b120f.png"></p><p>**æç¤º:  **<strong>KVM</strong> è™šæ‹Ÿæœºè®¿é—®å¤–éƒ¨ç½‘ç»œè®°ä½ <a href="https://wn-apple-teawine.fun/2023/06/02/%E9%85%8D%E7%BD%AEsnat%E4%BD%BF%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AEinternet%E7%9A%84%E5%86%85%E7%BD%91%E6%9C%BA%E5%99%A8%E9%80%9A%E8%BF%87%E5%85%B6%E4%BB%96%E6%9C%BA%E5%99%A8%E5%87%BA%E5%A4%96%E7%BD%91/?highlight=snat">iptables SNAT</a> æ¨¡å¼è¿›è¡Œäº†æºåœ°å€è½¬æ¢ï¼Œå¦‚æœå¤–éƒ¨ç½‘ç»œéœ€è¦è®¿é—®åˆ° <strong>KVM</strong> è™šæ‹Ÿæœºä¸­ï¼Œéœ€è¦åœ¨å®¿ä¸»æœºé€šè¿‡ <strong>iptables</strong> æ·»åŠ ç«¯å£æ˜ å°„æ¥å®ç°ï¼Œå¦‚æœä¸å¸Œæœ›é€šè¿‡ç«¯å£æ˜ å°„æ¥å®ç°ï¼Œå¯ä»¥ä½¿ç”¨ <strong>KVMçš„æ¡¥æ¥ç½‘ç»œ</strong> æ›´åŠ æ–¹ä¾¿ã€‚</p><h2 id="ä¹-kvm-åˆ›å»ºæ¡¥æ¥ç½‘ç»œ"><a href="#ä¹-kvm-åˆ›å»ºæ¡¥æ¥ç½‘ç»œ" class="headerlink" title="ä¹. kvm åˆ›å»ºæ¡¥æ¥ç½‘ç»œ"></a>ä¹. kvm åˆ›å»ºæ¡¥æ¥ç½‘ç»œ</h2><p><strong>åœ¨KVMè™šæ‹Ÿæœºä¸­ï¼ŒBridge(æ¡¥æ¥)æ¨¡å¼å¯ä»¥è®© KVM è™šæ‹Ÿæœºå’Œå®¿ä¸»æœºå…±äº«ä¸€ä¸ªç‰©ç†ç½‘ç»œè®¾å¤‡æ¥è¿æ¥ç½‘ç»œï¼Œè¿™æ · KVM è™šæ‹Ÿæœºå¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œè€Œå¤–éƒ¨ç½‘ç»œä¹Ÿå¯ä»¥ç›´æ¥è®¿é—® KVM è™šæ‹Ÿæœºï¼ŒBridgeæ¡¥æ¥æ¨¡å¼ä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼Œåº”ç”¨ä¹Ÿéå¸¸å¹¿æ³›ã€‚</strong></p><p><strong>åˆ›å»ºæ¡¥æ¥ç½‘å¡ï¼ˆæ‰§è¡Œåˆ›å»ºåéœ€è¦é‡å¯ç³»ç»Ÿæ‰èƒ½çœ‹åˆ°ï¼‰</strong> å°†å®¿ä¸»æœºå·¥ä½œçš„ç½‘å¡ç»‘å®šåˆ° br0 æ¡¥æ¥ç½‘å¡ä¸Š (br0ç°åœ¨ä¸å­˜åœ¨)</p><ul><li><strong>æ ¼å¼: virsh iface-bridge ens32 br0</strong></li><li><strong>ens33 ä¸ºå®¿ä¸»æœºç½‘å¡</strong></li><li><strong>br0 ä¸ºæ¡¥æ¥ç½‘å¡</strong></li></ul><h3 id="1-åˆ›å»ºæ¡¥æ¥ç½‘å¡"><a href="#1-åˆ›å»ºæ¡¥æ¥ç½‘å¡" class="headerlink" title="1.åˆ›å»ºæ¡¥æ¥ç½‘å¡"></a><code>1.</code>åˆ›å»ºæ¡¥æ¥ç½‘å¡</h3><blockquote><p><a href="http://sunlight.zznnwn.cloudns.biz/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/?highlight=%E9%95%9C%E5%83%8F">å®ç°å½¢å¼å…¶å®åœ¨åšä¸»å¦ä¸€ç¯‡æ–‡ç« ä¸­å·²æœ‰æåŠ | &gt; é“¾æ¥</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†å®¿ä¸»æœºå·¥ä½œçš„ç½‘å¡ç»‘å®šåˆ° br0 æ¡¥æ¥ç½‘å¡</span></span><br><span class="line">virsh iface-bridge ens33 br0</span><br><span class="line">//è¿”å›</span><br><span class="line">ä½¿ç”¨é™„åŠ è®¾å¤‡ br0 ç”Ÿæˆæ¡¥æ¥ ens32 å¤±è´¥</span><br><span class="line"><span class="comment"># é‡å¯ç³»ç»Ÿåç™»å½•æŸ¥çœ‹ç½‘å¡</span></span><br><span class="line">ip a s </span><br><span class="line">...</span><br><span class="line">ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master br0 state UP group default qlen 1000</span><br><span class="line"> Â   <span class="built_in">link</span>/ether 00:0c:29:23:67:1e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">3: br0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line"> Â   <span class="built_in">link</span>/ether 00:0c:29:23:67:1e brd ff:ff:ff:ff:ff:ff</span><br><span class="line"> Â   inet 10.0.0.10/8 brd 10.255.255.255 scope global br0</span><br><span class="line">...</span><br><span class="line"><span class="comment"># æ­¤æ—¶pingä¸é€šç™¾åº¦</span></span><br><span class="line">ping www.baidu.com</span><br><span class="line"><span class="comment"># è§£å†³ç½‘å¡æ·»åŠ DNSå³å¯</span></span><br><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-br0</span><br><span class="line">...</span><br><span class="line">DEVICE=<span class="string">&quot;br0&quot;</span></span><br><span class="line">ONBOOT=<span class="string">&quot;yes&quot;</span></span><br><span class="line">TYPE=<span class="string">&quot;Bridge&quot;</span></span><br><span class="line">BOOTPROTO=<span class="string">&quot;none&quot;</span></span><br><span class="line">IPADDR=<span class="string">&quot;10.0.0.10&quot;</span></span><br><span class="line">GATEWAY=<span class="string">&quot;10.0.0.220&quot;</span></span><br><span class="line">IPV6INIT=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_AUTOCONF=<span class="string">&quot;yes&quot;</span></span><br><span class="line">DHCPV6C=<span class="string">&quot;no&quot;</span></span><br><span class="line">STP=<span class="string">&quot;on&quot;</span></span><br><span class="line">DELAY=<span class="string">&quot;0&quot;</span></span><br><span class="line">DNS1=<span class="string">&quot;223.5.5.5&quot;</span> Â <span class="comment"># æ·»åŠ æ­¤</span></span><br><span class="line">....</span><br><span class="line"><span class="comment"># ç”Ÿæ•ˆ</span></span><br><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure><p><strong>å¤‡æ³¨ï¼šæ­¤æ—¶å®¿ä¸»æœº ens33 ç½‘å¡æ²¡æœ‰è‡ªå·±çš„ IP åœ°å€ï¼Œç½‘å¡å¯„ç”Ÿåœ¨å®ƒèº«ä¸Šï¼Œç½‘æ¡¥ä¸ç‰©ç†ç½‘å£ MAC åœ°å€ç›¸åŒ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_9376b88c60933a7b09a87ec71a768aff.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_9376b88c60933a7b09a87ec71a768aff.png"></p><h2 id="å-åˆ›å»º-kvm-è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘ç»œ"><a href="#å-åˆ›å»º-kvm-è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘ç»œ" class="headerlink" title="å. åˆ›å»º kvm è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘ç»œ"></a>å. åˆ›å»º <code>kvm</code> è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘ç»œ</h2><p><strong>åˆ›å»º kvm è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘å¡ï¼ˆå®‰è£…å®Œæˆç³»ç»Ÿï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º kvm è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘å¡</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web03 \</span><br><span class="line">--memory 1024 \</span><br><span class="line">--vcpus 1 --disk /kvm/web03-vda.qcow2,format=qcow2,size=10 --cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso \</span><br><span class="line">--network bridge=br0 --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br><span class="line"><span class="comment"># æŸ¥çœ‹åˆ—è¡¨</span></span><br><span class="line">virsh list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹vncç«¯å£ï¼ˆ5902ï¼‰</span></span><br><span class="line">virsh vncdisplay web03</span><br><span class="line">:2</span><br></pre></td></tr></table></figure><p><strong>é…ç½®é™æ€åœ°å€ åœ°å€ä¸ºä¸å®¿ä¸»æœºåŒä¸€ä¸ªç½‘æ®µ ä¸”æ²¡æœ‰è¢«å ç”¨çš„ç½‘æ®µ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_288e666dc41e472b5b532cc4fd38d635.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_288e666dc41e472b5b532cc4fd38d635.png"></p><p><strong>éªŒè¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç­‰å¾…ç›¸å½“ä¸€æ®µæ—¶é—´</span></span><br><span class="line">virsh start web03</span><br><span class="line"><span class="comment"># æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">virsh list</span><br><span class="line"><span class="comment"># è¿œç¨‹è¿æ¥æµ‹è¯•ï¼ˆå¯è¿é€šå¤–ç½‘æ­£å¸¸pingé€šç™¾åº¦ï¼‰</span></span><br><span class="line">ssh -p22 root@10.0.0.185</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ccce45df3c03202f8b55bc31adb1b817.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ccce45df3c03202f8b55bc31adb1b817.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_52de4dfd8d24e6c18177342d745e60f6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_52de4dfd8d24e6c18177342d745e60f6.png"></p><h2 id="åä¸€-ä¿®æ”¹kvmè™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼"><a href="#åä¸€-ä¿®æ”¹kvmè™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼" class="headerlink" title="åä¸€. ä¿®æ”¹kvmè™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼"></a>åä¸€. ä¿®æ”¹<code>kvm</code>è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">virsh list</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹è™šæ‹Ÿæœºç½‘å¡ä¿¡æ¯</strong> <strong>æ ¼å¼: virsh  domiflist è™šæ‹Ÿæœºåç§°</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è™šæ‹Ÿæœºweb03ç½‘å¡</span></span><br><span class="line">virsh domiflist web03</span><br><span class="line">//è¿”å›</span><br><span class="line">Interface  Type Â  Â  Â  Source Â  Â  Model Â  Â  Â  MAC</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">vnet0 Â  Â   bridge Â  Â  br0 Â  Â  Â   virtio Â  Â  Â 52:54:00:68:3e:8d</span><br></pre></td></tr></table></figure><p><strong>å…³æœºçŠ¶æ€ä¸‹</strong> ä¿®æ”¹ç½‘ç»œæ¨¡å¼ä¸º <strong>bridge</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹è™šæ‹Ÿæœºé…ç½®</span></span><br><span class="line">virsh edit web02</span><br><span class="line"></span><br><span class="line">åŸ &lt;interface <span class="built_in">type</span>=<span class="string">&#x27;network&#x27;</span>&gt;  æ”¹ &lt;interface <span class="built_in">type</span>=<span class="string">&#x27;bridge&#x27;</span>&gt; Â <span class="comment"># ä¿®æ”¹ç±»å‹</span></span><br><span class="line">åŸ &lt;<span class="built_in">source</span> network=<span class="string">&#x27;default&#x27;</span>/&gt; æ”¹ &lt;<span class="built_in">source</span> bridge=<span class="string">&#x27;br0&#x27;</span>/&gt; Â  Â  <span class="comment"># ç½‘å¡åç§°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨è™šæ‹ŸæœºéªŒè¯</span></span><br><span class="line">virsh start web02</span><br><span class="line"><span class="comment"># é€šè¿‡vnc/consoleç™»å½•é…ç½®é™æ€IP</span></span><br><span class="line">virsh vncdisplay web02 æˆ– virsh console web02</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4f21ccb77b8d5dd6719b7488e808320c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4f21ccb77b8d5dd6719b7488e808320c.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0e88cdc4e62769bb5458975545f4269e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0e88cdc4e62769bb5458975545f4269e.png"></p><p>é…ç½®å®Œæˆå <strong>ssh</strong> è¿œç¨‹è¿æ¥æµ‹è¯• &gt;&gt; æˆåŠŸã€‚</p><h2 id="åäºŒ-kvmç½‘ç»œåŸç†"><a href="#åäºŒ-kvmç½‘ç»œåŸç†" class="headerlink" title="åäºŒ. kvmç½‘ç»œåŸç†"></a>åäºŒ. <code>kvm</code>ç½‘ç»œåŸç†</h2><p>æ¯å° <strong>KVM</strong> å¯åŠ¨åï¼Œéƒ½ä¼šåœ¨ <strong>å®¿ä¸»æœº</strong> åˆ›å»ºä¸€ä¸ªä»¥ <strong>vnet</strong> å¼€å¤´çš„ç½‘å¡(ä» <strong>vnet0</strong> å¼€å§‹)ï¼Œç”¨äºæ‰“é€š <strong>è™šæ‹Ÿæœº</strong> ä¸ <strong>å®¿ä¸»æœº</strong> ä¹‹é—´çš„ç½‘ç»œã€‚</p><h3 id="0-ç½‘ç»œæ¨¡å¼æ‹–å¸ƒå›¾"><a href="#0-ç½‘ç»œæ¨¡å¼æ‹–å¸ƒå›¾" class="headerlink" title="0.ç½‘ç»œæ¨¡å¼æ‹–å¸ƒå›¾"></a><code>0.</code>ç½‘ç»œæ¨¡å¼æ‹–å¸ƒå›¾</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_502c79bc51c37605ad93625e7c73b987.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_502c79bc51c37605ad93625e7c73b987.png"></p><h3 id="1-å®¿ä¸»æœºç½‘å¡é…ç½®"><a href="#1-å®¿ä¸»æœºç½‘å¡é…ç½®" class="headerlink" title="1.å®¿ä¸»æœºç½‘å¡é…ç½®"></a><code>1.</code>å®¿ä¸»æœºç½‘å¡é…ç½®</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7e62f395165b9a771a1f429a170a2cc0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7e62f395165b9a771a1f429a170a2cc0.png"></p><p>é€šè¿‡ <strong>brctl show</strong> å¯ä»¥çœ‹åˆ° <strong>vnet</strong> ç½‘å¡ä½¿ç”¨çš„å®¿ä¸»æœºç½‘å¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm ~]# brctl show</span><br><span class="line">bridge name Â  Â  bridge id Â  Â  Â  Â  Â  Â  Â  STP enabled Â  Â  interfaces</span><br><span class="line">br0 Â  Â  Â  Â  Â  Â  8000.000c2923671e Â  Â  Â  yes Â  Â  Â  Â  Â  Â  ens33</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   vnet0</span><br><span class="line">virbr0 Â  Â  Â  Â  Â 8000.525400289c13 Â  Â  Â  yes Â  Â  Â  Â  Â  Â  virbr0-nic</span><br></pre></td></tr></table></figure><h2 id="åä¸‰-kvmè™šæ‹Ÿæœºç¡¬ä»¶çƒ­æ·»åŠ æŠ€æœ¯"><a href="#åä¸‰-kvmè™šæ‹Ÿæœºç¡¬ä»¶çƒ­æ·»åŠ æŠ€æœ¯" class="headerlink" title="åä¸‰.  kvmè™šæ‹Ÿæœºç¡¬ä»¶çƒ­æ·»åŠ æŠ€æœ¯"></a>åä¸‰.  kvmè™šæ‹Ÿæœºç¡¬ä»¶çƒ­æ·»åŠ æŠ€æœ¯</h2><h3 id="1-çƒ­æ·»åŠ ç£ç›˜"><a href="#1-çƒ­æ·»åŠ ç£ç›˜" class="headerlink" title="1.çƒ­æ·»åŠ ç£ç›˜"></a><code>1.</code>çƒ­æ·»åŠ ç£ç›˜</h3><p><strong>æ¡ˆä¾‹: ä¸º web03 è™šæ‹Ÿæœºæ·»åŠ ä¸€å—æ–° qcow2 ç¡¬ç›˜ï¼Œå¹¶å¯¹ç¡¬ç›˜ç©ºé—´è¿›è¡Œæ‰©å®¹ (KVMè™šæ‹Ÿæœºé»˜è®¤ç£ç›˜åç§°: vdaã€vdbã€vdcä¾æ¬¡ç±»æ¨ï¼Œå¯è¿›å…¥KVMå†…éƒ¨æŸ¥çœ‹)</strong></p><p><strong>æ·»åŠ ä¹‹å‰ (åªæœ‰ä¸€å—10Gçš„ç¡¬ç›˜)</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@web03 ~]# lsblk</span><br><span class="line">NAME Â  Â  Â  Â  Â  Â  Â  Â   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sr0 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 11:0 Â  Â 1 1024M Â 0 rom Â </span><br><span class="line">vda Â  Â  Â  Â  Â  Â  Â  Â  Â  252:0 Â  Â 0 Â  10G Â 0 disk </span><br><span class="line">â”œâ”€vda1 Â  Â  Â  Â  Â  Â  Â  Â 252:1 Â  Â 0 Â   1G Â 0 part /boot</span><br><span class="line">â””â”€vda2 Â  Â  Â  Â  Â  Â  Â  Â 252:2 Â  Â 0 Â   9G Â 0 part </span><br><span class="line">  â”œâ”€centos_web03-root 253:0 Â  Â 0 Â   8G Â 0 lvm  /</span><br><span class="line">  â””â”€centos_web03-swap 253:1 Â  Â 0 Â   1G Â 0 lvm  [SWAP]</span><br></pre></td></tr></table></figure><p><strong>åœ¨ kvm ç›®å½•åˆ›å»ºä¸€å— qcow2 æ ¼å¼çš„è™šæ‹Ÿç¡¬ç›˜ï¼Œå®¹é‡ä¸º 10G</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºä¸€å—qcow2æ ¼å¼çš„è™šæ‹Ÿç¡¬ç›˜ï¼Œå®¹é‡ä¸º10G</span></span><br><span class="line">cd /kvm</span><br><span class="line">qemu-img create -f qcow2 /kvm/web03-vdb.qcow2 10G</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ç£ç›˜è¯¦æƒ…</span></span><br><span class="line">qemu-img info /kvm/web03-vdb.qcow2</span><br><span class="line">//è¿”å›</span><br><span class="line">image: /kvm/web03-vdb.qcow2</span><br><span class="line">file format: qcow2</span><br><span class="line">virtual size: 10G (10737418240 bytes)</span><br></pre></td></tr></table></figure><p><strong>æ°¸ä¹…æ·»åŠ ç£ç›˜</strong></p><ul><li><strong>â€“live            åœ¨çº¿æ·»åŠ </strong></li><li><strong>â€“config        æ°¸ä¹…ä¿å­˜é…ç½® ï¼ˆä¸åŠ ä¸´æ—¶ç”Ÿæ•ˆ è™šæ‹Ÿæœºä¸€é‡å¯å°±æ²¡äº†ï¼‰</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ°¸ä¹…æ·»åŠ ç£ç›˜ï¼ˆç»™web03 æ·»åŠ 10Gç£ç›˜ æŒ‡å®šæ·»åŠ åè™šæ‹Ÿæœºç£ç›˜åç§°ä¸º vdb æ ¼å¼ä¸º qcow2 æ ¼å¼ï¼‰</span></span><br><span class="line">virsh attach-disk web03 /kvm/web03-vdb.qcow2 vdb --subdriver qcow2 --live --config</span><br><span class="line">//è¿”å›</span><br><span class="line">Disk attached successfully</span><br></pre></td></tr></table></figure><p><strong>web03è™šæ‹ŸæœºéªŒè¯</strong>ï¼ˆæˆåŠŸæ·»åŠ ä¸€å—10G vdbç£ç›˜ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç™»å½•è™šæ‹Ÿæœº</span></span><br><span class="line">virsh console web03</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ç£ç›˜è¯¦æƒ…</span></span><br><span class="line">lsblk</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ ¼å¼åŒ–æŒ‚è½½éªŒè¯ä½¿ç”¨(æ­£å¸¸ä½¿ç”¨)</span></span><br><span class="line">mkfs.xfs /dev/vdb /mnt</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_df1d528276047646321dc497bb964d7c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_df1d528276047646321dc497bb964d7c.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_98ea2a719d22c44088b0687abc0ff47e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_98ea2a719d22c44088b0687abc0ff47e.png"></p><p><strong>æ°¸ä¹…å‰¥ç¦» (éœ€è¦æå‰å¸è½½)</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è™šæ‹Ÿæœºå…ˆå¸è½½ç£ç›˜</span></span><br><span class="line">umonut /dev/vdb</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> å®¿ä¸»æœºæ‰§è¡Œæ“ä½œ æ°¸ä¹…å‰¥ç¦»è™šæ‹Ÿæœºç£ç›˜</span></span><br><span class="line">virsh detach-disk web03 vdb --live --config</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è™šæ‹ŸæœºæŸ¥çœ‹ï¼ˆæˆåŠŸï¼‰</span></span><br><span class="line">lsblk</span><br><span class="line">//è¿”å›</span><br><span class="line">NAME Â  Â  Â  Â  Â  Â  Â  Â   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sr0 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 11:0 Â  Â 1 1024M Â 0 rom Â </span><br><span class="line">vda Â  Â  Â  Â  Â  Â  Â  Â  Â  252:0 Â  Â 0 Â  10G Â 0 disk </span><br><span class="line">â”œâ”€vda1 Â  Â  Â  Â  Â  Â  Â  Â 252:1 Â  Â 0 Â   1G Â 0 part /boot</span><br><span class="line">â””â”€vda2 Â  Â  Â  Â  Â  Â  Â  Â 252:2 Â  Â 0 Â   9G Â 0 part </span><br><span class="line">  â”œâ”€centos_web03-root 253:0 Â  Â 0 Â   8G Â 0 lvm  /</span><br><span class="line">  â””â”€centos_web03-swap 253:1 Â  Â 0 Â   1G Â 0 lvm  [SWAP]</span><br></pre></td></tr></table></figure><h3 id="2-å¯¹åˆšæ‰å‰¥ç¦»çš„qcow2ç£ç›˜ç©ºé—´æ‰©å®¹-æ— æ³•åœ¨çº¿æ‰©å®¹ï¼Œå¿…é¡»å…ˆå‰¥ç¦»"><a href="#2-å¯¹åˆšæ‰å‰¥ç¦»çš„qcow2ç£ç›˜ç©ºé—´æ‰©å®¹-æ— æ³•åœ¨çº¿æ‰©å®¹ï¼Œå¿…é¡»å…ˆå‰¥ç¦»" class="headerlink" title="2. å¯¹åˆšæ‰å‰¥ç¦»çš„qcow2ç£ç›˜ç©ºé—´æ‰©å®¹ (æ— æ³•åœ¨çº¿æ‰©å®¹ï¼Œå¿…é¡»å…ˆå‰¥ç¦»)"></a><code>2.</code> å¯¹åˆšæ‰å‰¥ç¦»çš„qcow2ç£ç›˜ç©ºé—´æ‰©å®¹ (æ— æ³•åœ¨çº¿æ‰©å®¹ï¼Œå¿…é¡»å…ˆå‰¥ç¦»)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç»™åˆ›å»ºçš„ç£ç›˜æ‰©å®¹5G</span></span><br><span class="line">qemu-img resize /kvm/web03-vdb.qcow2 +5G</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ‰©å®¹è¯¦æƒ…</span></span><br><span class="line">qemu-img info /kvm/web03-vdb.qcow2</span><br><span class="line">//è¿”å›</span><br><span class="line">image: /kvm/web03-vdb.qcow2</span><br><span class="line">file format: qcow2</span><br><span class="line">virtual size: 15G (16106127360 bytes)</span><br></pre></td></tr></table></figure><p><strong>æ·»åŠ ç£ç›˜åˆ°è™šæ‹Ÿæœºï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ°¸ä¹…æ·»åŠ ç£ç›˜ï¼ˆç»™web03 æ·»åŠ 10Gç£ç›˜ æŒ‡å®šæ·»åŠ åè™šæ‹Ÿæœºç£ç›˜åç§°ä¸º vdb æ ¼å¼ä¸º qcow2 æ ¼å¼ï¼‰</span></span><br><span class="line">virsh attach-disk web03 /kvm/web03-vdb.qcow2 vdb --subdriver qcow2 --live --config</span><br><span class="line">//è¿”å›</span><br><span class="line">Disk attached successfully</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‚è½½éªŒè¯ï¼ˆå…ˆå‰å·²ç»æ ¼å¼åŒ–è¿‡ç£ç›˜ æ­¤æ—¶åˆ‡è®°ä¸èƒ½å†æ ¼å¼åŒ– å¦åˆ™ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼‰</span> </span><br><span class="line">[root@web03 ~]# mount /dev/vdb /mnt</span><br><span class="line">[root@web03 ~]# cd /mnt</span><br><span class="line">[root@web03 mnt]# ls</span><br><span class="line">1.ttx</span><br><span class="line">[root@web03 mnt]# </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ·æ–°åˆ°<span class="built_in">df</span> -Th</span></span><br><span class="line">xfs_growfs /mnt</span><br><span class="line">//è¿”å›</span><br><span class="line">meta-data=/dev/vdb Â  Â  Â  Â  Â  Â  Â  isize=512 Â  Â agcount=4, agsize=655360 blks</span><br><span class="line"> Â  Â  Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sectsz=512 Â  attr=2, projid32bit=1</span><br><span class="line"> Â  Â  Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  crc=1 Â  Â  Â  Â finobt=0 spinodes=0</span><br><span class="line">data Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  bsize=4096 Â  blocks=2621440, imaxpct=25</span><br><span class="line"> Â  Â  Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sunit=0 Â  Â  Â swidth=0 blks</span><br><span class="line">naming Â  =version 2 Â  Â  Â  Â  Â  Â  Â bsize=4096 Â  ascii-ci=0 ftype=1</span><br><span class="line">log Â  Â  Â =internal Â  Â  Â  Â  Â  Â  Â  bsize=4096 Â  blocks=2560, version=2</span><br><span class="line"> Â  Â  Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sectsz=512 Â  sunit=0 blks, lazy-count=1</span><br><span class="line">realtime =none Â  Â  Â  Â  Â  Â  Â  Â  Â  extsz=4096 Â  blocks=0, rtextents=0</span><br></pre></td></tr></table></figure><p><strong>å…ˆå‰å·²ç»æ ¼å¼åŒ–è¿‡ç£ç›˜ æ­¤æ—¶åˆ‡è®°ä¸èƒ½å†æ ¼å¼åŒ– å¦åˆ™ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_05199bb86394af821c0bc709165683a0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_05199bb86394af821c0bc709165683a0.png"></p><h2 id="åå››-çƒ­æ·»åŠ ç½‘å¡"><a href="#åå››-çƒ­æ·»åŠ ç½‘å¡" class="headerlink" title="åå››. çƒ­æ·»åŠ ç½‘å¡"></a>åå››. çƒ­æ·»åŠ ç½‘å¡</h2><h3 id="1-çƒ­æ·»åŠ ç½‘å¡"><a href="#1-çƒ­æ·»åŠ ç½‘å¡" class="headerlink" title="1.çƒ­æ·»åŠ ç½‘å¡"></a><code>1.</code>çƒ­æ·»åŠ ç½‘å¡</h3><p><strong>æ¡ˆä¾‹: ä¸ºKVMè™šæ‹Ÿæœº web03 æ·»åŠ ä¸€å—ç½‘å¡</strong></p><p><strong>æ ¼å¼:  virsh attach-interface   è™šæ‹Ÿæœºåç§°  â€“type bridgeâ€“source  ç½‘æ¡¥å  â€“model  virtio</strong></p><ul><li><strong>â€“type              ç”¨äºæŒ‡å®šç½‘å¡ç±»å‹</strong></li><li><strong>â€“source          å®¿ä¸»æœºç½‘æ¡¥å</strong></li><li><strong>â€“model virtio   é©±åŠ¨æ¨¡å¼(ç”¨äºæŒ‡å®šç½‘å¡ç±»å‹ä»¥ethå¼€å¤´)</strong></li><li><strong>â€“live              åœ¨çº¿æ·»åŠ </strong></li><li><strong>â€“config          æ°¸ä¹…ä¿å­˜é…ç½®(ä¸åŠ ä¸´æ—¶ç”Ÿæ•ˆ)</strong></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç»™ web03 çƒ­æ·»åŠ ä¸€å—bridgeç±»å‹ç½‘å¡</span></span><br><span class="line">virsh attach-interface web03 --type bridge Â --source br0 --model virtio --live --config</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç»™ web03 çƒ­æ·»åŠ ä¸€å—natç±»å‹ç½‘å¡ (åªæœ‰ä¸€å—ç½‘å¡æ¨¡å¼æ—¶ --<span class="built_in">source</span>éœ€è¦æ˜¯ens33)</span></span><br><span class="line">virsh attach-interface web03 --type default --source br0 --model virtio --live --config</span><br></pre></td></tr></table></figure><p><strong>è™šæ‹ŸæœºéªŒè¯ï¼š</strong> <code>ip a s</code> æˆåŠŸæ·»åŠ äº†ä¸€å— <strong>eth1</strong> ç½‘å¡ å¹¶ä¸”ç½‘å¡è‡ªåŠ¨è·å–ä¸º10.0.0.186</p><p>è‹¥è¦ é…ç½®æˆå›ºå®šåœ°å€æ—¶éœ€è¦æ–°å»ºä¸€ä¸ªç½‘å¡é…ç½®æ–‡ä»¶ é…ç½® IP  æˆ–è€…ä½¿ç”¨ nmtui è®¾ç½®ç½‘å¡</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d11dedc5313b8c669b47717ebb3752a8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d11dedc5313b8c669b47717ebb3752a8.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_bb39dccafdd291a95d611dfe61554255.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_bb39dccafdd291a95d611dfe61554255.png"></p><p><strong>ç½‘å¡ä¸æƒ³è¦äº†æ€ä¹ˆåŠå‘¢ çƒ­åˆ é™¤å³å¯ã€‚</strong></p><h3 id="2-çƒ­åˆ é™¤è™šæ‹Ÿæœºç½‘å¡ï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰"><a href="#2-çƒ­åˆ é™¤è™šæ‹Ÿæœºç½‘å¡ï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰" class="headerlink" title="2.çƒ­åˆ é™¤è™šæ‹Ÿæœºç½‘å¡ï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰"></a><code>2.</code>çƒ­åˆ é™¤è™šæ‹Ÿæœºç½‘å¡ï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰</h3><ul><li><strong>â€“mac +é€šè¿‡macåœ°å€åˆ é™¤ ï¼ˆæŒ‡å®šç½‘å¡macåœ°å€åˆ é™¤ï¼‰</strong></li><li><strong>è™šæ‹Ÿæœºä½¿ç”¨ ip a / ifconfig æŸ¥çœ‹ï¼Œmacåœ°å€</strong></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">çƒ­åˆ é™¤è™šæ‹Ÿæœº web03 ç½‘å¡ (æˆåŠŸå‰¥ç¦»)</span></span><br><span class="line">virsh detach-interface web03 --type bridge --mac 52:54:00:c8:3e:2a --live --config</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_1e84857802829a410b17411183904d57.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_1e84857802829a410b17411183904d57.png"></p><h3 id="åäº”-çƒ­æ·»åŠ å†…å­˜"><a href="#åäº”-çƒ­æ·»åŠ å†…å­˜" class="headerlink" title="åäº”. çƒ­æ·»åŠ å†…å­˜"></a>åäº”. çƒ­æ·»åŠ å†…å­˜</h3><h3 id="1-åˆ›å»ºæ—¶æŒ‡å®šcpu-å†…å­˜æœ€å¤§æ•°é‡"><a href="#1-åˆ›å»ºæ—¶æŒ‡å®šcpu-å†…å­˜æœ€å¤§æ•°é‡" class="headerlink" title="1.åˆ›å»ºæ—¶æŒ‡å®šcpu å†…å­˜æœ€å¤§æ•°é‡"></a><code>1.</code>åˆ›å»ºæ—¶æŒ‡å®šcpu å†…å­˜æœ€å¤§æ•°é‡</h3><p><strong>çƒ­æ·»åŠ å†…å­˜ä¸CPU  å‰ææ˜¯åˆ›å»ºKVMè™šæ‹Ÿæœºæ—¶è®¾ç½®maxmemoryä¸maxvcpuså‚æ•° ä¹Ÿå¯åˆ›å»ºå®Œæˆåé€šè¿‡å‘½ä»¤å®šä¹‰</strong></p><ul><li><strong>maxmemory    å®šä¹‰è™šæœºæœ€å¤§å¯ä»¥åˆ†é…å†…å­˜çš„å¤§å°</strong></li><li><strong>maxvcpus        å®šä¹‰è™šæ‹Ÿæœºæœ€å¤§å¯ä»¥ä½¿ç”¨çš„CPUæ ¸æ•°</strong></li></ul><p><strong>åˆ›å»ºKVMè™šæ‹Ÿæœºï¼Œå¹¶è®¾ç½®maxmemoryä¸maxvcpusçš„å€¼</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºè™šæ‹Ÿæœº</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web04 \</span><br><span class="line">--memory 1024,maxmemory=2048 \</span><br><span class="line">--vcpus 1,maxvcpus=4 --disk /kvm/web04-vda.qcow2,format=qcow2,size=10 \</span><br><span class="line">--cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso --network bridge=br0 --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºåé€šè¿‡å‘½ä»¤æŒ‡å®š-cpu-å†…å­˜æœ€å¤§æ•°é‡"><a href="#2-åˆ›å»ºåé€šè¿‡å‘½ä»¤æŒ‡å®š-cpu-å†…å­˜æœ€å¤§æ•°é‡" class="headerlink" title="2.åˆ›å»ºåé€šè¿‡å‘½ä»¤æŒ‡å®š cpu å†…å­˜æœ€å¤§æ•°é‡"></a><code>2.</code>åˆ›å»ºåé€šè¿‡å‘½ä»¤æŒ‡å®š cpu å†…å­˜æœ€å¤§æ•°é‡</h3><blockquote><p><strong>å‘½ä»¤åˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šæœ€å¤§å†…å­˜ åˆ™éœ€è¦å…ˆè®¾ç½®ä¸€ä¸‹æœ€å¤§å†…å­˜ å¦åˆ™æ— æ³•æ·»åŠ </strong></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®æœ€å¤§å†…å­˜ï¼Œéœ€è¦å…³æœº</span></span><br><span class="line">virsh shutdown  web03</span><br><span class="line">virsh setmaxmem web03 6144M --config Â </span><br><span class="line">// é»˜è®¤æ— å›æ˜¾</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸´æ—¶æ·»åŠ å†…å­˜ï¼Œç¼©å‡å†…å­˜åŒæ ·ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸è¦ç¼©å‡å†…å­˜ ä¼šå¯¼è‡´æœºå™¨å‡ºç°é—®é¢˜</span></span><br><span class="line">virsh setmem web03 4096M </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ°¸ä¹…æ·»åŠ å†…å­˜</span></span><br><span class="line">virsh setmem web03 4096M --config Â </span><br></pre></td></tr></table></figure><p><strong>éªŒè¯</strong>ï¼ˆæ·»åŠ æˆåŠŸï¼‰</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_e5eb9315664b827df6013961c3b6b4d2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_e5eb9315664b827df6013961c3b6b4d2.png"></p><h2 id="åå…­-çƒ­æ·»åŠ cpu"><a href="#åå…­-çƒ­æ·»åŠ cpu" class="headerlink" title="åå…­. çƒ­æ·»åŠ cpu"></a>åå…­. çƒ­æ·»åŠ <code>cpu</code></h2><h3 id="1-åˆ›å»ºè™šæ‹Ÿæœºæ—¶æŒ‡å®š-CPU-æœ€å¤§æ•°æ—¶-çƒ­æ·»åŠ CPU"><a href="#1-åˆ›å»ºè™šæ‹Ÿæœºæ—¶æŒ‡å®š-CPU-æœ€å¤§æ•°æ—¶-çƒ­æ·»åŠ CPU" class="headerlink" title="1. åˆ›å»ºè™šæ‹Ÿæœºæ—¶æŒ‡å®š CPU æœ€å¤§æ•°æ—¶ çƒ­æ·»åŠ CPU"></a><code>1.</code> åˆ›å»ºè™šæ‹Ÿæœºæ—¶æŒ‡å®š <strong>CPU</strong> æœ€å¤§æ•°æ—¶ çƒ­æ·»åŠ <code>CPU</code></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸´æ—¶çƒ­æ·»åŠ cpuæ ¸æ•°</span></span><br><span class="line">virsh setvcpus web03 4 --live</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ°¸ä¹…æ·»åŠ cpuæ ¸æ•°</span></span><br><span class="line">virsh setvcpus web03 4 --config</span><br></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºå®Œæˆåçƒ­æ·»åŠ è™šæ‹ŸæœºCPUï¼ˆéœ€è¦å…³æœº-ä¸”è®¾ç½®çš„-CPU-æœ€å¤§æ•°ä¸èƒ½è¶…è¿‡å®¿ä¸»æœº-CPU-æ•°ï¼‰"><a href="#2-åˆ›å»ºå®Œæˆåçƒ­æ·»åŠ è™šæ‹ŸæœºCPUï¼ˆéœ€è¦å…³æœº-ä¸”è®¾ç½®çš„-CPU-æœ€å¤§æ•°ä¸èƒ½è¶…è¿‡å®¿ä¸»æœº-CPU-æ•°ï¼‰" class="headerlink" title="2. åˆ›å»ºå®Œæˆåçƒ­æ·»åŠ è™šæ‹ŸæœºCPUï¼ˆéœ€è¦å…³æœº ä¸”è®¾ç½®çš„ CPU æœ€å¤§æ•°ä¸èƒ½è¶…è¿‡å®¿ä¸»æœº  CPU  æ•°ï¼‰"></a><code>2.</code> åˆ›å»ºå®Œæˆåçƒ­æ·»åŠ è™šæ‹ŸæœºCPUï¼ˆéœ€è¦å…³æœº ä¸”è®¾ç½®çš„ CPU æœ€å¤§æ•°ä¸èƒ½è¶…è¿‡å®¿ä¸»æœº  CPU  æ•°ï¼‰</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹è™šæ‹Ÿæœºå½“å‰æœ€å¤§æ”¯æŒçš„æ ¸å¿ƒæ•°</span></span><br><span class="line">virsh edit web03</span><br><span class="line">...</span><br><span class="line">//è¿”å›</span><br><span class="line">  &lt;memory unit=&#x27;KiB&#x27;&gt;2097152&lt;/memory&gt;</span><br><span class="line">  &lt;currentMemory unit=&#x27;KiB&#x27;&gt;2097152&lt;/currentMemory&gt;</span><br><span class="line">  &lt;vcpu placement=&#x27;static&#x27;&gt;1&lt;/vcpu&gt; Â  # 1cpu</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è°ƒæ•´è™šæ‹Ÿæœºæ”¯æŒCPUçš„æœ€å¤§å€¼</span></span><br><span class="line">virsh setvcpus web03 --maximum 6 --config </span><br><span class="line">...</span><br><span class="line">å¦åˆ™ä¼šæŠ¥é”™</span><br><span class="line">virsh setvcpus web03 Â 4 --config</span><br><span class="line">error: invalid argument: requested vcpus is greater than max allowable vcpus for the persistent domain: 4 &gt; 1</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨å‘½ä»¤è°ƒæ•´å æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦æ”¹å˜ (æ–‡ä»¶æˆåŠŸæ”¹å˜)</span></span><br><span class="line">virsh edit web03</span><br><span class="line">...</span><br><span class="line">  &lt;currentMemory unit=&#x27;KiB&#x27;&gt;2097152&lt;/currentMemory&gt;</span><br><span class="line">  &lt;vcpu placement=&#x27;static&#x27; current=&#x27;1&#x27;&gt;6&lt;/vcpu&gt; Â # 6cpu</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨è™šæ‹ŸæœºæŸ¥çœ‹é…ç½®</span></span><br><span class="line">virsh start web03</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸´æ—¶çƒ­æ·»åŠ CPUæ ¸å¿ƒæ•°é‡</span></span><br><span class="line">virsh setvcpus web03 4</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ°¸ä¹…æ·»åŠ CPUæ ¸å¿ƒæ•°é‡</span></span><br><span class="line">virsh setvcpus web03 4 --config</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_229143f829ebe75863789362572c1acf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_229143f829ebe75863789362572c1acf.png"></p><p><strong>æœ¬æ–‡çƒ­æ·»åŠ å†…å­˜åŠcpuéƒ¨åˆ†å‚è€ƒå¦‚ä¸‹é“¾æ¥</strong></p><p><a href="https://www.cnblogs.com/yinzhengjie/p/18127842">https://www.cnblogs.com/yinzhengjie/p/18127842</a> <a href="https://blog.csdn.net/m0_46180357/article/details/108935979">https://blog.csdn.net/m0_46180357/article/details/108935979</a></p>]]></content>
      
      
      <categories>
          
          <category> kvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows11å®‰è£…docker-desktop,docker-compose</title>
      <link href="/2024/04/20/windows11%E5%AE%89%E8%A3%85docker-desktop,docker-compose/"/>
      <url>/2024/04/20/windows11%E5%AE%89%E8%A3%85docker-desktop,docker-compose/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="windows11å®‰è£…docker-desktop-docker-compose"><a href="#windows11å®‰è£…docker-desktop-docker-compose" class="headerlink" title="windows11å®‰è£…docker-desktop,docker-compose"></a>windows11å®‰è£…docker-desktop,docker-compose</h1><blockquote><p>å¤‡æ³¨ï¼šdocker-desktop æ— æ³•ä¸ vmware çš„è™šæ‹ŸåŒ– Inter-VT-x/EPTæˆ–AMD-V/RVI(V) å…±å­˜ ä½¿ç”¨æ­¤åŠŸèƒ½æ—¶éœ€è¦å…ˆçŸ­æš‚å…³é—­ Hyper-V æœåŠ¡å¹¶é‡å¯ç”µè„‘ CMD å‘½ä»¤å¦‚ä¸‹ éœ€è¦ä½¿ç”¨docker-desktop æ—¶å†å¼€å¯å¹¶é‡å¯ç”µè„‘å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­</span></span><br><span class="line">bcdedit /set hypervisorlaunchtype off </span><br><span class="line"><span class="comment"># å¯åŠ¨ </span></span><br><span class="line">bcdedit /set hypervisorlaunchtype auto</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_118aa809b6e7db0a2c34c57eb7d08ecf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_118aa809b6e7db0a2c34c57eb7d08ecf.png"></p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/CNjcdyl/article/details/124802614">è§£å†³è™šæ‹ŸæœºVM-å¼€å¯ è™šæ‹ŸåŒ– Intel-VT-x/EPT æˆ– AMD-V/RVIï¼ˆVï¼‰ å ç”µè„‘è“å±é‡å¯ æˆ–æ˜¾ç¤ºæ­¤å¹³å°ä¸æ”¯æŒè™šæ‹ŸåŒ–çš„é—®é¢˜ ï¼ˆWin10ï¼‰_è™šæ‹ŸåŒ–inteltv-xeptæˆ–amd-vrvi-</a></p></blockquote><h1 id="ä¸€ã€å®‰è£…é¡ºåº"><a href="#ä¸€ã€å®‰è£…é¡ºåº" class="headerlink" title="ä¸€ã€å®‰è£…é¡ºåº"></a>ä¸€ã€å®‰è£…é¡ºåº</h1><p><a href="https://blog.csdn.net/qq_41644183/article/details/132305487#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85Hyper-V">å®‰è£…Hyper-V</a></p><p><a href="https://blog.csdn.net/qq_41644183/article/details/132305487#%E4%B8%89%E3%80%81%E5%AE%89%E8%A3%85WSL">å®‰è£…WSL</a></p><p><a href="https://blog.csdn.net/qq_41644183/article/details/132305487#%E5%9B%9B%E3%80%81%E5%AE%89%E8%A3%85Docker%20Desktop">å®‰è£…Docker Desktop</a></p><p><a href="https://link.zhihu.com/?target=https://desktop.docker.com/win/main/amd64/Docker%2520Desktop%2520Installer.exe">Docker-windows-appä¸‹è½½é“¾æ¥</a></p><h1 id="äºŒã€å®‰è£…Hyper-V"><a href="#äºŒã€å®‰è£…Hyper-V" class="headerlink" title="äºŒã€å®‰è£…Hyper-V"></a>äºŒã€å®‰è£…Hyper-V</h1><p>1ã€Windows11æ˜¯æ‰¾ä¸åˆ°<a href="https://so.csdn.net/so/search?q=Hyper-V&spm=1001.2101.3001.7020">Hyper-V</a>çš„ï¼Œéœ€è¦è‡ªè¡Œå®‰è£…</p><p>2ã€åˆ›å»ºä¸€ä¸ªhyper.batæ–‡ä»¶ï¼Œç¼–è¾‘ï¼Œå¤åˆ¶ä»¥ä¸‹ä»£ç åˆ°æ–‡ä»¶ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pushd</span> <span class="string">&quot;%~dp0&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /b %SystemRoot%\servicing\Packages\*Hyper-V*.mum &gt;hyper-v.txt</span><br><span class="line"><span class="keyword">for</span> /f %%i <span class="keyword">in</span> (<span class="string">&#x27;findstr /i . hyper-v.txt 2^&gt;nul&#x27;</span>) <span class="keyword">do</span> dism /online /norestart /add-package:<span class="string">&quot;%SystemRoot%\servicing\Packages\%%i&quot;</span></span><br><span class="line">del hyper-v.txt</span><br><span class="line">Dism /online /enable-feature /featurename:Microsoft-Hyper-V-All /LimitAccess /ALL</span><br></pre></td></tr></table></figure><p>3ã€ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œhyper.batï¼Œè¿è¡Œäº†ä¹‹åéœ€è¦æŒ‰Ctrl+Cåœä¸‹æ¥ï¼Œå¦åˆ™ä¼šä¸€ç›´é‡å¤æ‰§è¡Œï¼Œæœ€åè¾“å…¥Yï¼Œç¡®è®¤å®ŒæˆHyper-Vçš„å®‰è£…<br>4ã€æ‰“å¼€æ§åˆ¶é¢æ¿-&gt;ç¨‹åº-&gt;å¯ç”¨æˆ–å…³é—­WindowsåŠŸèƒ½å‹¾é€‰Hyper-Vï¼ŒåŒæ—¶å‹¾é€‰é€‚ç”¨äºLinuxçš„Windowså­ç³»ç»Ÿä»¥åŠè™šæ‹Ÿæœºå¹³å°ï¼Œé‡å¯ç”µè„‘ï¼ˆå¯ä»¥ç­‰å®‰è£…WSLçš„æ—¶å€™å†é‡å¯ï¼‰<br><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c56711b4323471003c3a8ea0d960d131.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c56711b4323471003c3a8ea0d960d131.png"></p><h1 id="ä¸‰ã€å®‰è£…WSL"><a href="#ä¸‰ã€å®‰è£…WSL" class="headerlink" title="ä¸‰ã€å®‰è£…WSL"></a>ä¸‰ã€å®‰è£…WSL</h1><p>1ã€ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€PowerShellï¼Œè¾“å…¥å‘½ä»¤å®‰è£…WSL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All</span><br></pre></td></tr></table></figure><p>2ã€å®Œæˆï¼Œé‡å¯ç”µè„‘ï¼Œå®Œæˆå®‰è£…</p><p>3ã€å¦‚æœWSLç‰ˆæœ¬å¤ªä½ï¼Œå‡çº§WSL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl.exe --update</span><br></pre></td></tr></table></figure><h1 id="å››ã€å®‰è£…Docker-Desktop"><a href="#å››ã€å®‰è£…Docker-Desktop" class="headerlink" title="å››ã€å®‰è£…Docker Desktop"></a>å››ã€å®‰è£…Docker Desktop</h1><p>1ã€<a href="https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe">ä¸‹è½½Docker Desktop</a></p><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c8aeee17bdfc44342ee2537961ade9c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c8aeee17bdfc44342ee2537961ade9c.png"></p><h1 id="äº”-å®‰è£…docker-compose"><a href="#äº”-å®‰è£…docker-compose" class="headerlink" title="äº”. å®‰è£…docker-compose"></a>äº”. å®‰è£…docker-compose</h1><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/docker/compose/releases/">https://github.com/docker/compose</a></p><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/qq_41644183/article/details/132305487">Dockerå®‰è£…æ•™ç¨‹â€”â€”ä»¥Windows11å®¶åº­ä¸­æ–‡ç‰ˆä¸ºä¾‹_win11å®¶åº­ç‰ˆå®‰è£…docker</a></p><p><a href="https://zhuanlan.zhihu.com/p/552307629">Win11å®‰è£…DockeråŠç®€å•ä½¿ç”¨ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://blog.csdn.net/qq_38215042/article/details/108647680">Windowså®‰è£…ä½¿ç”¨dockerä¸docker-compose_windowsä¸‹å®‰è£…compose-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>confluenceéƒ¨ç½²</title>
      <link href="/2024/04/17/confluence%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/17/confluence%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="confluenceéƒ¨ç½²"><a href="#confluenceéƒ¨ç½²" class="headerlink" title="confluenceéƒ¨ç½²"></a>confluenceéƒ¨ç½²</h1><h1 id="ä¸€-å®‰è£…java-1-8"><a href="#ä¸€-å®‰è£…java-1-8" class="headerlink" title="ä¸€. å®‰è£…java 1.8"></a>ä¸€. å®‰è£…java 1.8</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install software-properties-common</span><br><span class="line">apt-get install openjdk-8-jdk</span><br></pre></td></tr></table></figure><h1 id="äºŒ-éƒ¨ç½²mysql5-7æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨dockeréƒ¨ç½²"><a href="#äºŒ-éƒ¨ç½²mysql5-7æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨dockeréƒ¨ç½²" class="headerlink" title="äºŒ. éƒ¨ç½²mysql5.7æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨dockeréƒ¨ç½²"></a>äºŒ. éƒ¨ç½²mysql5.7æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨dockeréƒ¨ç½²</h1><blockquote><p>ç‰¹åˆ«è¯´æ˜ï¼ˆæœ¬æ–‡å·²å†™å…¥docker-composeæ–‡ä»¶ä¸­ï¼‰</p><p>ä¸€å®šè¦è®¾ç½®æ•°æ®åº“éš”ç¦»çº§åˆ« <code>SET GLOBAL tx_isolation=&#39;READ-COMMITTED&#39;; </code>å¦åˆ™ä¼šå¯¼è‡´confluenceè¿ä¸ä¸Šæ•°æ®åº“</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;3.0&quot;</span>                                                                                                                                                 </span><br><span class="line">services:                                                                                                                                                      </span><br><span class="line">  db:                                                                                                                                                          </span><br><span class="line">    image: mysql:5.7                                                                                                                                           </span><br><span class="line">    container_name: confluse_mysql                                                                                                                             </span><br><span class="line">    hostname: db                                                                                                                                               </span><br><span class="line">    restart: always                                                                                                                                            </span><br><span class="line">    ports:                                                                                                                                                     </span><br><span class="line">      - <span class="string">&quot;3307:3306&quot;</span>                                                                                                                                            </span><br><span class="line">    <span class="built_in">command</span>:                                                                                                                                                   </span><br><span class="line">      - mysqld                                                                                                                                                 </span><br><span class="line">      - --symbolic-links=0                                                                                                                                     </span><br><span class="line">      - --transaction-isolation=READ-COMMITTED                                                                                                                 </span><br><span class="line">      - --collation_server=utf8_bin                                                                                                                            </span><br><span class="line">      - --character-set-server=utf8                                                                                                                            </span><br><span class="line">      - --innodb_file_per_table=1                                                                                                                              </span><br><span class="line">      - --innodb_buffer_pool_size=2G                                                                                                                           </span><br><span class="line">      - --max_connections=1000                                                                                                                                 </span><br><span class="line">      - --innodb_flush_log_at_trx_commit=2                                                                                                                     </span><br><span class="line">      - --innodb_read_io_threads=32                                                                                                                            </span><br><span class="line">      - --innodb_write_io_threads=16                                                                                                                           </span><br><span class="line">      - --max_allowed_packet=32M                                                                                                                               </span><br><span class="line">      - --max_heap_table_size=512M                                                                                                                             </span><br><span class="line">      - --bulk_insert_buffer_size=64M                                                                                                                          </span><br><span class="line">      - --tmp_table_size=64M                                                                                                                                   </span><br><span class="line">      - --join_buffer_size=64M                                                                                                                                 </span><br><span class="line">      - --max_allowed_packet=34M                                                                                                                               </span><br><span class="line">      - --innodb_log_file_size=256M                                                                                                                            </span><br><span class="line">    environment:                                                                                                                                               </span><br><span class="line">      - MYSQL_ROOT_PASSWORD=<span class="built_in">test</span>                                                                                                                     </span><br><span class="line">      - MYSQL_DATABASE=confluence_test                                                                                                                         </span><br><span class="line">      - MYSQL_DATABASE=confluence                                                                                                                              </span><br><span class="line">      - MYSQL_USER=confluence                                                                                                                                  </span><br><span class="line">      - MYSQL_PASSWORD=<span class="built_in">test</span>                                                                                                                                  </span><br><span class="line">      - TZ=Asia/Shanghai                                                                                                                                       </span><br><span class="line">    volumes:                                                                                                                                                   </span><br><span class="line">      - confluse-db:/var/lib/mysql                                                                                                                             </span><br><span class="line">      - ./db_bak_sh:/home/db_bak_sh:rw                                                                                                                         </span><br><span class="line">      - ./bak:/opt/confluence_mysql/bak:rw                                                                                                                     </span><br><span class="line">volumes:                                                                                                                                                       </span><br><span class="line">  confluse-db:</span><br></pre></td></tr></table></figure><p>mysqlå¤‡ä»½è„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash                                                                                                                                                          </span></span><br><span class="line"><span class="comment">#mysqlbak_version:1.3                                                                                                                                                </span></span><br><span class="line"><span class="comment">#æ ‡å‡†æ¢æ•°æ®åº“å¤‡ä»½è„šæœ¬                                                                                                                                                </span></span><br><span class="line"><span class="built_in">set</span> -e                                                                                                                                                               </span><br><span class="line"><span class="function"><span class="title">bak_mysql</span></span>()&#123;                                                                                                                                                         </span><br><span class="line">   bak_name=<span class="string">&quot;confluence&quot;</span>                                                                                                                                             </span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;\033[33m å¼€å§‹å¤‡ä»½æ•°æ®åº“:<span class="variable">$&#123;bak_name&#125;</span> \033[0m&quot;</span>                                                                                                                </span><br><span class="line">   bak_dir=<span class="string">&quot;/opt/confluence_mysql/bak&quot;</span>                                                                                                                               </span><br><span class="line">   time=`<span class="built_in">date</span> +%F_%H_%M`                                                                                                                                             </span><br><span class="line">   port_bak=3306                                                                                                                                                     </span><br><span class="line">   user_bak=<span class="string">&quot;root&quot;</span>                                                                                                                                                   </span><br><span class="line">   passwd_bak=<span class="string">&quot;test&quot;</span>                                                                                                                                       </span><br><span class="line">   ip_bak=localhost                                                                                                                                                  </span><br><span class="line"><span class="keyword">if</span> [ ! -d <span class="variable">$&#123;bak_dir&#125;</span> ];                                                                                                                                              </span><br><span class="line">   <span class="keyword">then</span>                                                                                                                                                              </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[33m å¼€å§‹åˆ›å»ºç›®å½•:<span class="variable">$&#123;bak_dir&#125;</span> \033[0m&quot;</span>                                                                                                               </span><br><span class="line">       <span class="built_in">mkdir</span> -p  <span class="variable">$&#123;bak_dir&#125;</span> &amp;&amp; <span class="built_in">chmod</span> 755 <span class="variable">$&#123;bak_dir&#125;</span>                                                                                                                  </span><br><span class="line">   <span class="keyword">else</span>                                                                                                                                                              </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[36m <span class="variable">$&#123;bak_dir&#125;</span>ç›®å½•å·²å­˜åœ¨  \033[0m&quot;</span>                                                                                                                 </span><br><span class="line"><span class="keyword">fi</span>                                                                                                                                                                   </span><br><span class="line">mysqldump -P<span class="variable">$&#123;port_bak&#125;</span> -p<span class="variable">$&#123;passwd_bak&#125;</span> -u<span class="variable">$&#123;user_bak&#125;</span> -h<span class="variable">$&#123;ip_bak&#125;</span> --single-transaction -R -E -B <span class="variable">$&#123;bak_name&#125;</span> |gzip &gt;<span class="variable">$&#123;bak_dir&#125;</span>/<span class="variable">$&#123;bak_name&#125;</span>_<span class="variable">$&#123;ip_bak&#125;</span>_<span class="variable">$&#123;time&#125;</span>.sql.gz   </span><br><span class="line">bak_file=<span class="string">&quot;/opt/confluence_mysql/bak/*.sql.gz&quot;</span>                                                                                                                        </span><br><span class="line"><span class="keyword">if</span> [ $? = 0 ];                                                                                                                                                       </span><br><span class="line">   <span class="keyword">then</span>                                                                                                                                                              </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[36m  <span class="variable">$&#123;time&#125;</span>æ•°æ®åº“:<span class="variable">$&#123;bak_name&#125;</span>å¤‡ä»½æˆåŠŸ,                                                                                                            </span></span><br><span class="line"><span class="string">                å¤‡ä»½ä½ç½®:<span class="variable">$&#123;bak_dir&#125;</span>/<span class="variable">$&#123;bak_name&#125;</span>_<span class="variable">$&#123;ip_bak&#125;</span>_<span class="variable">$&#123;time&#125;</span>.sql.gz  \033[0m&quot;</span> &gt;&gt; /opt/confluence_mysql/bak/confluence_bak.log                                   </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[36m <span class="variable">$&#123;time&#125;</span>æ•°æ®åº“:<span class="variable">$&#123;bak_name&#125;</span>å¤‡ä»½æˆåŠŸ,                                                                                                             </span></span><br><span class="line"><span class="string">                å¤‡ä»½ä½ç½®:<span class="variable">$&#123;bak_dir&#125;</span>/<span class="variable">$&#123;bak_name&#125;</span>_<span class="variable">$&#123;ip_bak&#125;</span>_<span class="variable">$&#123;time&#125;</span>.sql.gz                                                                                             </span></span><br><span class="line"><span class="string">                <span class="variable">$&#123;bak_dir&#125;</span>ç›®å½•æ­£åœ¨åˆ é™¤äº”å¤©å‰çš„å¤‡ä»½ã€‚ \033[0m&quot;</span>                                                                                                        </span><br><span class="line">       find <span class="variable">$&#123;bak_file&#125;</span> -<span class="built_in">type</span> f -mtime +5 |xargs <span class="built_in">rm</span> -f                                                                                                               </span><br><span class="line">   <span class="keyword">else</span>                                                                                                                                                              </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[31m <span class="variable">$&#123;time&#125;</span>æ•°æ®åº“:<span class="variable">$&#123;bak_name&#125;</span>å¤‡ä»½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ã€‚ \033[0m&quot;</span>                                                                                           </span><br><span class="line"><span class="keyword">fi</span>                                                                                                                                                                   </span><br><span class="line">&#125;                                                                                                                                                                                                                                                                                                                                           </span><br><span class="line"><span class="function"><span class="title">main</span></span>() &#123;                                                                                                                                                                                                                                                                                                                       </span><br><span class="line">    bak_mysql                                                                                                                                                                                                                                                                                                   </span><br><span class="line">&#125;                                                                                                                                                                    </span><br><span class="line">main      </span><br></pre></td></tr></table></figure><p>ç™»å½•mysqlè®¾ç½®ç­–ç•¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it confluse_mysql bash</span><br><span class="line">mysql -uroot -p</span><br><span class="line">SET GLOBAL tx_isolation=<span class="string">&#x27;READ-COMMITTED&#x27;</span>;</span><br></pre></td></tr></table></figure><p><a href="https://wn-apple-teawine.fun/2023/05/15/mysql%E5%A4%87%E4%BB%BD%E8%84%9A%E6%9C%AC/?highlight=mysql%E5%A4%87%E4%BB%BD">mysqlå¤‡ä»½è„šæœ¬</a></p><p>å®šæ—¶ä»»åŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0 9 * * * /usr/bin/docker <span class="built_in">exec</span> webstack_mysql bash /home/mysqlbak/webstack-dbbak.sh</span><br><span class="line">0 10 * * * /usr/bin/docker <span class="built_in">exec</span> confluse_mysql bash /home/db_bak_sh/confluence_dbbak.sh</span><br></pre></td></tr></table></figure><h1 id="ä¸‰-å®‰è£…confluse"><a href="#ä¸‰-å®‰è£…confluse" class="headerlink" title="ä¸‰. å®‰è£…confluse"></a>ä¸‰. å®‰è£…confluse</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… confluence</span></span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">wget https://product-downloads.atlassian.com/software/confluence/downloads/atlassian-confluence-6.12.0-x64.bin</span><br><span class="line"><span class="comment"># èµ‹äºˆæ‰§è¡Œæƒé™</span></span><br><span class="line"><span class="built_in">chmod</span> +x atlassian-confluence-6.12.0-x64.bin</span><br><span class="line"><span class="comment"># æ‰§è¡Œå®‰è£…</span></span><br><span class="line">./atlassian-confluence-6.12.0-x64.bin</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_79ea426efd840b65466f2b7ada4cc900.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_79ea426efd840b65466f2b7ada4cc900.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ebffd9d0bc193d12ca2d33caf5fba471.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ebffd9d0bc193d12ca2d33caf5fba471.png"></p><h1 id="å››-å…¶ä»–"><a href="#å››-å…¶ä»–" class="headerlink" title="å››. å…¶ä»–"></a>å››. å…¶ä»–</h1><blockquote><p>ç ´è§£ confluence</p><p>ç ´è§£æ–‡ä»¶ä¸‹è½½</p><p><a href="https://drive.wn-apple-teawine.fun/api/raw/?path=/public-tools/confluence/confluence%E7%A0%B4%E8%A7%A3%E5%B7%A5%E5%85%B7.zip">confluenceç ´è§£å·¥å…·.rar</a></p><h1 id="ç ´è§£æ­¥éª¤"><a href="#ç ´è§£æ­¥éª¤" class="headerlink" title="ç ´è§£æ­¥éª¤"></a>ç ´è§£æ­¥éª¤</h1><p>windows javaä¸‹è½½åœ°å€:</p><p><a href="https://www.oracle.com/java/technologies/javase/javase8u211-later-archive-downloads.html">Java Archive Downloads - Java SE 8u211 and later (oracle.com)</a></p><p>windowséƒ¨ç½²javaå‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_45710060/article/details/123315280">Javaè¯¦ç»†å®‰è£…é…ç½®æ•™ç¨‹(Windows)ï¼Œä»ä¸‹è½½åˆ°é…ç½®â€”â€”Java-1.8(jdk)å®‰è£…_jre1.8-CSDNåšå®¢</a></p><ul><li><p>æ‹·è´ <strong>/opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar</strong> æ–‡ä»¶åˆ° æœ¬åœ°æœ¬åœ°å¹¶é‡å‘½åä¸º <strong>atlassian-extras-2.4.jar</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æ­¤æ–‡ä»¶æ‹·è´åˆ°å½“å‰ç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span>  /opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar .</span><br><span class="line"><span class="comment"># é‡å‘½åä¸º atlassian-extras-2.4.jar å†å°†é‡å‘½ååçš„æ–‡ä»¶ä¸‹è½½åˆ°windowsç”µè„‘æœ¬åœ° ç”¨äºå­˜å‚¨ç ´è§£æ–‡ä»¶çš„æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">mv</span>  atlassian-extras-decoder-v2-3.4.1.jar  atlassian-extras-2.4.jar</span><br></pre></td></tr></table></figure></li><li><p>æ‰“å¼€ç ´è§£å·¥å…· <strong>confluence_keygen.jar</strong>ï¼ˆæœ¬åœ°éœ€å…ˆå®‰è£… <strong>java</strong> ï¼‰<strong>windows</strong> å‘½ä»¤è¡Œ <strong>cmd</strong> æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar confluence_keygen.jar</span><br></pre></td></tr></table></figure></li><li><p>æ‰§è¡Œå®Œæˆå åå°ä¼šè‡ªåŠ¨å¯åŠ¨ä¸€ä¸ªç¨‹åº &gt;&gt; æ­¤æ—¶ç‚¹å‡»å·²å¯åŠ¨çš„ç¨‹åºçš„ <strong>.patch!</strong> é€‰é¡¹ æ‰¾åˆ° <strong>atlassian-extras-2.4.jar</strong> æ‰“å¼€</p></li><li><p>å¯ä»¥çœ‹åˆ° <strong>atlassian-extras-2.4.jar</strong> å’Œ <strong>atlassian-extras-2.4.bak</strong> ä¸¤ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œ <strong>atlassian-extras-2.4.jar</strong> å·²ç»æ˜¯ç ´è§£å¥½çš„äº†ï¼Œå°† <strong>atlassian-extras-2.4.jar</strong> åå­—æ”¹å› <strong>atlassian-extras-decoder-v2-3.4.1.jar</strong> å°† <strong>atlassian-extras-decoder-v2-3.4.1.jar</strong> ä¸Šä¼ åˆ°æœåŠ¡å™¨åŸç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨</span></span><br><span class="line">rz</span><br><span class="line"><span class="comment"># é‡å‘½åä¸ºä¹‹å‰çš„æ–‡ä»¶å</span></span><br><span class="line"><span class="built_in">mv</span> atlassian-extras-2.4.jar  atlassian-extras-decoder-v2-3.4.1.jar</span><br><span class="line"><span class="comment"># å¤åˆ¶åˆ°åŸç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span> atlassian-extras-decoder-v2-3.4.1.jar  /opt/atlassian/confluence/confluence/WEB-INF/lib/</span><br></pre></td></tr></table></figure></li><li><p>å°†ç ´è§£åŒ…ä¸­çš„ mysql é©±åŠ¨ mysql-connector-java-5.1.44-bin.jar æ‹·è´åˆ° /opt/atlassian/confluence/confluence/WEB-INF/lib</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†mysqlé©±åŠ¨æ‹·è´åˆ°æœåŠ¡å™¨ç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span> mysql-connector-java-5.1.44-bin.jar  /opt/atlassian/confluence/confluence/WEB-INF/lib</span><br></pre></td></tr></table></figure></li><li><p>é‡å¯ confluence</p></li></ul><h2 id="åœæ­¢"><a href="#åœæ­¢" class="headerlink" title="åœæ­¢"></a>åœæ­¢</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢ç¨‹åº</span></span><br><span class="line"><span class="built_in">cd</span> /opt/atlassian/confluence/bin/</span><br><span class="line">./stop-confluence.sh</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹-confluence-ç›‘å¬åœ°å€ï¼Œç¡®å®š-8090-æ²¡æœ‰ç›‘å¬åœ¨-127-0-0-1-ä¸Š"><a href="#ä¿®æ”¹-confluence-ç›‘å¬åœ°å€ï¼Œç¡®å®š-8090-æ²¡æœ‰ç›‘å¬åœ¨-127-0-0-1-ä¸Š" class="headerlink" title="ä¿®æ”¹ confluence ç›‘å¬åœ°å€ï¼Œç¡®å®š 8090 æ²¡æœ‰ç›‘å¬åœ¨ 127.0.0.1 ä¸Š"></a>ä¿®æ”¹ confluence ç›‘å¬åœ°å€ï¼Œç¡®å®š 8090 æ²¡æœ‰ç›‘å¬åœ¨ 127.0.0.1 ä¸Š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /opt/atlassian/confluence/conf/server.xml</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹-confluence-ä½¿ç”¨çš„ç›®å½•çš„æƒé™"><a href="#ä¿®æ”¹-confluence-ä½¿ç”¨çš„ç›®å½•çš„æƒé™" class="headerlink" title="ä¿®æ”¹ confluence ä½¿ç”¨çš„ç›®å½•çš„æƒé™"></a>ä¿®æ”¹ confluence ä½¿ç”¨çš„ç›®å½•çš„æƒé™</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–‡ä»¶å¤¹å…¶æ‰€æœ‰å†…å®¹é€’å½’åœ°ä¿®æ”¹ä¸ºconfluenceç”¨æˆ·å’Œç»„çš„æ‰€æœ‰æƒ</span></span><br><span class="line"><span class="built_in">chown</span> -R confluence:confluence /opt/atlassian</span><br><span class="line"><span class="built_in">chown</span> -R confluence:confluence /var/atlassian</span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨ï¼Œå¯åŠ¨æ¯”è¾ƒæ…¢ï¼Œéœ€è¦ç­‰ä¸ªä¸¤ä¸‰åˆ†é’Ÿ"><a href="#å¯åŠ¨ï¼Œå¯åŠ¨æ¯”è¾ƒæ…¢ï¼Œéœ€è¦ç­‰ä¸ªä¸¤ä¸‰åˆ†é’Ÿ" class="headerlink" title="å¯åŠ¨ï¼Œå¯åŠ¨æ¯”è¾ƒæ…¢ï¼Œéœ€è¦ç­‰ä¸ªä¸¤ä¸‰åˆ†é’Ÿ"></a>å¯åŠ¨ï¼Œå¯åŠ¨æ¯”è¾ƒæ…¢ï¼Œéœ€è¦ç­‰ä¸ªä¸¤ä¸‰åˆ†é’Ÿ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ç¨‹åº</span></span><br><span class="line">./start-confluence.sh</span><br></pre></td></tr></table></figure><p>å…³äºæœåŠ¡ç›‘å¬IPçš„åŒºåˆ«ï¼Œå‚è€ƒ</p><p><a href="https://segmentfault.com/a/1190000018629247">https://segmentfault.com/a/1190000018629247</a></p><p>è®¿é—®confluence</p><p><a href="http://ip:8090/">http://ip:8090</a></p><p>å¼€æœºè‡ªå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ä¸ºsystemdæ‰˜ç®¡</span></span><br><span class="line">vim /lib/systemd/system/confluence.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=confluence service</span><br><span class="line">After=network.target</span><br><span class="line">StartLimitIntervalSec=60</span><br><span class="line">StartLimitBurst=5</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">User=confluence</span><br><span class="line">Group=confluence</span><br><span class="line">ExecStart=/opt/atlassian/confluence/bin/start-confluence.sh</span><br><span class="line">ExecStop=/opt/atlassian/confluence/bin/stop-confluence.sh</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=1</span><br><span class="line">SuccessExitStatus=3 4</span><br><span class="line">RestartForceExitStatus=3 4</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line"></span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">systemctl start/stop/restart/status confluence</span><br><span class="line">systemctl <span class="built_in">enable</span> confluence</span><br></pre></td></tr></table></figure><p>æŠ¥é”™</p><p>è‹¥éƒ¨ç½²è¿‡ç¨‹ä¸­å‡ºç°æŠ¥é”™ï¼Œå¯ä»¥å…ˆåœæ­¢ confluenceï¼Œç„¶ååˆ é™¤æ•°æ®åº“ï¼Œå¹¶é‡å»ºæ•°æ®åº“ï¼Œç„¶ååˆ é™¤ /var/atlassian/application-data/confluence/confluence.cfg.xml æ–‡ä»¶</p><p>å†å¯åŠ¨ confluenceï¼Œå°±åˆåˆ°äº† confluence çš„ setup é¡µé¢</p><h1 id="å¸è½½wiki"><a href="#å¸è½½wiki" class="headerlink" title="å¸è½½wiki"></a>å¸è½½wiki</h1><p><a href="https://blog.csdn.net/qq_43693598/article/details/111265298">linux å¸è½½confluenceï¼Œåªéœ€ä¸‰æ­¥_confluenceå¸è½½-CSDNåšå®¢</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. åˆ é™¤ä¸»ç›®å½•</span><br><span class="line"><span class="built_in">rm</span> -rf /opt/atlassian/</span><br><span class="line"></span><br><span class="line">2. åˆ é™¤æ•°æ®ç›®å½•</span><br><span class="line"><span class="built_in">rm</span> -rf /var/atlassian/</span><br><span class="line"></span><br><span class="line">3. åˆ é™¤ç”¨æˆ·</span><br><span class="line">userdel -r confluence</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.cnblogs.com/ios9/p/14473523.html">https://www.cnblogs.com/ios9/p/14473523.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²</title>
      <link href="/2024/04/16/homepage%E4%B8%8Esun-panel%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%AF%BC%E8%88%AA%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/16/homepage%E4%B8%8Esun-panel%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%AF%BC%E8%88%AA%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²"><a href="#homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²" class="headerlink" title="homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²"></a>homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²</h1><blockquote><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ghcr.io/gethomepage/homepage:latest</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:homepage</span><br></pre></td></tr></table></figure><p>å…¶ä»–å„ç§å¯¼èˆª</p><p><a href="https://wn-apple-teawine.fun/2023/11/23/web-start%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%AF%BC%E8%88%AA%E6%A0%8F%E9%83%A8%E7%BD%B2">https://wn-apple-teawine.fun/2023/11/23/web-startè½»é‡çº§å¯¼èˆªæ éƒ¨ç½²</a></p><p><a href="https://wn-apple-teawine.fun/2023/08/11/webstack%E9%83%A8%E7%BD%B2">https://wn-apple-teawine.fun/2023/08/11/webstackéƒ¨ç½²</a></p></blockquote><h2 id="ä¸€-éƒ¨ç½²"><a href="#ä¸€-éƒ¨ç½²" class="headerlink" title="ä¸€. éƒ¨ç½²"></a>ä¸€. éƒ¨ç½²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;3.8&quot;</span></span><br><span class="line">services:</span><br><span class="line">  homepage:</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:homepage</span><br><span class="line">    container_name: homepage</span><br><span class="line">    restart: unless-stopped</span><br><span class="line">    ports:</span><br><span class="line">      - 3123:3000</span><br><span class="line">    environment:</span><br><span class="line">      - PUID=1000</span><br><span class="line">      - PGID=100</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - ./config:/app/config</span><br><span class="line">      <span class="comment"># - /var/run/docker.sock:/var/run/docker.sock (å¯é€‰)</span></span><br><span class="line">      - ./logs:/logs</span><br><span class="line">      - ./icons:/app/public/icons</span><br><span class="line">      - ./images:/app/public/images</span><br><span class="line">      - /volume2:/volume2:ro   <span class="comment">#æœ¬æœºç£ç›˜</span></span><br><span class="line">      <span class="comment">#- /volume3:/volume3:ro</span></span><br><span class="line">    network_mode: bridge                                                                           </span><br></pre></td></tr></table></figure><h2 id="äºŒ-é…ç½®ï¼ˆæ–‡ä»¶è·¯å¾„å¯åŠ¨è·¯å¾„æ–‡ä»¶å¤¹configï¼‰"><a href="#äºŒ-é…ç½®ï¼ˆæ–‡ä»¶è·¯å¾„å¯åŠ¨è·¯å¾„æ–‡ä»¶å¤¹configï¼‰" class="headerlink" title="äºŒ. é…ç½®ï¼ˆæ–‡ä»¶è·¯å¾„å¯åŠ¨è·¯å¾„æ–‡ä»¶å¤¹configï¼‰"></a>äºŒ. é…ç½®ï¼ˆæ–‡ä»¶è·¯å¾„å¯åŠ¨è·¯å¾„æ–‡ä»¶å¤¹configï¼‰</h2><p><strong>service.yml</strong>æœ¬æ–‡é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">root@web:/opt/homepage/config<span class="comment"># cat services.yaml </span></span><br><span class="line">---</span><br><span class="line"><span class="comment"># For configuration options and examples, please see:</span></span><br><span class="line"><span class="comment"># https://gethomepage.dev/latest/configs/services</span></span><br><span class="line"></span><br><span class="line">- è¿ç»´ä¸å¼€å‘å·¥å…·:</span><br><span class="line">    - Gitlab:</span><br><span class="line">        href: http://10.0.0.10:8929</span><br><span class="line">        description: ä»£ç æ‰˜ç®¡å¹³å°</span><br><span class="line">    - å¯†ç ç®¡ç†å¹³å°:</span><br><span class="line">        href: https://10.0.0.10</span><br><span class="line">        description: å¯†ç ç®¡ç†å¹³å°</span><br><span class="line"></span><br><span class="line">- AIåŠ©æ‰‹:</span><br><span class="line">    - one-api:</span><br><span class="line">        href: http://10.0.0.10:3000</span><br><span class="line">        description: api-keyåˆ†å‘å¹³å°</span><br><span class="line">    - Fastgpt:</span><br><span class="line">        href: http://10.0.0.10:30001</span><br><span class="line">        description: Fastgpt</span><br><span class="line"></span><br><span class="line">- å®˜ç½‘:</span><br><span class="line">    - å®˜ç½‘1:</span><br><span class="line">        href: http://10.0.0.10/wp-login.php</span><br><span class="line">        description: å®˜ç½‘1</span><br><span class="line">    - å®˜ç½‘2:</span><br><span class="line">        href: http://10.0.0.10:4007/wp-login.php</span><br><span class="line">        description: å®˜ç½‘2</span><br></pre></td></tr></table></figure><p><strong>settings.yaml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="comment"># For configuration options and examples, please see:</span></span><br><span class="line"><span class="comment"># https://gethomepage.dev/latest/configs/settings</span></span><br><span class="line"></span><br><span class="line">providers:</span><br><span class="line">  openweathermap: openweathermapapikey</span><br><span class="line">  weatherapi: weatherapiapikey</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯­è¨€en-AUã€en-GB</span></span><br><span class="line">language: zh-CN</span><br><span class="line"></span><br><span class="line"><span class="comment"># èƒŒæ™¯å›¾</span></span><br><span class="line">background:</span><br><span class="line">  image: https://images.unsplash.com/photo-1502790671504-542ad42d5189?auto=format&amp;fit=crop&amp;w=2560&amp;q=80</span><br><span class="line">  blur: sm <span class="comment">#æ¨¡ç³Šç¨‹åº¦ï¼ŒèŒƒå›´ sm, &quot;&quot;, md, xl... å‚è€ƒ https://tailwindcss.com/docs/backdrop-blur</span></span><br><span class="line">  saturate: 50 <span class="comment">#é¥±å’Œåº¦ï¼ŒèŒƒå›´ 0, 50, 100... å‚è€ƒ https://tailwindcss.com/docs/backdrop-saturate</span></span><br><span class="line">  brightness: 50 <span class="comment">#äº®åº¦ï¼ŒèŒƒå›´ 0, 50, 75... å‚è€ƒ https://tailwindcss.com/docs/backdrop-brightness</span></span><br><span class="line">  opacity: 50 <span class="comment">#ä¸é€æ˜åº¦ï¼ŒèŒƒå›´ 0-100</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ ‡é¢˜</span></span><br><span class="line">title: CKY-å¯¼èˆª</span><br><span class="line"></span><br><span class="line"><span class="comment"># éšè—å‘å¸ƒç‰ˆæœ¬</span></span><br><span class="line"><span class="comment">#hideVersion: true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼èˆªæ¨ªå±éœ€è¦ä¸service.ymlæ–‡ä»¶åŒæ­¥</span></span><br><span class="line">layout:</span><br><span class="line">  è¿ç»´ä¸å¼€å‘å·¥å…·:</span><br><span class="line">    icon: /images/1.png</span><br><span class="line">    style: row</span><br><span class="line">    columns: 6</span><br><span class="line">  AIåŠ©æ‰‹:</span><br><span class="line">    icon: jellyfin.png</span><br><span class="line">    style: row</span><br><span class="line">    columns: 6</span><br><span class="line">  å®˜ç½‘:</span><br><span class="line">    icon: jellyfin.png</span><br><span class="line">    style: row</span><br><span class="line">    columns: 6</span><br></pre></td></tr></table></figure><h4 id="èƒŒæ™¯å›¾"><a href="#èƒŒæ™¯å›¾" class="headerlink" title="èƒŒæ™¯å›¾"></a>èƒŒæ™¯å›¾</h4><p>å¯ä»¥ä½¿ç”¨å›¾ç‰‡é“¾æ¥è‡ªå®šä¹‰ HomeÂ­page çš„èƒŒæ™¯ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">background:</span><br><span class="line">  image: https://images.unsplash.com/photo-1502790671504-542ad42d5189?auto=format&amp;fit=crop&amp;w=2560&amp;q=80</span><br></pre></td></tr></table></figure><p>æˆ–è€…ä½¿ç”¨æœ¬åœ°å›¾ç‰‡ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¯”å¦‚ <code>images</code> ï¼Œåœ¨ comÂ­pose é…ç½®é‡Œæ˜ å°„åˆ° <code>/app/public/images</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">volumes:</span><br><span class="line">  - ./homepage/images:/app/public/images</span><br></pre></td></tr></table></figure><p>ä¹‹åå°±å¯ä»¥è¿™æ ·å¼•ç”¨æœ¬åœ°çš„å›¾ç‰‡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">background:</span><br><span class="line">  image: https://images.unsplash.com/photo-1502790671504-542ad42d5189?auto=format&amp;fit=crop&amp;w=2560&amp;q=80</span><br><span class="line">  blur: sm <span class="comment">#æ¨¡ç³Šç¨‹åº¦ï¼ŒèŒƒå›´ sm, &quot;&quot;, md, xl... å‚è€ƒ https://tailwindcss.com/docs/backdrop-blur</span></span><br><span class="line">  saturate: 50 <span class="comment">#é¥±å’Œåº¦ï¼ŒèŒƒå›´ 0, 50, 100... å‚è€ƒ https://tailwindcss.com/docs/backdrop-saturate</span></span><br><span class="line">  brightness: 50 <span class="comment">#äº®åº¦ï¼ŒèŒƒå›´ 0, 50, 75... å‚è€ƒ https://tailwindcss.com/docs/backdrop-brightness</span></span><br><span class="line">  opacity: 50 <span class="comment">#ä¸é€æ˜åº¦ï¼ŒèŒƒå›´ 0-100</span></span><br></pre></td></tr></table></figure><p><strong>ç‰¹åˆ«æ³¨æ„ï¼šä¸è¦å·æ‡’ç›´æ¥æ˜ å°„ <code>/app/public</code> ç›®å½•ï¼Œä¼šæŠ¥é”™ã€‚</strong></p><p><strong>widgets.yaml</strong></p><p>homeÂ­page ä¸­ <code>widgets.yaml</code> ä¸»è¦æ˜¯ç”¨æ¥ä¿®æ”¹<strong>é¡µé¢é¡¶éƒ¨</strong>çš„ä¸€äº›å°éƒ¨ä»¶ï¼Œæ¯”å¦‚ç³»ç»ŸçŠ¶å†µã€æœç´¢æ¡†ã€å¤©æ°”ã€æ—¶é—´ã€æ¬¢è¿è¯ç­‰ç­‰ã€‚</p><p>è‡ªå·±åªç”¨åˆ°äº†ç³»ç»ŸçŠ¶å†µã€æœç´¢æ¡†å’Œæ—¶é—´ï¼Œæ‰€ä»¥åªè¯´è¯´è¿™ä»¨çš„ç”¨æ³•ã€‚</p><p>ç³»ç»ŸçŠ¶å†µä¸­å†…å­˜åªæœ‰ä¸€ä¸ªå¥½åŠï¼Œä½†ç¡¬ç›˜æœ‰å¾ˆå¤šä¸ªçš„è¯ï¼Œå°±éœ€è¦æœ‰å‡ ä¸ªç›˜å°±æ˜ å°„å‡ ä¸ªæ–‡ä»¶å¤¹è¿›å»ã€‚ä¾‹å¦‚ç¾¤æ™– NAS ä¸­ï¼Œæœ‰ <code>volume1</code> ã€ <code>volume2</code> ã€ <code>volume3</code> ä¸‰ä¸ªç¡¬ç›˜ï¼Œæ˜ å°„çš„æ—¶å€™å°±è¦éƒ½æ˜ å°„è¿›å»ï¼›æ€•å®¹å™¨å†™åæ–‡ä»¶ï¼Œå°±åŠ ä¸Š <code>:ro</code> åªè¯»ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">volumes:</span><br><span class="line">  - /volume2:/volume2:ro</span><br><span class="line">  - /volume3:/volume3:ro</span><br></pre></td></tr></table></figure><p>ä½†é…ç½®æ–‡ä»¶æ˜¯åœ¨ <code>volume1</code> ä¸­ï¼Œæ‰€ä»¥ä¸ç”¨æ˜ å°„ <code>volume1</code> ã€‚</p><p>æ—¶é—´ã€æœç´¢å®Œå…¨æ˜¯å®˜æ–¹æ–‡æ¡£çš„æ•™ç¨‹ï¼Œæˆ‘å°±ä¸å¤åˆ¶ç²˜è´´è¿‡æ¥äº†ã€‚æœ€åçš„é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">- resources:</span><br><span class="line">    label: System</span><br><span class="line">    cpu: <span class="literal">true</span></span><br><span class="line">    memory: <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">- resources:</span><br><span class="line">    label: Storage</span><br><span class="line">    expanded: <span class="literal">true</span></span><br><span class="line">    disk:</span><br><span class="line">      - /</span><br><span class="line">      - /volume2</span><br><span class="line">      - /volume3</span><br><span class="line"></span><br><span class="line">- search:</span><br><span class="line">    provider: [google, baidu]</span><br><span class="line">    target: _blank</span><br><span class="line"></span><br><span class="line">- datetime:</span><br><span class="line">    text_size: xl</span><br><span class="line">    format:</span><br><span class="line">      timeStyle: short</span><br><span class="line">      hour12: <span class="literal">false</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_61f83a276d633a416fff126c70fe1b2b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_61f83a276d633a416fff126c70fe1b2b.png"></p><h2 id="ä¸‰-sun-panelå¯¼èˆªéƒ¨ç½²-ä¸å»ºè®®ä½¿ç”¨-å­˜åœ¨bug-æ— æ³•ä¿®æ”¹å¯†ç "><a href="#ä¸‰-sun-panelå¯¼èˆªéƒ¨ç½²-ä¸å»ºè®®ä½¿ç”¨-å­˜åœ¨bug-æ— æ³•ä¿®æ”¹å¯†ç " class="headerlink" title="ä¸‰. sun-panelå¯¼èˆªéƒ¨ç½²(ä¸å»ºè®®ä½¿ç”¨ å­˜åœ¨bug æ— æ³•ä¿®æ”¹å¯†ç )"></a>ä¸‰. sun-panelå¯¼èˆªéƒ¨ç½²(ä¸å»ºè®®ä½¿ç”¨ å­˜åœ¨bug æ— æ³•ä¿®æ”¹å¯†ç )</h2><blockquote><p>å‚è€ƒï¼š<a href="https://mp.weixin.qq.com/s/WbwTVuCcoqHZkXJsBPIGFA">https://mp.weixin.qq.com/s/WbwTVuCcoqHZkXJsBPIGFA</a></p><ul><li><code>/app/conf</code>ï¼šç”¨æ¥å­˜æ”¾é…ç½®æ–‡ä»¶ã€‚</li><li><code>/app/uploads</code>ï¼šå­˜æ”¾ä¸Šä¼ çš„æ–‡ä»¶ã€‚</li><li><code>/app/database</code>ï¼šå­˜æ”¾æ•°æ®åº“æ–‡ä»¶ã€‚</li><li><code>/app/runtime</code>ï¼šå­˜æ”¾è¿è¡Œæ—¥å¿—ï¼ˆä¸å»ºè®®æŒ‚è½½ï¼‰ã€‚</li></ul><p>é»˜è®¤å¯†ç </p><ul><li>è´¦æˆ·ï¼š<a href="mailto:&#97;&#x64;&#109;&#x69;&#x6e;&#64;&#115;&#x75;&#x6e;&#46;&#99;&#x63;">&#97;&#x64;&#109;&#x69;&#x6e;&#64;&#115;&#x75;&#x6e;&#46;&#99;&#x63;</a></li><li>å¯†ç ï¼š12345678</li></ul></blockquote><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hslr/sun-panel</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:sun-panel</span><br></pre></td></tr></table></figure><p>docker-composeæ–¹å¼éƒ¨ç½²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  sun-panel:</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:sun-panel</span><br><span class="line">    container_name: sun-panel</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;3002:3002&quot;</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ./conf:/app/conf</span><br><span class="line">      - ./uploads:/app/uploads</span><br><span class="line">      - ./database:/app/database</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c0077360c400276d07c17648c643fa87.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c0077360c400276d07c17648c643fa87.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://github.com/gethomepage/homepage">https://github.com/gethomepage/homepage</a></p><p><a href="https://www.himiku.com/archives/homepage.html">https://www.himiku.com/archives/homepage.html</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu20.04éƒ¨ç½²ftpæœåŠ¡</title>
      <link href="/2024/04/11/ubuntu20.04%E9%83%A8%E7%BD%B2ftp%E6%9C%8D%E5%8A%A1/"/>
      <url>/2024/04/11/ubuntu20.04%E9%83%A8%E7%BD%B2ftp%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ubuntu20-04éƒ¨ç½²ftpæœåŠ¡"><a href="#ubuntu20-04éƒ¨ç½²ftpæœåŠ¡" class="headerlink" title="ubuntu20.04éƒ¨ç½²ftpæœåŠ¡"></a>ubuntu20.04éƒ¨ç½²ftpæœåŠ¡</h1><h2 id="ä¸€-å®‰è£…ftpæœåŠ¡å¹¶åˆ›å»ºç™»å½•ç”¨æˆ·"><a href="#ä¸€-å®‰è£…ftpæœåŠ¡å¹¶åˆ›å»ºç™»å½•ç”¨æˆ·" class="headerlink" title="ä¸€. å®‰è£…ftpæœåŠ¡å¹¶åˆ›å»ºç™»å½•ç”¨æˆ·"></a>ä¸€. å®‰è£…ftpæœåŠ¡å¹¶åˆ›å»ºç™»å½•ç”¨æˆ·</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install vsftpd</span><br></pre></td></tr></table></figure><p>æ·»åŠ ftpç”¨æˆ·</p><p>åˆ›å»ºç”¨æˆ·(ç”¨æˆ·åä¸ºmyftpï¼Œä¸åé¢vsftpdé…ç½®æ–‡ä»¶å¯¹åº”)ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -m myftp -d /home/myftp</span><br><span class="line"><span class="comment"># è‹¥ä¸æƒ³è®©è¯¥ç”¨æˆ·ç™»å½•ç³»ç»Ÿ</span></span><br><span class="line">sudo useradd -m myftp -d /home/myftp -s /bin/bash/nologin</span><br><span class="line"><span class="comment"># è®¾ç½®ç”¨æˆ·å¯†ç </span></span><br><span class="line">sudo passwd myftp</span><br></pre></td></tr></table></figure><p>åˆ›å»ºç”¨æˆ·ç›®å½•,å¹¶èµ‹äºˆæƒé™(<code>æ­¤æ­¥éª¤å¿…é¡»åœ¨åˆ›å»ºç”¨æˆ·ä¹‹å</code>)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> /home/myftp</span><br><span class="line">sudo <span class="built_in">chmod</span> 755 /home/myftp -R</span><br></pre></td></tr></table></figure><h2 id="äºŒ-ä¿®æ”¹æœåŠ¡é…ç½®"><a href="#äºŒ-ä¿®æ”¹æœåŠ¡é…ç½®" class="headerlink" title="äºŒ. ä¿®æ”¹æœåŠ¡é…ç½®"></a>äºŒ. ä¿®æ”¹æœåŠ¡é…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/vsftpd.conf</span><br></pre></td></tr></table></figure><p>é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">listen=YES</span><br><span class="line"><span class="comment">#listen_ipv6=YES      #ä½¿ç”¨IPV6</span></span><br><span class="line">anonymous_enable=NO   <span class="comment">#ä¸å…è®¸åŒ¿åè®¿é—®</span></span><br><span class="line">local_enable=YES      <span class="comment">#å…è®¸æœ¬åœ°ç”¨æˆ·ç™»å½•</span></span><br><span class="line">write_enable=YES      <span class="comment">#å…è®¸FTPå†™å…¥</span></span><br><span class="line">local_umask=022      <span class="comment">#æ–°å»ºæ–‡ä»¶å¤¹æˆ–æ–‡ä»¶çš„æƒé™é»˜è®¤ä¸º077ï¼Œå¤§å¤šæ•°ftpæœåŠ¡å™¨è®¾ç½®ä¸º022</span></span><br><span class="line"><span class="comment">#anon_upload_enable=YES  #ä¸å…è®¸åŒ¿åç”¨æˆ·ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">#anon_mkdir_write_enable=YES #ä¸å…è®¸åŒ¿åç”¨æˆ·æ–°å»ºç›®å½•</span></span><br><span class="line">dirmessage_enable=YES        <span class="comment">#è¿›å…¥ç›®å½•æ—¶å‘è¿œç¨‹ç”¨æˆ·å‘é€æ¶ˆæ¯</span></span><br><span class="line">use_localtime=YES            <span class="comment">#æ˜¾ç¤ºå¸¦æœ‰æ—¶é—´çš„ç›®å½•åˆ—è¡¨</span></span><br><span class="line">xferlog_enable=YES           <span class="comment">#æ¿€æ´»ä¸Šä¼ /ä¸‹è½½çš„æ—¥å¿—è®°å½•</span></span><br><span class="line">connect_from_port_20=YES     <span class="comment">#ç¡®ä¿ftpä¼ è¾“ç«¯å£å·ä¸º20</span></span><br><span class="line"><span class="comment">#chown_uploads=YES           #å¯å°†ä¸Šä¼ çš„åŒ¿åæ–‡ä»¶ç”±æŒ‡å®šç”¨æˆ·æ‹¥æœ‰</span></span><br><span class="line"><span class="comment">#chown_username=whoever</span></span><br><span class="line">xferlog_file=/var/log/vsftpd.log  <span class="comment">#æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤è·¯å¾„</span></span><br><span class="line">xferlog_std_format=YES           <span class="comment">#ä½¿ç”¨æ ‡å‡†åŒ–æ ¼å¼çš„æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line"><span class="comment">#idle_session_timeout=600         #ç©ºé—²ä¼šè¯è¶…æ—¶çš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">#data_connection_timeout=120     #æ•°æ®è¿æ¥è¶…æ—¶çš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">#Nopriv_user= ftpsecure         #åˆ›å»ºå”¯ä¸€çš„ç”¨æˆ·ï¼Œå°†è¯¥ç”¨æˆ·ç”¨ä½œå®Œå…¨éš”ç¦»ä¸”æ— ç‰¹æƒçš„ç”¨æˆ·</span></span><br><span class="line"><span class="comment">#async_abor_enable=YES        #è¯†åˆ«å¼‚æ­¥aborè¯·æ±‚ï¼Œå¯èƒ½ä¼šæ‹’ç»ä¸€äº›è€çš„FTPå®¢æˆ·ç«¯çš„è¿æ¥</span></span><br><span class="line"><span class="comment">#ascii_upload_enable=YES      #è®¾ç½®ASCIIä¸Šä¼ ä¸‹è½½</span></span><br><span class="line"><span class="comment">#ascii_download_enable=YES </span></span><br><span class="line">ftpd_banner=Welcome to blah FTP service. <span class="comment">#ç™»å½•æ¬¢è¿è¯­</span></span><br><span class="line"><span class="comment">#deny_email_enable=YES          #æ‹’ç»åŒ¿åemailåœ°å€çš„æ–‡ä»¶ï¼Œé˜²æ­¢æ”»å‡»</span></span><br><span class="line"><span class="comment">#banned_email_file=/etc/vsftpd.banned_emails</span></span><br><span class="line"><span class="comment">#chroot_local_user=YES           #å°†æœ¬åœ°ç”¨æˆ·é™åˆ¶åœ¨ä¸»ç›®å½•ä¸­</span></span><br><span class="line">local_root=/home/myftp             <span class="comment">#è®¾ç½®ä¸»ç›®å½•</span></span><br><span class="line">chroot_local_user=YES            <span class="comment">#é™åˆ¶ç”¨æˆ·æƒé™</span></span><br><span class="line">chroot_list_enable=YES</span><br><span class="line">chroot_list_file=/etc/vsftpd.chroot_list  <span class="comment">#å…è®¸è®¿é—®çš„ç”¨æˆ·åˆ—è¡¨æ–‡ä»¶</span></span><br><span class="line"><span class="comment">#ls_recurse_enable=YES              #æ¿€æ´»ls -ré€‰é¡¹</span></span><br><span class="line">secure_chroot_dir=/var/run/vsftpd/empty   <span class="comment">#ç©ºç›®å½•åç§°</span></span><br><span class="line">pam_service_name=myftp                   <span class="comment">#åˆ›å»ºçš„ftpç”¨æˆ·å</span></span><br><span class="line"><span class="comment">#rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem  #sslçš„RSAè¯ä¹¦ä½ç½®</span></span><br><span class="line"><span class="comment">#rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key #sslçš„RSAç§˜é’¥ä½ç½®</span></span><br><span class="line"><span class="comment">#ssl_enable=NO                          #å¼€å¯sslåŠ å¯†</span></span><br><span class="line"><span class="comment">#utf8_filesystem=YES                    #ä½¿ç”¨utf8æ–‡ä»¶ç³»ç»Ÿ</span></span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹ä¸ºé…ç½®åçš„vsftpd.confæ–‡ä»¶å†…å®¹ï¼Œ#ä¸ºæ³¨é‡Šå†…å®¹ï¼Œå·²åˆ é™¤ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">listen=YES</span><br><span class="line">anonymous_enable=NO</span><br><span class="line">local_enable=YES</span><br><span class="line">write_enable=YES</span><br><span class="line">dirmessage_enable=YES</span><br><span class="line">use_localtime=YES</span><br><span class="line">xferlog_enable=YES</span><br><span class="line">connect_from_port_20=YES</span><br><span class="line">xferlog_file=/var/log/vsftpd.log</span><br><span class="line">xferlog_std_format=YES</span><br><span class="line">ftpd_banner=Welcome to blah FTP service.</span><br><span class="line">local_root=/home/myftp</span><br><span class="line">chroot_local_user=YES</span><br><span class="line">chroot_list_enable=YES</span><br><span class="line">chroot_list_file=/etc/vsftpd.chroot_list</span><br><span class="line">secure_chroot_dir=/var/run/vsftpd/empty</span><br><span class="line">pam_service_name=myftp</span><br><span class="line">rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem</span><br><span class="line">rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š</p><ul><li>local_root=/home/myftp     //è¯¥ç›®å½•ä¸ºä¹‹å‰åˆ›å»ºçš„ç”¨æˆ·ç›®å½•</li><li>pam_service_name=myftp   //é»˜è®¤ä¸ºvsftpdï¼Œéœ€è¦æ›´æ”¹ä¸ºåˆ›å»ºçš„ftpç”¨æˆ·å</li><li>åˆ›å»ºæ–‡ä»¶vsftpd.chroot_list</li><li>sudo vi /etc/vsftpd.chroot_list   å¹¶å°†ä¹‹å‰åˆ›å»ºçš„ç”¨æˆ·å(myftp)æ·»åŠ åˆ°è¯¥æ–‡ä»¶ä¸­ã€‚</li></ul><p>é‡æ–°å¯åŠ¨æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart vsftpd</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5fd0c9223e7d46a74c05bea17f930c28.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5fd0c9223e7d46a74c05bea17f930c28.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/fangye945a/article/details/85109404">https://blog.csdn.net/fangye945a/article/details/85109404</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxéƒ¨ç½²hexo</title>
      <link href="/2024/04/11/linux%E9%83%A8%E7%BD%B2hexo/"/>
      <url>/2024/04/11/linux%E9%83%A8%E7%BD%B2hexo/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="linuxéƒ¨ç½²hexo"><a href="#linuxéƒ¨ç½²hexo" class="headerlink" title="linuxéƒ¨ç½²hexo"></a>linuxéƒ¨ç½²hexo</h1><h2 id="ä¸€-å®‰è£…node-js"><a href="#ä¸€-å®‰è£…node-js" class="headerlink" title="ä¸€. å®‰è£…node.js"></a>ä¸€. å®‰è£…node.js</h2><h3 id="node-jsä¸‹è½½é“¾æ¥"><a href="#node-jsä¸‹è½½é“¾æ¥" class="headerlink" title="node.jsä¸‹è½½é“¾æ¥"></a>node.jsä¸‹è½½é“¾æ¥</h3><blockquote><p><a href="https://nodejs.org/dist/v16.13.1/node-v16.13.1-linux-x64.tar.xz">èµ„æºä¸‹è½½é“¾æ¥ | &gt;</a></p></blockquote><h2 id="äºŒ-é…ç½®node-js"><a href="#äºŒ-é…ç½®node-js" class="headerlink" title="äºŒ. é…ç½®node.js"></a>äºŒ. é…ç½®node.js</h2><p>node.jsä¸‹è½½å®Œæˆå</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /usr/local/node/</span><br><span class="line"><span class="built_in">cd</span> /usr/local/node/</span><br><span class="line">æ­¤æ—¶å°†å®‰è£…åŒ…ä¸Šä¼ åˆ°æ­¤ç›®å½•åè§£å‹</span><br><span class="line">rz </span><br><span class="line">tar -xvf node-v16.13.1-linux-x64.tar.xz</span><br></pre></td></tr></table></figure><p>é…ç½®ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®ç¯å¢ƒå˜é‡ </span></span><br><span class="line">vim /etc/profile</span><br><span class="line"><span class="comment"># æ·»åŠ å¦‚ä¸‹</span></span><br><span class="line"><span class="comment"># Nodejs</span></span><br><span class="line"><span class="built_in">export</span> PATH=/usr/local/node/node-v16.13.1-linux-x64/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">source</span>  /etc/profile</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶nodejså®‰è£…å®Œæˆã€‚</p><h2 id="ä¸‰-å®‰è£…cnpm"><a href="#ä¸‰-å®‰è£…cnpm" class="headerlink" title="ä¸‰. å®‰è£…cnpm"></a>ä¸‰. å®‰è£…cnpm</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼ŒéªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</span></span><br><span class="line"><span class="comment"># å®‰è£…ä¸€ä¸ªnpmçš„åŠ å¼ºç‰ˆ</span></span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line"><span class="comment"># è®¾ç½®ä»“åº“ä¸ºnpmä»“åº“</span></span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmjs.org</span><br><span class="line"><span class="comment"># ç»­å®‰è£…å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œå› ä¸ºcpnmç‰ˆæœ¬å¤ªé«˜çš„åŸå› å¦‚æœå‡ºç°é—®é¢˜çš„å¯ä»¥å¸è½½è¿™ä¸ªæœ€æ–°ç‰ˆæœ¬å®‰è£…ä¸€ä¸ªæŒ‡å®šç‰ˆæœ¬</span></span><br><span class="line">çš„(npmæ˜¯ä»å›½å¤–æ‹‰åŒ… cnpmå›½å†…)</span><br><span class="line">npm uninstall -g cnpm</span><br><span class="line"><span class="comment"># å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼š7.1.0</span></span><br><span class="line">npm install cnpm@7.1.0 -g</span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">[root@localhost ~]<span class="comment"># npm -version</span></span><br><span class="line">8.1.2</span><br><span class="line">[root@localhost ~]<span class="comment"># npx -v</span></span><br><span class="line">8.1.2</span><br><span class="line">[root@localhost bin]<span class="comment"># npm version</span></span><br></pre></td></tr></table></figure><h2 id="å››-å®‰è£…hexo"><a href="#å››-å®‰è£…hexo" class="headerlink" title="å››. å®‰è£…hexo"></a>å››. å®‰è£…hexo</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ­¤æ—¶å†ä½¿ç”¨cnpmå®‰è£…nodejså³å¯</span></span><br><span class="line"><span class="comment"># å®‰è£…hexo</span></span><br><span class="line">cnpm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>å¤‡æ³¨ï¼šå°†äº‹å…ˆåœ¨windowså‡†å¤‡å¥½çš„å®‰è£…åšå®¢å‹ç¼©åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨è§£å‹å† hexo clean &amp;&amp; hexo g &amp;&amp; hexo så³å¯ã€‚</p><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://blog.csdn.net/weixin_45561352/article/details/122109731">linuxæ­å»ºhexoä¸ªäººåšå®¢_linux hexoåšå®¢-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fastgptå¯¹æ¥one-apiéƒ¨ç½²</title>
      <link href="/2024/04/09/fastgpt%E5%AF%B9%E6%8E%A5one-api%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/09/fastgpt%E5%AF%B9%E6%8E%A5one-api%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="fastgptå¯¹æ¥one-apiéƒ¨ç½²"><a href="#fastgptå¯¹æ¥one-apiéƒ¨ç½²" class="headerlink" title="fastgptå¯¹æ¥one-apiéƒ¨ç½²"></a>fastgptå¯¹æ¥one-apiéƒ¨ç½²</h1><blockquote><p>é»˜è®¤å¯†é’¥ï¼š<strong>root/1234</strong></p></blockquote><h2 id="one-apiéƒ¨ç½²"><a href="#one-apiéƒ¨ç½²" class="headerlink" title="one-apiéƒ¨ç½²"></a>one-apiéƒ¨ç½²</h2><blockquote><p><a href="http://sunlight.zznnwn.cloudns.biz/2024/04/09/one-api%E9%83%A8%E7%BD%B2/">éƒ¨ç½²é“¾æ¥ | &gt;</a></p></blockquote><h2 id="ä¸€-fastgptä½¿ç”¨docker-composeæ–¹å¼éƒ¨ç½²"><a href="#ä¸€-fastgptä½¿ç”¨docker-composeæ–¹å¼éƒ¨ç½²" class="headerlink" title="ä¸€ fastgptä½¿ç”¨docker-composeæ–¹å¼éƒ¨ç½²"></a>ä¸€ fastgptä½¿ç”¨docker-composeæ–¹å¼éƒ¨ç½²</h2><h3 id="é•œåƒå¯é€‰"><a href="#é•œåƒå¯é€‰" class="headerlink" title="é•œåƒå¯é€‰"></a>é•œåƒå¯é€‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:pgvector-v0.5.0</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:mongo5.0.18</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:fastgptv4.7</span><br></pre></td></tr></table></figure><h3 id="å®˜ç½‘éƒ¨ç½²æ–¹å¼ï¼š"><a href="#å®˜ç½‘éƒ¨ç½²æ–¹å¼ï¼š" class="headerlink" title="å®˜ç½‘éƒ¨ç½²æ–¹å¼ï¼š"></a>å®˜ç½‘éƒ¨ç½²æ–¹å¼ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> fastgpt</span><br><span class="line"><span class="built_in">cd</span> fastgpt</span><br><span class="line">curl -O https://raw.githubusercontent.com/labring/FastGPT/main/files/deploy/fastgpt/docker-compose.yml</span><br><span class="line">curl -O https://raw.githubusercontent.com/labring/FastGPT/main/projects/app/data/config.json</span><br></pre></td></tr></table></figure><h2 id="äºŒ-æœ¬æ–‡éƒ¨ç½²"><a href="#äºŒ-æœ¬æ–‡éƒ¨ç½²" class="headerlink" title="äºŒ æœ¬æ–‡éƒ¨ç½²"></a>äºŒ æœ¬æ–‡éƒ¨ç½²</h2><blockquote><p>one-apiä¸fastgptåˆ†å¼€éƒ¨ç½² å…ˆéƒ¨ç½²one apiå†éƒ¨ç½²fastgptå³å¦‚ä¸‹</p></blockquote><h3 id="docker-compose-ymlæ–‡ä»¶"><a href="#docker-compose-ymlæ–‡ä»¶" class="headerlink" title="docker-compose.ymlæ–‡ä»¶"></a>docker-compose.ymlæ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®åº“çš„é»˜è®¤è´¦å·å’Œå¯†ç ä»…é¦–æ¬¡è¿è¡Œæ—¶è®¾ç½®æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment"># å¦‚æœä¿®æ”¹äº†è´¦å·å¯†ç ï¼Œè®°å¾—æ”¹æ•°æ®åº“å’Œé¡¹ç›®è¿æ¥å‚æ•°ï¼Œåˆ«åªæ”¹ä¸€å¤„~</span></span><br><span class="line"><span class="comment"># è¯¥é…ç½®æ–‡ä»¶åªæ˜¯ç»™å¿«é€Ÿå¯åŠ¨ï¼Œæµ‹è¯•ä½¿ç”¨ã€‚æ­£å¼ä½¿ç”¨ï¼Œè®°å¾—åŠ¡å¿…ä¿®æ”¹è´¦å·å¯†ç ï¼Œä»¥åŠè°ƒæ•´åˆé€‚çš„çŸ¥è¯†åº“å‚æ•°ï¼Œå…±äº«å†…å­˜ç­‰ã€‚</span></span><br><span class="line"></span><br><span class="line">version: <span class="string">&#x27;3.3&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  pg:</span><br><span class="line">    image: ankane/pgvector:v0.5.0 <span class="comment"># git</span></span><br><span class="line">    <span class="comment"># image: registry.cn-hangzhou.aliyuncs.com/fastgpt/pgvector:v0.5.0 # é˜¿é‡Œäº‘</span></span><br><span class="line">    container_name: pg</span><br><span class="line">    restart: always</span><br><span class="line">    ports: <span class="comment"># ç”Ÿäº§ç¯å¢ƒå»ºè®®ä¸è¦æš´éœ²</span></span><br><span class="line">      - 5432:5432</span><br><span class="line">    networks:</span><br><span class="line">      - fastgpt</span><br><span class="line">    environment:</span><br><span class="line">      <span class="comment"># è¿™é‡Œçš„é…ç½®åªæœ‰é¦–æ¬¡è¿è¡Œç”Ÿæ•ˆã€‚ä¿®æ”¹åï¼Œé‡å¯é•œåƒæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚éœ€è¦æŠŠæŒä¹…åŒ–æ•°æ®åˆ é™¤å†é‡å¯ï¼Œæ‰æœ‰æ•ˆæœ</span></span><br><span class="line">      - POSTGRES_USER=username</span><br><span class="line">      - POSTGRES_PASSWORD=password</span><br><span class="line">      - POSTGRES_DB=postgres</span><br><span class="line">    volumes:</span><br><span class="line">      - ./pg/data:/var/lib/postgresql/data</span><br><span class="line">  mongo:</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/fastgpt/mongo:5.0.18</span><br><span class="line">    container_name: mongo</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - 27017:27017</span><br><span class="line">    networks:</span><br><span class="line">      - fastgpt</span><br><span class="line">    <span class="built_in">command</span>: mongod --keyFile /data/mongodb.key --replSet rs0</span><br><span class="line">    environment:</span><br><span class="line">      - MONGO_INITDB_ROOT_USERNAME=myusername</span><br><span class="line">      - MONGO_INITDB_ROOT_PASSWORD=mypassword</span><br><span class="line">    volumes:</span><br><span class="line">      - ./mongo/data:/data/db</span><br><span class="line">    entrypoint:</span><br><span class="line">      - bash</span><br><span class="line">      - -c</span><br><span class="line">      - |</span><br><span class="line">        openssl rand -<span class="built_in">base64</span> 128 &gt; /data/mongodb.key</span><br><span class="line">        <span class="built_in">chmod</span> 400 /data/mongodb.key</span><br><span class="line">        <span class="built_in">chown</span> 999:999 /data/mongodb.key</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&#x27;const isInited = rs.status().ok === 1</span></span><br><span class="line"><span class="string">        if(!isInited)&#123;</span></span><br><span class="line"><span class="string">          rs.initiate(&#123;</span></span><br><span class="line"><span class="string">              _id: &quot;rs0&quot;,</span></span><br><span class="line"><span class="string">              members: [</span></span><br><span class="line"><span class="string">                  &#123; _id: 0, host: &quot;mongo:27017&quot; &#125;</span></span><br><span class="line"><span class="string">              ]</span></span><br><span class="line"><span class="string">          &#125;)</span></span><br><span class="line"><span class="string">        &#125;&#x27;</span> &gt; /data/initReplicaSet.js</span><br><span class="line">        <span class="comment"># å¯åŠ¨MongoDBæœåŠ¡</span></span><br><span class="line">        <span class="built_in">exec</span> docker-entrypoint.sh <span class="string">&quot;$<span class="variable">$@</span>&quot;</span> &amp;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç­‰å¾…MongoDBæœåŠ¡å¯åŠ¨</span></span><br><span class="line">        <span class="keyword">until</span> mongo -u myusername -p mypassword --authenticationDatabase admin --<span class="built_in">eval</span> <span class="string">&quot;print(&#x27;waited for connection&#x27;)&quot;</span> &gt; /dev/null 2&gt;&amp;1; <span class="keyword">do</span></span><br><span class="line">          <span class="built_in">echo</span> <span class="string">&quot;Waiting for MongoDB to start...&quot;</span></span><br><span class="line">          <span class="built_in">sleep</span> 2</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‰§è¡Œåˆå§‹åŒ–å‰¯æœ¬é›†çš„è„šæœ¬</span></span><br><span class="line">        mongo -u myusername -p mypassword --authenticationDatabase admin /data/initReplicaSet.js</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç­‰å¾…docker-entrypoint.shè„šæœ¬æ‰§è¡Œçš„MongoDBæœåŠ¡è¿›ç¨‹</span></span><br><span class="line">        <span class="built_in">wait</span> $$!</span><br><span class="line">  fastgpt:</span><br><span class="line">    container_name: fastgpt</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:v4.7 <span class="comment"># git</span></span><br><span class="line">    <span class="comment"># image: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:v4.7 # é˜¿é‡Œäº‘</span></span><br><span class="line">    ports:</span><br><span class="line">      - 30001:3000</span><br><span class="line">    networks:</span><br><span class="line">      - fastgpt</span><br><span class="line">    depends_on:</span><br><span class="line">      - mongo</span><br><span class="line">      - pg</span><br><span class="line">    restart: always</span><br><span class="line">    environment:</span><br><span class="line">      <span class="comment"># root å¯†ç ï¼Œç”¨æˆ·åä¸º: rootã€‚å¦‚æœéœ€è¦ä¿®æ”¹ root å¯†ç ï¼Œç›´æ¥ä¿®æ”¹è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œå¹¶é‡å¯å³å¯ã€‚</span></span><br><span class="line">      - DEFAULT_ROOT_PSW=1234</span><br><span class="line">      <span class="comment"># AIæ¨¡å‹çš„APIåœ°å€å“¦ã€‚åŠ¡å¿…åŠ  /v1ã€‚è¿™é‡Œé»˜è®¤å¡«å†™äº†OneApiçš„è®¿é—®åœ°å€ã€‚</span></span><br><span class="line">      - OPENAI_BASE_URL=http://10.0.0.10:3000/v1                     <span class="comment">#(æ­¤åœ°å€ä¸ºoneapiåœ°å€+/v1)</span></span><br><span class="line">      <span class="comment"># AIæ¨¡å‹çš„API Keyã€‚ï¼ˆè¿™é‡Œé»˜è®¤å¡«å†™äº†OneAPIçš„å¿«é€Ÿé»˜è®¤keyï¼Œæµ‹è¯•é€šåï¼ŒåŠ¡å¿…åŠæ—¶ä¿®æ”¹ï¼‰</span></span><br><span class="line">      - CHAT_API_KEY=sk-z02Gt0o6cWhTS6cbFfbgbggb9d42cF622Bc5e5c471a  <span class="comment">#(æ­¤keyä¸ºone-apiç”Ÿæˆçš„ä»¤ç‰Œ)</span></span><br><span class="line">      <span class="comment"># æ•°æ®åº“æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">      - DB_MAX_LINK=30</span><br><span class="line">      <span class="comment"># ç™»å½•å‡­è¯å¯†é’¥</span></span><br><span class="line">      - TOKEN_KEY=any</span><br><span class="line">      <span class="comment"># rootçš„å¯†é’¥ï¼Œå¸¸ç”¨äºå‡çº§æ—¶å€™çš„åˆå§‹åŒ–è¯·æ±‚</span></span><br><span class="line">      - ROOT_KEY=root_key</span><br><span class="line">      <span class="comment"># æ–‡ä»¶é˜…è¯»åŠ å¯†</span></span><br><span class="line">      - FILE_TOKEN_KEY=filetoken</span><br><span class="line">      <span class="comment"># MongoDB è¿æ¥å‚æ•°. ç”¨æˆ·åmyusername,å¯†ç mypasswordã€‚</span></span><br><span class="line">      - MONGODB_URI=mongodb://myusername:mypassword@mongo:27017/fastgpt?authSource=admin</span><br><span class="line">      <span class="comment"># pg è¿æ¥å‚æ•°</span></span><br><span class="line">      - PG_URL=postgresql://username:password@pg:5432/postgres</span><br><span class="line">    volumes:</span><br><span class="line">      - ./config.json:/app/data/config.json</span><br><span class="line">      - ./fastgpt/tmp:/app/tmp</span><br><span class="line">  <span class="comment"># mysql:</span></span><br><span class="line">  <span class="comment">#   image: mysql:8.0.36</span></span><br><span class="line">  <span class="comment">#   container_name: mysql</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#   ports:</span></span><br><span class="line">  <span class="comment">#     - 3306:3306</span></span><br><span class="line">  <span class="comment">#   networks:</span></span><br><span class="line">  <span class="comment">#     - fastgpt</span></span><br><span class="line">  <span class="comment">#   command: --default-authentication-plugin=mysql_native_password</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     # é»˜è®¤rootå¯†ç ï¼Œä»…é¦–æ¬¡è¿è¡Œæœ‰æ•ˆ</span></span><br><span class="line">  <span class="comment">#     MYSQL_ROOT_PASSWORD: oneapimmysql</span></span><br><span class="line">  <span class="comment">#     MYSQL_DATABASE: oneapi</span></span><br><span class="line">  <span class="comment">#   volumes:</span></span><br><span class="line">  <span class="comment">#     - ./mysql:/var/lib/mysql</span></span><br><span class="line">  <span class="comment"># oneapi:</span></span><br><span class="line">  <span class="comment">#   container_name: oneapi</span></span><br><span class="line">  <span class="comment">#   image: ghcr.io/songquanpeng/one-api:latest</span></span><br><span class="line">  <span class="comment">#   ports:</span></span><br><span class="line">  <span class="comment">#     - 3001:3000</span></span><br><span class="line">  <span class="comment">#   depends_on:</span></span><br><span class="line">  <span class="comment">#     - mysql</span></span><br><span class="line">  <span class="comment">#   networks:</span></span><br><span class="line">  <span class="comment">#     - fastgpt</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     # mysql è¿æ¥å‚æ•°</span></span><br><span class="line">  <span class="comment">#     - SQL_DSN=root:oneapimmysql@tcp(mysql:3306)/oneapi</span></span><br><span class="line">  <span class="comment">#     # ç™»å½•å‡­è¯åŠ å¯†å¯†é’¥</span></span><br><span class="line">  <span class="comment">#     - SESSION_SECRET=oneapikey</span></span><br><span class="line">  <span class="comment">#     # å†…å­˜ç¼“å­˜</span></span><br><span class="line">  <span class="comment">#     - MEMORY_CACHE_ENABLED=true</span></span><br><span class="line">  <span class="comment">#     # å¯åŠ¨èšåˆæ›´æ–°ï¼Œå‡å°‘æ•°æ®äº¤äº’é¢‘ç‡</span></span><br><span class="line">  <span class="comment">#     - BATCH_UPDATE_ENABLED=true</span></span><br><span class="line">  <span class="comment">#     # èšåˆæ›´æ–°æ—¶é•¿</span></span><br><span class="line">  <span class="comment">#     - BATCH_UPDATE_INTERVAL=10</span></span><br><span class="line">  <span class="comment">#     # åˆå§‹åŒ–çš„ root å¯†é’¥ï¼ˆå»ºè®®éƒ¨ç½²å®Œåæ›´æ”¹ï¼Œå¦åˆ™å®¹æ˜“æ³„éœ²ï¼‰</span></span><br><span class="line">  <span class="comment">#     - INITIAL_ROOT_TOKEN=fastgpt</span></span><br><span class="line">  <span class="comment">#   volumes:</span></span><br><span class="line">  <span class="comment">#     - ./oneapi:/data</span></span><br><span class="line">networks:</span><br><span class="line">  fastgpt:</span><br></pre></td></tr></table></figure><h4 id="é˜¿é‡Œé€šä¹‰åƒæ–‡ç‰ˆconfig-jsoné…ç½®"><a href="#é˜¿é‡Œé€šä¹‰åƒæ–‡ç‰ˆconfig-jsoné…ç½®" class="headerlink" title="é˜¿é‡Œé€šä¹‰åƒæ–‡ç‰ˆconfig.jsoné…ç½®"></a>é˜¿é‡Œé€šä¹‰åƒæ–‡ç‰ˆconfig.jsoné…ç½®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;feConfigs&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;lafEnv&quot;</span>: <span class="string">&quot;https://laf.dev&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;systemEnv&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;openapiPrefix&quot;</span>: <span class="string">&quot;fastgpt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vectorMaxProcess&quot;</span>: 15,</span><br><span class="line">    <span class="string">&quot;qaMaxProcess&quot;</span>: 15,</span><br><span class="line">    <span class="string">&quot;pgHNSWEfSearch&quot;</span>: 100</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;llmModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-turbo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;é€šä¹‰åƒé—®&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 16000,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 13000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-plus&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;qwen-plus&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 125000,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 100000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-max&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;qwen-max&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 128000,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 100000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;vectorModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-max-longcontext&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;qwen-max-longcontext&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;defaultToken&quot;</span>: 512,</span><br><span class="line">      <span class="string">&quot;maxToken&quot;</span>: 3000,</span><br><span class="line">      <span class="string">&quot;weight&quot;</span>: 100,</span><br><span class="line">      <span class="string">&quot;dbConfig&quot;</span>: &#123;&#125;,</span><br><span class="line">      <span class="string">&quot;queryConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;reRankModels&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;audioSpeechModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-1.8b-chat&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;qwen-1.8b-chat&quot;</span>,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;voices&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Alloy&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;alloy&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Alloy&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Echo&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;echo&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Echo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Fable&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;fable&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Fable&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Onyx&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;onyx&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Onyx&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Nova&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;nova&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Nova&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Shimmer&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;shimmer&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Shimmer&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;whisperModel&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;model&quot;</span>: <span class="string">&quot;whisper-1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Whisper1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;charsPointsPrice&quot;</span>: 0</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="openai-chatgptç‰ˆconfigé…ç½®"><a href="#openai-chatgptç‰ˆconfigé…ç½®" class="headerlink" title="openai chatgptç‰ˆconfigé…ç½®"></a>openai chatgptç‰ˆconfigé…ç½®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;feConfigs&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;lafEnv&quot;</span>: <span class="string">&quot;https://laf.dev&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;systemEnv&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;openapiPrefix&quot;</span>: <span class="string">&quot;fastgpt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vectorMaxProcess&quot;</span>: 15,</span><br><span class="line">    <span class="string">&quot;qaMaxProcess&quot;</span>: 15,</span><br><span class="line">    <span class="string">&quot;pgHNSWEfSearch&quot;</span>: 100</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;llmModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 16000,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 13000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;gpt-4-0125-preview&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;gpt-4-turbo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 125000,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 100000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;gpt-4-vision-preview&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;gpt-4-vision&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 128000,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 100000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;vectorModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;text-embedding-ada-002&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Embedding-2&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;defaultToken&quot;</span>: 512,</span><br><span class="line">      <span class="string">&quot;maxToken&quot;</span>: 3000,</span><br><span class="line">      <span class="string">&quot;weight&quot;</span>: 100,</span><br><span class="line">      <span class="string">&quot;dbConfig&quot;</span>: &#123;&#125;,</span><br><span class="line">      <span class="string">&quot;queryConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;reRankModels&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;audioSpeechModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;tts-1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;OpenAI TTS1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;voices&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Alloy&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;alloy&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Alloy&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Echo&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;echo&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Echo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Fable&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;fable&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Fable&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Onyx&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;onyx&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Onyx&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Nova&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;nova&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Nova&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Shimmer&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;shimmer&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Shimmer&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;whisperModel&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;model&quot;</span>: <span class="string">&quot;whisper-1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Whisper1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;charsPointsPrice&quot;</span>: 0</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ollamaæœ¬åœ°å¤§æ¨¡å‹+å‘é‡æ¨¡å‹ç‰ˆ</strong></p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;feConfigs&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;lafEnv&quot;</span><span class="punctuation">:</span> <span class="string">&quot;https://laf.dev&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;systemEnv&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;openapiPrefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fastgpt&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;vectorMaxProcess&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;qaMaxProcess&quot;</span><span class="punctuation">:</span> <span class="number">15</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;pgHNSWEfSearch&quot;</span><span class="punctuation">:</span> <span class="number">100</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;llmModels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;qwen2:0.5b&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;qwen2:0.5b&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxContext&quot;</span><span class="punctuation">:</span> <span class="number">16000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/imgs/model/openai.svg&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxResponse&quot;</span><span class="punctuation">:</span> <span class="number">4000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;quoteMaxToken&quot;</span><span class="punctuation">:</span> <span class="number">13000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxTemperature&quot;</span><span class="punctuation">:</span> <span class="number">1.2</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;charsPointsPrice&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;censor&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vision&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;datasetProcess&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInClassify&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInExtractFields&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInToolCall&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInQueryExtension&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;toolChoice&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;functionCall&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;customCQPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;customExtractPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;defaultSystemChatPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;defaultConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;qwen-plus&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;qwen-plus&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/imgs/model/openai.svg&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxContext&quot;</span><span class="punctuation">:</span> <span class="number">125000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxResponse&quot;</span><span class="punctuation">:</span> <span class="number">4000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;quoteMaxToken&quot;</span><span class="punctuation">:</span> <span class="number">100000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxTemperature&quot;</span><span class="punctuation">:</span> <span class="number">1.2</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;charsPointsPrice&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;censor&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vision&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;datasetProcess&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInClassify&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInExtractFields&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInToolCall&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInQueryExtension&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;toolChoice&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;functionCall&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;customCQPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;customExtractPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;defaultSystemChatPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;defaultConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;qwen-max&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;qwen-max&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/imgs/model/openai.svg&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxContext&quot;</span><span class="punctuation">:</span> <span class="number">128000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxResponse&quot;</span><span class="punctuation">:</span> <span class="number">4000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;quoteMaxToken&quot;</span><span class="punctuation">:</span> <span class="number">100000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxTemperature&quot;</span><span class="punctuation">:</span> <span class="number">1.2</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;charsPointsPrice&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;censor&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vision&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;datasetProcess&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInClassify&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInExtractFields&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInToolCall&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;usedInQueryExtension&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;toolChoice&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;functionCall&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">false</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;customCQPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;customExtractPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;defaultSystemChatPrompt&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;defaultConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;vectorModels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nomic-embed-text:latest&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nomic-embed-text:latest&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;avatar&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/imgs/model/openai.svg&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;charsPointsPrice&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;defaultToken&quot;</span><span class="punctuation">:</span> <span class="number">512</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;maxToken&quot;</span><span class="punctuation">:</span> <span class="number">3000</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;weight&quot;</span><span class="punctuation">:</span> <span class="number">100</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;dbConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;queryConfig&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;reRankModels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;audioSpeechModels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">      <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;qwen-1.8b-chat&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;qwen-1.8b-chat&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;charsPointsPrice&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;voices&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Alloy&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;alloy&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;bufferId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openai-Alloy&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Echo&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;echo&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;bufferId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openai-Echo&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Fable&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;fable&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;bufferId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openai-Fable&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Onyx&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;onyx&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;bufferId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openai-Onyx&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Nova&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nova&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;bufferId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openai-Nova&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">          <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;label&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Shimmer&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;value&quot;</span><span class="punctuation">:</span> <span class="string">&quot;shimmer&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;bufferId&quot;</span><span class="punctuation">:</span> <span class="string">&quot;openai-Shimmer&quot;</span></span><br><span class="line">          <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">      <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;whisperModel&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="string">&quot;whisper-1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Whisper1&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;charsPointsPrice&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="fastgptå¯åŠ¨"><a href="#fastgptå¯åŠ¨" class="headerlink" title="fastgptå¯åŠ¨"></a>fastgptå¯åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-æ‰©å±•ä¸fastgptå¯¹æ¥ollamaæœ¬åœ°å¤§æ¨¡å‹"><a href="#ä¸‰-æ‰©å±•ä¸fastgptå¯¹æ¥ollamaæœ¬åœ°å¤§æ¨¡å‹" class="headerlink" title="ä¸‰ æ‰©å±•ä¸fastgptå¯¹æ¥ollamaæœ¬åœ°å¤§æ¨¡å‹"></a>ä¸‰ æ‰©å±•ä¸fastgptå¯¹æ¥ollamaæœ¬åœ°å¤§æ¨¡å‹</h3><h4 id="one-apiä¸fastgptåœ¨ä¸€ä¸ªéƒ¨ç½²æ–‡ä»¶ä¸­é›†æˆï¼ˆæ¨èä½¿ç”¨æ­¤ç§ï¼‰"><a href="#one-apiä¸fastgptåœ¨ä¸€ä¸ªéƒ¨ç½²æ–‡ä»¶ä¸­é›†æˆï¼ˆæ¨èä½¿ç”¨æ­¤ç§ï¼‰" class="headerlink" title="one-apiä¸fastgptåœ¨ä¸€ä¸ªéƒ¨ç½²æ–‡ä»¶ä¸­é›†æˆï¼ˆæ¨èä½¿ç”¨æ­¤ç§ï¼‰"></a>one-apiä¸fastgptåœ¨ä¸€ä¸ªéƒ¨ç½²æ–‡ä»¶ä¸­é›†æˆï¼ˆæ¨èä½¿ç”¨æ­¤ç§ï¼‰</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">pg:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">ankane/pgvector:v0.5.0</span> <span class="comment"># git</span></span><br><span class="line">    <span class="comment"># image: registry.cn-hangzhou.aliyuncs.com/fastgpt/pgvector:v0.5.0 # é˜¿é‡Œäº‘</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">pg</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span> <span class="comment"># ç”Ÿäº§ç¯å¢ƒå»ºè®®ä¸è¦æš´éœ²</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5432</span><span class="string">:5432</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fastgpt</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="comment"># è¿™é‡Œçš„é…ç½®åªæœ‰é¦–æ¬¡è¿è¡Œç”Ÿæ•ˆã€‚ä¿®æ”¹åï¼Œé‡å¯é•œåƒæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚éœ€è¦æŠŠæŒä¹…åŒ–æ•°æ®åˆ é™¤å†é‡å¯ï¼Œæ‰æœ‰æ•ˆæœ</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_USER=username</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_PASSWORD=password</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_DB=postgres</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./pg/data:/var/lib/postgresql/data</span></span><br><span class="line">  <span class="attr">mongo:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/fastgpt/mongo:5.0.18</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mongo</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">27017</span><span class="string">:27017</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fastgpt</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">mongod</span> <span class="string">--keyFile</span> <span class="string">/data/mongodb.key</span> <span class="string">--replSet</span> <span class="string">rs0</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MONGO_INITDB_ROOT_USERNAME=myusername</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MONGO_INITDB_ROOT_PASSWORD=mypassword</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./mongo/data:/data/db</span></span><br><span class="line">    <span class="attr">entrypoint:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">bash</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">|</span></span><br><span class="line"><span class="string">        openssl rand -base64 128 &gt; /data/mongodb.key</span></span><br><span class="line"><span class="string">        chmod 400 /data/mongodb.key</span></span><br><span class="line"><span class="string">        chown 999:999 /data/mongodb.key</span></span><br><span class="line"><span class="string">        echo &#x27;const isInited = rs.status().ok === 1</span></span><br><span class="line"><span class="string">        if(!isInited)&#123;</span></span><br><span class="line"><span class="string">          rs.initiate(&#123;</span></span><br><span class="line"><span class="string">              _id: &quot;rs0&quot;,</span></span><br><span class="line"><span class="string">              members: [</span></span><br><span class="line"><span class="string">                  &#123; _id: 0, host: &quot;mongo:27017&quot; &#125;</span></span><br><span class="line"><span class="string">              ]</span></span><br><span class="line"><span class="string">          &#125;)</span></span><br><span class="line"><span class="string">        &#125;&#x27; &gt; /data/initReplicaSet.js</span></span><br><span class="line"><span class="string">        # å¯åŠ¨MongoDBæœåŠ¡</span></span><br><span class="line"><span class="string">        exec docker-entrypoint.sh &quot;$$@&quot; &amp;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">        <span class="comment"># ç­‰å¾…MongoDBæœåŠ¡å¯åŠ¨</span></span><br><span class="line">        <span class="string">until</span> <span class="string">mongo</span> <span class="string">-u</span> <span class="string">myusername</span> <span class="string">-p</span> <span class="string">mypassword</span> <span class="string">--authenticationDatabase</span> <span class="string">admin</span> <span class="string">--eval</span> <span class="string">&quot;print(&#x27;waited for connection&#x27;)&quot;</span> <span class="string">&gt;</span> <span class="string">/dev/null</span> <span class="number">2</span><span class="string">&gt;&amp;1;</span> <span class="string">do</span></span><br><span class="line">          <span class="string">echo</span> <span class="string">&quot;Waiting for MongoDB to start...&quot;</span></span><br><span class="line">          <span class="string">sleep</span> <span class="number">2</span></span><br><span class="line">        <span class="string">done</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‰§è¡Œåˆå§‹åŒ–å‰¯æœ¬é›†çš„è„šæœ¬</span></span><br><span class="line">        <span class="string">mongo</span> <span class="string">-u</span> <span class="string">myusername</span> <span class="string">-p</span> <span class="string">mypassword</span> <span class="string">--authenticationDatabase</span> <span class="string">admin</span> <span class="string">/data/initReplicaSet.js</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç­‰å¾…docker-entrypoint.shè„šæœ¬æ‰§è¡Œçš„MongoDBæœåŠ¡è¿›ç¨‹</span></span><br><span class="line">        <span class="string">wait</span> <span class="string">$$!</span></span><br><span class="line">  <span class="attr">fastgpt:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">fastgpt</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:v4.7</span> <span class="comment"># git</span></span><br><span class="line">    <span class="comment"># image: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:v4.7 # é˜¿é‡Œäº‘</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">30001</span><span class="string">:3000</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fastgpt</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mongo</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">pg</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="comment"># root å¯†ç ï¼Œç”¨æˆ·åä¸º: rootã€‚å¦‚æœéœ€è¦ä¿®æ”¹ root å¯†ç ï¼Œç›´æ¥ä¿®æ”¹è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œå¹¶é‡å¯å³å¯ã€‚</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DEFAULT_ROOT_PSW=1234</span></span><br><span class="line">      <span class="comment"># AIæ¨¡å‹çš„APIåœ°å€å“¦ã€‚åŠ¡å¿…åŠ  /v1ã€‚è¿™é‡Œé»˜è®¤å¡«å†™äº†OneApiçš„è®¿é—®åœ°å€ã€‚</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">OPENAI_BASE_URL=http://one-api:3000/v1</span>                     <span class="comment">#(æ­¤åœ°å€ä¸ºoneapiåœ°å€+/v1)</span></span><br><span class="line">      <span class="comment"># AIæ¨¡å‹çš„API Keyã€‚ï¼ˆè¿™é‡Œé»˜è®¤å¡«å†™äº†OneAPIçš„å¿«é€Ÿé»˜è®¤keyï¼Œæµ‹è¯•é€šåï¼ŒåŠ¡å¿…åŠæ—¶ä¿®æ”¹ï¼‰</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CHAT_API_KEY=sk-74E561</span>  <span class="comment">#(æ­¤keyä¸ºone-apiç”Ÿæˆçš„ä»¤ç‰Œ)</span></span><br><span class="line">      <span class="comment"># æ•°æ®åº“æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DB_MAX_LINK=30</span></span><br><span class="line">      <span class="comment"># ç™»å½•å‡­è¯å¯†é’¥</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TOKEN_KEY=any</span></span><br><span class="line">      <span class="comment"># rootçš„å¯†é’¥ï¼Œå¸¸ç”¨äºå‡çº§æ—¶å€™çš„åˆå§‹åŒ–è¯·æ±‚</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ROOT_KEY=root_key</span></span><br><span class="line">      <span class="comment"># æ–‡ä»¶é˜…è¯»åŠ å¯†</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">FILE_TOKEN_KEY=filetoken</span></span><br><span class="line">      <span class="comment"># MongoDB è¿æ¥å‚æ•°. ç”¨æˆ·åmyusername,å¯†ç mypasswordã€‚</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MONGODB_URI=mongodb://myusername:mypassword@mongo:27017/fastgpt?authSource=admin</span></span><br><span class="line">      <span class="comment"># pg è¿æ¥å‚æ•°</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PG_URL=postgresql://username:password@pg:5432/postgres</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config.json:/app/data/config.json</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./fastgpt/tmp:/app/tmp</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">one-api:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:one-api-latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">one-api</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./one-api:/data</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fastgpt</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">fastgpt:</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>å¯¹æ¥æœ¬åœ°å¤§æ¨¡å‹+å‘é‡æ¨¡å‹æ³¨æ„äº‹é¡¹ï¼š</strong></p><ul><li>oneapiæ–°å¢æ¸ é“ å¡«å…¥å‘é‡æ¨¡å‹ åŠæœ¬åœ°å¤§æ¨¡å‹</li><li>é€šè¿‡æ­¤æ¸ é“æ–°å»ºä»¤ç‰Œ å¹¶å°†ä»¤ç‰Œkeyè´Ÿè½½åˆ°æ¸ é“å¯†é’¥å¤„ ä¿å­˜</li><li>æ¸ é“æ¨¡å‹éœ€è¦æ‰‹åŠ¨å¡«å…¥ä¸è¦é€‰æ‹©ä¸Šæ–¹çš„ å¦åˆ™æ— æ³•è·å–</li><li>fastgpt config.jsonæ–‡ä»¶å°†å¤§æ¨¡å‹åŠå‘é‡æ¨¡å‹å¡«å…¥ æœ¬æ–‡ä½¿ç”¨å‘é‡æ¨¡å‹ä¸º<code>nomic-embed-text:latest</code></li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_032b3fcee57bdf2b60ae8989041ed7a0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/8/image_032b3fcee57bdf2b60ae8989041ed7a0.png"></p><p><code>nomic-embed-text:latest</code>å‘é‡æ¨¡å‹éƒ¨ç½²æ–¹å¼<code>ollama pull nomic-embed-text:latest</code></p><p>æ¨¡å‹å®˜ç½‘ï¼š<a href="https://ollama.com/library/nomic-embed-text:latest">https://ollama.com/library/nomic-embed-text:latest</a></p><p>æ­¤å¤„å‚è€ƒï¼š<a href="https://www.bilibili.com/video/BV1bz421S79Y/?t=727.194668&spm_id_from=333.1350.jump_directly&vd_source=f2da0b118b0745da0dcde264fed6ee35">fastgptå–‚é¥­æ•™ç¨‹-æœ€å¼ºAIçŸ¥è¯†åº“_å“”å“©å“”å“©_bilibili</a></p><h4 id="fastgptæ›´æ¢logo"><a href="#fastgptæ›´æ¢logo" class="headerlink" title="fastgptæ›´æ¢logo"></a>fastgptæ›´æ¢logo</h4><p>[å…¶ä»–logoæ›´æ¢å‚è€ƒ | &gt; (<a href="https://doc.fastai.site/docs/development/configuration/">é…ç½®æ–‡ä»¶ä»‹ç» | FastGPT (fastai.site)</a>)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">cp</span> ./logo.svg fastgpt:/app/projects/app/public/icon</span><br><span class="line">docker <span class="built_in">cp</span> ./favicon.ico fastgpt:/app/projects/app/public/</span><br></pre></td></tr></table></figure><h2 id="å››-æ•ˆæœ"><a href="#å››-æ•ˆæœ" class="headerlink" title="å›› æ•ˆæœ"></a>å›› æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_3390fff9c5b4e790c31ef176e89a5c27.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_3390fff9c5b4e790c31ef176e89a5c27.png"></p><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://doc.fastai.site/docs/development/docker/">å®˜ç½‘</a></p><p><a href="https://blog.csdn.net/m0_62536353/article/details/135733446">ä¿å§†çº§æ•™ç¨‹ï¼šFastGPTæ„å»ºä¸ªäººæœ¬åœ°çŸ¥è¯†åº“(Docker composeå¿«é€Ÿéƒ¨ç½²)_fastgptæœ¬åœ°éƒ¨ç½²-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>one-apiåŠoen-api-pluséƒ¨ç½²åŠä½¿ç”¨</title>
      <link href="/2024/04/09/one-api%E5%8F%8Aone-api-plus%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/09/one-api%E5%8F%8Aone-api-plus%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="one-apiåŠoen-api-pluséƒ¨ç½²åŠä½¿ç”¨"><a href="#one-apiåŠoen-api-pluséƒ¨ç½²åŠä½¿ç”¨" class="headerlink" title="one-apiåŠoen-api-pluséƒ¨ç½²åŠä½¿ç”¨"></a>one-apiåŠoen-api-pluséƒ¨ç½²åŠä½¿ç”¨</h1><blockquote><p>è°ƒç”¨çš„æ¥å£æ˜¯å›½å¤–çš„ä¾‹å¦‚chatgptæ—¶éœ€è¦é…ç½®ä»£ç†æˆ–è€…ä½¿ç”¨å›½å¤–æœåŠ¡å™¨</p><p>åˆå§‹å¯†ç ï¼šroot/123456</p></blockquote><h2 id="ä½¿ç”¨docker-composeéƒ¨ç½²"><a href="#ä½¿ç”¨docker-composeéƒ¨ç½²" class="headerlink" title="ä½¿ç”¨docker-composeéƒ¨ç½²"></a>ä½¿ç”¨docker-composeéƒ¨ç½²</h2><h3 id="é•œåƒå¯é€‰"><a href="#é•œåƒå¯é€‰" class="headerlink" title="é•œåƒå¯é€‰"></a>é•œåƒå¯é€‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">justsong/one-api:latest </span><br><span class="line">image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:one-api-latest</span><br></pre></td></tr></table></figure><h3 id="dockeræ–¹å¼"><a href="#dockeræ–¹å¼" class="headerlink" title="dockeræ–¹å¼"></a>dockeræ–¹å¼</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ SQLite çš„éƒ¨ç½²å‘½ä»¤ï¼š</span></span><br><span class="line">docker run --name one-api -d --restart always -p 3000:3000 -e TZ=Asia/Shanghai -v /home/ubuntu/data/one-api:/data justsong/one-api</span><br><span class="line"><span class="comment"># ä½¿ç”¨ MySQL çš„éƒ¨ç½²å‘½ä»¤ï¼Œåœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šæ·»åŠ  `-e SQL_DSN=&quot;root:123456@tcp(localhost:3306)/oneapi&quot;`ï¼Œè¯·è‡ªè¡Œä¿®æ”¹æ•°æ®åº“è¿æ¥å‚æ•°ï¼Œä¸æ¸…æ¥šå¦‚ä½•ä¿®æ”¹è¯·å‚è§ä¸‹é¢ç¯å¢ƒå˜é‡ä¸€èŠ‚ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼š</span></span><br><span class="line">docker run --name one-api -d --restart always -p 3000:3000 -e SQL_DSN=<span class="string">&quot;root:123456@tcp(localhost:3306)/oneapi&quot;</span> -e TZ=Asia/Shanghai -v /home/ubuntu/data/one-api:/data justsong/one-api</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="docker-composeæ–¹å¼"><a href="#docker-composeæ–¹å¼" class="headerlink" title="docker-composeæ–¹å¼"></a>docker-composeæ–¹å¼</h2><p>ä½¿ç”¨mysqlä½œä¸ºæ•°æ®åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  one-api:</span><br><span class="line">    container_name: one-api</span><br><span class="line">    image: justsong/one-api</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">    environment:</span><br><span class="line">      - SQL_DSN=root:123456@tcp(localhost:3306)/oneapi</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - ./one-api:/data</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨SQliteä½œä¸ºæ•°æ®åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  one-api:</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:one-api-latest</span><br><span class="line">    container_name: one-api</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">    environment:</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - ./one-api:/data</span><br></pre></td></tr></table></figure><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_a09a324c0e01b3dc1c96ba17b2b32f1b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_a09a324c0e01b3dc1c96ba17b2b32f1b.png"></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><blockquote><p><a href="%5Bhttps://doc.fastai.site/docs/development/one-api/%5D(https://doc.fastai.site/docs/development/one-api/)">è§é“¾æ¥ | &gt;&gt;</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_f34a8621031f3fc757073165acc4903d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_f34a8621031f3fc757073165acc4903d.png"></p><p><strong>å¯¹æ¥chat-next-webåªéœ€è¦å¡«å†™å¦‚ä¸‹å³å¯</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_41dd190facdda36a483473f4b9721848.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_41dd190facdda36a483473f4b9721848.png"></p></blockquote><h2 id="oneapi-å¯¹æ¥ollama"><a href="#oneapi-å¯¹æ¥ollama" class="headerlink" title="oneapi å¯¹æ¥ollama"></a>oneapi å¯¹æ¥ollama</h2><p><a href="http://t.csdnimg.cn/9zk1x">http://t.csdnimg.cn/9zk1x</a></p><p>æœ¬åœ°å¤§æ¨¡å‹éœ€è¦åœ¨æ–¹æ¡†å†…æ‰‹åŠ¨å¡«å…¥å¦åˆ™æ— æ³•æ£€ç´¢ä¼šæŠ¥é”™æ‰¾ä¸åˆ°</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_55f1658c77b591edcfaa012730ebe5ed.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_55f1658c77b591edcfaa012730ebe5ed.png"></p><p>å¤‡æ³¨ï¼šå½“å¯¹æ¥fastgptæ—¶éœ€è¦éƒ¨ç½²ä¸€ä¸ªå‘é‡æ¨¡å‹ä»¥åŠä¸€ä¸ªå¤§æ¨¡å‹ åˆ›å»ºçš„æ¸ é“å¯¼å…¥ä¸¤ä¸ªæ¨¡å‹  å¹¶ä¸”åˆ›å»ºä»¤ç‰Œæ—¶ ä¸èƒ½é€‰æ‹©æ¨¡å‹èŒƒå›´å¦åˆ™ä¼šæŠ¥é”™è¿”å›ä¸ºç©º</p><p>æˆåŠŸ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_2c937edb6f72a54bff00c3176f397e65.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/7/image_2c937edb6f72a54bff00c3176f397e65.png"></p><h2 id="æ‰©å±•one-api-plus"><a href="#æ‰©å±•one-api-plus" class="headerlink" title="æ‰©å±•one-api-plus"></a>æ‰©å±•one-api-plus</h2><p>æ­¤é¡¹ç›®æ˜¯å¤§ä½¬é­”æ”¹one-apiçš„ä¸€ä¸ªé¡¹ç›®ç•Œé¢ç¾è§‚ å¥½ç”¨ ä½¿ç”¨æ–¹æ³•ä¸ä¸Šæ–¹one-apiç›¸åŒ</p><p>æ‰˜ç®¡åœ°å€ï¼š<a href="https://github.com/MartialBE/one-hub">https://github.com/MartialBE/one-hub</a></p><p><strong>éƒ¨ç½²æ–¹æ³•</strong></p><p>gitåˆ°æœ¬åœ°å docker-compose up -då³å¯</p><p>git clone <a href="https://github.com/MartialBE/one-hub.git">https://github.com/MartialBE/one-hub.git</a></p><p>æˆ–</p><p>git clone <a href="https://github.com/GEGEWU-CLOUD/one-api-plus.git">https://github.com/GEGEWU-CLOUD/one-api-plus.git</a></p><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://cloud.sealos.io/">ä½¿ç”¨sealosä¸€é”®éƒ¨ç½²å’Œä½¿ç”¨oneapiï¼ˆç›¸å¯¹ç®€å•ç•¥ï¼‰</a></p><p><a href="%5Bhttps://github.com/GEGEWU-CLOUD/one-api%5D(https://github.com/GEGEWU-CLOUD/one-api)">ä½¿ç”¨dockeréƒ¨ç½²</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntué…ç½®ç½‘å¡bondç‰ˆ openstackéƒ¨ç½²</title>
      <link href="/2024/04/02/ubuntu%E9%85%8D%E7%BD%AE%E7%BD%91%E5%8D%A1bond%E7%89%88%20openstack%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/02/ubuntu%E9%85%8D%E7%BD%AE%E7%BD%91%E5%8D%A1bond%E7%89%88%20openstack%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ubuntué…ç½®ç½‘å¡bondç‰ˆ-openstackéƒ¨ç½²"><a href="#ubuntué…ç½®ç½‘å¡bondç‰ˆ-openstackéƒ¨ç½²" class="headerlink" title="ubuntué…ç½®ç½‘å¡bondç‰ˆ openstackéƒ¨ç½²"></a>ubuntué…ç½®ç½‘å¡bondç‰ˆ openstackéƒ¨ç½²</h1><blockquote><p>ç¯å¢ƒï¼š8C24G windows10å®¶åº­ç‰ˆ workstdtion17 pro ubuntu20.04</p><p><del>ç”±äºç”µè„‘æ€§èƒ½åŸå› æ­¤æ¬¡ä½¿ç”¨å•èŠ‚ç‚¹æµ‹è¯•</del></p></blockquote><h2 id="ä¸€-ubuntuç½‘å¡bondé…ç½®"><a href="#ä¸€-ubuntuç½‘å¡bondé…ç½®" class="headerlink" title="ä¸€. ubuntuç½‘å¡bondé…ç½®"></a>ä¸€. ubuntuç½‘å¡bondé…ç½®</h2><p>è§é“¾æ¥ | ï¼š<a href="http://sunlight.zznnwn.cloudns.biz/2024/04/02/workstdtion%E6%A8%A1%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%88%92%E5%88%86vlan%E5%8F%8A%E7%BD%91%E5%8D%A1bond%E8%AE%BE%E7%BD%AE">workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlanåŠç½‘å¡bondè®¾ç½®</a></p><h2 id="äºŒ-ä¸¤æˆ–å•å‰¯æœ¬cephéƒ¨ç½²"><a href="#äºŒ-ä¸¤æˆ–å•å‰¯æœ¬cephéƒ¨ç½²" class="headerlink" title="äºŒ. ä¸¤æˆ–å•å‰¯æœ¬cephéƒ¨ç½²"></a>äºŒ. ä¸¤æˆ–å•å‰¯æœ¬cephéƒ¨ç½²</h2><p>è„šæœ¬éƒ¨ç½²æ–¹å¼è§é“¾æ¥ | ï¼š<a href="https://gegewu-cloud.github.io/2023/09/24/ceph%E9%9B%86%E7%BE%A4%E4%B9%8Bcephadm%E6%B8%85%E7%90%86ceph%E9%9B%86%E7%BE%A4/">cephä¸€é”®éƒ¨ç½²</a></p><p>å¤‡æ³¨<strong>ceph</strong>ç½‘ç»œé€‰æ‹©ï¼š â€“mon-ip  <del>10.56.60.11</del>  â€“cluster-network <del>10.56.50.0/24</del>  â€“allow-overwrite</p><h2 id="ä¸‰-ä¸¤æˆ–å•å‰¯æœ¬openstackéƒ¨ç½²"><a href="#ä¸‰-ä¸¤æˆ–å•å‰¯æœ¬openstackéƒ¨ç½²" class="headerlink" title="ä¸‰. ä¸¤æˆ–å•å‰¯æœ¬openstackéƒ¨ç½²"></a>ä¸‰. ä¸¤æˆ–å•å‰¯æœ¬openstackéƒ¨ç½²</h2><h3 id="1-global-ymlæ–‡ä»¶é…ç½®-ç½‘ç»œä¸ä¸€ä¸­ä¿æŒä¸€è‡´"><a href="#1-global-ymlæ–‡ä»¶é…ç½®-ç½‘ç»œä¸ä¸€ä¸­ä¿æŒä¸€è‡´" class="headerlink" title="1. global.ymlæ–‡ä»¶é…ç½® ç½‘ç»œä¸ä¸€ä¸­ä¿æŒä¸€è‡´"></a>1. global.ymlæ–‡ä»¶é…ç½® ç½‘ç»œä¸ä¸€ä¸­ä¿æŒä¸€è‡´</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -------------------&lt;&lt;åˆ†å‰²çº¿&gt;&gt;------------------------</span></span><br><span class="line"><span class="comment"># kolla-ansible global.ymlé…ç½®</span></span><br><span class="line">kolla_base_distro: <span class="string">&quot;ubuntu&quot;</span></span><br><span class="line">kolla_install_type: <span class="string">&quot;source&quot;</span></span><br><span class="line">openstack_release: <span class="string">&quot;zznnyoga&quot;</span></span><br><span class="line">nova_compute_virt_type: <span class="string">&quot;qemu&quot;</span></span><br><span class="line">node_custom_config: <span class="string">&quot;/etc/kolla/config&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®ç§æœ‰é˜¿é‡Œäº‘ä»“åº“</span></span><br><span class="line">docker_registry: <span class="string">&quot;registry.cn-hangzhou.aliyuncs.com&quot;</span>     <span class="comment"># æ‹‰å– docker é•œåƒçš„æº</span></span><br><span class="line">docker_namespace: <span class="string">&quot;zznn&quot;</span>                                 <span class="comment"># docker registry é¡¹ç›®å</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤–éƒ¨cephé…ç½® ï¼ˆ workstdtion ens33 natæ¨¡å¼ ï¼‰</span></span><br><span class="line">swift_storage_interface: <span class="string">&quot;vlan60&quot;</span>             <span class="comment"># ceph å­˜å‚¨ç½‘ç»œçš„æ¥å£ (ceph public network æ‰€åœ¨æ¥å£)</span></span><br><span class="line"><span class="comment"># external_ceph_pool_pgs: 16                  # (hdd osd ä¸ªæ•°) * 3 çš„å€¼æœ€æ¥è¿‘ 2^n çš„æ•°, ä¾‹å¦‚ hdd osd ä¸ªæ•°ä¸º 12, åˆ™ external_ceph_pool_pgs å– 32</span></span><br><span class="line"><span class="comment"># external_ceph_ssd_pool_pgs: 32              # (ssd osd ä¸ªæ•°) * 3 çš„å€¼æœ€æ¥è¿‘ 2^n çš„æ•°, å¦‚æœæ²¡æœ‰ ssd, åˆ™å¯å¿½ç•¥è¯¥é…ç½®</span></span><br><span class="line">failed_swap_on: <span class="string">&quot;yes&quot;</span>                        <span class="comment"># é»˜è®¤ç¦æ­¢å¼€å¯ swap</span></span><br><span class="line">enable_external_ceph: <span class="string">&quot;yes&quot;</span>                  <span class="comment"># å¼€å¯å¤–éƒ¨ceph</span></span><br><span class="line">external_ceph_admin_permission: <span class="string">&quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># openstackå†…éƒ¨æ¥å£é…ç½® ï¼ˆens33 natæ¨¡å¼ ens37 ä¸»æœºæ¨¡å¼ï¼ˆ å…¶å®æ­¤å¤„ens37åº”è¯¥ä½¿ç”¨å¤–éƒ¨IPå³ä½¿ç”¨ æ¡¥æ¥æ¨¡å¼çš„ens38 ä½†vmwareç¯å¢ƒè¿™æ ·ä¹Ÿè¡Œ å› ä¸ºwindowsç«¯å¯ä»¥pingé€šä¸»æœºæ¨¡å¼ç”Ÿæˆçš„IP ï¼‰ï¼‰</span></span><br><span class="line">keepalived_virtual_router_id: <span class="string">&quot;99&quot;</span>           <span class="comment"># keepalived å”¯ä¸€çš„ IDï¼Œéœ€è¦å’Œå±€åŸŸç½‘å†…å…¶ä»–  keepalived ID ä¸ä¸€è‡´, å–å€¼èŒƒå›´ 0~255</span></span><br><span class="line">kolla_internal_vip_address: <span class="string">&quot;10.56.70.100&quot;</span>   <span class="comment"># å†…éƒ¨ vip ï¼Œéœ€è¦å’Œ /etc/hosts ä¸­çš„ IP ç½‘æ®µä¸€è‡´ ï¼ˆworkstdtionå®éªŒç¯å¢ƒåˆ’åˆ†lanåŒºæ®µ20åªèƒ½å†…éƒ¨é€šä¿¡ ï¼‰</span></span><br><span class="line">network_interface: <span class="string">&quot;vlan70&quot;</span>                   <span class="comment"># å†…éƒ¨ vip æ¥å£ï¼ŒæœåŠ¡å™¨å†…éƒ¨é€šè®¯åœ°å€</span></span><br><span class="line">kolla_external_vip_address: <span class="string">&quot;192.168.1.99&quot;</span>   <span class="comment"># å¤–éƒ¨ vipï¼Œç”¨äº horizon dashboard ç•Œé¢æ“ä½œç­‰(è‹¥å¼€å¯é«˜å¯ç”¨ï¼šenable_haproxy: &quot;yes&quot;éœ€è¦é…ç½®ä¸ºæ²¡æœ‰å ç”¨çš„ip)</span></span><br><span class="line">horizon_port: <span class="string">&quot;10000&quot;</span>                    <span class="comment"># dashboard çš„ç«¯å£</span></span><br><span class="line">kolla_external_vip_interface: <span class="string">&quot;bond3&quot;</span>    <span class="comment"># å¤–éƒ¨ vip æ¥å£, è‹¥è¯¥ç½‘å¡åˆ’åˆ†äº† vlanï¼Œåˆ™éœ€è¦å¡«å†™é…ç½®å¤–ç½‘çš„å­æ¥å£workstdtionæ¨¡æ‹Ÿens38æ¡¥æ¥æ¨¡å¼ç½‘å¡ä¸º192.168.31æ®µ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä»–é…ç½®</span></span><br><span class="line"><span class="comment"># kolla_external_vip_interface: &quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">api_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">storage_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">cluster_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">tunnel_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">dns_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line"><span class="comment"># neutron_external_interface: &quot;ens38&quot; # è®¿é—®openstackçš„ç‰©ç†ç½‘å¡ä¸éœ€è¦é…ç½®IPï¼Œä¸šåŠ¡å£</span></span><br><span class="line">neutron_plugin_agent: <span class="string">&quot;openvswitch&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤–ç½‘è®¾ç½®ï¼ˆ ens38 natæ¨¡å¼ æ­¤å¤„ens38ä¸ºä¸šåŠ¡å£ä¸é…ç½®IP é‡‡ç”¨åŠå…¬ç½‘192.168.31æ®µä½œä¸ºå¤–ç½‘ æ¥çº¿æ¥åŠå…¬ç½‘çš„å…‰çº¤æˆ–ç½‘çº¿ ï¼‰</span></span><br><span class="line"><span class="comment"># neutron_external_interface: &quot;ens38&quot;      # flat ç½‘ç»œä½¿ç”¨çš„ç‰©ç†ç½‘å¡,è‹¥éœ€è¦è¿æ¥ä¸“ç½‘</span></span><br><span class="line">neutron_external_interface: <span class="string">&quot;bond2,vlan80&quot;</span>        <span class="comment"># workstdtionæ¨¡æ‹Ÿæ¡¥æ¥æ¨¡å¼ç½‘å¡ ç”¨äºæ¨¡æ‹Ÿå¤–ç½‘å¯é…ç½®ç½‘ç»œä¹Ÿå¯ä¸é…ç½® ç‰©ç†æœåŠ¡å™¨éœ€è¦æ¥å¤–ç½‘ç½‘çº¿</span></span><br><span class="line">neutron_bridge_name: <span class="string">&quot;&#123;% for i in range(neutron_external_interface.split(&#x27;,&#x27;)|length) %&#125;br-ex&#123;&#123; loop.index0 + 1 &#125;&#125;&#123;% if not loop.last %&#125;,&#123;% endif %&#125;&#123;% endfor %&#125;&quot;</span></span><br><span class="line"><span class="comment"># ç½‘æ¡¥åå­—, neutron_external_interface æœ‰å¤šå°‘ä¸ªæ¥å£å°±è¦æŒ‡å®šå¤šå°‘ä¸ªç½‘æ¡¥åç§°</span></span><br><span class="line">enable_neutron_dns: <span class="string">&quot;no&quot;</span>                                  <span class="comment"># neutron æ˜¯å¦å¼€å¯ dns, å¦‚æœå¼€å¯ dns, å¯èƒ½é­å— dns åå°„å‹ ddos æ”»å‡», å¦‚æœä¸å¼€å¯, horizon ä¸­åˆ›å»ºå­ç½‘æ—¶éœ€è¦æŒ‡å®šå…¬å…± dns, å¦‚ 223.5.5.5</span></span><br><span class="line">enable_neutron_mtu_1550: <span class="string">&quot;no&quot;</span>                             <span class="comment"># ä¸è¦ä¿®æ”¹è¯¥å‚æ•°ï¼Œå¦åˆ™å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›ç½‘ç»œé—®é¢˜</span></span><br><span class="line">enable_neutron_ext_net: <span class="string">&quot;yes&quot;</span>                             <span class="comment"># æ˜¯å¦è‡ªåŠ¨åˆ›å»º flat ç½‘ç»œ</span></span><br><span class="line">neutron_ext_net_cidr: <span class="string">&quot;192.168.1.0/24&quot;</span></span><br><span class="line">neutron_ext_net_range: <span class="string">&quot;start=192.168.1.70,end=192.168.1.120&quot;</span></span><br><span class="line">neutron_ext_net_gateway: <span class="string">&quot;192.168.1.1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¦ç”¨æ—¶é’Ÿæ£€æŸ¥(å¯é€‰)</span></span><br><span class="line"><span class="comment"># prechecks_enable_host_ntp_checks: &quot;false&quot;</span></span><br><span class="line"><span class="comment"># skylineå¯é€‰</span></span><br><span class="line"><span class="comment"># enable_skyline: &quot;yes&quot;</span></span><br><span class="line"><span class="comment"># å…¶ä»–é…ç½®</span></span><br><span class="line">enable_ceph: <span class="string">&quot;no&quot;</span></span><br><span class="line">enable_haproxy: <span class="string">&quot;yes&quot;</span></span><br><span class="line">enable_chrony: <span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="comment"># enable_mariabackup: &quot;no&quot;</span></span><br><span class="line"><span class="comment"># enable_ceph_rgw: &quot;yes&quot;</span></span><br><span class="line">enable_cinder: <span class="string">&quot;yes&quot;</span></span><br><span class="line">enable_manila_backend_cephfs_native: <span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="comment"># enable_neutron_qos: &quot;yes&quot;  </span></span><br><span class="line"><span class="comment"># enable_ceph_rgw_keystone: &quot;yes&quot;</span></span><br><span class="line">glance_backend_ceph: <span class="string">&quot;yes&quot;</span></span><br><span class="line">glance_enable_rolling_upgrade: <span class="string">&quot;no&quot;</span></span><br><span class="line">gnocchi_backend_storage: <span class="string">&quot;ceph&quot;</span></span><br><span class="line">cinder_backend_ceph: <span class="string">&quot;yes&quot;</span></span><br><span class="line">nova_backend_ceph: <span class="string">&quot;yes&quot;</span></span><br><span class="line">ironic_dnsmasq_dhcp_range:</span><br><span class="line">tempest_image_id:</span><br><span class="line">tempest_flavor_ref_id:</span><br><span class="line">tempest_public_network_id:</span><br><span class="line">tempest_floating_network_name:</span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------åˆ†å‰²çº¿--------------</span></span><br><span class="line"><span class="comment"># 2023.10.30æ–°å¢(æ–°å¢vpn qos æ•°æ®åº“) ---------------------&gt;&gt; ä¸‹æ–¹æ–°å¢é…ç½®------------</span></span><br><span class="line">enable_neutron_dvr: <span class="string">&quot;yes&quot;</span>                <span class="comment"># æ‚¨å¯ç”¨äº† OpenStack Neutron çš„ DVRï¼ˆDistributed Virtual Routerï¼‰åŠŸèƒ½ã€‚DVR æ˜¯ä¸€é¡¹åŠŸèƒ½ï¼Œå®ƒå…è®¸è™šæ‹Ÿè·¯ç”±å™¨ï¼ˆVirtual Routerï¼‰çš„æ•°æ®é¢åŠŸèƒ½åœ¨è®¡ç®—èŠ‚ç‚¹ä¸Šåˆ†å¸ƒå¼æ‰§è¡Œï¼Œè€Œä¸æ˜¯é›†ä¸­æ‰§è¡Œåœ¨ç½‘ç»œèŠ‚ç‚¹ä¸Šã€‚è¿™æœ‰åŠ©äºæé«˜ç½‘ç»œæ€§èƒ½å’Œæ‰©å±•æ€§ã€‚</span></span><br><span class="line">enable_neutron_vpnaas: <span class="string">&quot;yes&quot;</span>             <span class="comment"># vpn</span></span><br><span class="line">enable_neutron_qos: <span class="string">&quot;yes&quot;</span>                <span class="comment"># qos</span></span><br><span class="line">enable_nova_ssh: <span class="string">&quot;yes&quot;</span>                   <span class="comment"># è¿™å…è®¸ç”¨æˆ·é€šè¿‡ SSH åè®®è®¿é—®è™šæ‹Ÿæœºå®ä¾‹ï¼Œä»¥è¿›è¡Œè¿œç¨‹ç®¡ç†å’Œæ“ä½œã€‚</span></span><br><span class="line"><span class="comment"># enable_neutron_provider_networks: &quot;yes&quot;  # æä¾›è€…ç½‘ç»œæ˜¯ä¸€ç§ç½‘ç»œç±»å‹ï¼Œå…è®¸ OpenStack ç§Ÿæˆ·è¿æ¥åˆ°å¤–éƒ¨ç½‘ç»œï¼Œé€šå¸¸æ˜¯ç‰©ç†ç½‘ç»œæˆ–å…¶ä»–å¤–éƒ¨ç½‘ç»œæœåŠ¡ã€‚</span></span><br><span class="line"><span class="comment"># enable_trove: &quot;yes&quot;                      # Trove æ˜¯ OpenStack çš„æ•°æ®åº“å³æœåŠ¡ </span></span><br></pre></td></tr></table></figure><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>å¯ä»¥çœ‹åˆ°æ­¤ç§æ–¹å¼å³ä½¿æ˜¯æµ‹è¯•ç¯å¢ƒceph osdå†™å…¥é€Ÿåº¦ä¹Ÿå¯ä»¥è¾¾åˆ°<del>1M/s</del>ä»¥ä¸Š</p><p>æ³¨ï¼šæ­¤ç§æµ‹è¯•æ—¶å‘ç°æµ®åŠ¨IPæ— æ³•ä½¿ç”¨åŸå› å¦‚ä¸‹</p><p>æ–‡ä»¶ï¼š</p><ul><li>/etc/kolla/neutron-server/ml2_conf.ini</li><li>/etc/kolla/neutron-openvswitch-agent/openvswitch_agent.ini</li><li>bond2 vlan80 ä¸æµ®åŠ¨IPç½‘æ®µå‡ä¸åœ¨ä¸€èµ· bond2 ä¸Š<del>ç½‘å¡ç½‘å£éœ€è¦æ¥ä¸æµ®åŠ¨IPåŒç½‘æ®µçš„ç½‘çº¿</del> <strong>å¹¶ä¸”ä¸èƒ½é…ç½® IP</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cat</span> /etc/kolla/neutron-openvswitch-agent/openvswitch_agent.ini</span><br><span class="line"></span><br><span class="line">[agent]</span><br><span class="line">tunnel_types = vxlan</span><br><span class="line">l2_population = <span class="literal">true</span></span><br><span class="line">arp_responder = <span class="literal">true</span></span><br><span class="line">enable_distributed_routing = True</span><br><span class="line">extensions = qos</span><br><span class="line"></span><br><span class="line">[securitygroup]</span><br><span class="line">firewall_driver = neutron.agent.linux.iptables_firewall.OVSHybridIptablesFirewallDriver</span><br><span class="line"></span><br><span class="line">[ovs]</span><br><span class="line">bridge_mappings = physnet1:br-ex1,physnet2:br-ex2</span><br><span class="line">datapath_type = system</span><br><span class="line">ovsdb_connection = tcp:127.0.0.1:6640</span><br><span class="line">ovsdb_timeout = 10</span><br><span class="line">local_ip = 10.56.70.11     <span class="comment"># IPä¸º56æ®µIPä½†æµ®åŠ¨IPä¸º192.168æ®µ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹äº¤æ¢æœºå†…éƒ¨</span></span><br><span class="line">(venv3) root@ceph1:/etc/kolla/neutron-openvswitch-agent<span class="comment"># docker exec -it openvswitch_vswitchd bash</span></span><br><span class="line">(openvswitch-vswitchd)[root@ceph1 /]<span class="comment"># ovs-vsctl show</span></span><br><span class="line">0b40fa1b-d121-4e67-ae65-2a702169c162</span><br><span class="line">    Manager <span class="string">&quot;ptcp:6640:127.0.0.1&quot;</span></span><br><span class="line">        is_connected: <span class="literal">true</span></span><br><span class="line">    Bridge br-ex1</span><br><span class="line">        Controller <span class="string">&quot;tcp:127.0.0.1:6633&quot;</span></span><br><span class="line">            is_connected: <span class="literal">true</span></span><br><span class="line">        fail_mode: secure</span><br><span class="line">        datapath_type: system</span><br><span class="line">        Port br-ex1</span><br><span class="line">            Interface br-ex1</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port bond2                       <span class="comment"># å¯ä»¥çœ‹åˆ°æ­¤å¤„ä½¿ç”¨çš„å¤–ç½‘ç½‘å¡æ˜¯bond2 ä½†æ˜¯æ­¤æ—¶bond2æ˜¯</span></span><br><span class="line">            Interface bond2</span><br><span class="line">        Port phy-br-ex1</span><br><span class="line">            Interface phy-br-ex1</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=int-br-ex1&#125;</span><br><span class="line">    Bridge br-ex2</span><br><span class="line">        Controller <span class="string">&quot;tcp:127.0.0.1:6633&quot;</span></span><br><span class="line">            is_connected: <span class="literal">true</span></span><br><span class="line">        fail_mode: secure</span><br><span class="line">        datapath_type: system</span><br><span class="line">        Port phy-br-ex2</span><br><span class="line">            Interface phy-br-ex2</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=int-br-ex2&#125;</span><br><span class="line">        Port br-ex2</span><br><span class="line">            Interface br-ex2</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port vlan80</span><br><span class="line">            Interface vlan80</span><br><span class="line">    Bridge br-tun</span><br><span class="line">        Controller <span class="string">&quot;tcp:127.0.0.1:6633&quot;</span></span><br><span class="line">            is_connected: <span class="literal">true</span></span><br><span class="line">        fail_mode: secure</span><br><span class="line">        datapath_type: system</span><br><span class="line">        Port br-tun</span><br><span class="line">            Interface br-tun</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port patch-int</span><br><span class="line">            Interface patch-int</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=patch-tun&#125;</span><br><span class="line">    Bridge br-int</span><br><span class="line">        Controller <span class="string">&quot;tcp:127.0.0.1:6633&quot;</span></span><br><span class="line">            is_connected: <span class="literal">true</span></span><br><span class="line">        fail_mode: secure</span><br><span class="line">        datapath_type: system</span><br><span class="line">        Port tapc4f556bc-44</span><br><span class="line">            tag: 3</span><br><span class="line">            Interface tapc4f556bc-44</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port patch-tun</span><br><span class="line">            Interface patch-tun</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=patch-int&#125;</span><br><span class="line">        Port qvo0650711e-a1</span><br><span class="line">            tag: 2</span><br><span class="line">            Interface qvo0650711e-a1</span><br><span class="line">        Port int-br-ex1</span><br><span class="line">            Interface int-br-ex1</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=phy-br-ex1&#125;</span><br><span class="line">        Port qg-97668e2d-78</span><br><span class="line">            tag: 3</span><br><span class="line">            Interface qg-97668e2d-78</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port int-br-ex2</span><br><span class="line">            Interface int-br-ex2</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=phy-br-ex2&#125;</span><br><span class="line">        Port sg-02263924-70</span><br><span class="line">            tag: 2</span><br><span class="line">            Interface sg-02263924-70</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port tap823e4df9-c8</span><br><span class="line">            tag: 2</span><br><span class="line">            Interface tap823e4df9-c8</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port fg-69b4fc5a-cc</span><br><span class="line">            tag: 3</span><br><span class="line">            Interface fg-69b4fc5a-cc</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port br-int</span><br><span class="line">            Interface br-int</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port qr-69d003b3-f2</span><br><span class="line">            tag: 2</span><br><span class="line">            Interface qr-69d003b3-f2</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br></pre></td></tr></table></figure><h3 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">(venv3)</span> <span class="string">root@ceph1:~#</span> <span class="string">cat</span> <span class="string">/etc/netplan/00-installer-config.yaml</span> </span><br><span class="line"><span class="comment"># This is the network config written by &#x27;subiquity&#x27;</span></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line">  <span class="attr">ethernets:</span></span><br><span class="line">    <span class="attr">ens33:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens37:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens38:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens39:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens40:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens41:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens42:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens43:</span> &#123;&#125;</span><br><span class="line">  <span class="attr">bonds:</span></span><br><span class="line">    <span class="attr">bond0:</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;10.56.50.11/24&quot;</span>]  <span class="comment"># æ­¤ç½‘å£ç”¨ä¸‡å…†å£ ç”¨äºceph osdé—´é€šä¿¡ï¼ˆ--cluster-networkï¼‰</span></span><br><span class="line">      <span class="attr">interfaces:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">ens37</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer3+4</span></span><br><span class="line">    <span class="attr">bond1:</span></span><br><span class="line">      <span class="attr">interfaces:</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="string">ens38</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer3+4</span></span><br><span class="line">    <span class="attr">bond2:</span></span><br><span class="line">      <span class="attr">interfaces:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">ens39</span>   <span class="comment"># æ¥ä¸æµ®åŠ¨IPåŒç½‘æ®µçš„ç½‘çº¿</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer3+4</span></span><br><span class="line">    <span class="attr">bond3:</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;192.168.1.10/24&quot;</span>]      <span class="comment"># æ­¤ç½‘å£ç”¨åƒå…†å£ &gt;&gt; ç”µå£ ç”¨äºè¿œç¨‹è¿æ¥ ä¸ºæµ®åŠ¨IP</span></span><br><span class="line">      <span class="attr">gateway4:</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">      <span class="attr">interfaces:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">ens33</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer3+4</span></span><br><span class="line">  <span class="attr">vlans:</span></span><br><span class="line">    <span class="attr">vlan60:</span></span><br><span class="line">      <span class="attr">id:</span> <span class="number">60</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">bond1</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;10.56.60.11/24&quot;</span>]</span><br><span class="line">    <span class="attr">vlan70:</span></span><br><span class="line">      <span class="attr">id:</span> <span class="number">70</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">bond1</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;10.56.70.11/24&quot;</span>]</span><br><span class="line">    <span class="attr">vlan80:</span></span><br><span class="line">      <span class="attr">id:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">bond1</span></span><br><span class="line">      <span class="comment">#addresses: [&quot;10.56.80.11/24&quot;]  #æµ®åŠ¨IPä½¿ç”¨æ¥å£ä¸é…ç½®IP</span></span><br><span class="line">    <span class="attr">vlan90:</span></span><br><span class="line">      <span class="attr">id:</span> <span class="number">90</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">bond1</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;10.56.90.11/24&quot;</span>]</span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶é—®é¢˜è§£å†³ã€‚</p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><h3 id="cephçŠ¶æ€"><a href="#cephçŠ¶æ€" class="headerlink" title="cephçŠ¶æ€"></a>cephçŠ¶æ€</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(venv3) root@ceph1:~# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     dc7fa486-f1a0-11ee-a64f-c194d5eb9f2e</span><br><span class="line">    health: HEALTH_WARN</span><br><span class="line">            5 pool(s) have no replicas configured</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum ceph1 (age 62m)</span><br><span class="line">    mgr: ceph1.phqsba(active, since 62m)</span><br><span class="line">    osd: 1 osds: 1 up (since 62m), 1 in (since 2h)</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   5 pools, 129 pgs</span><br><span class="line">    objects: 157 objects, 220 MiB</span><br><span class="line">    usage:   111 MiB used, 20 GiB / 20 GiB avail</span><br><span class="line">    pgs:     129 active+clean</span><br></pre></td></tr></table></figure><h3 id="openstackåˆ›å»ºå®ä¾‹éªŒè¯æ•ˆæœ-gt-gt"><a href="#openstackåˆ›å»ºå®ä¾‹éªŒè¯æ•ˆæœ-gt-gt" class="headerlink" title="openstackåˆ›å»ºå®ä¾‹éªŒè¯æ•ˆæœ &gt;&gt;"></a>openstackåˆ›å»ºå®ä¾‹éªŒè¯æ•ˆæœ &gt;&gt;</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ea5efea6d38310a022b2f7c573e3afcd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ea5efea6d38310a022b2f7c573e3afcd.png"></p><p>æ­¤æ—¶é›†ç¾¤æµ‹è¯•åœ†æ»¡å®Œæˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlan,ä»¥åŠç‰©ç†æœåŠ¡å™¨ç½‘å¡bondè®¾ç½®</title>
      <link href="/2024/04/02/workstdtion%E6%A8%A1%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%88%92%E5%88%86vlan,%E4%BB%A5%E5%8F%8A%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BD%91%E5%8D%A1bond%E8%AE%BE%E7%BD%AE/"/>
      <url>/2024/04/02/workstdtion%E6%A8%A1%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%88%92%E5%88%86vlan,%E4%BB%A5%E5%8F%8A%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BD%91%E5%8D%A1bond%E8%AE%BE%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlan-ä»¥åŠç‰©ç†æœåŠ¡å™¨ç½‘å¡bondè®¾ç½®"><a href="#workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlan-ä»¥åŠç‰©ç†æœåŠ¡å™¨ç½‘å¡bondè®¾ç½®" class="headerlink" title="workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlan,ä»¥åŠç‰©ç†æœåŠ¡å™¨ç½‘å¡bondè®¾ç½®"></a>workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlan,ä»¥åŠç‰©ç†æœåŠ¡å™¨ç½‘å¡bondè®¾ç½®</h1><h2 id="workstdtionè®¾ç½®"><a href="#workstdtionè®¾ç½®" class="headerlink" title="workstdtionè®¾ç½®"></a>workstdtionè®¾ç½®</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c2444bc85394584e2798df97ef8b9549.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c2444bc85394584e2798df97ef8b9549.png"></p><h2 id="ä¸€-ç¬¬ä¸€ç§ubuntuç³»ç»Ÿç½‘å¡é…ç½®"><a href="#ä¸€-ç¬¬ä¸€ç§ubuntuç³»ç»Ÿç½‘å¡é…ç½®" class="headerlink" title="ä¸€. ç¬¬ä¸€ç§ubuntuç³»ç»Ÿç½‘å¡é…ç½®"></a>ä¸€. ç¬¬ä¸€ç§ubuntuç³»ç»Ÿç½‘å¡é…ç½®</h2><blockquote><p>æŸ¥çœ‹ç«¯å£é€Ÿç‡ï¼š</p><ul><li><p>åˆ¤æ–­æ˜¯åƒå…†ç½‘å¡è¿˜æ˜¯ç™¾å…†ç½‘å¡ æŸ¥çœ‹æ”¯æŒçš„é€Ÿç‡ &gt; <strong>ethtool ens33</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Speed: 1000Mb/s</span><br><span class="line">Duplex: Full</span><br><span class="line">Port: Twisted Pair</span><br></pre></td></tr></table></figure></li></ul></blockquote><p>å®Œæ•´ç½‘å¡é…ç½®å¦‚ä¸‹ï¼šå…±æ¥å››æ ¹ç½‘çº¿ <strong>bond0&gt;&gt;bond3</strong> å¤„ç½‘å¡éœ€è¦æ˜¯<strong>up</strong>çŠ¶æ€ ç‰©ç†æœåŠ¡å™¨æ—¶åªéœ€è¦æ’å…¥ç½‘çº¿æŸ¥çœ‹ç«¯å£çŠ¶æ€å³å¯åˆ¤æ–­ç½‘å£çŠ¶æ€</p><ul><li><p>bond3 æµ®åŠ¨IP 192.168.1.10/24 ç½‘å£ä¸Š ä½äºåƒå…†å£ æ¥ä¸€æ ¹äº¤æ¢æœºä¸Šåˆ’åˆ†çš„ä¸€æ ¹åŒç½‘æ®µç½‘çº¿ ç”¨äºè¿œç¨‹è¿æ¥</p></li><li><p>bond0 ä¸‡å…†å£æ¥ä¸€æ ¹äº¤æ¢æœºåˆ’åˆ†çš„ 50 æ®µç½‘ç»œ ç”¨äºceph osd å†…éƒ¨é€šä¿¡cephï¼ˆâ€“cluster-networkï¼‰ç½‘ç»œ</p></li><li><p>bond1 ä¸Šé¢æ¥äº¤æ¢æœºä¸Šå¯¹ è¯¥ç½‘å£åˆ’åˆ†äº†vlan60 vlan70 vlan80 vlan90 çš„ç½‘çº¿</p></li><li><p><code>bond2</code> ä¸Šé¢æ¥äº¤æ¢æœºä¸Šå¯¹ <del>192.168.1.10/24 ç½‘æ®µåˆ’åˆ†çš„æµ®åŠ¨IP æ± </del> çš„ç½‘çº¿ ä¾‹å¦‚ï¼š<del>æœ¬æ–‡åˆ™éœ€è¦ä¸ºæ¡¥æ¥æ¨¡å¼æ¨¡æ‹Ÿæµ®åŠ¨</del>IP  å¹¶ä¸”æ­¤ç½‘å£ä¸é…ç½®IPï¼ˆä¸‹æ–¹æ–‡ä»¶æµ‹è¯•å·²é…ç½®äº†IP <del>å®é™…è¿‡ç¨‹ä¸­è‡ªè¡Œæ³¨é‡Š</del>ï¼‰<code>å®éªŒä¸­å•èŠ‚ç‚¹vmwareç¯å¢ƒbond2ä¸‹ç½‘å¡ens39æ¡¥æ¥æ¨¡å¼ éƒ¨ç½²å•èŠ‚ç‚¹stackä¸€åˆ‡æ­£å¸¸ ä½†æ˜¯åŒèŠ‚ç‚¹bond2ä¸‹ç½‘å¡ens39 åŒèŠ‚ç‚¹ens39ç½‘å¡å‡é…ç½®æ¡¥æ¥æ¨¡å¼æ—¶ åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å¯ç”¨ &gt;&gt; æ­¤æ—¶ åªéœ€è¦å°†åŒèŠ‚ç‚¹ä¸Šæ–¹å‡æ²¡æœ‰åˆ’åˆ†bondçš„ä»»æ„ç½‘å¡æ¡¥æ¥å¦‚ens41 ä¿®æ”¹globalæ–‡ä»¶ç”¨äºæµ®åŠ¨IPæ± ä½¿ç”¨çš„ç½‘å¡ä¸ºens41 å†é‡æ–°éƒ¨ç½² å³ æ­£å¸¸</code>ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_6e28aee0f289c98393d974c614fc09c3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_6e28aee0f289c98393d974c614fc09c3.png"></p></li><li><p>ä¸‰å°æœåŠ¡å™¨ æ­¤ç§é…ç½®å®Œæˆå æ˜¯å¯ä»¥äº’é€šçš„æ— è®º<strong>ping</strong>é‚£ä¸ªç½‘æ®µéƒ½æ˜¯é€šçš„<br>ubuntuç½‘å¡bondæ¥çº¿ä¸cephåŠstarté›†æˆ<strong>æ½å›¾</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_cea9571e22249bca02d6cb339ed3c060.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_cea9571e22249bca02d6cb339ed3c060.png"></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This is the network config written by &#x27;subiquity&#x27;</span></span><br><span class="line">network:</span><br><span class="line">  ethernets:</span><br><span class="line">    ens33: &#123;&#125;</span><br><span class="line">    ens37: &#123;&#125;</span><br><span class="line">    ens38: &#123;&#125;</span><br><span class="line">    ens39: &#123;&#125;</span><br><span class="line">    ens40: &#123;&#125;</span><br><span class="line">    ens41: &#123;&#125;</span><br><span class="line">    ens42: &#123;&#125;</span><br><span class="line">    ens43: &#123;&#125;</span><br><span class="line">  bonds:</span><br><span class="line">    bond0:</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.50.11/24&quot;</span>]  <span class="comment"># æ­¤ç½‘å£ç”¨ä¸‡å…†å£ ç”¨äºceph osdé—´é€šä¿¡ï¼ˆ--cluster-networkï¼‰</span></span><br><span class="line">      interfaces:</span><br><span class="line">        - ens37</span><br><span class="line">      parameters:</span><br><span class="line">        mode: 802.3ad</span><br><span class="line">        mii-monitor-interval: 100</span><br><span class="line">        lacp-rate: fast</span><br><span class="line">        transmit-hash-policy: layer3+4</span><br><span class="line">    bond1:</span><br><span class="line">      interfaces:  </span><br><span class="line">        - ens38</span><br><span class="line">      parameters:</span><br><span class="line">        mode: 802.3ad</span><br><span class="line">        mii-monitor-interval: 100</span><br><span class="line">        lacp-rate: fast</span><br><span class="line">        transmit-hash-policy: layer3+4</span><br><span class="line">    bond2:</span><br><span class="line">      interfaces:</span><br><span class="line">        - ens39</span><br><span class="line">      parameters:</span><br><span class="line">        mode: 802.3ad</span><br><span class="line">        mii-monitor-interval: 100</span><br><span class="line">        lacp-rate: fast</span><br><span class="line">        transmit-hash-policy: layer3+4</span><br><span class="line">    bond3:</span><br><span class="line">      addresses: [<span class="string">&quot;192.168.1.10/24&quot;</span>]      <span class="comment"># æ­¤ç½‘å£ç”¨åƒå…†å£ &gt;&gt; ç”µå£ ç”¨äºè¿œç¨‹è¿æ¥ åŠæµ®åŠ¨IPä½¿ç”¨</span></span><br><span class="line">      gateway4: 192.168.1.1</span><br><span class="line">      interfaces:</span><br><span class="line">        - ens33</span><br><span class="line">      parameters:</span><br><span class="line">        mode: 802.3ad</span><br><span class="line">        mii-monitor-interval: 100</span><br><span class="line">        lacp-rate: fast</span><br><span class="line">        transmit-hash-policy: layer3+4</span><br><span class="line">  vlans:</span><br><span class="line">    vlan60:</span><br><span class="line">      <span class="built_in">id</span>: 60</span><br><span class="line">      <span class="built_in">link</span>: bond1</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.60.11/24&quot;</span>]</span><br><span class="line">    vlan70:</span><br><span class="line">      <span class="built_in">id</span>: 70</span><br><span class="line">      <span class="built_in">link</span>: bond1</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.70.11/24&quot;</span>]</span><br><span class="line">    vlan80:</span><br><span class="line">      <span class="built_in">id</span>: 80</span><br><span class="line">      <span class="built_in">link</span>: bond1</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.80.11/24&quot;</span>]</span><br><span class="line">    vlan90:</span><br><span class="line">      <span class="built_in">id</span>: 90</span><br><span class="line">      <span class="built_in">link</span>: bond1</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.90.11/24&quot;</span>]</span><br><span class="line">  version: 2</span><br></pre></td></tr></table></figure><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">  System information as of Wed 03 Apr 2024 04:59:36 AM UTC</span><br><span class="line"></span><br><span class="line">  System load:              0.02</span><br><span class="line">  Usage of /:               26.9% of 39.07GB</span><br><span class="line">  Memory usage:             11%</span><br><span class="line">  Swap usage:               0%</span><br><span class="line">  Processes:                261</span><br><span class="line">  Users logged <span class="keyword">in</span>:          1</span><br><span class="line">  IPv4 address <span class="keyword">for</span> bond0:   10.56.50.11</span><br><span class="line">  IPv4 address <span class="keyword">for</span> bond3:   192.168.1.10</span><br><span class="line">  IPv6 address <span class="keyword">for</span> bond3:   240e:36f:151f:a000:e407:31ff:fee2:70f9</span><br><span class="line">  IPv4 address <span class="keyword">for</span> docker0: 172.17.0.1</span><br><span class="line">  IPv4 address <span class="keyword">for</span> vlan60:  10.56.60.11</span><br><span class="line">  IPv4 address <span class="keyword">for</span> vlan70:  10.56.70.11</span><br><span class="line">  IPv4 address <span class="keyword">for</span> vlan80:  10.56.80.11</span><br><span class="line">  IPv4 address <span class="keyword">for</span> vlan90:  10.56.90.11</span><br><span class="line"><span class="comment">#-----------------------------------------------------------------</span></span><br><span class="line">root@ceph1:~<span class="comment"># ip a</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond3 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e6:07:31:e2:70:f9 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">3: ens37: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 5a:c0:b2:8b:fe:e7 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">4: ens38: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond1 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">5: ens39: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond2 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 76:88:82:b8:46:ba brd ff:ff:ff:ff:ff:ff</span><br><span class="line">6: ens40: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:45:8a:b0 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::20c:29ff:fe45:8ab0/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">7: ens41: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:45:8a:ba brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::20c:29ff:fe45:8aba/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">8: ens42: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:45:8a:c4 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::20c:29ff:fe45:8ac4/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">9: ens43: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:45:8a:ce brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::20c:29ff:fe45:8ace/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">10: bond0: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 5a:c0:b2:8b:fe:e7 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.50.11/24 brd 10.56.50.255 scope global bond0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::58c0:b2ff:fe8b:fee7/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">11: bond1: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">12: bond2: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 76:88:82:b8:46:ba brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::7488:82ff:feb8:46ba/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">13: bond3: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e6:07:31:e2:70:f9 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.1.10/24 brd 192.168.1.255 scope global bond3</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 240e:36f:151f:a000:e407:31ff:fee2:70f9/64 scope global dynamic mngtmpaddr noprefixroute </span><br><span class="line">       valid_lft 198193sec preferred_lft 111793sec</span><br><span class="line">    inet6 fe80::e407:31ff:fee2:70f9/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">14: vlan90@bond1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.90.11/24 brd 10.56.90.255 scope global vlan90</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">15: vlan60@bond1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.60.11/24 brd 10.56.60.255 scope global vlan60</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">16: vlan70@bond1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.70.11/24 brd 10.56.70.255 scope global vlan70</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">17: vlan80@bond1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.80.11/24 brd 10.56.80.255 scope global vlan80</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">18: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default </span><br><span class="line">    <span class="built_in">link</span>/ether 02:42:98:b9:c1:30 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ä¾¿å¯é…ç½®openstack ä¸ ceph è§ &gt;&gt; | <a href="http://sunlight.zznnwn.cloudns.biz/2024/04/02/ubuntu%E9%85%8D%E7%BD%AE%E7%BD%91%E5%8D%A1bond%E7%89%88%20openstack%E9%83%A8%E7%BD%B2/">bondç‰ˆopesnatck</a> ã€‚</p><h2 id="æ‰©å±•ï¼š"><a href="#æ‰©å±•ï¼š" class="headerlink" title="æ‰©å±•ï¼š"></a>æ‰©å±•ï¼š</h2><p>å®é™…ç‰©ç†ç¯å¢ƒï¼Œç‰©ç†æœåŠ¡å™¨ubuntué…ç½®bond 802.3adå¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This is the network config written by &#x27;subiquity&#x27;</span></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line">  <span class="attr">ethernets:</span></span><br><span class="line">     <span class="attr">eno1:</span> &#123;&#125;</span><br><span class="line">     <span class="attr">eno2:</span> &#123;&#125;</span><br><span class="line">     <span class="attr">eno3:</span> &#123;&#125;</span><br><span class="line">     <span class="attr">eno4:</span></span><br><span class="line">        <span class="attr">addresses:</span> [<span class="number">58.49</span><span class="number">.220</span><span class="number">.166</span><span class="string">/24</span>]</span><br><span class="line">        <span class="attr">gateway4:</span> <span class="number">58.49</span><span class="number">.220</span><span class="number">.1</span></span><br><span class="line">  <span class="attr">bonds:</span></span><br><span class="line">    <span class="attr">bond0:</span></span><br><span class="line">      <span class="attr">interfaces:</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="string">eno3</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer3+4</span></span><br><span class="line">  <span class="attr">vlans:</span></span><br><span class="line">    <span class="attr">vlan60:</span></span><br><span class="line">      <span class="attr">id:</span> <span class="number">60</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">bond0</span>   <span class="comment"># å³en03ç½‘å¡å³åŸºäºeno3ç½‘å¡é…ç½®802.3ad</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;192.168.30.100/24&quot;</span>]  </span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p>åŒç½‘å¡ç‰ˆæœ¬ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ubuntu-bond </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ubuntu-bond </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£</title>
      <link href="/2024/04/01/kolla-ansible%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E4%B9%8B%E6%96%B0%E5%A2%9Eglance%E7%AD%89%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D%E6%96%87%E6%A1%A3/"/>
      <url>/2024/04/01/kolla-ansible%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E4%B9%8B%E6%96%B0%E5%A2%9Eglance%E7%AD%89%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£"><a href="#kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£" class="headerlink" title="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£"></a>kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£</h1><h2 id="cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º"><a href="#cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º" class="headerlink" title="cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º"></a>cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º</h2><p>å®˜ç½‘ç‰ˆæœ¬ï¼ˆæµ‹è¯•æ­¤ç§ç‰ˆæœ¬ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph auth get-or-create client.glance mon <span class="string">&#x27;profile rbd&#x27;</span> osd <span class="string">&#x27;profile rbd pool=images&#x27;</span> mgr <span class="string">&#x27;profile rbd pool=images&#x27;</span> -o ceph.client.glance.keyring </span><br><span class="line">ceph auth get-or-create client.cinder mon <span class="string">&#x27;profile rbd&#x27;</span> osd <span class="string">&#x27;profile rbd pool=volumes, profile rbd pool=vms, profile rbd-read-only pool=images&#x27;</span> mgr <span class="string">&#x27;profile rbd pool=volumes, profile rbd pool=vms&#x27;</span> -o ceph.client.cinder.keyring</span><br><span class="line">ceph auth get-or-create client.cinder-backup mon <span class="string">&#x27;profile rbd&#x27;</span> osd <span class="string">&#x27;profile rbd pool=backups&#x27;</span> mgr <span class="string">&#x27;profile rbd pool=backups&#x27;</span> -o ceph.client.cinder-backup.keyring</span><br></pre></td></tr></table></figure><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬å¯†é’¥åˆ›å»ºå¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/ceph</span><br><span class="line">ceph auth get-or-create client.cinder mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=volumes, allow rwx pool=vms, allow rx pool=images&#x27;</span> -o ceph.client.cinder.keyring</span><br><span class="line">ceph auth get-or-create client.glance mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=images&#x27;</span>  -o ceph.client.glance.keyring</span><br><span class="line">ceph auth get-or-create client.cinder-backup mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=backups, allow rwx pool=volumes&#x27;</span>  -o ceph.client.cinder-backup.keyring</span><br><span class="line">ceph auth get-or-create client.nova mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=vms, allow rwx pool=volumes, allow rx pool=images&#x27;</span>  -o ceph.client.nova.keyring</span><br></pre></td></tr></table></figure><h2 id="ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®"><a href="#ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®" class="headerlink" title="ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®"></a>ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®</h2><blockquote><p>ä¸‹æ–¹å†…å®¹æ¥è‡ª | ï¼š</p><p><a href="https://wn-apple-teawine.fun/2023/06/02/ceph%E4%B8%8Eopenstack-yoga%E9%9B%86%E6%88%90">https://wn-apple-teawine.fun/2023/06/02/cephä¸openstack-yogaé›†æˆ</a></p><p>å¯å‚è€ƒå®˜ç½‘ï¼š</p><p><a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/">https://docs.ceph.com/en/reef/rbd/rbd-openstack/</a></p><p><del><strong>volume</strong>ä¸<strong>cinder-backup</strong>åˆ©ç”¨<strong>kolla-ansible</strong>åˆå¹¶é…ç½®æ–‡ä»¶å±æ€§åç”Ÿæˆçš„é…ç½®æ–‡ä»¶åˆ†åˆ«ä½äº</del></p><p>/etc/kolla/cinder-volume/cinder.conf<br>/etc/kolla/cinder-backup/cinder.conf</p><p><del><strong>glance</strong>ä¸<strong>nova</strong>åˆ†åˆ«ä½äº</del></p><p>/etc/kolla/glance-api/glance-api.conf<br>/etc/kolla/nova-compute/nova.conf</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># glanceçš„é…ç½®é•œåƒå­˜å‚¨</span></span><br><span class="line">vi /etc/kolla/config/glance/glance-api.conf</span><br><span class="line"><span class="comment"># æ·»åŠ ï¼š</span></span><br><span class="line">[glance_store]</span><br><span class="line">stores=rbd</span><br><span class="line">default_store=rbd</span><br><span class="line">rbd_store_pool=images</span><br><span class="line">rbd_store_user=glance</span><br><span class="line">rbd_store_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># cinderçš„é…ç½®å·å­˜å‚¨</span></span><br><span class="line">vi /etc/kolla/config/cinder/cinder-volume.conf</span><br><span class="line"><span class="comment"># æ·»åŠ :</span></span><br><span class="line">[DEFAULT]</span><br><span class="line">enabled_backends=rbd-1</span><br><span class="line">[rbd-1]</span><br><span class="line">rbd_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line"><span class="comment"># rbd_flatten_volume_from_snapshot = true</span></span><br><span class="line">rbd_user=cinder  </span><br><span class="line">backend_host=rbd:volumes</span><br><span class="line">rbd_pool=volumes</span><br><span class="line">volume_backend_name=rbd-1</span><br><span class="line">volume_driver=cinder.volume.drivers.rbd.RBDDriver     <span class="comment"># æ­¤ä¸ºé©±åŠ¨</span></span><br><span class="line">rbd_secret_uuid=ea241bba-2031-4b0e-b750-c8356cbb46a8 </span><br><span class="line"></span><br><span class="line">æ–°å¢ï¼šï¼ˆ rbd_flatten_volume_from_snapshot = <span class="literal">true</span></span><br><span class="line">ï¼‰</span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šrbd_secret_uuidåœ¨/etc/kolla/passwords.yml æ–‡ä»¶ä¸­æ‰¾</span></span><br><span class="line"><span class="comment"># cat /etc/kolla/passwords.yml | grep rbd_secret_uuid</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cinder-backupçš„é…ç½®</span></span><br><span class="line">vi /etc/kolla/config/cinder/cinder-backup.conf</span><br><span class="line"><span class="comment"># æ·»åŠ :</span></span><br><span class="line">[DEFAULT]</span><br><span class="line">backup_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line">backup_ceph_user=cinder-backup   </span><br><span class="line">backup_ceph_chunk_size=134217728</span><br><span class="line">backup_ceph_pool=backups</span><br><span class="line"><span class="comment"># æœ¬æ¬¡ä½¿ç”¨cinder.backup.drivers.ceph.CephBackupDriver</span></span><br><span class="line">backup_driver=cinder.backup.drivers.ceph.CephBackupDriver    <span class="comment">#æ­¤ä¸ºé©±åŠ¨å¯é€‰cinder.backup.drivers.ceph</span></span><br><span class="line">backup_ceph_stripe_unit=0</span><br><span class="line">backup_ceph_stripe_count=0</span><br><span class="line">restore_discard_excess_bytes=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># novaçš„é…ç½®</span></span><br><span class="line">vi /etc/kolla/config/nova/nova-compute.conf</span><br><span class="line"><span class="comment"># æ·»åŠ ï¼š   </span></span><br><span class="line">[libvirt]   </span><br><span class="line">virt_type=kvm  </span><br><span class="line">cpu_mode=none </span><br><span class="line">images_rbd_pool=vms</span><br><span class="line">images_type=rbd</span><br><span class="line">images_rbd_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line">rbd_user=nova</span><br><span class="line"><span class="comment"># disk_cachemodes= &quot;network=writeback&quot;</span></span><br><span class="line"><span class="comment"># inject_password=true</span></span><br><span class="line"><span class="comment"># å¦‚æœæ˜¯åœ¨è™šæ‹Ÿæœºä¸Šéƒ¨ç½²çš„è¯éœ€è¦å°†virt_type æ”¹ä¸ºqemuï¼Œå¦‚æœä¸æ”¹æˆqemuï¼Œåœ¨openstackä¹‹ä¸Šåœ¨èµ·è™šæœºï¼Œè¿™ä¸ªè™šæœºæ˜¯èµ·ä¸æ¥çš„ </span></span><br><span class="line">ï¼ˆå®é™…ç¯å¢ƒå‚è€ƒ</span><br><span class="line">æ–°å¢: disk_cachemodes= <span class="string">&quot;network=writeback&quot;</span> inject_password=<span class="literal">true</span>,images_type=rbd </span><br><span class="line">åˆ é™¤: virt_type=kvm, cpu_mode = none :åˆ é™¤æ–°å¢é…ç½®æ­¤ç§æ—¶æˆåŠŸ ï¼‰</span><br></pre></td></tr></table></figure></blockquote><h2 id="glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api-confï¼‰"><a href="#glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api-confï¼‰" class="headerlink" title="glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api.confï¼‰"></a>glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api.confï¼‰</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/glance/glance-api.conf</p><blockquote><p>å®˜ç½‘å¼•ç”¨</p><h4 id="KILO-AND-AFTER-gt-gt"><a href="#KILO-AND-AFTER-gt-gt" class="headerlink" title="KILO AND AFTER&gt;&gt;"></a>KILO AND AFTER<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#kilo-and-after" title="Permalink to this heading">&gt;&gt;</a></h4><p>Edit <code>/etc/glance/glance-api.conf</code> and add under the <code>[glance_store]</code> section:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[glance_store]</span><br><span class="line">stores = rbd</span><br><span class="line">default_store = rbd</span><br><span class="line">rbd_store_pool = images</span><br><span class="line">rbd_store_user = glance</span><br><span class="line">rbd_store_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">rbd_store_chunk_size = 8</span><br></pre></td></tr></table></figure><p>For more information about the configuration options available in Glance please refer to the OpenStack Configuration Reference: <a href="http://docs.openstack.org/">http://docs.openstack.org/</a>.</p><h4 id="ENABLE-COPY-ON-WRITE-CLONING-OF-IMAGESïƒ"><a href="#ENABLE-COPY-ON-WRITE-CLONING-OF-IMAGESïƒ" class="headerlink" title="ENABLE COPY-ON-WRITE CLONING OF IMAGESïƒ"></a>ENABLE COPY-ON-WRITE CLONING OF IMAGES<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#enable-copy-on-write-cloning-of-images" title="Permalink to this heading">ïƒ</a></h4><p>Note that this exposes the back end location via Glanceâ€™s API, so the endpoint with this option enabled should not be publicly accessible.</p><h5 id="ANY-OPENSTACK-VERSION-EXCEPT-MITAKAïƒ"><a href="#ANY-OPENSTACK-VERSION-EXCEPT-MITAKAïƒ" class="headerlink" title="ANY OPENSTACK VERSION EXCEPT MITAKAïƒ"></a>ANY OPENSTACK VERSION EXCEPT MITAKA<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#any-openstack-version-except-mitaka" title="Permalink to this heading">ïƒ</a></h5><p>If you want to enable copy-on-write cloning of images, also add under the <code>&lt;span class=&quot;pre&quot;&gt;[DEFAULT]&lt;/span&gt;</code> section:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_image_direct_url = True</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_image_direct_url = True</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨OpenStackä¸­ï¼ŒGlanceæ˜¯ç”¨äºç®¡ç†è™šæ‹Ÿæœºé•œåƒçš„ç»„ä»¶ï¼Œè€ŒCephåˆ™æ˜¯ä¸€ç§åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œå¸¸è¢«ç”¨äºOpenStackçš„åç«¯å­˜å‚¨ã€‚åœ¨ä½ æåˆ°çš„é…ç½®ä¸­ï¼Œ<code>show_image_direct_url = True</code> æ˜¯ç”¨äºé…ç½® Glance çš„ <code>glance-api.conf</code> æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒç”¨äºå¯ç”¨æˆ–ç¦ç”¨æ˜¾ç¤ºé•œåƒç›´æ¥URLçš„åŠŸèƒ½ã€‚å½“ä½ è®¾ç½® <code>show_image_direct_url = True</code> æ—¶ï¼ŒGlance API å°†åŒ…å«ä¸€ä¸ªåä¸º <code>direct_url</code> çš„å±æ€§ï¼Œè¯¥å±æ€§åŒ…å«æŒ‡å‘å­˜å‚¨é•œåƒç›´æ¥URLçš„é“¾æ¥ã€‚è¿™ä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ç›´æ¥URLè®¿é—®é•œåƒï¼Œè€Œä¸å¿…é€šè¿‡ Glance API æœåŠ¡ã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ˜¯æœ‰ç”¨çš„ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½ å¸Œæœ›é€šè¿‡ç›´æ¥é“¾æ¥å…±äº«é•œåƒç»™å…¶ä»–ç”¨æˆ·æˆ–ç³»ç»Ÿï¼Œè€Œæ— éœ€é€šè¿‡ Glance API ã€‚åœ¨ Ceph å’Œ OpenStack é›†æˆçš„æƒ…å†µä¸‹ï¼Œä½ éœ€è¦ç¡®ä¿ Glance é…ç½®æ–‡ä»¶ä¸­çš„ <code>default_store</code> è®¾ç½®ä¸º <code>rbd</code>ï¼Œä»¥ä¾¿å°†é•œåƒå­˜å‚¨åœ¨ Ceph RBDï¼ˆå—è®¾å¤‡ï¼‰åç«¯ã€‚åŒæ—¶ï¼Œä½ éœ€è¦é…ç½®å¥½ Ceph çš„è®¿é—®æƒé™ï¼Œç¡®ä¿ OpenStack çš„å„ä¸ªç»„ä»¶å¯ä»¥æ­£ç¡®åœ°è®¿é—®å’Œä½¿ç”¨ Ceph å­˜å‚¨ã€‚</p></blockquote><h2 id="ciner-å®˜ç½‘å‚è€ƒ"><a href="#ciner-å®˜ç½‘å‚è€ƒ" class="headerlink" title="ciner(å®˜ç½‘å‚è€ƒ)"></a>ciner(å®˜ç½‘å‚è€ƒ)</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/cinder/cinder-volume.conf</p><blockquote><p>OpenStack requires a driver to interact with Ceph block devices. You must also specify the pool name for the block device. On your OpenStack node, edit <code>/etc/cinder/cinder.conf</code> by adding:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">...</span><br><span class="line">enabled_backends = ceph</span><br><span class="line">glance_api_version = 2</span><br><span class="line">...</span><br><span class="line">[ceph]</span><br><span class="line">volume_driver = cinder.volume.drivers.rbd.RBDDriver</span><br><span class="line">volume_backend_name = ceph</span><br><span class="line">rbd_pool = volumes</span><br><span class="line">rbd_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">rbd_flatten_volume_from_snapshot = false</span><br><span class="line">rbd_max_clone_depth = 5</span><br><span class="line">rbd_store_chunk_size = 4</span><br><span class="line">rados_connect_timeout = -1</span><br></pre></td></tr></table></figure><p>If you are using <a href="https://docs.ceph.com/en/reef/rados/configuration/auth-config-ref/#enabling-disabling-cephx">cephx authentication</a>, also configure the user and uuid of the secret you added to <code> libvirt</code> as documented earlier:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ceph]</span><br><span class="line">...</span><br><span class="line">rbd_user = cinder</span><br><span class="line">rbd_secret_uuid = 457eb676-33da-42ec-9a8c-9293d545c337</span><br></pre></td></tr></table></figure><p>Note that if you are configuring multiple cinder back ends, <code>&lt;span class=&quot;pre&quot;&gt;glance_api_version&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span class=&quot;pre&quot;&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span class=&quot;pre&quot;&gt;2&lt;/span&gt;</code> must be in the <code>&lt;span class=&quot;pre&quot;&gt;[DEFAULT]&lt;/span&gt;</code> section.</p></blockquote><p><strong>enabled_backends = ceph</strong>  æ­¤é…ç½®å®é™…ä¸Šåç«¯æ‰‹åŠ¨æ“ä½œä¸ºå¦‚ä¸‹ å®é™…ä¸Šå°±æ˜¯åˆ›å»ºç£ç›˜æ—¶é€‰æ‹©çš„ç±»å‹ æ–°ç‰ˆæœ¬ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»º é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆå³å¯</p><p>æ¯”å¦‚ æˆ‘æ‰‹åŠ¨åˆ›å»ºrbd-1ç±»å‹æ—¶åˆ™ä¼šæŠ¥é”™ï¼š</p><p>æ‰§è¡Œ cinder type-key 1f90a0e1-3657-4d42-9965-4e9ab76ed635  set volume_backend_name=rbd-1 æŠ¥é”™<br>ERROR: Volume Type is currently in use. (HTTP 400) (Request-ID: req-48ab8f51-d024-45e4-a9f8-376f7c71bf45)</p><blockquote><p>cinder type-create ceph</p><p>cinder type-key 8a8a69b6-ec9f-4a09-8126-a211fce34ef3 set  volume_backend_name=ceph</p><p>cinder type-list</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_081d10d51610d49db32c3074544340f6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_081d10d51610d49db32c3074544340f6.png"></p></blockquote><h2 id="ciner-backup"><a href="#ciner-backup" class="headerlink" title="ciner-backup"></a>ciner-backup</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/cinder/cinder-backup.conf</p><p>äº‹å®ä¸Šé»˜è®¤ä½¿ç”¨çš„é©±åŠ¨æ˜¯swifté©±åŠ¨ ZzNnWn.ä½¿ç”¨é©±åŠ¨ä¸º<strong>cinder.backup.drivers.ceph.CephBackupDriver</strong> éœ€è¦æ³¨æ„çš„æ˜¯<strong>cinder.backup.drivers.ceph</strong>æ­¤é©±åŠ¨å·²å¼ƒç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">backup_driver= cinder.backup.drivers.swift.SwiftBackupDriver</span><br><span class="line">backup_driver=cinder.backup.drivers.swift.SwiftBackupDriver</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c901ca872c1b350140046935d9a97ad.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c901ca872c1b350140046935d9a97ad.png"></p><blockquote><p>å®˜ç½‘å¼•ç”¨</p><h3 id="CONFIGURING-CINDER-BACKUPïƒ"><a href="#CONFIGURING-CINDER-BACKUPïƒ" class="headerlink" title="CONFIGURING CINDER BACKUPïƒ"></a>CONFIGURING CINDER BACKUP<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#configuring-cinder-backup" title="Permalink to this heading">ïƒ</a></h3><p>OpenStack Cinder Backup requires a specific daemon so donâ€™t forget to install it. On your Cinder Backup node, edit <code>/etc/cinder/cinder.conf</code> and add:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">backup_driver = cinder.backup.drivers.ceph</span><br><span class="line">backup_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">backup_ceph_user = cinder-backup</span><br><span class="line">backup_ceph_chunk_size = 134217728</span><br><span class="line">backup_ceph_pool = backups</span><br><span class="line">backup_ceph_stripe_unit = 0</span><br><span class="line">backup_ceph_stripe_count = 0</span><br><span class="line">restore_discard_excess_bytes = <span class="literal">true</span></span><br></pre></td></tr></table></figure></blockquote><h2 id="novaä¸ceph"><a href="#novaä¸ceph" class="headerlink" title="novaä¸ceph"></a>novaä¸ceph</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/nova/nova-compute.conf</p><p>æ­¤å¤„åº”è®¾ç½®ä¸ºå¦‚ä¸‹</p><p>rbd_secret_uuid é€šè¿‡å¦‚ä¸‹ä¸¤ç§æ–¹å¼çš†å¯æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install libvirt-clients -y</span><br><span class="line">virsh secret-list  (æ­¤ç§ä¸ºå·²ä¸openstacké›†æˆæ‰èƒ½ä½¿ç”¨)</span><br><span class="line"><span class="built_in">cat</span> /etc/kolla/passwords.yml |grep rbd_secret_uuid</span><br></pre></td></tr></table></figure><p>å®Œæ•´é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># novaçš„é…ç½®</span></span><br><span class="line">vi /etc/kolla/config/nova/nova-compute.conf</span><br><span class="line"><span class="comment"># æ·»åŠ ï¼š   </span></span><br><span class="line">[libvirt]   </span><br><span class="line">virt_type=kvm  </span><br><span class="line">cpu_mode=none </span><br><span class="line">images_rbd_pool=vms</span><br><span class="line">images_type=rbd</span><br><span class="line">images_rbd_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line">rbd_user=nova</span><br><span class="line"><span class="comment"># rbd_secret_uuid=ea241bba-2031-4b0e-b750-c8356cbb46a8 (å¯é€‰ä¸éœ€è¦é…ç½®åç«¯ä¼šè‡ªåŠ¨ç”Ÿæˆ)</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5cdbe807c394a81c86e7f04b76d40922.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5cdbe807c394a81c86e7f04b76d40922.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4e38f71c5e42268c245ab6d95a5044b5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4e38f71c5e42268c245ab6d95a5044b5.png"></p><blockquote><p>å®˜ç½‘å¼•ç”¨</p><h3 id="CONFIGURING-NOVA-TO-ATTACH-CEPH-RBD-BLOCK-DEVICEïƒ"><a href="#CONFIGURING-NOVA-TO-ATTACH-CEPH-RBD-BLOCK-DEVICEïƒ" class="headerlink" title="CONFIGURING NOVA TO ATTACH CEPH RBD BLOCK DEVICEïƒ"></a>CONFIGURING NOVA TO ATTACH CEPH RBD BLOCK DEVICE<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#configuring-nova-to-attach-ceph-rbd-block-device" title="Permalink to this heading">ïƒ</a></h3><p>In order to attach Cinder devices (either normal block or by issuing a boot from volume), you must tell Nova (and libvirt) which user and UUID to refer to when attaching the device. libvirt will refer to this user when connecting and authenticating with the Ceph cluster.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[libvirt]</span><br><span class="line">...</span><br><span class="line">rbd_user = cinder</span><br><span class="line">rbd_secret_uuid = 457eb676-33da-42ec-9a8c-9293d545c337</span><br></pre></td></tr></table></figure><p>These two flags are also used by the Nova ephemeral back end.</p><h3 id="CONFIGURING-NOVAïƒ"><a href="#CONFIGURING-NOVAïƒ" class="headerlink" title="CONFIGURING NOVAïƒ"></a>CONFIGURING NOVA<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#configuring-nova" title="Permalink to this heading">ïƒ</a></h3><p>In order to boot virtual machines directly from Ceph volumes, you must configure the ephemeral backend for Nova.</p><p>It is recommended to enable the RBD cache in your Ceph configuration file; this has been enabled by default since the Giant release. Moreover, enabling the client admin socket allows the collection of metrics and can be invaluable for troubleshooting.</p><p>This socket can be accessed on the hypervisor (Nova compute) node:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph daemon /var/run/ceph/ceph-client.cinder.19195.32310016.asok help</span><br></pre></td></tr></table></figure><p>To enable RBD cache and admin sockets, ensure that on each hypervisorâ€™s <code>&lt;span class=&quot;pre&quot;&gt;ceph.conf&lt;/span&gt;</code> contains:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">    rbd cache = true</span><br><span class="line">    rbd cache writethrough until flush = true</span><br><span class="line">    admin socket = /var/run/ceph/guests/$cluster-$type.$id.$pid.$cctid.asok</span><br><span class="line">    log file = /var/log/qemu/qemu-guest-$pid.log</span><br><span class="line">    rbd concurrent management ops = 20</span><br></pre></td></tr></table></figure><p>Configure permissions for these directories:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /var/run/ceph/guests/ /var/log/qemu/</span><br><span class="line">chown qemu:libvirtd /var/run/ceph/guests /var/log/qemu/</span><br></pre></td></tr></table></figure><p>Note that user <code>&lt;span class=&quot;pre&quot;&gt;qemu&lt;/span&gt;</code> and group <code>&lt;span class=&quot;pre&quot;&gt;libvirtd&lt;/span&gt;</code> can vary depending on your system. The provided example works for RedHat based systems.</p><p>Tip</p><p>If your virtual machine is already running you can simply restart it to enable the admin socket</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•</title>
      <link href="/2024/04/01/openstack%E4%B8%8Eceph%E9%9B%86%E6%88%90%E5%AE%8C%E6%88%90%E5%90%8E%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/"/>
      <url>/2024/04/01/openstack%E4%B8%8Eceph%E9%9B%86%E6%88%90%E5%AE%8C%E6%88%90%E5%90%8E%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•"><a href="#openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•" class="headerlink" title="openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•"></a>openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•</h1><h2 id="ä¸€-glanceå¯¹æ¥åŠŸèƒ½æµ‹è¯•"><a href="#ä¸€-glanceå¯¹æ¥åŠŸèƒ½æµ‹è¯•" class="headerlink" title="ä¸€. glanceå¯¹æ¥åŠŸèƒ½æµ‹è¯•"></a>ä¸€. glanceå¯¹æ¥åŠŸèƒ½æµ‹è¯•</h2><h3 id="ä¸Šä¼ é•œåƒã€success-ã€‘"><a href="#ä¸Šä¼ é•œåƒã€success-ã€‘" class="headerlink" title="ä¸Šä¼ é•œåƒã€success!ã€‘"></a>ä¸Šä¼ é•œåƒã€success!ã€‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸Šä¼ é•œåƒ</span></span><br><span class="line">root@localhost:~<span class="comment"># openstack image create &quot;cirros-0.4.0-x86_64&quot; --file cirros-0.4.0-x86_64-disk.img --disk-format qcow2 --container-format bare --public</span></span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">root@localhost:~<span class="comment"># glance image-list</span></span><br><span class="line">+--------------------------------------+---------------------+</span><br><span class="line">| ID                                   | Name                |</span><br><span class="line">+--------------------------------------+---------------------+</span><br><span class="line">| 73d31ccc-8eae-49e9-a0a7-2731e5a3806a | cirros-0.4.0-x86_64 |</span><br><span class="line">+--------------------------------------+---------------------+</span><br><span class="line">root@localhost:~<span class="comment"># rbd -p images ls</span></span><br><span class="line">73d31ccc-8eae-49e9-a0a7-2731e5a3806a</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å—è®¾å¤‡(é•œåƒ)è¯¦æƒ…</span></span><br><span class="line">root@localhost:~<span class="comment"># rbd -p images info 73d31ccc-8eae-49e9-a0a7-2731e5a3806a</span></span><br><span class="line">rbd image <span class="string">&#x27;73d31ccc-8eae-49e9-a0a7-2731e5a3806a&#x27;</span>:</span><br><span class="line">        size 12 MiB <span class="keyword">in</span> 2 objects</span><br><span class="line">        order 23 (8 MiB objects)</span><br><span class="line">        snapshot_count: 1</span><br><span class="line">        <span class="built_in">id</span>: 1c4b9299cdad7</span><br><span class="line">        block_name_prefix: rbd_data.1c4b9299cdad7</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        access_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        modify_timestamp: Tue Apr  2 05:43:02 2024</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¿«ç…§ã€å­˜åœ¨ã€‘"><a href="#æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¿«ç…§ã€å­˜åœ¨ã€‘" class="headerlink" title="æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¿«ç…§ã€å­˜åœ¨ã€‘"></a>æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¿«ç…§ã€å­˜åœ¨ã€‘</h3><p><strong>protected: True</strong>(æ­¤å¤„â€“æ­¤æ ‡ç­¾è¡¨ç¤ºè¢«ä¿æŠ¤èµ·æ¥äº† æ— æ³•ç›´æ¥åˆ é™¤ åé¢é›†æˆnovaå ä½¿ç”¨æ­¤é•œåƒåˆ›å»ºè™šæ‹Ÿæœº ä»–ä¼šé’ˆå¯¹æ­¤é•œåƒå¿«ç…§ å…‹éš†ä¸€ä¸ªå‡ºæ¥)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:~<span class="comment"># rbd snap ls images/73d31ccc-8eae-49e9-a0a7-2731e5a3806a</span></span><br><span class="line">SNAPID  NAME  SIZE    PROTECTED  TIMESTAMP   </span><br><span class="line">    13  snap  12 MiB  <span class="built_in">yes</span>        Tue Apr  2 05:43:04 2024</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¿«ç…§è¯¦æƒ…</span></span><br><span class="line">root@localhost:~<span class="comment"># rbd info images/73d31ccc-8eae-49e9-a0a7-2731e5a3806a@snap</span></span><br><span class="line">rbd image <span class="string">&#x27;73d31ccc-8eae-49e9-a0a7-2731e5a3806a&#x27;</span>:</span><br><span class="line">        size 12 MiB <span class="keyword">in</span> 2 objects</span><br><span class="line">        order 23 (8 MiB objects)</span><br><span class="line">        snapshot_count: 1</span><br><span class="line">        <span class="built_in">id</span>: 1c4b9299cdad7</span><br><span class="line">        block_name_prefix: rbd_data.1c4b9299cdad7</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        access_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        modify_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        protected: True  (æ­¤å¤„--æ­¤æ ‡ç­¾è¡¨ç¤ºè¢«ä¿æŠ¤èµ·æ¥äº†)</span><br></pre></td></tr></table></figure><h3 id="æ—¥å¿—æŸ¥çœ‹"><a href="#æ—¥å¿—æŸ¥çœ‹" class="headerlink" title="æ—¥å¿—æŸ¥çœ‹"></a>æ—¥å¿—æŸ¥çœ‹</h3><p>kolla-ansibleéƒ¨ç½²çš„é›†ç¾¤<strong>glance</strong>å‡ºç°é—®é¢˜å¯åœ¨<code>/var/log/kolla/glance/glance-api.log</code>ä¸­æŸ¥çœ‹<strong>æ­¤æ—¶glanceå¯¹æ¥å®Œæˆã€‚</strong></p><h2 id="äºŒ-cinerå¯¹æ¥åŠŸèƒ½æµ‹è¯•"><a href="#äºŒ-cinerå¯¹æ¥åŠŸèƒ½æµ‹è¯•" class="headerlink" title="äºŒ. cinerå¯¹æ¥åŠŸèƒ½æµ‹è¯•"></a>äºŒ. cinerå¯¹æ¥åŠŸèƒ½æµ‹è¯•</h2><h3 id="å‰ç«¯é¡µé¢åˆ›å»ºç£ç›˜åç«¯cephæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€success-ã€‘"><a href="#å‰ç«¯é¡µé¢åˆ›å»ºç£ç›˜åç«¯cephæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€success-ã€‘" class="headerlink" title="å‰ç«¯é¡µé¢åˆ›å»ºç£ç›˜åç«¯cephæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€success!ã€‘"></a>å‰ç«¯é¡µé¢åˆ›å»ºç£ç›˜åç«¯cephæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€success!ã€‘</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c52afb0c1b17c459ac6dc022eff72bf8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c52afb0c1b17c459ac6dc022eff72bf8.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">oot@localhost:~<span class="comment"># rbd -p volumes ls |grep cdfce732-c69f-4ea6-9f95-181c19b932dd</span></span><br><span class="line">volume-cdfce732-c69f-4ea6-9f95-181c19b932dd</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ‰©å®¹äº‘ç¡¬ç›˜ã€success-ã€‘"><a href="#æ‰©å®¹äº‘ç¡¬ç›˜ã€success-ã€‘" class="headerlink" title="æ‰©å®¹äº‘ç¡¬ç›˜ã€success!ã€‘"></a>æ‰©å®¹äº‘ç¡¬ç›˜ã€success!ã€‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:~<span class="comment"># rbd -p volumes info volume-cdfce732-c69f-4ea6-9f95-181c19b932dd</span></span><br><span class="line">rbd image <span class="string">&#x27;volume-cdfce732-c69f-4ea6-9f95-181c19b932dd&#x27;</span>:</span><br><span class="line">        size 5 GiB <span class="keyword">in</span> 1280 objects   ã€æˆåŠŸæ‰©å®¹åˆ°äº†5Gã€‘</span><br><span class="line">        order 22 (4 MiB objects)</span><br><span class="line">        snapshot_count: 0</span><br><span class="line">        <span class="built_in">id</span>: 1ce49280a276</span><br><span class="line">        block_name_prefix: rbd_data.1ce49280a276</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        access_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        modify_timestamp: Tue Apr  2 07:01:15 2024</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºå¿«ç…§ã€å‰ç«¯-åç«¯-success-ã€‘"><a href="#åˆ›å»ºå¿«ç…§ã€å‰ç«¯-åç«¯-success-ã€‘" class="headerlink" title="åˆ›å»ºå¿«ç…§ã€å‰ç«¯/åç«¯ success!ã€‘"></a>åˆ›å»ºå¿«ç…§ã€å‰ç«¯/åç«¯ success!ã€‘</h3><p>æŸ¥çœ‹åç«¯å¿«ç…§åŠå¿«ç…§è¯¦æƒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:~<span class="comment"># rbd -p  volumes ls</span></span><br><span class="line">volume-0069c8f9-4f25-4233-91a9-a2f27006f208</span><br><span class="line">volume-0b204bfd-a83b-4d02-aa5c-b7894d710f07</span><br><span class="line">volume-69c5a7f6-fdc8-4c81-9a24-9ffc3aa413ce</span><br><span class="line">volume-ad6ee530-b73e-4605-b0aa-fc6813e10b8a</span><br><span class="line">volume-cdfce732-c69f-4ea6-9f95-181c19b932dd</span><br><span class="line">root@localhost:~<span class="comment"># rbd -p volumes snap ls  volume-cdfce732-c69f-4ea6-9f95-181c19b932dd</span></span><br><span class="line">SNAPID  NAME                                           SIZE   PROTECTED  TIMESTAMP             </span><br><span class="line">    10  snapshot-d8b94a76-c1b1-48c6-a5f7-d7a478b5cf8c  5 GiB  <span class="built_in">yes</span>        Tue Apr  2 07:23:35 2024</span><br><span class="line">root@localhost:~<span class="comment"># rbd info volumes/volume-cdfce732-c69f-4ea6-9f95-181c19b932dd@snapshot-d8b94a76-c1b1-48c6-a5f7-d7a478b5cf8c</span></span><br><span class="line">rbd image <span class="string">&#x27;volume-cdfce732-c69f-4ea6-9f95-181c19b932dd&#x27;</span>:</span><br><span class="line">        size 5 GiB <span class="keyword">in</span> 1280 objects</span><br><span class="line">        order 22 (4 MiB objects)</span><br><span class="line">        snapshot_count: 1</span><br><span class="line">        <span class="built_in">id</span>: 1ce49280a276</span><br><span class="line">        block_name_prefix: rbd_data.1ce49280a276</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        access_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        modify_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        protected: True</span><br></pre></td></tr></table></figure><h3 id="æ—¥å¿—æŸ¥çœ‹-1"><a href="#æ—¥å¿—æŸ¥çœ‹-1" class="headerlink" title="æ—¥å¿—æŸ¥çœ‹"></a>æ—¥å¿—æŸ¥çœ‹</h3><p>æŠ¥é”™æŸ¥çœ‹cineræ—¥å¿—æ–‡ä»¶ç›®å½•ï¼š/var/log/kolla/cinder/</p><p>cinder-api-access.log  cinder-api-error.log  cinder-api.log  cinder-backup.log  cinder-scheduler.log  cinder-volume.log</p><p><strong>ciner</strong>å¯¹æ¥å®Œæˆã€‚</p><h2 id="ä¸‰-ciner-backupå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€å‰ç«¯-åç«¯success-ã€‘"><a href="#ä¸‰-ciner-backupå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€å‰ç«¯-åç«¯success-ã€‘" class="headerlink" title="ä¸‰. ciner-backupå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€å‰ç«¯/åç«¯success!ã€‘"></a>ä¸‰. ciner-backupå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€å‰ç«¯/åç«¯success!ã€‘</h2><h3 id="åˆ›å»ºäº‘ç¡¬ç›˜å¤‡ä»½"><a href="#åˆ›å»ºäº‘ç¡¬ç›˜å¤‡ä»½" class="headerlink" title="åˆ›å»ºäº‘ç¡¬ç›˜å¤‡ä»½"></a>åˆ›å»ºäº‘ç¡¬ç›˜å¤‡ä»½</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_baec65a01ef1848667e37913f18fb4a2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_baec65a01ef1848667e37913f18fb4a2.png"></p><p>å‰ç«¯åˆ›å»ºå®Œæˆå…¶å®åç«¯å®ç°æ–¹å¼å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¸®åŠ©</span></span><br><span class="line">cinder -h |grep backup</span><br><span class="line">cinder <span class="built_in">help</span> backup-create</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># cinder list</span></span><br><span class="line">+--------------------------------------+-----------+-------------+------+----------------+-------------+----------+-------------+</span><br><span class="line">| ID                                   | Status    | Name        | Size | Consumes Quota | Volume Type | Bootable | Attached to |</span><br><span class="line">+--------------------------------------+-----------+-------------+------+----------------+-------------+----------+-------------+</span><br><span class="line">| cdfce732-c69f-4ea6-9f95-181c19b932dd | available | cinder-test | 5    | True           | __DEFAULT__ | <span class="literal">false</span>    |             |</span><br><span class="line">+--------------------------------------+-----------+-------------+------+----------------+-------------+----------+-------------+</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹å…¶è¿›è¡Œå¤‡ä»½</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># cinder backup-create cdfce732-c69f-4ea6-9f95-181c19b932dd --name backup-demo</span></span><br><span class="line">+-----------+--------------------------------------+</span><br><span class="line">| Property  | Value                                |</span><br><span class="line">+-----------+--------------------------------------+</span><br><span class="line">| <span class="built_in">id</span>        | c9c3ef24-e310-4685-aa54-64cd6fa7d08b |</span><br><span class="line">| name      | backup-demo                          |</span><br><span class="line">| volume_id | cdfce732-c69f-4ea6-9f95-181c19b932dd |</span><br><span class="line">+-----------+--------------------------------------+</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># cinder backup-list</span></span><br><span class="line">+--------------------------------------+--------------------------------------+-----------+-------------+------+--------------+-----------+----------------------------------+</span><br><span class="line">| ID                                   | Volume ID                            | Status    | Name        | Size | Object Count | Container | User ID                          |</span><br><span class="line">+--------------------------------------+--------------------------------------+-----------+-------------+------+--------------+-----------+----------------------------------+</span><br><span class="line">| 6774233c-007a-4d49-a8a7-38dc9993b440 | cdfce732-c69f-4ea6-9f95-181c19b932dd | available | <span class="built_in">test</span>        | 5    | 0            | backups   | d9737a89a5754af99610d37225abd070 |</span><br><span class="line">| c9c3ef24-e310-4685-aa54-64cd6fa7d08b | cdfce732-c69f-4ea6-9f95-181c19b932dd | available | backup-demo | 5    | 0            | backups   | d9737a89a5754af99610d37225abd070 |</span><br><span class="line">+--------------------------------------+--------------------------------------+-----------+-------------+------+--------------+-----------+----------------------------------+</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·è¯¦æƒ…</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># cinder backup-show 6774233c-007a-4d49-a8a7-38dc9993b440</span></span><br><span class="line">+-----------------------------------+--------------------------------------+</span><br><span class="line">| Property                          | Value                                |</span><br><span class="line">+-----------------------------------+--------------------------------------+</span><br><span class="line">| availability_zone                 | None                                 |</span><br><span class="line">| container                         | backups                              |</span><br><span class="line">| created_at                        | 2024-04-02T07:48:41.000000           |</span><br><span class="line">| data_timestamp                    | 2024-04-02T07:48:41.000000           |</span><br><span class="line">| description                       | None                                 |</span><br><span class="line">| fail_reason                       | None                                 |</span><br><span class="line">| has_dependent_backups             | False                                |</span><br><span class="line">| <span class="built_in">id</span>                                | 6774233c-007a-4d49-a8a7-38dc9993b440 |</span><br><span class="line">| is_incremental                    | False                                |</span><br><span class="line">| metadata                          | &#123;&#125;                                   |</span><br><span class="line">| name                              | <span class="built_in">test</span>                                 |</span><br><span class="line">| object_count                      | 0                                    |</span><br><span class="line">| os-backup-project-attr:project_id | 2cb7b9ee85ab4d8a8257723a08c8a032     |</span><br><span class="line">| size                              | 5                                    |</span><br><span class="line">| snapshot_id                       | None                                 |</span><br><span class="line">| status                            | available                            |</span><br><span class="line">| updated_at                        | 2024-04-02T07:49:01.000000           |</span><br><span class="line">| user_id                           | d9737a89a5754af99610d37225abd070     |</span><br><span class="line">| volume_id                         | cdfce732-c69f-4ea6-9f95-181c19b932dd |</span><br><span class="line">+-----------------------------------+--------------------------------------+</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·å®é™…ä¸Šå°±æ˜¯æŠŠå·æ‹·è´è¿‡æ¥ä¸€ä»½</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># rbd -p backups ls</span></span><br><span class="line">volume-cdfce732-c69f-4ea6-9f95-181c19b932dd.backup.6774233c-007a-4d49-a8a7-38dc9993b440</span><br><span class="line">volume-cdfce732-c69f-4ea6-9f95-181c19b932dd.backup.c9c3ef24-e310-4685-aa54-64cd6fa7d08b</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ciner-backup</strong>å¯¹æ¥å®Œæˆã€‚</p><h2 id="å››-nova-libvirt-ä¸cephå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€successï¼ã€‘"><a href="#å››-nova-libvirt-ä¸cephå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€successï¼ã€‘" class="headerlink" title="å››. nova(libvirt)ä¸cephå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€successï¼ã€‘"></a>å››. nova(libvirt)ä¸cephå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€successï¼ã€‘</h2><h3 id="åˆ›å»ºè™šæ‹Ÿæœºæµ‹è¯•-å‰ç«¯åˆ›å»ºåç«¯éªŒè¯"><a href="#åˆ›å»ºè™šæ‹Ÿæœºæµ‹è¯•-å‰ç«¯åˆ›å»ºåç«¯éªŒè¯" class="headerlink" title="åˆ›å»ºè™šæ‹Ÿæœºæµ‹è¯• (å‰ç«¯åˆ›å»ºåç«¯éªŒè¯)"></a>åˆ›å»ºè™šæ‹Ÿæœºæµ‹è¯• (å‰ç«¯åˆ›å»ºåç«¯éªŒè¯)</h3><p><strong>æŸ¥çœ‹ç³»ç»Ÿç›˜</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(venv3) root@localhost:~<span class="comment"># rbd -p volumes ls |grep 39a0ae42-08b3-4885-850f-12536e3d2051</span></span><br><span class="line">volume-39a0ae42-08b3-4885-850f-12536e3d2051</span><br><span class="line">(venv3) root@localhost:~<span class="comment"># rbd device list</span></span><br><span class="line">(venv3) root@localhost:~<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_245c6b28748b4fb29da0f259cc4be37d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_245c6b28748b4fb29da0f259cc4be37d.png"></p>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦åŠgrafanaé¢æ¿è®¾ç½®</title>
      <link href="/2024/03/28/zabbix%E7%9B%91%E6%8E%A7%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AE%E6%8A%A5%E8%AD%A6%E5%8F%8Agrafana%E9%9D%A2%E6%9D%BF%E8%AE%BE%E7%BD%AE/"/>
      <url>/2024/03/28/zabbix%E7%9B%91%E6%8E%A7%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AE%E6%8A%A5%E8%AD%A6%E5%8F%8Agrafana%E9%9D%A2%E6%9D%BF%E8%AE%BE%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦"><a href="#zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦" class="headerlink" title="zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦"></a>zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦</h1><h2 id="ä¸€-ä¼ä¸šå¾®ä¿¡æŠ¥è­¦"><a href="#ä¸€-ä¼ä¸šå¾®ä¿¡æŠ¥è­¦" class="headerlink" title="ä¸€. ä¼ä¸šå¾®ä¿¡æŠ¥è­¦"></a>ä¸€. ä¼ä¸šå¾®ä¿¡æŠ¥è­¦</h2><p>åç«¯é…ç½®<br>è¯­è¨€ï¼š<strong>shell</strong><br>è„šæœ¬ï¼š/usr/lib/zabbix/alertscripts/weixin.sh<br>ç»„åæ”¹ä¸ºï¼š<strong>zabbix:zabbix</strong><br><strong>chmod a+x weixin.sh</strong>  èµ‹äºˆæ‰§è¡Œæƒé™<br><strong>weixin.sh</strong>è„šæœ¬å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># è„šæœ¬ä½¿ç”¨ï¼šzz=`ls -l`</span></span><br><span class="line"><span class="comment"># ./weixin.sh test  &#123;&quot;errcode&quot;:0,&quot;errmsg&quot;:&quot;$zz&quot;,&quot;invaliduser&quot;:&quot;&quot;&#125;</span></span><br><span class="line"><span class="comment"># ./weixin.sh test  &#123;&quot;errcode&quot;:0,&quot;GEGEWU-TEST&quot;:&quot;\nåºŠå‰æ˜æœˆå…‰\nç–‘æ˜¯åœ°ä¸Šéœœ\nä¸¾å¤´æœ›æ˜æœˆ\nä½å¤´æ€æ•…ä¹¡&quot;,&quot;invaliduser&quot;:&quot;&quot;&#125;</span></span><br><span class="line">CorpID=<span class="string">&quot;ww83dd692579d&quot;</span>                             <span class="comment"># ä½ çš„ä¼ä¸šid</span></span><br><span class="line">Secret=<span class="string">&quot;LSwoGzg-lXJFFkSztBptbgAfLrps&quot;</span>    <span class="comment"># ä½ çš„SecretID</span></span><br><span class="line">GURL=<span class="string">&quot;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=<span class="variable">$CorpID</span>&amp;corpsecret=<span class="variable">$Secret</span>&quot;</span></span><br><span class="line">Token=$(/usr/bin/curl -s -G <span class="variable">$GURL</span> |awk -F\&quot;: <span class="string">&#x27;&#123;print $4&#125;&#x27;</span>|awk -F\&quot; <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line"><span class="comment"># echo $Token</span></span><br><span class="line">PURL=<span class="string">&quot;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=<span class="variable">$Token</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">body</span></span>()&#123;</span><br><span class="line">        <span class="built_in">local</span> int agentid=1000002               <span class="comment"># ä½ çš„agentdid</span></span><br><span class="line">        <span class="built_in">local</span> UserID=<span class="string">&quot;@all&quot;</span>                     <span class="comment"># å‘é€çš„ç”¨æˆ·ID</span></span><br><span class="line">        <span class="built_in">local</span> PartyID=2                         <span class="comment"># éƒ¨é—¨ID</span></span><br><span class="line">        <span class="built_in">local</span> Msg=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span> | <span class="built_in">cut</span> -d<span class="string">&quot; &quot;</span> -f3-) <span class="comment"># å‘é€ç»™æ‰€æœ‰äºº</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;&#123;\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;touser&quot;: &quot;&#x27;</span><span class="string">&quot;<span class="variable">$UserID</span>&quot;</span>\&quot;<span class="string">&quot;,\n&quot;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;toparty&quot;: &quot;&#x27;</span><span class="string">&quot;<span class="variable">$PartyID</span>&quot;</span>\&quot;<span class="string">&quot;,\n&quot;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;msgtype&quot;: &quot;text&quot;,\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;agentid&quot;: &quot;&#x27;</span><span class="string">&quot;<span class="variable">$agentid</span>&quot;</span>\&quot;<span class="string">&quot;,\n&quot;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;text&quot;: &#123;\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t\t&quot;content&quot;: &quot;&#x27;</span><span class="string">&quot;<span class="variable">$Msg</span>&quot;</span>\&quot;<span class="string">&quot;\n&quot;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&#125;,\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;safe&quot;:&quot;0&quot;\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;&#125;\n&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">/usr/bin/curl --data-ascii <span class="string">&quot;<span class="subst">$(body $1 $2 $3)</span>&quot;</span> <span class="variable">$PURL</span></span><br></pre></td></tr></table></figure><p>å¯ç”¨æ€§æµ‹è¯•</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6423a1843860753100db9c0cb961464a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6423a1843860753100db9c0cb961464a.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9eeec69992482f2c02585016a1a9ebc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9eeec69992482f2c02585016a1a9ebc.png"></p><p>ä»¥ä¸Šå¾®ä¿¡æŠ¥è­¦åç«¯é…ç½®å®Œæ¯•ï¼</p><h3 id="1-zabbixå‰ç«¯é¡µé¢é…ç½®å‘Šè­¦"><a href="#1-zabbixå‰ç«¯é¡µé¢é…ç½®å‘Šè­¦" class="headerlink" title="1. zabbixå‰ç«¯é¡µé¢é…ç½®å‘Šè­¦"></a>1. zabbixå‰ç«¯é¡µé¢é…ç½®å‘Šè­¦</h3><h4 id="1-0-ç®¡ç†-ç”¨æˆ·-é…ç½®æŠ¥è­¦æ—¶é—´-ç­‰çº§"><a href="#1-0-ç®¡ç†-ç”¨æˆ·-é…ç½®æŠ¥è­¦æ—¶é—´-ç­‰çº§" class="headerlink" title="1.0. ç®¡ç†-ç”¨æˆ· é…ç½®æŠ¥è­¦æ—¶é—´ ç­‰çº§"></a>1.0. ç®¡ç†-ç”¨æˆ· é…ç½®æŠ¥è­¦æ—¶é—´ ç­‰çº§</h4><p>ç‰¹åˆ«è¯´æ˜ï¼šæ”¶ä»¶äºº-2   2 ä¸ºæŠ¥è­¦<strong>æœºå™¨äººæ‰€åœ¨çš„béƒ¨é—¨id</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_888125f3de45e9c9945bac3b5d692349.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_888125f3de45e9c9945bac3b5d692349.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_b6fa1a78467aa2bbbaad45ef6447659a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_b6fa1a78467aa2bbbaad45ef6447659a.png"></p><h4 id="1-1-æŠ¥è­¦åª’ä»‹ç±»å‹"><a href="#1-1-æŠ¥è­¦åª’ä»‹ç±»å‹" class="headerlink" title="1.1. æŠ¥è­¦åª’ä»‹ç±»å‹"></a>1.1. æŠ¥è­¦åª’ä»‹ç±»å‹</h4><p><strong>ç®¡ç†-æŠ¥è­¦åª’ä»‹ç±»å‹-åˆ›å»ºåª’ä½“ç±»å‹</strong></p><p><strong>è„šæœ¬å‚æ•°</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;ALERT.SENDTO&#125;</span><br><span class="line">&#123;ALERT.SUBJECT&#125;</span><br><span class="line">&#123;ALERT.MESSAGE&#125;</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8c5386fe48f1b7a90f3c7ef75ed02192.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8c5386fe48f1b7a90f3c7ef75ed02192.png"></p><p><strong>è®¾ç½®é»˜è®¤æŠ¥è­¦å‘é€ä¿¡æ¯</strong></p><p>ç®¡ç†-æŠ¥è­¦åª’ä»‹ç±»å‹-åˆ›å»ºåª’ä½“ç±»å‹-message templates 3-ç‚¹å‡»æ·»åŠ -é€‰æ‹©-é—®é¢˜</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ä¸»é¢˜ï¼š</span><br><span class="line">æ•…éšœ&#123;TRIGGER.STATUS&#125;,æœºå™¨:&#123;HOSTNAME1&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;æ•…éšœ!</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line"> </span><br><span class="line">å‘Šè­¦æœºå™¨:&#123;HOSTNAME1&#125;</span><br><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;</span><br><span class="line">å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125;</span><br><span class="line">é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br></pre></td></tr></table></figure><p><strong>ç‚¹å‡»é€‰æ‹©ï¼šproblem recovery</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ä¸»é¢˜ï¼š</span><br><span class="line">æ¢å¤&#123;TRIGGER.STATUS&#125;, æœºå™¨:&#123;HOSTNAME1&#125;: &#123;TRIGGER.NAME&#125;å·²æ¢å¤!</span><br><span class="line"> </span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line">å‘Šè­¦æœºå™¨:&#123;HOSTNAME1&#125;</span><br><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;</span><br><span class="line">å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125;</span><br><span class="line">é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br></pre></td></tr></table></figure><p><strong>è®¾ç½®å¥½åæ ·å¼</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_5f6c7c481dd5a5e6f394abbc3edfbc91.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_5f6c7c481dd5a5e6f394abbc3edfbc91.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7317fad2e7265063fc284c4657d37336.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7317fad2e7265063fc284c4657d37336.png"></p><p><strong>é…ç½®-åŠ¨ä½œ-Tigger actions-åˆ›å»ºåŠ¨ä½œå¾®ä¿¡å‘Šè­¦</strong></p><ul><li>åç§° :  å¾®ä¿¡æŠ¥è­¦</li><li>è®¡ç®—æ–¹å¼ : å’Œï¼ˆåŒæ—¶æ»¡è¶³ï¼‰(A and B) and C</li><li>æ¡ä»¶</li></ul><table><thead><tr><th>æ ‡ç­¾</th><th>åç§°</th><th>åŠ¨ä½œ</th></tr></thead><tbody><tr><td><strong>A</strong></td><td>è§¦å‘å™¨åç§° ä¸å«<em>Dialer</em></td><td>ç§»é™¤</td></tr><tr><td><strong>B</strong></td><td>è§¦å‘å™¨åç§° åŒ…å«<em>down</em></td><td>ç§»é™¤</td></tr><tr><td><strong>C</strong></td><td>ä¸»æœºç¾¤ç»„ ä¸ç­‰äº<em>å¼ å®¶å£</em></td><td>ç§»é™¤</td></tr><tr><td>æ·»åŠ </td><td></td><td></td></tr></tbody></table><p>  <strong>æœ¬æ–‡ä½¿ç”¨æ­¤<br>  åç§° :  å¾®ä¿¡æŠ¥è­¦</strong><br>  è®¡ç®—æ–¹å¼ : ä¸/æˆ– ï¼ˆé»˜è®¤ï¼‰</p><table><thead><tr><th>æ ‡ç­¾</th><th>åç§°</th><th>åŠ¨ä½œ</th></tr></thead><tbody><tr><td><strong>A</strong></td><td>è§¦å‘å™¨ç¤ºè­¦åº¦ å¤§äºç­‰äº è­¦å‘Š</td><td>ç§»é™¤</td></tr><tr><td><strong>B</strong></td><td>è§¦å‘å™¨ç¤ºè­¦åº¦Â å¤§äºç­‰äº æœªåˆ†ç±»</td><td>ç§»é™¤</td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><p>  <img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8beb0459a4e8371c8d40f0b0e0bba60b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8beb0459a4e8371c8d40f0b0e0bba60b.png"></p><p>  <img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3ea30163e5c0105262ced1c11bf11d7d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3ea30163e5c0105262ced1c11bf11d7d.png"></p><ul><li><p>å·²å¯ç”¨ [X]</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_30dad5e3e18fbd9afa4fd05d59d22ec8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_30dad5e3e18fbd9afa4fd05d59d22ec8.png"></p></li></ul><p><strong>è®¾ç½®æ“ä½œ</strong></p><p>å‘Šè­¦ç»†èŠ‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®¾å¤‡:&#123;HOST.NAME&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;å‘Šè­¦!\nå‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;\nå‘Šè­¦åœ°å€:&#123;HOST.IP&#125;\nå‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br></pre></td></tr></table></figure><p>æ¢å¤ç»†èŠ‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;\nå‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;å·²æ¢å¤ï¼\nå½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;\nå‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;\næ¢å¤æ—¶é—´:&#123;EVENT.RECOVERY.DATE&#125; &#123;EVENT.RECOVERY.TIME&#125;\næŒç»­æ—¶é—´:&#123;EVENT.AGE&#125;</span><br></pre></td></tr></table></figure><p><strong>æ›´æ–°æš‚æ—¶ä¸å†™</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_2c6085aabbe2423e90b8f16a44cd3b1e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_2c6085aabbe2423e90b8f16a44cd3b1e.png"></p><h4 id="1-2-æˆ–è€…è®¾ç½®å¦‚ä¸‹å†—é•¿ç‰ˆæœ¬è®¾ç½®æ–¹å¼å¦‚ä¸‹å‚è€ƒ"><a href="#1-2-æˆ–è€…è®¾ç½®å¦‚ä¸‹å†—é•¿ç‰ˆæœ¬è®¾ç½®æ–¹å¼å¦‚ä¸‹å‚è€ƒ" class="headerlink" title="1.2. æˆ–è€…è®¾ç½®å¦‚ä¸‹å†—é•¿ç‰ˆæœ¬è®¾ç½®æ–¹å¼å¦‚ä¸‹å‚è€ƒ"></a>1.2. æˆ–è€…è®¾ç½®å¦‚ä¸‹å†—é•¿ç‰ˆæœ¬è®¾ç½®æ–¹å¼å¦‚ä¸‹å‚è€ƒ</h4><p>æ“ä½œ æ·»åŠ <br>æ­¥éª¤é€‰æ‹©ï¼š1-1<br>æ­¥éª¤æ—¶é—´ï¼š0 ï¼ˆé»˜è®¤ï¼‰<br>ç”¨æˆ·ç¾¤ç»„é»˜è®¤ç®¡ç†å‘˜ç¾¤ç»„ ï¼šZabbix administrators<br>ä»…å‘é€åˆ°ï¼šå¾®ä¿¡å‘Šè­¦<br>cus message ï¼š [X]</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ä¸»é¢˜ï¼š</span><br><span class="line">æ•…éšœ&#123;TRIGGER.STATUS&#125;,æœºå™¨:&#123;HOSTNAME1&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;æ•…éšœ!</span><br><span class="line"> </span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line">å‘Šè­¦æœºå™¨:&#123;HOSTNAME1&#125;</span><br><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;</span><br><span class="line">å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125;</span><br><span class="line">é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br></pre></td></tr></table></figure><p>æ¢å¤æ“ä½œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ä¸»é¢˜ï¼š</span><br><span class="line">æœºå™¨:&#123;HOST.NAME&#125;: &#123;TRIGGER.NAME&#125;å·²æ¢å¤!</span><br><span class="line"> </span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line">æœºå™¨:&#123;HOST.NAME&#125;: &#123;TRIGGER.NAME&#125;å·²æ¢å¤!</span><br><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;</span><br><span class="line">å‘Šè­¦åœ°å€:&#123;HOST.IP&#125;</span><br><span class="line">ç›‘æ§å–å€¼:&#123;ITEM.LASTVALUE&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">æ¢å¤æ—¶é—´:&#123;EVENT.RECOVERY.DATE&#125; &#123;EVENT.RECOVERY.TIME&#125;</span><br><span class="line">æŒç»­æ—¶é—´:&#123;EVENT.AGE&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šæ›´æ–°æ“ä½œæš‚æ—¶ä¸å†™ã€‚<br>æ­¤æ—¶ç‚¹å‡»å¯ç”¨æ–°åˆ›å»ºçš„å¾®ä¿¡å‘Šè­¦ï¼šå³å¯ç”¨åŠ¨ä½œ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3119571721f2605c8403618b944a5384.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3119571721f2605c8403618b944a5384.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_82a0baf528dbe6863ab110882f7d84e8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_82a0baf528dbe6863ab110882f7d84e8.png"></p><h2 id="äºŒ-zabbixå‡ºå›¾æ·»åŠ äº¤æ¢æœºè®¾ç½®"><a href="#äºŒ-zabbixå‡ºå›¾æ·»åŠ äº¤æ¢æœºè®¾ç½®" class="headerlink" title="äºŒ. zabbixå‡ºå›¾æ·»åŠ äº¤æ¢æœºè®¾ç½®"></a>äºŒ. zabbixå‡ºå›¾æ·»åŠ äº¤æ¢æœºè®¾ç½®</h2><h3 id="2-1-æ·»åŠ è®¾å¤‡"><a href="#2-1-æ·»åŠ è®¾å¤‡" class="headerlink" title="2.1. æ·»åŠ è®¾å¤‡"></a>2.1. æ·»åŠ è®¾å¤‡</h3><p><strong>é…ç½®-ç¾¤ç»„-åˆ›å»ºç¾¤ç»„ï¼ˆå¦‚æœªæ¥ç§‘æŠ€åŸï¼‰</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6fb86456c1f1b9eba430942b08b77ff.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6fb86456c1f1b9eba430942b08b77ff.png"></p><p><strong>ç›‘æµ‹-ä¸»æœº-æ·»åŠ ä¸»æœºï¼ˆæ ¹æ®äº¤æ¢æœºå‚å•†é€‰æ‹©åˆé€‚çš„ç›‘æ§æ¨¡æ¿å¦‚åä¸ºåˆ™é€‰æ‹©åä¸ºï¼‰</strong></p><p>ä¸»æœºåç§°ï¼š10.0.0.10<br>å¯è§åç§°ï¼šåä¸ºCE6851<br>æ¨¡æ¿ï¼š Huawei VRP by SNMP<br>ç¾¤ç»„ï¼šæœªæ¥ç§‘æŠ€åŸ<br>interfaces<br>ç±»å‹ï¼šsnmp<br>ç‰ˆæœ¬ snmpV2<br>snmp communityï¼ˆå›¢ä½“åï¼‰ï¼š passwd<br>è¿æ¥åˆ°ip DNS ç«¯å£ï¼š161<br>ç”±agentä»£ç†ç¨‹åºç›‘æµ‹ (æ— agentä»£ç†ç¨‹åº)<br>å·²å¯ç”¨</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e19dd19666176395dc07dfda08b59091.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e19dd19666176395dc07dfda08b59091.png"></p><p><strong>æ¨¡æ¿é€‰æ‹©ï¼ˆä»¥åä¸ºäº¤æ¢æœºä¸ºä¾‹ï¼‰</strong></p><p>æ¨¡æ¿-ä¸»æœºç¾¤ç»„<code>-Templates/Network devices-HuaweiVRPbySNMP</code></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f42f938f9b0285953e4100811df34b7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f42f938f9b0285953e4100811df34b7.png"></p><h3 id="2-2-åä¸ºCEç³»ä¾‹ç‰¹åˆ«è¯´æ˜"><a href="#2-2-åä¸ºCEç³»ä¾‹ç‰¹åˆ«è¯´æ˜" class="headerlink" title="2.2. åä¸ºCEç³»ä¾‹ç‰¹åˆ«è¯´æ˜"></a>2.2. åä¸ºCEç³»ä¾‹ç‰¹åˆ«è¯´æ˜</h3><p>è§ğŸ”—é“¾æ¥ | <strong><a href="https://blog.csdn.net/m0_59586152/article/details/125200506">ç‰¹åˆ«ä»‹ç»å…³äºhuaweiCEç³»åˆ—çš„cpuç›‘æ§(æ­¤å¤„zabbixè‡ªå¸¦çš„ç›‘æ§æœ‰æ—¶å€™æ— æ³•é‡‡é›†æˆåŠŸ)</a></strong></p><h2 id="ä¸‰-grafanaé¢æ¿é…ç½®ï¼ˆå»ºè®®grafanaç‰ˆæœ¬ä¸º8-5-2ï¼‰"><a href="#ä¸‰-grafanaé¢æ¿é…ç½®ï¼ˆå»ºè®®grafanaç‰ˆæœ¬ä¸º8-5-2ï¼‰" class="headerlink" title="ä¸‰. grafanaé¢æ¿é…ç½®ï¼ˆå»ºè®®grafanaç‰ˆæœ¬ä¸º8.5.2ï¼‰"></a>ä¸‰. grafanaé¢æ¿é…ç½®ï¼ˆå»ºè®®grafanaç‰ˆæœ¬ä¸º8.5.2ï¼‰</h2><h3 id="3-1-å®‰è£…zabbixæ’ä»¶"><a href="#3-1-å®‰è£…zabbixæ’ä»¶" class="headerlink" title="3.1. å®‰è£…zabbixæ’ä»¶"></a>3.1. å®‰è£…zabbixæ’ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@gegewu1:/opt/grafana-8.5.2/bin<span class="comment"># ./grafana-cli plugins install alexanderzobnin-zabbix-app</span></span><br><span class="line">âœ” Downloaded alexanderzobnin-zabbix-app v4.2.8 zip successfully</span><br><span class="line"> </span><br><span class="line">Please restart Grafana after installing plugins. Refer to Grafana documentation <span class="keyword">for</span> instructions <span class="keyword">if</span> necessary.</span><br><span class="line"> </span><br><span class="line">root@gegewu1:/opt/grafana-8.5.2/bin<span class="comment">#</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>é…ç½®zabbixæºæ—¶éœ€è¦å°†80ç«¯å£å†™å‡ºå¦åˆ™ä¼šæ·»åŠ å¤±è´¥å³ï¼š<a href="http://10.0.0.10/zabbix/api_jsonrpc.php">http://10.0.0.10:80/zabbix/api_jsonrpc.php</a></p><p><strong>é…ç½®å¥½å‰ç«¯zabbixç»„ä»¶å é€‰æ‹©åˆé€‚éœ€è¦ç›‘æ§çš„ç«¯å£å³å¯</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_a1cb215aaf904a7b1c6517dae8c43a38.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_a1cb215aaf904a7b1c6517dae8c43a38.png"></p><p><strong>æ•ˆæœ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_9e24dccc0ed9e1529e55edd526aef9ea.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_9e24dccc0ed9e1529e55edd526aef9ea.png"></p><p>æœ¬æ–‡å‚è€ƒ |<br><a href="https://blog.csdn.net/m0_59586152/article/details/125136342">https://blog.csdn.net/m0_59586152/article/details/125136342</a><br><a href="https://blog.csdn.net/m0_59586152/article/details/125200506">https://blog.csdn.net/m0_59586152/article/details/125200506</a></p>]]></content>
      
      
      <categories>
          
          <category> zabbix </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zabbix </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wordpressè®¾ç½®WP SMTPé‚®ä»¶æé†’</title>
      <link href="/2024/03/27/wordpress%E8%AE%BE%E7%BD%AEWP%20SMTP%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92/"/>
      <url>/2024/03/27/wordpress%E8%AE%BE%E7%BD%AEWP%20SMTP%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="wordpressè®¾ç½®WP-SMTPé‚®ä»¶æé†’"><a href="#wordpressè®¾ç½®WP-SMTPé‚®ä»¶æé†’" class="headerlink" title="wordpressè®¾ç½®WP SMTPé‚®ä»¶æé†’"></a>wordpressè®¾ç½®WP SMTPé‚®ä»¶æé†’</h2><blockquote><p>æœ¬æ–‡ä½¿ç”¨wordpressæ’ä»¶ &gt; <a href="https://wordpress.org/plugins/wp-smtp/">WP SMTP</a> å®‰è£… &gt; <a href="https://wn-apple-teawine.fun/2023/10/08/wordpress%E5%8D%9A%E5%AE%A2-docker-compose%E6%9E%84%E5%BB%BA/?highlight=%E5%90%84%E7%A7%8D">wordpresså®‰è£…é“¾æ¥</a></p><p>æ’ä»¶å®‰è£…åŒ…ç•™å­˜åœ°å€ | <a href="https://drive.zznnwn.cloudns.biz/api/raw/?path=/boke/wordpress/WP-SMTP/wp-smtp.1.2.6.zip">ä¼ é€é—¨</a></p></blockquote><h3 id="wordpresså®‰è£…WP-SMTPæ’ä»¶æ–¹æ³•"><a href="#wordpresså®‰è£…WP-SMTPæ’ä»¶æ–¹æ³•" class="headerlink" title="wordpresså®‰è£…WP SMTPæ’ä»¶æ–¹æ³•"></a>wordpresså®‰è£…WP SMTPæ’ä»¶æ–¹æ³•</h3><p>æ’ä»¶ &gt; æ·»åŠ æ’ä»¶ &gt; ä¸Šä¼ æ’ä»¶ &gt; é€‰æ‹©æ–‡ä»¶ | æ­¤æ—¶å¹³å°ä¼šè‡ªåŠ¨å®‰è£…æ­¤æ’ä»¶</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6dc16744541929c15f31c5105b4877d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6dc16744541929c15f31c5105b4877d.png"></p><h3 id="é…ç½®smtpæœåŠ¡"><a href="#é…ç½®smtpæœåŠ¡" class="headerlink" title="é…ç½®smtpæœåŠ¡"></a>é…ç½®smtpæœåŠ¡</h3><p>ä¸»è¦é…ç½®é‚®ç®±æˆæƒç  è®¾ç½® &gt; è®¨è®º &gt; å¼€å¯è¯„è®ºæé†’</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8079623496c957fa91390f39150ee7e8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8079623496c957fa91390f39150ee7e8.png"></p><h3 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_d8ba9af400a0c44fca7a8b7aa6bd50bd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_d8ba9af400a0c44fca7a8b7aa6bd50bd.png"></p><p><strong>æœ¬æ–‡å‚è€ƒ</strong></p><p><a href="https://blog.naibabiji.com/tutorial/wordpress-smtp-cha-jian.html#wp_smtp">https://blog.naibabiji.com/tutorial/wordpress-smtp-cha-jian.html#wp_smtp</a></p>]]></content>
      
      
      <categories>
          
          <category> wordpress </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wordpress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxå‘½ä»¤ç­›é€‰å‡ºipv4åœ°å€å¹¶å»é‡è®¡ç®—å‡ºç°æ¬¡æ•°</title>
      <link href="/2024/03/25/linux%E5%91%BD%E4%BB%A4%E7%AD%9B%E9%80%89%E5%87%BAipv4%E5%9C%B0%E5%9D%80%E5%B9%B6%E5%8E%BB%E9%87%8D%E8%AE%A1%E7%AE%97%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0/"/>
      <url>/2024/03/25/linux%E5%91%BD%E4%BB%A4%E7%AD%9B%E9%80%89%E5%87%BAipv4%E5%9C%B0%E5%9D%80%E5%B9%B6%E5%8E%BB%E9%87%8D%E8%AE%A1%E7%AE%97%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>linuxå‘½ä»¤ç­›é€‰å‡ºipv4åœ°å€å¹¶å»é‡è®¡ç®—å‡ºç°æ¬¡æ•°<a href>                                              </a></strong></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><ul><li><strong>grep -oE â€œ\b([0-9]{1,3}.){3}[0-9]{1,3}\bâ€ 1.txt |sort -nr |uniq -c</strong></li><li><strong>ss -ant |grep ESTAB |awk -F â€˜[ :]+â€™  â€˜{print $4}â€™ |grep -v â€˜[â€˜ |sort -rn |uniq -c</strong></li><li><strong>cat 1.txt  |awk -F â€˜[ :]+â€™  â€˜/^ip/{print $2}â€™ |sort -nr |uniq -c</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@k8s:~<span class="comment"># cat 1.txt </span></span><br><span class="line">ip: 10.10.10.1:1080</span><br><span class="line">ip: 10.10.10.2:1080</span><br><span class="line">ip: 10.10.10.4:2050</span><br><span class="line">ip: 10.10.10.2:1020</span><br><span class="line">root@k8s:~<span class="comment"># ss -ant |grep -oE &quot;\b([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;\b&quot; 1.txt</span></span><br><span class="line">10.10.10.1</span><br><span class="line">10.10.10.2</span><br><span class="line">10.10.10.4</span><br><span class="line">10.10.10.2</span><br><span class="line">root@k8s:~<span class="comment"># grep -oE &quot;\b([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;\b&quot; 1.txt |sort -nr |uniq -c</span></span><br><span class="line">      1 10.10.10.4</span><br><span class="line">      2 10.10.10.2</span><br><span class="line">      1 10.10.10.1</span><br><span class="line">root@k8s:~<span class="comment"># ss -ant |grep ESTAB |awk -F &#x27;[ :]+&#x27;  &#x27;&#123;print $4&#125;&#x27; |grep -v &#x27;\[&#x27; |sort -rn |uniq -c</span></span><br><span class="line">      1 172.16.0.1</span><br><span class="line">    124 127.0.0.1</span><br><span class="line">     10 10.0.0.240</span><br><span class="line">root@k8s:~<span class="comment"># cat 1.txt  |awk -F &#x27;[ :]+&#x27;  &#x27;/^ip/&#123;print $2&#125;&#x27; |sort -nr |uniq -c</span></span><br><span class="line">      1 10.10.10.4</span><br><span class="line">      2 10.10.10.2</span><br><span class="line">      1 10.10.10.1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shellå®ç°è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—</title>
      <link href="/2024/03/24/Shell%E5%AE%9E%E7%8E%B0%E8%AE%A1%E7%AE%97%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/"/>
      <url>/2024/03/24/Shell%E5%AE%9E%E7%8E%B0%E8%AE%A1%E7%AE%97%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="Shellå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—"><a href="#Shellå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—" class="headerlink" title="Shellå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—"></a>Shellå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—</h3><p><a href="https://zh.numberempire.com/fibonaccinumbers.php">æ–æ³¢é‚£å¥‘æ•°è®¡ç®—å™¨ (numberempire.com)</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">fibonacci</span></span>() &#123;</span><br><span class="line">    n=<span class="variable">$1</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$n</span> -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> 0</span><br><span class="line">    <span class="keyword">elif</span> [ <span class="variable">$n</span> -eq 1 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> 1</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        a=0</span><br><span class="line">        b=1</span><br><span class="line">        i=2</span><br><span class="line">        <span class="keyword">while</span> [ <span class="variable">$i</span> -le <span class="variable">$n</span> ]; <span class="keyword">do</span></span><br><span class="line">            c=$((a + b))</span><br><span class="line">            a=<span class="variable">$b</span></span><br><span class="line">            b=<span class="variable">$c</span></span><br><span class="line">            i=$((i + <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$b</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;è¯·è¾“å…¥Nå€¼ï¼ˆN &lt; 50ï¼‰: &quot;</span> N</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$N</span> -ge 0 ] &amp;&amp; [ <span class="variable">$N</span> -lt 50 ]; <span class="keyword">then</span></span><br><span class="line">    result=$(fibonacci <span class="variable">$N</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬ <span class="variable">$N</span> é¡¹ä¸º: <span class="variable">$result</span>&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;è¾“å…¥çš„Nå€¼ä¸åœ¨æœ‰æ•ˆèŒƒå›´å†…ï¼&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_caa7837e83fa0efebe83bac133122bd4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_caa7837e83fa0efebe83bac133122bd4.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9d599e5ba7c00c4a861753f0f01a4cb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9d599e5ba7c00c4a861753f0f01a4cb.png"></p>]]></content>
      
      
      <categories>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹</title>
      <link href="/2024/03/23/ceph%E9%9B%86%E7%BE%A4%E6%89%A9%E5%AE%B9%E4%B8%8E%E7%BC%A9%E5%AE%B9%E8%8A%82%E7%82%B9/"/>
      <url>/2024/03/23/ceph%E9%9B%86%E7%BE%A4%E6%89%A9%E5%AE%B9%E4%B8%8E%E7%BC%A9%E5%AE%B9%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹"><a href="#cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹" class="headerlink" title="cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹"></a>cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹</h3><p><a href="https://wn-apple-teawine.fun/2023/08/29/cephadm%E9%83%A8%E7%BD%B2ceph-quincy%E7%89%88%E6%9C%AC/"><strong>ä¸€. æ‰©å®¹å¸¸è§„æ·»åŠ èŠ‚ç‚¹å³å¯</strong></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­è‡ªåŠ¨æ·»åŠ osd</span></span><br><span class="line">ceph orch apply osd --all-available-devices --unmanaged=<span class="literal">true</span></span><br><span class="line"><span class="comment"># æ·»åŠ ceph-4ä¸ºæ–°èŠ‚ç‚¹</span></span><br><span class="line">ssh-copy-id ceph-4</span><br><span class="line">ssh-copy-id -f -i /etc/ceph/ceph.pub root@ceph-4</span><br><span class="line"><span class="comment"># ceph-4 æ¢æº </span></span><br><span class="line"><span class="comment"># è®¾ç½®ceph quincyæº </span></span><br><span class="line"><span class="comment"># è®¾ç½®dockeré•œåƒåŠ é€Ÿ &gt;&gt; ç•¥ (ceph-4æ“ä½œ)</span></span><br><span class="line">hostnamectl set-hostname ceph-4</span><br><span class="line">apt install -y python3 systemd lvm2 ceph-common</span><br><span class="line">curl -sSL https://get.daocloud.io/docker | sh</span><br><span class="line"><span class="comment"># ä¸»èŠ‚ç‚¹æ‰§è¡Œæ·»åŠ èŠ‚ç‚¹</span></span><br><span class="line">ceph orch host add ceph-4</span><br></pre></td></tr></table></figure><p><strong>äºŒ. èŠ‚ç‚¹ç¼©å®¹( æ³¨æ„é¡ºåº )â€“æš‚æœªæµ‹è¯•</strong></p><blockquote><p>æ­¤å¤„éœ€è¦æ³¨æ„å‰¯æœ¬æ•°  æ¯”å¦‚é›†ç¾¤ä¸ºä¸‰å‰¯æœ¬ä¸‰å°æœåŠ¡å™¨ç¼©å‡ä¸ºä¸¤å°æ—¶ æ­¤æ—¶é›†ç¾¤ç¼ºå¤±ä¸€èŠ‚ç‚¹å°±å˜æˆäº† ä¸¤å‰¯æœ¬ ç§»é™¤èŠ‚ç‚¹éœ€è¦è°ƒæ•´å‰¯æœ¬æ•° å‰¯æœ¬æ•°ä¸èƒ½å°äº<code>2</code>å³æœ€å°èƒ½æ”¯æŒçš„ç¼©å‡ä¸º3èŠ‚ç‚¹ &gt;&gt; 2èŠ‚ç‚¹</p></blockquote><p><a href="https://gegewu-cloud.github.io/2023/09/01/ceph%E9%9B%86%E7%BE%A4%E4%B9%8Bosd%E5%9D%8F%E7%9B%98%E5%89%94%E9%99%A4/">osdåç›˜å‰”é™¤å‚è€ƒæ­¤å¤„é“¾æ¥å³å¯</a></p><p><a href="https://wn-apple-teawine.fun/2023/10/29/ceph%E9%9B%86%E7%BE%A4%E4%B9%8Bceph-quincy%E7%89%88%E6%9C%ACcephadm%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F%E4%BF%AE%E6%94%B9ceph%E9%85%8D%E7%BD%AE/">cephadméƒ¨ç½²æ–¹å¼æ›´æ”¹é…ç½®å‚è€ƒæ­¤å¤„å«ceph-deployæ–¹å¼æ›´æ”¹å‰¯æœ¬æ•°</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆè®¾ç½®ä¸è¿ç§»æ•°æ®</span></span><br><span class="line">ceph osd <span class="built_in">set</span> noout</span><br><span class="line"><span class="comment"># è‹¥èŠ‚ç‚¹ä¸º3èŠ‚ç‚¹é”å®¹ä¸º2èŠ‚ç‚¹åˆ™éœ€è¦ æ›´æ”¹å‰¯æœ¬æ•°ä¸º2 cephçš„crashmapé»˜è®¤ä»¥ä¸»æœºä¸ºå•ä½ (å‰¯æœ¬æ•°ä¸èƒ½å°äº2)</span></span><br><span class="line">ceph config <span class="built_in">help</span> osd_pool_default_size                     <span class="comment"># æŸ¥çœ‹å½“å‰å‰¯æœ¬æ•°é…ç½®</span></span><br><span class="line">ceph config-key <span class="built_in">set</span> config/global/osd_pool_default_size 2  <span class="comment"># è®¾ç½®å‰¯æœ¬æ•°ä¸º2</span></span><br><span class="line">systemctl restart ceph.target                              <span class="comment"># é‡å¯ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment"># å·²ç»å­˜åœ¨çš„pooléœ€è¦æ‰‹åŠ¨è®¾ç½®å‰¯æœ¬æ•° (å‰¯æœ¬æ•°ä¸èƒ½å°äº2)</span></span><br><span class="line">ceph osd pool  <span class="built_in">set</span> ceph-demo size  2</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä»–å¦‚mds mgr monç­‰èŠ‚ç‚¹æ•°é‡ä¹Ÿè¦å¯¹åº”ç¼©å‡</span></span><br><span class="line">ceph orch apply mon --placement=<span class="string">&quot;2 ceph-1 ceph-2&quot;</span>   </span><br><span class="line">ceph orch apply mgr --placement=<span class="string">&quot;2 ceph-1 ceph-2&quot;</span></span><br><span class="line">ceph orch apply rgw  foo --placement=<span class="string">&quot;2 ceph-1 ceph-2&quot;</span> --port=8000</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»é›†ç¾¤ä¸­åˆ é™¤å…³äºè¯¥ceph-3ä¸»æœºçš„æ‰€æœ‰å®ˆæŠ¤è¿›ç¨‹</span></span><br><span class="line">ceph orch host drain ceph-3</span><br><span class="line"><span class="comment"># å°†_no_scheduleæ ‡ç­¾åº”ç”¨äºä¸»æœºè‡³äºç»´æŠ¤æ¨¡å¼</span></span><br><span class="line">ceph orch host label add ceph-3 _no_schedule</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­è‡ªåŠ¨æ·»åŠ osd</span></span><br><span class="line">ceph orch apply osd --all-available-devices --unmanaged=<span class="literal">true</span></span><br><span class="line"><span class="comment"># ç§»é™¤osd</span></span><br><span class="line">ceph osd out osd.1</span><br><span class="line">ceph osd purge osd.1 --yes-i-really-mean-it</span><br><span class="line">ceph osd <span class="built_in">rm</span> osd.1</span><br><span class="line">ceph orch daemon <span class="built_in">rm</span> osd.1 --force</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ceph </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ceph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cephfsæ­å»ºåŠæƒé™ç®¡ç†</title>
      <link href="/2024/03/23/cephfs%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/"/>
      <url>/2024/03/23/cephfs%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="cephfsæ­å»ºåŠæƒé™ç®¡ç†-æœ¬æ–‡å•èŠ‚ç‚¹æµ‹è¯•"><a href="#cephfsæ­å»ºåŠæƒé™ç®¡ç†-æœ¬æ–‡å•èŠ‚ç‚¹æµ‹è¯•" class="headerlink" title="cephfsæ­å»ºåŠæƒé™ç®¡ç†(æœ¬æ–‡å•èŠ‚ç‚¹æµ‹è¯•)"></a>cephfsæ­å»ºåŠæƒé™ç®¡ç†(æœ¬æ–‡å•èŠ‚ç‚¹æµ‹è¯•)</h3><p><strong>æ‹–å¸ƒå›¾</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3e7fad3ed82c19ee8bc03e153c89c81f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3e7fad3ed82c19ee8bc03e153c89c81f.png"></p><p><strong>æ¶æ„</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c33ff0f84010148834f8b19aae653197.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c33ff0f84010148834f8b19aae653197.png"></p><p><strong>cephFSç®€ä»‹</strong></p><p>æ¯ä¸ªCephFSæ–‡ä»¶ç³»ç»Ÿè‡³å°‘éœ€è¦ä¸€ä¸ªMDSï¼ˆmetadata serverï¼‰ï¼Œä¸€èˆ¬æ˜¯ä¸‰ä¸ªã€‚CephFS æ˜¯ä¸ªä¸ POSIX æ ‡å‡†å…¼å®¹çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ–‡ä»¶ç›®å½•å’Œå…¶ä»–å…ƒæ•°æ®å­˜å‚¨åœ¨RADOSä¸­ï¼ŒMDSç¼“å­˜å…ƒä¿¡æ¯å’Œæ–‡ä»¶ç›®å½•ä¿¡æ¯ã€‚</p><p>cephfsçš„æ ¸å¿ƒç»„ä»¶æœ‰ï¼šMDSã€Clientsã€RADOSã€‚</p><p>å‚è€ƒï¼š<a href="https://cloud.tencent.com/developer/article/1664666">CephFS ä»‹ç»åŠä½¿ç”¨ç»éªŒåˆ†äº«</a>ã€‚</p><blockquote><p>å„ä¸ªç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»å¦‚ä¸‹ï¼š</p><ul><li>client ã€Š==ã€‹ MDSï¼šå…ƒæ•°æ®æ“ä½œå’Œcapalitiesã€‚</li><li>Client ã€Š==ã€‹ OSDï¼š æ•°æ®IOã€‚</li><li>MDS ã€Š==ã€‹ OSDï¼šå…ƒæ•°æ®IOã€‚</li></ul></blockquote><p>cephfsæ”¯æŒç”¨æˆ·çº§åˆ«å’Œå†…æ ¸çº§åˆ«çš„æŒ‚è½½ä½¿ç”¨ï¼Œå¯æ‰©å±•æ€§é«˜ï¼Œå¹¶ä¸”å¯ä»¥å…±äº«æ–‡ä»¶ç³»ç»Ÿï¼Œå¤šä¸ªclientså¯ä»¥åŒæ—¶è¯»å†™ã€‚MDSæ”¯æŒé«˜å¯ç”¨æ€§ï¼Œé»˜è®¤é‡‡ç”¨çš„æ˜¯ä¸»å¤‡æ¨¡å¼ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ”¹ä¸ºå¤šä¸»ï¼‰ï¼Œå¹¶ä¸”cephfsæ”¯æŒæ–‡ä»¶ç³»ç»Ÿçš„é…é¢é™åˆ¶ã€‚</p><blockquote><p>cephfsä¸­MDSå¤šä¸»çš„ä¼˜åŠ¿åŠç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>å½“å…ƒæ•°æ®é»˜è®¤çš„å•ä¸ª MDS æˆä¸ºç“¶é¢ˆæ—¶ï¼Œé…ç½®å¤šä¸ªæ´»è·ƒçš„ MDS å®ˆæŠ¤è¿›ç¨‹ï¼Œæå‡é›†ç¾¤æ€§èƒ½ã€‚</li><li>å¤šä¸ªæ´»è·ƒçš„ MDS æœ‰åˆ©äºæ€§èƒ½æå‡ã€‚</li><li>å¤šä¸ªæ´»è·ƒçš„MDS å¯ä»¥å®ç°MDSè´Ÿè½½å‡è¡¡ã€‚</li><li>å¤šä¸ªæ´»è·ƒçš„MDS å¯ä»¥å®ç°å¤šç§Ÿæˆ·èµ„æºéš”ç¦»ã€‚</li><li>å®ƒèƒ½å¤Ÿå°†æ–‡ä»¶ç³»ç»Ÿæ ‘åˆ†å‰²æˆå­æ ‘ï¼Œæ¯ä¸ªå­æ ‘å¯ä»¥äº¤ç»™ç‰¹å®šçš„MDSè¿›è¡Œæƒå¨ç®¡ç†ï¼Œä»è€Œè¾¾åˆ°äº†éšç€å…ƒæ•°æ®æœåŠ¡å™¨æ•°é‡çš„å¢åŠ ï¼Œé›†ç¾¤æ€§èƒ½çº¿æ€§åœ°æ‰©å±•ã€‚</li><li>æ¯ä¸ªå­æ ‘éƒ½æ˜¯åŸºäºå…ƒæ•°æ®åœ¨ç»™å®šç›®å½•æ ‘ä¸­çš„çƒ­åŠ¨æ€åˆ›å»ºçš„ã€‚</li><li>ä¸€æ—¦åˆ›å»ºäº†å­æ ‘ï¼Œå®ƒçš„å…ƒæ•°æ®å°±è¢«è¿ç§»åˆ°ä¸€ä¸ªæœªåŠ è½½çš„MDSã€‚</li><li>åç»­å®¢æˆ·ç«¯å¯¹å…ˆå‰æˆæƒçš„MDSçš„è¯·æ±‚è¢«è½¬å‘ã€‚</li></ul></blockquote><h3 id="ä¸€-åˆ›å»ºmds"><a href="#ä¸€-åˆ›å»ºmds" class="headerlink" title="ä¸€. åˆ›å»ºmds"></a>ä¸€. <strong>åˆ›å»º</strong>mds</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆå¼€å¯mdsç»„ä»¶ï¼Œcephfsï¼šæ–‡ä»¶ç³»ç»Ÿåç§°ï¼›â€“placementï¼šæŒ‡å®šé›†ç¾¤å†…éœ€è¦å‡ ä¸ªmdsï¼Œåé¢è·Ÿä¸»æœºåï¼ˆç­‰å¾…ä¸€åˆ†é’Ÿå®Œæˆåˆ›å»ºï¼‰</span></span><br><span class="line">ceph orch apply mds cephfs --placement=<span class="string">&quot;2 ceph1 ceph2&quot;</span></span><br><span class="line"><span class="comment"># è¿”å›</span></span><br><span class="line">Scheduled mds.cephfs update...</span><br><span class="line"><span class="comment"># åˆ›å»ºcephfsï¼Œceph qç‰ˆä¸æŒ‡å®špgçš„è¯ï¼Œé»˜è®¤è‡ªåŠ¨è°ƒæ•´ ä¸èƒ½ä½¿ç”¨ rbd init åˆå§‹åŒ–</span></span><br><span class="line">ceph osd pool create cephfs_data 8 8</span><br><span class="line">ceph osd pool create cephfs_metadata 8 8</span><br><span class="line"><span class="comment"># è¿”å›</span></span><br><span class="line">pool <span class="string">&#x27;cephfs_metadata&#x27;</span> created</span><br><span class="line"><span class="comment"># å°†ä¸¤ä¸ªpoolå…³è”èµ·æ¥</span></span><br><span class="line">ceph fs new cephfsdemo cephfs_metadata cephfs_data</span><br><span class="line"><span class="comment"># è¿”å›</span></span><br><span class="line">new fs with metadata pool 3 and data pool 2</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å„èŠ‚ç‚¹æ˜¯å¦å·²å¯åŠ¨mdså®¹å™¨ï¼›è¿˜å¯ä»¥ä½¿ç”¨ceph orch ps æŸ¥çœ‹æŸä¸€èŠ‚ç‚¹è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">ceph orch ps --daemon-type mds</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹mdsä¿¡æ¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹cephfsä¿¡æ¯</span></span><br><span class="line">ceph fs <span class="built_in">ls</span></span><br><span class="line">name: cephfs, metadata pool: cephfs_metadata, data pools: [cephfs_data ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹mdsçŠ¶æ€</span></span><br><span class="line">ceph mds <span class="built_in">stat</span></span><br><span class="line">cephfs:1 &#123;0=cephfs.ceph-1.uuemyr=up:active&#125; 1 up:standby</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹mdsè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">ceph fs status </span><br><span class="line"></span><br><span class="line">RANK  STATE           MDS              ACTIVITY     DNS    INOS   DIRS   CAPS  </span><br><span class="line"> 0    active  cephfs.ceph-2.iuvxfu  Reqs:    0 /s    16     19     13      1</span><br></pre></td></tr></table></figure><p>åˆ é™¤<code>cephfs</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph fs <span class="built_in">rm</span> &lt;fs-name&gt; --yes-i-really-mean-it </span><br></pre></td></tr></table></figure><h3 id="äºŒ-æŒ‚è½½cephfs"><a href="#äºŒ-æŒ‚è½½cephfs" class="headerlink" title="äºŒ. æŒ‚è½½cephfs"></a>äºŒ. æŒ‚è½½<code>cephfs</code></h3><p><strong>ä¸´æ—¶æŒ‚è½½</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨å†…æ ¸çº§åˆ«æŒ‚è½½ï¼š</span></span><br><span class="line"> <span class="built_in">mkdir</span> -p /mnt/cephfs/</span><br><span class="line"> mount -t ceph 10.0.0.124:6789:/ /mnt/cephfs/ -o name=admin  ï¼ˆè‡ªåŠ¨è¯†åˆ«admin keyï¼‰</span><br><span class="line"> æˆ–</span><br><span class="line"> mount -t ceph 10.0.0.124:6789:/ /mnt/cephfs -o name=admin,secret=AQCeoO1j+e+lMhAAP2izu6rTQSGz0oyJkLw9UQ==</span><br><span class="line"> æˆ–</span><br><span class="line"> <span class="comment"># æ–‡ä»¶å¯†é’¥æŒ‚è½½ï¼š</span></span><br><span class="line"> <span class="built_in">echo</span> AQDqOnNf7tGvHhAAZoXbhXRbETxRLBTl5DT1MQ== &gt;&gt; admin.key</span><br><span class="line"> mount -t ceph 192.168.229.114:6789:/ /cephfs/ -o name=admin,secretfile=admin.key</span><br><span class="line"><span class="comment"># æ‰©å±•æŸ¥çœ‹key:  </span></span><br><span class="line">ceph auth <span class="built_in">ls</span></span><br><span class="line">æŒ‡å®šç”¨æˆ·æŒ‚è½½ éœ€è¦å…ˆå»ºç«‹cephxè®¤è¯ç”¨æˆ·å†…æ ¸çº§åˆ«é…ç½®æ°¸ä¹…æŒ‚è½½</span><br></pre></td></tr></table></figure><p><strong>ç”¨æˆ·æ€æŒ‚è½½ï¼ˆä¾‹å­ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install ceph-fuse     <span class="comment"># å®‰è£…å®¢æˆ·ç«¯</span></span><br><span class="line">$ apt -y install ceph-fuse</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">mkdir</span> /ceph-fuse   <span class="comment"># åˆ›å»ºæŒ‚è½½ç‚¹å¹¶æŒ‚è½½ä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line">$ ceph-fuse -n client.admin -m 192.168.99.11:6789,192.168.99.12:6789,192.168.99.13:6789 /ceph-fuse</span><br><span class="line"><span class="comment"># monitoråœ°å€å¯ä»¥å¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªï¼ˆå¦‚æœå…¶ä¸­ä¸€ä¸ªå®•æœºä¸å½±å“ä½¿ç”¨ï¼‰</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">df</span> -hT /ceph-fuse       <span class="comment"># æŸ¥çœ‹ç¡®è®¤</span></span><br><span class="line">æ–‡ä»¶ç³»ç»Ÿ       ç±»å‹            å®¹é‡  å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹</span><br><span class="line">ceph-fuse      fuse.ceph-fuse   94G     0   94G    0% /ceph-fuse</span><br></pre></td></tr></table></figure><p><strong>æ°¸ä¹…æŒ‚è½½</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥é…ç½®æ–‡ä»¶ï¼š/etc/fstab </span></span><br><span class="line"><span class="comment"># å¯†é’¥æ–‡ä»¶</span></span><br><span class="line">  10.0.0.124:6789:/ /mnt/cephfs ceph name=admin,secretfile=/root/adminkey,noatime 0 0</span><br><span class="line"><span class="comment"># ç›´æ¥æŒ‡å®šå¯†é’¥</span></span><br><span class="line">  10.0.0.124:6789:/ /mnt/cephfs ceph name=admin,secret=AQCeoO1j+e+lMhAAP2izu6rTQSGz0oyJkLw9UQ==,noatime,_netdev 0 0</span><br><span class="line"></span><br><span class="line">å…³æœºéªŒè¯ï¼šæ­£å¸¸æŒ‚è½½ / monut -a å³å¯éªŒè¯</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7a032c8de07240c963b4846f8b971faf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7a032c8de07240c963b4846f8b971faf.png"></p><h3 id="ä¸‰-cephæƒé™æ§åˆ¶"><a href="#ä¸‰-cephæƒé™æ§åˆ¶" class="headerlink" title="ä¸‰. cephæƒé™æ§åˆ¶"></a>ä¸‰. <a href="https://www.cnblogs.com/lvzhenjiang/p/14907610.html#35-%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4%E6%8C%82%E8%BD%BD%E4%BD%BF%E7%94%A8"><strong>cephæƒé™æ§åˆ¶</strong></a></h3><h4 id="3-6-ä¸åŒç”¨æˆ·æŒ‚è½½ä¸åŒç›®å½•"><a href="#3-6-ä¸åŒç”¨æˆ·æŒ‚è½½ä¸åŒç›®å½•" class="headerlink" title="3.6 ä¸åŒç”¨æˆ·æŒ‚è½½ä¸åŒç›®å½•"></a>3.6 ä¸åŒç”¨æˆ·æŒ‚è½½ä¸åŒç›®å½•</h4><h5 id="3-6-1-æ·»åŠ æ–°çš„poolåˆ°cephfs"><a href="#3-6-1-æ·»åŠ æ–°çš„poolåˆ°cephfs" class="headerlink" title="3.6.1 æ·»åŠ æ–°çš„poolåˆ°cephfs"></a>3.6.1 æ·»åŠ æ–°çš„poolåˆ°cephfs</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cephfsä¸­å¢åŠ æ–°çš„pool</span></span><br><span class="line">ceph osd pool create cephfs_data1 4 4           # åˆ›å»ºpool</span><br><span class="line">ceph fs add_data_pool cephfsdemo cephfs_data1  # åŠ åˆ°cephfsä¸­  </span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-6-2-åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•-bruceï¼Œæ•°æ®å­˜å‚¨åœ¨-pool-cephfs-data1-ä¸­"><a href="#3-6-2-åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•-bruceï¼Œæ•°æ®å­˜å‚¨åœ¨-pool-cephfs-data1-ä¸­" class="headerlink" title="3.6.2 åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•/bruceï¼Œæ•°æ®å­˜å‚¨åœ¨ pool cephfs_data1 ä¸­"></a>3.6.2 åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•/bruceï¼Œæ•°æ®å­˜å‚¨åœ¨ <code>pool cephfs_data1</code> ä¸­</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•/bruceï¼Œæ•°æ®å­˜å‚¨åœ¨ `pool cephfs_data1` ä¸­</span></span><br><span class="line">ceph auth get-or-create client.bruce mon &#x27;allow r&#x27; mds &#x27;allow r, allow rw path=/bruce&#x27; osd &#x27;allow rw pool=cephfs_data1&#x27; -o ceph.client.bruce.keyring</span><br><span class="line">// è¿”å›</span><br><span class="line">[client.bruce]</span><br><span class="line">key = AQCtFc9g/CmyERAAzi7ORpEWIxlMiiFC1GK7nA==</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_85fe5cb0da273b96eb63b2ca004dc93c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_85fe5cb0da273b96eb63b2ca004dc93c.png"></p><h5 id="3-6-3-å®¢æˆ·ç«¯æŒ‚è½½"><a href="#3-6-3-å®¢æˆ·ç«¯æŒ‚è½½" class="headerlink" title="3.6.3 å®¢æˆ·ç«¯æŒ‚è½½"></a>3.6.3 å®¢æˆ·ç«¯æŒ‚è½½</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®¢æˆ·ç«¯æŒ‚è½½</span></span><br><span class="line">mkdir /data1</span><br><span class="line">mount -t ceph 192.168.99.11:6789,192.168.99.12:6789,192.168.99.13:6789:/ /data1/ -o name=bruce,secret=AQCtFc9g/CmyERAAzi7ORpEWIxlMiiFC1GK7nA==</span><br></pre></td></tr></table></figure><h3 id="å››ã€cephfsæƒé™ä¸è®¿é—®æ§åˆ¶"><a href="#å››ã€cephfsæƒé™ä¸è®¿é—®æ§åˆ¶" class="headerlink" title="å››ã€cephfsæƒé™ä¸è®¿é—®æ§åˆ¶"></a>å››ã€cephfsæƒé™ä¸è®¿é—®æ§åˆ¶</h3><h4 id="4-1-æ·»åŠ ç”¨æˆ·"><a href="#4-1-æ·»åŠ ç”¨æˆ·" class="headerlink" title="4.1 æ·»åŠ ç”¨æˆ·"></a>4.1 æ·»åŠ ç”¨æˆ·</h4><p>æ·»åŠ ç”¨æˆ·<code>jerryï¼Œjerry</code>åªæœ‰å¯¹<code>/jerry</code>è·¯å¾„ä¸‹çš„æ–‡ä»¶å…·æœ‰è¯»å†™æƒé™ï¼Œå¯¹å…¶ä»–è·¯å¾„ä¸‹çš„æ–‡ä»¶åªæœ‰è¯»çš„æƒé™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºæƒé™å¯†é’¥</span></span><br><span class="line">ceph auth get-or-create client.jerry mon &#x27;allow r&#x27; mds &#x27;allow rw,allow rw path=/jerry&#x27; osd &#x27;allow rw pool=cephfs_data2&#x27; -o ceph.client.jerry.keyring</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨jerryç”¨æˆ·æŒ‚è½½</span></span><br><span class="line">mount -t ceph 10.0.0.10:6789:/ /data -o name=jerry,secret=AQAo0/9lI2g7KRAA8AqwdIUhGQcS4tJgltSlzw==</span><br></pre></td></tr></table></figure><h4 id="4-2-è·å–æƒé™åˆ—è¡¨"><a href="#4-2-è·å–æƒé™åˆ—è¡¨" class="headerlink" title="4.2 è·å–æƒé™åˆ—è¡¨"></a>4.2 è·å–æƒé™åˆ—è¡¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth list</span></span><br></pre></td></tr></table></figure><h4 id="4-3-åˆ é™¤ç”¨æˆ·"><a href="#4-3-åˆ é™¤ç”¨æˆ·" class="headerlink" title="4.3 åˆ é™¤ç”¨æˆ·"></a>4.3 åˆ é™¤ç”¨æˆ·</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth del client.jerry</span></span><br></pre></td></tr></table></figure><h4 id="4-4-è·å–æŸä¸ªç”¨æˆ·çš„key"><a href="#4-4-è·å–æŸä¸ªç”¨æˆ·çš„key" class="headerlink" title="4.4 è·å–æŸä¸ªç”¨æˆ·çš„key"></a>4.4 è·å–æŸä¸ªç”¨æˆ·çš„key</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth get-key client.bruce</span></span><br></pre></td></tr></table></figure><h4 id="4-5-ä¿®æ”¹ç”¨æˆ·æƒé™"><a href="#4-5-ä¿®æ”¹ç”¨æˆ·æƒé™" class="headerlink" title="4.5 ä¿®æ”¹ç”¨æˆ·æƒé™"></a>4.5 ä¿®æ”¹ç”¨æˆ·æƒé™</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth caps client.jerry mon <span class="string">&#x27;allow r&#x27;</span> mds <span class="string">&#x27;allow r, allow rw path=/jerry, allow rw path=/test&#x27;</span> osd <span class="string">&#x27;allow rw&#x27;</span></span></span><br></pre></td></tr></table></figure><h4 id="4-6-æ³¨æ„äº‹é¡¹"><a href="#4-6-æ³¨æ„äº‹é¡¹" class="headerlink" title="4.6 æ³¨æ„äº‹é¡¹"></a>4.6 æ³¨æ„äº‹é¡¹</h4><blockquote><ul><li>å½“ç”¨java apiæ“ä½œcephfsæ—¶ï¼Œapiæ— æ³•æŒ‡å®šæ–°å»ºæ–‡ä»¶orç›®å½•çš„æ‰€å±ç”¨æˆ·oræ‰€å±ç»„ï¼Œè¿™ä¸¤ä¸ªå±æ€§å–å†³äºè¿è¡Œjavaç¨‹åºæ—¶çš„å½“å‰ç”¨æˆ·(uid)åŠå…¶æ‰€å±çš„ç”¨æˆ·ç»„(gid)</li><li>ç»è¿‡æµ‹è¯•å‘ç°ï¼Œcephfsæ–‡ä»¶orç›®å½•çš„æƒé™æ˜¯linuxæœ¬èº«ç”¨æˆ·æƒé™å’Œcephfsç”¨æˆ·æƒé™çš„äº¤é›†</li><li>ä¿®æ”¹ç”¨æˆ·æƒé™åï¼Œåœ¨æœ¬åœ°éœ€è¦é‡æ–°æŒ‚è½½æ‰å¯ç”Ÿæ•ˆ</li><li>å»ºç›®å½•ï¼Œè®¾ç½®æƒé™æ— éœ€å‰åé¡ºåº</li></ul></blockquote><p><strong>æœ¬æ–‡å‚è€ƒï¼š</strong></p><p>å®˜ç½‘ï¼š<br><a href="https://docs.ceph.com/en/quincy/cephfs/#ceph-file-system">https://docs.ceph.com/en/quincy/cephfs/#ceph-file-system</a><br>æŒ‚è½½ï¼š<br><a href="https://docs.ceph.com/en/quincy/cephfs/mount-using-kernel-driver/">https://docs.ceph.com/en/quincy/cephfs/mount-using-kernel-driver/</a><br>cephfsä»‹ç»+å„ç§æµ‹è¯•ï¼š<br><a href="http://www.yangguanjun.com/2017/07/16/cephfs-test-method-lite/">http://www.yangguanjun.com/2017/07/16/cephfs-test-method-lite/</a></p>]]></content>
      
      
      <categories>
          
          <category> ceph </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ceph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ceph rbdæ•°æ®å†™å…¥æµç¨‹</title>
      <link href="/2024/03/20/ceph%20rbd%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B/"/>
      <url>/2024/03/20/ceph%20rbd%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="ceph-rbdæ•°æ®å†™å…¥æµç¨‹"><a href="#ceph-rbdæ•°æ®å†™å…¥æµç¨‹" class="headerlink" title="ceph rbdæ•°æ®å†™å…¥æµç¨‹"></a>ceph rbdæ•°æ®å†™å…¥æµç¨‹</h3><p><strong>æ‹“è¡¥å›¾ï¼š</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_14d0de28111417c8dc2aa9088c5b6136.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_14d0de28111417c8dc2aa9088c5b6136.png"></p><p><strong>å›¾ç‰‡è§£æï¼š</strong><br><code>å­˜å‚¨è¿‡ç¨‹ï¼š</code>ä¸€ä¸ªæ–‡ä»¶åˆ‡å‰²ä¸ºå¾ˆå¤šéƒ¨åˆ† æ¯”å¦‚ä¸€ä¸ª100Mçš„æ–‡ä»¶æœ€ç»ˆä¼šåˆ‡å‰²æˆ25ä¸ª4Mï¼ˆé»˜è®¤4Mï¼‰çš„æ–‡ä»¶<br><code>åˆ‡å‰²ä¹‹åï¼š</code>æ¯ä¸ª<code>object</code>éƒ½ä¼šæœ‰ä¸€ä¸ª<code>object id  object id</code> éœ€è¦å­˜å‚¨åˆ°pgé‡Œé¢å» æ­¤å¤„è¿›è¡Œä¸€ä¸ªè¿ç®—æŠŠ<code>object id ä½œä¸ºä¸€ä¸ªå“ˆå¸Œ   &gt;&gt; å¯¹å…¶è¿›è¡Œæ©ç è¿ç®— &gt;&gt; å¾—åˆ°pgid </code>pgä¸Šé¢ï¼š<code> å­˜å‚¨å¤šä¸ªobject</code> &gt;&gt; é€šè¿‡<code>crush</code>ç®—æ³•æŠŠ<code>pg</code>åšä¸€æ¬¡è¿ç®—åˆ†é…åˆ° é›†ç¾¤ä¸­å¯¹åº”çš„<code>osd</code>èŠ‚ç‚¹ä¸Š(æ ¹æ®<code>crush</code>å±‚æ¬¡çš„ä¸åŒ<code>osd</code>ä¹Ÿä¼šè½åˆ°ä¸åŒçš„åœ°æ–¹ )<br>æ¯”å¦‚<code>crush</code>ç®—æ³•å®šä¹‰çš„æ˜¯ä»¥æœºæ¶ä¸ºå•ä½çš„ æ­¤æ—¶ä¾¿ä¼šè½åˆ°ä¸åŒçš„æœºæ¶ä¸Šçš„<code>osd</code>ä¸Šä»è€Œç¡®ä¿æ•°æ®çš„é«˜å¯ç”¨æ€§</p><p><strong>å®é™…æ“ä½œæ¼”ç¤ºï¼š</strong></p><p>æ–‡ä»¶åˆ‡å‰²å¤§å°éªŒè¯ æ¼”ç¤ºæ–‡ä»¶ id: rbd_data.38074c091b82.0000000000000200</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">rbd info ceph-demo/rbd-demo.img   æˆ–    rbd -p ceph-demo info rbd-demo.img ï¼ˆæŸ¥çœ‹å‘½ä»¤ï¼‰</span><br><span class="line">rbd image <span class="string">&#x27;rbd-demo.img&#x27;</span>:</span><br><span class="line">        size 11 GiB <span class="keyword">in</span> 2816 objects</span><br><span class="line">        order 22 (4 MiB objects)</span><br><span class="line">        snapshot_count: 0</span><br><span class="line">        <span class="built_in">id</span>: 38074c091b82</span><br><span class="line">        block_name_prefix: rbd_data.38074c091b82</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Sat Nov  5 21:41:38 2022</span><br><span class="line">        access_timestamp: Sat Nov  5 21:41:38 2022</span><br><span class="line">        modify_timestamp: Sat Nov  5 21:41:38 2022</span><br></pre></td></tr></table></figure><p>è§£æï¼š</p><p>å…±ï¼š11G  åˆ†ä¸ºï¼š2816ä¸ªæ–‡ä»¶  æ¯ä¸ªæ–‡ä»¶ï¼š4M<br>objectçš„å‰ç¼€éƒ½æ˜¯ä»¥ï¼š rbd_data.38074c091b82 å¼€å¤´<br>æŸ¥çœ‹éªŒè¯ï¼š<code>rados -p ceph-demo ls |grep rbd\_data.38074c091b82</code>   (æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶)<br>æŸ¥çœ‹å¤§å°ï¼š<code>rados -p ceph-demo stat rbd\_data.38074c091b82.0000000000000200</code>  ï¼ˆæ¯ä¸ªéƒ½æ˜¯4Mï¼‰</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f53063cda709eabdb71f3cd486276b4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f53063cda709eabdb71f3cd486276b4.png"></p><p><strong>æŸ¥çœ‹æ–‡ä»¶æœ€ç»ˆè½åœ¨çš„åœ°æ–¹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ceph osd map ceph-demo rbd_data.38074c091b82.0000000000000200     (æŸ¥çœ‹æ–‡ä»¶æœ€ç»ˆè½äº)</span><br><span class="line">//è¿”å›</span><br><span class="line">osdmap e49 pool <span class="string">&#x27;ceph-demo&#x27;</span> (1) object <span class="string">&#x27;rbd_data.38074c091b82.0000000000000200&#x27;</span> -&gt; pg 1.7811abdf (1.5f) -&gt; up ([0,1], p0) acting ([0,1], p0)</span><br><span class="line"></span><br><span class="line">ceph osd tree</span><br><span class="line">ID CLASS WEIGHT  TYPE NAME       STATUS REWEIGHT PRI-AFF </span><br><span class="line">-1       0.01178 root default          </span><br><span class="line">-3       0.00589     host node-1       </span><br><span class="line"> 0   hdd 0.00589         osd.0       up  1.00000 1.00000 </span><br><span class="line">-5       0.00589     host node-2       </span><br><span class="line"> 1   hdd 0.00589         osd.1       up  1.00000 1.00000 </span><br><span class="line"></span><br><span class="line">è§£æï¼š æ–‡ä»¶poolæ± deph-demo &gt;&gt; è½åœ¨pgidä¸ºï¼š1.7811abdf ä¸Šé¢ &gt;&gt; è§£ææ©ç å“ˆå¸Œåˆ†é…äº &gt;&gt; osd.0 osd.1ä¸Šé¢</span><br><span class="line">ä¸€ä¸ªæ–‡ä»¶æ‹†åˆ†ä¸ºå¤šä¸ªobjectè¿™äº›objectéƒ½ä¼šè½åœ¨ä¸åŒçš„pgä¸Š  pgæœ€ç»ˆè½åœ¨ä¸åŒçš„osdä¸Š </span><br><span class="line">éªŒè¯ï¼š</span><br><span class="line"><span class="keyword">for</span>å¾ªç¯éªŒè¯</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `rados -p ceph-demo <span class="built_in">ls</span> |grep rbd_data.38074c091b82` ; <span class="keyword">do</span> ceph osd map ceph-demo <span class="variable">$i</span>;  <span class="keyword">done</span></span><br><span class="line">è½äºä¸åŒçš„pgä¸Š</span><br></pre></td></tr></table></figure><p>è§£æï¼š æ–‡ä»¶poolæ± deph-demo &gt;&gt; è½åœ¨pgidä¸ºï¼š1.7811abdf ä¸Šé¢ &gt;&gt; è§£ææ©ç å“ˆå¸Œåˆ†é…äº &gt;&gt; osd.0 osd.1ä¸Šé¢ä¸€ä¸ªæ–‡ä»¶æ‹†åˆ†ä¸ºå¤šä¸ªobjectè¿™äº›objectéƒ½ä¼šè½åœ¨ä¸åŒçš„pgä¸Š  pgæœ€ç»ˆè½åœ¨ä¸åŒçš„osdä¸Š</p><p>éªŒè¯ï¼šforå¾ªç¯éªŒè¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> \`rados -p ceph-demo <span class="built_in">ls</span> |grep rbd\_data.38074c091b82\` ; <span class="keyword">do</span> ceph osd map ceph-demo \<span class="variable">$i</span>;  <span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>è½äºä¸åŒçš„pgä¸Š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_29628694717b3300ec37f4ed88d5abbb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_29628694717b3300ec37f4ed88d5abbb.png"></p><p><strong>rbdæ˜¯ç˜¦åˆ†é…çš„ä¼šæ ¹æ®ä½¿ç”¨æƒ…å†µå»è‡ªåŠ¨çš„æ‰©è¿™äº›ç©ºé—´</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rados -p ceph-demo <span class="built_in">ls</span> |grep rbd_data.38074c091b82 |<span class="built_in">wc</span> -l        <span class="comment"># å½“å‰è¿™ä¸ªå—æœ‰äº”åå¤šä¸ªobject</span></span><br><span class="line">//è¿”å› </span><br><span class="line">56 </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å½“å‰è¿™ä¸ªå—æœ‰äº”åå¤šä¸ªobject  æ¯ä¸ª4M å®é™…åˆ†é…äº†ä¹Ÿå°±äºŒç™¾å¤šMçš„ç©ºé—´  å½“å‰åªç”¨äº†40å¤šM ä½¿ç”¨å¢é•¿çš„è¯ä¼šåŠ¨æ€çš„å»æ‰©å®¹objectçš„æ•°é‡ æ»¡è¶³ æˆ‘ä»¬éœ€è¦çš„ç©ºé—´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -n 1 <span class="string">&#x27;rados -p ceph-demo ls |grep rbd_data.38074c091b82 |wc -l &#x27;</span>    ï¼ˆåŠ¨æ€ç›‘è§†objectæ–‡ä»¶å˜åŒ–ï¼‰</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7c31491c234c587d7d0cc391e7fce3d6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7c31491c234c587d7d0cc391e7fce3d6.png"></p><p>å¾€æŒ‚è½½çš„ç›®å½•å†™å…¥æ•°æ®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /mnt/rbd-demo</span><br><span class="line"></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=test.img bs=1M count=1024       (å¾€ç›®å½•å†™å…¥1Gæ•°æ®)</span><br><span class="line"><span class="comment"># å†™å…¥çœŸå®æ•°æ®</span></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/urandom of=file bs=100M count=9000 iflag=fullblock status=progress</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ€ç»ˆobjectå¢åŠ åˆ°313ä¸ª</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_cc6f5bd1aac93adf5cc215f62178f499.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_cc6f5bd1aac93adf5cc215f62178f499.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_64fcc6f1de8cc79e192aa157631a06d9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_64fcc6f1de8cc79e192aa157631a06d9.png"></p>]]></content>
      
      
      <categories>
          
          <category> ceph </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ceph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³ä¹</title>
      <link href="/2024/03/16/%E9%9F%B3%E4%B9%90/"/>
      <url>/2024/03/16/%E9%9F%B3%E4%B9%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>éŸ³ä¹</strong></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="https://music.163.com/outchain/player?type=2&id=557584888&auto=1&height=66"> </iframe><hr><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="https://music.163.com/outchain/player?type=2&id=523250334&auto=1&height=66"> </iframe>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>onedrive-vercel-indexéƒ¨ç½²</title>
      <link href="/2024/03/15/onedrive-vercel-index%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/03/15/onedrive-vercel-index%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="onedrive-vercel-index-éƒ¨ç½²"><a href="#onedrive-vercel-index-éƒ¨ç½²" class="headerlink" title="onedrive-vercel-index éƒ¨ç½²"></a>onedrive-vercel-index éƒ¨ç½²</h3><p>æ¦‚è§ˆï¼šå‚è€ƒä¸‹æ–¹å®˜ç½‘å³å¯ éƒ¨ç½²ç›¸å¯¹ç®€å•</p><h3 id="æ³¨å†Œä¸€ä¸ªåº”ç”¨ç¨‹åº"><a href="#æ³¨å†Œä¸€ä¸ªåº”ç”¨ç¨‹åº" class="headerlink" title="æ³¨å†Œä¸€ä¸ªåº”ç”¨ç¨‹åº"></a><a href="https://ovi.swo.moe/zh/docs/advanced#%E6%B3%A8%E5%86%8C%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F">æ³¨å†Œä¸€ä¸ªåº”ç”¨ç¨‹åº</a></h3><p>æ‰“å¼€ä»¥ä¸‹é“¾æ¥ï¼š</p><ul><li><a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade">Microsoft Azure App registrations</a> ï¼ˆOneDrive å›½é™…ç‰ˆä¼ä¸šç‰ˆä¸æ•™è‚²ç‰ˆE5 è®¢é˜…ä¸“ç”¨æœ¬æ–‡ä½¿ç”¨æ­¤ç‰ˆæœ¬ï¼‰</li><li><a href="https://portal.azure.cn/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade">Microsoft Azure.cn App registrations</a>ï¼ˆOneDrive ä¸–çºªäº’è”ä¸“ç”¨ï¼‰</li></ul><h3 id="serrectéœ€è¦åŠ å¯†é“¾æ¥è§å‚è€ƒé“¾æ¥"><a href="#serrectéœ€è¦åŠ å¯†é“¾æ¥è§å‚è€ƒé“¾æ¥" class="headerlink" title="serrectéœ€è¦åŠ å¯†é“¾æ¥è§å‚è€ƒé“¾æ¥"></a>serrectéœ€è¦åŠ å¯†é“¾æ¥è§å‚è€ƒé“¾æ¥</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e934dc8c7a9ad014792319e375d506ab.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e934dc8c7a9ad014792319e375d506ab.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_32138b6f42071fff75dbd218321a5a77.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_32138b6f42071fff75dbd218321a5a77.png"></p><h3 id="æœ¬æ–‡å‚è€ƒï¼š"><a href="#æœ¬æ–‡å‚è€ƒï¼š" class="headerlink" title="æœ¬æ–‡å‚è€ƒï¼š"></a>æœ¬æ–‡å‚è€ƒï¼š</h3><p><a href="https://ovi.swo.moe/zh/docs/advanced">https://ovi.swo.moe/zh/docs/advanced</a><br><a href="https://ovi.swo.moe/zh/docs/getting-started">https://ovi.swo.moe/zh/docs/getting-started</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8sä»ªè¡¨ç›˜éƒ¨ç½²</title>
      <link href="/2024/03/12/k8s%E4%BB%AA%E8%A1%A8%E7%9B%98%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/03/12/k8s%E4%BB%AA%E8%A1%A8%E7%9B%98%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="k8sä»ªè¡¨ç›˜éƒ¨ç½²"><a href="#k8sä»ªè¡¨ç›˜éƒ¨ç½²" class="headerlink" title="k8sä»ªè¡¨ç›˜éƒ¨ç½²"></a>k8sä»ªè¡¨ç›˜éƒ¨ç½²</h2><p><strong>ä»ªè¡¨ç›˜æ–‡ä»¶ä¸‹è½½é“¾æ¥</strong><br><a href="https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml">https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml</a><br><a href="https://drive.zznnwn.cloudns.biz/onedrive/k8s%E9%83%A8%E7%BD%B2%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8F%8Acni/%E4%BD%BF%E7%94%A8container%E4%BD%9C%E4%B8%BA%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8C%E6%97%B6/recommended_v270.yaml">https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/recommended_v270.yaml</a></p><h3 id="éƒ¨ç½²ä»ªè¡¨ç›˜"><a href="#éƒ¨ç½²ä»ªè¡¨ç›˜" class="headerlink" title="éƒ¨ç½²ä»ªè¡¨ç›˜"></a>éƒ¨ç½²ä»ªè¡¨ç›˜</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f &quot;https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml&quot;</span><br><span class="line">kubectl apply -f &quot;https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/recommended_v270.yaml&quot;</span><br></pre></td></tr></table></figure><p><strong>å‘½åç©ºé—´ä¸­çš„åç§°åˆ›å»ºæœåŠ¡å¸æˆ·(admin-user.yml)</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kubernetes-dashboard</span></span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²admin-user.yml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f admin-user.yml </span><br><span class="line">kubectl apply -f <span class="string">&quot;https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/admin-user.yml&quot;</span></span><br></pre></td></tr></table></figure><p>åˆ›å»º ClusterRoleBinding(<code>ClusterRoleBinding.yml</code>)</p><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåœ¨ä½¿ç”¨ æˆ–ä»»ä½•å…¶ä»–å¸¸ç”¨å·¥å…·é¢„é…é›†ç¾¤åï¼Œé›†ç¾¤ä¸­å·²å­˜åœ¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒå¹¶åªä¸ºæˆ‘ä»¬çš„ . å¦‚æœå®ƒä¸å­˜åœ¨ï¼Œåˆ™éœ€è¦å…ˆåˆ›å»ºæ­¤è§’è‰²å¹¶æ‰‹åŠ¨æˆäºˆæ‰€éœ€çš„æƒé™ã€‚<code>kops kubeadm ClusterRole cluster-admin ClusterRoleBinding ServiceAccount</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterRoleBinding</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line">  <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br><span class="line">  <span class="attr">kind:</span> <span class="string">ClusterRole</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">cluster-admin</span></span><br><span class="line"><span class="attr">subjects:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kubernetes-dashboard</span></span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²ClusterRoleBinding.yml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f ClusterRoleBinding.yml </span><br><span class="line">kubectl apply -f <span class="string">&quot;https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/ClusterRoleBinding.yml&quot;</span></span><br></pre></td></tr></table></figure><p><strong>è·å– ServiceAccount çš„æŒæœ‰è€…ä»¤ç‰Œ</strong></p><p>ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¯ç”¨äºç™»å½•çš„ä»¤ç‰Œã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard create token admin-user</span><br></pre></td></tr></table></figure><p><strong>å®ƒåº”è¯¥æ‰“å°å¦‚ä¸‹å†…å®¹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLXY1N253Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIwMzAzMjQzYy00MDQwLTRhNTgtOGE0Ny04NDllZTliYTc5YzEiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9.Z2JrQlitASVwWbc-s6deLRFVk5DWD3P_vjUFXsqVSY10pbjFLG4njoZwh8p3tLxnX_VBsr7_6bwxhWSYChp9hwxznemD5x5HLtjb16kI9Z7yFWLtohzkTwuFbqmQaMoget_nYcQBUC5fDmBHRfFvNKePh_vSSb2h_aYXa8GV5AcfPQpY7r461itme1EXHQJqv-SN-zUnguDguCTjD80pFZ_CmnSE1z9QdMHPB8hoB4V68gtswR1VLa6mSYdgPwCHauuOobojALSaMc3RH7MmFUumAgguhqAkX3Omqd3rJbYOMRuMjhANqd08piDC3aIabINX6gP5-Tuuw2svnV6NYQ</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-an-api-token-for-a-serviceaccount">Kubernetes æ–‡æ¡£</a>ï¼Œäº†è§£æœ‰å…³ ServiceAccount çš„ API ä»¤ç‰Œçš„æ›´å¤šä¿¡æ¯ã€‚</p><h4 id="è·å–-ServiceAccount-çš„é•¿æœŸæŒæœ‰è€…ä»¤ç‰Œ-å»ºè®®ä½¿ç”¨æ­¤ç§"><a href="#è·å–-ServiceAccount-çš„é•¿æœŸæŒæœ‰è€…ä»¤ç‰Œ-å»ºè®®ä½¿ç”¨æ­¤ç§" class="headerlink" title="è·å– ServiceAccount çš„é•¿æœŸæŒæœ‰è€…ä»¤ç‰Œ(å»ºè®®ä½¿ç”¨æ­¤ç§)"></a>è·å– ServiceAccount çš„é•¿æœŸæŒæœ‰è€…ä»¤ç‰Œ(å»ºè®®ä½¿ç”¨æ­¤ç§)</h4><p>æˆ‘ä»¬è¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ secret çš„ä»¤ç‰Œï¼Œè¯¥ä»¤ç‰Œç»‘å®šäº†æœåŠ¡å¸æˆ·ï¼Œä»¤ç‰Œå°†ä¿å­˜åœ¨ Secret ä¸­æ–‡ä»¶(<code>secret_token.yml</code>)</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Secret</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kubernetes-dashboard</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">kubernetes.io/service-account.name:</span> <span class="string">&quot;admin-user&quot;</span>   </span><br><span class="line"><span class="attr">type:</span> <span class="string">kubernetes.io/service-account-token</span>  </span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f secret_token.yml</span><br><span class="line">kubectl apply -f <span class="string">&quot;https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/secret_token.yml&quot;</span></span><br></pre></td></tr></table></figure><p>åˆ›å»º Secret åï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è·å–ä¿å­˜åœ¨ Secret ä¸­çš„ Tokenï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get secret admin-user -n kubernetes-dashboard -o jsonpath=&#123;&quot;.data.token&quot;&#125; | base64 -d</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-a-long-lived-api-token-for-a-serviceaccount">Kubernetes æ–‡æ¡£</a>ï¼Œäº†è§£æœ‰å…³ ServiceAccount çš„é•¿æœŸ API ä»¤ç‰Œçš„æ›´å¤šä¿¡æ¯ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_451018f8aaf9cdda00b42a1da75d3b46.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_451018f8aaf9cdda00b42a1da75d3b46.png"></p><h3 id="æœ€åå°†dashboardç«¯å£æš´éœ²åœ¨å¤–ç”¨äºè®¿é—®"><a href="#æœ€åå°†dashboardç«¯å£æš´éœ²åœ¨å¤–ç”¨äºè®¿é—®" class="headerlink" title="æœ€åå°†dashboardç«¯å£æš´éœ²åœ¨å¤–ç”¨äºè®¿é—®"></a>æœ€åå°†<code>dashboard</code>ç«¯å£æš´éœ²åœ¨å¤–ç”¨äºè®¿é—®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl  patch svc kubernetes-dashboard -n kubernetes-dashboard \</span><br><span class="line">-p <span class="string">&#x27;&#123;&quot;spec&quot;:&#123;&quot;type&quot;:&quot;NodePort&quot;,&quot;ports&quot;:[&#123;&quot;port&quot;:443,&quot;targetPort&quot;:8443,&quot;nodePort&quot;:30443&#125;]&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_57bf21fb0b0a561b21cf24556ecc01a5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_57bf21fb0b0a561b21cf24556ecc01a5.png"></p><h3 id="æ‰©å±•ä¸€é”®éƒ¨ç½²"><a href="#æ‰©å±•ä¸€é”®éƒ¨ç½²" class="headerlink" title="æ‰©å±•ä¸€é”®éƒ¨ç½²"></a>æ‰©å±•ä¸€é”®éƒ¨ç½²</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://drive.zznnwn.cloudns.biz/onedrive/è„šæœ¬/k8sä¸€é”®éƒ¨ç½²è„šæœ¬/k8s-dashboard.sh | bash</span><br></pre></td></tr></table></figure><h3 id="ç™»é™†ä»ªè¡¨ç›˜"><a href="#ç™»é™†ä»ªè¡¨ç›˜" class="headerlink" title="ç™»é™†ä»ªè¡¨ç›˜"></a>ç™»é™†ä»ªè¡¨ç›˜</h3><p>è®¿é—®ï¼š<a href="https://localhost:8443/#/login">https://localhost:8443/#/login</a></p><h3 id="æ¸…ç†å’Œåç»­æ­¥éª¤"><a href="#æ¸…ç†å’Œåç»­æ­¥éª¤" class="headerlink" title="æ¸…ç†å’Œåç»­æ­¥éª¤"></a>æ¸…ç†å’Œåç»­æ­¥éª¤</h3><p>åˆ é™¤ admin å’Œ .<code>ServiceAccount ClusterRoleBinding</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard delete serviceaccount admin-user</span><br><span class="line">kubectl -n kubernetes-dashboard delete clusterrolebinding admin-user</span><br></pre></td></tr></table></figure><p>è¦äº†è§£æœ‰å…³å¦‚ä½•åœ¨ Kubernetes ä¸­æˆäºˆ/æ‹’ç»æƒé™çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·é˜…è¯»å®˜æ–¹<a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/">èº«ä»½éªŒè¯</a>å’Œ<a href="https://kubernetes.io/docs/reference/access-authn-authz/authorization/">æˆæƒ</a>æ–‡æ¡£ã€‚</p><h4 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h4><p><a href="https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/web-ui-dashboard/">https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/web-ui-dashboard/</a><br><a href="https://github.com/kubernetes/dashboard/blob/master/docs/user/access-control/creating-sample-user.md">https://github.com/kubernetes/dashboard/blob/master/docs/user/access-control/creating-sample-user.md</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹</title>
      <link href="/2024/03/12/k8s%E5%8E%BB%E9%99%A4%E6%B1%A1%E7%82%B9%E8%8A%82%E7%82%B9/"/>
      <url>/2024/03/12/k8s%E5%8E%BB%E9%99%A4%E6%B1%A1%E7%82%B9%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹"><a href="#k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹" class="headerlink" title="k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹"></a>k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹</h3><p><strong>ç°è±¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹èŠ‚ç‚¹è¯¦æƒ…</span></span><br><span class="line">kubectl describe pods nginx-7b7485646b-n9f8g  -n default  </span><br><span class="line"></span><br><span class="line"><span class="comment">################æŠ¥é”™ä¿¡æ¯##############</span></span><br><span class="line"></span><br><span class="line">Node-Selectors:                                                                                                          </span><br><span class="line">Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists <span class="keyword">for</span> 300s                                         </span><br><span class="line">                             node.kubernetes.io/unreachable:NoExecute op=Exists <span class="keyword">for</span> 300s                                       </span><br><span class="line">Events:                                                                                                                        </span><br><span class="line">  Type     Reason            Age    From               Message                                                                 </span><br><span class="line">  ----     ------            ----   ----               -------                                                                 </span><br><span class="line">  Warning  FailedScheduling  2m54s  default-scheduler  0/1 nodes are available: 1 node(s) had untolerated taint &#123;node-role.kubernetes.io/control-plane: &#125;. </span><br><span class="line">preemption: 0/1 nodes are available: 1 Preemption is not helpful <span class="keyword">for</span> scheduling.. </span><br></pre></td></tr></table></figure><p><strong>è§£å†³</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@k8s:~<span class="comment"># kubectl describe nodes |grep Taints                                                                                                      </span></span><br><span class="line">Taints:             node-role.kubernetes.io/control-plane:NoSchedule                                                                                 </span><br><span class="line">                                                                                                                                                                                        </span><br><span class="line">root@k8s:~<span class="comment"># kubectl get node                                                                                                                         </span></span><br><span class="line">NAME   STATUS   ROLES           AGE     VERSION                                                                                                      </span><br><span class="line">k8s    Ready    control-plane   4h22m   v1.26.5                                                                                                      </span><br><span class="line">root@k8s:~<span class="comment"># kubectl taint nodes k8s  node-role.kubernetes.io/control-plane-</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_169b466f0666661a0ccb13ce6795653b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_169b466f0666661a0ccb13ce6795653b.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8så¸¸ç”¨å‘½ä»¤</title>
      <link href="/2024/03/12/k8s%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2024/03/12/k8s%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="k8så¸¸ç”¨å‘½ä»¤"><a href="#k8så¸¸ç”¨å‘½ä»¤" class="headerlink" title="k8så¸¸ç”¨å‘½ä»¤"></a>k8så¸¸ç”¨å‘½ä»¤</h3><h4 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h4><p>è¿™æ˜¯ä¸€ä¸ªç”¨äºç®¡ç† Kubernetes é›†ç¾¤çš„ kubectl å‘½ä»¤ã€‚è®©æˆ‘ä»¬è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‘½ä»¤çš„å„ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><strong>kubectl</strong>: è¿™æ˜¯ Kubernetes å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºä¸ Kubernetes é›†ç¾¤è¿›è¡Œäº¤äº’ï¼Œä¾‹å¦‚åˆ›å»ºã€ç®¡ç†å’Œç›‘è§†èµ„æºã€‚</li><li><strong>get</strong>: è¿™æ˜¯ kubectl å‘½ä»¤çš„ä¸€ä¸ªå­å‘½ä»¤ï¼Œç”¨äºæ£€ç´¢ï¼ˆè·å–ï¼‰Kubernetes é›†ç¾¤ä¸­çš„èµ„æºçš„ä¿¡æ¯ã€‚</li><li><strong>svc</strong>: è¿™æ˜¯ â€œserviceâ€ çš„ç¼©å†™ï¼Œè¡¨ç¤ºä½ å¸Œæœ›è·å–æœåŠ¡ï¼ˆServiceï¼‰çš„ç›¸å…³ä¿¡æ¯ã€‚</li><li><strong>deploy</strong>: è¿™æ˜¯ â€œdeploymentâ€ çš„ç¼©å†™ï¼Œè¡¨ç¤ºä½ å¸Œæœ›è·å–éƒ¨ç½²ï¼ˆDeploymentï¼‰çš„ç›¸å…³ä¿¡æ¯ã€‚</li><li><strong>-n kube-system</strong>: è¿™æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼ˆflagï¼‰ï¼Œç”¨äºæŒ‡å®šè¦æ£€ç´¢èµ„æºæ‰€åœ¨çš„å‘½åç©ºé—´ï¼ˆnamespaceï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œâ€-n kube-systemâ€ è¡¨ç¤ºä½ å¸Œæœ›è·å–ä½äº kube-system å‘½åç©ºé—´ä¸­çš„æœåŠ¡çš„ä¿¡æ¯ã€‚</li></ul><h2 id="k8så¸¸ç”¨å‘½ä»¤-1"><a href="#k8så¸¸ç”¨å‘½ä»¤-1" class="headerlink" title="k8så¸¸ç”¨å‘½ä»¤"></a>k8så¸¸ç”¨å‘½ä»¤</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹é•œåƒ</span><br><span class="line">kubeadm config images list </span><br><span class="line"># æŸ¥çœ‹æœåŠ¡</span><br><span class="line">kubectl get pod,svc</span><br><span class="line">#  ç¼–è¾‘cm</span><br><span class="line">kubectl  edit cm -n apiconfig</span><br></pre></td></tr></table></figure><p><strong>ç»å¸¸ä½¿ç”¨çš„æ“ä½œæœ‰ä¸‹é¢è¿™äº›ï¼š</strong></p><table><thead><tr><th><strong>å‘½ä»¤åˆ†ç±»</strong></th><th><strong>å‘½ä»¤</strong></th><th><strong>ç¿»è¯‘</strong></th><th><strong>å‘½ä»¤ä½œç”¨</strong></th></tr></thead><tbody><tr><td><strong>åŸºæœ¬å‘½ä»¤</strong></td><td><strong>create</strong></td><td><strong>åˆ›å»º</strong></td><td><strong>åˆ›å»ºä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>edit</strong></td><td><strong>ç¼–è¾‘</strong></td><td><strong>ç¼–è¾‘ä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>get</strong></td><td><strong>è·å–</strong></td><td><strong>è·å–ä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>patch</strong></td><td><strong>æ›´æ–°</strong></td><td><strong>æ›´æ–°ä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>delete</strong></td><td><strong>åˆ é™¤</strong></td><td><strong>åˆ é™¤ä¸€ä¸ªèµ„æº</strong></td></tr><tr><td></td><td><strong>explain</strong></td><td><strong>è§£é‡Š</strong></td><td><strong>å±•ç¤ºèµ„æºæ–‡æ¡£</strong></td></tr><tr><td><strong>è¿è¡Œå’Œè°ƒè¯•</strong></td><td><strong>run</strong></td><td><strong>è¿è¡Œ</strong></td><td><strong>åœ¨é›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„é•œåƒ</strong></td></tr><tr><td></td><td><strong>expose</strong></td><td><strong>æš´éœ²</strong></td><td><strong>æš´éœ²èµ„æºä¸º Service</strong></td></tr><tr><td></td><td><strong>describe</strong></td><td><strong>æè¿°</strong></td><td><strong>æ˜¾ç¤ºèµ„æºå†…éƒ¨ä¿¡æ¯</strong></td></tr><tr><td></td><td><strong>logs</strong></td><td><strong>æ—¥å¿—è¾“å‡ºå®¹å™¨åœ¨ pod ä¸­çš„æ—¥å¿—</strong></td><td><strong>è¾“å‡ºå®¹å™¨åœ¨ pod ä¸­çš„æ—¥å¿—</strong></td></tr><tr><td></td><td><strong>attach</strong></td><td><strong>ç¼ ç»•è¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨</strong></td><td><strong>è¿›å…¥è¿è¡Œä¸­çš„å®¹å™¨</strong></td></tr><tr><td></td><td><strong>exec</strong></td><td><strong>æ‰§è¡Œå®¹å™¨ä¸­çš„ä¸€ä¸ªå‘½ä»¤</strong></td><td><strong>æ‰§è¡Œå®¹å™¨ä¸­çš„ä¸€ä¸ªå‘½ä»¤</strong></td></tr><tr><td></td><td><strong>cp</strong></td><td><strong>å¤åˆ¶</strong></td><td><strong>åœ¨Podå†…å¤–å¤åˆ¶æ–‡ä»¶</strong></td></tr><tr><td></td><td><strong>rollout</strong></td><td><strong>é¦–æ¬¡å±•ç¤º</strong></td><td><strong>ç®¡ç†èµ„æºçš„å‘å¸ƒ</strong></td></tr><tr><td></td><td><strong>scale</strong></td><td><strong>è§„æ¨¡</strong></td><td><strong>æ‰©(ç¼©)å®¹Podçš„æ•°é‡</strong></td></tr><tr><td></td><td><strong>autoscale</strong></td><td><strong>è‡ªåŠ¨è°ƒæ•´</strong></td><td><strong>è‡ªåŠ¨è°ƒæ•´Podçš„æ•°é‡</strong></td></tr><tr><td><strong>é«˜çº§å‘½ä»¤</strong></td><td><strong>apply</strong></td><td><strong>rc</strong></td><td><strong>é€šè¿‡æ–‡ä»¶å¯¹èµ„æºè¿›è¡Œé…ç½®</strong></td></tr><tr><td></td><td><strong>label</strong></td><td><strong>æ ‡ç­¾</strong></td><td><strong>æ›´æ–°èµ„æºä¸Šçš„æ ‡ç­¾</strong></td></tr><tr><td><strong>å…¶ä»–å‘½ä»¤</strong></td><td><strong>cluster-info</strong></td><td><strong>é›†ç¾¤ä¿¡æ¯</strong></td><td><strong>æ˜¾ç¤ºé›†ç¾¤ä¿¡æ¯</strong></td></tr><tr><td></td><td><strong>version</strong></td><td><strong>ç‰ˆæœ¬</strong></td><td><strong>æ˜¾ç¤ºå½“å‰Serverå’ŒClientçš„ç‰ˆæœ¬</strong></td></tr></tbody></table><p><strong>ç»å¸¸ä½¿ç”¨çš„èµ„æºæœ‰ä¸‹é¢è¿™äº›ï¼š</strong></p><table><thead><tr><th><strong>èµ„æºåˆ†ç±»</strong></th><th><strong>èµ„æºåç§°</strong></th><th><strong>ç¼©å†™</strong></th><th><strong>èµ„æºä½œç”¨</strong></th></tr></thead><tbody><tr><td><strong>é›†ç¾¤çº§åˆ«èµ„æº</strong></td><td><strong>nodes</strong></td><td><strong>no</strong></td><td><strong>é›†ç¾¤ç»„æˆéƒ¨åˆ†</strong></td></tr><tr><td><strong>namespaces</strong></td><td><strong>ns</strong></td><td><strong>éš”ç¦»Pod</strong></td><td></td></tr><tr><td><strong>podèµ„æº</strong></td><td><strong>pods</strong></td><td><strong>po</strong></td><td><strong>è£…è½½å®¹å™¨</strong></td></tr><tr><td><strong>podèµ„æºæ§åˆ¶å™¨</strong></td><td><strong>replicationcontrollers</strong></td><td><strong>rc</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>replicasets</strong></td><td><strong>rs</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>deployments</strong></td><td><strong>deploy</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>daemonsets</strong></td><td><strong>ds</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>jobs</strong></td><td></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>cronjobs</strong></td><td><strong>cj</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>horizontalpodautoscalers</strong></td><td><strong>hpa</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td></td><td><strong>statefulsets</strong></td><td><strong>sts</strong></td><td><strong>æ§åˆ¶podèµ„æº</strong></td></tr><tr><td><strong>æœåŠ¡å‘ç°èµ„æº</strong></td><td><strong>services</strong></td><td><strong>svc</strong></td><td><strong>ç»Ÿä¸€podå¯¹å¤–æ¥å£</strong></td></tr><tr><td></td><td><strong>ingress</strong></td><td><strong>ing</strong></td><td><strong>ç»Ÿä¸€podå¯¹å¤–æ¥å£</strong></td></tr><tr><td><strong>å­˜å‚¨èµ„æº</strong></td><td><strong>volumeattachments</strong></td><td></td><td><strong>å­˜å‚¨</strong></td></tr><tr><td></td><td><strong>persistentvolumes</strong></td><td><strong>pv</strong></td><td><strong>å­˜å‚¨</strong></td></tr><tr><td></td><td><strong>persistentvolumeclaims</strong></td><td><strong>pvc</strong></td><td><strong>å­˜å‚¨</strong></td></tr><tr><td><strong>é…ç½®èµ„æº</strong></td><td><strong>configmaps</strong></td><td><strong>cm</strong></td><td><strong>é…ç½®</strong></td></tr><tr><td></td><td><strong>secrets</strong></td><td></td><td><strong>é…ç½®</strong></td></tr></tbody></table><p><strong>é€šè¿‡ymlåˆ›å»ºåˆ é™¤åº”ç”¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply  -f kuboard-offline.yml</span><br><span class="line">kubectl delete -f kuboard-offline.yml</span><br><span class="line">kubectl apply  -f nginx-deployment.yml</span><br></pre></td></tr></table></figure><p><strong>é€šè¿‡å‘½ä»¤è¡Œåˆ›å»ºåº”ç”¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å¸®åŠ©å‘½ä»¤</span></span><br><span class="line">kubectl create deployment --<span class="built_in">help</span></span><br><span class="line"><span class="comment"># å¼€å§‹å‘å¸ƒåº”ç”¨ æŒ‡å®šåç§°æ˜¯demo é•œåƒæ˜¯nginx:1.7.9 å‰¯æœ¬æ•°æ˜¯3</span></span><br><span class="line">kubectl create deployment demo --image=nginx:1.7.9 --replicas=3</span><br><span class="line"><span class="comment">#åˆ›å»ºserviceæš´éœ²ç«¯å£ä½¿ç”¨vipè®¿é—®</span></span><br><span class="line">kubectl expose deployment demo --port=80 --target-port=80 </span><br><span class="line"></span><br><span class="line">kubectl create deployment nginx --image=registry.cn-hangzhou.aliyuncs.com/xiaohh-docker/nginx:latest</span><br><span class="line">kubectl expose deployment nginx --port=80 --<span class="built_in">type</span>=LoadBalancer</span><br><span class="line">kubectl delete deployment nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºservice </span></span><br><span class="line">kubectl create -f nginx-service.yaml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æš´éœ²åœ¨å¤–éƒ¨çš„ç«¯å£</span></span><br><span class="line">kubectl get service/nginx-service</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤pod</span></span><br><span class="line">kubectl delete deployment demo </span><br></pre></td></tr></table></figure><p><strong>æš´éœ²å¤–éƒ¨ç«¯å£ç”¨äºè®¿é—®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl  patch svc kubernetes-dashboard -n kubernetes-dashboard \</span><br><span class="line">-p <span class="string">&#x27;&#123;&quot;spec&quot;:&#123;&quot;type&quot;:&quot;NodePort&quot;,&quot;ports&quot;:[&#123;&quot;port&quot;:443,&quot;targetPort&quot;:8443,&quot;nodePort&quot;:30443&#125;]&#125;&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹podè¯¦æƒ…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å‘½åç©ºé—´ä¸ºkube-systemçš„podè¯¦æƒ…</span></span><br><span class="line">kubectl get pods -n kube-system</span><br><span class="line">kubectl get pods -n kube-system -o wide</span><br><span class="line">kubectl describe pod kubernetes-dashboard-7bdfc744fc-hmhh2 -n kube-system</span><br><span class="line"><span class="comment"># è·å–ä½äº kube-system/kubernetes-dashboard å‘½åç©ºé—´ä¸­çš„æ‰€æœ‰æœåŠ¡ï¼ˆServiceï¼‰çš„ä¿¡æ¯ã€‚è¿™å°†åˆ—å‡º kube-system å‘½åç©ºé—´ä¸­æ‰€æœ‰æœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœåŠ¡çš„åç§°ã€ç±»å‹ã€é›†ç¾¤IPç­‰ã€‚</span></span><br><span class="line">kubectl get svc -n kube-system</span><br><span class="line">kubectl get svc -n kubernetes-dashboard </span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç³»ç»Ÿpodä»¥å¤–çš„podè¯¦æƒ…/æŸ¥çœ‹è‡ªå·±éƒ¨ç½²çš„åº”ç”¨</span></span><br><span class="line">kubectl get pods -o wide</span><br><span class="line">kubectl get deployments.apps</span><br><span class="line">kubectl describe pods nginx-deployment-57c68fcd95-sgd25</span><br><span class="line"><span class="comment"># æŸ¥çœ‹demoåº”ç”¨ï¼ˆå®¹å™¨ï¼‰service(svc)è¯¦ç»†</span></span><br><span class="line">kubectl describe service demo</span><br><span class="line"><span class="comment"># æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€</span></span><br><span class="line">kubectl get nodes</span><br><span class="line">kubectl get cs</span><br><span class="line"><span class="comment"># corednsç»„ä»¶ç”¨äºåšåç§°è§£æ ä¸»è¦æ˜¯é€šè¿‡daemonsets.appsçš„å½¢å¼åœ¨é‡Œé¢éƒ¨ç½²ä¸¤ä¸ªdaemonsetåˆ†åˆ«æ˜¯kube-flannel-ds å’Œ kube-proxy</span></span><br><span class="line">kubectl get daemonsets.apps -n kube-system</span><br></pre></td></tr></table></figure><p><strong>ç™»é™†è¿›å…¥podç›¸å½“äºdocker exec</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç™»å½•å®¹å™¨æŸ¥çœ‹volumesè¯¦æƒ…</span></span><br><span class="line">kubectl <span class="built_in">exec</span> -it volume-rbd-demo /bin/bash</span><br><span class="line">kubectl <span class="built_in">exec</span> -it volume-rbd-demo -- <span class="built_in">df</span> -h</span><br></pre></td></tr></table></figure><p><strong>éƒ¨åˆ†å‘½ä»¤å®Œæ•´å†™æ³•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get deployment --namespace=kubernetes-dashboard kubernetes-dashboard</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">$ kubectl describe deployment --namespace=kubernetes-dashboard kubernetes-dashboard</span><br><span class="line"><span class="comment"># æŸ¥çœ‹service</span></span><br><span class="line">$ kubectl get service --namespace=kubernetes-dashboard kubernetes-dashboard </span><br><span class="line">è¿”å›</span><br><span class="line">NAME                   TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)   AGE</span><br><span class="line">kubernetes-dashboard   ClusterIP   10.108.163.102   &lt;none&gt;        443/TCP   5m15s</span><br><span class="line"><span class="comment"># å¦å¤–æŸ¥çœ‹podçŠ¶æ€ (æ­¤æ—¶è¯´æ˜å®‰è£…å®Œæˆ</span></span><br><span class="line">$ kubectl --namespace=kubernetes-dashboard get pod -o wide | grep dashboard</span><br><span class="line">è¿”å›</span><br><span class="line">dashboard-metrics-scraper-79459f84f-5g8h6   1/1     Running   0          5m34s   172.16.0.9   ceph1   &lt;none&gt;   </span><br><span class="line">kubernetes-dashboard-76dc96b85f-nhwjd       1/1     Running   0          5m34s   172.16.0.8   ceph1   &lt;none&gt;</span><br><span class="line"><span class="comment"># æŸ¥çœ‹svc</span></span><br><span class="line">kubectl -n kubernetes-dashboard get svc</span><br><span class="line">NAME                        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE</span><br><span class="line">dashboard-metrics-scraper   ClusterIP   10.104.31.122    &lt;none&gt;        8000/TCP   32m</span><br><span class="line">kubernetes-dashboard        ClusterIP   10.108.163.102   &lt;none&gt;        443/TCP    32m</span><br><span class="line"><span class="comment"># å¦‚æœçŠ¶æ€ä¸€ç›´åˆ›å»ºä¸­, ä½¿ç”¨describeæŸ¥çœ‹å…·ä½“è¿‡ç¨‹ ï¼ˆå¦‚ä¸‹å›æ˜¾åˆ™éœ€è¦è®¾ç½®æ‹‰å–é•œåƒæ–¹æ³•ï¼‰</span></span><br><span class="line">$ kubectl describe pod --namespace=kubernetes-dashboard</span><br></pre></td></tr></table></figure><h3 id="ä¸€-å¼€å§‹"><a href="#ä¸€-å¼€å§‹" class="headerlink" title="ä¸€.  å¼€å§‹"></a>ä¸€.  å¼€å§‹</h3><h4 id="1-åˆ é™¤pod"><a href="#1-åˆ é™¤pod" class="headerlink" title="1. åˆ é™¤pod"></a>1. åˆ é™¤pod</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹pod</span></span><br><span class="line">kubectl get pods -A</span><br><span class="line"><span class="comment"># åˆ é™¤pod</span></span><br><span class="line"><span class="comment"># æ£€æŸ¥ Pod è¯¦ç»†ä¿¡æ¯ï¼šé¦–å…ˆï¼ŒæŸ¥çœ‹è¯¥ Pod çš„è¯¦ç»†ä¿¡æ¯ä»¥äº†è§£å…¶çŠ¶æ€å’Œå¯èƒ½çš„åŸå› ã€‚è¿™å°†æ˜¾ç¤º Pod çš„ YAML é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å½“å‰çš„çŠ¶æ€å’Œå…¶ä»–è¯¦ç»†ä¿¡æ¯ã€‚</span></span><br><span class="line">kubectl get pod kuboard-cc79974cd-7xkpc -n kube-system -o yaml</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ Podï¼šå¦‚æœç¡®å®šè¦åˆ é™¤è¯¥ Podï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</span></span><br><span class="line">è¯·æ³¨æ„ï¼Œå¼ºåˆ¶åˆ é™¤å¯èƒ½ä¼šå¯¼è‡´å®¹å™¨å’Œç›¸å…³èµ„æºæ— æ³•æ­£å¸¸ç»ˆæ­¢ï¼Œè¿™å¯èƒ½ä¼šå½±å“æ­£åœ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºã€‚å¦‚æœå¯èƒ½çš„è¯ï¼Œæœ€å¥½å…ˆè®© Pod è‡ªè¡Œç»ˆæ­¢ï¼ˆé€šå¸¸éœ€è¦ä¸€äº›æ—¶é—´ï¼‰ï¼Œç„¶åå†å°è¯•åˆ é™¤å®ƒã€‚</span><br><span class="line"></span><br><span class="line">kubectl delete pod kuboard-cc79974cd-7xkpc -n kube-system</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ£€æŸ¥åˆ é™¤ç»“æœï¼šä½ å¯ä»¥å†æ¬¡ä½¿ç”¨ kubectl get pods å‘½ä»¤æ¥ç¡®è®¤è¯¥ Pod æ˜¯å¦å·²ç»è¢«æˆåŠŸåˆ é™¤ã€‚</span></span><br><span class="line"></span><br><span class="line">kubectl get pods -n kube-system</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤ä¸€ä¸ªåä¸º nginx-deployment çš„ Deployment</span></span><br><span class="line"></span><br><span class="line">kubectl delete deployment nginx-deployment</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¦‚æœä½ ä¸ç¡®å®šå…·ä½“éœ€è¦åˆ é™¤å“ªäº›èµ„æºï¼Œä½¿ç”¨æŸ¥çœ‹ç›¸å…³èµ„æºï¼Œç„¶åé€ä¸ªåˆ é™¤ã€‚</span></span><br><span class="line"></span><br><span class="line">kubectl get all --selector app=nginx </span><br></pre></td></tr></table></figure><h4 id="2-åˆ é™¤podçš„æ˜ å°„ç«¯å£"><a href="#2-åˆ é™¤podçš„æ˜ å°„ç«¯å£" class="headerlink" title="2. åˆ é™¤podçš„æ˜ å°„ç«¯å£"></a>2. åˆ é™¤podçš„æ˜ å°„ç«¯å£</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ˜ å°„ç«¯å£</span></span><br><span class="line">kubectl get svc</span><br><span class="line"><span class="comment"># åˆ é™¤nginxæ˜ å°„çš„ç«¯å£</span></span><br><span class="line">kubectl delete svc nginx</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8så•èŠ‚ç‚¹ä¸é›†ç¾¤éƒ¨ç½²</title>
      <link href="/2024/03/11/k8s%E5%8D%95%E8%8A%82%E7%82%B9%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/03/11/k8s%E5%8D%95%E8%8A%82%E7%82%B9%E4%B8%8E%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="k8så•èŠ‚ç‚¹ä¸é›†ç¾¤éƒ¨ç½²"><a href="#k8så•èŠ‚ç‚¹ä¸é›†ç¾¤éƒ¨ç½²" class="headerlink" title="k8så•èŠ‚ç‚¹ä¸é›†ç¾¤éƒ¨ç½²"></a>k8så•èŠ‚ç‚¹ä¸é›†ç¾¤éƒ¨ç½²</h1><blockquote><p>ä½¿ç”¨containerä½œä¸ºk8så®¹å™¨è¿è¡Œæ—¶æœåŠ¡å™¨ä¸éœ€è¦å®‰è£…cni<br><strong>kube-flannel.ymlé…ç½®åŸé“¾æ¥</strong><br><a href="https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml">https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</a></p></blockquote><h2 id="ä¸€-é¡¹ç›®é“¾æ¥-gt-gt-gt-gt-gt-gt-gt-gt-gt-gt-gt"><a href="#ä¸€-é¡¹ç›®é“¾æ¥-gt-gt-gt-gt-gt-gt-gt-gt-gt-gt-gt" class="headerlink" title="ä¸€. é¡¹ç›®é“¾æ¥ | &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;"></a>ä¸€. é¡¹ç›®é“¾æ¥ | &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</h2><p><a href="https://gitee.com/apple-Teawine/k8s/tree/master/deploy-k8s-container%E7%89%88">é¡¹ç›®é“¾æ¥</a></p><p><a href="https://onenote.zznnwn.cloudns.biz/zh-CN/%E8%84%9A%E6%9C%AC/k8s%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC/">onedriveé“¾æ¥</a></p><h2 id="äºŒ-k8sv1-28-0-00ç‰ˆæœ¬é›†ç¾¤éƒ¨ç½²"><a href="#äºŒ-k8sv1-28-0-00ç‰ˆæœ¬é›†ç¾¤éƒ¨ç½²" class="headerlink" title="äºŒ. k8sv1.28.0-00ç‰ˆæœ¬é›†ç¾¤éƒ¨ç½²"></a>äºŒ. k8sv1.28.0-00ç‰ˆæœ¬é›†ç¾¤éƒ¨ç½²</h2><ul><li>æ¨èç¯å¢ƒï¼šubuntu20.04</li><li>k8sè½¯ä»¶æºï¼šé˜¿é‡Œäº‘</li><li>ä¸¤è€…æœ€å¥½è®¾ç½®å¥½å…å¯†ç™»å½•</li></ul><h3 id="a-masterèŠ‚ç‚¹éƒ¨ç½²ï¼ˆall-in-oneç‰ˆk8sï¼‰"><a href="#a-masterèŠ‚ç‚¹éƒ¨ç½²ï¼ˆall-in-oneç‰ˆk8sï¼‰" class="headerlink" title="a. masterèŠ‚ç‚¹éƒ¨ç½²ï¼ˆall-in-oneç‰ˆk8sï¼‰"></a>a. masterèŠ‚ç‚¹éƒ¨ç½²ï¼ˆall-in-oneç‰ˆk8sï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸€é”®éƒ¨ç½²all-in-oneç‰ˆk8s</span></span><br><span class="line">curl -sSL https://onenote.zznnwn.cloudns.biz/api/raw/?path=/è„šæœ¬/k8sä¸€é”®éƒ¨ç½²è„šæœ¬/k8s_v1.28.sh | IP=10.0.0.10 KUBELET=1.28.0-00 HOSTNAME=k8s MIRROR=aliyun DOCKER=no bash </span><br></pre></td></tr></table></figure><h3 id="b-æ™®é€šèŠ‚ç‚¹éƒ¨ç½²ååŠ å…¥é›†ç¾¤"><a href="#b-æ™®é€šèŠ‚ç‚¹éƒ¨ç½²ååŠ å…¥é›†ç¾¤" class="headerlink" title="b. æ™®é€šèŠ‚ç‚¹éƒ¨ç½²ååŠ å…¥é›†ç¾¤"></a>b. æ™®é€šèŠ‚ç‚¹éƒ¨ç½²ååŠ å…¥é›†ç¾¤</h3><h4 id="1-æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬-éœ€è¦å®‰è£…å¥½docker"><a href="#1-æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬-éœ€è¦å®‰è£…å¥½docker" class="headerlink" title="1.æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬ éœ€è¦å®‰è£…å¥½docker"></a>1.æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬ éœ€è¦å®‰è£…å¥½<code>docker</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://onenote.zznnwn.cloudns.biz/api/raw/?path=/è„šæœ¬/linuxåˆå§‹åŒ–è„šæœ¬/init_latest.sh | HOSTNAME=k8s1 IP=10.0.0.10 MIRROR=aliyun DOCKER=<span class="built_in">yes</span> bash</span><br></pre></td></tr></table></figure><h4 id="2-éƒ¨ç½²è‡ªåŠ¨æ‹‰å–é•œåƒè„šæœ¬"><a href="#2-éƒ¨ç½²è‡ªåŠ¨æ‹‰å–é•œåƒè„šæœ¬" class="headerlink" title="2.éƒ¨ç½²è‡ªåŠ¨æ‹‰å–é•œåƒè„šæœ¬"></a>2.éƒ¨ç½²è‡ªåŠ¨æ‹‰å–é•œåƒè„šæœ¬</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL  https://onenote.zznnwn.cloudns.biz/api/raw/?path=/è„šæœ¬/k8sä¸€é”®éƒ¨ç½²è„šæœ¬/download_k8s_images.sh |bash</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="3-æ‰§è¡Œéƒ¨ç½²k8sç¯å¢ƒ"><a href="#3-æ‰§è¡Œéƒ¨ç½²k8sç¯å¢ƒ" class="headerlink" title="3.æ‰§è¡Œéƒ¨ç½²k8sç¯å¢ƒ"></a>3.æ‰§è¡Œéƒ¨ç½²k8sç¯å¢ƒ</h4><p>å¦‚æœæ˜¯å…¶ä»–ç‰ˆæœ¬å…¶ä»–èŠ‚ç‚¹åŠ å…¥åªéœ€è¦ä¿®æ”¹è„šæœ¬ç‰ˆæœ¬å˜é‡å³å¯</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_98a7e0f652cad742031e5d7025cb0cbe.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/11/image_98a7e0f652cad742031e5d7025cb0cbe.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -O  k8s_v1.28_local.sh  https://onenote.zznnwn.cloudns.biz/api/raw/?path=/è„šæœ¬/k8sä¸€é”®éƒ¨ç½²è„šæœ¬/k8s_v1.28_local.sh</span><br></pre></td></tr></table></figure><h4 id="4-æ‰§è¡Œ-kubeadm-join-åŠ å…¥k8sé›†ç¾¤-å¦‚æœå¿˜è®°äº†-åˆ™æ‰§è¡Œå¦‚ä¸‹é‡æ–°è·å–"><a href="#4-æ‰§è¡Œ-kubeadm-join-åŠ å…¥k8sé›†ç¾¤-å¦‚æœå¿˜è®°äº†-åˆ™æ‰§è¡Œå¦‚ä¸‹é‡æ–°è·å–" class="headerlink" title="4.æ‰§è¡Œ kubeadm join åŠ å…¥k8sé›†ç¾¤ å¦‚æœå¿˜è®°äº† åˆ™æ‰§è¡Œå¦‚ä¸‹é‡æ–°è·å–"></a>4.æ‰§è¡Œ kubeadm join åŠ å…¥k8sé›†ç¾¤ å¦‚æœå¿˜è®°äº† åˆ™æ‰§è¡Œå¦‚ä¸‹é‡æ–°è·å–</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm token create --print-join-command</span><br></pre></td></tr></table></figure><p>éƒ¨ç½²å®Œæˆåæµ‹è¯•é›†ç¾¤çŠ¶æ€</p><h3 id="éƒ¨ç½²ä¸€ä¸ªNGNINX"><a href="#éƒ¨ç½²ä¸€ä¸ªNGNINX" class="headerlink" title="éƒ¨ç½²ä¸€ä¸ªNGNINX"></a>éƒ¨ç½²ä¸€ä¸ª<code>NGNINX</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create deployment nginx  --image=nginx:1.14-alpine</span><br></pre></td></tr></table></figure><h3 id="æš´éœ²ç«¯å£-type-NodePorté›†ç¾¤ä¹‹å¤–è®¿é—®"><a href="#æš´éœ²ç«¯å£-type-NodePorté›†ç¾¤ä¹‹å¤–è®¿é—®" class="headerlink" title="æš´éœ²ç«¯å£--type=NodePorté›†ç¾¤ä¹‹å¤–è®¿é—®"></a>æš´éœ²ç«¯å£<code>--type=NodePort</code>é›†ç¾¤ä¹‹å¤–è®¿é—®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl expose deploy nginx  --port=80 --target-port=80  --<span class="built_in">type</span>=NodePort</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹å¤–éƒ¨è®¿é—®ç«¯å£ã€ä¸‰æ¡å‘½ä»¤éƒ½èƒ½ä½¿ç”¨ã€‘"><a href="#æŸ¥çœ‹å¤–éƒ¨è®¿é—®ç«¯å£ã€ä¸‰æ¡å‘½ä»¤éƒ½èƒ½ä½¿ç”¨ã€‘" class="headerlink" title="æŸ¥çœ‹å¤–éƒ¨è®¿é—®ç«¯å£ã€ä¸‰æ¡å‘½ä»¤éƒ½èƒ½ä½¿ç”¨ã€‘"></a>æŸ¥çœ‹å¤–éƒ¨è®¿é—®ç«¯å£ã€ä¸‰æ¡å‘½ä»¤éƒ½èƒ½ä½¿ç”¨ã€‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubecet get svc </span><br><span class="line">kubecet get svc -n deauflt</span><br><span class="line">kubectl get pod,svc</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_a3f218144218f3b84fc841c95cfa40e7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_a3f218144218f3b84fc841c95cfa40e7.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_58648684/article/details/130699568">https://blog.csdn.net/weixin_58648684/article/details/130699568</a><br><a href="https://cn.linux-console.net/?p=3508">https://cn.linux-console.net/?p=3508</a>  containerå®‰è£…å‚è€ƒ<br><a href="https://wn-apple-teawine.fun/2023/06/04/ubuntu%E9%83%A8%E7%BD%B2kubernetes">https://wn-apple-teawine.fun/2023/06/04/ubuntuéƒ¨ç½²kubernetes</a><br><a href="https://www.cnblogs.com/way2backend/p/16970506.html#3-%E5%AE%89%E8%A3%85containerd">https://www.cnblogs.com/way2backend/p/16970506.html#3-%E5%AE%89%E8%A3%85containerd</a><br><a href="https://blog.csdn.net/IOT_AI/article/details/131916926">[Ubuntu 22.04] å®‰è£…containerd_ubuntu22.04 å®‰è£…containerd-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨Linuxä¸Šä»¥All-in-Oneæ¨¡å¼å®‰è£…KubeSphere</title>
      <link href="/2024/03/10/%E5%9C%A8Linux%E4%B8%8A%E4%BB%A5All-in-One%E6%A8%A1%E5%BC%8F%E5%AE%89%E8%A3%85KubeSphere/"/>
      <url>/2024/03/10/%E5%9C%A8Linux%E4%B8%8A%E4%BB%A5All-in-One%E6%A8%A1%E5%BC%8F%E5%AE%89%E8%A3%85KubeSphere/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>é¦–å…ˆæœåŠ¡å™¨æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬ å®‰è£…docker</p><p>æœ¬æ–‡å‚è€ƒï¼š<a href="https://kubesphere.io/zh/docs/v3.4/quick-start/all-in-one-on-linux/">https://kubesphere.io/zh/docs/v3.4/quick-start/all-in-one-on-linux/</a></p><h3 id="èŠ‚ç‚¹è¦æ±‚"><a href="#èŠ‚ç‚¹è¦æ±‚" class="headerlink" title="èŠ‚ç‚¹è¦æ±‚"></a>èŠ‚ç‚¹è¦æ±‚</h3><ul><li>èŠ‚ç‚¹å¿…é¡»èƒ½å¤Ÿé€šè¿‡ <code>SSH</code> è¿æ¥ã€‚</li><li>èŠ‚ç‚¹ä¸Šå¯ä»¥ä½¿ç”¨ <code>sudo</code>/<code>curl</code>/<code>openssl</code>/<code>tar</code> å‘½ä»¤ã€‚</li></ul><h3 id="å®¹å™¨è¿è¡Œæ—¶"><a href="#å®¹å™¨è¿è¡Œæ—¶" class="headerlink" title="å®¹å™¨è¿è¡Œæ—¶"></a>å®¹å™¨è¿è¡Œæ—¶</h3><p>æ‚¨çš„é›†ç¾¤å¿…é¡»æœ‰ä¸€ä¸ªå¯ç”¨çš„å®¹å™¨è¿è¡Œæ—¶ã€‚å¦‚æœæ‚¨ä½¿ç”¨ KubeKey æ­å»ºé›†ç¾¤ï¼ŒKubeKey ä¼šé»˜è®¤å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Dockerã€‚æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºé›†ç¾¤å‰æ‰‹åŠ¨å®‰è£… Docker æˆ–å…¶ä»–å®¹å™¨è¿è¡Œæ—¶ã€‚</p><table><thead><tr><th>æ”¯æŒçš„å®¹å™¨è¿è¡Œæ—¶</th><th>ç‰ˆæœ¬</th></tr></thead><tbody><tr><td>Docker</td><td>19.3.8 +</td></tr><tr><td>containerd</td><td>æœ€æ–°ç‰ˆ</td></tr><tr><td>CRI-Oï¼ˆè¯•éªŒç‰ˆï¼Œæœªç»å……åˆ†æµ‹è¯•ï¼‰</td><td>æœ€æ–°ç‰ˆ</td></tr><tr><td>iSulaï¼ˆè¯•éªŒç‰ˆï¼Œæœªç»å……åˆ†æµ‹è¯•ï¼‰</td><td>æœ€æ–°ç‰ˆ</td></tr></tbody></table><h3 id="ä¾èµ–é¡¹è¦æ±‚"><a href="#ä¾èµ–é¡¹è¦æ±‚" class="headerlink" title="ä¾èµ–é¡¹è¦æ±‚"></a>ä¾èµ–é¡¹è¦æ±‚</h3><p>KubeKey å¯ä»¥å°† Kubernetes å’Œ KubeSphere ä¸€åŒå®‰è£…ã€‚é’ˆå¯¹ä¸åŒçš„ Kubernetes ç‰ˆæœ¬ï¼Œéœ€è¦å®‰è£…çš„ä¾èµ–é¡¹å¯èƒ½æœ‰æ‰€ä¸åŒã€‚æ‚¨å¯ä»¥å‚è€ƒä»¥ä¸‹åˆ—è¡¨ï¼ŒæŸ¥çœ‹æ˜¯å¦éœ€è¦æå‰åœ¨èŠ‚ç‚¹ä¸Šå®‰è£…ç›¸å…³çš„ä¾èµ–é¡¹ã€‚</p><table><thead><tr><th>ä¾èµ–é¡¹</th><th>Kubernetes ç‰ˆæœ¬ â‰¥ 1.18</th><th>Kubernetes ç‰ˆæœ¬ &lt; 1.18</th></tr></thead><tbody><tr><td><code>socat</code></td><td>å¿…é¡»</td><td>å¯é€‰ä½†å»ºè®®</td></tr><tr><td><code>conntrack</code></td><td>å¿…é¡»</td><td>å¯é€‰ä½†å»ºè®®</td></tr><tr><td><code>ebtables</code></td><td>å¯é€‰ä½†å»ºè®®</td><td>å¯é€‰ä½†å»ºè®®</td></tr><tr><td><code>ipset</code></td><td>å¯é€‰ä½†å»ºè®®</td><td>å¯é€‰ä½†å»ºè®®</td></tr></tbody></table><p>KubeKey æ˜¯ç”¨ Go è¯­è¨€å¼€å‘çš„ä¸€æ¬¾å…¨æ–°çš„å®‰è£…å·¥å…·ï¼Œä»£æ›¿äº†ä»¥å‰åŸºäº ansible çš„å®‰è£…ç¨‹åºã€‚KubeKey ä¸ºç”¨æˆ·æä¾›äº†çµæ´»çš„å®‰è£…é€‰æ‹©ï¼Œå¯ä»¥åˆ†åˆ«å®‰è£… KubeSphere å’Œ Kubernetes æˆ–äºŒè€…åŒæ—¶å®‰è£…ï¼Œæ—¢æ–¹ä¾¿åˆé«˜æ•ˆã€‚</p><h3 id="ç½‘ç»œå’Œ-DNS-è¦æ±‚"><a href="#ç½‘ç»œå’Œ-DNS-è¦æ±‚" class="headerlink" title="ç½‘ç»œå’Œ DNS è¦æ±‚"></a>ç½‘ç»œå’Œ DNS è¦æ±‚</h3><ul><li>è¯·ç¡®ä¿ <code>/etc/resolv.conf</code> ä¸­çš„ DNS åœ°å€å¯ç”¨ï¼Œå¦åˆ™ï¼Œå¯èƒ½ä¼šå¯¼è‡´é›†ç¾¤ä¸­çš„ DNS å‡ºç°é—®é¢˜ã€‚</li><li>å¦‚æœæ‚¨çš„ç½‘ç»œé…ç½®ä½¿ç”¨é˜²ç«å¢™è§„åˆ™æˆ–å®‰å…¨ç»„ï¼Œè¯·åŠ¡å¿…ç¡®ä¿åŸºç¡€è®¾æ–½ç»„ä»¶å¯ä»¥é€šè¿‡ç‰¹å®šç«¯å£ç›¸äº’é€šä¿¡ã€‚å»ºè®®æ‚¨å…³é—­é˜²ç«å¢™ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://kubesphere.io/zh/docs/v3.3/installing-on-linux/introduction/port-firewall/">ç«¯å£è¦æ±‚</a>ã€‚</li><li>æ”¯æŒçš„ CNI æ’ä»¶ï¼šCalico å’Œ Flannelã€‚å…¶ä»–æ’ä»¶ä¹Ÿé€‚ç”¨ï¼ˆä¾‹å¦‚ Cilium å’Œ Kube-OVN ç­‰ï¼‰ï¼Œä½†è¯·æ³¨æ„å®ƒä»¬æœªç»å……åˆ†æµ‹è¯•ã€‚</li></ul><p>æç¤º</p><ul><li>å»ºè®®æ‚¨çš„æ“ä½œç³»ç»Ÿå¤„äºå¹²å‡€çŠ¶æ€ï¼ˆä¸å®‰è£…ä»»ä½•å…¶ä»–è½¯ä»¶ï¼‰ï¼Œå¦åˆ™å¯èƒ½ä¼šå‘ç”Ÿå†²çªã€‚</li><li>å¦‚æœæ‚¨æ— æ³•ä» <code>dockerhub.io</code> ä¸‹è½½å®¹å™¨é•œåƒï¼Œå»ºè®®æå‰å‡†å¤‡ä»“åº“çš„é•œåƒåœ°å€ï¼ˆå³åŠ é€Ÿå™¨ï¼‰ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://kubesphere.io/zh/docs/v3.4/faq/installation/configure-booster/">ä¸ºå®‰è£…é…ç½®åŠ é€Ÿå™¨</a>ã€‚</li></ul><p>ç¡¬ä»¶æ¨èé…ç½®</p><table><thead><tr><th>æ“ä½œç³»ç»Ÿ</th><th>æœ€ä½é…ç½®</th></tr></thead><tbody><tr><td><strong>Ubuntu</strong> <em>16.04</em>, <em>18.04</em>, <em>20.04</em>, <em>22.04</em></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr><tr><td><strong>Debian</strong> <em>Buster</em>, <em>Stretch</em></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr><tr><td><strong>CentOS</strong> <em>7.x</em></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr><tr><td><strong>Red Hat Enterprise Linux 7</strong></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr><tr><td><strong>SUSE Linux Enterprise Server 15/openSUSE Leap 15.2</strong></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr></tbody></table></blockquote><p><strong>ä¸€. å®‰è£…ä¾èµ–</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install -y socat conntrack ipset</span><br></pre></td></tr></table></figure><p><strong>äºŒ. æ‰§è¡Œéƒ¨ç½²k8s</strong></p><blockquote><p>æ­¤æ­¥éª¤éƒ¨ç½²å¾ˆå¯èƒ½å› ä¸ºç½‘ç»œåŸå› å¯¼è‡´å¤±è´¥</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è‹¥æ­¤å‘½ä»¤å¤±è´¥åˆ™ä½¿ç”¨ä¸‹æ–¹å…ˆä¸‹è½½è½¯ä»¶åŒ…è§£å‹åæ‰§è¡Œ</span></span><br><span class="line">curl -sfL https://get-kk.kubesphere.io | VERSION=v3.0.13 sh -</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹è½½è½¯ä»¶åŒ…</span></span><br><span class="line">cd /opt &amp;&amp; curl -flO https://kubernetes.pek3b.qingstor.com/kubekey/releases/download/v3.0.13/kubekey-v3.0.13-linux-amd64.tar.gz</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è§£å‹</span></span><br><span class="line">tar -xvf kubekey-v3.0.13-linux-amd64.tar.gz</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æœ¬æ–‡ä½¿ç”¨</span></span><br><span class="line">./kk create cluster --with-kubernetes v1.26.5 --container-manager containerd --with-kubesphere v3.4.1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯é€‰</span></span><br><span class="line">./kk create cluster --with-kubernetes v1.26.5 --container-manager containerd --with-local-storage</span><br></pre></td></tr></table></figure><p>k8sç‰ˆæœ¬å·å‚è€ƒï¼š<a href="https://kubernetes.io/zh-cn/releases/">å‘è¡Œç‰ˆæœ¬ | Kubernetes</a></p><p><strong>ä¸‰. æœ€åï¼šéªŒè¯å®‰è£…ç»“æœ</strong></p><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤ä»¥æ£€æŸ¥å®‰è£…ç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l &#x27;app in (ks-install, ks-installer)&#x27; -o jsonpath=&#x27;&#123;.items[0].metadata.name&#125;&#x27;) -f</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¿¡æ¯ä¼šæ˜¾ç¤º Web æ§åˆ¶å°çš„ IP åœ°å€å’Œç«¯å£å·ï¼Œé»˜è®¤çš„ NodePort æ˜¯ <code>30880</code>ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨é»˜è®¤çš„å¸æˆ·å’Œå¯†ç  (<code>admin/P@88w0rd</code>) é€šè¿‡ <code>&lt;NodeIP&gt;:30880</code> è®¿é—®æ§åˆ¶å°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœåŠ¡å™¨é­å—SYNæ´ªæ°´æ”»å‡»</title>
      <link href="/2024/03/05/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%81%AD%E5%8F%97SYN%E6%B4%AA%E6%B0%B4%E6%94%BB%E5%87%BB/"/>
      <url>/2024/03/05/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%81%AD%E5%8F%97SYN%E6%B4%AA%E6%B0%B4%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>å¼•ç”¨GPT3.5å›ç­”ï¼š</p><p>SYN æ´ªæ°´æ”»å‡»ï¼ˆSYN floodingï¼‰çš„æƒ…å†µã€‚SYN æ´ªæ°´æ”»å‡»æ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œæ”»å‡»æ–¹å¼ï¼Œæ”»å‡»è€…å‘é€å¤§é‡ä¼ªé€ çš„ TCP è¿æ¥è¯·æ±‚ï¼ˆSYN åŒ…ï¼‰ï¼Œå¯¼è‡´æœåŠ¡å™¨èµ„æºè€—å°½æˆ–ç½‘ç»œæ‹¥å¡ã€‚</p><p>å†…æ ¸æ£€æµ‹åˆ°å¯èƒ½çš„ SYN æ´ªæ°´æ”»å‡»åï¼Œä¼šé‡‡å–ä¸€äº›æªæ–½æ¥åº”å¯¹ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯å‘é€ cookiesã€‚TCP SYN cookies æ˜¯ä¸€ç§ç”¨äºé˜²æ­¢ SYN æ´ªæ°´æ”»å‡»çš„æŠ€æœ¯ï¼Œå®ƒå…è®¸æœåŠ¡å™¨åœ¨é­å— SYN æ´ªæ°´æ”»å‡»æ—¶ç»§ç»­å¤„ç†è¿æ¥è¯·æ±‚ï¼Œè€Œæ— éœ€ç»´æŠ¤åŠå¼€è¿æ¥çš„çŠ¶æ€ã€‚</p><p>å®ƒæ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œæ”»å‡»ç±»å‹ï¼Œæ—¨åœ¨ä½¿æœåŠ¡å™¨ä¸å¯ç”¨ã€‚åœ¨è¿™ç§æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å‘é€å¤§é‡ä¼ªé€ çš„ SYN æ•°æ®åŒ…åˆ°æœåŠ¡å™¨ä¸Šï¼Œä½¿æœåŠ¡å™¨æ— æ³•å¤„ç†æ‰€æœ‰è¿™äº›è¿æ¥è¯·æ±‚ï¼Œä»è€Œè€—å°½å…¶èµ„æºã€‚</p></blockquote><h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p><strong>ç°è±¡ï¼š</strong></p><p><code>Mar  5 18:04:28 ybh83aa9pnppbp kernel: TCP: request_sock_TCP: Possible SYN flooding on port 22. Sending cookies.  Check SNMP counters.</code></p><p>è¿™ä¸ªæ˜¯é­å—åˆ°äº†Â SYN æ´ªæ°´æ”»å‡»ï¼ˆSYN floodingï¼‰<br>æ‚¨å¯¹22ç«¯å£åšä¸ªç™½åå•é™åˆ¶å°±è¡Œäº†<br>æˆ–è€…ä½¿ç”¨è¿™ä¸ªå·¥å…·è¿›è¡Œé˜²å¾¡è¿™ç§æ”»å‡»<br><a href="https://github.com/fail2ban/fail2ban">https://github.com/fail2ban/fail2ban</a></p><blockquote><p>å¼•ç”¨GPT3.5å›ç­”ï¼š</p><p>è¿™ä¸ªé”™è¯¯è¡¨æ˜ä½ çš„LinuxæœåŠ¡å™¨å¯èƒ½å—åˆ°äº† SYN æ´ªæ°´æ”»å‡»ï¼Œå®ƒæ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œæ”»å‡»ç±»å‹ï¼Œæ—¨åœ¨ä½¿æœåŠ¡å™¨ä¸å¯ç”¨ã€‚åœ¨è¿™ç§æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å‘é€å¤§é‡ä¼ªé€ çš„ SYN æ•°æ®åŒ…åˆ°æœåŠ¡å™¨ä¸Šï¼Œä½¿æœåŠ¡å™¨æ— æ³•å¤„ç†æ‰€æœ‰è¿™äº›è¿æ¥è¯·æ±‚ï¼Œä»è€Œè€—å°½å…¶èµ„æºã€‚</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š</p><ol><li><p><strong>å¢åŠ  SYN æ”¶é˜Ÿåˆ—çš„å¤§å°</strong>ï¼šé€šè¿‡è°ƒæ•´å†…æ ¸å‚æ•°ï¼Œå¢åŠ æœåŠ¡å™¨ä¸Š SYN æ”¶é˜Ÿåˆ—çš„å¤§å°ï¼Œä½¿å…¶èƒ½å¤Ÿå¤„ç†æ›´å¤šçš„è¿æ¥è¯·æ±‚ã€‚ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>/proc/sys/net/ipv4/tcp_max_syn_backlog</code> å‚æ•°æ¥å®ç°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†é˜Ÿåˆ—å¤§å°å¢åŠ åˆ° 1024ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_max_syn_backlog=1024</span><br></pre></td></tr></table></figure></li><li><p><strong>é…ç½®é˜²ç«å¢™</strong>ï¼šä½¿ç”¨é˜²ç«å¢™æ¥è¿‡æ»¤æ¥è‡ªå¤–éƒ¨ç½‘ç»œçš„æ¶æ„æµé‡ã€‚å¯ä»¥é…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œé™åˆ¶æ¯ä¸ª IP åœ°å€å¯¹ SSH ç«¯å£çš„è¿æ¥é€Ÿç‡ï¼Œæˆ–è€…ä½¿ç”¨å·¥å…·å¦‚ Fail2Ban æ¥è‡ªåŠ¨æ£€æµ‹å¹¶å°é”æ¶æ„ IP åœ°å€ã€‚</p></li><li><p><strong>ä½¿ç”¨ SYN Cookie</strong>ï¼šå¯ç”¨ SYN Cookie å¯ä»¥é˜²æ­¢æœåŠ¡å™¨è¢« SYN æ´ªæ°´æ”»å‡»æ‰€æ‹’ç»æœåŠ¡ã€‚è¿™ä¸ªé€‰é¡¹ä¼šåœ¨æœåŠ¡å™¨ç«¯åœ¨æ”¶åˆ° SYN è¯·æ±‚æ—¶ä¸åˆ†é…èµ„æºï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªåŠ å¯†çš„ Cookie å‘é€ç»™å®¢æˆ·ç«¯ã€‚åªæœ‰å½“å®¢æˆ·ç«¯è¿”å›å¸¦æœ‰æ­£ç¡® Cookie çš„ ACK è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨æ‰ä¼šåˆ†é…èµ„æºå¹¶å®Œæˆ TCP æ¡æ‰‹ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯ç”¨ SYN Cookieï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_syncookies=1</span><br></pre></td></tr></table></figure></li><li><p><strong>æ›´æ–°ç³»ç»Ÿå’Œè½¯ä»¶</strong>ï¼šç¡®ä¿ä½ çš„ç³»ç»Ÿå’Œæ‰€æœ‰å®‰å…¨ç›¸å…³çš„è½¯ä»¶éƒ½æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå› ä¸ºå‚å•†é€šå¸¸ä¼šä¿®å¤å·²çŸ¥çš„æ¼æ´å’Œå®‰å…¨é—®é¢˜ã€‚</p></li><li><p><strong>ç›‘æ§ç½‘ç»œæµé‡</strong>ï¼šå®šæœŸç›‘æ§æœåŠ¡å™¨ä¸Šçš„ç½‘ç»œæµé‡ï¼Œå¹¶åœ¨æ£€æµ‹åˆ°å¼‚å¸¸æµé‡æ—¶åŠæ—¶é‡‡å–è¡ŒåŠ¨ã€‚</p></li><li><p><strong>é™åˆ¶ SSH è®¿é—®</strong>ï¼šå¦‚æœå¯èƒ½ï¼Œå°è¯•é™åˆ¶ SSH è®¿é—®åªå…è®¸æ¥è‡ªç‰¹å®š IP åœ°å€èŒƒå›´çš„è¿æ¥ï¼Œä»¥å‡å°‘æœåŠ¡å™¨å—åˆ°æ”»å‡»çš„é£é™©ã€‚</p></li></ol><p>å¦‚æœä»¥ä¸Šæªæ–½éƒ½ä¸èƒ½è§£å†³é—®é¢˜ï¼Œä½ å¯èƒ½éœ€è¦è¿›ä¸€æ­¥çš„è°ƒæŸ¥å’Œåˆ†æï¼Œå¯èƒ½éœ€è¦ä¸ç½‘ç»œå®‰å…¨ä¸“å®¶åˆä½œï¼Œä»¥æ‰¾å‡ºæ›´æ·±å±‚æ¬¡çš„è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><h4 id="fail2banå®‰è£…åŠä½¿ç”¨å‚è€ƒ"><a href="#fail2banå®‰è£…åŠä½¿ç”¨å‚è€ƒ" class="headerlink" title="fail2banå®‰è£…åŠä½¿ç”¨å‚è€ƒ"></a>fail2banå®‰è£…åŠä½¿ç”¨å‚è€ƒ</h4><p><a href="https://blog.csdn.net/dudu1225/article/details/121242917">Fail2banå®‰è£…åŠé…ç½®</a><br><a href="https://blog.csdn.net/qq_46229380/article/details/109802360">Fail2banå®‰è£…åŠé…ç½®å‹ç¼©åŒ…æ–¹å¼å®‰è£…</a><br><a href="https://www.jianshu.com/p/4fdec5794d08">CentOS7ä¸‹å®‰è£…å’Œä½¿ç”¨Fail2ban - ç®€ä¹¦ (jianshu.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windowsæˆ–Linux SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†</title>
      <link href="/2024/02/19/Windows%E6%88%96Linux%20SSH%E8%BF%9E%E6%8E%A5%E6%88%96%E8%80%85%E6%9C%8D%E5%8A%A1%E5%81%B6%E5%8F%91%E6%80%A7%E6%96%AD%E5%BC%80%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/"/>
      <url>/2024/02/19/Windows%E6%88%96Linux%20SSH%E8%BF%9E%E6%8E%A5%E6%88%96%E8%80%85%E6%9C%8D%E5%8A%A1%E5%81%B6%E5%8F%91%E6%80%A7%E6%96%AD%E5%BC%80%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="Windowsæˆ–Linux-SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†"><a href="#Windowsæˆ–Linux-SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†" class="headerlink" title="Windowsæˆ–Linux SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†"></a>Windowsæˆ–Linux SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†</h3><p><a href="https://support.huaweicloud.com/trouble-ecs/ecs-trouble.pdf">æŸ¥çœ‹PDF</a></p><p><a href>åˆ†äº«</a></p><h4 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h4><p>è¯¥æ–‡æ¡£é€‚ç”¨äºåœ¨SSHè¿æ¥Linuxäº‘æœåŠ¡å™¨æˆ–è€…è®¿é—®è¯¥æœåŠ¡å™¨ä¸Šçš„åº”ç”¨æ—¶å¶ç°è¿æ¥æ–­å¼€ã€‚</p><h4 id="çº¦æŸä¸é™åˆ¶"><a href="#çº¦æŸä¸é™åˆ¶" class="headerlink" title="çº¦æŸä¸é™åˆ¶"></a>çº¦æŸä¸é™åˆ¶</h4><ol><li>ä¿®æ”¹ç³»ç»Ÿå†…æ ¸å‚æ•°å¯èƒ½äº§ç”Ÿå†…æ ¸ä¸ç¨³å®šï¼Œè¯·è¯„ä¼°é£é™©åè¿›è¡Œæ“ä½œã€‚</li><li>ä¸ºäº†ç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œä¿®æ”¹å†…æ ¸å‚æ•°åå»ºè®®åœ¨åˆç†çš„æ—¶é—´é‡å¯ç³»ç»Ÿã€‚</li></ol><h4 id="æ ¹å› åˆ†æ"><a href="#æ ¹å› åˆ†æ" class="headerlink" title="æ ¹å› åˆ†æ"></a>æ ¹å› åˆ†æ</h4><ol><li><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹ç³»ç»Ÿå†…æ ¸æ˜¯å¦å¼€å¯äº†TIME_WAITå¿«é€Ÿå›æ”¶å’Œé‡åˆ©ç”¨ç­–ç•¥</p><p><strong>sysctl -a |grep tcp_tw</strong></p><p>å¦‚<a href="https://support.huaweicloud.com/trouble-ecs/ecs_trouble_0317.html#ecs_trouble_0317__fig258143323916">å›¾1</a>æ‰€ç¤ºï¼Œç¡®è®¤å·²å¼€å¯è¯¥ç­–ç•¥ã€‚</p><p><strong>å›¾1</strong> TIME_WAIT<br><img src="https://support.huaweicloud.com/trouble-ecs/zh-cn_image_0174991741.png"></p></li><li><p>ç”±äºæœåŠ¡ç«¯å¼€å¯äº†TIME_WAITå¿«é€Ÿå›æ”¶å’Œé‡åˆ©ç”¨ç­–ç•¥å¯¼è‡´ï¼Œå³å¯ç”¨äº†net.ipv4.tcp_tw_recycleæˆ–è€…net.ipv4.tcp_tw_reuseã€‚ç³»ç»Ÿé»˜è®¤æ˜¯ä¸å¯ç”¨è¯¥åŠŸèƒ½ã€‚<br><img src="https://res-static.hc-cdn.cn/aem/content/dam/cloudbu-site/archive/china/zh-cn/support/resource/framework/v3/images/support-doc-new-note.svg">è¯´æ˜ï¼šå®¢æˆ·ç«¯é€šå¸¸åœ¨NATç¯å¢ƒä¸‹ï¼Œå¤šå°ç»ˆç«¯ä½¿ç”¨åŒä¸€ä¸ªå…¬ç½‘ipï¼Œæ— æ³•å®ç°æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„ä¸€å¯¹ä¸€è¿æ¥ã€‚å¦‚æœå¼€å¯æ­¤å‚æ•°æœåŠ¡ç«¯ä¼šå›æ”¶å¤„äºTIME_WAITçŠ¶æ€çš„TCPè¿æ¥ï¼Œå¯¼è‡´è¿æ¥æ–­å¼€ã€‚</p></li></ol><h4 id="æ“ä½œæ–¹æ³•ï¼š"><a href="#æ“ä½œæ–¹æ³•ï¼š" class="headerlink" title="æ“ä½œæ–¹æ³•ï¼š"></a>æ“ä½œæ–¹æ³•ï¼š</h4><p>å…³é—­ä¸Šè¿°ä¸¤ä¸ªå†…æ ¸å‚æ•°ï¼Œæ‰“å¼€/etc/sysctl.confï¼Œæ·»åŠ æˆ–è€…ä¿®æ”¹ä¸‹åˆ—ä¸¤è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.tcp_tw_recycle = 0</span><br><span class="line">net.ipv4.tcp_tw_reuse = 0</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä½¿ä¿®æ”¹çš„é…ç½®ç”Ÿæ•ˆã€‚<br><strong># sysctl -p</strong></p><p><img src="https://res-static.hc-cdn.cn/aem/content/dam/cloudbu-site/archive/china/zh-cn/support/resource/framework/v3/images/support-doc-new-note.svg">è¯´æ˜ï¼šå¯åŠ¨ä¸­ä¿®æ”¹å†…æ ¸å‚æ•°å¯èƒ½å­˜åœ¨å†…æ ¸åŠ è½½è¯¥å‚æ•°ä¸ç¨³å®šçš„æƒ…å†µï¼Œå»ºè®®åœ¨åˆé€‚çš„æ—¶é—´è¿›è¡Œé‡å¯ã€‚</p><p>ä¸Šæ–‡å‚è€ƒï¼š<a href="https://support.huaweicloud.com/trouble-ecs/ecs_trouble_0317.html">SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†_å¼¹æ€§äº‘æœåŠ¡å™¨ ECS_æ•…éšœæ’é™¤_SSHè¿æ¥ (huaweicloud.com)</a></p><h4 id="windowsæœåŠ¡å¶å‘æ€§æ–­è¿è§£å†³"><a href="#windowsæœåŠ¡å¶å‘æ€§æ–­è¿è§£å†³" class="headerlink" title="windowsæœåŠ¡å¶å‘æ€§æ–­è¿è§£å†³"></a>windowsæœåŠ¡å¶å‘æ€§æ–­è¿è§£å†³</h4><p>æ­¤æ–‡å‚è€ƒï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/604394878">https://zhuanlan.zhihu.com/p/604394878</a><br><a href="https://blog.csdn.net/boonya/article/details/105700988">https://blog.csdn.net/boonya/article/details/105700988</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzkzNzI1MzE2Mw==&mid=2247484249&idx=1&sn=d522df8c29cdc5c2bb1c466403c0d737&chksm=c293031df5e48a0b7856b9a553dbf1df27015afe09c939f114ad35ad486a30737dd4b258f4e5&scene=21#wechat_redirect">è¿ç»´æ’æŸ¥ç¯‡ | æœåŠ¡å™¨äº§ç”Ÿå¤§é‡çš„TIME_WAITçš„åŸå› ä½ çŸ¥é“å—ï¼Ÿ</a></p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openstackä¸Šä½¿ç”¨windowsé•œåƒåˆ¶ä½œ</title>
      <link href="/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/"/>
      <url>/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€-workstdtion-vsphere-åˆ¶ä½œopenstacké•œåƒ"><a href="#ä¸€-workstdtion-vsphere-åˆ¶ä½œopenstacké•œåƒ" class="headerlink" title="ä¸€.  workstdtion/ vsphere åˆ¶ä½œopenstacké•œåƒ"></a>ä¸€.  <code>workstdtion</code>/ vsphere åˆ¶ä½œ<code>openstack</code>é•œåƒ</h2><h3 id="note"><a href="#note" class="headerlink" title="note:"></a>note:</h3><h4 id="æ¼”ç¤ºwindows-server2016ç‰ˆæœ¬-é…ç½®æ—¶éœ€è¦è‡³å°‘ç»™Cç›˜50Gç©ºé—´"><a href="#æ¼”ç¤ºwindows-server2016ç‰ˆæœ¬-é…ç½®æ—¶éœ€è¦è‡³å°‘ç»™Cç›˜50Gç©ºé—´" class="headerlink" title="æ¼”ç¤ºwindows-server2016ç‰ˆæœ¬ / é…ç½®æ—¶éœ€è¦è‡³å°‘ç»™Cç›˜50Gç©ºé—´"></a>æ¼”ç¤º<code>windows-server2016</code>ç‰ˆæœ¬ / é…ç½®æ—¶éœ€è¦è‡³å°‘ç»™Cç›˜<code>50G</code>ç©ºé—´</h4><h3 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h3><blockquote><p><strong>å› ä¸º windows é»˜è®¤ä¸æ”¯æŒ virtio é©±åŠ¨ï¼Œè€Œé€šè¿‡ openstack ç®¡ç†çš„è™šæ‹Ÿæœºæ˜¯éœ€è¦ virtio é©±åŠ¨çš„ï¼Œæ‰€ä»¥éœ€è¦ç»™ windows å®‰è£…é©±åŠ¨ï¼ŒåŒ…æ‹¬ç¡¬ç›˜é©±åŠ¨å’Œç½‘å¡é©±åŠ¨å¦å¤–è¿˜éœ€è¦å®‰è£…CloudbaseInitSetupå’Œqemu-ga (qemu-guest-agent)</strong> <a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/</a> <strong>ä»¥ä¸Šåœ°å€å¯ä¸‹è½½æœ€æ–°ç¨³å®šç‰ˆçš„ virtio-win-x.x.xxx.iso æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«äº†ç¡¬ç›˜é©±åŠ¨å’Œç½‘å¡é©±åŠ¨ä»¥åŠ</strong></p></blockquote><h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><ul><li><a href="https://www.jianshu.com/p/60caf1c2f10a">https://www.jianshu.com/p/60caf1c2f10a</a>                                                                 ï¼ˆç®€ä¹¦ï¼‰</li><li><a href="https://support.huaweicloud.com/usermanual-ims/zh-cn_topic_0030730602.html">https://support.huaweicloud.com/usermanual-ims/zh-cn_topic_0030730602.html</a>   ï¼ˆåä¸ºäº‘ could-initä½¿ç”¨ï¼‰</li><li><a href="https://cloud.tencent.com/document/product/213/30000">https://cloud.tencent.com/document/product/213/30000</a>                                             (è…¾è®¯äº‘  could-inité…ç½®)</li><li><a href="https://blog.51cto.com/readshlinux/1902888">https://blog.51cto.com/readshlinux/1902888</a>                                                                (51ctoä¿®æ”¹å¯†ç è„šæœ¬)</li></ul><h3 id="å‘½ä»¤å‚è€ƒï¼š"><a href="#å‘½ä»¤å‚è€ƒï¼š" class="headerlink" title="å‘½ä»¤å‚è€ƒï¼š"></a>å‘½ä»¤å‚è€ƒï¼š</h3><ul><li><a href="http://linuxcoming.com/blog/2019/09/03/linux_basic_tools_virt_install_os_variant.html">http://linuxcoming.com/blog/2019/09/03/linux_basic_tools_virt_install_os_variant.html</a></li><li><strong>é©±åŠ¨æ— æ³•å®‰è£…å‚è€ƒï¼š</strong></li><li><a href="https://zhidao.baidu.com/question/2207933972086796788.html">https://zhidao.baidu.com/question/2207933972086796788.html</a></li></ul><h4 id="å®‰è£…å¿…å¤‡è½¯ä»¶"><a href="#å®‰è£…å¿…å¤‡è½¯ä»¶" class="headerlink" title="å®‰è£…å¿…å¤‡è½¯ä»¶"></a>å®‰è£…å¿…å¤‡è½¯ä»¶</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å®‰è£…å¿…å¤‡è½¯ä»¶</span><br><span class="line">yum install -y qemu-kvm libvirt virt-install bridge-utils</span><br></pre></td></tr></table></figure><h3 id="1-ä¸‹è½½Cloudbase-Initå·¥å…·-ä¸‹è½½Cloudbase-Initå·¥å…·å®‰è£…åŒ…ã€‚"><a href="#1-ä¸‹è½½Cloudbase-Initå·¥å…·-ä¸‹è½½Cloudbase-Initå·¥å…·å®‰è£…åŒ…ã€‚" class="headerlink" title="1.ä¸‹è½½Cloudbase-Initå·¥å…·  ä¸‹è½½Cloudbase-Initå·¥å…·å®‰è£…åŒ…ã€‚"></a><code>1</code>.ä¸‹è½½<code>Cloudbase-Init</code>å·¥å…·  ä¸‹è½½<code>Cloudbase-Init</code>å·¥å…·å®‰è£…åŒ…ã€‚</h3><p><strong>æ ¹æ®Windowsæ“ä½œç³»ç»Ÿçš„ä¸åŒä½æ•°ï¼Œæ‚¨éœ€è¦ä¸‹è½½ä¸åŒç‰ˆæœ¬çš„Cloudbase-Initå·¥å…·å®‰è£…åŒ…ã€‚</strong></p><p><strong>Cloudbaseå®˜ç½‘ï¼š</strong></p><p><a href="https://links.jianshu.com/go?to=http://www.cloudbase.it/cloud-init-for-windows-instances/">http://www.cloudbase.it/cloud-init-for-windows-instances/</a>ã€‚</p><p><strong>Cloudbase-Initåˆ†ä¸ºç¨³å®šç‰ˆæœ¬å’ŒBetaç‰ˆæœ¬ä¸¤ç§ã€‚</strong> <strong>ç¨³å®šç‰ˆæœ¬è·å–è·¯å¾„ï¼š</strong></p><p><strong>64ä½ï¼š</strong></p><p><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x64.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x64.msi</a><br><a href="https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_11_x64.msi">https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_11_x64.msi</a><br><a href="https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_9_x64.msi">https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_9_x64.msi</a></p><p><strong>32ä½ï¼š</strong></p><p><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x86.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x86.msi</a></p><p><strong>Betaç‰ˆæœ¬è·å–è·¯å¾„ï¼š</strong></p><p><strong>64ä½ï¼š</strong><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_x64.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_x64.msi</a></p><p><strong>32ä½ï¼š</strong><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_x86.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_x86.msi</a></p><p><strong>virtio-winé©±åŠ¨ä¸‹è½½:</strong></p><p><strong><a href="https://links.jianshu.com/go?to=https://github.com/virtio-win/kvm-guest-drivers-windows">https://github.com/virtio-win/kvm-guest-drivers-windows</a></strong></p><p><strong>æˆ–</strong></p><p><a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/</a></p><h4 id="windows-isoé•œåƒä¸‹è½½åœ°å€ï¼š"><a href="#windows-isoé•œåƒä¸‹è½½åœ°å€ï¼š" class="headerlink" title="windows-isoé•œåƒä¸‹è½½åœ°å€ï¼š"></a>windows-isoé•œåƒä¸‹è½½åœ°å€ï¼š</h4><p><a href="https://msdn.itellyou.cn/">https://msdn.itellyou.cn/</a></p><hr><h4 id="é¦–å…ˆå¼€å¯vcenter-vmwareè™šæ‹ŸåŒ–ï¼š"><a href="#é¦–å…ˆå¼€å¯vcenter-vmwareè™šæ‹ŸåŒ–ï¼š" class="headerlink" title="é¦–å…ˆå¼€å¯vcenter/vmwareè™šæ‹ŸåŒ–ï¼š"></a>é¦–å…ˆå¼€å¯vcenter/vmwareè™šæ‹ŸåŒ–ï¼š</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c7a56db15460c4c9ec3337ba89289ef2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c7a56db15460c4c9ec3337ba89289ef2.png"></p><h5 id="æ³¨æ„äº‹é¡¹ï¼š-ç›®å½•å»ºè®®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•-ä¸èƒ½åœ¨-rootç›®å½•æ‰§è¡Œåˆ›å»ºå·¥ä½œç›®å½•-ä¼šæŠ¥é”™-æƒé™é”™è¯¯"><a href="#æ³¨æ„äº‹é¡¹ï¼š-ç›®å½•å»ºè®®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•-ä¸èƒ½åœ¨-rootç›®å½•æ‰§è¡Œåˆ›å»ºå·¥ä½œç›®å½•-ä¼šæŠ¥é”™-æƒé™é”™è¯¯" class="headerlink" title="æ³¨æ„äº‹é¡¹ï¼š  ç›®å½•å»ºè®®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½• ä¸èƒ½åœ¨/rootç›®å½•æ‰§è¡Œåˆ›å»ºå·¥ä½œç›®å½• ä¼šæŠ¥é”™ æƒé™é”™è¯¯"></a>æ³¨æ„äº‹é¡¹ï¼š  ç›®å½•å»ºè®®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½• ä¸èƒ½åœ¨/rootç›®å½•æ‰§è¡Œåˆ›å»ºå·¥ä½œç›®å½• ä¼šæŠ¥é”™ æƒé™é”™è¯¯</h5><h4 id="ä¸‹è½½å®Œæˆæˆªå›¾ï¼šå…±3è½¯ä»¶"><a href="#ä¸‹è½½å®Œæˆæˆªå›¾ï¼šå…±3è½¯ä»¶" class="headerlink" title="ä¸‹è½½å®Œæˆæˆªå›¾ï¼šå…±3è½¯ä»¶"></a>ä¸‹è½½å®Œæˆæˆªå›¾ï¼šå…±<code>3</code>è½¯ä»¶</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_29087c9168c1688bc91ff2c661a017a6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_29087c9168c1688bc91ff2c661a017a6.png"></p><h3 id="2-ç½‘å¡é…ç½®ï¼ˆç‰©ç†æœº-vmware-vcenteråˆ›å»ºï¼‰"><a href="#2-ç½‘å¡é…ç½®ï¼ˆç‰©ç†æœº-vmware-vcenteråˆ›å»ºï¼‰" class="headerlink" title="2. ç½‘å¡é…ç½®ï¼ˆç‰©ç†æœº/ vmware / vcenteråˆ›å»ºï¼‰"></a><code>2</code>. ç½‘å¡é…ç½®ï¼ˆç‰©ç†æœº<code>/ vmware / vcenter</code>åˆ›å»ºï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å¤‡ä»½ç½‘å¡</span><br><span class="line">cp ifcfg-ens33 ifcfg-br0</span><br></pre></td></tr></table></figure><h5 id="ä¿®æ”¹ifcfg-ens33"><a href="#ä¿®æ”¹ifcfg-ens33" class="headerlink" title="ä¿®æ”¹ifcfg-ens33"></a>ä¿®æ”¹<code>ifcfg-ens33</code></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">2ã€BOOTPROTO=&quot;dhcp&quot; # æ”¹ä¸º BOOTPROTO=&quot;static&quot;</span><br><span class="line">3ã€BRIDGE=br0 Â  Â  Â  # è°ƒæ•´ä¸ºç½‘æ¡¥æ¨¡å¼ å…¶ä»–ä¸åšæ›´æ”¹</span><br><span class="line"># ä¿ç•™å¦‚ä¸‹é…ç½®å…¶ä»–é…ç½®é€šé€šåˆ é™¤</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens33</span><br><span class="line">BRIDGE=br0</span><br><span class="line">UUID=01d75770-3b87-47e3-bbc3-bebaed2293e3</span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=yes</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6372d21fbb18fb333f61a84f13eed939.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6372d21fbb18fb333f61a84f13eed939.png"></p><h4 id="ä¿®æ”¹ifcfg-br0"><a href="#ä¿®æ”¹ifcfg-br0" class="headerlink" title="ä¿®æ”¹ifcfg-br0"></a>ä¿®æ”¹<code>ifcfg-br0</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">1ã€TYPE=&quot;Ethernet&quot; Â  # ä¿®æ”¹ä¸ºTYPE=&quot;Bridge&quot;</span><br><span class="line">2ã€BOOTPROTO=&quot;dhcp&quot; Â # æ”¹ä¸ºÂ BOOTPROTO=&quot;static&quot;</span><br><span class="line">3ã€NAME=&quot;ens33&quot; Â  Â  Â # ä¿®æ”¹ä¸ºÂ NAME=&quot;br0&quot;Â  åŠÂ DEVICE=&quot;ens33&quot;Â  ä¿®æ”¹ä¸ºÂ DEVICE=&quot;br0&quot;</span><br><span class="line">4ã€æ³¨é‡Š UUIDÂ  Â  Â  Â  Â # UUID=&quot;a8d78ec6-485c-4d14-aae1-1908bc6b9a61&quot;</span><br><span class="line">5ã€é…ç½®é™æ€IP</span><br><span class="line">IPADDR=10.0.0.20</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=223.5.5.5</span><br><span class="line"># å®Œæ•´ç½‘å¡é…ç½® -------------------------------</span><br><span class="line">TYPE=Bridge</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=br0</span><br><span class="line"># UUID=01d75770-3b87-47e3-bbc3-bebaed2293e3</span><br><span class="line">DEVICE=br0</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=10.0.0.20</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=223.5.5.5</span><br><span class="line"># é‡å¯ç½‘å¡</span><br><span class="line">systemctl restart network.service</span><br></pre></td></tr></table></figure><h4 id="å¦‚æœé‡‡ç”¨ï¼ˆäº‘ä¸»æœºï¼‰åˆ›å»ºéœ€è¦ä¿®æ”¹ç½‘å¡ï¼ˆ-å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨äº‘ä¸»æœºå¯èƒ½ä¼šå‡ºç°å„ç§æŠ½é£ç°è±¡-ï¼‰é…ç½®-å¦‚ä¸‹é…ç½®-å¦‚ä¸‹ï¼š"><a href="#å¦‚æœé‡‡ç”¨ï¼ˆäº‘ä¸»æœºï¼‰åˆ›å»ºéœ€è¦ä¿®æ”¹ç½‘å¡ï¼ˆ-å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨äº‘ä¸»æœºå¯èƒ½ä¼šå‡ºç°å„ç§æŠ½é£ç°è±¡-ï¼‰é…ç½®-å¦‚ä¸‹é…ç½®-å¦‚ä¸‹ï¼š" class="headerlink" title="å¦‚æœé‡‡ç”¨ï¼ˆäº‘ä¸»æœºï¼‰åˆ›å»ºéœ€è¦ä¿®æ”¹ç½‘å¡ï¼ˆ å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨äº‘ä¸»æœºå¯èƒ½ä¼šå‡ºç°å„ç§æŠ½é£ç°è±¡ ï¼‰é…ç½® å¦‚ä¸‹é…ç½® å¦‚ä¸‹ï¼š"></a>å¦‚æœé‡‡ç”¨ï¼ˆäº‘ä¸»æœºï¼‰åˆ›å»ºéœ€è¦ä¿®æ”¹ç½‘å¡ï¼ˆ å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨äº‘ä¸»æœºå¯èƒ½ä¼šå‡ºç°å„ç§æŠ½é£ç°è±¡ ï¼‰é…ç½® å¦‚ä¸‹é…ç½® å¦‚ä¸‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@images network-scripts]# cat ifcfg-br0</span><br><span class="line"># Created by cloud-init on instance boot automatically, do not edit.</span><br><span class="line">#</span><br><span class="line">BOOTPROTO=static Â  Â  Â # æ”¹</span><br><span class="line">DEVICE=br0 Â  Â  Â  Â  Â  Â # æ”¹</span><br><span class="line">HWADDR=fa:16:3e:90:a8:67</span><br><span class="line">MTU=1500</span><br><span class="line">ONBOOT=yes</span><br><span class="line">STARTMODE=auto</span><br><span class="line">TYPE=Bridge Â  Â  Â  Â  Â  # æ”¹</span><br><span class="line">USERCTL=no Â  Â  Â  Â  Â  Â </span><br><span class="line">IPADDR=10.0.0.76 Â  Â  Â # æ”¹</span><br><span class="line">PREFIX=24 Â  Â  Â  Â  Â  Â  # æ”¹</span><br><span class="line">GATEWAY=10.0.0.1 Â  Â  Â # æ”¹</span><br><span class="line">DNS1=223.5.5.5 Â  Â  Â  Â # æ”¹</span><br><span class="line">#-------------------------------------------------------------------------</span><br><span class="line">[root@images network-scripts]# cat ifcfg-eth0</span><br><span class="line"># Created by cloud-init on instance boot automatically, do not edit.</span><br><span class="line">#</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEVICE=eth0</span><br><span class="line">#HWADDR=fa:16:3e:90:a8:67 Â  Â  # æ”¹</span><br><span class="line">MTU=1500</span><br><span class="line">ONBOOT=yes</span><br><span class="line">STARTMODE=auto</span><br><span class="line">TYPE=Ethernet Â  Â  Â  Â  Â  Â  Â  Â  # æ”¹</span><br><span class="line">USERCTL=no</span><br><span class="line">BRIDGE=br0 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ”¹</span><br></pre></td></tr></table></figure><h4 id="3-æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ–-ï¼ˆæ”¯æŒï¼‰"><a href="#3-æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ–-ï¼ˆæ”¯æŒï¼‰" class="headerlink" title="3. æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ– ï¼ˆæ”¯æŒï¼‰"></a><code>3</code>. æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ– ï¼ˆæ”¯æŒï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ–</span><br><span class="line">grep -E &#x27;(vmx|svm)&#x27; /proc/cpuinfo</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_a37f9f1aa2fc3773a217aed3042a7fdf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_a37f9f1aa2fc3773a217aed3042a7fdf.png"></p><h3 id="4-åˆ›å»ºé•œåƒæ–‡ä»¶åŒ…"><a href="#4-åˆ›å»ºé•œåƒæ–‡ä»¶åŒ…" class="headerlink" title="4. åˆ›å»ºé•œåƒæ–‡ä»¶åŒ…"></a><code>4</code>. åˆ›å»ºé•œåƒæ–‡ä»¶åŒ…</h3><p><strong>æ–‡ä»¶å­˜æ”¾ç›®å½•å¿…é¡»ä¸ºæ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªç›®å½• åˆ‡è®°ä¸èƒ½åœ¨</strong><code>root</code>ç›®å½•å¦åˆ™ä¼šæŠ¥é”™</p><h4 id="å„ä¸ªç›®å½•å­˜æ”¾æ–‡ä»¶æ¦‚è§ˆï¼š"><a href="#å„ä¸ªç›®å½•å­˜æ”¾æ–‡ä»¶æ¦‚è§ˆï¼š" class="headerlink" title="å„ä¸ªç›®å½•å­˜æ”¾æ–‡ä»¶æ¦‚è§ˆï¼š"></a>å„ä¸ªç›®å½•å­˜æ”¾æ–‡ä»¶æ¦‚è§ˆï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># å…³äºæ–‡ä»¶å­˜æ”¾ç›®å½•å¿…é¡»ä¸ºæ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªç›®å½• æ­¤å¤„å¦‚ä¸‹ï¼š</span><br><span class="line">mkdir -p /data/windows/data</span><br><span class="line">mkdir -p /data/windows/CloudbaseInitSetup</span><br><span class="line"></span><br><span class="line"># /data/windowsç›®å½•å­˜æ”¾ï¼š</span><br><span class="line">[root@cpe-172-100-70-251 windows]# ls -lh</span><br><span class="line">æ€»ç”¨é‡ 101M</span><br><span class="line">-rw-r--r--. 1 root root 101M 3æœˆ Â 22 13:52 CloudbaseInitSetup.iso</span><br><span class="line">drwxr-xr-x. 2 root root Â 124 3æœˆ Â 22 13:49 data</span><br><span class="line">-rw-r--r--. 1 root root 193K 3æœˆ Â 22 13:51 windows_server_2016_x64.qcow2</span><br><span class="line"></span><br><span class="line">#/data/windows/data</span><br><span class="line">[root@cpe-172-100-70-251 data]# ll</span><br><span class="line">æ€»ç”¨é‡ 6801916</span><br><span class="line">-rw-r--r--. 1 qemu qemu 6302720000 3æœˆ Â 22 10:43 cn_windows_server_2016_vl_x64_dvd_11636695.iso</span><br><span class="line">-rw-r--r--. 1 qemu qemu Â 534818816 3æœˆ Â 22 09:18 virtio-win-0.1.229.iso</span><br><span class="line"></span><br><span class="line"># /data/windows/CloudbaseInitSetupç›®å½•å­˜æ”¾ </span><br><span class="line">-rw-r--r--. 1 root root 40M 3æœˆ Â 20 2017 CloudbaseInitSetup_0_9_11_x64.msi Â  ï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨ç‰ˆæœ¬ï¼‰</span><br><span class="line">-rw-r--r--. 1 qemu qemu 61M 3æœˆ Â 22 09:18 CloudbaseInitSetup_1_1_4_x64.msi Â  ï¼ˆç¨³å®šç‰ˆï¼‰</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ‰§è¡Œåˆ›å»ºé•œåƒæ–‡ä»¶åŒ…ï¼š"><a href="#æ‰§è¡Œåˆ›å»ºé•œåƒæ–‡ä»¶åŒ…ï¼š" class="headerlink" title="æ‰§è¡Œåˆ›å»ºé•œåƒæ–‡ä»¶åŒ…ï¼š"></a>æ‰§è¡Œåˆ›å»ºé•œåƒæ–‡ä»¶åŒ…ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºé•œåƒæ–‡ä»¶åŒ… ï¼š/data/windows/ ç›®å½•æ‰§è¡Œ</span><br><span class="line">qemu-img create -f qcow2 windows_server_2016_x64.qcow2 50G</span><br><span class="line"># å°†CloudbaseInitSetup_1_1_4_x64.msi é…ç½®æ”¾åœ¨CloudbaseInitSetup.isoä¸­ ï¼ˆæ‰§è¡Œç›®å½•ï¼š/data/windows/ï¼‰</span><br><span class="line">note: æ­¤æ­¥éª¤ä¸æ‰§è¡Œé€šè¿‡vncç»†åŒ–é…ç½®æ—¶å°†æ— æ³•æ‰¾åˆ°win2k16ç›®å½•ä¸‹ç½‘å¡é©±åŠ¨</span><br><span class="line"># åŸºäºç›®å½•CloudbaseInitSetupåˆ¶ä½œisoé•œåƒå‘½åä¸ºCloudbaseInitSetup.iso</span><br><span class="line">mkisofs -o CloudbaseInitSetup.iso CloudbaseInitSetup/ Â  Â  Â  </span><br><span class="line"># æŸ¥çœ‹é•œåƒæ–‡ä»¶åŒ…</span><br><span class="line">qemu-img  info  windows_server_2016_x64.qcow2</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_57235b7e44eacb3280aa8ad3117a09f1.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_57235b7e44eacb3280aa8ad3117a09f1.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6594c419f60291d68cc7c6093c655a86.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6594c419f60291d68cc7c6093c655a86.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_8dc76fd0808704d1163b1a63b168b02d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_8dc76fd0808704d1163b1a63b168b02d.png"></p><h3 id="åˆ›å»ºé•œåƒè™šæ‹Ÿæœº"><a href="#åˆ›å»ºé•œåƒè™šæ‹Ÿæœº" class="headerlink" title="åˆ›å»ºé•œåƒè™šæ‹Ÿæœº"></a>åˆ›å»ºé•œåƒè™šæ‹Ÿæœº</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"># å‚æ•°</span><br><span class="line">--name windows_server_2016_x64Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â #ç³»ç»Ÿå‘½å</span><br><span class="line">--ram 4096 \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  #å†…å­˜å¤§é»˜è®¤M</span><br><span class="line">--vcpu=4 \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â #CPUæ ¸æ•°</span><br><span class="line">--os-type=windows \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â  Â  Â Â Â  Â Â Â  Â #ç³»ç»Ÿç±»å‹</span><br><span class="line">--os-variant=win2k16 \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â #ç³»ç»Ÿç‰ˆæœ¬</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio \Â  #åˆ›å»ºç³»ç»Ÿç›˜é•œåƒÂ  Â æ ¼å¼qcow2Â  æ€»æˆ</span><br><span class="line"> # windows ISOé•œåƒè·¯å¾„ ç±»å‹ä¸ºCDROM sataç›˜</span><br><span class="line">--disk path=/data/cn_windows_server_2016_x64_dvd_9327743.iso,device=cdrom,bus=sata \Â  Â </span><br><span class="line"> # windows é©±åŠ¨ ISOé•œåƒ è·¯å¾„ ç±»å‹</span><br><span class="line">--disk path=/data/virtio-win-0.1.190.iso,device=cdrom,bus=sata \Â  Â           </span><br><span class="line">--bridge=br0,model=virtio \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â      Â  #ç½‘ç»œæ¡¥æ¥æ¨¡å¼</span><br><span class="line">--graphics vnc,listen=0.0.0.0 \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â  Â  #vncÂ </span><br><span class="line">--noautoconsole</span><br><span class="line"># äº‘ä¸»æœºåˆ›å»º</span><br><span class="line"># --(éœ€è¦è‡³å°‘60Gç©ºé—´)--------------------------------------------------------------------------------------------</span><br><span class="line"># æ‰§è¡Œåˆ›å»ºwindowsé•œåƒ (windows2016)</span><br><span class="line"># workstdtion / äº‘ä¸»æœº åˆ›å»ºæ–¹å¼å‡å¯é‡‡ç”¨ ï¼ˆæ–¹å¼1ï¼‰</span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2016_x64 --vcpus=2 --memory 1024 --os-type=windows --os-variant=win2k16 \</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2016_x64_dvd_9718765.iso,device=cdrom,size=5   \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=sata \</span><br><span class="line">--bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off</span><br><span class="line"></span><br><span class="line"># äº‘ä¸»æœº åˆ›å»ºï¼ˆå‚è€ƒï¼‰ï¼ˆæ–¹å¼2ï¼‰</span><br><span class="line">sudo virt-install --connect qemu:///system --name windows_server_2016_x64Â --vcpus=2 --memory 1024 --os-type=windows --os-variant=win2k16 \</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2016_x64_dvd_9718765.iso,device=cdrom,size=5  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=sata \</span><br><span class="line">--network network=default,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br><span class="line"># -----------------------------------------------------------------------------------------------------------</span><br><span class="line"># vsphereåˆ›å»º</span><br><span class="line"># -----------------------------------------------------------------------------------------------------------</span><br><span class="line"># windows2016æ–°å¢é©±åŠ¨ï¼ˆæœ¬æ•™ç¨‹æ‰§è¡Œå‘½ä»¤ï¼‰</span><br><span class="line">å‚æ•°ï¼šbus=stat &gt;&gt; bus=ide</span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2016_x64 --vcpus=2 --memory 2048 --os-type=windows --os-variant=win2k16 \</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2016_vl_x64_dvd_11636695.iso,device=cdrom,size=5,bus=ide  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=ide \</span><br><span class="line">--disk path=./CloudbaseInitSetup.iso,device=cdrom,bus=ide \   # æ–°å¢é©±åŠ¨</span><br><span class="line">--bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off  </span><br><span class="line"></span><br><span class="line"># windows2012r2</span><br><span class="line">qemu-img create -f qcow2 windows_server_2012r2_x64.qcow2 30G</span><br><span class="line"></span><br><span class="line">mkisofs -o CloudbaseInitSetup.iso CloudbaseInitSetup/  </span><br><span class="line"></span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2012r2_x64 --vcpus=2 --memory 4096 --os-type=windows --os-variant=win2k12r2 \</span><br><span class="line">--disk windows_server_2012r2_x64.qcow2,bus=virtio --disk size=30 \</span><br><span class="line">--disk path=./data/cn_windows_server_2012_r2_vl_x64_dvd_2979220.iso,device=cdrom,size=5,bus=ide  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=ide \</span><br><span class="line">--disk path=./CloudbaseInitSetup.iso,device=cdrom,bus=ide --bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off  </span><br><span class="line"></span><br><span class="line"># windows2019</span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2019_x64 --vcpus=2 --memory 2048 --os-type=windows --os-variant=win2k19 \</span><br><span class="line">--disk windows_server_2019_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2019_x64_dvd_4de40f33.iso,device=cdrom,size=5,bus=ide  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=ide \</span><br><span class="line">--disk path=./CloudbaseInitSetup.iso,device=cdrom,bus=ide \</span><br><span class="line">--bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off </span><br><span class="line"></span><br><span class="line"># -----------------------------------------------------------------------------------------------------------</span><br><span class="line"># æŸ¥çœ‹åˆšé€šè¿‡é•œåƒå¯åŠ¨çš„è™šæ‹Ÿæœºè™šæ‹Ÿæœº / æŸ¥çœ‹--os-variantæ”¯æŒçš„ç±»å‹</span><br><span class="line">virsh list --all       # åˆ—å‡ºæ‰€æœ‰è™šæœº</span><br><span class="line">osinfo-query os        # æŸ¥çœ‹æ”¯æŒçš„ç±»å‹</span><br><span class="line">virsh shutdown ubuntu  # æ­£å¸¸å…³é—­è™šæ‹Ÿæœº</span><br><span class="line">virsh undefine name    # åˆ é™¤è™šæœº</span><br><span class="line">virsh start name       # å¯åŠ¨æŒ‡å®šè™šæœº</span><br><span class="line">virsh reboot name      # é‡å¯æŒ‡å®šè™šæœº</span><br><span class="line"></span><br><span class="line">[root@localhost windows]# osinfo-query os</span><br><span class="line"> Short ID             | Name                                               | Version  | ID                            </span><br><span class="line">----------------------+----------------------------------------------------+----------+---</span><br><span class="line"> alpinelinux3.5       | Alpine Linux 3.5                                   | 3.5      |  </span><br><span class="line"> alpinelinux3.6       | Alpine Linux 3.6                                   | 3.6      | </span><br><span class="line"> alpinelinux3.7       | Alpine Linux 3.7                                   | 3.7      | </span><br><span class="line"> alpinelinux3.8       | Alpine Linux 3.8                                   | 3.8      | </span><br><span class="line"> alt.p8               | ALT p8 StarterKits                                 | p8       | </span><br><span class="line"> alt.p9               | ALT p9 StarterKits                                 | p9       |</span><br></pre></td></tr></table></figure><h5 id="å‚è€ƒï¼š-1"><a href="#å‚è€ƒï¼š-1" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h5><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_66220ca6a8e52c12bfe4526cba82dbb3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_66220ca6a8e52c12bfe4526cba82dbb3.png"></p><h4 id="å‡ºç°ä¸‹æ–¹å›æ˜¾åˆ™è¯´æ˜windowsé•œåƒåˆ›å»ºæˆåŠŸï¼š"><a href="#å‡ºç°ä¸‹æ–¹å›æ˜¾åˆ™è¯´æ˜windowsé•œåƒåˆ›å»ºæˆåŠŸï¼š" class="headerlink" title="å‡ºç°ä¸‹æ–¹å›æ˜¾åˆ™è¯´æ˜windowsé•œåƒåˆ›å»ºæˆåŠŸï¼š"></a>å‡ºç°ä¸‹æ–¹å›æ˜¾åˆ™è¯´æ˜windowsé•œåƒåˆ›å»ºæˆåŠŸï¼š</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d46cb89118adb196c752bfeefb854b09.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d46cb89118adb196c752bfeefb854b09.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_49e8c464d4892bd3ca53f4cc2a3e94d9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_49e8c464d4892bd3ca53f4cc2a3e94d9.png"></p><h3 id="5-virt-installå¸¸ç”¨å‘½ä»¤ï¼š"><a href="#5-virt-installå¸¸ç”¨å‘½ä»¤ï¼š" class="headerlink" title="5. virt-installå¸¸ç”¨å‘½ä»¤ï¼š"></a><code>5. virt-install</code>å¸¸ç”¨å‘½ä»¤ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹åˆšé€šè¿‡é•œåƒå¯åŠ¨çš„è™šæ‹Ÿæœºè™šæ‹Ÿæœº / æŸ¥çœ‹--os-variantæ”¯æŒçš„ç±»å‹</span><br><span class="line">virsh list             # åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœº</span><br><span class="line">osinfo-query os        # æŸ¥çœ‹æ”¯æŒçš„ç±»å‹</span><br><span class="line"># virt-installå¸¸ç”¨å‘½ä»¤</span><br><span class="line">virsh list --all       # åˆ—å‡ºæ‰€æœ‰è™šæœº</span><br><span class="line">virsh start  web01     # å¯åŠ¨æŒ‡å®šè™šæœº</span><br><span class="line">virsh reboot web01     # é‡å¯æŒ‡å®šè™šæœºï¼ˆå…³é—­çŠ¶æ€æ— æ³•é‡å¯ï¼‰</span><br><span class="line">virsh console name     # è¿æ¥è™šæ‹Ÿæœº</span><br><span class="line">virsh destroy name     # æ‹”æ‰ç”µæºï¼ˆå¾ˆå°‘ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">virsh undefine web01   # åˆ é™¤è™šæœºæ–‡ä»¶å³åˆ é™¤è™šæ‹Ÿæœºï¼ˆä¸ä¼šåˆ é™¤ç£ç›˜æ–‡ä»¶ï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">virsh domblklist web01             # æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜ä¿¡æ¯</span><br><span class="line">virsh dominfo    web01             # æŸ¥çœ‹è™šæ‹Ÿæœºé…ç½®ä¿¡æ¯</span><br><span class="line">virsh domiflist  web01             # æŸ¥çœ‹è™šæ‹Ÿç½‘å¡ä¿¡æ¯</span><br><span class="line">virsh dumpxml    web01             # ä»¥ xmlæ ¼å¼æŸ¥çœ‹è™šæ‹Ÿæœº</span><br><span class="line">virsh define     file-name         # å¯¼å…¥è™šæ‹Ÿæœº</span><br><span class="line">virsh edit       name              # ç¼–è¾‘è™šæ‹Ÿæœºé…ç½®ï¼ˆä¸€èˆ¬æ˜¯åœ¨åˆšå®šä¹‰å®Œè™šæ‹Ÿæœºä¹‹åï¼‰è‡ªå¸¦è¯­æ³•æ£€æµ‹</span><br><span class="line">virsh domrename  old-name  new-name   # è™šæ‹Ÿæœºé‡å‘½å</span><br><span class="line">virsh vncdisplay web01                # æŸ¥çœ‹vncç«¯å£</span><br><span class="line">virsh autostart  name                 # è™šæ‹Ÿæœºéšæœºé‡å¯</span><br><span class="line">virsh autostart --disable name        # å–æ¶ˆè™šæ‹Ÿæœºéšæœºé‡å¯</span><br><span class="line"></span><br><span class="line"># å›¾å½¢ç•Œé¢ï¼š</span><br><span class="line">é€šè¿‡æ‰§è¡Œåvirt-managerï¼Œå¯åŠ¨libvirtçš„å›¾å½¢ç•Œé¢ï¼Œåœ¨å›¾å½¢ç•Œé¢ä¸‹å¯ä»¥ä¸€æ­¥ä¸€æ­¥çš„åˆ›å»ºè™šæ‹Ÿæœºï¼Œç®¡ç†è™šæ‹Ÿæœºï¼Œè¿˜å¯ä»¥ç›´æ¥æ§åˆ¶è™šæ‹Ÿæœºçš„æ¡Œé¢ã€‚</span><br><span class="line"># å‘½ä»¤è¡Œï¼š</span><br><span class="line">virsh list                              # æ˜¾ç¤ºæœ¬åœ°æ´»åŠ¨è™šæ‹Ÿæœº</span><br><span class="line">virsh list â€“all                         # æ˜¾ç¤ºæœ¬åœ°æ‰€æœ‰çš„è™šæ‹Ÿæœºï¼ˆæ´»åŠ¨çš„+ä¸æ´»åŠ¨çš„ï¼‰</span><br><span class="line">virsh define ubuntu.xml                 # é€šè¿‡é…ç½®æ–‡ä»¶å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆè¿™ä¸ªè™šæ‹Ÿæœºè¿˜ä¸æ˜¯æ´»åŠ¨çš„ï¼‰</span><br><span class="line">virsh start ubuntu                      # å¯åŠ¨åå­—ä¸ºubuntuçš„éæ´»åŠ¨è™šæ‹Ÿæœº</span><br><span class="line">virsh create ubuntu.xml                 # åˆ›å»ºè™šæ‹Ÿæœºï¼ˆåˆ›å»ºåï¼Œè™šæ‹Ÿæœºç«‹å³æ‰§è¡Œï¼Œæˆä¸ºæ´»åŠ¨ä¸»æœºï¼‰</span><br><span class="line">virsh suspend ubuntu                    # æš‚åœè™šæ‹Ÿæœº</span><br><span class="line">virsh resume ubuntu                     # å¯åŠ¨æš‚åœçš„è™šæ‹Ÿæœº</span><br><span class="line">virsh shutdown web01          # æ­£å¸¸å…³é—­è™šæ‹Ÿæœº</span><br><span class="line">virsh destroy ubuntu          # å¼ºåˆ¶æ‹”æ‰ç”µæºå…³é—­è™šæ‹Ÿæœºï¼ˆå¾ˆå°‘ä½¿ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">virsh domname 2                         # æ˜¾ç¤ºidå·ä¸º2çš„è™šæ‹Ÿæœºå                      </span><br><span class="line">virsh domid ubuntu                      # æ˜¾ç¤ºè™šæ‹Ÿæœºidå·                     </span><br><span class="line">virsh domuuid ubuntu                    # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„uuid   </span><br><span class="line">virsh domstate ubuntu                   # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰çŠ¶æ€  </span><br><span class="line">virsh dumpxml ubuntu                    # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰é…ç½®æ–‡ä»¶ï¼ˆå¯èƒ½å’Œå®šä¹‰è™šæ‹Ÿæœºæ—¶çš„é…ç½®ä¸åŒï¼Œå› ä¸ºå½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œéœ€è¦ç»™# è™šæ‹Ÿæœºåˆ†é…idå·ã€uuidã€vncç«¯å£å·ç­‰ç­‰ï¼‰  </span><br><span class="line">virsh setmem ubuntu 512000              # ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®å†…å­˜å¤§å°  </span><br><span class="line">virsh setvcpus ubuntu 4                 # ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®cpuä¸ªæ•°  </span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="é…ç½®snatä½¿é•œåƒå¯ä»¥è®¿é—®internet-åœ¨å®¿ä¸»æœºæ‰§è¡Œ"><a href="#é…ç½®snatä½¿é•œåƒå¯ä»¥è®¿é—®internet-åœ¨å®¿ä¸»æœºæ‰§è¡Œ" class="headerlink" title="é…ç½®snatä½¿é•œåƒå¯ä»¥è®¿é—®internet( åœ¨å®¿ä¸»æœºæ‰§è¡Œ )"></a>é…ç½®<code>snat</code>ä½¿é•œåƒå¯ä»¥è®¿é—®<code>internet</code>( åœ¨å®¿ä¸»æœºæ‰§è¡Œ )</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># å¼€å¯</span><br><span class="line">--å‚æ•°ï¼š</span><br><span class="line">-s 172.100.70.241           # é•œåƒip  ï¼ˆæˆ– å…¶ä»–è™šæ‹Ÿæœºï¼‰</span><br><span class="line">--to-source 172.100.70.251  # å®¿ä¸»æœºipï¼ˆæˆ– æœ¬è™šæ‹Ÿæœºï¼‰</span><br><span class="line">sysctl net.ipv4.ip_forward=1</span><br><span class="line">sysctl -p</span><br><span class="line">iptables -t nat -A POSTROUTING -s 172.100.70.241  -j SNAT --to-source 172.100.70.251</span><br></pre></td></tr></table></figure><h2 id="äºŒ-vncç»†åŒ–é…ç½®-qemu-img-è§ä¸‹ç« "><a href="#äºŒ-vncç»†åŒ–é…ç½®-qemu-img-è§ä¸‹ç« " class="headerlink" title="äºŒ. vncç»†åŒ–é…ç½® qemu-img ( è§ä¸‹ç«  )"></a>äºŒ. <code>vnc</code>ç»†åŒ–é…ç½® <code>qemu-img</code> ( è§ä¸‹ç«  )</h2><h4 id="qemu-imgå‘½ä»¤å‚è€ƒï¼š"><a href="#qemu-imgå‘½ä»¤å‚è€ƒï¼š" class="headerlink" title="qemu-imgå‘½ä»¤å‚è€ƒï¼š"></a><code>qemu-img</code>å‘½ä»¤å‚è€ƒï¼š</h4><p><a href="https://zhuanlan.zhihu.com/p/623104229">https://zhuanlan.zhihu.com/p/623104229</a></p><p><a href="https://support.huaweicloud.com/bestpractice-ims/ims_bp_0030.html">https://support.huaweicloud.com/bestpractice-ims/ims_bp_0030.html</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_e552b52db5a6700f7e86be4d1ee01215.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_e552b52db5a6700f7e86be4d1ee01215.png"></p><h4 id="11-é…ç½®å®Œæˆåå¤„ç†é•œåƒï¼ˆå‹ç¼©é•œåƒï¼‰"><a href="#11-é…ç½®å®Œæˆåå¤„ç†é•œåƒï¼ˆå‹ç¼©é•œåƒï¼‰" class="headerlink" title="11.é…ç½®å®Œæˆåå¤„ç†é•œåƒï¼ˆå‹ç¼©é•œåƒï¼‰"></a><code>11</code>.é…ç½®å®Œæˆåå¤„ç†é•œåƒï¼ˆå‹ç¼©é•œåƒï¼‰</h4><h3 id="å‚è€ƒï¼š-2"><a href="#å‚è€ƒï¼š-2" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># å‚æ•°</span><br><span class="line">-cï¼Œè¡¨ç¤ºå¿…é¡»å‹ç¼©ç›®æ ‡é•œåƒï¼ˆä»…é™qcowæ ¼å¼ï¼‰ã€‚</span><br><span class="line">-fï¼Œç¬¬ä¸€ç§é•œåƒæ ¼å¼ã€‚</span><br><span class="line">-o, optionsï¼šé€‰é¡¹ï¼Œæ˜¯ä»¥é€—å·åˆ†éš”çš„æ ¼å¼ç‰¹å®šé€‰é¡¹åˆ—è¡¨ï¼Œæ ¼å¼ä¸ºname=valueæ ¼å¼ã€‚ä½¿ç”¨â€œ-oï¼Ÿâ€æœ‰å…³ä½¿ç”¨çš„æ ¼å¼æ”¯æŒçš„é€‰é¡¹çš„æ¦‚è¿°ï¼Œæˆ–å‚é˜…ä¸‹é¢çš„æ ¼å¼è¯´æ˜äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="line">++++++++++++++++++++++++++++++++++</span><br><span class="line">#--sparse=alwaysç¨€ç–æ‹·è´ï¼Œå¿½ç•¥å…¨0æ•°æ®</span><br><span class="line">cp --sparse=always ws2012r2.qcow2 ws2012r2-new.qcow2 #--sparse=alwaysç¨€ç–æ‹·è´ï¼Œå¿½ç•¥å…¨0æ•°æ®</span><br><span class="line"># rawå’Œqcow2éœ€è¦è½¬æ¢ï¼Œè¿™é‡ŒåŸæœ¬ç”¨çš„qcow2ï¼Œæ‰€ä»¥æœªè½¬æ¢ã€‚</span><br><span class="line"># æ¡ˆä¾‹ï¼š</span><br><span class="line">qemu-img convert -c -f raw -O qcow2 centos7-new.raw centos7-new.qcow2</span><br><span class="line">qemu-img convert -c -O qcow2 centos7-new.qcow2 centos7-mini.qcow2</span><br><span class="line"># å®é™…æ“ä½œ</span><br><span class="line">qemu-img convert -c -O qcow2 windows_server_2016_x64_new.qcow2 windows_server_2016_x64_min.qcow2</span><br><span class="line">++++++++++++++++++++++++++++++++++</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_ea53daa63d24ff564cde1f936d3d4e0f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_ea53daa63d24ff564cde1f936d3d4e0f.png"></p><h4 id="å®é™…æ“ä½œ"><a href="#å®é™…æ“ä½œ" class="headerlink" title="å®é™…æ“ä½œ:"></a>å®é™…æ“ä½œ:</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># rawå’Œqcow2éœ€è¦è½¬æ¢ï¼Œè¿™é‡ŒåŸæœ¬ç”¨çš„qcow2ï¼Œæ‰€ä»¥æœªè½¬æ¢ã€‚</span><br><span class="line"># æ¡ˆä¾‹ï¼š</span><br><span class="line">qemu-img convert -c -f raw -O qcow2 centos7-new.raw centos7-new.qcow2</span><br><span class="line">qemu-img convert -c -f qcow2 -o  raw centos7-new.qcow2 centos7-mini.raw</span><br><span class="line"># å®é™…æ“ä½œ</span><br><span class="line">qemu-img convert -c -f raw -O qcow2 windows_server_2016_x64_new.raw windows_server_2016_x64_min.qcow2</span><br></pre></td></tr></table></figure><h4 id="ä¸Šä¼ åˆ°openstackâ€”skyline"><a href="#ä¸Šä¼ åˆ°openstackâ€”skyline" class="headerlink" title="ä¸Šä¼ åˆ°openstackâ€”skyline:"></a>ä¸Šä¼ åˆ°<code>openstackâ€”skyline</code>:</h4><p><strong>å‚æ•°ï¼š</strong><code>--property os_distro=windows --property os_version=2012 --property os_admin_user=Administrator</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># qcm2æ ¼å¼</span><br><span class="line">openstack image create --disk-format qcow2 --public --property hw_qemu_guest_agent=yes --property os_distro=windows --property os_version=2012 --property os_admin_user=Administrator --file  windows_server_2016_x64.qcow2 windows_server_2016_x64.qcow2</span><br><span class="line"># rawæ ¼å¼</span><br><span class="line">openstack image create --disk-format raw --public --property hw_qemu_guest_agent=yes --property os_distro=windows --property os_version=2012 --property os_admin_user=Administrator --file windows_server_2019_x64.raw windows_server_2019_x64.raw </span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºäº‘ä¸»æœºï¼š"><a href="#ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºäº‘ä¸»æœºï¼š" class="headerlink" title="ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºäº‘ä¸»æœºï¼š"></a>ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºäº‘ä¸»æœºï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æ­¤å‘½ä»¤å¿…é¡»è¦å…ˆå°†é•œåƒä¸Šä¼ åˆ°openstack</span><br><span class="line">openstack server create --config-drive true --image windows2016min.qcow2 --flavor 9 --password ******20! --network demo-net windows2016_test</span><br></pre></td></tr></table></figure><h4 id="æ³¨ï¼š-æ­¤æ—¶é…ç½®å®Œæˆ-é›†æˆå¯ä¿®æ”¹å¯†ç "><a href="#æ³¨ï¼š-æ­¤æ—¶é…ç½®å®Œæˆ-é›†æˆå¯ä¿®æ”¹å¯†ç " class="headerlink" title="æ³¨ï¼š æ­¤æ—¶é…ç½®å®Œæˆ  é›†æˆå¯ä¿®æ”¹å¯†ç "></a>æ³¨ï¼š æ­¤æ—¶é…ç½®å®Œæˆ  é›†æˆå¯ä¿®æ”¹å¯†ç </h4><h4 id="æ•ˆæœï¼š"><a href="#æ•ˆæœï¼š" class="headerlink" title="æ•ˆæœï¼š"></a>æ•ˆæœï¼š</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d0e78dd049d08305a4192234429c341d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d0e78dd049d08305a4192234429c341d.png"></p><h4 id="æ‰©å±•ï¼š-æ—§é¢æ¿-windows-é‡ç½®å¯†ç "><a href="#æ‰©å±•ï¼š-æ—§é¢æ¿-windows-é‡ç½®å¯†ç " class="headerlink" title="æ‰©å±•ï¼š æ—§é¢æ¿ windows é‡ç½®å¯†ç :"></a>æ‰©å±•ï¼š æ—§é¢æ¿ windows é‡ç½®å¯†ç :</h4><p>æ›´æ–°äº‘ä¸»æœºå…ƒæ•°æ®ï¼Œæ·»åŠ <code>change_passwd=True</code>, è½¯é‡å¯äº‘ä¸»æœºã€‚é‡å¯å®Œä¹‹åï¼Œè™šæœºå¯†ç ä¸º <code>admin_pass</code> æŒ‡å®šçš„å¯†ç ã€‚å¯†ç é‡ç½®åå†å°†å…ƒæ•°æ® <code>change_passwd</code> åˆ æ‰ï¼Œæˆ–è€…æ”¹ä¸ºå…¶ä»–å€¼</p><p><strong>æ·»åŠ å &gt;&gt; è½¯é‡å¯   ||  è½¯é‡å¯ä¹‹å &gt;&gt; åˆ é™¤change_passwd=True    æ­¤æ—¶å¯†ç å˜ä¸ºåˆ›å»ºäº‘ä¸»æœºæ—¶è®¾ç½®çš„å¯†ç å³</strong><code>****023!</code>ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_65022b246096b0295461a22397c72313.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_65022b246096b0295461a22397c72313.png"></p><p><strong>æ•™ç¨‹ç»“æŸã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èµåŠ©å¢™</title>
      <link href="/2024/02/01/%E8%B5%9E%E5%8A%A9%E5%A2%99/"/>
      <url>/2024/02/01/%E8%B5%9E%E5%8A%A9%E5%A2%99/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>ç½‘ç«™å»ºè®¾ä¸ç»´æŠ¤å®å±ä¸æ˜“ï¼Œå¦‚æœæˆ‘çš„æ–‡ç« å¸®åŠ©åˆ°äº†æ‚¨ï¼Œæˆ–è€…æ‚¨æƒ³æ”¯æŒæˆ‘çš„ç½‘ç«™ï¼Œå¯ä»¥æ‰«æä¸‹æ–¹äºŒç»´ç è¿›è¡ŒèµåŠ©ï¼ˆèµåŠ©æ—¶è¯·å¤‡æ³¨è‡ªå·±çš„ åŒ–å/æ˜µç§° ï¼Œæ‰“èµåå°†åœ¨æ­¤é¡µé¢å±•ç¤ºï¼‰ï¼Œéå¸¸æ„Ÿè°¢æ‚¨çš„æ”¯æŒ~ ğŸŒ¹</p></blockquote><h2 id="èµåŠ©å¢™ğŸŒ¹"><a href="#èµåŠ©å¢™ğŸŒ¹" class="headerlink" title="èµåŠ©å¢™ğŸŒ¹"></a>èµåŠ©å¢™ğŸŒ¹</h2><p>æ‰“èµæ–¹å¼  å¾®ä¿¡  æ”¯ä»˜å®ğŸŒ™</p><div class="gallery">    <div class="fj-gallery  data" data-rowheight="220" data-limit="10">    <span class="gallery-data">[{"url":"https://wn-apple-teawine.fun/img/wechatpayqr.webp","alt":"å¾®ä¿¡"},{"url":"https://wn-apple-teawine.fun/img/alipayqr.webp","alt":"æ”¯ä»˜å®"}]</span>    </div>    <button class="gallery-load-more"><span>Load More</span><i class="fa-solid fa-arrow-down"></i></button>    </div><table><thead><tr><th>ZzNnWn.</th><th>æ™’åœ¨æ·±æµ·é‡Œ.</th><th>ç²˜äººçš„é¸­å˜´å…½</th></tr></thead><tbody><tr><td>ï¿¥100</td><td>ï¿¥50</td><td>ï¿¥1000</td></tr><tr><td></td><td></td><td></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®€å†</title>
      <link href="/2024/02/01/%E7%AE%80%E5%8E%86/"/>
      <url>/2024/02/01/%E7%AE%80%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ç®€å†"><a href="#ç®€å†" class="headerlink" title="ç®€å†"></a>ç®€å†</h2><h4 id="åŸºæœ¬ä¿¡æ¯-æ•™è‚²èƒŒæ™¯-æ±‚èŒæ„å‘"><a href="#åŸºæœ¬ä¿¡æ¯-æ•™è‚²èƒŒæ™¯-æ±‚èŒæ„å‘" class="headerlink" title="åŸºæœ¬ä¿¡æ¯ æ•™è‚²èƒŒæ™¯ æ±‚èŒæ„å‘"></a><strong>åŸºæœ¬ä¿¡æ¯</strong> <strong>æ•™è‚²èƒŒæ™¯</strong> <strong>æ±‚èŒæ„å‘</strong></h4><p>å§“åï¼š<br>é‚®ç®±ï¼š<a href="mailto:&#56;&#x37;&#56;&#x38;&#57;&#49;&#54;&#49;&#49;&#64;&#113;&#x71;&#46;&#99;&#111;&#x6d;">&#56;&#x37;&#56;&#x38;&#57;&#49;&#54;&#49;&#49;&#64;&#113;&#x71;&#46;&#99;&#111;&#x6d;</a><br>è¯ä¹¦ï¼šé˜¿é‡Œäº‘ACP<br>æœŸæœ›è–ªèµ„ï¼š15k<br>å²—ä½ï¼šäº‘è®¡ç®—å·¥ç¨‹å¸ˆ</p><h4 id="ä¸“ä¸šæŠ€èƒ½æ¦‚è§ˆ"><a href="#ä¸“ä¸šæŠ€èƒ½æ¦‚è§ˆ" class="headerlink" title="ä¸“ä¸šæŠ€èƒ½æ¦‚è§ˆ"></a><strong>ä¸“ä¸šæŠ€èƒ½æ¦‚è§ˆ</strong></h4><p>Â· ç²¾é€šå„ç±»<strong>linux</strong>ç³»ç»Ÿå„é¡¹é…ç½®æ€§èƒ½è°ƒä¼˜å®‰å…¨ä¼˜åŒ–<strong>shell</strong>è„šæœ¬æ“ä½œç³»ç»ŸåŒ…æ‹¬ä½†ä¸é™äº<strong>ï¼ˆubuntu centos debain åä¸ºæ¬§æ‹‰ é˜¿é‡Œé¾™èœ¥</strong>ç­‰ï¼‰<br>Â· ç²¾é€šäº‘è®¡ç®—<strong>iaas paas</strong>å±‚<br>Â· ç²¾é€šcephåˆ†å¸ƒå¼å­˜å‚¨,<br>Â· ç²¾é€šopenstacké›†ç¾¤ nova cinder neutoen glanceçš„è¿ç»´<br>Â· ç²¾é€šgrafanaå¼€æºæ—¥å¿—ç›‘æ§<strong>loki</strong><br>Â· ç²¾é€šäº‘è¿ç§»æŠ€æœ¯<strong>DTS SMC OSSè¿ç§»ï¼ˆé˜¿é‡Œäº‘ï¼‰</strong><br>Â· ç²¾é€šå†·è¿ç§»æŠ€æœ¯<strong>V2V Qemu-img dd  disk2vhd</strong>ç­‰ ï¼ˆä½¿ç”¨äºä»»ä½•é€‚é…çš„å¹³å°ï¼‰<br>Â· ç²¾é€š<strong>ansible</strong>è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·<br>Â· ç²¾é€š<strong>docker docker-compose Dockerfileã€‚</strong><br>Â· ç²¾é€šå„ç§å¼€æºæ—¶åºæ•°æ®åº“<strong>influxdb promethus-tsdb</strong>ç­‰<br>Â· ç²¾é€šå„ç§ç›‘æ§ç³»ç»Ÿ<strong>prometheus zabbix telegraf nightingale cacti smartping uptime-Kuma</strong>ç­‰<br>Â· ç²¾é€šå„ç§å…³ç³»æ•°æ®åº“<strong>mysql postgreSQL mariadb</strong>æŒæ¡<strong>Mysql</strong>ä»¥åŠ<strong>mariadb</strong>æ•°æ®åº“å®‰å…¨ç­–ç•¥å¦‚ï¼ˆå¯†ç å®‰å…¨ ç™»å½•å®‰å…¨ å®¡è®¡ç­‰ï¼‰<br>Â· ç²¾é€š<strong>keepalived+nginx</strong>é«˜å¯ç”¨.æŒæ¡<strong>mysql</strong>ä¸»ä»å¤åˆ¶ <strong>redis</strong>é›†ç¾¤ã€‚<br>Â· ç²¾é€šéƒ¨ç½²<strong>openstack</strong>äº‘å¹³å° <strong>ç®¡ç†OpenStackäº‘å¹³å°ï¼ŒåŒ…æ‹¬è™šæ‹Ÿæœºå®ä¾‹ã€ç½‘ç»œå’Œå­˜å‚¨èµ„æºçš„é…ç½®ã€‚</strong><br>Â· ç²¾é€š<strong>Cephåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œè´Ÿè´£Cephé›†ç¾¤çš„éƒ¨ç½²ã€ç›‘æ§å’Œæ€§èƒ½è°ƒä¼˜ã€‚</strong><br>Â· ç²¾é€š<strong>tcp udp http https snmp ftp vrrp</strong>ç­‰å„ç§åè®®<br>Â· ç²¾é€š<strong>nginx</strong> è´Ÿè½½å‡è¡¡ï¼ŒåŠ¨é™åˆ†ç¦»ï¼Œåå‘ä»£ç† ç†Ÿç»ƒæŒæ¡å¼€æº<strong>openvpn l2tp frp</strong>æŠ€æœ¯<br>Â· ç²¾é€š<strong>nas</strong>å­˜å‚¨å¤šå‰¯æœ¬<strong>cephfs</strong>ï¼ˆå•å‰¯æœ¬<strong>NFS iscsi</strong>ï¼‰ å¯¹è±¡å­˜å‚¨ è´Ÿè½½å‡è¡¡ <strong>nat</strong>ç½‘å…³** rds** ç­‰<br>Â· ç²¾é€šä½¿ç”¨<strong>kubeadm</strong>éƒ¨ç½²<strong>k8s</strong>ä»¥åŠå®ç°ä¸<strong>ceph</strong>é›†æˆï¼ˆStorageClassï¼‰<br>Â· ç†Ÿç»ƒæŒæ¡<strong>python</strong>è„šæœ¬ï¼ˆç½‘ç»œçˆ¬è™«æ–¹å‘ï¼‰ã€‚</p><h4 id="å·¥ä½œç»éªŒ1"><a href="#å·¥ä½œç»éªŒ1" class="headerlink" title="å·¥ä½œç»éªŒ1"></a><strong>å·¥ä½œç»éªŒ1</strong></h4><p>å…¬å¸ç»è¥èŒƒå›´ï¼šä¸»è¦ç»è¥ç‰©è”ç½‘äº§å“ è½¯ä»¶å¼€å‘ç­‰</p><h4 id="é¡¹ç›®ç»éªŒï¼š"><a href="#é¡¹ç›®ç»éªŒï¼š" class="headerlink" title="é¡¹ç›®ç»éªŒï¼š"></a><strong>é¡¹ç›®ç»éªŒï¼š</strong></h4><p>2020.11â€”â€”2021.04<br>Â· ç»´æŠ¤è®¾è®¡åŠéƒ¨ç½²è‹å·å¸‚å›½å®¶ç”µç½‘å„å¥—ç³»ç»Ÿå¦‚éš§é“å­ç³»ç»Ÿ ç²¾ç›ŠåŒ–ç®¡æ§å¹³å°ç­‰ã€‚<br>2021.04â€”â€”2021.05<br>Â· éƒ¨ç½²ç»´æŠ¤ä¼˜åŒ–å…¬å¸è¾¹ç¼˜è®¡ç®—ç®±äº§å“ï¼Œç¼–å†™<strong>dockerfile</strong>åˆ¶ä½œä¸€é”®å¯åŠ¨ç§æœ‰åŒ–é•œåƒ å¹¶å®åœ°æµ‹è¯•å…¶åŠŸèƒ½ã€‚<br>2021.05â€”â€”2021.07<br>Â· è®¾è®¡éƒ¨ç½²å…¬å¸<strong>vmware vcenter esxi</strong> ç§æœ‰äº‘å¹³å°<br>Â· æ­å»º<strong>openvpn</strong>å®ç°ä¼ä¸šå‘˜å·¥åœ¨å®¶è®¿é—®å…¬å¸å†…ç½‘<br>Â· å¯¹éœ€è¦æš´éœ²å¤–ç½‘æ²¡æœ‰<strong>å¤–ç½‘IP</strong>çš„<strong>web</strong>æœåŠ¡åšå†…ç½‘ç©¿é€ã€‚<br>Â· å¯¹<strong>vcenter</strong>å…¶ä¸­ä¸€å°è™šæ‹Ÿæœºé…ç½®å¤–ç½‘IPå¯¹å¤–æœåŠ¡<br>2021.07â€”â€”2022.02<br>Â· æ—¥å¸¸ç»´æŠ¤<strong>mysql</strong>æ•°æ®åº“ å…¬å¸å„å¥—ç³»ç»Ÿå¦‚ç¦…é“ ç²¾ç›ŠåŒ–ç®¡æ§å¹³å° <strong>nacos</strong>  è™šæ‹ŸåŒ–å¹³å°<strong>vcenter</strong>ç­‰<br>Â· æ£€æŸ¥ç³»ç»Ÿè¿è¡Œæƒ…å†µæ’é”™ç­‰<br>Â· ç¼–å†™è¿ç»´æŠ€æœ¯æ–‡æ¡£<br>Â· åˆ©ç”¨<strong>ansible</strong>ç»™å¤šå°æœåŠ¡å™¨é…ç½®ç¯å¢ƒï¼Œç¼–å†™å‰§æœ¬éƒ¨ç½²ç¨‹åºç¯å¢ƒç­‰ã€‚</p><h4 id="å·¥ä½œç»éªŒ2"><a href="#å·¥ä½œç»éªŒ2" class="headerlink" title="å·¥ä½œç»éªŒ2"></a><strong>å·¥ä½œç»éªŒ2</strong></h4><p><strong>å…¬å¸ä»‹ç»ï¼š</strong></p><p>åä¸­åœ°åŒºæœ€å¤§çš„åˆ†å¸ƒå¼äº‘æœåŠ¡å•† é˜¿é‡Œäº‘åä¸­åœ°åŒºæœ€å¤§ä»£ç†å•† å…¬å¸æœ‰è‡ªå·±çš„äº‘è®¡ç®—å¹³å°MSC-Stackå¯¹å¤–å¸®åŠ©ä¸Šåƒå®¶å®¢æˆ·ä¸Šäº‘ å¯¹ä¸Šåƒå®¶ä¼ä¸šæä¾›æœåŠ¡ å®¢æˆ·åŒ…æ‹¬å°ç±³ åä¸º è‹±ä¼Ÿè¾¾ æ–—é±¼ å­—èŠ‚è·³åŠ¨ç­‰<br><strong>ä¸»è¦äº§å“ï¼š</strong></p><p><strong>MSC-Stackï¼š</strong>åŸºäºopenstackä¸cephåˆ†å¸ƒå¼å­˜å‚¨å¼€å‘çš„ä¸€å¥—äº‘è®¡ç®—å¹³å°ã€‚<br>K8s å ¡å’æœº ä¸»æœºå…¥ä¾µ äº‘ä¸»æœºè´Ÿè½½å‡è¡¡å™¨ natç½‘å…³ç­‰åŠŸèƒ½ ç›®å‰æ‹¥æœ‰æ­¦æ±‰ ç¦å· åŒ—äº¬ æˆéƒ½ å››èŠ‚ç‚¹ã€‚<br>åŸç”ŸOpenStackéƒ¨åˆ†ï¼šä¸€å¥—openstack nç‰ˆå¤–ç½‘ç¯å¢ƒ ä¸€å¥—openstack zedç‰ˆå†…ç½‘ç¯å¢ƒã€‚</p><h4 id="é¡¹ç›®ç»éªŒ"><a href="#é¡¹ç›®ç»éªŒ" class="headerlink" title="é¡¹ç›®ç»éªŒ"></a><strong>é¡¹ç›®ç»éªŒ</strong></h4><p><strong>åŸç”ŸOpenStackï¼ŒMCS-Stackä¸cephäº‘è®¡ç®—éƒ¨åˆ†</strong><br>2022.05â€”â€”2022.06<br>Â· éƒ¨ç½²å…¬å¸<strong>openstac-zed</strong>ç‰ˆæœ¬ç³»ç»Ÿ åç«¯å­˜å‚¨é‡‡ç”¨<strong>ceph</strong>åˆ†å¸ƒå¼å­˜å‚¨ ç¼–å†™<strong>shell</strong>è„šæœ¬éƒ¨ç½²ä¹å·äº‘å¼€æºå‰ç«¯skylineï¼ˆopenstack-uiï¼‰<strong>é˜¶æ®µï¼š<br><strong>è°ƒç ”:</strong>  openstackä¸cephç‰ˆæœ¬é€‚é… æµ‹è¯•æ­é…æƒ…å†µã€‚<br><strong>åˆ¶ä½œé•œåƒï¼š</strong>åˆ¶ä½œ</strong>openstack<strong>æ‰€éœ€é•œåƒ å…ˆæ­å»º</strong>all-in-one<strong>ç¯å¢ƒ</strong>openstack<strong>ä¸</strong>ceph<strong>å†åˆ¶ä½œå…¶é•œåƒ å¹¶æ¨é€åˆ°å…¬å¸å†…ç½‘harboré•œåƒå¹³å°ã€‚<br><strong>æ­å»ºï¼š</strong>æœ€åæ­å»ºé›†ç¾¤ç‰ˆ</strong>openstack**<br>Â· éƒ¨ç½²å®Œæˆå mariadb passwdç­‰æ•°æ®å¤‡ä»½<br>Â· äº‘ä¸»æœºå®‰è£…dockeræ— æ³•è®¿é—®å¤–ç½‘è®¾ç½®MTUè§£å†³<br>Â· <strong>cephadm</strong>çš„æ–¹å¼éƒ¨ç½²åç«¯<strong>ceph</strong>é›†ç¾¤ã€‚**<br>2023.05â€”2023.06<br>Â· è®¡ç®—èŠ‚ç‚¹æ•…éšœæ—¶æ¢å¤äº‘ä¸»æœº<br>Â· åˆ é™¤äº‘ä¸»æœºå¡æ­»ï¼Œå¡åœ¨deletingçŠ¶æ€<br>2022.07â€”2022.08<br>Â· äº‘ç›˜æ‰‹åŠ¨æ‰©å®¹<br>Â· cinder äº‘ç›˜æ— æ³•åˆ é™¤<br>Â· windowsäº‘ä¸»æœºè®¾ç½®å¯†ç æ°¸ä¸è¿‡æœŸ<br>Â· åˆ¶ä½œopenstackäº‘ä¸Šä½¿ç”¨çš„é•œåƒï¼ˆlinux(ubuntu16.04-22.04) centos(7.4-8.3) rocky9.2  debain11 windows server 2012r2 â€”2019ï¼‰<br>2023.08â€”2023.08<br>Â· openstacké›†ç¾¤ç¼©å‡è®¡ç®—èŠ‚ç‚¹ã€‚</p><p><strong>äº‘è®¡ç®—-äº‘è¿ç§»éƒ¨åˆ†</strong><br>2023.06-2023.07<br>Â· ä½¿ç”¨<strong>v2v</strong>ï¼Œå°†å®¢æˆ·<strong>vmware</strong>æ•°å°è™šæ‹Ÿæœºè¿ç§»åˆ°<strong>MCS-Stack</strong>äº‘å¹³å°åŒ…æ‹¬<strong>Linux</strong>ä¸<strong>windows</strong>ã€‚<br>Â· ä½¿ç”¨<strong>disk2vhd</strong>æŠ€æœ¯å°†å®¢æˆ·<strong>OpenStack</strong>äº‘å¹³å°<strong>windows server</strong>è¿ç§»åˆ°<strong>MCS-Stack</strong>äº‘å¹³å°ã€‚<br>2023.09-2023.09<br>Â· é˜¿é‡Œäº‘é¾™èœ¥é•œåƒECSï¼Œä½¿ç”¨<strong>qemu-img</strong>å†·è¿ç§»æŠ€æœ¯è¿ç§»åˆ°<strong>MCS-Stack</strong>äº‘å¹³å° å¹¶ä¿®æ”¹è„šæœ¬é€‚é…<strong>could-init</strong><br>Â· å®¢æˆ·åä¸ºäº‘å…«å°centos7.9ï¼Œäº‘èµ„æºè¿ç§»åˆ°<strong>MCS-Stack</strong>äº‘å¹³å° ä½¿ç”¨<strong>qemu-img</strong>å†·è¿ç§»æŠ€æœ¯ å¹¶å®‰è£…cloud-initç­‰é€‚é…<strong>MCS-Stack</strong>äº‘å¹³å°<br>2023.10-2023.11<br>Â· å°†æŸå®¢æˆ·å›½ç§‘äº‘å¤šå°centosåŠrds,ubuntué˜¿é‡Œäº‘<strong>DTS SMC çƒ­</strong>è¿ç§»ç­‰æ–¹å¼ è¿ç§»åˆ°é˜¿é‡Œäº‘ã€‚<br>Â· ä½¿ç”¨å…±äº«é•œåƒæ–¹å¼å°†æŸå®¢æˆ·<strong>A</strong>è´¦å·ECSèµ„æºè¿ç§»åˆ°<strong>B</strong>è´¦æˆ·åŠå°†å®¢æˆ·ossè¿ç§»åˆ°Bè´¦å·</p><p><strong>å®¢æˆ·æœåŠ¡ä¸‹æ–¹ä¸ºéƒ¨åˆ†ä¾‹å­(2022.04â€”â€”è‡³ä»Š)</strong><br>Â· è§£å†³rdsäº§å“<strong>sql-mode</strong>æŠ¥é”™ï¼Œéƒ¨ç½²<strong>mysql</strong>ä¸»ä»ï¼Œéƒ¨ç½²<strong>redis</strong>é›†ç¾¤<br>Â· éƒ¨ç½²<strong>nginx+keepalived</strong>é«˜å¯ç”¨å®ç°ä¸€ä¸ªå¤–ç½‘IPä¸¤æœåŠ¡å™¨å…¬ç”¨ ä»¥åŠä¸€ä¸ªå†…ç½‘VIPä¸¤æœåŠ¡å™¨å…¬ç”¨<br>Â· å®¢æˆ·åœ¨mcs-stackä¸Šäº‘ä¸»æœº<strong>é­é‡xmrigæŒ–çŸ¿ç—…æ¯’ pnscanç—…æ¯’</strong>æ”»å‡»è§£å†³ã€‚<br>Â· äº‘ä¸»æœºä½¿ç”¨lvmå·ä½¿æ•°æ®ç›˜æ‰©å®¹åˆ°ç³»ç»Ÿç›˜åè¿›å…¥<strong>grub rescue</strong>æ•‘æ´æ¨¡å¼è§£å†³ç­‰ã€‚<br>Â· è§£å†³å®¢æˆ·ä½¿ç”¨dockeræ„å»ºnacosé‡åˆ°çš„ä¸€ç³»åˆ—é—®é¢˜åŒ…æ‹¬æ•°æ®æŒä¹…åŒ– ä½¿ç”¨å¤–éƒ¨æ•°æ®åº“ç­‰ã€‚</p><p><strong>è„šæœ¬éƒ¨åˆ†</strong><br>Â· ç¼–å†™shellè„šæœ¬ç›‘æ§åç«¯<strong>ceph</strong>é›†ç¾¤å¥åº·çŠ¶å†µï¼ˆopenstack é›†æˆäº†prometheuså®æ—¶ç›‘æ§cephé›†ç¾¤çŠ¶å†µï¼‰ã€‚        ï¼ˆå‘Šè­¦æ¨é€åˆ°é’‰é’‰ï¼‰ï¼Œç¼–å†™æ¸…ç©ºzabbixè¡¨shellè„šæœ¬ã€‚<br>Â· ç¼–å†™<strong>zabbix</strong>å‘Šè­¦è„šæœ¬  ï¼ˆä¼ä¸šå¾®ä¿¡å‘Šè­¦ï¼‰ï¼Œç¼–å†™lvmè‡ªåŠ¨æ‰©å®¹è„šæœ¬ï¼ˆäººæœºäº¤äº’ï¼‰ã€‚<br>Â· ç¼–å†™ç¼–è¯‘å®‰è£…nginx keepalivedmysql redisï¼Œ<br>Â· ç›‘æ§vcenter exsi pythonè„šæœ¬ å‘Šè­¦æ¨é€åˆ°é’‰é’‰<br>Â· ç¼–å†™éƒ¨ç½²openstackåˆå§‹åŒ–è„šæœ¬ ä»¥åŠ<strong>all-in-one</strong>ç¯å¢ƒä¸€é”®éƒ¨ç½²openstackè„šæœ¬<br>Â· ç¼–å†™ä¸€é”®æ¸…ç†cephé›†ç¾¤ä»¥åŠä¸€é”®å®‰è£…cephé›†ç¾¤è„šæœ¬ï¼ŒäºŒæ¬¡å¼€å‘kalla-ansibleé›†æˆå…¬å¸å‰ç«¯é¢æ¿ã€‚<br>Â· ç¼–å†™ç›‘æ§oracle pythonè„šæœ¬ å¯¹æŸå¤§ç¥çš„é¡¹ç›®äºŒæ¬¡å¼€å‘ å¢åŠ pythonè„šæœ¬oracleç›‘æ§é¡¹ç›®<br>Â· ç¼–å†™å†·è¿ç§»v2våŠè‡ªåŠ¨è¿ç§»è„šæœ¬ï¼Œ<br>Â· ç¼–å†™é€‚ç”¨äºcentos ubuntu çš„æœåŠ¡å™¨åˆå§‹åŒ–è„šæœ¬åŒ…æ‹¬è‡ªå·±è®¾ç½®æ—¶åŒº æº limit docker pipç­‰<br>Â· ç¼–å†™mysql pgæ•°æ®åº“è‡ªåŠ¨å¤‡ä»½è„šæœ¬ï¼Œç¼–å†™ansibleå‰§æœ¬å®ç°skylineä¸openstacké›†æˆ</p><p><strong>ç›‘æ§éƒ¨åˆ†</strong><br>2022.04-2022.05<br>Â· æŒ‰å®¢æˆ·éœ€æ±‚è®¾è®¡éƒ¨ç½²ç›‘æ§æŸåŒ»é™¢ä¸ƒå°æœåŠ¡å™¨<strong>telegraf+prometheus+grafana</strong>çš„æ–¹å¼ç›‘æ§<strong>linuxå„é¡¹æŒ‡æ ‡</strong><br>Â· <strong>æ­å»ºé‡‡ç”¨telegraf+prometheusæ¶æ„</strong>ç›‘æ§äº¤æ¢æœºç­‰æ•°é€šè®¾å¤‡ ï¼ˆåæœŸæ€§èƒ½ä¸è¶³æ›¿æ¢ä¸ºzabbixï¼‰ã€‚<br>Â· æ­å»ºzabbixç›‘æ§å…¬å¸<strong>ä¸Šç™¾å°äº¤æ¢æœº</strong>å®ç°äº¤æ¢æœºå„ç§ç›‘æ§ä¸é™äºï¼ˆè¿›å‡ºå£æµé‡ cpu å†…å­˜ æ¸©åº¦ç­‰ï¼‰æ­é…è„šæœ¬å®ç°å‘Šè­¦æ¨é€åˆ°ä¼ä¸šå¾®ä¿¡ã€‚<br>2022.07-2022.08<br>Â· æ­å»º<strong>telegraf+influxdb+grafana</strong>ç›‘æ§<strong>æŸå®¢æˆ·ä»£è¿ç»´vcenter</strong>é¡¹ç›® å®ç°å¯¹æ•´ä¸ªé›†ç¾¤çš„ç›‘æ§ åŒ…æ‹¬æ¯ä¸€å°è™šæ‹Ÿæœº æ¯ä¸€å°exsiå®¿ä¸»æœº å®Œå…¨æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ <strong>è¯¥vmwareé¡¹ç›®åŒ…å«500å¤šå°è™šæ‹Ÿæœº</strong>åä¸ª<strong>esxi</strong>èŠ‚ç‚¹ã€‚<br>Â· æ„å»º<strong>telegraf+influxdb+python</strong>è„šæœ¬+<strong>grafana</strong>ç›‘æ§<strong>æŸå®¢æˆ·ä»£è¿ç»´vcenter</strong>é¡¹ç›®ä¸­äº”å°<strong>oracle</strong>æ•°æ®åº“ï¼ˆæ­¤é¡¹ç›®ä¸ºå¯¹æŸå¤§ç¥é¡¹ç›®äºŒæ¬¡å¼€å‘  ä¿®æ”¹<strong>python</strong>è„šæœ¬åˆ¶ä½œ<strong>telegraf-py</strong>ç‰ˆé•œåƒå®ç°å¯¹<strong>oracle</strong>å®Œå…¨ç›‘æ§ï¼‰ã€‚<br>2023.07-2023.07<br>Â· ç¼–è¯‘<strong>nginx-module-vts</strong>æ¨¡å—è¿›<strong>nginx</strong>ä½¿ç”¨<strong>prometheus+grafana</strong>å®ç°å¯¹<strong>nginx</strong>çš„ç›‘æ§ï¼Œéƒ¨ç½²<strong>uptime-Kuma</strong>ç›‘æ§å…¬å¸å„å¥—ç³»ç»Ÿ<br>Â· éƒ¨ç½²<strong>grafana</strong>å¼€æº<strong>loki</strong>ç›‘æ§å…¬å¸å„å°ç‰©ç†æœåŠ¡å™¨ç³»ç»Ÿæ—¥å¿—ã€‚</p><p><strong>ä»£è¿ç»´å®¢æˆ·åŠå…¬å¸å†…éƒ¨ç³»ç»Ÿéƒ¨ç½²åŠç»´æŠ¤éƒ¨åˆ†ï¼ˆ2023.07-è‡³ä»Šï¼‰</strong><br>Â· ä½¿ç”¨<strong>vercelå‡½æ•°è®¡ç®—</strong>æ­å»ºå…¬å¸<strong>chagpté—®ç­”ç³»ç»Ÿå®ç°</strong>è·¨å¢ƒè®¿é—®<strong>openai chatgpt</strong>æœåŠ¡ã€‚<br>Â· éƒ¨ç½²<strong>k8sä¸ceph</strong>é›†æˆï¼ˆ<strong>storeglass</strong>ï¼‰ã€‚<br>Â· éƒ¨ç½²<strong>wiki</strong>å…¬å¸å†…éƒ¨çŸ¥è¯†åº“ç³»ç»Ÿ<br>Â· éƒ¨ç½²<strong>cacti</strong>ç›‘æ§äº¤æ¢æœºå¹³å°<br>Â· <strong>smartping</strong> ç›‘æ§ç½‘ç»œçŠ¶å†µç³»ç»Ÿå¹¶åˆ¶ä½œ<strong>smartping docker</strong>é•œåƒå®ç°å¿«æ·éƒ¨ç½²ã€‚<br>Â· éƒ¨ç½²<strong>webstack</strong>ç½‘ç«™å¯¼èˆªç³»ç»Ÿã€‚<br>Â· <strong>ferryä¸‡èƒ½</strong>å·¥å•ç³»ç»Ÿã€‚<br>Â· <strong>cloudreve</strong>å…¬å¸äº‘ç›˜ç³»ç»Ÿã€‚<br>Â· è°ƒç ”<strong>kanboard</strong>ä¸<strong>ç¦…é“</strong>é¡¹ç›®ç®¡ç†ç³»ç»Ÿ <strong>å› kanboardåŠŸèƒ½å¤šæ ·ä½†å‰ç«¯ç®€é™‹</strong>æœ€ç»ˆé€‰å‹ä½¿ç”¨<strong>ç¦…é“ç³»ç»Ÿ</strong>ã€‚<br>Â· éƒ¨ç½²å…¬å¸<strong>esxié›†ç¾¤ä½¿ç”¨vcenter</strong>ç®¡ç†å¹³å°æ§åˆ¶ã€‚<br>Â· åŸ¹è®­å…¬å¸å„ç§è¿ç»´äººå‘˜ï¼Œç ”å‘éƒ¨ç½²äº‘ç®±ç»´æŠ¤<br>Â· é›†ç¾¤<strong>cronsun</strong>å®šæ—¶ä»»åŠ¡ç®¡ç†ç³»ç»Ÿï¼Œ<strong>bitwarden</strong>å¯†ç ç®¡ç†å¹³å°ã€‚<br>Â· å¸®åŠ©æŸäº‘å¹³å°å®¢æˆ·å°†<strong>nacos</strong>åˆ¶ä½œæˆä¸ºé•œåƒå®ç°<strong>docker</strong>ä¸€é”®å¿«æ·éƒ¨ç½²å®ç°æ•°æ®æŒä¹…åŒ–<br>Â· æ—¥å¸¸ç»´æŠ¤openstacké›†ç¾¤  ç»´æŠ¤åç«¯å­˜å‚¨cephé›†ç¾¤<br>ä¾‹ï¼š äº‘ä¸»æœº æ— æ³•åˆ é™¤ å‰ç«¯å¡æ­» ï¼Œ10 pgs not deep-scrubbed in timeï¼Œcephé›†ç¾¤å®¹é‡å‘Šè­¦ osdæ¢ç›˜æ›´æ¢<br>Â· å…¬å¸äº‘å¹³å°ä¸Šåƒå®¶å®¢æˆ·äº‘èµ„æºçš„æ—¥å¸¸è¿ç»´æœåŠ¡åˆ¶ä½œäº‘ä¸Šç¯å¢ƒä½¿ç”¨çš„å„ç§<strong>windows</strong>ç³»ç»Ÿ<strong>linux</strong>ç³»ç»Ÿçš„é•œåƒ<br>Â· æ­å»ºæŸå®¢æˆ·nginx+keepalivedé«˜å¯ç”¨ å®ç°ä¸»æŒ‚<strong>å¤–ç½‘IP</strong>åŠ<strong>å†…ç½‘VIP</strong>è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡æœåŠ¡å™¨ï¼ˆè¯¥é¡¹ç›®åªæœ‰ä¸€ä¸ªå¤–ç½‘IPï¼‰<br>Â· æ­å»ºæŸå®¢æˆ·<strong>mysql</strong>ä¸»ä»å¤åˆ¶é¡¹ç›®åæœŸæ›¿æ¢ä¸º<strong>MariaDB Galera****Cluster</strong>å®ç°ä¸»å¤‡è‡ªåŠ¨åˆ‡æ¢ã€‚</p><h4 id="å…¶ä»–-è‡ªæœ‰é¡¹ç›®"><a href="#å…¶ä»–-è‡ªæœ‰é¡¹ç›®" class="headerlink" title="å…¶ä»–/è‡ªæœ‰é¡¹ç›®"></a>å…¶ä»–/è‡ªæœ‰é¡¹ç›®</h4><p>Â· ä¸¤ç«™ç‚¹ä¸ªäººåšå®¢ç³»ç»Ÿ ï¼ˆç¼–å†™æŠ€æœ¯åšå®¢180ä½™ç¯‡ åŠ ä¸Šonenoteç´¯è®¡ä¸‰åä¸‡å­—ï¼‰<br>Â· <strong>Discuss Twikoo</strong>è¯„è®ºç³»ç»Ÿ<br><strong>OneManager</strong> ç½‘ç›˜ç®¡ç†ç³»ç»Ÿï¼ˆæ‰€æœ‰ç½‘ç›˜é€šè¿‡æ­¤<strong>web</strong>ç®¡ç†<strong>onedrive</strong> é˜¿é‡Œäº‘ç›˜ç­‰å®ç°ä¸é™æ ¼å¼ä»»æ„å¯å…±äº«ï¼‰<br>Â· <strong>Blazeb2</strong>å›¾åºŠç®¡ç†ç³»ç»Ÿå…¼å®¹<strong>s3</strong>åè®®ã€‚<br>Â· æ­å»ºNextChatè®¿é—®openai  ChatGptæœåŠ¡<br>NOTEï¼šä¸Šè¿°å„ç§ç³»ç»Ÿå‡é‡‡ç”¨<strong>cloudns</strong>æä¾›åŸŸå <strong>cloudfare</strong>æä¾›åŸŸåè§£æåŠ<strong>CDN</strong>ç¼“å­˜ç­‰ é™¤åšå®¢å¤–å…¶ä½™ç³»ç»Ÿå‡ä½¿ç”¨<strong>vercel</strong>å‡½æ•°è®¡ç®—ï¼ˆfaasï¼‰éƒ¨ç½²ã€‚</p><h4 id="è‡ªæˆ‘è¯„ä»·-å…´è¶£çˆ±å¥½"><a href="#è‡ªæˆ‘è¯„ä»·-å…´è¶£çˆ±å¥½" class="headerlink" title="è‡ªæˆ‘è¯„ä»·/å…´è¶£çˆ±å¥½"></a>è‡ªæˆ‘è¯„ä»·/å…´è¶£çˆ±å¥½</h4><p>è‡ªæˆ‘è¯„ä»·<br>Â· å¼ºæ‰§è¡ŒåŠ›ï¼ˆæ‰§è¡Œçš„æ„æ„¿+æ‰§è¡Œçš„èƒ½åŠ›ï¼‰<br>Â· å¼ºå­¦ä¹ åŠ›ï¼ˆå¯¹æ–°æŠ€æœ¯çš„æ¸´æœ›+åˆ»è‹¦çš„é’»ç ”ç²¾ç¥ï¼‰<br>Â· è¾ƒå¼ºçš„å›¢é˜Ÿåˆä½œæ„è¯†ã€ä¹äºå¹¶å–„äºåˆ†äº«ã€‚<br>å…´è¶£çˆ±å¥½<br>Â· ç¯®çƒ è¶³çƒ ç¾½æ¯›çƒ æ•£æ­¥ ç™»å±± ç­‰å„ç§è¿åŠ¨åŠå¯¹æŠ€æœ¯æœ‰æµ“åšçš„å…´è¶£çˆ±å¥½çæŠ˜è…¾ ã€‚<br>Â· çƒ­çˆ±ä¸­å›½å¤è¯—è¯æ–‡åŒ– åŠæ˜ä»£å†å²ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®</title>
      <link href="/2024/01/31/%E4%BD%BF%E7%94%A8vercel%E5%8F%8Adocker%E6%9E%84%E5%BB%BAchatgpt-nex-web%E5%AE%9E%E7%8E%B0%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/"/>
      <url>/2024/01/31/%E4%BD%BF%E7%94%A8vercel%E5%8F%8Adocker%E6%9E%84%E5%BB%BAchatgpt-nex-web%E5%AE%9E%E7%8E%B0%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®"><a href="#ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®" class="headerlink" title="ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®"></a>ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®</h2><p>æ¦‚è§ˆï¼š</p><ul><li>éœ€è¦åœ¨æŸå®è´­ä¹°openai-key</li><li>å¯è´­ä¹°ç›´è¿keyæˆ–ä¸­è½¬key å¦‚æœè´­ä¹°çš„ä¸ºä¸­è½¬keyåˆ™éœ€è¦å¡«å†™ä¸­è½¬æœåŠ¡åœ°å€</li><li><a href="https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web">chatgpt-nex-webé¡¹ç›®åœ°å€</a> å…ˆforkåˆ°è‡ªå·±ä»“åº“</li><li><a href="https://vercel.com/new/clone?repository-url=https://github.com/Yidadaa/ChatGPT-Next-Web&env=OPENAI_API_KEY&env=CODE&env=GOOGLE_API_KEY&project-name=chatgpt-next-web&repository-name=ChatGPT-Next-Web">verceléƒ¨ç½²åœ°å€</a></li></ul><p>å…¶ä»–ç±»ä¼¼å¼€æºé¡¹ç›®ï¼š</p><ul><li><a href="https://lobehub.com/zh/docs/self-hosting/platform/vercel">Lobe Chat</a></li><li><a href="https://github.com/lobehub/lobe-chat">lobe chatä»£ç ä»“åº“</a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzkzODY1MTQzOQ==&mid=2247483908&idx=1&sn=b2080d845ce5f0bc0c62373876763fa9&chksm=c2fdb844f58a3152a8164dd750c28d213fbd10d27ab83afd4af88e6105e054935e8c1f095f7d&mpshare=1&scene=24&srcid=050689k9Z1fsXTKMRvZ99D8j&sharer_shareinfo=7581c54658eeb1539b7febee12f3c196&sharer_shareinfo_first=7581c54658eeb1539b7febee12f3c196#rd">lobe Chatéƒ¨ç½²æ•™ç¨‹</a></li></ul><h4 id="ä¸€-æ„å»º"><a href="#ä¸€-æ„å»º" class="headerlink" title="ä¸€. æ„å»º"></a>ä¸€. æ„å»º</h4><p>æ·»åŠ å¦‚ä¸‹ç¯å¢ƒå˜é‡å³å¯</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CODE: passwd</span><br><span class="line">BASE<span class="emphasis">_URL: https://chatapi<span class="strong">***</span></span></span><br><span class="line"><span class="strong"><span class="emphasis">OPENAI_API_KEY: sk-wD6Ha8FsvZfbpH7AD53**</span><span class="strong">****</span><span class="strong">****</span>*</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c4148f2652bb4fe1369077b9bafea30c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c4148f2652bb4fe1369077b9bafea30c.png"></p><p>æ­¤æ—¶æ„å»ºå®Œæˆã€‚</p><h4 id="äºŒ-dockeréƒ¨ç½²"><a href="#äºŒ-dockeréƒ¨ç½²" class="headerlink" title="äºŒ. dockeréƒ¨ç½²"></a>äºŒ. dockeréƒ¨ç½²</h4><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yidadaa/chatgpt-next-web</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:chatgpt-next-web-v2.11.3</span><br></pre></td></tr></table></figure><p>docker-composeéƒ¨ç½²</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">chatgpt-next-web:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">yidadaa/chatgpt-next-web</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">chatgpt-next-web_container</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3001:3000&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">OPENAI_API_KEY=sk-En7SyGK0zljZWKlT98836aD3B2Dc420c900021D943Ac41F4</span> <span class="comment"># oneapi key</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CODE=Jkl123456</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PROXY_URL=http://192.168.31.163:3002</span>   <span class="comment"># oneapiåœ°å€</span></span><br></pre></td></tr></table></figure><h4 id="ä¸‰-ä½¿ç”¨"><a href="#ä¸‰-ä½¿ç”¨" class="headerlink" title="ä¸‰. ä½¿ç”¨"></a>ä¸‰. ä½¿ç”¨</h4><ul><li><p>è‹¥keyé¢åº¦ä¸å¤Ÿåˆ™éœ€è¦å……å€¼, å…¶ä»–keyä½¿ç”¨æ­¤å¹³å°è®¿é—®chatgptéœ€è¦å¦‚ä¸‹æ“ä½œ</p></li><li><p>ç›´è¿keyç›´æ¥å¡«å†™åå³å¯ä½¿ç”¨ è‡ªå®šä¹‰æ¥å£å¤„ æ¥å£åœ°å€ä¿ç•™é»˜è®¤â€œ/api/openaiâ€</p></li><li><p>ä¸­è½¬keyåˆ™è‡ªå®šä¹‰æ¥å£å¤„ æ¥å£åœ°å€éœ€è¦å¡«å†™ä¸­è½¬æœåŠ¡åœ°å€</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6f3a9535578411a50e84c4b23940099b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6f3a9535578411a50e84c4b23940099b.png"></p></li></ul><p>lobechatæ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_83095fcea8d81d4ab7cfba1b69f2bd33.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_83095fcea8d81d4ab7cfba1b69f2bd33.png"></p><p>å»ºè®®ä½¿ç”¨cloudfareç»™vercelç»‘å®šåŸŸåè®¿é—®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®</title>
      <link href="/2024/01/29/%E5%85%AC%E6%9C%89%E4%BA%91%E7%A7%81%E6%9C%89%E4%BA%91%E5%AF%B9%E8%B1%A1%E6%A1%B6%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/01/29/%E5%85%AC%E6%9C%89%E4%BA%91%E7%A7%81%E6%9C%89%E4%BA%91%E5%AF%B9%E8%B1%A1%E6%A1%B6%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®"><a href="#å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®" class="headerlink" title="å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®"></a>å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>å…¬æœ‰äº‘ä¸ç§æœ‰äº‘é…ç½®å¯¹è±¡æ¡¶ä¿¡æ¯æ˜¯æœ‰å·®å¼‚çš„</p><h3 id="ä¸€-å…¬æœ‰äº‘-é˜¿é‡Œäº‘ä¸ºä¾‹"><a href="#ä¸€-å…¬æœ‰äº‘-é˜¿é‡Œäº‘ä¸ºä¾‹" class="headerlink" title="ä¸€. å…¬æœ‰äº‘-é˜¿é‡Œäº‘ä¸ºä¾‹"></a>ä¸€. å…¬æœ‰äº‘-é˜¿é‡Œäº‘ä¸ºä¾‹</h3><p>ä½¿ç”¨è½¯ä»¶<strong>s3cmd</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…s3cmd</span></span><br><span class="line">yum install -y epel-release &amp;&amp; yum install -y s3cmd</span><br><span class="line"><span class="comment"># å®‰è£…qemu</span></span><br><span class="line">yum install qemu-kvm libvirt virt-install bridge-utils  -y</span><br></pre></td></tr></table></figure><p>å…¶ä»–å®‰è£…æ–¹å¼ï¼ˆubuntuï¼‰</p><p><a href="https://developer.aliyun.com/article/356106">https://developer.aliyun.com/article/356106</a><br><a href="https://www.s3express.com/download.htm">https://www.s3express.com/download.htm</a>    ï¼ˆs3è½¯ä»¶ä¸‹è½½é“¾æ¥ï¼‰</p><p>ç®€ä»‹ï¼š<br><a href="https://wangyan.org/blog/s3cmd-how-to-use.html">https://wangyan.org/blog/s3cmd-how-to-use.html</a></p><p>s3cmd å®‰è£…ä½¿ç”¨æŒ‡å—<br>s3cmd æ˜¯ä¸€æ¬¾ Amazon S3 å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒä¸ä»…èƒ½ä¸Šä¼ ã€ä¸‹è½½ã€åŒæ­¥ï¼Œè¿˜èƒ½è®¾ç½®æƒé™ï¼Œä¸‹é¢æ˜¯å®Œæ•´çš„å®‰è£…ä½¿ç”¨æŒ‡å—ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ä¸€ã€å®‰è£…æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•ä¸€ï¼šï¼ˆDebian/Ubuntu ï¼‰</span></span><br><span class="line"><span class="string">wget</span> <span class="string">-O-</span> <span class="string">-q</span> <span class="string">http://s3tools.org/repo/deb-all/stable/s3tools.key</span> <span class="string">|</span> <span class="string">sudo</span> <span class="string">apt-key</span> <span class="string">add</span> <span class="bullet">-</span></span><br><span class="line"><span class="string">wget</span> <span class="string">-O/etc/apt/sources.list.d/s3tools.list</span> <span class="string">http://s3tools.org/repo/deb-all/stable/s3tools.list</span></span><br><span class="line"><span class="string">apt-get</span> <span class="string">update</span> <span class="string">&amp;&amp;</span> <span class="string">sudo</span> <span class="string">apt-get</span> <span class="string">install</span> <span class="string">s3cmd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•äºŒï¼š</span></span><br><span class="line"><span class="string">wget</span> <span class="string">http://nchc.dl.sourceforge.net/project/s3tools/s3cmd/1.0.0/s3cmd-1.0.0.tar.gz</span></span><br><span class="line"><span class="string">tar</span> <span class="string">-zxf</span> <span class="string">s3cmd-1.0.0.tar.gz</span> <span class="string">-C</span> <span class="string">/usr/local/</span></span><br><span class="line"><span class="string">mv</span> <span class="string">/usr/local/s3cmd-1.0.0/</span> <span class="string">/usr/local/s3cmd/</span></span><br><span class="line"><span class="string">ln</span> <span class="string">-s</span> <span class="string">/usr/local/s3cmd/s3cmd</span> <span class="string">/usr/bin/s3cmd</span></span><br></pre></td></tr></table></figure><p>é˜¿é‡Œäº‘é…ç½®å¦‚ä¸‹</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_896f06a76b5634cec9f24ce6f7ec5119.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_896f06a76b5634cec9f24ce6f7ec5119.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆå§‹åŒ–s3cmd</span></span><br><span class="line">s3cmd --configure</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰§è¡Œ</span></span><br><span class="line">[root@3z6to251zh02kg system]# s3cmd --configure</span><br><span class="line"></span><br><span class="line">Enter new values or accept defaults in brackets with Enter.</span><br><span class="line">Refer to user manual for detailed description of all options.</span><br><span class="line"></span><br><span class="line">Access key and Secret key are your identifiers for Amazon S3. Leave them empty for using the env variables.</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Access Key: LTAI5t9</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Secret Key: XD0f6iyM0nY8oUJZz</span></span><br><span class="line">Default Region [US]:  # hangzhou</span><br><span class="line"></span><br><span class="line">Use &quot;s3.amazonaws.com&quot; for S3 Endpoint and not modify it to the target Amazon S3.</span><br><span class="line">S3 Endpoint [s3.amazonaws.com]: # oss-cn-hangzhou.aliyuncs.com ï¼ˆbucketsåŸŸååœ¨é˜¿é‡Œäº‘ossæ¦‚è§ˆä¸­æŸ¥çœ‹ï¼‰</span><br><span class="line"></span><br><span class="line">Use &quot;%(bucket)s.s3.amazonaws.com&quot; to the target Amazon S3. &quot;%(bucket)s&quot; and &quot;%(location)s&quot; vars can be used</span><br><span class="line">if the target S3 system supports dns based buckets.</span><br><span class="line">DNS-style bucket+hostname:port template for accessing a bucket [%(bucket)s.s3.amazonaws.com]: # %(bucket)s.oss-cn-hangzhou.aliyuncs.com</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">%(bucket)s.oss-cn-hangzhou.aliyuncs.com</span></span><br><span class="line">Encryption password is used to protect your files from reading</span><br><span class="line">by unauthorized persons while in transfer to S3</span><br><span class="line">Encryption password: </span><br><span class="line">Path to GPG program [/bin/gpg]: </span><br><span class="line"></span><br><span class="line">When using secure HTTPS protocol all communication with Amazon S3</span><br><span class="line">servers is protected from 3rd party eavesdropping. This method is</span><br><span class="line">slower than plain HTTP, and can only be proxied with Python 2.7 or newer</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Use HTTPS protocol [Yes]: Yes</span></span><br><span class="line"></span><br><span class="line">On some networks all internet access must go through a HTTP proxy.</span><br><span class="line">Try setting it here if you can&#x27;t connect to S3 directly</span><br><span class="line">HTTP Proxy server name: </span><br><span class="line"></span><br><span class="line">New settings:</span><br><span class="line">  Access Key: LTAI5t9EwR</span><br><span class="line">  Secret Key: XD0f6iyM0nJZz1</span><br><span class="line">  Default Region: hangzhou</span><br><span class="line">  S3 Endpoint: oss-cn-hangzhou.aliyuncs.com</span><br><span class="line">  DNS-style bucket+hostname:port template for accessing a bucket: %(bucket)s.oss-cn-hangzhou.aliyuncs.com</span><br><span class="line">  Encryption password: </span><br><span class="line">  Path to GPG program: /bin/gpg</span><br><span class="line">  Use HTTPS protocol: True</span><br><span class="line">  HTTP Proxy server name: </span><br><span class="line">  HTTP Proxy server port: 0</span><br><span class="line"></span><br><span class="line">Test access with supplied credentials? [Y/n] y</span><br><span class="line">Please wait, attempting to list all buckets...</span><br><span class="line">Success. Your access key and secret key worked fine :-)</span><br><span class="line"></span><br><span class="line">Now verifying that encryption works...</span><br><span class="line">Not configured. Never mind.</span><br><span class="line"></span><br><span class="line">Save settings? [y/N] y</span><br><span class="line">Configuration saved to &#x27;/root/.s3cfg&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ­¤æ—¶è®¾ç½®å®Œæˆ</span></span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯è¿æ¥è½¯ä»¶é…ç½®</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_69abbafcc46e7ce35928521f13a67e58.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_69abbafcc46e7ce35928521f13a67e58.png"></p><p>æ­¤æ—¶å³å¯è®¿é—®é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ã€‚</p><h3 id="äºŒ-ç§æœ‰äº‘-æŸäº‘é…ç½®"><a href="#äºŒ-ç§æœ‰äº‘-æŸäº‘é…ç½®" class="headerlink" title="äºŒ. ç§æœ‰äº‘ æŸäº‘é…ç½®"></a>äºŒ. ç§æœ‰äº‘ æŸäº‘é…ç½®</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># åˆ›å»ºbucketsæŠ¥é”™ï¼šåŸå› ç‰ˆæœ¬ä¸ä¸€è‡´ éœ€è¦å°†v2å¯ç”¨</span></span><br><span class="line">è§£å†³ï¼š</span><br><span class="line">vim /root/.s3cfg</span><br><span class="line">signature<span class="emphasis">_v2 = True </span></span><br><span class="line"><span class="emphasis"># æˆ–æ–°å»ºæ–‡ä»¶è¾“å…¥ï¼š</span></span><br><span class="line"><span class="emphasis">vim ~/.s3cfg</span></span><br><span class="line"><span class="emphasis">[default]</span></span><br><span class="line"><span class="emphasis">access_</span>key = 914c4</span><br><span class="line">secret<span class="emphasis">_key = qk45WMQg5VP4MBeAYE</span></span><br><span class="line"><span class="emphasis">host_</span>base = http://111.111.87.99:7480</span><br><span class="line">host<span class="emphasis">_bucket = http://111.111.87.99:7480/914c48814</span></span><br><span class="line"><span class="emphasis">use_</span>https = False</span><br><span class="line">signature<span class="emphasis">_v2 = True </span></span><br></pre></td></tr></table></figure><h3 id="ä¸‰-æ‰©å±•s3cmdå‘½ä»¤ä½¿ç”¨"><a href="#ä¸‰-æ‰©å±•s3cmdå‘½ä»¤ä½¿ç”¨" class="headerlink" title="ä¸‰. æ‰©å±•s3cmdå‘½ä»¤ä½¿ç”¨"></a>ä¸‰. æ‰©å±•<code>s3cmd</code>å‘½ä»¤ä½¿ç”¨</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># å‘½ä»¤ä½¿ç”¨</span></span><br><span class="line"><span class="section">#åˆ›å»ºbucketåç§°ä¸ºs3://cem-demo</span></span><br><span class="line">s3cmd -h                                            # æŸ¥çœ‹å‘½ä»¤è¯¦æƒ…</span><br><span class="line">s3cmd put /etc/fstab  s3://s3cmd-demo/fstab-demo    # ä¸Šä¼ æ–‡ä»¶å°†/etcç›®å½•ä¸‹æ–‡ä»¶fstabä¸Šä¼ </span><br><span class="line">s3cmd ls s3://ceph-s3-bucket                        # æŸ¥çœ‹bucketé‡Œé¢æœ‰ä»€ä¹ˆæŸ¥çœ‹å…·ä½“å†…å®¹åé¢æ¥ç›®å½•</span><br><span class="line">s3cmd put /etc s3://ceph-s3-bucket/fstab-demo/etc/ --recursive # ä¸Šä¼ ç›®å½•ï¼ˆé€’å½’çš„æ–¹å¼è®°å¾—&quot;/&quot;ï¼‰</span><br><span class="line">s3cmd get s3://ceph-s3-bucket/s3browser-6-4-1.rar              # ä¸‹è½½å‘½ä»¤</span><br><span class="line"></span><br><span class="line">s3cmd rm s3://ceph-s3-bucket/fstab-demo                        # åˆ é™¤æ–‡ä»¶å‘½ä»¤</span><br><span class="line">s3cmd rm s3://ceph-s3-bucket/fstab-demo/ --recursive           # åˆ é™¤ç›®å½•å‘½ä»¤</span><br><span class="line">s3cmd mb s3://cmd-demo                                         # åˆ›å»ºç›®å½•</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centosè®¾ç½®ç™»é™†å¯†ç éªŒè¯é”™è¯¯è‡ªåŠ¨é”å®š</title>
      <link href="/2024/01/28/centos%E8%AE%BE%E7%BD%AE%E7%99%BB%E9%99%86%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E9%94%99%E8%AF%AF%E8%87%AA%E5%8A%A8%E9%94%81%E5%AE%9A/"/>
      <url>/2024/01/28/centos%E8%AE%BE%E7%BD%AE%E7%99%BB%E9%99%86%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E9%94%99%E8%AF%AF%E8%87%AA%E5%8A%A8%E9%94%81%E5%AE%9A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>centosè®¾ç½®ç™»é™†å¯†ç éªŒè¯é”™è¯¯è‡ªåŠ¨é”å®š</strong></p><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_43822878/article/details/93018223">Linuxé™åˆ¶è¿œç¨‹ç™»å½•å°è¯•å¯†ç æ¬¡æ•°åŠé”å®šæ—¶é—´_linux sshè¿æ¥5æ¬¡å°ip1å°æ—¶-CSDNåšå®¢</a></p><p>CentOSä¸­æœ‰ä¸€ä¸ªpam_tally2.soçš„PAMæ¨¡å—ï¼Œæ¥é™å®šç”¨æˆ·çš„ç™»å½•å¤±è´¥æ¬¡æ•°ï¼Œå¦‚æœæ¬¡æ•°è¾¾åˆ°è®¾ç½®çš„é˜ˆå€¼ï¼Œåˆ™é”å®šç”¨æˆ·ã€‚</p><h3 id="ä¸€-system-authè®¾ç½®ç™»é™†é”™è¯¯é”å®šï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨æ­¤ä¼˜åŒ–é…ç½®ï¼‰"><a href="#ä¸€-system-authè®¾ç½®ç™»é™†é”™è¯¯é”å®šï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨æ­¤ä¼˜åŒ–é…ç½®ï¼‰" class="headerlink" title="ä¸€. system-authè®¾ç½®ç™»é™†é”™è¯¯é”å®šï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨æ­¤ä¼˜åŒ–é…ç½®ï¼‰"></a>ä¸€. system-authè®¾ç½®ç™»é™†é”™è¯¯é”å®šï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨æ­¤ä¼˜åŒ–é…ç½®ï¼‰</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_7a31d3176074dee91ac4da1d3a07e168.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_7a31d3176074dee91ac4da1d3a07e168.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pam.d/system-auth</span><br><span class="line"><span class="comment"># é…ç½®å¦‚ä¸‹</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line"><span class="comment"># This file is auto-generated.</span></span><br><span class="line"><span class="comment"># User changes will be destroyed the next time authconfig is run.</span></span><br><span class="line">auth       required       pam_tally2.so    deny=3    unlock_time=10 even_deny_root root_unlock_time=10</span><br><span class="line">auth        required      pam_env.so</span><br><span class="line">auth        required      pam_faildelay.so delay=2000000</span><br><span class="line">auth        sufficient    pam_unix.so nullok try_first_pass</span><br><span class="line">auth        requisite     pam_succeed_if.so uid &gt;= 1000 quiet_success</span><br><span class="line">auth        required      pam_deny.so</span><br><span class="line"></span><br><span class="line">account     required      pam_unix.so</span><br><span class="line">account     sufficient    pam_localuser.so</span><br><span class="line">account     sufficient    pam_succeed_if.so uid &lt; 1000 quiet</span><br><span class="line">account     required      pam_permit.so</span><br><span class="line"></span><br><span class="line">password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=</span><br><span class="line">password    sufficient    pam_unix.so sha512 shadow nullok try_first_pass use_authtok</span><br><span class="line">password    required      pam_deny.so</span><br><span class="line"></span><br><span class="line">session     optional      pam_keyinit.so revoke</span><br><span class="line">session     required      pam_limits.so</span><br><span class="line">-session     optional      pam_systemd.so</span><br><span class="line">session     [success=1 default=ignore] pam_succeed_if.so service <span class="keyword">in</span> crond quiet use_uid</span><br><span class="line">session     required      pam_unix.so</span><br></pre></td></tr></table></figure><p>å‚æ•°è§£é‡Šï¼š</p><p>æ·»åŠ å‚æ•°ä»‹ç»ï¼šè®¾ç½®å¯†ç å°è¯•é”™è¯¯ä¸‰æ¬¡ï¼Œæ™®é€šç”¨æˆ·å’Œrootç”¨æˆ·éƒ½è¿›è¡Œé”å®šï¼Œæ™®é€šç”¨æˆ·é”å®š10ç§’ï¼Œrootç”¨æˆ·é”å®š10ç§’</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auth       required       pam_tally2.so    deny=3    unlock_time=10 even_deny_root root_unlock_time=10</span><br></pre></td></tr></table></figure><h3 id="äºŒ-ä¸‹æ–¹ä¸ºå…¶ä»–é…ç½®é¡¹å†…å®¹"><a href="#äºŒ-ä¸‹æ–¹ä¸ºå…¶ä»–é…ç½®é¡¹å†…å®¹" class="headerlink" title="äºŒ. ä¸‹æ–¹ä¸ºå…¶ä»–é…ç½®é¡¹å†…å®¹"></a>äºŒ. ä¸‹æ–¹ä¸ºå…¶ä»–é…ç½®é¡¹å†…å®¹</h3><h4 id="1ã€ç¼–è¯‘PAMçš„é…ç½®æ–‡ä»¶"><a href="#1ã€ç¼–è¯‘PAMçš„é…ç½®æ–‡ä»¶" class="headerlink" title="1ã€ç¼–è¯‘PAMçš„é…ç½®æ–‡ä»¶"></a>1ã€ç¼–è¯‘PAMçš„é…ç½®æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># vim /etc/pam.d/login</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line">auth    required    pam_tally2.so    deny=3    unlock_time=100 even_deny_root root_unlock_time=200</span><br><span class="line">auth [user_unknown=ignore success=ok ignore=ignore default=bad] pam_securetty.so</span><br><span class="line">auth       substack     system-auth</span><br><span class="line">auth       include      postlogin</span><br><span class="line">account    required     pam_nologin.so</span><br><span class="line">account    include      system-auth</span><br><span class="line">password   include      system-auth</span><br><span class="line"><span class="comment"># pam_selinux.so close should be the first session rule</span></span><br><span class="line">session    required     pam_selinux.so close</span><br><span class="line">session    required     pam_loginuid.so</span><br><span class="line">session    optional     pam_console.so</span><br><span class="line"><span class="comment"># pam_selinux.so open should only be followed by sessions to be executed in the user context</span></span><br><span class="line">session    required     pam_selinux.so open</span><br><span class="line">session    required     pam_namespace.so</span><br><span class="line">session    optional     pam_keyinit.so force revoke</span><br><span class="line">session    include      system-auth</span><br><span class="line">session    include      postlogin</span><br><span class="line">-session   optional     pam_ck_connector.so</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å„å‚æ•°ä»‹ç»ï¼š</p><blockquote><p>even_deny_root     ä¹Ÿé™åˆ¶rootç”¨æˆ·ï¼›<br>deny                      è®¾ç½®æ™®é€šç”¨æˆ·å’Œrootç”¨æˆ·è¿ç»­é”™è¯¯ç™»é™†çš„æœ€å¤§æ¬¡æ•°ï¼Œè¶…è¿‡æœ€å¤§æ¬¡æ•°ï¼Œåˆ™é”å®šè¯¥ç”¨æˆ·<br>unlock_time          è®¾å®šæ™®é€šç”¨æˆ·é”å®šåï¼Œå¤šå°‘æ—¶é—´åè§£é”ï¼Œå•ä½æ˜¯ç§’ï¼›<br>root_unlock_time  è®¾å®šrootç”¨æˆ·é”å®šåï¼Œå¤šå°‘æ—¶é—´åè§£é”ï¼Œå•ä½æ˜¯ç§’ï¼›<br>æ­¤å¤„ä½¿ç”¨çš„æ˜¯ pam_tally2 æ¨¡å—ï¼Œå¦‚æœä¸æ”¯æŒ pam_tally2 å¯ä»¥ä½¿ç”¨ pam_tally æ¨¡å—ã€‚å¦å¤–ï¼Œä¸åŒçš„pamç‰ˆæœ¬ï¼Œè®¾ç½®å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥å‚ç…§ç›¸å…³æ¨¡å—çš„ä½¿ç”¨è§„åˆ™ã€‚</p></blockquote><p>åœ¨#%PAM-1.0çš„ä¸‹é¢ï¼Œå³ç¬¬äºŒè¡Œï¼Œæ·»åŠ å†…å®¹ï¼Œä¸€å®šè¦å†™åœ¨å‰é¢ï¼Œå¦‚æœå†™åœ¨åé¢ï¼Œè™½ç„¶ç”¨æˆ·è¢«é”å®šï¼Œä½†æ˜¯åªè¦ç”¨æˆ·è¾“å…¥æ­£ç¡®çš„å¯†ç ï¼Œè¿˜æ˜¯å¯ä»¥ç™»å½•çš„ï¼</p><p>æ·»åŠ å‚æ•°ä»‹ç»ï¼šè®¾ç½®å¯†ç å°è¯•é”™è¯¯ä¸‰æ¬¡ï¼Œæ™®é€šç”¨æˆ·å’Œrootç”¨æˆ·éƒ½è¿›è¡Œé”å®šï¼Œæ™®é€šç”¨æˆ·é”å®š100ç§’ï¼Œrootç”¨æˆ·é”å®š200ç§’</p><p><strong>/etc/pam.d/login</strong> â€”æœ€ç»ˆé…ç½®å›¾ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_b79029648b226f7ff2cca46a85548223.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_b79029648b226f7ff2cca46a85548223.png"></p><h4 id="2ã€è¿™ä¸ªåªæ˜¯é™åˆ¶äº†ç”¨æˆ·ä»ttyç™»å½•ï¼Œè€Œæ²¡æœ‰é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œå¦‚æœæƒ³é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œéœ€è¦æ”¹sshdæ–‡ä»¶"><a href="#2ã€è¿™ä¸ªåªæ˜¯é™åˆ¶äº†ç”¨æˆ·ä»ttyç™»å½•ï¼Œè€Œæ²¡æœ‰é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œå¦‚æœæƒ³é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œéœ€è¦æ”¹sshdæ–‡ä»¶" class="headerlink" title="2ã€è¿™ä¸ªåªæ˜¯é™åˆ¶äº†ç”¨æˆ·ä»ttyç™»å½•ï¼Œè€Œæ²¡æœ‰é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œå¦‚æœæƒ³é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œéœ€è¦æ”¹sshdæ–‡ä»¶"></a>2ã€è¿™ä¸ªåªæ˜¯é™åˆ¶äº†ç”¨æˆ·ä»ttyç™»å½•ï¼Œè€Œæ²¡æœ‰é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œå¦‚æœæƒ³é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œéœ€è¦æ”¹sshdæ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># vim /etc/pam.d/sshd</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line">auth    required    pam_tally2.so    deny=3    unlock_time=100 even_deny_root root_unlock_time=200</span><br><span class="line">auth       required     pam_sepermit.so</span><br><span class="line">auth       substack     password-auth</span><br><span class="line">auth       include      postlogin</span><br><span class="line"><span class="comment"># Used with polkit to reauthorize users in remote sessions</span></span><br><span class="line">-auth      optional     pam_reauthorize.so prepare</span><br><span class="line">account    required     pam_nologin.so</span><br><span class="line">account    include      password-auth</span><br><span class="line">password   include      password-auth</span><br><span class="line"><span class="comment"># pam_selinux.so close should be the first session rule</span></span><br><span class="line">session    required     pam_selinux.so close</span><br><span class="line">session    required     pam_loginuid.so</span><br><span class="line"><span class="comment"># pam_selinux.so open should only be followed by sessions to be executed in the user context</span></span><br><span class="line">session    required     pam_selinux.so open env_params</span><br><span class="line">session    required     pam_namespace.so</span><br><span class="line">session    optional     pam_keyinit.so force revoke</span><br><span class="line">session    include      password-auth</span><br><span class="line">session    include      postlogin</span><br><span class="line"><span class="comment"># Used with polkit to reauthorize users in remote sessions</span></span><br><span class="line">-session   optional     pam_reauthorize.so prepare</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯å¢åŠ åœ¨ç¬¬2è¡Œï¼</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5dbaaaaf8233e87db4cc63de60cab88b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5dbaaaaf8233e87db4cc63de60cab88b.png"></p><p>æŸ¥çœ‹ç”¨æˆ·ç™»å½•å¤±è´¥çš„æ¬¡æ•°:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># pam_tally2 --user</span></span><br><span class="line">Login           Failures Latest failure     From</span><br><span class="line">aihuidi             6    06/20/19 10:11:07  192.168.200.186    åœ¨186è¿™ä¸ªipä¸Šæœ‰ä¸ªæ™®é€šç”¨æˆ·aihuidiç™»å½•å¤±è´¥</span><br></pre></td></tr></table></figure><p>è§£é”æŒ‡å®šç”¨æˆ·:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># pam_tally2 -r -u aihuidi    è§£é”aihuidiç”¨æˆ·</span></span><br><span class="line">Login           Failures Latest failure     From</span><br><span class="line">aihuidi             6    06/20/19 10:11:07  192.168.200.186</span><br><span class="line">[root@node2 ~ ]<span class="comment"># pam_tally2 --user     åœ¨è¿›è¡ŒæŸ¥çœ‹ç”¨æˆ·ç™»å½•å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">[root@node2 ~ ]<span class="comment"># </span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>psï¼šè¿™ä¸ªè¿œç¨‹sshçš„æ—¶å€™ï¼Œè¾“å…¥å¯†ç é”™è¯¯è¶…è¿‡ä¸‰æ¬¡ä½†æ˜¯æ²¡æœ‰æç¤ºï¼Œæˆ‘ç”¨çš„æ˜¯Xshellï¼Œä¸çŸ¥é“å…¶å®ƒç»ˆç«¯æœ‰æ²¡æœ‰æç¤ºï¼Œä½†æ˜¯åªè¦è¶…è¿‡è®¾å®šçš„å€¼ï¼Œè¾“å…¥æ­£ç¡®çš„å¯†ç ä¹Ÿæ˜¯ç™»é™†ä¸äº†çš„ï¼ï¼Œè¿˜æ˜¯è¦ç­‰åˆ°è®¾å®šçš„æ—¶é—´åœ¨é‡æ–°å°è¯•è¾“å…¥æ­£ç¡®å¯†ç è¿›è¡Œç™»å½•è®¤è¯</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é­”æ”¹ç¬”è®°å››ï¼šhexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª</title>
      <link href="/2024/01/26/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E5%9B%9B%EF%BC%9Ahexo%E5%B0%8F%E7%8C%AB%E5%92%AA%E4%B8%8E%E6%BC%AB%E7%94%BB%E5%AF%BC%E8%88%AA/"/>
      <url>/2024/01/26/%E9%AD%94%E6%94%B9%E7%AC%94%E8%AE%B0%E5%9B%9B%EF%BC%9Ahexo%E5%B0%8F%E7%8C%AB%E5%92%AA%E4%B8%8E%E6%BC%AB%E7%94%BB%E5%AF%BC%E8%88%AA/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h4 id="é­”æ”¹ç¬”è®°å››ï¼šhexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª"><a href="#é­”æ”¹ç¬”è®°å››ï¼šhexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª" class="headerlink" title="é­”æ”¹ç¬”è®°å››ï¼šhexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª"></a>é­”æ”¹ç¬”è®°å››ï¼šhexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª</h4><p>è¯¦è§ï¼š<a href="https://tzy1997.com/articles/hexo1613/">è¯·æ”¶ä¸‹è¿™åªå¯çˆ±çš„çŒ«å’ªå§</a><br>è¯¦è§ï¼š<a href="https://www.fomal.cc/posts/5389e93f.html">æ¼«ç”»å¯¼èˆª</a></p><h3 id="ä¸€-å°çŒ«å’ª"><a href="#ä¸€-å°çŒ«å’ª" class="headerlink" title="ä¸€. å°çŒ«å’ª"></a>ä¸€. å°çŒ«å’ª</h3><p>åˆ¶ä½œä¸€ä¸ªç››æ”¾å†…å®¹çš„ç›’å­ï¼Œåœ¨<code>[BlogRoot]/node_modules/hexo-theme-butterfly/layout/includes/head.pug</code>(å¦‚æœæ˜¯<code>git clone</code> å®‰è£…åœ¨<code>[BlogRoot]/themes/butterfly/layout/includes/head.pug</code>)æœ€åä¸€è¡ŒåŠ å…¥å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">#myscoll</span></span><br></pre></td></tr></table></figure><p>å…¶å®éšä¾¿æ”¾åœ¨å“ªé‡Œéƒ½è¡Œï¼Œåªè¦èƒ½åŠ è½½å‡ºæ¥å°±è¡Œ</p><p>åœ¨<code>[BlogRoot]/node_modules/hexo-theme-butterfly/source/js</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª<code>cat.js</code>ï¼Œå°†ä»¥ä¸‹ä»£ç å¤åˆ¶åˆ°æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span> &gt; <span class="number">992</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getBasicInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">/* çª—å£é«˜åº¦ */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">ViewH</span> = $(<span class="variable language_">window</span>).<span class="title function_">height</span>();</span><br><span class="line">        <span class="comment">/* documenté«˜åº¦ */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">DocH</span> = $(<span class="string">&quot;body&quot;</span>)[<span class="number">0</span>].<span class="property">scrollHeight</span>;</span><br><span class="line">        <span class="comment">/* æ»šåŠ¨çš„é«˜åº¦ */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">ScrollTop</span> = $(<span class="variable language_">window</span>).<span class="title function_">scrollTop</span>();</span><br><span class="line">        <span class="comment">/* å¯æ»šåŠ¨çš„é«˜åº¦ */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="variable constant_">S_V</span> = <span class="title class_">DocH</span> - <span class="title class_">ViewH</span>;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Band</span>_H = <span class="title class_">ScrollTop</span> / (<span class="title class_">DocH</span> - <span class="title class_">ViewH</span>) * <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="title class_">ViewH</span>: <span class="title class_">ViewH</span>,</span><br><span class="line">            <span class="title class_">DocH</span>: <span class="title class_">DocH</span>,</span><br><span class="line">            <span class="title class_">ScrollTop</span>: <span class="title class_">ScrollTop</span>,</span><br><span class="line">            <span class="title class_">Band</span><span class="attr">_H</span>: <span class="title class_">Band</span>_H,</span><br><span class="line">            <span class="attr">S_V</span>: <span class="variable constant_">S_V</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">show</span>(<span class="params">basicInfo</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (basicInfo.<span class="property">ScrollTop</span> &gt; <span class="number">0.001</span>) &#123;</span><br><span class="line">            $(<span class="string">&quot;.neko&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;display&#x27;</span>, <span class="string">&#x27;block&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $(<span class="string">&quot;.neko&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;display&#x27;</span>, <span class="string">&#x27;none&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    (<span class="keyword">function</span> (<span class="params">$</span>) &#123;</span><br><span class="line">        $.fn.<span class="property">nekoScroll</span> = <span class="keyword">function</span> (<span class="params">option</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> defaultSetting = &#123;</span><br><span class="line">                <span class="attr">top</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">                <span class="attr">scroWidth</span>: <span class="number">6</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                <span class="attr">z_index</span>: <span class="number">9999</span>,</span><br><span class="line">                <span class="attr">zoom</span>: <span class="number">0.9</span>,</span><br><span class="line">                <span class="attr">borderRadius</span>: <span class="number">5</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                <span class="attr">right</span>: <span class="number">60</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                <span class="comment">// è¿™é‡Œå¯ä»¥æ¢ä¸ºä½ å–œæ¬¢çš„å›¾ç‰‡ï¼Œä¾‹å¦‚æˆ‘å°±æ¢ä¸ºäº†é›ªäººï¼Œä½†æ˜¯è¦æŠ å›¾</span></span><br><span class="line">                <span class="attr">nekoImg</span>: <span class="string">&quot;https://bu.dusays.com/2022/07/20/62d812db74be9.png&quot;</span>,</span><br><span class="line">                <span class="attr">hoverMsg</span>: <span class="string">&quot;å–µå–µå–µ~&quot;</span>,</span><br><span class="line">                <span class="attr">color</span>: <span class="string">&quot;#6f42c1&quot;</span>,</span><br><span class="line">                <span class="attr">during</span>: <span class="number">500</span>,</span><br><span class="line">                <span class="attr">blog_body</span>: <span class="string">&quot;body&quot;</span>,</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">var</span> setting = $.<span class="title function_">extend</span>(defaultSetting, option);</span><br><span class="line">            <span class="keyword">var</span> getThis = <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;className&quot;</span>) !== <span class="string">&quot;&quot;</span> ? <span class="string">&quot;.&quot;</span> + <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;className&quot;</span>) : <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;id&quot;</span>) !== <span class="string">&quot;&quot;</span> ? <span class="string">&quot;#&quot;</span> +</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;id&quot;</span>) : <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;nodeName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ($(<span class="string">&quot;.neko&quot;</span>).<span class="property">length</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">after</span>(<span class="string">&quot;&lt;div class=\&quot;neko\&quot; id=&quot;</span> + setting.<span class="property">nekoname</span> + <span class="string">&quot; data-msg=\&quot;&quot;</span> + setting.<span class="property">hoverMsg</span> + <span class="string">&quot;\&quot;&gt;&lt;/div&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> basicInfo = <span class="title function_">getBasicInfo</span>();</span><br><span class="line">            $(getThis)</span><br><span class="line">                .<span class="title function_">css</span>(&#123;</span><br><span class="line">                    <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;width&#x27;</span>: setting.<span class="property">scroWidth</span>,</span><br><span class="line">                    <span class="string">&#x27;top&#x27;</span>: setting.<span class="property">top</span>,</span><br><span class="line">                    <span class="string">&#x27;height&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span>,</span><br><span class="line">                    <span class="string">&#x27;background-color&#x27;</span>: setting.<span class="property">bgcolor</span>,</span><br><span class="line">                    <span class="string">&quot;border-radius&quot;</span>: setting.<span class="property">borderRadius</span>,</span><br><span class="line">                    <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                    <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">scImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;-webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.1) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0.1) 75%, transparent 75%, transparent)&#x27;</span>, <span class="string">&#x27;border-radius&#x27;</span>: <span class="string">&#x27;2em&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;background-size&#x27;</span>: <span class="string">&#x27;contain&#x27;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                .<span class="title function_">css</span>(&#123;</span><br><span class="line">                    <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;top&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> - <span class="number">50</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span> * <span class="number">10</span>,</span><br><span class="line">                    <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                    <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">nekoImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="title function_">show</span>(<span class="title function_">getBasicInfo</span>());</span><br><span class="line">            $(<span class="variable language_">window</span>)</span><br><span class="line">                .<span class="title function_">scroll</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="keyword">let</span> basicInfo = <span class="title function_">getBasicInfo</span>();</span><br><span class="line">                    <span class="title function_">show</span>(basicInfo);</span><br><span class="line">                    $(getThis)</span><br><span class="line">                        .<span class="title function_">css</span>(&#123;</span><br><span class="line">                            <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;width&#x27;</span>: setting.<span class="property">scroWidth</span>,</span><br><span class="line">                            <span class="string">&#x27;top&#x27;</span>: setting.<span class="property">top</span>,</span><br><span class="line">                            <span class="string">&#x27;height&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span>,</span><br><span class="line">                            <span class="string">&#x27;background-color&#x27;</span>: setting.<span class="property">bgcolor</span>,</span><br><span class="line">                            <span class="string">&quot;border-radius&quot;</span>: setting.<span class="property">borderRadius</span>,</span><br><span class="line">                            <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                            <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">scImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;-webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.1) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0.1) 75%, transparent 75%, transparent)&#x27;</span>, <span class="string">&#x27;border-radius&#x27;</span>: <span class="string">&#x27;2em&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;background-size&#x27;</span>: <span class="string">&#x27;contain&#x27;</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                        .<span class="title function_">css</span>(&#123;</span><br><span class="line">                            <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;top&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> - <span class="number">50</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span> * <span class="number">10</span>,</span><br><span class="line">                            <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                            <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">nekoImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                        &#125;);</span><br><span class="line">                    <span class="keyword">if</span> (basicInfo.<span class="property">ScrollTop</span> == basicInfo.<span class="property">S_V</span>) &#123;</span><br><span class="line">                        $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                            .<span class="title function_">addClass</span>(<span class="string">&quot;showMsg&quot;</span>)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                            .<span class="title function_">removeClass</span>(<span class="string">&quot;showMsg&quot;</span>);</span><br><span class="line">                        $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                            .<span class="title function_">attr</span>(<span class="string">&quot;data-msg&quot;</span>, setting.<span class="property">hoverMsg</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                btf.<span class="title function_">scrollToDest</span>(<span class="number">0</span>, <span class="number">500</span>)</span><br><span class="line">            &#125;);</span><br><span class="line">            $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                .<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    btf.<span class="title function_">scrollToDest</span>(<span class="number">0</span>, <span class="number">500</span>)</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)(jQuery);</span><br><span class="line"></span><br><span class="line">    $(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//éƒ¨åˆ†è‡ªå®šä¹‰</span></span><br><span class="line">        $(<span class="string">&quot;#myscoll&quot;</span>).<span class="title function_">nekoScroll</span>(&#123;</span><br><span class="line">            <span class="attr">bgcolor</span>: <span class="string">&#x27;rgb(0 0 0 / .5)&#x27;</span>, <span class="comment">//èƒŒæ™¯é¢œè‰²ï¼Œæ²¡æœ‰ç»³å­èƒŒæ™¯å›¾ç‰‡æ—¶æœ‰æ•ˆ</span></span><br><span class="line">            <span class="attr">borderRadius</span>: <span class="string">&#x27;2em&#x27;</span>,</span><br><span class="line">            <span class="attr">zoom</span>: <span class="number">0.9</span></span><br><span class="line">        &#125;</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">//è‡ªå®šä¹‰ï¼ˆå»æ‰ä»¥ä¸‹æ³¨é‡Šï¼Œå¹¶æ³¨é‡Šæ‰å…¶ä»–çš„æŸ¥çœ‹æ•ˆæœï¼‰</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        $(&quot;#myscoll&quot;).nekoScroll(&#123;</span></span><br><span class="line"><span class="comment">            nekoname:&#x27;neko1&#x27;, //nekonameï¼Œç›¸å½“äºid</span></span><br><span class="line"><span class="comment">            nekoImg:&#x27;img/çŒ«å’ª.png&#x27;, //nekoçš„èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line"><span class="comment">            scImg:&quot;img/ç»³1.png&quot;, //ç»³å­çš„èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line"><span class="comment">            bgcolor:&#x27;#1e90ff&#x27;, //èƒŒæ™¯é¢œè‰²ï¼Œæ²¡æœ‰ç»³å­èƒŒæ™¯å›¾ç‰‡æ—¶æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">            zoom:0.9, //ç»³å­é•¿åº¦çš„ç¼©æ”¾å€¼</span></span><br><span class="line"><span class="comment">            hoverMsg:&#x27;ä½ å¥½~å–µ&#x27;, //é¼ æ ‡æµ®åŠ¨åˆ°nekoä¸Šæ–¹çš„å¯¹è¯æ¡†ä¿¡æ¯</span></span><br><span class="line"><span class="comment">            right:&#x27;100px&#x27;, //è·ç¦»é¡µé¢å³è¾¹çš„è·ç¦»</span></span><br><span class="line"><span class="comment">            fontFamily:&#x27;æ¥·ä½“&#x27;, //å¯¹è¯æ¡†å­—ä½“</span></span><br><span class="line"><span class="comment">            fontSize:&#x27;14px&#x27;, //å¯¹è¯æ¡†å­—ä½“çš„å¤§å°</span></span><br><span class="line"><span class="comment">            color:&#x27;#1e90ff&#x27;, //å¯¹è¯æ¡†å­—ä½“é¢œè‰²</span></span><br><span class="line"><span class="comment">            scroWidth:&#x27;8px&#x27;, //ç»³å­çš„å®½åº¦</span></span><br><span class="line"><span class="comment">            z_index:100, //ä¸ç”¨è§£é‡Šäº†å§</span></span><br><span class="line"><span class="comment">            during:1200, //ä»é¡¶éƒ¨åˆ°åº•éƒ¨æ»‘åŠ¨çš„æ—¶é•¿</span></span><br><span class="line"><span class="comment">        &#125;);</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>[BlogRoot]/node_modules/hexo-theme-butterfly/source/css</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª<code>cat.css</code>ï¼Œå°†ä»¥ä¸‹ä»£ç å¤åˆ¶åˆ°æ–‡ä»¶ä¸­ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¸æ–°å»º css æ–‡ä»¶ï¼Œå¤åˆ¶ä»£ç åˆ°<code>custom.css</code>ä¹Ÿè¡Œï¼Œæ€»ä¹‹æœ‰åœ°æ–¹å¼•å…¥å°±è¡Œã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-tag">body</span>::-webkit-scrollbar &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&quot;https://bu.dusays.com/2022/07/20/62d812db74be9.png&quot;</span>);</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-size</span>: contain;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">50%</span>);</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">font-family</span>: tzy;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#6f42c1</span>;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&quot;https://bu.dusays.com/2022/07/20/62d812d95e6f5.png&quot;</span>);</span><br><span class="line">    <span class="attribute">background-size</span>: contain;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">9999</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">115%</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-class">.showMsg</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="built_in">attr</span>(data-msg);</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="built_in">attr</span>(data-msg);</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-class">.fontColor</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @description: æ»šåŠ¨æ¡æ ·å¼  è·ŸçŒ«äºŒé€‰ä¸€</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">992px</span>) &#123;</span><br><span class="line">    ::-webkit-scrollbar &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">8px</span> <span class="meta">!important</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">8px</span> <span class="meta">!important</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-track &#123;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">2em</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">255</span> <span class="number">255</span> <span class="number">255</span> / .<span class="number">3</span>);</span><br><span class="line">        <span class="attribute">background-image</span>: <span class="built_in">-webkit-linear-gradient</span>(<span class="number">45deg</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>) <span class="number">25%</span>, transparent <span class="number">25%</span>, transparent <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>) <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>) <span class="number">75%</span>, transparent <span class="number">75%</span>, transparent);</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">2em</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-corner &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: transparent</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶<code>_config.butterfly.yml</code>ä¸­å¼•å…¥<code>cat.js</code>å’Œ<code>cat.css</code>ï¼Œå½“ç„¶è¿˜æœ‰åœ¨bottomçš„æœ€å‰é¢å¼•å…¥<code>jQuery</code>ï¼Œå› ä¸º<code>cat.js</code>çš„è¯­æ³•ä¾èµ–<code>jQuery</code>ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/cat.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">src=&quot;https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">data-pjax</span> <span class="string">src=&quot;/js/cat.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€åé‡æ–°ç¼–è¯‘è¿è¡Œå³å¯çœ‹è§æ•ˆæœã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure><h3 id="äºŒ-æ¼«ç”»å¯¼èˆª"><a href="#äºŒ-æ¼«ç”»å¯¼èˆª" class="headerlink" title="äºŒ. æ¼«ç”»å¯¼èˆª"></a>äºŒ. æ¼«ç”»å¯¼èˆª</h3><p>é€‰æ‹©å–œæ¬¢çš„å›¾æ ‡ æ·»åŠ åˆ°é¡¹ç›® åœ¨<a href="https://www.iconfont.cn/">é˜¿é‡Œäº‘å›¾æ ‡åº“</a></p><p>åœ¨<code>[BlogRoot]\themes\butterfly\source\css\custom.css</code>ä¸­å¡«å†™å¦‚ä¸‹å†…å®¹ï¼Œå¼•å…¥Unicodeå’ŒFont-classçš„çº¿ä¸Šèµ„æºï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">@import</span> <span class="string">&quot;//at.alicdn.com/t/c/font_4426032_sy4sytzuoj9.css&quot;</span><span class="string">;</span></span><br></pre></td></tr></table></figure><p>æ›´æ¨èåœ¨åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶<code>inject</code>é…ç½®é¡¹è¿›è¡Œå…¨å±€å¼•å…¥ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;//at.alicdn.com/t/c/font_4426032_sy4sytzuoj9.css&quot;</span> <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;//at.alicdn.com/t/c/font_4426032_sy4sytzuoj9.js&quot;&gt;&lt;/script&gt;</span> </span><br></pre></td></tr></table></figure><p>åŒæ—¶å¯ä»¥åœ¨è‡ªå®šä¹‰<code>CSS</code>ä¸­æ·»åŠ å¦‚ä¸‹æ ·å¼æ¥æ§åˆ¶å›¾æ ‡é»˜è®¤å¤§å°å’Œé¢œè‰²ç­‰å±æ€§ï¼ˆ<strong>è‹¥å·²ç»åœ¨é¡¹ç›®è®¾ç½®ä¸­å‹¾é€‰äº†å½©è‰²é€‰é¡¹ï¼Œåˆ™æ— éœ€å†å®šä¹‰å›¾æ ‡é¢œè‰²</strong>ï¼‰ï¼Œå†™æ³•ä¸å­—ä½“æ ·å¼ç±»ä¼¼ï¼Œè¿™ææ€•ä¹Ÿæ˜¯å®ƒè¢«ç§°ä¸º<code>iconfont</code>ï¼ˆå›¾æ ‡å­—ä½“ï¼‰çš„åŸå› :</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.iconfont</span> &#123;</span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">&quot;iconfont&quot;</span> <span class="type">!important;</span></span><br><span class="line">  <span class="string">/*</span> <span class="string">è¿™é‡Œå¯ä»¥è‡ªå®šä¹‰å›¾æ ‡å¤§å°</span> <span class="string">*/</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="string">3em;</span></span><br><span class="line">  <span class="attr">font-style:</span> <span class="string">normal;</span></span><br><span class="line">  <span class="string">-webkit-font-smoothing:</span> <span class="string">antialiased;</span></span><br><span class="line">  <span class="string">-moz-osx-font-smoothing:</span> <span class="string">grayscale;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åå®šä¹‰å¯¼èˆªæ </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">ä¸»é¡µ:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-shouye</span>              <span class="comment">#fas fa-home</span></span><br><span class="line">  <span class="string">åˆ†ç±»:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-fenlei</span> <span class="comment">#fa fa-archive</span></span><br><span class="line">  <span class="string">æ ‡ç­¾:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-biaoqian</span>     <span class="comment">#fa fa-tags</span></span><br><span class="line">  <span class="string">å½’æ¡£:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-guidang</span>  <span class="comment">#fa fa-folder-open</span></span><br><span class="line">  <span class="string">å‹é“¾:</span> <span class="string">/link/</span>    <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-kafei</span>  <span class="comment"># fa fa-link</span></span><br><span class="line">  <span class="string">ç•™è¨€æ¿:</span> <span class="string">https://gegewu-cloud.github.io/2023/05/23/ç•™è¨€æ¿/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-lishiliuyan</span> <span class="comment">#fa fa-paper-plane</span></span><br><span class="line">  <span class="string">å…³äº:</span> <span class="string">https://gegewu-cloud.github.io/2023/05/22/å…³äº/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-xing</span> <span class="comment">#fas fa-heart </span></span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_4b90daa3afa9713b09d6c5b78cbb6671.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_4b90daa3afa9713b09d6c5b78cbb6671.png"></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl</title>
      <link href="/2024/01/25/%E6%B8%85%E7%90%86systemd%E6%97%A5%E5%BF%97%E4%B9%8Bjournalctl/"/>
      <url>/2024/01/25/%E6%B8%85%E7%90%86systemd%E6%97%A5%E5%BF%97%E4%B9%8Bjournalctl/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl"><a href="#æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl" class="headerlink" title="æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl"></a>æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl</h2><p>å‚è€ƒæ–‡çŒ®</p><p><a href="https://itlanyan.com/clear-systemd-journal-logs/">https://itlanyan.com/clear-systemd-journal-logs/</a></p><p><strong>systemd journal</strong>ä¹‹äº<code>systemd</code>çŠ¹å¦‚<strong>syslog</strong>ä¹‹äº<code>init</code>ï¼Œå…¶æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ <strong>/var/log/journal</strong> ç›®å½•ä¸‹ã€‚éšç€æ—¶é—´çš„æµé€ï¼Œè¯¥ç›®å½•ä¸‹ä¼šç§¯ç´¯å¤§é‡æ—¥å¿—æ–‡ä»¶ï¼Œå ç”¨ä¸å°‘çš„ç£ç›˜ç©ºé—´ã€‚å¦‚æœç¡¬ç›˜å®¹é‡è¾ƒå°æˆ–å¯ç”¨ç©ºé—´ç´§å¼ ï¼Œå¯ä»¥è€ƒè™‘æ¸…ç†è¿‡æœŸæ—¥å¿—é‡Šæ”¾å ç”¨çš„ç©ºé—´ã€‚</p><p>æœ¬æ–‡ä»‹ç»æ¸…ç†<a href="https://itlanyan.com/tag/systemd/">systemd</a>æ—¥å¿—çš„æ–¹æ³•ã€‚</p><h3 id="æ¸…ç†systemdæ—¥å¿—"><a href="#æ¸…ç†systemdæ—¥å¿—" class="headerlink" title="æ¸…ç†systemdæ—¥å¿—"></a>æ¸…ç†systemdæ—¥å¿—</h3><p><a href="https://itlanyan.com/clear-systemd-journal-logs/#bnp_indexs">è¿”å›ç›®å½•</a></p><p>æ¸…ç†ä¹‹å‰ï¼Œå¯æŸ¥çœ‹ä¸€ä¸‹systemdæ—¥å¿—æ‰€å ç”¨çš„ç£ç›˜ç©ºé—´ã€‚æ—¢å¯ä»¥ç”¨å¸¸ç”¨çš„ <code>&lt;span class=&quot;pln&quot;&gt;du&lt;/span&gt;</code> å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo du -sh /var/log/journal/</span><br><span class="line"># ç¤ºä¾‹è¾“å‡º</span><br><span class="line"># 3.9G /var/log/journal/</span><br></pre></td></tr></table></figure><p>ä½†æ›´æ¨èä½¿ç”¨systemdæ—¥å¿—ç®¡ç†ä¸“ç”¨å‘½ä»¤ <code>&lt;span class=&quot;pln&quot;&gt;journalctl&lt;/span&gt;</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">journalctl --disk-usage</span><br><span class="line"># ç¤ºä¾‹è¾“å‡º</span><br><span class="line"># Archived and active journals take up 3.9G on disk.</span><br></pre></td></tr></table></figure><p>çŸ¥é“äº†æ—¥å¿—å ç”¨çš„ç£ç›˜ç©ºé—´ï¼Œæ¥ä¸‹æ¥ä¾¿å¯ä»¥æ¸…ç†è¿‡æœŸæ—¥å¿—ã€‚å¼€å§‹ä¹‹å‰ï¼Œå»ºè®® <code>&lt;span class=&quot;pln&quot;&gt;rotate&lt;/span&gt;</code> å½“å‰æ—¥å¿—(rotateæ˜¯æ—¥å¿—æ“ä½œä¸­çš„ä¸€ä¸ªæœ¯è¯­ï¼Œå…¶å½’æ¡£æ—§æ—¥å¿—ï¼Œåç»­æ—¥å¿—å†™å…¥æ–°åˆ›å»ºçš„æ—¥å¿—æ–‡ä»¶ä¸­)ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo journalctl --rotate</span><br></pre></td></tr></table></figure><p><code>&lt;span class=&quot;pln&quot;&gt;journalctl&lt;/span&gt;</code>æä¾›äº†ä¸‰ç§æ¸…ç†systemdæ—¥å¿—çš„æ–¹å¼ã€‚ç¬¬ä¸€ç§æ˜¯æ¸…ç†æŒ‡å®šæ—¶é—´ä¹‹å‰çš„æ—¥å¿—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æ¸…ç†7å¤©ä¹‹å‰çš„æ—¥å¿—</span><br><span class="line">sudo journalctl --vacuum-time=7d</span><br><span class="line"># æ¸…ç†2å°æ—¶ä¹‹å‰çš„æ—¥å¿—</span><br><span class="line">sudo journactl --vacuum-time=2h</span><br><span class="line"># æ¸…ç†10ç§’ä¹‹å‰çš„æ—¥å¿—</span><br><span class="line">sudo journalctl --vacuum-time=10s</span><br><span class="line"># ä¸Šè¿°å‘½ä»¤ç¤ºä¾‹è¾“å‡ºï¼š</span><br><span class="line"># Vacuuming done, freed 3.7G of archived journals on disk.</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ˜¯é™åˆ¶æ—¥å¿—å ç”¨çš„ç©ºé—´å¤§å°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># é™åˆ¶systemdæ—¥å¿—å ç”¨ä¸è¶…è¿‡1Gç©ºé—´</span><br><span class="line">sudo journalctl --vacuum-size=1G</span><br><span class="line"># é™åˆ¶systemdæ—¥å¿—å ç”¨ä¸è¶…è¿‡100M</span><br><span class="line">sudo journalctl --vacuum-size=100M</span><br><span class="line"># è¾“å‡ºä¸ç¬¬ä¸€ç§ç±»ä¼¼</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ˜¯ä¿ç•™æ—¥å¿—æ–‡ä»¶ä¸ªæ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ä¿ç•™æœ€è¿‘çš„5ä¸ªæ—¥å¿—æ–‡ä»¶</span><br><span class="line">sudo journalctl --vacuum-files=5</span><br><span class="line"># è¾“å‡ºä¸ç¬¬ä¸€ç§ç±»ä¼¼</span><br></pre></td></tr></table></figure><p>ä¸çŸ¥é“ <code>journalctl</code> ç®¡ç†æ—¥å¿—åŠŸèƒ½ä¹‹å‰ï¼Œæœ¬äººç”¨è¿‡ <code>find é…åˆ </code><span class="kwd">exec</span><code> (æˆ–è€…ç®¡é“åŠ </code><span class="pln">xargs</span>`)çš„åœŸåŠæ³•æ¸…ç†è¿‡æœŸæ—¥å¿—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># åˆ é™¤7å¤©å‰çš„æ—¥å¿—</span><br><span class="line">find /var/log/journal -mtime +7 -exec rm -rf &#123;&#125; \;</span><br></pre></td></tr></table></figure><h3 id="ä¸€åŠ³æ°¸é€¸çš„åŠæ³•"><a href="#ä¸€åŠ³æ°¸é€¸çš„åŠæ³•" class="headerlink" title="ä¸€åŠ³æ°¸é€¸çš„åŠæ³•"></a>ä¸€åŠ³æ°¸é€¸çš„åŠæ³•</h3><p><a href="https://itlanyan.com/clear-systemd-journal-logs/#bnp_indexs">è¿”å›ç›®å½•</a></p><p>ä¸Šæ–‡ä»‹ç»çš„æ¸…ç†systemdæ—¥å¿—æ–¹æ³•é€‚åˆä¸€æ¬¡æ€§æ‰‹åŠ¨ç®¡ç†ï¼Œé‡å¤åšå°±æ²¡æ„æ€äº†ã€‚ä¸€åŠ³æ°¸é€¸çš„åŠæ³•æ˜¯é…ç½®systemd journalï¼Œè®©å…¶è‡ªåŠ¨ç®¡ç†æ—¥å¿—ï¼Œä¸å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´ã€‚</p><p>æ–¹æ³•æ˜¯ç¼–è¾‘ <strong>/etc/systemd/journald.conf</strong> æ–‡ä»¶ï¼Œå¯¹å…¶ä¸­çš„å‚æ•°è¿›è¡Œè®¾ç½®ã€‚ä¾‹å¦‚é™åˆ¶æ—¥å¿—æœ€å¤§å ç”¨1Gç©ºé—´ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[Journal]</span><br><span class="line">#Storage=auto</span><br><span class="line">#Compress=yes</span><br><span class="line">#Seal=yes</span><br><span class="line">#SplitMode=uid</span><br><span class="line">#SyncIntervalSec=5m</span><br><span class="line">#RateLimitInterval=30s</span><br><span class="line">#RateLimitBurst=1000</span><br><span class="line">SystemMaxUse=1G</span><br><span class="line">#SystemKeepFree=</span><br><span class="line">#SystemMaxFileSize=</span><br><span class="line">#RuntimeMaxUse=</span><br><span class="line">#RuntimeKeepFree=</span><br><span class="line">#RuntimeMaxFileSize=</span><br></pre></td></tr></table></figure><p>ä¿å­˜é…ç½®æ–‡ä»¶åè®°å¾—é‡æ–°åŠ è½½ï¼š<code>sudo systemctl restart systemd-journald</code></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://itlanyan.com/clear-systemd-journal-logs/#bnp_indexs">è¿”å›ç›®å½•</a></p><ol><li><a href="https://linuxhandbook.com/clear-systemd-journal-logs/">How to Clear Systemd Journal Logs</a></li><li><a href="https://itlanyan.com/find-files-in-linux/">Linuxæ–‡ä»¶æŸ¥æ‰¾</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerä¸k8såŠvercelæ–¹å¼éƒ¨ç½²qexoğŸ˜˜</title>
      <link href="/2024/01/24/docker%E4%B8%8Ek8s%E5%8F%8Avercel%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2qexo/"/>
      <url>/2024/01/24/docker%E4%B8%8Ek8s%E5%8F%8Avercel%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2qexo/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="dockerä¸k8såŠvercelæ–¹å¼éƒ¨ç½²qexoğŸ˜˜"><a href="#dockerä¸k8såŠvercelæ–¹å¼éƒ¨ç½²qexoğŸ˜˜" class="headerlink" title="dockerä¸k8såŠvercelæ–¹å¼éƒ¨ç½²qexoğŸ˜˜"></a>dockerä¸k8såŠvercelæ–¹å¼éƒ¨ç½²qexoğŸ˜˜</h2><h4 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h4><p><a href="https://github.com/Qexo/Qexo.git">https://github.com/Qexo/Qexo.git</a>      ã€githubå®˜æ–¹æ‰˜ç®¡ä»“åº“ã€‘<br><a href="https://www.yyds.space/posts/3dfeb390abb4">https://www.yyds.space/posts/3dfeb390abb4</a><br><a href="https://www.oplog.cn/qexo/start/build.html">Qexo æ–‡æ¡£ (oplog.cn)</a></p><h2 id="ä¸€ã€dockeréƒ¨ç½²åŠæ„å»ºé•œåƒ"><a href="#ä¸€ã€dockeréƒ¨ç½²åŠæ„å»ºé•œåƒ" class="headerlink" title="ä¸€ã€dockeréƒ¨ç½²åŠæ„å»ºé•œåƒ"></a>ä¸€ã€dockeréƒ¨ç½²åŠæ„å»ºé•œåƒ</h2><p>æœ€æ–°éƒ¨ç½²æ–¹å¼ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E8%84%9A%E6%9C%AC/qexo/qexo.sh |  bash</span><br></pre></td></tr></table></figure><p>è„šæœ¬è¯¦æƒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line"><span class="comment"># IP=$&#123;IP:-&#x27;127.0.0.1&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ‰§è¡Œæ­¤è„šæœ¬å‰éœ€è¦å…ˆæ‰§è¡Œåˆå§‹åŒ–è„šæœ¬&quot;</span></span><br><span class="line"><span class="built_in">sleep</span> 2</span><br><span class="line"><span class="comment"># read -p &quot;è¾“å…¥æ‚¨çš„æœ¬æœºiP: &quot; hostname_ip</span></span><br><span class="line"><span class="comment"># mkdir -p /opt/qexo &amp;&amp; cd /opt/qexo &amp;&amp; touch db.sqlite3</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /opt/qexo || <span class="literal">true</span></span><br><span class="line"><span class="built_in">cd</span> /opt/qexo </span><br><span class="line"></span><br><span class="line"><span class="comment"># docker-compose.yml</span></span><br><span class="line"><span class="built_in">cat</span> &gt; docker-compose.yml &lt;&lt; <span class="string">eric</span></span><br><span class="line"><span class="string">version: &quot;3.8&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">services:</span></span><br><span class="line"><span class="string">  qexo:</span></span><br><span class="line"><span class="string">    image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.6.0</span></span><br><span class="line"><span class="string">    container_name: qexo</span></span><br><span class="line"><span class="string">    restart: always</span></span><br><span class="line"><span class="string">    ports:</span></span><br><span class="line"><span class="string">      - &quot;8000:8000&quot;</span></span><br><span class="line"><span class="string">    environment:</span></span><br><span class="line"><span class="string">      - TIMEOUT=600</span></span><br><span class="line"><span class="string">    volumes:</span></span><br><span class="line"><span class="string">      - &quot;./db:/app/db&quot;</span></span><br><span class="line"><span class="string">eric</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># # configs.py</span></span><br><span class="line"><span class="comment"># cat &gt; configs.py &lt;&lt; eric</span></span><br><span class="line"><span class="comment"># import pymysql,os</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># DOMAINS = [&quot;127.0.0.1&quot;,&quot;$IP&quot;]</span></span><br><span class="line"><span class="comment"># DATABASES = &#123;</span></span><br><span class="line"><span class="comment">#     &#x27;default&#x27;: &#123;</span></span><br><span class="line"><span class="comment">#         &#x27;ENGINE&#x27;: &#x27;django.db.backends.sqlite3&#x27;,</span></span><br><span class="line"><span class="comment">#         &#x27;NAME&#x27;: os.path.join(&#x27;/app/db&#x27; , &#x27;db.sqlite3&#x27;),</span></span><br><span class="line"><span class="comment">#     &#125;</span></span><br><span class="line"><span class="comment"># &#125;</span></span><br><span class="line"><span class="comment"># eric</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cat &gt; docker-compose.yml &lt;&lt; eric</span></span><br><span class="line"><span class="comment"># version: &#x27;3&#x27;</span></span><br><span class="line"><span class="comment"># services:</span></span><br><span class="line"><span class="comment">#   qexo:</span></span><br><span class="line"><span class="comment">#     image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.0.2 </span></span><br><span class="line"><span class="comment">#     container_name: qexo</span></span><br><span class="line"><span class="comment">#     restart: always</span></span><br><span class="line"><span class="comment">#     ports:</span></span><br><span class="line"><span class="comment">#       - &quot;8000:8000&quot;</span></span><br><span class="line"><span class="comment">#     volumes:</span></span><br><span class="line"><span class="comment">#       - ./db.sqlite3:/app/db/db.sqlite3</span></span><br><span class="line"><span class="comment">#       - ./blog:/app/data</span></span><br><span class="line"><span class="comment">#       - ./configs.py:/app/configs.py</span></span><br><span class="line"><span class="comment"># eric</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;å¼€å§‹æ„å»ºqexo&quot;</span></span><br><span class="line">[ $? -eq 0 ] &amp;&amp; docker-compose up -d </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;æ„å»ºå®Œæˆ è®¿é—®æœ¬æœºIP+8000ç«¯å£è®¿é—®&quot;</span></span><br><span class="line">hostname -I</span><br><span class="line">docker-compose ps</span><br></pre></td></tr></table></figure><h2 id="äºŒã€ç”³è¯·å…è´¹mongondbæ•°æ®åº“ä½¿ç”¨verceléƒ¨ç½²qexo"><a href="#äºŒã€ç”³è¯·å…è´¹mongondbæ•°æ®åº“ä½¿ç”¨verceléƒ¨ç½²qexo" class="headerlink" title="äºŒã€ç”³è¯·å…è´¹mongondbæ•°æ®åº“ä½¿ç”¨verceléƒ¨ç½²qexo"></a>äºŒã€ç”³è¯·å…è´¹mongondbæ•°æ®åº“ä½¿ç”¨verceléƒ¨ç½²qexo</h2><h3 id="ç”³è¯·-MongoDB-æ•°æ®åº“"><a href="#ç”³è¯·-MongoDB-æ•°æ®åº“" class="headerlink" title="ç”³è¯· MongoDB æ•°æ®åº“"></a>ç”³è¯· MongoDB æ•°æ®åº“<a href="https://www.oplog.cn/qexo/start/build.html#%E7%94%B3%E8%AF%B7-mongodb-%E6%95%B0%E6%8D%AE%E5%BA%93"></a></h3><p><a href="https://www.mongodb.com/cloud/atlas/register">æ³¨å†Œ MongoDB è´¦å·</a> åˆ›å»ºå…è´¹ MongoDB æ•°æ®åº“, åŒºåŸŸ<strong>ä¸€å®šè¦é€‰æ‹© AWS / N. Virginia (us-east-1)</strong> åœ¨ Clusters é¡µé¢ç‚¹å‡» CONNECT, æŒ‰æ­¥éª¤è®¾ç½®å…è®¸æ‰€æœ‰ IP åœ°å€çš„è¿æ¥ï¼‰, åˆ›å»ºæ•°æ®åº“ç”¨æˆ·, å¹¶è®°å½•æ•°æ®åº“è¿æ¥ä¿¡æ¯, å¯†ç å³ä¸ºä½ æ‰€è®¾ç½®çš„å€¼<a href="https://s2.loli.net/2024/07/19/9axCOdNGJWUIqQ7.png"><img src="https://s2.loli.net/2024/07/19/9axCOdNGJWUIqQ7.png"></a></p><p>é¦–æ¬¡éƒ¨ç½²ä¼šæŠ¥é”™, è¯·æ— è§†å¹¶é‡æ–°è¿›å…¥é¡¹ç›®, åœ¨é¡¹ç›®è®¾ç½®ç•Œé¢æ·»åŠ ç¯å¢ƒå˜é‡ Environment Variablesï¼ˆè§ onenote åšå®¢åˆ†ç±»æ ç›®ï¼‰</p><table><thead><tr><th>åç§°</th><th>æ„ä¹‰</th><th>ç¤ºä¾‹</th></tr></thead><tbody><tr><td>MONGODB_HOST</td><td>MongoDB æ•°æ®åº“è¿æ¥åœ°å€</td><td>mongodb+srv://cluster0.xxxx.mongodb.net</td></tr><tr><td>MONGODB_PORT</td><td>MongoDB æ•°æ®åº“é€šä¿¡ç«¯å£ é»˜è®¤åº”å¡«å†™ 27017</td><td>27017</td></tr><tr><td>MONGODB_USER</td><td>MongoDB æ•°æ®åº“ç”¨æˆ·å</td><td>abudu</td></tr><tr><td>MONGODB_DB</td><td>MongoDB æ•°æ®åº“å</td><td>Cluster0</td></tr><tr><td>MONGODB_PASS</td><td>MongoDB æ•°æ®åº“å¯†ç </td><td>password</td></tr></tbody></table><p>åœ¨ Deployments ç‚¹å‡» Redeploy å¼€å§‹éƒ¨ç½², è‹¥æ²¡æœ‰ Error ä¿¡æ¯å³å¯æ‰“å¼€åŸŸåè¿›å…¥åˆå§‹åŒ–å¼•å¯¼</p><p><del>ä¸‹æ–¹å¿½ç•¥</del></p><div class="tabs" id="test4"><ul class="nav-tabs"><li class="tab active"><button type="button" data-href="#test4-1">æ­¤æ ä¸‹æ–¹éƒ¨ç½²æ–¹å¼ä½œåºŸ</button></li><li class="tab"><button type="button" data-href="#test4-2"><i class="fab fa-apple-pay" style="text-align: center;"></i></button></li><li class="tab"><button type="button" data-href="#test4-3"><i class="fas fa-bomb"></i>ç‚¸å¼¹</button></li></ul><div class="tab-contents"><div class="tab-item-content active" id="test4-1"><h4 id="æ¦‚è§ˆï¼š"><a href="#æ¦‚è§ˆï¼š" class="headerlink" title="æ¦‚è§ˆï¼š"></a>æ¦‚è§ˆï¼š</h4><ul><li><p>ä½¿ç”¨Dockerfileæ–‡ä»¶æ„å»ºé•œåƒ</p></li><li><p>å¯åŠ¨å®¹å™¨</p></li><li><p>æ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ</p></li><li><p>åˆ›å»ºæ‰€éœ€ç›®å½•åŠæ–‡ä»¶</p></li><li><p>å¦‚ä¸æƒ³äº†è§£é•œåƒåˆ¶ä½œè¿‡ç¨‹å¯ç›´æ¥ä½¿ç”¨æ­¤docker-compose.ymlæ–‡ä»¶å¯åŠ¨qexoæœåŠ¡<br>é•œåƒå¯é€‰â€œ<strong>registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.0.2</strong>â€<br>docker-compose.ymlæ–‡ä»¶(éœ€è¦ä¿®æ”¹<strong>config.py</strong>æ–‡ä»¶å°†è‡ªå·±çš„æœºå™¨<strong>IP</strong>æˆ–<strong>åŸŸå</strong>åŠ å…¥  |  å…³äº<strong>db.sqlite3</strong>åªéœ€è¦åœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ªåä¸º<strong>db.sqlite3</strong>çš„ç©ºæ–‡ä»¶å³å¯ğŸ˜ )</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">qexo:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.0.2</span> </span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">qexo</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8000:8000&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./db.sqlite3:/app/db/db.sqlite3</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./blog:/app/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./configs.py:/app/configs.py</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="1-åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶"><a href="#1-åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶" class="headerlink" title="1. åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶"></a>1. åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /app/db /app/data</span><br><span class="line"><span class="built_in">touch</span>    /app/db/db.sqlite3</span><br><span class="line"><span class="comment"># åˆ›å»ºDockerfileå·¥ä½œç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /data/qexo</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/qexo/db</span><br><span class="line"><span class="built_in">cd</span> /data/qexo/db &amp;&amp; <span class="built_in">touch</span> db.sqlite3</span><br><span class="line"><span class="comment"># å°†Qexoæºç æ–‡ä»¶ä¸Šä¼ è‡³å·¥ä½œç›®å½• å¹¶æ‰“åŒ…ä¸ºtar.gzæ ¼å¼æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cd</span> /data/qexo &amp;&amp; rz</span><br><span class="line"><span class="comment"># é…ç½®ç¼–æ’æ–‡ä»¶</span></span><br><span class="line">vim Dockerfile</span><br></pre></td></tr></table></figure><p><strong>2. Dockerfileæ–‡ä»¶</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">FROM python:3.11.3-alpine</span><br><span class="line"><span class="comment"># ç»´æŠ¤è€…ä¿¡æ¯</span></span><br><span class="line">LABEL maintainer=<span class="string">&quot;xwgegewu@gmail.com&quot;</span></span><br><span class="line"><span class="comment"># è®¾ç½®ç”Ÿäº§æ¨¡å¼ç¯å¢ƒå˜é‡ </span></span><br><span class="line"><span class="comment"># ENV APP_ENV production</span></span><br><span class="line"><span class="comment"># pipyæºè®¾ç½®</span></span><br><span class="line">RUN pip config <span class="built_in">set</span> global.index-url https://mirrors.cloud.tencent.com/pypi/simple/</span><br><span class="line"><span class="comment"># è®¾ç½®æ—¶åŒº</span></span><br><span class="line">RUN sed -i <span class="string">&#x27;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#x27;</span> /etc/apk/repositories &amp;&amp; \</span><br><span class="line">    apk --no-cache add tzdata &amp;&amp; \</span><br><span class="line">    <span class="built_in">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; \</span><br><span class="line">    apk --no-cache del tzdata &amp;&amp; \</span><br><span class="line">    apk --no-cache add git &amp;&amp; \</span><br><span class="line">    <span class="built_in">mkdir</span> /app</span><br><span class="line"><span class="comment"># è®¾ç½®å·¥ä½œç›®å½•</span></span><br><span class="line">WORKDIR /app</span><br><span class="line"><span class="comment"># æ‹·è´æ•°æ®</span></span><br><span class="line"><span class="comment"># RUN git clone https://github.com/Qexo/Qexo.git /app</span></span><br><span class="line">ADD ./Qexo.tar.gz /app/</span><br><span class="line">RUN <span class="built_in">mv</span> /app/Qexo/* /app/</span><br><span class="line"><span class="comment"># å®‰è£…ä¾èµ–</span></span><br><span class="line">RUN pip install --upgrade pip </span><br><span class="line">RUN apk --no-cache add build-base python3-dev libffi-dev</span><br><span class="line">RUN pip install Django==3.2.18</span><br><span class="line">RUN pip install PyMySQL==1.0.2</span><br><span class="line">RUN pip install boto3==1.26.94</span><br><span class="line">RUN pip install requests==2.28.2</span><br><span class="line">RUN pip install PyGithub==1.58.1</span><br><span class="line">RUN pip install python-gitlab==3.13.0</span><br><span class="line">RUN pip install html2text==2020.1.16</span><br><span class="line">RUN pip install PyYAML</span><br><span class="line">RUN pip install urllib3==1.26.15</span><br><span class="line">RUN pip install Markdown==3.4.1</span><br><span class="line">RUN pip install djongo==1.3.6</span><br><span class="line">RUN pip install django-cors-headers==3.14.0</span><br><span class="line">RUN pip install pymongo==3.13.0</span><br><span class="line">RUN pip install dnspython==2.2.1</span><br><span class="line">RUN pip install sqlparse==0.2.4</span><br><span class="line">RUN pip install psycopg2-binary==2.9.5</span><br><span class="line">RUN pip install cryptography==39.0.2</span><br><span class="line">RUN pip install pyopenssl==23.0.0</span><br><span class="line">RUN pip install oss2==2.17.0</span><br><span class="line">RUN pip install beautifulsoup4==4.11.2</span><br><span class="line"><span class="comment"># æ‹·è´å¯åŠ¨è„šæœ¬</span></span><br><span class="line">COPY . /app/</span><br><span class="line">RUN <span class="built_in">chmod</span> +x /app/run.sh</span><br><span class="line"><span class="comment"># æš´éœ²ç«¯å£</span></span><br><span class="line">EXPOSE 8000</span><br><span class="line"><span class="comment"># æŒ‚è½½ç›®å½•</span></span><br><span class="line">VOLUME [<span class="string">&quot;/app/db&quot;</span>, <span class="string">&quot;/app/data&quot;</span>]</span><br><span class="line"><span class="comment"># å¯åŠ¨django</span></span><br><span class="line">ENTRYPOINT [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;/app/run.sh&quot;</span>]</span><br></pre></td></tr></table></figure><h4 id="3-åœ¨-data-qexoåˆ›å»ºé…ç½®æ–‡ä»¶"><a href="#3-åœ¨-data-qexoåˆ›å»ºé…ç½®æ–‡ä»¶" class="headerlink" title="3. åœ¨/data/qexoåˆ›å»ºé…ç½®æ–‡ä»¶"></a>3. åœ¨/data/qexoåˆ›å»ºé…ç½®æ–‡ä»¶</h4><h5 id="configs-py"><a href="#configs-py" class="headerlink" title="configs.py"></a>configs.py</h5><p><strong>DOMAINS</strong>å¤„éœ€è¦åŠ ä¸Šè‡ªå·±çš„æœ¬æœº<strong>IP</strong>æˆ–è€…<strong>åŸŸå</strong> ç›¸å½“äºè®¾ç½®ç™½åå•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd /data/qexo &amp;&amp; vim configs.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“é…ç½®</span></span><br><span class="line"><span class="keyword">import</span> pymysql,os</span><br><span class="line"></span><br><span class="line">DOMAINS = [<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;10.0.0.10&quot;</span>]</span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.sqlite3&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: os.path.join(<span class="string">&#x27;/app/db&#x27;</span> , <span class="string">&#x27;db.sqlite3&#x27;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="run-sh"><a href="#run-sh" class="headerlink" title="run.sh"></a>run.sh</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">python3 manage.py makemigrations</span><br><span class="line">python3 manage.py migrate</span><br><span class="line">python3 manage.py runserver 0.0.0.0:8000 --noreload</span><br></pre></td></tr></table></figure><h5 id="æ„å»ºdockeré•œåƒ-å¯åŠ¨å®¹å™¨"><a href="#æ„å»ºdockeré•œåƒ-å¯åŠ¨å®¹å™¨" class="headerlink" title="æ„å»ºdockeré•œåƒ å¯åŠ¨å®¹å™¨"></a>æ„å»ºdockeré•œåƒ å¯åŠ¨å®¹å™¨</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»º</span></span><br><span class="line">docker build -t qexo:3.0.2 .</span><br><span class="line"><span class="comment"># å¯åŠ¨å®¹å™¨</span></span><br><span class="line">docker run -d --name qexo -p 8000:8000 -v /data/qexo/db:/app/db -v /data/blog:/app/data qexo:3.0.2</span><br></pre></td></tr></table></figure><h5 id="æŸ¥çœ‹dockeræ—¥å¿—æ˜¯å¦æˆåŠŸè¿è¡Œ"><a href="#æŸ¥çœ‹dockeræ—¥å¿—æ˜¯å¦æˆåŠŸè¿è¡Œ" class="headerlink" title="æŸ¥çœ‹dockeræ—¥å¿—æ˜¯å¦æˆåŠŸè¿è¡Œ"></a>æŸ¥çœ‹dockeræ—¥å¿—æ˜¯å¦æˆåŠŸè¿è¡Œ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">docker logs qexo</span><br><span class="line"></span><br><span class="line">è·å–æœ¬åœ°é…ç½®æ–‡ä»¶æˆåŠŸ, ä½¿ç”¨æœ¬åœ°æ•°æ®åº“é…ç½®</span><br><span class="line">           _               _ </span><br><span class="line">     /\   | |             | |</span><br><span class="line">    /  \  | |__  _   _  __| |_   _ </span><br><span class="line">   / /\ \ | |_ \| | | |/ _| | | | |</span><br><span class="line">  / ____ \| |_) | |_| | (_| | |_| |</span><br><span class="line"> /_/    \_\____/ \____|\____|\____|</span><br><span class="line">å½“å‰ç¯å¢ƒ: æœ¬åœ°</span><br><span class="line">Operations to perform:</span><br><span class="line">  Apply all migrations: auth, contenttypes, hexoweb, sessions</span><br><span class="line">Running migrations:</span><br><span class="line">  No migrations to apply.</span><br><span class="line">[25/Jan/2024 07:11:16] ERROR: Providerè·å–å¤±è´¥, è·³è¿‡(functions.py.&lt;module&gt;[line:55])</span><br><span class="line">[25/Jan/2024 07:11:40] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 302 0</span><br><span class="line">[25/Jan/2024 07:11:40] INFO: æœªæ£€æµ‹åˆ°åˆå§‹åŒ–é…ç½®, è½¬è·³åˆ°åˆå§‹åŒ–é¡µé¢(views.py.login_view[line:40])</span><br><span class="line">[25/Jan/2024 07:11:40] <span class="string">&quot;GET /login/?next=/ HTTP/1.1&quot;</span> 302 0</span><br><span class="line">[25/Jan/2024 07:11:40] INFO: ä¿å­˜è®¾ç½®CDN_PREV =&gt; https://unpkg.com/(functions.py.save_setting[line:259])</span><br><span class="line">[25/Jan/2024 07:11:40] INFO: ä¿å­˜è®¾ç½®QEXO_NAME =&gt; Hexoç®¡ç†é¢æ¿(functions.py.save_setting[line:259])</span><br></pre></td></tr></table></figure><p>æµè§ˆå™¨è®¿é—®: http://æœ¬æœºIP:8000 å®Œæˆå„é¡¹åˆå§‹åŒ–ç­‰é…ç½®ã€‚</p><h4 id="4-æœ€åæ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ-ç•¥-å¹¶ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæ„å»ºå®¹å™¨"><a href="#4-æœ€åæ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ-ç•¥-å¹¶ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæ„å»ºå®¹å™¨" class="headerlink" title="4. æœ€åæ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ(ç•¥)å¹¶ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæ„å»ºå®¹å™¨"></a>4. æœ€åæ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ(ç•¥)å¹¶ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæ„å»ºå®¹å™¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker login ....</span><br><span class="line">docker tag .....</span><br><span class="line">docker push .....</span><br></pre></td></tr></table></figure><h2 id="äºŒã€k8séƒ¨ç½²qexoï¼ˆä½¿ç”¨HostPathå­˜å‚¨ï¼‰"><a href="#äºŒã€k8séƒ¨ç½²qexoï¼ˆä½¿ç”¨HostPathå­˜å‚¨ï¼‰" class="headerlink" title="äºŒã€k8séƒ¨ç½²qexoï¼ˆä½¿ç”¨HostPathå­˜å‚¨ï¼‰"></a>äºŒã€k8séƒ¨ç½²qexoï¼ˆä½¿ç”¨HostPathå­˜å‚¨ï¼‰</h2><p>åˆ›å»ºé…ç½®æ–‡ä»¶å¤¹ç›®å½•ï¼š/opt/qexo/app/db</p><p>åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•ï¼š  /opt/qexo/app/db/db.sqlite3</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mysqlé…ç½®</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ConfigMap</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">qexo-py</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">data:</span></span><br><span class="line">  <span class="attr">configs.py:</span> <span class="string">|</span></span><br><span class="line"><span class="string">    # æ•°æ®åº“é…ç½®</span></span><br><span class="line"><span class="string">    import pymysql,os</span></span><br><span class="line"><span class="string"></span>  </span><br><span class="line">    <span class="string">DOMAINS</span> <span class="string">=</span> [<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;10.0.0.10&quot;</span>]</span><br><span class="line">    <span class="string">DATABASES</span> <span class="string">=</span> &#123;</span><br><span class="line">        <span class="attr">&#x27;default&#x27;:</span> &#123;</span><br><span class="line">            <span class="attr">&#x27;ENGINE&#x27;:</span> <span class="string">&#x27;django.db.backends.sqlite3&#x27;</span>,</span><br><span class="line">            <span class="attr">&#x27;NAME&#x27;:</span> <span class="string">os.path.join(&#x27;/app/db&#x27;</span> , <span class="string">&#x27;db.sqlite3&#x27;</span><span class="string">)</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># qexo  </span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">apps/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">StatefulSet</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">qexo</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">matchLabels:</span></span><br><span class="line">      <span class="attr">app:</span> <span class="string">qexo</span> <span class="comment"># has to match .spec.template.metadata.labels</span></span><br><span class="line">  <span class="attr">serviceName:</span> <span class="string">&quot;qexo&quot;</span></span><br><span class="line">  <span class="attr">replicas:</span> <span class="number">1</span> <span class="comment"># by default is 1               # 3å‰¯æœ¬</span></span><br><span class="line">  <span class="comment"># minReadySeconds: 10 # by default is 0</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">metadata:</span></span><br><span class="line">      <span class="attr">labels:</span></span><br><span class="line">        <span class="attr">app:</span> <span class="string">qexo</span> <span class="comment"># has to match .spec.selector.matchLabels</span></span><br><span class="line">    <span class="attr">spec:</span></span><br><span class="line">      <span class="attr">terminationGracePeriodSeconds:</span> <span class="number">10</span></span><br><span class="line">      <span class="attr">containers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qexo</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.0.2</span> </span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">containerPort:</span> <span class="number">8000</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">qexo</span></span><br><span class="line">        <span class="attr">volumeMounts:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qexo-volume</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">/app/db/db.sqlite3</span> </span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qexo-py</span></span><br><span class="line">          <span class="attr">mountPath:</span> <span class="string">&quot;/app/configs.py&quot;</span></span><br><span class="line">          <span class="attr">subPath:</span> <span class="string">configs.py</span></span><br><span class="line">      <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qexo-volume</span></span><br><span class="line">        <span class="attr">hostPath:</span> </span><br><span class="line">          <span class="attr">path:</span> <span class="string">/opt/qexo/app/db/db.sqlite3</span>      <span class="comment"># å®¿ä¸»æœºç›®å½•  </span></span><br><span class="line">          <span class="attr">type:</span> <span class="string">FileOrCreate</span>                     <span class="comment"># ç›®å½•å­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±å…ˆåˆ›å»ºåä½¿ç”¨</span></span><br><span class="line">      <span class="comment"># å®šä¹‰ ConfigMap ç±»å‹çš„ Volume</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">qexo-py</span></span><br><span class="line">        <span class="attr">configMap:</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">qexo-py</span>  <span class="comment"># å¼•ç”¨åä¸º mysql-cm çš„ ConfigMap</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># æš´éœ²webstackç«¯å£</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Service</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">dev</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">qexo-service</span></span><br><span class="line"><span class="attr">spec:</span></span><br><span class="line">  <span class="attr">selector:</span></span><br><span class="line">    <span class="attr">app:</span> <span class="string">qexo</span></span><br><span class="line">  <span class="attr">ports:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">protocol:</span> <span class="string">TCP</span></span><br><span class="line">      <span class="attr">port:</span> <span class="number">8000</span></span><br><span class="line">      <span class="attr">targetPort:</span> <span class="number">8000</span></span><br><span class="line">  <span class="attr">sessionAffinity:</span> <span class="string">ClientIP</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">NodePort</span> <span class="comment"># å°†æœåŠ¡æš´éœ²ä¸º NodePort ç±»å‹</span></span><br></pre></td></tr></table></figure><p>æ‰©å±•ç¼–è¾‘æŒ‚è½½ä¸Šå»çš„configmapæ–‡ä»¶ï¼š</p><ul><li>kubectl get cm -n dev</li><li>kubectl edit cm qexo-py -n dev</li></ul><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-2"><p><strong>åªæœ‰å›¾æ ‡ æ²¡æœ‰Tabåå­—</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div><div class="tab-item-content" id="test4-3"><p><strong>åå­—+icon</strong></p><button type="button" class="tab-to-top" aria-label="scroll to top"><i class="fas fa-arrow-up"></i></button></div></div></div>]]></content>
      
      
      <categories>
          
          <category> qexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> qexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos7é‡ç½®å¯†ç </title>
      <link href="/2024/01/24/centos7%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/"/>
      <url>/2024/01/24/centos7%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>centos7é‡ç½®å¯†ç </strong></p><h4 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h4><p><a href="https://blog.csdn.net/gnail_oug/article/details/94721777">https://blog.csdn.net/gnail_oug/article/details/94721777</a></p><h4 id="ç¯å¢ƒï¼š"><a href="#ç¯å¢ƒï¼š" class="headerlink" title="ç¯å¢ƒï¼š"></a>ç¯å¢ƒï¼š</h4><p>centos7.6 / 7.9 é‡ç½®å¯†ç </p><h4 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h4><p>å½“<strong>root</strong>å¯†ç å¿˜äº†ä¹‹åï¼Œå¯ä»¥é€šè¿‡é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºæ—¶é‡æ–°è®¾ç½®å¯†ç ã€‚æ³¨ï¼šæµ‹è¯•ç‰ˆæœ¬ä¸º**CentOS Linux release 7.6.1810 (Core)**ï¼Œå…¶ä»–ç‰ˆæœ¬å¯èƒ½æœ‰äº›åŒºåˆ«ã€‚</p><h4 id="é‡ç½®å¯†ç "><a href="#é‡ç½®å¯†ç " class="headerlink" title="é‡ç½®å¯†ç "></a>é‡ç½®å¯†ç </h4><h5 id="1ã€é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºè¿‡ç¨‹ä¸­ï¼Œå‡ºç°ä»¥ä¸‹ç•Œé¢æ—¶æŒ‰eé”®ï¼Œè¿›å…¥ç¼–è¾‘ç•Œé¢"><a href="#1ã€é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºè¿‡ç¨‹ä¸­ï¼Œå‡ºç°ä»¥ä¸‹ç•Œé¢æ—¶æŒ‰eé”®ï¼Œè¿›å…¥ç¼–è¾‘ç•Œé¢" class="headerlink" title="1ã€é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºè¿‡ç¨‹ä¸­ï¼Œå‡ºç°ä»¥ä¸‹ç•Œé¢æ—¶æŒ‰eé”®ï¼Œè¿›å…¥ç¼–è¾‘ç•Œé¢"></a>1ã€é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºè¿‡ç¨‹ä¸­ï¼Œå‡ºç°ä»¥ä¸‹ç•Œé¢æ—¶æŒ‰eé”®ï¼Œè¿›å…¥ç¼–è¾‘ç•Œé¢</h5><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_56eb784c63c8b82f62e62f1b5752d680.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_56eb784c63c8b82f62e62f1b5752d680.png"></p><h5 id="2ã€ä¿®æ”¹é…ç½®ä¿®æ”¹å¯†ç "><a href="#2ã€ä¿®æ”¹é…ç½®ä¿®æ”¹å¯†ç " class="headerlink" title="2ã€ä¿®æ”¹é…ç½®ä¿®æ”¹å¯†ç "></a>2ã€ä¿®æ”¹é…ç½®ä¿®æ”¹å¯†ç </h5><ul><li>æŒ‰æ–¹å‘é”®ä¸‹é”®â†“ï¼Œæ‰¾åˆ°è®¾ç½®è¯­è¨€çš„åœ°æ–¹ï¼Œå¦‚<strong>LANG=en_US.UTF-8</strong> åœ¨åé¢è¿½åŠ <strong>rw single init=/bin/bash,<strong>ç„¶åæŒ‰</strong>ctrl+x</strong>é‡å¯ç³»ç»Ÿ</li><li>è¿›å…¥<strong>bash</strong>ç•Œé¢åï¼Œå¯ä»¥è¾“å…¥<strong>passwd</strong>å‘½ä»¤é‡æ–°è®¾ç½®<strong>root</strong>å¯†ç </li><li>å¦‚æœå¼€å¯äº†<strong>SELinux</strong>ï¼Œæ‰§è¡Œå‘½ä»¤<strong>touch /.autorelabel</strong>å‘½ä»¤</li><li>è¾“å…¥<strong>exec /sbin/init</strong>å‘½ä»¤é‡å¯ç³»ç»Ÿ ä½¿ç”¨æ–°è®¾ç½®çš„å¯†ç è¿›å…¥ç³»ç»Ÿä¹‹åï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼Œå¯ä»¥è¾“å…¥<strong>reboot</strong>é‡æ–°å¯åŠ¨ä¸€æ¬¡ç³»ç»Ÿã€‚</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5f98f5afcf72816ec0aeff6ad4f81deb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5f98f5afcf72816ec0aeff6ad4f81deb.png"></p><p>æ­¤æ—¶æˆåŠŸï¼</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxå¸¦å®½ç½‘å¡æµé‡ç›‘æ§å·¥å…·nethogsä½¿ç”¨</title>
      <link href="/2024/01/22/linux%E5%B8%A6%E5%AE%BD%E7%BD%91%E5%8D%A1%E6%B5%81%E9%87%8F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7nethogs%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/01/22/linux%E5%B8%A6%E5%AE%BD%E7%BD%91%E5%8D%A1%E6%B5%81%E9%87%8F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7nethogs%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>linuxå¸¦å®½ç½‘å¡æµé‡ç›‘æ§å·¥å…·nethogsä½¿ç”¨</strong></p><p>å‰è¨€ï¼š</p><p>æ­¤å‰åœ¨å¦å¤–ä¸€ç¯‡åšå®¢é‡Œé¢ä»‹ç»äº†å¦ä¸€æµ‹é€Ÿå·¥å…·<a href="https://gegewu-cloud.github.io/2023/07/14/speedtest-%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E5%B8%A6%E5%AE%BD/?highlight=speed">speedtest</a>ä¸å°‘å°ä¼™ä¼´åé¦ˆè¯´æµ‹é€Ÿä¸å‡†ç¡® æœ¬æ¬¡ä»‹ç»å¦ä¸€å·¥å…·<a href="%5BLinux%E5%B7%A5%E5%85%B7%E4%B9%8Bnethogs%E5%91%BD%E4%BB%A4-CSDN%E5%8D%9A%E5%AE%A2%5D(https://blog.csdn.net/carefree2005/article/details/124199604)">nethogs</a>  å„ç§ç½‘ç»œæµé‡ç›‘æ§å·¥å…· &gt; <a href="https://gegewu-cloud.github.io/2023/11/23/linux%E6%8E%92%E6%9F%A5%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98%E5%B8%B8%E7%94%A8CMD%E6%80%BB%E7%BB%93/">ä¼ é€</a></p><h3 id="ä¸€-å®‰è£…"><a href="#ä¸€-å®‰è£…" class="headerlink" title="ä¸€. å®‰è£…"></a>ä¸€. å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install - y nethogs</span><br></pre></td></tr></table></figure><h3 id="äºŒ-ä½¿ç”¨"><a href="#äºŒ-ä½¿ç”¨" class="headerlink" title="äºŒ. ä½¿ç”¨"></a>äºŒ. ä½¿ç”¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å¸®åŠ©</span></span><br><span class="line">nethogs -h</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ç‰ˆæœ¬</span></span><br><span class="line">nethogs -v</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nethogså‘½ä»¤é»˜è®¤ç›‘æ§æ‰€æœ‰ç‰©ç†ç½‘å¡ï¼Œå¯ä»¥åé¢æ¥å£ç½‘å¡åç§°æ–¹å¼æŒ‡å®šç›‘æ§æŸç½‘å¡æµé‡ï¼Œå¯ä»¥æ¥å¤šä¸ªç½‘å¡åç§°ï¼Œç½‘å¡ä¹‹é—´ç©ºæ ¼éš”å¼€</span></span><br><span class="line">nethogs eth0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç›‘æ§æ—¶åˆ·æ–°é¢‘ç‡3ç§’æ€»è®¡2æ¬¡</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é»˜è®¤åˆ·æ–°é¢‘ç‡é—´éš”1ç§’ï¼Œåˆ·æ–°æ¬¡æ•°ä¸é™åˆ¶ç›´åˆ°ä¸»åŠ¨ç»“æŸè¿›ç¨‹æˆ–è€…é€€å‡ºã€‚</span></span><br><span class="line">nethogs -d 3 -c 2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‰ç…§MBæµé‡æ ¼å¼æ˜¾ç¤ºæ¨¡å¼æ˜¾ç¤º</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‡å®šç½‘å¡æµé‡æ˜¾ç¤ºå•ä½ï¼Œé»˜è®¤KBï¼Œ(0 = KB/s, 1 = total KB, 2 = total B, 3 = total MB)</span></span><br><span class="line">nethogs -v 3</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç›‘æ§æ‰€æœ‰ç½‘å¡æµé‡</span></span><br><span class="line">nethogs -a</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-tè¡¨ç¤ºå¯ç”¨è¿½è¸ªæ¨¡å¼ï¼Œå¯ä»¥è®°å½•æ¯ä¸€æ¬¡çš„å€¼ï¼Œä¹Ÿå¯ä»¥ç»“åˆå…¶ä»–å‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚</span></span><br><span class="line">nethogs -t -d 10 -c 5</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-ä½¿ç”¨è¯­æ³•åŠå‚æ•°è¯´æ˜"><a href="#ä¸‰-ä½¿ç”¨è¯­æ³•åŠå‚æ•°è¯´æ˜" class="headerlink" title="ä¸‰. ä½¿ç”¨è¯­æ³•åŠå‚æ•°è¯´æ˜"></a>ä¸‰. ä½¿ç”¨è¯­æ³•åŠå‚æ•°è¯´æ˜</h3><p>ä½¿ç”¨è¯­æ³•<br>ç”¨æ³•ï¼šnethogs [å‚æ•°] [device]</p><p>å‚æ•°    å‚æ•°è¯´æ˜<br>-V    æ‰“å°å‘½ä»¤ç‰ˆæœ¬<br>-h    æ‰“å°å¸®åŠ©<br>-b    bughuntæ¨¡å¼<br>-d    æŒ‡å®šæ˜¾ç¤ºåˆ·æ–°é¢‘ç‡ï¼Œå•ä½ç§’ï¼Œé»˜è®¤1ç§’<br>-v    æŒ‡å®šæµé‡å•ä½æ¨¡å¼(0 = KB/s, 1 = total KB, 2 = total B, 3 = total MB)<br>-c    è®¾ç½®åˆ·æ–°æ›´æ–°æ¬¡æ•°<br>-t    tracemodeæ¨¡å¼ï¼Œå¯ä»¥è®°å½•ä¸‹æ¯ä¸€æ¬¡åˆ·æ–°çš„æµé‡å€¼<br>-p    æ··æ‚æ¨¡å¼ä¸‹ç›‘å¬æµé‡ï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰<br>-s    æŒ‰ç…§å‘é€æµé‡æ’åºè¾“å‡º<br>-a    ç›‘æ§æ‰€æœ‰ç½‘å¡ç«¯å£ï¼ŒåŒ…æ‹¬ç¯å›æ¥å£<br>è¿è¡Œæ¨¡å¼ä¸‹æŒ‰é”®è¯´æ˜<br>æŒ‰é”®    æŒ‰é”®è¯´æ˜<br>q    é€€å‡º<br>s    æŒ‰ç…§å‘é€æµé‡æ’åº<br>r    æŒ‰ç…§æ¥å—æµé‡æ’åº<br>m    åˆ‡æ¢ç«¯å£æµé‡å•ä½æ˜¾ç¤ºæ¨¡å¼åœ¨B,KB,MBä¹‹é—´æµé‡åˆ‡æ¢</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰©ç†æœåŠ¡å™¨ç»“æ„å›¾</title>
      <link href="/2024/01/17/%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%93%E6%9E%84%E5%9B%BE/"/>
      <url>/2024/01/17/%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%93%E6%9E%84%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>ç‰©ç†æœåŠ¡å™¨ç»“æ„å›¾</strong></p><p><strong>æ¦‚è§ˆğŸ‰ ï¼š</strong></p><p>å¤–è§‚æ¥å£</p><p>äº§å“å†…éƒ¨ç»“æ„</p><div class="gallery">    <div class="fj-gallery  data" data-rowheight="220" data-limit="10">    <span class="gallery-data">[{"url":"https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_e55ad4914ecc2115cae8f66c70a4d2ce.png","alt":""},{"url":"https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_0719498ab66e6038ecc45c5d21398f75.png","alt":""},{"url":"https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_30518c76a3cbacc8c7bfb54189ee5695.png","alt":""}]</span>    </div>    <button class="gallery-load-more"><span>Load More</span><i class="fa-solid fa-arrow-down"></i></button>    </div>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å°ç«™ç®€ä»‹</title>
      <link href="/2024/01/17/%E6%9C%AC%E7%AB%99%E8%AF%B4%E6%98%8E/"/>
      <url>/2024/01/17/%E6%9C%AC%E7%AB%99%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å°ç«™ç®€ä»‹ğŸŒ™"><a href="#å°ç«™ç®€ä»‹ğŸŒ™" class="headerlink" title="å°ç«™ç®€ä»‹ğŸŒ™"></a>å°ç«™ç®€ä»‹ğŸŒ™</h1><p>æœ¬ç«™ä¸º<a href="https://gegewu-cloud.github.io/">ZzNnWn.</a>åšä¸»æ–°å¼€åšå®¢ æœ¬ç«™ä½¿ç”¨å›¾åºŠBlazeb2åŠGithubå›¾åºŠ</p><p>ä¹‹å‰ä¸€ç›´ä½¿ç”¨<del>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</del>çš„æ–¹å¼å†™ä½œç®¡ç†åšå®¢ ä¸æ˜¯å¾ˆæ–¹ä¾¿æœ‰æ—¶å€™ä¼šå‡ºç°<strong>hexo d</strong>æŠ¥é”™çš„ç°è±¡  åŠ ä¹‹åšå®¢ç¯‡æ•°å¤ªå¤šåå¯¼è‡´ æ¯æ¬¡æ‰§è¡ŒæŸè€—æ—¶é—´è¿‡é•¿ ä¸€ç›´åœ¨å¯»æ‰¾è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³• ä¸­é€”å·®ç‚¹æ”¾å¼ƒä½¿ç”¨hexo  ä¸€æ¬¡å¶ç„¶çš„æœºä¼š äº†è§£åˆ°<a href="http://sunlight.zznnwn.cloudns.biz/2024/01/16/hexo-butterfly-Qexo%E5%90%8E%E7%AB%AFgithub%E8%87%AA%E5%8A%A8%E5%8C%96.md/">Qexo</a>è¿™ä¸ªæå…¶å¥½ç”¨çš„ç®¡ç†hexoçš„å·¥å…·å‡ ç•ªå°è¯•åå†³å®šæ–°å¼€ä¸€åšå®¢<a href="http://sunlight.zznnwn.cloudns.biz/">ç²˜äººçš„é¸­å˜´å…½. </a> åˆè¡· ç”¨äºè®°å½•æ—¥å¸¸ æœ¬ç«™æŠ€æœ¯ç±»æ–‡ç« è¾ƒå°‘ æŠ€æœ¯ç±»æ–‡ç« åœ¨åšä¸»å¦ä¸€å°ç«™<a href="https://gegewu-cloud.github.io/">ZzNnWn.</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_5b853d0d15aa45c9015e5066614ecc8f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/9/image_5b853d0d15aa45c9015e5066614ecc8f.png"></p><p>ç«™ç‚¹åˆå§‹é“¾æ¥ï¼š<a href="http://sunlight.zznnwn.cloudns.biz/">zznn-cloudåšå®¢</a><br>æ‰˜ç®¡åŸŸååœ°å€ï¼š<a href="http://sunlight.zznnwn.cloudns.biz/">http://sunlight.zznnwn.cloudns.biz/</a></p>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux-aliasæ–¹å¼é˜²æ­¢æ ¹ç›®å½•è¯¯åˆ </title>
      <link href="/2024/01/16/linux-alias%E6%96%B9%E5%BC%8F%E9%98%B2%E6%AD%A2%E6%A0%B9%E7%9B%AE%E5%BD%95%E8%AF%AF%E5%88%A0/"/>
      <url>/2024/01/16/linux-alias%E6%96%B9%E5%BC%8F%E9%98%B2%E6%AD%A2%E6%A0%B9%E7%9B%AE%E5%BD%95%E8%AF%AF%E5%88%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>linux-aliasæ–¹å¼é˜²æ­¢æ ¹ç›®å½•è¯¯åˆ ï¼ˆæœ¬æ–‡æ¡£æœªæµ‹è¯•ï¼‰</strong></p><p>å‚è€ƒï¼š</p><ul><li><a href="http://www.opstool.com/article/179">http://www.opstool.com/article/179</a></li><li><a href="https://steemit.com/cn/@oflyhigh/sudo-rm-rf">https://steemit.com/cn/@oflyhigh/sudo-rm-rf</a></li><li><a href="https://zhuanlan.zhihu.com/p/106066854">https://zhuanlan.zhihu.com/p/106066854</a></li></ul><p>rmæ˜¯ä¸€ä¸ªå±é™©çš„å‘½ä»¤ï¼Œä¸ºäº†é˜²æ­¢rm /è¿™æ ·çš„æ“ä½œå‘ç”Ÿã€‚æˆ‘ä»¬å¯ä»¥åœ¨ç”¨æˆ·çš„å®¶ç›®å½•çš„.bashrcé‡Œå°†rm alisaä¸€ä¸‹ï¼ŒåŠ ä¸Šâ€“preserve-rootè¿™ä¸ªå‚æ•°ã€‚å…¶å®é™¤äº†rmå¤–ï¼Œå¦å¤–å‡ ä¸ªå‘½ä»¤ä¹Ÿéœ€è¦è°¨æ…ï¼Œå¦‚chgrpã€chownã€chmodæ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨.bashrcé‡ŒåŠ å…¥å¦‚ä¸‹aliasï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> <span class="built_in">chgrp</span>=<span class="string">&#x27;chgrp --preserve-root&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">chown</span>=<span class="string">&#x27;chown --preserve-root&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">chmod</span>=<span class="string">&#x27;chmod --preserve-root&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">rm</span>=<span class="string">&#x27;rm -i --preserve-root&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è¯¦ç»†è§£é‡Šä¹‹æ ¹ç›®å½•ä¿æŠ¤</strong></p><p>æœ‰ä¸€å®šç»éªŒçš„ç³»ç»Ÿç®¡ç†å‘˜å¯èƒ½è¿™ä¸ªæ—¶å€™ä¼šæƒ³èµ·æ¥ï¼Œ<code>rm</code> å‘½ä»¤æœ‰ä¸€å¯¹ä¸“é—¨é’ˆå¯¹æ ¹ç›®å½•çš„é€‰é¡¹ <code>--preserve-root</code> å’Œ <code>--no-preserve-root</code> ã€‚è¿™å¯¹é€‰é¡¹çš„æ„æ€æ˜¯ï¼š</p><ul><li><code>--preserve-root</code>ï¼šä¿æŠ¤æ ¹ç›®å½•ï¼Œè¿™æ˜¯é»˜è®¤è¡Œä¸ºã€‚</li><li><code>--no-preserve-root</code>ï¼šä¸ä¿æŠ¤æ ¹ç›®å½•ã€‚</li></ul><p>è¿™å¯¹é€‰é¡¹æ˜¯åæ¥æ·»åŠ åˆ° <code>rm</code> å‘½ä»¤çš„ã€‚å¯èƒ½å‡ ä¹æ¯ä¸ªç³»ç»Ÿç®¡ç†å‘˜éƒ½çŠ¯è¿‡æ“ä½œé”™è¯¯ï¼Œè€Œè¿™å…¶ä¸­åˆ é™¤è¿‡æ ¹ç›®å½•çš„æ¯”æ¯”çš†æ˜¯ï¼ˆæˆ‘å°±æ˜¯ä¸€ä¸ªï¼‰ã€‚å‡ºç°è¿™ç§æƒ…å†µçš„åŸå› æœ‰å‡ ç§ï¼š</p><ul><li>è¾“å…¥æ‰‹è¯¯ï¼šæ¯”å¦‚æœ¬æ¥æƒ³è¾“å…¥ <code>rm /tmp/test.txt</code>ï¼Œç»“æœä¸å°å¿ƒé”®ç›˜æ‰“çš„é£èµ·ï¼Œå¤šè¾“å…¥äº†ä¸€ä¸ªç©ºæ ¼å˜æˆï¼š <code>rm / tmp/test.txt</code> ã€‚çœ‹åˆ°æ ¹ç›®å½•ï¼ˆ<code>/</code>ï¼‰åé¢çš„ç©ºæ ¼äº†ä¹ˆï¼Ÿï¼â€”â€”è¿™å°±æ˜¯æˆ‘å½“å‰è‡ªå·±äº²æ‰‹çŠ¯è¿‡çš„é”™è¯¯ï¼Œè€Œä¸”æ˜¯åœ¨ç”Ÿäº§æœåŠ¡å™¨ä¸Šã€‚</li><li>æœªæ­£ç¡®åˆå§‹åŒ–æˆ–å‘½åé”™è¯¯çš„ shell è„šæœ¬å˜é‡ï¼šæ¯”å¦‚åœ¨è„šæœ¬ä¸­ï¼Œ<code>rm -rf /$&#123;tmp_dir&#125;</code>ï¼Œå¦‚æœæ— è®ºæ˜¯ <code>tmp_dir</code> å˜é‡æ²¡æœ‰æ­£ç¡®èµ‹å€¼è¿˜æ˜¯è¾“å…¥é”™è¯¯ï¼ˆåŸæœ¬æˆ–è®¸æ˜¯ <code>tmpdir</code> ï¼Ÿï¼‰ï¼Œé‚£ä¼šå¯¼è‡´ä»€ä¹ˆï¼Ÿå½“ç„¶æ˜¯åˆ é™¤æ ¹ç›®å½•å’¯~</li></ul><p>é‰´äºè¿™ç§æƒ…å†µå±‚å‡ºä¸ç©·ï¼Œåœ¨ Linux åœˆå­å‡ ä¹å’Œâ€œåˆå­¦è€…å¦‚ä½•é€€å‡º viâ€ ä¸€æ ·æˆä¸ºç»å…¸ç¬‘è¯äº†ã€‚æ‰€ä»¥ï¼Œåœ¨ POSIX ç¬¬ä¸ƒç‰ˆè§„èŒƒä¸­ï¼Œ<code>rm</code> å‘½ä»¤<a href="https://link.zhihu.com/?target=http://pubs.opengroup.org/onlinepubs/9699919799/utilities/rm.html">æ·»åŠ </a>äº† <code>--preserve-root</code> é€‰é¡¹ï¼Œå¹¶å°†å…¶ä½œä¸ºé»˜è®¤è¡Œä¸ºï¼Œä»¥é™ä½å‡ºç°è¿™ç§é”™è¯¯çš„å¯èƒ½ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ä¸ªé€‰é¡¹ä¸èƒ½é˜²èŒƒæœ¬æ–‡ä¸­æ‰€è¿°çš„æ¸…é™¤æ ¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼ˆ<code>/*</code>ï¼‰çš„æ“ä½œã€‚</p><p>æœ‰çš„åŒå­¦å¯èƒ½è¦é—®ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜ä¼šä¸“é—¨å‡ºç° <code>--no-preserve-root</code> é€‰é¡¹å‘¢ï¼Ÿè¿™å¯èƒ½ä¸»è¦æ˜¯å‡ºäº UNIX å“²å­¦çš„è€ƒè™‘ï¼Œç»™äºˆä½ æƒ³è¦çš„ä¸€åˆ‡æƒåŠ›ï¼ŒçŠ¯å‚»æ˜¯ä½ çš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿçš„äº‹æƒ…ã€‚ä¸‡ä¸€ï¼Œä½ çœŸçš„æƒ³åˆ é™¤æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å‘¢ï¼Ÿ</p><p>ä½ è¿˜åˆ«è¯´ï¼ŒçœŸæœ‰è¿™ç§éœ€æ±‚ï¼šæ¯”å¦‚ä½ è¦æ¸…é™¤ä¸€ä¸ª chroot ç¯å¢ƒä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚ chroot æˆ‘ä»¬è¿™é‡Œä¸å¤šè®²ï¼Œå®ƒå°±æ˜¯ä»¥ä¸€ä¸ªç›®å½•ä½œä¸ºâ€œç›‘ç‹±â€ï¼Œè¯¥ç›®å½•åœ¨é€»è¾‘ä¸Šå½¢æˆäº†æ–°çš„â€œæ ¹ç›®å½•â€ï¼Œåœ¨è¯¥ç›‘ç‹±å†…çš„æ–‡ä»¶æ“ä½œä¸èƒ½è·¨å‡ºè¯¥ç›®å½•èŒƒç•´ã€‚è¿‘äº›å¹´æµè¡Œçš„ Dockerã€LXC/LXD ä¹‹ç±»çš„å®¹å™¨æŠ€æœ¯ï¼Œéƒ½æ˜¯ä¸€ç§ chroot æŠ€æœ¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo-butterfly-Qexoåç«¯githubè‡ªåŠ¨åŒ–</title>
      <link href="/2024/01/16/hexo-butterfly-Qexo%E5%90%8E%E7%AB%AFgithub%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
      <url>/2024/01/16/hexo-butterfly-Qexo%E5%90%8E%E7%AB%AFgithub%E8%87%AA%E5%8A%A8%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>hexo+butterfly+Qexoåç«¯+githubè‡ªåŠ¨åŒ–</strong>ğŸ‘</p><p>å‚è€ƒï¼š</p><p><a href="https://www.oplog.cn/qexo/">https://www.oplog.cn/qexo/</a>                      ï¼ˆå®˜ç½‘ï¼‰<br><a href="https://blog.kwxos.top/posts/18807.html">https://blog.kwxos.top/posts/18807.html</a> ï¼ˆåªæ­¤ä¸€ç¯‡å³å¯ğŸ‘ ï¼‰<br><a href="https://blog.syize.cn/2024/12/04/hexo-github-actions/">ä½¿ç”¨GitHubçš„Actionè‡ªåŠ¨ç”Ÿæˆå’Œéƒ¨ç½²Hexoåšå®¢ | Syize ã® blog</a></p><p>æ¦‚è§ˆï¼š</p><p>ï¼ˆåªéœ€è¦githubæ•´ä½“è®¾ç½®åˆ›å»ºtokenåé…ç½®actionå¡«å…¥tokenåœ¨autodeploy.ymlæ–‡ä»¶ä¸­å³å¯å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼‰</p><ul><li><p>æ–°å»ºä¸¤ä¸ªä»“åº“ä¸€ä¸ªæ”¾åšå®¢æºæ–‡ä»¶ ä¸€ä¸ªå­˜æ”¾é™æ€æ–‡ä»¶<br>å­˜æ”¾æºæ–‡ä»¶ä»“åº“ï¼š<a href="https://github.com/zznn-cloud/qexo-blog-source">qexo-blog-source</a>æ­¤ä»“åº“éœ€è®¾ç½®ä¸ºç§æœ‰<br>å­˜æ”¾é™æ€æ–‡ä»¶ä»“åº“ï¼šzznn-cloud.github.io æ­¤ä»“åº“å…¬å¼€</p></li><li><p>å¸¸è§„éƒ¨ç½²æ–¹å¼hexo clean &amp;&amp; hexo g &amp;&amp; hexo då°†é™æ€æ–‡ä»¶æ¨é€åˆ°ä»“åº“zznn-cloud.github.io</p></li><li><p>ä½¿ç”¨Gitã€vscodeæˆ–è€…githubè‡ªå¸¦çš„appç­‰å·¥å…·å°†åšå®¢æºæ–‡ä»¶æ¨é€åˆ°ä»“åº“qexo-blog-source<br>æ¨èä½¿ç”¨githubè‡ªå¸¦çš„app<br>ä½¿ç”¨å‚è€ƒï¼š<a href="https://www.cnblogs.com/chuqianyu/p/14185992.html">é€šè¿‡GitHub Desktop ä¸Šä¼ ä»£ç åˆ°github è¿œç¨‹ä»“åº“ - æ¥šåƒç¾½ - åšå®¢å›­ (cnblogs.com)</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_69e9fe2fb3567df1fc4753addd7aa446.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/25/1/image_69e9fe2fb3567df1fc4753addd7aa446.png"></p></li><li><p>æºæ–‡ä»¶ä»“åº“qexo-blog-source <strong>.github</strong>ä¸‹æ–°å»ºGithub Actioné…ç½®æ–‡ä»¶</p></li><li><p>ä½¿ç”¨Verceléƒ¨ç½²qexoç®¡ç†åšå®¢</p></li><li><p>æµè§ˆå™¨è®¿é—®zznn-cloud.github.io æ­¤æ—¶éƒ¨ç½²å®Œæˆ</p></li></ul><blockquote><p>~~note: å…³äºåšå®¢å¦‚ä½•æ­å»ºåŠGithub pageså¦‚ä½•ä½¿ç”¨ç›¸å¯¹ç®€å•æœ¬æ–‡ä¸åšä»‹ç»~</p><p>æœ€ç®€æ–¹å¼éƒ¨ç½²åˆ©ç”¨åšä¸»å…¬å¼€çš„æºç ä»“åº“ï¼š</p><p><a href="https://github.com/zznn-cloud/blog_easy_client">https://github.com/zznn-cloud/blog_easy_client</a></p></blockquote><h2 id="ä¸€-ä¸¤ä¸ªä»“åº“é…ç½®"><a href="#ä¸€-ä¸¤ä¸ªä»“åº“é…ç½®" class="headerlink" title="ä¸€. ä¸¤ä¸ªä»“åº“é…ç½®"></a>ä¸€. ä¸¤ä¸ªä»“åº“é…ç½®</h2><ol><li><p><a href="https://wn-apple-teawine.fun/2023/08/12/hexo%E4%B8%8Egithub%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/#%E5%8D%81-butterfly%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE">å…¬å¼€ä»“åº“zznn-cloud.github.ioé™æ€æ–‡ä»¶æ¨é€è¾ƒä¸ºç®€å•æ­¤å¤„ç•¥</a></p></li><li><p><strong>github-token</strong>ç”Ÿæˆæ­¤<code>token</code>å¡«å…¥ä¸‹æ–¹<code>action</code>é…ç½®æ–‡ä»¶(é…ç½®æ°¸ä¸è¿‡æœŸä»¥åŠä¸‹æ–¹æƒé™)</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/86b145ca-5730-4187-836e-00aad670b76d.png"></p></li><li><p>ç§æœ‰ä»“åº“<strong>qexo-blog-source</strong>åªéœ€è¦<strong>push</strong>ä¸‹æ–¹æ–‡ä»¶å³å¯</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/5ff789ab-8d59-4a54-b2a2-aeec9ba423b4.png"></p></li><li><p>ç§æœ‰ä»“åº“.githubç›®å½•æ–°å»ºé…ç½®æ–‡ä»¶å¦‚ä¸‹</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/6eb998ca-bee5-4b26-9286-86d3ba8ea862.png"></p><p>é…ç½®å¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">è‡ªåŠ¨éƒ¨ç½²</span></span><br><span class="line"><span class="comment"># å½“æœ‰æ”¹åŠ¨æ¨é€åˆ°mainåˆ†æ”¯æ—¶ï¼Œå¯åŠ¨Action</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">main</span></span><br><span class="line">      <span class="comment">#2020å¹´10æœˆågithubæ–°å»ºä»“åº“é»˜è®¤åˆ†æ”¯æ”¹ä¸ºmainï¼Œæ³¨æ„æ›´æ”¹</span></span><br><span class="line">  <span class="attr">release:</span></span><br><span class="line">    <span class="attr">types:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">published</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">æ£€æŸ¥åˆ†æ”¯</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">ref:</span> <span class="string">main</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">å®‰è£…</span> <span class="string">Node</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&quot;16.x&quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">å®‰è£…</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          export TZ=&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line"><span class="string">          npm install hexo-cli -g</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ç¼“å­˜</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">cache-npm</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v3</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">cache-name:</span> <span class="string">cache-node-modules</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.os</span> <span class="string">&#125;&#125;-build-$&#123;&#123;</span> <span class="string">env.cache-name</span> <span class="string">&#125;&#125;-$&#123;&#123;</span> <span class="string">hashFiles(&#x27;**/package-lock.json&#x27;)</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-build-</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="comment"># Install pandoc for mathjax (Optional)</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">pandoc</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          cd /tmp</span></span><br><span class="line"><span class="string">          wget -c https://github.com/jgm/pandoc/releases/download/2.14.0.3/pandoc-2.14.0.3-1-amd64.deb</span></span><br><span class="line"><span class="string">          sudo dpkg -i pandoc-2.14.0.3-1-amd64.deb</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">å®‰è£…ä¾èµ–</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="string">steps.cache-npm.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          # npm install gulp-cli -g #å…¨å±€å®‰è£…gulp</span></span><br><span class="line"><span class="string">          npm install --save</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">     <span class="comment"># - name: ä¿®æ”¹åŒæ æ’ä»¶çš„CDN</span></span><br><span class="line">     <span class="comment">#   run: |</span></span><br><span class="line">     <span class="comment">#     sed -i &quot;s/cdn.jsdelivr.net/blogresource.sqwdream.top\/cdn.jsdelivr.net/g&quot; node_modules/hexo-butterfly-article-double-row/index.js</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo bangumi -u #bilibiliç•ªå‰§æ›´æ–°</span></span><br><span class="line"><span class="string">          hexo generate</span></span><br><span class="line"><span class="string">          # gulp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">éƒ¨ç½²åˆ°Github</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">token:</span> <span class="string">github-token</span>  <span class="comment"># githubé«˜æƒé™token</span></span><br><span class="line">          <span class="attr">repository-name:</span> <span class="string">zznn-cloud/zznn-cloud.github.io</span></span><br><span class="line">          <span class="attr">branch:</span> <span class="string">main</span></span><br><span class="line">          <span class="attr">folder:</span> <span class="string">public</span></span><br><span class="line">          <span class="attr">commit-message:</span> <span class="string">&quot;$<span class="template-variable">&#123;&#123; github.event.head_commit.message &#125;&#125;</span> Updated By Github Actions&quot;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="äºŒ-Qexoéƒ¨ç½²åŠé…ç½®"><a href="#äºŒ-Qexoéƒ¨ç½²åŠé…ç½®" class="headerlink" title="äºŒ. Qexoéƒ¨ç½²åŠé…ç½®"></a>äºŒ. Qexoéƒ¨ç½²åŠé…ç½®</h2><ol><li><p>æ­¤å¤„ç”³è¯·vercelå…è´¹çš„æ•°æ®åº“ä½œä¸ºå­˜å‚¨æ•°æ®ä½¿ç”¨</p></li><li><p>ä½¿ç”¨vercelå‡½æ•°è®¡ç®—éƒ¨ç½²Qexoå‰ç«¯</p><p><del>Noteï¼šä¸Šæ–¹ä¸¤æ­¥éª¤è¾ƒä¸ºç®€å•æœ¬æ–‡ä¸åšä»‹ç»</del></p></li><li><p>ä¸€é”®éƒ¨ç½²Qexoä¼ é€é—¨(<a href="https://vercel.com/new/clone?repository-url=https://github.com/am-abudu/Qexo">New Project â€“ Vercel</a></p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/bc9f1111-b88d-49be-a0dd-a61f94e46078.png"></p></li><li><p>Qexoå†™åšå®¢å‚æ•°ç•™å­˜</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/655e81e0-1d98-40ee-9fbe-20f0f9ceea2e.png"></p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/04073e0c-4649-4ea8-8e83-5ab25e43507d.png"></p></li></ol><h1 id="ä¸‰-æ‰©å±•ğŸ˜˜"><a href="#ä¸‰-æ‰©å±•ğŸ˜˜" class="headerlink" title="ä¸‰. æ‰©å±•ğŸ˜˜"></a>ä¸‰. æ‰©å±•ğŸ˜˜</h1><p><strong>Qexo logoç­‰ä¿¡æ¯</strong></p><ul><li><a href="https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo.png">https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo.png</a></li><li><a href="https://unpkg.com/qexo-static@2.2.3/qexo/images/icon.png">https://unpkg.com/qexo-static@2.2.3/qexo/images/icon.png</a></li><li><a href="https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo-dark.png">https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo-dark.png</a></li></ul><p><strong>Githubå›¾åºŠè®¾ç½®</strong>âœŒ</p><p><a href="https://github.com/Qexo/Qexo/wiki/%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE">https://github.com/Qexo/Qexo/wiki/%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE</a></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># ä»“åº“</span></span><br><span class="line">zznn-cloud/zznn-cloud-blog-images</span><br><span class="line"><span class="section"># åˆ†æ”¯</span></span><br><span class="line">main</span><br><span class="line"><span class="section"># é«˜æƒé™token</span></span><br><span class="line">ghp<span class="emphasis">_Qknm...................</span></span><br><span class="line"><span class="emphasis"># ä¿å­˜è·¯å¾„</span></span><br><span class="line"><span class="emphasis">Qexo/&#123;year&#125;/&#123;month&#125;/&#123;filename&#125;_</span>&#123;md5&#125;.&#123;extName&#125;</span><br><span class="line"><span class="section"># è‡ªå®šä¹‰åŸŸå</span></span><br><span class="line">https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/&#123;year&#125;/&#123;month&#125;/&#123;filename&#125;<span class="emphasis">_&#123;md5&#125;.&#123;extName&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_3292d63d8f8d8a13d3e5c4da5693056e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_3292d63d8f8d8a13d3e5c4da5693056e.png"></p></blockquote><p>ç»“è¯­ï¼šQexoæ˜¯ä¸€ä¸ªæå…¶å¥½ç”¨çš„hexoç®¡ç†å¹³å°æ„Ÿè°¢ç»´æŠ¤æ­¤é¡¹ç›®å¤§ä½¬ä»¬çš„è´¡çŒ®ğŸ‘ ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> qexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> qexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>qexo</title>
      <link href="/2023/12/15/test%E6%96%87%E6%A1%A3/"/>
      <url>/2023/12/15/test%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh,è¿™æ˜¯ä¸€ä¸ªæ— æ•ˆçš„å¯†ç ã€‚è¯·æ£€æŸ¥å¹¶é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="1e36074e6806db3b794944b334a845b30ee4a44008c0f95412e8164b226bd2f7">a81b18b76326989181327cf554748c52da21cc33c0731b37b224ba7b570727d3b6d5ddf5cf3c517190be31f0da481a7c1ae1ccf60fc7eaceeb9cc5892e16592bedd0fa34da4e1fbebcabbc85c61b51dc15b4dd5c653dd684e603438464111c4758ada5701ed225dfbd33a33cab2ad7f5093655aeb5eaca0232ba36211d5fc9ff44db582730bf5c727b33bccadb8cb8b77cae0b827153cec6695bba5dd664156870a40827582da63c9bb736da2a1bfc98df7330236d44a7d2f8b10dfdfcd122bd5e2c4b11abfa2950fbe9241cf3f70397f4fefef6014cbf3accc24f189e4e0a0c3b4ec4f45e9219defb3827e97c491cc502d47705a211f980292e5d94782afb28e13979fec10f387caf7a4b98b79a86fe4e7ad3f9160a17314f34ae7dc9de9657330c39bdb079565dd9b9028e55be707459664d80e94aaa904db0f7625599f5d554d2eb884008a91dba287ef5a9e3b8d7f9be0e0cb510ed2de19caaef0d93f43f3fab92059dcb4ae3117d38f5f8569e2599dba450684e50ae2cafed01af668acaccbfd559639df872095f921c09511ba9aa98eaa60ff40792ef9de59eaf803fa0385e164e13c46a17baba7df1020fff0da0f5966c893838d94d1acb2cdefc0c668136b567139a3ccdb81c79fe589a04e4c29f588bc4970922e347038b5255e2073adf5a6f7b1b3da9766823e784de618db79c4e9c7fa9bcb8d349420c1caec932caf6fec3f006905a4da03a87acbb2a0c976d6aa75713e4ac4f627cfdf081140629c8e64f4a4f530949bef04038eb8a5f5bda930b8e4f90f00b0054e7424e220988a14706065271315d9cc90efbea5a21e6b2ab3b97950791af32fea88dc1b4997e0f745f4ee19c3ea33ef460bf37f91a0915fef7997f1476766e49003ee3b4a68b8b45b1fa6c2a9819837b731413ac89ca44f96ed6e06fdde14d31aafd7f10be7182781fcc2f07c927aa8a9b3e18889648d59b4731c1118ab551e3eace4c6cbdcec0dafc9ea2038503b1bf4ce5d78f51c6357e483f7ecd9082168c55ef6208c20227a5499cf042252ea5444d6d925806a4834d574b220e8e14e1ee686f2a699360a0fcedebe1c4b8b0ec701509bb99b96bf2bd69b73b8fd4db9ee9adf0bece84ccfef7bb6759ce3d88f32b8d6f5a4c48f33cc5576c609bf4b89b88fec3a9e95657ff7f1a71f8c2c08068bd8f32c9e0e6adae824595277425c51c9342210ea2ddbd0c468a56e49a07dd603b6c077294df30fd2d37ef48c85b28495a7fba0fdceb2f82d630deea7f8de307fb911599f5c6cb732ffa0c94511fb928a2ea94df54502f6e4ee0a1ec2287b6f0ab5d8cb8a71da9f5cd4fe2f3e86440dfef0c5f538f1fa794b49d86b24907d5ab7bef455fce7a1f5f0f8df94c6b4778617a040daa6e38feff24023cdc7d58888534dac1a361c5</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">è¯·è¾“å…¥è®¿é—®å¯†ç </span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
