<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/06/27/hello-world/"/>
      <url>/2024/06/27/hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>proxmoxæ•™ç¨‹</title>
      <link href="/2024/06/22/proxmox%E6%95%99%E7%A8%8B/"/>
      <url>/2024/06/22/proxmox%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="proxmoxæ•™ç¨‹"><a href="#proxmoxæ•™ç¨‹" class="headerlink" title="proxmoxæ•™ç¨‹"></a>proxmoxæ•™ç¨‹</h1><p>isoé•œåƒä¸‹è½½åœ°å€ï¼š<a href="https://pve.proxmox.com/wiki/Downloads">https://pve.proxmox.com/wiki/Downloads</a></p><h2 id="ä¸€-proxmoxçš„å®‰è£…åŠé…ç½®"><a href="#ä¸€-proxmoxçš„å®‰è£…åŠé…ç½®" class="headerlink" title="ä¸€. proxmoxçš„å®‰è£…åŠé…ç½®"></a>ä¸€. proxmoxçš„å®‰è£…åŠé…ç½®</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2f095d78b69671be4283fa3df4138a68.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2f095d78b69671be4283fa3df4138a68.png"></p><p>1.ç¡¬ä»¶ç›´é€š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_926f9dc034ba9e58f4d865c5d48e2dd6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_926f9dc034ba9e58f4d865c5d48e2dd6.png"></p><p>2.æœ€ç»ˆæ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_e695c7631fab1a105f95568f6c4d2628.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_e695c7631fab1a105f95568f6c4d2628.png"></p><h2 id="äºŒ-pveèŠ‚ç‚¹åŠ å…¥é›†ç¾¤"><a href="#äºŒ-pveèŠ‚ç‚¹åŠ å…¥é›†ç¾¤" class="headerlink" title="äºŒ. pveèŠ‚ç‚¹åŠ å…¥é›†ç¾¤"></a>äºŒ. pveèŠ‚ç‚¹åŠ å…¥é›†ç¾¤</h2><p>éœ€è¦ä¸¤ä¸ªpveèŠ‚ç‚¹ä¸»æœºåç§°ä¸ä¸€æ · å¦‚æœä¸»æœºåç§°ä¸€æ ·ä¼šå†²çªå¯¼è‡´æ— æ³•åŠ å…¥èŠ‚ç‚¹ å‡ºç°ç±»ä¼¼å¦‚ä¸‹æŠ¥é”™</p><p>ä¿®æ”¹pveèŠ‚ç‚¹åç§°å‚è€ƒï¼š<a href="https://www.qkeke.com/archives/2136.html">https://www.qkeke.com/archives/2136.html</a></p><h3 id="1-ä¿®æ”¹èŠ‚ç‚¹åç§°"><a href="#1-ä¿®æ”¹èŠ‚ç‚¹åç§°" class="headerlink" title="1.ä¿®æ”¹èŠ‚ç‚¹åç§°"></a>1.ä¿®æ”¹èŠ‚ç‚¹åç§°</h3><p>åœ¨åˆ›å»ºé›†ç¾¤åï¼Œå…¶ä»–åŒåèŠ‚ç‚¹å§‹ç»ˆæ— æ³•åŠ å…¥é›†ç¾¤ï¼Œäºæ˜¯éœ€è¦ä¿®æ”¹èŠ‚ç‚¹ä¸»æœºåï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>1ã€ä¿®æ”¹å¦‚ä¸‹2ä¸ªæ–‡ä»¶ä¸­çš„ä¸»æœºåä¸ºæ–°çš„ä¸»æœºå</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/hostname</span><br><span class="line">vi /etc/hosts</span><br></pre></td></tr></table></figure><p>2ã€å¦‚æœæˆ‘ä»¬å·²ç»åˆ›å»ºè™šæ‹Ÿæœºï¼Œéœ€è¦ä¿®æ”¹nodesä¸­èŠ‚ç‚¹é…ç½®æ–‡ä»¶åï¼ˆæ–°æœåŠ¡å™¨å¿½ç•¥æ­¤æ­¥ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /etc/pve/nodes/OldHostName     /etc/pve/nodes/NewHostName</span><br></pre></td></tr></table></figure><p>3ã€é‡å¯æœåŠ¡å™¨</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_688957670a3886de26c6dc137530bf6e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_688957670a3886de26c6dc137530bf6e.png"></p><h2 id="ä¸‰-pveé‡ç½®å¯†ç "><a href="#ä¸‰-pveé‡ç½®å¯†ç " class="headerlink" title="ä¸‰. pveé‡ç½®å¯†ç "></a>ä¸‰. pveé‡ç½®å¯†ç </h2><p><a href="http://t.csdnimg.cn/prU1W">http://t.csdnimg.cn/prU1W</a>  ï¼ˆæœ¬æ–‡å‚è€ƒï¼‰<br><a href="https://pve.proxmox.com/wiki/Root_Password_Reset#Method_1">https://pve.proxmox.com/wiki/Root_Password_Reset#Method_1</a></p><p>åˆå§‹å›¾</p><p>åˆ°æ­¤é¡µé¢æ—¶æŒ‰eè¿›å…¥grubæ¨¡å¼</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_b2331cc4270249582ef47242c1d19634.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_b2331cc4270249582ef47242c1d19634.png"></p><p>æ‰¾åˆ°æ­¤è¡Œæ·»åŠ æ­¤é…ç½®</p><p>å°†å…‰æ ‡ç§»åŠ¨åˆ°è¯¥è¡Œçš„æœ«å°¾ï¼Œç´§éšå…¶åâ€˜ro quietâ€™å¹¶é™„åŠ å‚æ•°init=/bin/bashã€‚</p><p>ä¸‹æ¬¡ç‚¹å‡»ctrl + xä»¥ä½¿å…¶èƒ½å¤Ÿä»¥è£…æœ‰åªè¯»(ro)è®¿é—®æƒé™çš„æ ¹æ–‡ä»¶ç³»ç»Ÿåœ¨å•ç”¨æˆ·æ¨¡å¼ä¸‹å¯åŠ¨ã€‚</p><p>ä¸ºæ‚¨é‡ç½®å¯†ç ï¼Œæ‚¨éœ€è¦æ›´æ”¹ä»è®¿é—®æƒé™åªè¯»åˆ°è¯»å†™ã€‚å› æ­¤ï¼Œè¿è¡Œä»¥ä¸‹å‘½ä»¤ä»¥é‡æ–°å®‰è£…å…·æœ‰rwå±æ€§çš„æ ¹æ–‡ä»¶ç³»ç»Ÿã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_08023f86d72ff75b8173d99bbedeeee4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_08023f86d72ff75b8173d99bbedeeee4.png"></p><p>æŒ‚è½½Debianæ–‡ä»¶ç³»ç»Ÿ åŠä¿®æ”¹å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mount -n -o remountï¼Œrw /</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_824a050b4122d5f75b3d666d2e695bfc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_824a050b4122d5f75b3d666d2e695bfc.png"></p><p>åœ¨Debianä¸­é‡è®¾æ ¹å¯†ç </p><p>æä¾›æ–°å¯†ç å¹¶é‡æ–°è¾“å…¥ä»¥ç¡®è®¤ã€‚å¦‚æœä¸€åˆ‡é¡ºåˆ©å¹¶ä¸”å¯†ç åŒ¹é…ï¼Œæ‚¨å°†åœ¨æ§åˆ¶å°æœ«å°¾æ”¶åˆ°â€œ å¯†ç æ›´æ–°æˆåŠŸ â€é€šçŸ¥</p><p>æœ€åæŒ‰Ctrl + Alt + Delé€€å‡ºå¹¶é‡æ–°å¯åŠ¨ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åˆšåˆšå®šä¹‰çš„æ–°åˆ›å»ºçš„å¯†ç ä»¥rootç”¨æˆ·èº«ä»½ç™»å½•ã€‚</p><p>è¿™å°±æ˜¯æ‚¨åœ¨Debian 10ä¸Šé‡ç½®å¿˜è®°çš„rootå¯†ç çš„æ–¹å¼ã€‚</p><h2 id="å››-æ·»åŠ æ•°æ®ç›˜ä¸ºå­˜å‚¨"><a href="#å››-æ·»åŠ æ•°æ®ç›˜ä¸ºå­˜å‚¨" class="headerlink" title="å››. æ·»åŠ æ•°æ®ç›˜ä¸ºå­˜å‚¨"></a>å››. æ·»åŠ æ•°æ®ç›˜ä¸ºå­˜å‚¨</h2><p>pveä¸åƒexsié‚£æ ·è‡ªåŠ¨æ·»åŠ å¥½çš„ éœ€è¦è‡ªå·±æ‰‹åŠ¨æŒ‚è½½åˆ°æŸä¸ªç›®å½• æ·»åŠ æ­¤ç›®å½•ä¸ºæœ¬åœ°å­˜å‚¨</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_d23a49628b2f8a794ab27c1d9e2d209a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_d23a49628b2f8a794ab27c1d9e2d209a.png"></p><h2 id="äº”-ä¿®æ”¹pve-ipåœ°å€"><a href="#äº”-ä¿®æ”¹pve-ipåœ°å€" class="headerlink" title="äº”. ä¿®æ”¹pve  ipåœ°å€"></a>äº”. ä¿®æ”¹pve  ipåœ°å€</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹pve ipåœ°å€ </span></span><br><span class="line">vi /etc/network/interfaces</span><br><span class="line"><span class="comment"># ä¿®æ”¹pve webé¡µé¢ç™»å½•åœ°å€</span></span><br><span class="line">vi /etc/issue</span><br><span class="line"><span class="comment"># ä¿®æ”¹æœ¬åœ°dns</span></span><br><span class="line">vi /etc/hosts</span><br></pre></td></tr></table></figure><p>é‡å¯ç½‘ç»œï¼šsystemctl restart networking</p><h2 id="å…­-GPUç›´é€š"><a href="#å…­-GPUç›´é€š" class="headerlink" title="å…­. GPUç›´é€š"></a>å…­. GPUç›´é€š</h2><p>æœ¬æ–‡å‚è€ƒé“¾æ¥ç­‰ï¼š</p><p><a href="https://v2rayssr.com/pve.html">https://v2rayssr.com/pve.html</a><br><a href="https://www.jianshu.com/p/d22a21c5ae81">https://www.jianshu.com/p/d22a21c5ae81</a><br><a href="https://blog.csdn.net/c13257595138/article/details/90385433">https://blog.csdn.net/c13257595138/article/details/90385433</a></p><p>ç®¡ç†å¤šä¸ªé›†ç¾¤<br><a href="https://pve-doc-cn.readthedocs.io/zh-cn/latest/">https://pve-doc-cn.readthedocs.io/zh-cn/latest/</a></p><p>æ˜¾å¡ç›´é€š<br><a href="https://blog.csdn.net/yyhyoung/article/details/130708894">https://blog.csdn.net/yyhyoung/article/details/130708894</a><br><a href="https://blog.rayfalling.com/2023/01/pve-7-3-%E4%BC%98%E5%8C%96%E5%92%8C%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A.html">https://blog.rayfalling.com/2023/01/pve-7-3-ä¼˜åŒ–å’Œæ˜¾å¡ç›´é€š.html</a></p><p>é€šè¿‡å·¥å…·å®ç°æ˜¾å¡ç›´é€š<br><a href="https://github.com/ivanhao/pvetools/wiki/i-%E7%A1%AC%E4%BB%B6%E7%9B%B4%E9%80%9A%E5%8F%8A%E6%98%BE%E5%8D%A1%E7%9B%B4%E9%80%9A%E9%85%8D%E7%BD%AE">https://github.com/ivanhao/pvetools/wiki/i-ç¡¬ä»¶ç›´é€šåŠæ˜¾å¡ç›´é€šé…ç½®</a></p>]]></content>
      
      
      <categories>
          
          <category> pve </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pve </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³é—­ubuntu  unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡</title>
      <link href="/2024/06/15/%E5%85%B3%E9%97%ADubuntu%20%20unattended-upgrades%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E6%9C%8D%E5%8A%A1/"/>
      <url>/2024/06/15/%E5%85%B3%E9%97%ADubuntu%20%20unattended-upgrades%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å…³é—­ubuntu-unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡"><a href="#å…³é—­ubuntu-unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡" class="headerlink" title="å…³é—­ubuntu  unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡"></a>å…³é—­ubuntu  unattended-upgradesè‡ªåŠ¨æ›´æ–°æœåŠ¡</h1><blockquote><p><code>unattended-upgrades</code>æ˜¯ä¸€ä¸ªè‡ªåŠ¨å‡çº§æœåŠ¡ï¼Œç”¨äºè‡ªåŠ¨æ›´æ–°ç³»ç»Ÿä¸­çš„è½¯ä»¶åŒ…å’Œå®‰å…¨è¡¥ä¸ã€‚å½“ç³»ç»Ÿé…ç½®äº†<code>unattended-upgrades</code>æœåŠ¡åï¼Œå®ƒä¼šå®šæœŸæ£€æŸ¥è½¯ä»¶åŒ…ç®¡ç†å™¨ï¼ˆå¦‚APTï¼‰çš„æ›´æ–°æºï¼Œç„¶åè‡ªåŠ¨ä¸‹è½½å’Œå®‰è£…å¯ç”¨çš„è½¯ä»¶åŒ…æ›´æ–°ã€‚</p><p>è¿™ä¸ªæœåŠ¡çš„ä¸»è¦ç›®çš„æ˜¯ç¡®ä¿ç³»ç»Ÿä¸­çš„è½¯ä»¶åŒ…ä¿æŒæœ€æ–°çŠ¶æ€ï¼ŒåŒ…æ‹¬å®‰å…¨æ›´æ–°å’Œ bug ä¿®å¤ã€‚é€šè¿‡è‡ªåŠ¨åŒ–è¿™ä¸ªè¿‡ç¨‹ï¼Œå¯ä»¥å‡å°‘ç®¡ç†å‘˜æ‰‹åŠ¨å¹²é¢„çš„éœ€æ±‚ï¼Œå¹¶æé«˜ç³»ç»Ÿçš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ã€‚</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œ<code>unattended-upgrades</code>æœåŠ¡ä¼šåœ¨åå°è¿è¡Œï¼Œå¹¶æ ¹æ®é…ç½®æ–‡ä»¶ä¸­çš„è§„åˆ™è‡ªåŠ¨æ‰§è¡Œæ›´æ–°æ“ä½œã€‚å®ƒå¯ä»¥å®šæœŸæ£€æŸ¥æ›´æ–°æºï¼Œä¸‹è½½è½¯ä»¶åŒ…æ›´æ–°ï¼Œå¹¶åœ¨ç³»ç»Ÿç©ºé—²æ—¶å®‰è£…è¿™äº›æ›´æ–°ï¼Œä»¥ç¡®ä¿ç³»ç»Ÿä¿æŒæœ€æ–°çŠ¶æ€ã€‚</p><p>å¦‚æœä½ é‡åˆ°äº†æ— æ³•æ‰§è¡Œ<code>apt</code>å‘½ä»¤çš„é—®é¢˜ï¼Œå¯èƒ½æ˜¯ç”±äº<code>unattended-upgrades</code>æœåŠ¡æ­£åœ¨è¿è¡Œå¹¶å ç”¨äº†ç›¸å…³çš„é”å®šæ–‡ä»¶ï¼Œå¯¼è‡´å…¶ä»–<code>apt</code>è¿›ç¨‹æ— æ³•æ“ä½œã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥é€‰æ‹©ç­‰å¾…è‡ªåŠ¨å‡çº§æœåŠ¡å®Œæˆæˆ–è€…ç»ˆæ­¢ç›¸å…³è¿›ç¨‹ï¼Œç„¶åå†æ‰§è¡Œä½ éœ€è¦çš„æ“ä½œã€‚</p></blockquote><p>è¦æš‚æ—¶å…³é—­<code>unattended-upgrades</code>æœåŠ¡ï¼Œä½ å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p><ol><li><p><strong>åœæ­¢<code>unattended-upgrades</code>æœåŠ¡</strong>ï¼š<br>è¿è¡Œä»¥ä¸‹å‘½ä»¤åœæ­¢<code>unattended-upgrades</code>æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl stop unattended-upgrades</span><br></pre></td></tr></table></figure></li><li><p><strong>ç¦ç”¨<code>unattended-upgrades</code>æœåŠ¡</strong>ï¼ˆå¯é€‰ï¼‰ï¼š<br>å¦‚æœä½ æƒ³åœ¨ç³»ç»Ÿé‡æ–°å¯åŠ¨åä»ç„¶ä¿æŒ<code>unattended-upgrades</code>æœåŠ¡å…³é—­çŠ¶æ€ï¼Œå¯ä»¥ç¦ç”¨è¯¥æœåŠ¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl <span class="built_in">disable</span> unattended-upgrades</span><br></pre></td></tr></table></figure></li><li><p><strong>ç¡®è®¤æœåŠ¡çŠ¶æ€</strong>ï¼š<br>ç¡®ä¿æœåŠ¡å·²ç»åœæ­¢ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status unattended-upgrades</span><br></pre></td></tr></table></figure></li></ol><p>è¿™æ ·ï¼Œ<code>unattended-upgrades</code>æœåŠ¡å°±ä¼šè¢«æš‚æ—¶å…³é—­ã€‚å¦‚æœä½ æƒ³é‡æ–°å¯ç”¨è¯¥æœåŠ¡ï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl start unattended-upgrades</span><br></pre></td></tr></table></figure><p>å…³é—­åä¸‹æ–¹é—®é¢˜è§£å†³</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_aaf97a6eb50633cfdab0e71cfd1c69a0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_aaf97a6eb50633cfdab0e71cfd1c69a0.png"></p><p>è¯·æ³¨æ„ï¼Œå…³é—­è‡ªåŠ¨å‡çº§æœåŠ¡å¯èƒ½ä¼šå¯¼è‡´ç³»ç»Ÿä¸­çš„è½¯ä»¶åŒ…å’Œå®‰å…¨è¡¥ä¸ä¸åŠæ—¶æ›´æ–°ï¼Œè¿™å¯èƒ½ä¼šå½±å“ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚å› æ­¤ï¼Œåœ¨å…³é—­æœåŠ¡ä¹‹å‰ï¼Œè¯·ç¡®ä¿äº†è§£é£é™©å¹¶åœ¨åˆé€‚çš„æ—¶æœºé‡æ–°å¯ç”¨æœåŠ¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu22.04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA CUDNN Anaconda Pytorch2 ç­‰</title>
      <link href="/2024/06/13/ubuntu22.04LTS%E5%AE%89%E8%A3%85NVIDIA%E5%AE%98%E6%96%B94090D%E9%A9%B1%E5%8A%A8CUDA%20CUDNN%20Anaconda%20%20Pytorch2%20%E7%AD%89/"/>
      <url>/2024/06/13/ubuntu22.04LTS%E5%AE%89%E8%A3%85NVIDIA%E5%AE%98%E6%96%B94090D%E9%A9%B1%E5%8A%A8CUDA%20CUDNN%20Anaconda%20%20Pytorch2%20%E7%AD%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ubuntu22-04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA-CUDNN-Anaconda-Pytorch2ç­‰"><a href="#ubuntu22-04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA-CUDNN-Anaconda-Pytorch2ç­‰" class="headerlink" title="ubuntu22.04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA CUDNN Anaconda Pytorch2ç­‰"></a>ubuntu22.04LTSå®‰è£…NVIDIAå®˜æ–¹4090Dé©±åŠ¨CUDA CUDNN Anaconda Pytorch2ç­‰</h1><h3 id="1-å®‰è£…ä¾èµ–"><a href="#1-å®‰è£…ä¾èµ–" class="headerlink" title="1. å®‰è£…ä¾èµ–"></a>1. å®‰è£…ä¾èµ–</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update   <span class="comment">#æ›´æ–°è½¯ä»¶åˆ—è¡¨</span></span><br><span class="line">sudo apt-get install g++</span><br><span class="line">sudo apt-get install gcc</span><br><span class="line">sudo apt-get install make</span><br></pre></td></tr></table></figure><p>æˆ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential gcc-multilib dkms</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœé‡åˆ°æ— æ³•ä¸‹è½½çš„æƒ…å†µï¼Œå¯èƒ½æ˜¯å› ä¸ºå®‰è£…å®Œç³»ç»Ÿåæºä¸å¯ç”¨ï¼Œå¯ä»¥å…ˆæ›´æ¢å›½å†…é•œåƒæºååœ¨è¿›è¡Œæœ¬æ­¥éª¤ï¼ˆæ¢æºæ–¹æ³•ï¼š<a href="https://zhuanlan.zhihu.com/p/139305626">å†™ç»™å·¥ç¨‹å¸ˆçš„ Ubuntu 20.04 æœ€ä½³é…ç½®æŒ‡å—</a> ç¬¬<strong>2ã€3</strong>æ­¥ï¼‰</p></blockquote><h3 id="2-å¸è½½åŸæœ‰é©±åŠ¨"><a href="#2-å¸è½½åŸæœ‰é©±åŠ¨" class="headerlink" title="2. å¸è½½åŸæœ‰é©±åŠ¨"></a>2. å¸è½½åŸæœ‰é©±åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get remove --purge nvidia*   <span class="comment"># æˆ–è€…nvidia-*</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-å®˜ç½‘ä¸‹è½½å¯¹åº”é©±åŠ¨"><a href="#3-å®˜ç½‘ä¸‹è½½å¯¹åº”é©±åŠ¨" class="headerlink" title="3. å®˜ç½‘ä¸‹è½½å¯¹åº”é©±åŠ¨"></a>3. å®˜ç½‘ä¸‹è½½å¯¹åº”é©±åŠ¨</h3><blockquote><p>ä¸‹è½½å¥½ä¹‹åï¼Œæ³¨æ„æŠŠnvidiaé©±åŠ¨æ”¾åœ¨è‹±æ–‡åæ–‡ä»¶å¤¹ä¸‹ï¼Œæ¯”å¦‚mkdir driver æ–°å»ºæ–‡ä»¶å¤¹â€œdriverâ€<br>å®˜ç½‘åœ°å€ï¼š<a href="https://www.nvidia.cn/Download/index.aspx?lang=cn">Nvidiaé©±åŠ¨ä¸‹è½½åœ°å€</a><br>æˆ‘è¿™é‡Œæ˜¾å¡æ˜¯4090ï¼Œå®˜ç½‘æ¨èé©±åŠ¨ç‰ˆæœ¬ä¸º535.54.03</p></blockquote><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a82106785b61bc2f12e3efa9b941936c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a82106785b61bc2f12e3efa9b941936c.png"></p><h3 id="4-ç¦ç”¨nouveau"><a href="#4-ç¦ç”¨nouveau" class="headerlink" title="4. ç¦ç”¨nouveau"></a>4. ç¦ç”¨nouveau</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo gedit /etc/modprobe.d/blacklist.conf æˆ–è€…(blacklist-nouveau.conf)</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>(å¦‚æœæ²¡æœ‰geditè¾“å…¥ä»¥ä¸ŠæŒ‡ä»¤ä¼šæŠ¥é”™ï¼Œå¯ä»¥ sudo apt-get install gedit å®‰è£… gedit æˆ–ä½¿ç”¨ nano ä»£æ›¿ gedit )</p></blockquote><p>åœ¨æ‰“å¼€çš„blacklist.confæœ«å°¾æ·»åŠ å¦‚ä¸‹ï¼Œä¿å­˜æ–‡æœ¬å…³é—­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">blacklist nouveau</span><br><span class="line">options nouveau modeset=0</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œè¿›è¡Œæ›´æ–°</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo update-initramfs -u</span><br></pre></td></tr></table></figure><p>æ›´æ–°ç»“æŸåé‡å¯ç”µè„‘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo reboot</span><br></pre></td></tr></table></figure><p>é‡å¯ååœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼Œå¦‚æœæ²¡æœ‰è¾“å‡ºåˆ™è¯´æ˜æˆåŠŸç¦ç”¨nouveau</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsmod | grep nouveau</span><br></pre></td></tr></table></figure><h3 id="5-åœæ­¢å½“å‰çš„æ˜¾ç¤ºæœåŠ¡å™¨"><a href="#5-åœæ­¢å½“å‰çš„æ˜¾ç¤ºæœåŠ¡å™¨" class="headerlink" title="5. åœæ­¢å½“å‰çš„æ˜¾ç¤ºæœåŠ¡å™¨"></a>5. åœæ­¢å½“å‰çš„æ˜¾ç¤ºæœåŠ¡å™¨</h3><p>æœ€ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨telinitå‘½ä»¤æ›´æ”¹ä¸ºè¿è¡Œçº§åˆ«3ã€‚åœ¨ç»ˆç«¯è¾“å…¥ä»¥ä¸‹linuxå‘½ä»¤åï¼Œæ˜¾ç¤ºæœåŠ¡å™¨å°†åœæ­¢ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo telinit 3</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>ä¸€èˆ¬æ‰§è¡Œå®Œä¸Šè¿°å‘½ä»¤åï¼Œç³»ç»Ÿè‡ªåŠ¨è¿›å…¥æ–‡æœ¬ç•Œé¢ttyï¼›<br>å¦‚æœè¿›ä¸å»ï¼Œå°±æŒ‰Ctrl + Alt + F1ï½F6ä¸­çš„ä¸€ä¸ª (åˆ†åˆ«å¯¹åº”è¿›å…¥tty1~tty6)<br>ç„¶åè¾“å…¥ç”¨æˆ·åå’Œå¯†ç </p></blockquote><h3 id="6-åœ¨æ–‡æœ¬ç•Œé¢ä¸­ï¼Œç¦ç”¨X-windowæœåŠ¡"><a href="#6-åœ¨æ–‡æœ¬ç•Œé¢ä¸­ï¼Œç¦ç”¨X-windowæœåŠ¡" class="headerlink" title="6. åœ¨æ–‡æœ¬ç•Œé¢ä¸­ï¼Œç¦ç”¨X-windowæœåŠ¡"></a>6. åœ¨æ–‡æœ¬ç•Œé¢ä¸­ï¼Œç¦ç”¨X-windowæœåŠ¡</h3><p>åœ¨ç»ˆç«¯è¾“å…¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo /etc/init.d/gdm3 stopæˆ–è€…ï¼ˆsudo service gdm3 stopï¼‰</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="7-å®‰è£…é©±åŠ¨"><a href="#7-å®‰è£…é©±åŠ¨" class="headerlink" title="7. å®‰è£…é©±åŠ¨"></a>7. å®‰è£…é©±åŠ¨</h3><p>cdå‘½ä»¤è¿›å…¥åˆ°å­˜æ”¾é©±åŠ¨çš„ç›®å½•ï¼Œè¾“å…¥å‘½ä»¤ï¼ˆå‘½ä»¤ä¸­çš„æ–‡ä»¶åä»¥ä½ ä¸‹è½½çš„é©±åŠ¨ä¸ºå‡†ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">chmod</span> 777 NVIDIA-Linux-x86_64-535.54.03.run   <span class="comment">#ç»™ä½ ä¸‹è½½çš„é©±åŠ¨èµ‹äºˆå¯æ‰§è¡Œæƒé™ï¼Œæ‰å¯ä»¥å®‰è£…</span></span><br><span class="line">sudo ./NVIDIA-Linux-x86_64-535.54.03.run â€“no-opengl-files   <span class="comment">#å®‰è£…</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_f8b9841992eaa256d8d224a8a53f064a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_f8b9841992eaa256d8d224a8a53f064a.png"></p><blockquote><p>ä»¥ä¸Šé—®é¢˜å¹¶éæŒ‰æˆ‘å†™çš„é¡ºåºå‡ºç°ï¼Œä½†æ˜¯å½“æ—¶æ²¡æœ‰æˆªå›¾æ‰€ä»¥å¿˜è®°é¡ºåºäº†ã€‚<strong>è¡¨æ ¼ä¸­æœ€åä¸€ä¸ªé—®é¢˜</strong>éœ€è¦æ³¨æ„ï¼Œåœ¨å…¶å®ƒçš„æ•™ç¨‹ä¸­ï¼Œè¿™ä¸ªé—®é¢˜é€‰yesï¼Œä½†æ˜¯åœ¨æˆ‘å®‰è£…ç³»ç»Ÿçš„è¿‡ç¨‹ä¸­ï¼Œé€‰yesä¼šå¯¼è‡´ç”µè„‘é‡å¯åæ— æ³•æ­£å¸¸å¼€æœºã€‚<strong>æ‰€ä»¥è¿™é‡Œæˆ‘é€‰äº†No</strong>ï¼Œé‡å¯åèƒ½å¤Ÿæ­£å¸¸å¼€æœºã€‚ï¼ˆUbuntu20.04 ã€æ˜¾å¡4090ï¼‰</p></blockquote><h3 id="8-é‡å¯å›¾å½¢ç•Œé¢"><a href="#8-é‡å¯å›¾å½¢ç•Œé¢" class="headerlink" title="8. é‡å¯å›¾å½¢ç•Œé¢"></a>8. é‡å¯å›¾å½¢ç•Œé¢</h3><p>å®‰è£…å®Œæˆåé€€å›å›¾å½¢ç•Œé¢ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo init 5 </span><br></pre></td></tr></table></figure><p>or</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ctrl + alt + f7 </span><br></pre></td></tr></table></figure><p>or</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service gdm3 restart</span><br></pre></td></tr></table></figure><p>æˆ–è€…ç»ˆç«¯è¾“å…¥ reboot é‡å¯</p><h3 id="9-æµ‹è¯•æ˜¾å¡é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸ"><a href="#9-æµ‹è¯•æ˜¾å¡é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸ" class="headerlink" title="9. æµ‹è¯•æ˜¾å¡é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸ"></a>9. æµ‹è¯•æ˜¾å¡é©±åŠ¨æ˜¯å¦å®‰è£…æˆåŠŸ</h3><p>ç»ˆç«¯è¾“å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvidia-smi</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‡ºç°ç±»ä¼¼ä¸‹å›¾çš„ç•Œé¢ï¼Œè¯´æ˜æˆåŠŸå®‰è£…é©±åŠ¨</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_faf7c52e1453ed6831feafd08733747a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_faf7c52e1453ed6831feafd08733747a.png"></p><h3 id="å››-å®‰è£…CUDA"><a href="#å››-å®‰è£…CUDA" class="headerlink" title="å››. å®‰è£…CUDA"></a>å››. å®‰è£…CUDA</h3><p>ä¸ºäº†èƒ½å¤Ÿä½¿ç”¨pytorch2ï¼Œæˆ‘åœ¨è¿™é‡Œå®‰è£…çš„CUDA11.8ç‰ˆæœ¬ã€‚<br>å‚è€ƒæ•™ç¨‹ï¼š<a href="https://zhuanlan.zhihu.com/p/612556391">CUDA_11.8å®‰è£…-çŸ¥ä¹</a></p><h4 id="1-å®˜ç½‘ä¸‹è½½CUDA"><a href="#1-å®˜ç½‘ä¸‹è½½CUDA" class="headerlink" title="1. å®˜ç½‘ä¸‹è½½CUDA"></a>1. å®˜ç½‘ä¸‹è½½CUDA</h4><p><a href="https://developer.nvidia.com/cuda-11-8-0-download-archive">CUDA Toolkit 11.8 Downloads</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a3e710d1f0efc1cd8aa0c09ba852954c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a3e710d1f0efc1cd8aa0c09ba852954c.png"></p><h3 id="2-ä¸‹è½½CUDA"><a href="#2-ä¸‹è½½CUDA" class="headerlink" title="2. ä¸‹è½½CUDA"></a>2. ä¸‹è½½CUDA</h3><p>ç»ˆç«¯è¾“å…¥ä¸Šä¸€æ­¥è·å¾—çš„å‘½ä»¤ï¼Œä¸‹è½½runfileæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://developer.download.nvidia.com/compute/cuda/11.8.0/local_installers/cuda_11.8.0_520.61.05_linux.run</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-å®‰è£…"><a href="#3-å®‰è£…" class="headerlink" title="3. å®‰è£…"></a>3. å®‰è£…</h3><p>æ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤ä¸‹è½½runfileæ–‡ä»¶åï¼Œcdåˆ°æ–‡ä»¶æ‰€åœ¨è·¯å¾„ï¼Œæ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼Œå®‰è£…cuda</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo sh cuda_11.8.0_520.61.05_linux.run</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œåç¨å¾®ç­‰å¾…ï¼Œä¼šå‡ºç°å¦‚ä¸‹ç”»é¢</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_75d6fd3264f5a14aea3d46eb7188bfad.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_75d6fd3264f5a14aea3d46eb7188bfad.png"></p><blockquote><p>ä¸Šä¸‹ç§»åŠ¨å…‰æ ‡åˆ°Driverä½ç½®ï¼ŒæŒ‰ç©ºæ ¼å–æ¶ˆé€‰æ‹©ï¼›ç”¨ç›¸åŒçš„æ“ä½œå–æ¶ˆå¦å¤–ä¸‰ä¸ªé€‰é¡¹ï¼Œåªå®‰è£…CUDA Toolkit 11.8ä¸»ä½“ï¼ˆå¦‚å›¾ï¼‰</p></blockquote><p>ç»§ç»­ç§»åŠ¨å…‰æ ‡åˆ°Optionsï¼ŒæŒ‰å›è½¦ï¼Œè¿›å…¥å®‰è£…é…ç½®ç•Œé¢ï¼ˆå¦‚ä¸‹ï¼‰</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_137f5444520fc1ba1ec212be997df3a5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_137f5444520fc1ba1ec212be997df3a5.png"></p><p>å…‰æ ‡ç§»åŠ¨åˆ°Toolkit Optionsï¼ŒæŒ‰å›è½¦ï¼Œè¿›å…¥CUDAå®‰è£…é…ç½®ç•Œé¢\</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_0067f24a438738730d4d902abcec20ce.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_0067f24a438738730d4d902abcec20ce.png"></p><blockquote><p>å¦‚ä¸Šå›¾ï¼Œå»æ‰æ‰€æœ‰å¤šé€‰é€‰é¡¹ï¼Œç‰¹åˆ«æ˜¯Create symbolic link from /usr/local/cudaé€‰é¡¹ï¼Œæœ€å¥½æ˜¯å»æ‰ã€‚è¿™æ ·å®‰è£…å®Œæˆåï¼Œæ˜¯ä¸ä¼šåœ¨/usr/local/ä¸‹ç”Ÿæˆcudaè½¯é“¾æ¥ç›®å½•ã€‚è¿™ä¸ªè½¯é“¾æ¥ç›®å½•åœ¨å®‰è£…è¿‡ç¨‹ä¸­æ˜¯ä¸å¯ä¿®æ”¹çš„ï¼Œå½“æˆ‘ä»¬å®‰è£…å¤šç‰ˆæœ¬CUDAæ—¶ï¼Œä¼šé‡å¤è¦†ç›–è¿™ä¸ªè½¯é“¾æ¥ç›®å½•ï¼Œå¯¹æˆ‘ä»¬ä½¿ç”¨CUDAä¼šäº§ç”Ÿä¸å¿…è¦çš„éº»çƒ¦ã€‚</p></blockquote><blockquote><p>CUDAé»˜è®¤å®‰è£…åœ¨/usr/local/ç›®å½•ä¸‹ï¼Œä¸€èˆ¬Change Toolkit Install Pathå¯ä»¥ä¸åšä¿®æ”¹ã€‚ä½†å¦‚æœæ˜¯æ™®é€šç”¨æˆ·å®‰è£…ï¼Œéœ€è®¾å®šå®‰è£…è·¯å¾„ä¸ºç”¨æˆ·ä¸»ç›®å½•ä¸‹ï¼Œå…‰æ ‡ç§»åŠ¨åˆ°Change Toolkit Install PathæŒ‰å›è½¦ï¼Œæ‰‹åŠ¨ä¿®æ”¹å®‰è£…è·¯å¾„åæŒ‰å›è½¦é€€å‡ºè·¯å¾„é…ç½®ç•Œé¢<br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p></blockquote><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_7384d8d55a365e5df7705a52eaba2a81.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_7384d8d55a365e5df7705a52eaba2a81.png"></p><p>å¦‚æœæƒ³è¦ä¿®æ”¹è·¯å¾„ï¼Œå¯ä»¥è®¾ç½®ä¸ºè‡ªå·±æƒ³è¦æ”¾åœ¨çš„ä½ç½®ï¼Œå¦‚ /home/ç”¨æˆ·å/app/cuda-11.8/</p><h3 id="4-è®¾ç½®CUDAç¯å¢ƒ"><a href="#4-è®¾ç½®CUDAç¯å¢ƒ" class="headerlink" title="4. è®¾ç½®CUDAç¯å¢ƒ"></a>4. è®¾ç½®CUDAç¯å¢ƒ</h3><p>å¦‚æœä¸Šä¸€æ­¥é€‰æ‹©ç”¨rootç”¨æˆ·å®‰è£…åœ¨é»˜è®¤è·¯å¾„ï¼Œåˆ™æ™®é€šç”¨æˆ·ç¯å¢ƒå˜é‡é…ç½®å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/usr/local/cuda-11.8/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$LD_LIBRARY_PATH</span>:/usr/local/cuda-11.8/lib64</span><br></pre></td></tr></table></figure><p>å¦‚æœæ˜¯æ™®é€šç”¨æˆ·å®‰è£…åœ¨è‡ªå·±çš„ç”¨æˆ·ç›®å½•ä¸‹ï¼Œç¯å¢ƒå˜é‡é…ç½®å¦‚ä¸‹ç¤ºä¾‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/home/duyong/apps/cuda-11.8/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">export</span> LD_LIBRARY_PATH=<span class="variable">$LD_LIBRARY_PATH</span>:/home/duyong/apps/cuda-11.8/lib64</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨æˆ·é…ç½®æ–‡ä»¶å³åˆ»ç”Ÿæ•ˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><p>éªŒè¯CUDAæ˜¯å¦å®‰è£…æˆåŠŸ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nvcc -V</span><br></pre></td></tr></table></figure><p>å¦‚æœæœ‰ç±»ä¼¼å¦‚ä¸‹è¾“å‡ºè¯´æ˜å®‰è£…æˆåŠŸ</p><blockquote><p>nvcc: NVIDIA Â® Cuda complier driver<br>Copyright Â© 2005-2022 NVIDIA Coropration<br>Bulit on Wed_Jun__8_16:49:14_PDT_2022<br>Cuda copiltation tools, release 11.7, V11.7.99<br>Build cuda_11.7.r11.7/compiler .31442593_0</p></blockquote><p>å®‰è£…å®Œæˆåé‡å¯</p><h2 id="äº”-å®‰è£…CUDNN"><a href="#äº”-å®‰è£…CUDNN" class="headerlink" title="äº”. å®‰è£…CUDNN"></a>äº”. å®‰è£…CUDNN</h2><p>å®˜ç½‘ä¸‹è½½åœ°å€ï¼šï¼ˆéœ€è¦æ³¨å†Œï¼‰</p><p><a href="https://developer.nvidia.com/cudnn">https://developer.nvidia.com/cudnn</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_255bdd3027c994186d2ab7d232c048d6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_255bdd3027c994186d2ab7d232c048d6.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a00f30ce85ee7aea5ba4008845c2697a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_a00f30ce85ee7aea5ba4008845c2697a.png"></p><p>ç‚¹å‡»ä¸‹è½½ï¼Œä¸‹è½½å®Œæˆåè§£å‹æ–‡ä»¶ï¼Œåœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">cp</span> cuda/include/cudnn.h /usr/local/cuda/include/</span><br><span class="line">sudo <span class="built_in">cp</span> cuda/lib64/libcudnn* /usr/local/cuda/lib64/</span><br><span class="line">sudo <span class="built_in">chmod</span> a+r /usr/local/cuda/include/cudnn.h</span><br><span class="line">sudo <span class="built_in">chmod</span> a+r /usr/local/cuda/lib64/libcudnn*</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤æ­¥æ“ä½œä¸ºæ‹·è´æ–‡ä»¶åˆ°æŒ‡å®šä½ç½®ï¼Œå¹¶èµ‹äºˆæƒé™</p><p>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸï¼Œè¾“å…¥ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR -A 2</span><br></pre></td></tr></table></figure><p>å®‰è£…æˆåŠŸä¼šæœ‰ç±»ä¼¼ä¸‹å›¾çš„è¾“å‡º</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2a150aaca0cc6b1bfd635806439e0210.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2a150aaca0cc6b1bfd635806439e0210.png"></p><h3 id="å…­-å®‰è£…Anaconda"><a href="#å…­-å®‰è£…Anaconda" class="headerlink" title="å…­. å®‰è£…Anaconda"></a>å…­. å®‰è£…Anaconda</h3><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/m0_50117360/article/details/108403586">Ubuntu 20.04å®‰è£…Anaconda3åŠç®€å•ä½¿ç”¨</a></p><h3 id="ä¸ƒ-å®‰è£…Pytorch2"><a href="#ä¸ƒ-å®‰è£…Pytorch2" class="headerlink" title="ä¸ƒ. å®‰è£…Pytorch2"></a>ä¸ƒ. å®‰è£…Pytorch2</h3><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/KRISNAT/article/details/124068391">è¶…è¯¦ç»† Ubuntuå®‰è£…PyTorchæ­¥éª¤</a></p><h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h3><p><a href="https://zhuanlan.zhihu.com/p/590877041">https://zhuanlan.zhihu.com/p/590877041</a><br><a href="https://blog.csdn.net/hwh295/article/details/113409389">https://blog.csdn.net/hwh295/article/details/113409389</a><br><a href="https://blog.csdn.net/Perfect886/article/details/119109380">https://blog.csdn.net/Perfect886/article/details/119109380</a><br><a href="https://zhuanlan.zhihu.com/p/61255639">https://zhuanlan.zhihu.com/p/61255639</a><br><a href="https://blog.csdn.net/m0_50117360/article/details/108403586">https://blog.csdn.net/m0_50117360/article/details/108403586</a><br><a href="https://blog.csdn.net/KRISNAT/article/details/124068391">https://blog.csdn.net/KRISNAT/article/details/124068391</a><br>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</p><h3 id="æœ¬æ–‡å‚è€ƒï¼š"><a href="#æœ¬æ–‡å‚è€ƒï¼š" class="headerlink" title="æœ¬æ–‡å‚è€ƒï¼š"></a>æœ¬æ–‡å‚è€ƒï¼š</h3><p><a href="https://blog.csdn.net/qq_43775794/article/details/131770933">https://blog.csdn.net/qq_43775794/article/details/131770933</a></p>]]></content>
      
      
      <categories>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™ å®‰è£…æ–°mysql</title>
      <link href="/2024/06/05/ubuntu%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4mysql%E6%AE%8B%E7%95%99%20%E5%AE%89%E8%A3%85%E6%96%B0mysql/"/>
      <url>/2024/06/05/ubuntu%E5%BD%BB%E5%BA%95%E5%88%A0%E9%99%A4mysql%E6%AE%8B%E7%95%99%20%E5%AE%89%E8%A3%85%E6%96%B0mysql/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™-å®‰è£…æ–°mysql"><a href="#ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™-å®‰è£…æ–°mysql" class="headerlink" title="ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™ å®‰è£…æ–°mysql"></a>ubuntuå½»åº•åˆ é™¤mysqlæ®‹ç•™ å®‰è£…æ–°mysql</h1><p>1.åˆ é™¤mysqlçš„æ•°æ®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> /var/lib/mysql/ -R</span><br></pre></td></tr></table></figure><p>2.åˆ é™¤mysqlçš„é…ç½®æ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">rm</span> /etc/mysql/ -R</span><br></pre></td></tr></table></figure><p>(è¿™ä¸¤æ­¥éå¸¸é‡è¦ï¼Œå¥½å¤šæ–‡ç« éƒ½æ²¡å†™)</p><p>3 .dpkg â€“list|grep mysqlæŸ¥çœ‹mysqlçš„ä¾èµ–é¡¹</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_8a639ced957b5aa0db30b0b1aac12589.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_8a639ced957b5aa0db30b0b1aac12589.png"></p><p>4.å¼€å§‹åˆ é™¤ä¾èµ–é¡¹</p><p>4.1 .å¸è½½å‘½ä»¤ï¼šsudo apt-get remove mysql-common</p><p>4.2. å¸è½½å‘½ä»¤ï¼šsudo apt-get autoremove â€“purge mysql-server-8.0</p><p>å¤‡æ³¨æ­¤ä¸¤éƒ¨åˆä¸ºä¸€æ­¥:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹æ–¹ä¸¤å‘½ä»¤çš†å¯</span></span><br><span class="line">dpkg -l|grep mysql|awk <span class="string">&#x27;&#123;print$2&#125;&#x27;</span>|sudo xargs dpkg -P</span><br><span class="line">dpkg -l|grep mysql|awk <span class="string">&#x27;&#123;print$2&#125;&#x27;</span>|sudo xargs remove -y</span><br></pre></td></tr></table></figure><p>4.3 .æ¸…é™¤æ®‹ç•™æ•°æ®ï¼Œè¿è¡Œå‘½ä»¤ï¼šdpkg -l|grep mysql|awk â€˜{print$2}â€™|sudo xargs dpkg -P</p><p>å†æ¬¡æŸ¥çœ‹MySQLçš„å‰©ä½™ä¾èµ–é¡¹ï¼Œè¿è¡Œå‘½ä»¤ï¼šdpkg â€“list|grep mysql</p><p>å¦‚æœæ²¡æœ‰è¿”å›å³åˆ é™¤å®Œäº†ï¼ˆåŸºæœ¬ä¸Šå°±ä¼šåˆ é™¤å®Œï¼‰ï¼Œå¦‚æœæ²¡åˆ é™¤å®Œåˆ™ç»§ç»­åˆ é™¤æ˜¾ç¤ºçš„ä¾èµ–åŒ…</p><p>å…¶ä»–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®å¤å®‰è£…åŒ…</span></span><br><span class="line">sudo dpkg-reconfigure mysql-server-5.7</span><br><span class="line"><span class="comment"># å¸è½½å®‰è£…åŒ…åŠé…ç½®æ–‡ä»¶</span></span><br><span class="line">sudo apt-get purge mysql-server-5.7</span><br></pre></td></tr></table></figure><p>å®Œæˆ æ­¤æ—¶å³å¯é‡æ–°å®‰è£…mysqlï¼</p><p>åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.csdn.net/qq_52135683/article/details/126857974">https://blog.csdn.net/qq_52135683/article/details/126857974</a></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>grafana 8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦</title>
      <link href="/2024/06/04/grafana%208%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%E9%82%AE%E4%BB%B6%E5%91%8A%E8%AD%A6/"/>
      <url>/2024/06/04/grafana%208%E4%BB%A5%E4%B8%8A%E7%89%88%E6%9C%AC%E9%85%8D%E7%BD%AE%E9%82%AE%E4%BB%B6%E5%91%8A%E8%AD%A6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="grafana-8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦"><a href="#grafana-8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦" class="headerlink" title="grafana 8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦"></a>grafana 8ä»¥ä¸Šç‰ˆæœ¬é…ç½®é‚®ä»¶å‘Šè­¦</h1><blockquote><p>æœ¬æ¬¡æ¼”ç¤ºä½¿ç”¨ç‰ˆæœ¬9.2.0</p><p>æ‹“è¡¥å›¾</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_edeee1c476fa329e2b3489f066df346c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_edeee1c476fa329e2b3489f066df346c.png"></p></blockquote><h2 id="1-é¦–å…ˆé…ç½®åç«¯é‚®ä»¶é…ç½®"><a href="#1-é¦–å…ˆé…ç½®åç«¯é‚®ä»¶é…ç½®" class="headerlink" title="1.é¦–å…ˆé…ç½®åç«¯é‚®ä»¶é…ç½®"></a>1.é¦–å…ˆé…ç½®åç«¯é‚®ä»¶é…ç½®</h2><p>å»ºè®®é…ç½®ä¸ºé‚®ä»¶ç»„ ç»„å†…æˆå‘˜éƒ½å¯æ”¶åˆ°é‚®ä»¶</p><p>æ­¤å¤„è§é“¾æ¥ï¼š<a href="https://wn-apple-teawine.fun/2023/05/26/grafana%E9%85%8D%E7%BD%AE%E9%82%AE%E4%BB%B6%E5%91%8A%E8%AD%A6">https://wn-apple-teawine.fun/2023/05/26/grafanaé…ç½®é‚®ä»¶å‘Šè­¦</a></p><h2 id="2-æ­¤æ—¶å³å¯é…ç½®å‘Šè­¦è§„åˆ™"><a href="#2-æ­¤æ—¶å³å¯é…ç½®å‘Šè­¦è§„åˆ™" class="headerlink" title="2.æ­¤æ—¶å³å¯é…ç½®å‘Šè­¦è§„åˆ™"></a>2.æ­¤æ—¶å³å¯é…ç½®å‘Šè­¦è§„åˆ™</h2><p>â‘ .é…ç½®</p><p>åç«¯é…ç½®è§ä¸Šæ–¹é“¾æ¥</p><p>å‰ç«¯é…ç½®è§ä¸‹æ–¹</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_77d36f135d1154ed015d21243fe9f8bc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_77d36f135d1154ed015d21243fe9f8bc.png"></p><p>ç‚¹å‡»æµ‹è¯•æŸ¥çœ‹æ˜¯å¦æˆåŠŸ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_4e8ed1f107e3602cfcf8edb7ff1872ca.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_4e8ed1f107e3602cfcf8edb7ff1872ca.png"></p><p>é…ç½®æŒç»­å‘é€å‘Šè­¦ é…ç½® Notification policies è®¾ç½®é‡å¤å‘é€å‘Šè­¦é‚®ä»¶çš„é—´éš”æ—¶é—´</p><p>ä¸è®¾ç½®æ­¤åˆ™é»˜è®¤å››å°æ—¶é‡å¤å‘é€ ç›¸å½“ç³Ÿç³•ğŸ’—</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_b76111cbaf1baced4e24119f9bb1c9a8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_b76111cbaf1baced4e24119f9bb1c9a8.png"></p><p><strong>æ­¤æ—¶ä¾¿ä¼šä¸¤åˆ†é’Ÿå‘ä¸€å°å‘Šè­¦é‚®ä»¶</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_ba9125fba1e0c66be945b60a83f2b41e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_ba9125fba1e0c66be945b60a83f2b41e.png"></p><p>â‘¡.é…ç½®promsqlè¯­å¥è®¾ç½®æŠ¥è­¦</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_54e566d16a35915ac3f03f44a05c8ed5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_54e566d16a35915ac3f03f44a05c8ed5.png"></p><p>æŠ¥è­¦æ¡ä»¶é€‰æ‹© é€‰æ‹©Bè¯­å¥ é€‰æ‹©Aä¼šæŠ¥é”™</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_e2cee9496752811ae27dba1c7b6c22bd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_e2cee9496752811ae27dba1c7b6c22bd.png"></p><p>**æˆ–æ‹–åŠ¨æ­¤çº¿ğŸº **</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_93c6bf297b5cff54231696e190e19874.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_93c6bf297b5cff54231696e190e19874.png"></p><p>è®¾ç½®æŠ¥è­¦å‘¨æœŸ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_5a25154c8a7e1694b0e6237fd051f8b4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_5a25154c8a7e1694b0e6237fd051f8b4.png"></p><p>è®¾ç½®æŠ¥è­¦å‡ºç°å‘é€æç¤ºè¯­å¥</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_776ebfdddab566d58c59c4685d439a9c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_776ebfdddab566d58c59c4685d439a9c.png"></p><p>è‡ªå®šä¹‰æ ‡ç­¾</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_1f801f865e968f8b9d0594ee1e9d84dd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_1f801f865e968f8b9d0594ee1e9d84dd.png"></p><h2 id="2-æ•ˆæœ"><a href="#2-æ•ˆæœ" class="headerlink" title="2.æ•ˆæœ"></a>2.æ•ˆæœ</h2><p>æŠ¥è­¦é¡µé¢</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_cec9e81d68127efb459ca97cb4f1d9e0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_cec9e81d68127efb459ca97cb4f1d9e0.png"></p><p>æŠ¥è­¦æ¢å¤ä¸å‘é€æŠ¥è­¦<br><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_5f7a15945a38ac95755b68996feb913e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_5f7a15945a38ac95755b68996feb913e.png"></p><p>å‚è€ƒï¼š</p><p><a href="https://blog.51cto.com/u_11529070/9174855">[è½¬å¸–]Prometheusç³»åˆ—ä¹‹Grafana ç‰ˆæœ¬9.0.0 è®¾ç½®Emailé‚®ä»¶æŠ¥è­¦å®æˆ˜_51CTOåšå®¢_prometheusé‚®ä»¶å‘Šè­¦</a></p>]]></content>
      
      
      <categories>
          
          <category> grafana </category>
          
      </categories>
      
      
        <tags>
            
            <tag> grafana </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘</title>
      <link href="/2024/06/03/%E5%AE%9D%E5%A1%94docker%E9%83%A8%E7%BD%B2%E5%AE%9E%E7%8E%B0%E5%AF%B9%E6%9F%90%E4%B8%80%E4%B8%AA%E7%9B%AE%E5%BD%95%E7%9A%84%E7%BC%96%E8%BE%91/"/>
      <url>/2024/06/03/%E5%AE%9D%E5%A1%94docker%E9%83%A8%E7%BD%B2%E5%AE%9E%E7%8E%B0%E5%AF%B9%E6%9F%90%E4%B8%80%E4%B8%AA%E7%9B%AE%E5%BD%95%E7%9A%84%E7%BC%96%E8%BE%91/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘"><a href="#å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘" class="headerlink" title="å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘"></a>å®å¡”dockeréƒ¨ç½²å®ç°å¯¹æŸä¸€ä¸ªç›®å½•çš„ç¼–è¾‘</h1><blockquote><h2 id="ç‰ˆæœ¬å‘½åè¯´æ˜-ï¼ˆé•œåƒå¯é€‰ï¼‰"><a href="#ç‰ˆæœ¬å‘½åè¯´æ˜-ï¼ˆé•œåƒå¯é€‰ï¼‰" class="headerlink" title="ç‰ˆæœ¬å‘½åè¯´æ˜ ï¼ˆé•œåƒå¯é€‰ï¼‰"></a>ç‰ˆæœ¬å‘½åè¯´æ˜ ï¼ˆé•œåƒå¯é€‰ï¼‰</h2><p>pch18/baotaæˆ–pch18/baota:latestç­‰åŒpch18/baota:lnmp<br>pch18/baota:lnmpä¸ºæœ€æ–°ç‰ˆæœ¬çš„å®˜æ–¹çº¯å‡€å®‰è£…çš„åŸºç¡€ä¸Šå®‰è£…nginx,mysql,php<br>pch18/baota:lnp ä¸ºå®˜æ–¹ç‰ˆæœ¬çº¯å‡€å®‰è£…çš„åŸºç¡€ä¸Šå®‰è£…nginx,php(ä¸å†…ç½®mysql,ç”¨äºå¤–ç½®æ•°æ®åº“çš„ç¯å¢ƒ)<br>pch18/baota:lamp ä¸ºå®˜æ–¹ç‰ˆæœ¬çº¯å‡€å®‰è£…çš„åŸºç¡€ä¸Šå®‰è£…apache,php<br>pch18/baota:lap ä¸ºå®˜æ–¹ç‰ˆæœ¬çº¯å‡€å®‰è£…çš„åŸºç¡€ä¸Šå®‰è£…apache,php(ä¸å†…ç½®mysql,ç”¨äºå¤–ç½®æ•°æ®åº“çš„ç¯å¢ƒ)<br>pch18/baota:clear ä¸ºå®˜æ–¹ç‰ˆæœ¬çº¯å‡€å®‰è£…, ä¸é»˜è®¤å®‰è£…nginx,mysql,phpç­‰ç¨‹åº</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/pch18-docker/baota">https://github.com/pch18-docker/baota</a></p></blockquote><h2 id="é•œåƒå¯é€‰"><a href="#é•œåƒå¯é€‰" class="headerlink" title="é•œåƒå¯é€‰"></a>é•œåƒå¯é€‰</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pch18/baota</span><br><span class="line">pch18/baota:clear</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:baota</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:pch18baota-clean</span><br></pre></td></tr></table></figure><h2 id="docker-composeéƒ¨ç½²"><a href="#docker-composeéƒ¨ç½²" class="headerlink" title="docker-composeéƒ¨ç½²"></a>docker-composeéƒ¨ç½²</h2><blockquote><p>åªéœ€è¦æš´éœ² webè®¿é—®ç«¯å£ 8888ä¸80ç«¯å£çš„æ˜ å°„å³å¯</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">baota:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">pch18/baota:clear</span></span><br><span class="line">    <span class="comment"># registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:baota</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">baota</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/data:/www/v10</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">~/wwwroot:/www/wwwroot</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8010:80&quot;</span></span><br><span class="line">      <span class="comment"># - &quot;4431:443&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8888:8888&quot;</span></span><br><span class="line">      <span class="comment"># - &quot;888:888&quot;</span></span><br><span class="line">    <span class="attr">shm_size:</span> <span class="string">&#x27;1g&#x27;</span></span><br></pre></td></tr></table></figure><p>å…³é—­å®‰è£…å¥—ä»¶æ¨èï¼š<code>sed -i &quot;s/self.CheckInstalled()/True/g&quot; /www/server/panel/class/system.py</code></p><p><strong>æ‰‹åŠ¨æ­¥éª¤</strong></p><ol><li>ä¿®æ”¹æ–‡ä»¶è·¯å¾„ï¼š<code>/www/server/panel/class/system.py</code></li><li>æœç´¢ä»£ç ï¼š<code>networkInfo[&#39;installed&#39;] = self.CheckInstalled()</code></li><li>æ›¿æ¢ä¸ºï¼š<code>networkInfo[&#39;installed&#39;] = True</code></li><li>é‡å¯é¢æ¿ï¼Œä½ ä¼šå‘ç°çƒ¦äººçš„å¼¹çª—æ¶ˆå¤±äº†ã€‚</li></ol><p><a href="https://qzone.work/technologys/604.html">å®å¡”é¢æ¿ç¦ç”¨ å¥—ä»¶æ¨èå®‰è£…å¼¹çª— - è«ååšå®¢ (qzone.work)</a></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>ç™»å½•æ–¹å¼<br>ç™»é™†åœ°å€ http://:8888<br>åˆå§‹è´¦å· username<br>åˆå§‹å¯†ç  password</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_63177a79daa92e8f483ee31941b38457.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_63177a79daa92e8f483ee31941b38457.png"></p><p>è‹¥æ— æ³•ç™»å½•åˆ™éœ€è¦é‡æ–°ä¿®æ”¹å¯†ç  docker exec è¿›å…¥å®¹å™¨ ä½¿ç”¨ bt å‘½ä»¤ è¾“å…¥5ï¼Œ6é‡ç½®ç™»å½•ä¿¡æ¯  ç™»å½•æˆåŠŸåéœ€è¦å¼€å¯ç¦»çº¿æ¨¡å¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·</title>
      <link href="/2024/05/30/ChatGPT%E5%AF%B9%E6%8E%A5%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/"/>
      <url>/2024/05/30/ChatGPT%E5%AF%B9%E6%8E%A5%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·"><a href="#ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·" class="headerlink" title="ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·"></a>ChatGPTå¯¹æ¥å¾®ä¿¡å…¬ä¼—å·</h1><blockquote><p>ä½¿ç”¨vercel é¡¹ç›®åœ°å€: <a href="https://github.com/pwh-pwh/aiwechat-vercel">https://github.com/pwh-pwh/aiwechat-vercel</a></p><p>éƒ¨ç½²é“¾æ¥ï¼š<a href="https://vercel.com/">https://vercel.com/</a></p></blockquote><p>ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">GPT_TOKEN: sk-utaX8XNb1Lq5m9DWQDqVT3BlbkFJNVgkLJshdsddsdsd</span><br><span class="line">WX_SUBSCRIBE_REPLY: æœ¬å…¬ä¼—å·(ç®€é€¸äº‘.) ç”¨äºåˆ†äº« äº‘è®¡ç®—ï¼Œäººå·¥æ™ºèƒ½ï¼Œå¤§æ¨¡å‹é›†æˆï¼Œå¼€æºç¤¾åŒºï¼Œäº‘åŸç”Ÿç›‘æ§ç­‰çŸ¥è¯† å¸®åŠ©æ‚¨è§£å†³æ—¥å¸¸ç”Ÿæ´»åŠå·¥ä½œä¸­çš„éš¾é¢˜ å…¬ä¼—å·å·²é›†æˆGPTæ„Ÿè°¢æ‚¨çš„å…³æ³¨ï¼</span><br><span class="line">maxOutput: 200</span><br><span class="line">WX_HELP_REPLY: è¾“å…¥ä»¥ä¸‹å‘½ä»¤è¿›è¡Œå¯¹è¯ \n/helpï¼šæŸ¥çœ‹å¸®åŠ© \n/gptï¼šä¸GPTå¯¹è¯ \næ­¤GPTæ¯æ¬¡å›ç­”å­—æ•°é™åˆ¶ä¸º200å­—å·¦å³ï¼Œå¦‚éœ€è§£é™¤å­—æ•°é™åˆ¶è¯·è”ç³»ä½œè€…(878891611@qq.com)è·å–å¸®åŠ©ã€‚</span><br><span class="line">accessCode: Jkl12sdsd!</span><br><span class="line">GPT_URL: https://api.openai.com/v1</span><br><span class="line">botType: gpt</span><br><span class="line">WX_TOKEN: 53acb98d1dac49969b45797129f504f8</span><br><span class="line">gptModel: gpt-3.5-turbo</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡</title>
      <link href="/2024/05/30/RustDesk%E5%85%A8%E5%B9%B3%E5%8F%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5%E8%BD%AF%E4%BB%B6%E8%87%AA%E5%BB%BA%E6%9C%8D%E5%8A%A1/"/>
      <url>/2024/05/30/RustDesk%E5%85%A8%E5%B9%B3%E5%8F%B0%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5%E8%BD%AF%E4%BB%B6%E8%87%AA%E5%BB%BA%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡"><a href="#RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡" class="headerlink" title="RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡"></a>RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡</h1><blockquote><p>RustDesk æ˜¯ä¸€æ¬¾å¼€æºçš„å…¨å¹³å°è¿œç¨‹æ¡Œé¢è½¯ä»¶ï¼Œå¯ä»¥å¹³æ›¿ TeamViewerã€å‘æ—¥è‘µã€ToDesk ç­‰è¿œç¨‹æ¡Œé¢è½¯ä»¶ã€‚å¯ä½¿ç”¨å®˜æ–¹æä¾›çš„å…è´¹æœåŠ¡å™¨ï¼ˆå›½å†…ä½¿ç”¨æ¯”è¾ƒæ‹‰èƒ¯ï¼‰ï¼Œä¹Ÿå¯è‡ªå»ºæœåŠ¡å™¨è®©æ•°æ®æŒæ¡åœ¨è‡ªå·±æ‰‹ä¸­ï¼Œä¸ç”¨æ‹…å¿ƒå®‰å…¨é—®é¢˜ï¼Œä»¥ä¸‹åˆ—ä¸¾å‡ ä¸ªç‰¹ç‚¹ï¼š</p><p>å…¨å¹³å°æ”¯æŒï¼Œå¦‚ï¼šWindowsã€macOSã€Linuxã€iOSã€Androidã€Web ç­‰ã€‚<br>æ”¯æŒ VP8 / VP9 / AV1 è½¯ä»¶ç¼–è§£ç å™¨å’Œ H264 / H265 ç¡¬ä»¶ç¼–è§£ç å™¨ã€‚<br>å®Œå…¨æŒæ§æ•°æ®ï¼Œè½»æ¾è‡ªå»ºã€‚<br>P2P è¿æ¥ï¼Œç«¯åˆ°ç«¯åŠ å¯†ã€‚<br>RustDesk 1.2 å¼€å§‹é‡‡ç”¨ Flutter é‡å†™æ¡Œé¢ç‰ˆæœ¬ï¼Œå¯ä»¥æ”¯æŒ Wayland è¢«æ§äº†ã€‚<br>å›½å†…çš„å¼€å‘å›¢é˜Ÿï¼ŒçŸ¥ä¹æœ‰è´¦å·ï¼ˆè¿˜æ¯”è¾ƒæ´»è·ƒï¼‰ï¼Œæœ‰é—®é¢˜å¯ä»¥å»æé—®ã€‚<br>RustDesk å®˜ç½‘ï¼š <a href="https://rustdesk.com/zh/">https://rustdesk.com/zh/</a></p><p>æœåŠ¡ç«¯ GitHub åœ°å€ï¼š <a href="https://github.com/rustdesk/rustdesk-server">https://github.com/rustdesk/rustdesk-server</a></p><p>å®¢æˆ·ç«¯ä¸‹è½½åœ°å€ï¼š <a href="https://github.com/rustdesk/rustdesk/releases">https://github.com/rustdesk/rustdesk/releases</a></p><p>æ–‡æ¡£åœ°å€ï¼š <a href="https://rustdesk.com/docs/zh-cn">https://rustdesk.com/docs/zh-cn</a></p></blockquote><h2 id="ä¸€-éƒ¨ç½²"><a href="#ä¸€-éƒ¨ç½²" class="headerlink" title="ä¸€. éƒ¨ç½²"></a>ä¸€. éƒ¨ç½²</h2><p>docker-composeéƒ¨ç½²</p><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rustdesk/rustdesk-server-s6:latest</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:rustdesk-server-s6</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">rustdesk-server:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">rustdesk/rustdesk-server-s6:latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">rustdesk-server</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">unless-stopped</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./data:/data</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">21115</span><span class="string">:21115</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">21116</span><span class="string">:21116</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">21116</span><span class="string">:21116/udp</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">21117</span><span class="string">:21117</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;RELAY=192.168.30.69:21117&quot;</span>  <span class="comment"># å¡«å…¥åŸŸåæˆ–è€…IP+hbbrçš„ç«¯å£</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;ENCRYPTED_ONLY=1&quot;</span></span><br></pre></td></tr></table></figure><h2 id="äºŒ-ä½¿ç”¨"><a href="#äºŒ-ä½¿ç”¨" class="headerlink" title="äºŒ. ä½¿ç”¨"></a>äºŒ. ä½¿ç”¨</h2><p>ä¸‹è½½å®¢æˆ·ç«¯æ‰“å¼€å¡«å…¥ æœåŠ¡å™¨å¤–ç½‘IP  åŠç”Ÿæˆçš„keyæ–‡ä»¶ï¼ˆcat /opt/rustdesk/data/id_ed25519.pubï¼‰  è‡ªå·±çš„å®¢æˆ·ç«¯å’Œ è¢«æ§æ–¹çš„å®¢æˆ·ç«¯éƒ½éœ€è¦å¡«å…¥IDæœåŠ¡å™¨ å’Œkey ç‚¹å‡»è¿œç¨‹å³å¯ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e133e39869f85fb864d9a6bc05ba20e1.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e133e39869f85fb864d9a6bc05ba20e1.png"></p><p>æ­¤æ—¶å³å¯è¿œç¨‹ã€‚</p><h2 id="ä¸‰-æœ¬æ–‡å‚è€ƒ"><a href="#ä¸‰-æœ¬æ–‡å‚è€ƒ" class="headerlink" title="ä¸‰. æœ¬æ–‡å‚è€ƒ"></a>ä¸‰. æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://blog.vlinyu.com/archives/docker-compose-remotedesk-rustdesk-server">ã€Docker é¡¹ç›®ã€‘ä¹‹â€“RustDeskå…¨å¹³å°è¿œç¨‹æ¡Œé¢è¿æ¥è½¯ä»¶è‡ªå»ºæœåŠ¡å™¨æµç¨‹-væ—ç¾½ (vlinyu.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer</title>
      <link href="/2024/05/30/%E9%83%A8%E7%BD%B2%E7%B1%BB%E4%BC%BC%E7%9F%A5%E4%B9%8E%E7%9A%84%E9%97%AE%E7%AD%94%E7%A4%BE%E5%8C%BAAnswer/"/>
      <url>/2024/05/30/%E9%83%A8%E7%BD%B2%E7%B1%BB%E4%BC%BC%E7%9F%A5%E4%B9%8E%E7%9A%84%E9%97%AE%E7%AD%94%E7%A4%BE%E5%8C%BAAnswer/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer"><a href="#éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer" class="headerlink" title="éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer"></a>éƒ¨ç½²ç±»ä¼¼çŸ¥ä¹çš„é—®ç­”ç¤¾åŒºAnswer</h1><h2 id="ä¸€-é¡¹ç›®åœ°å€"><a href="#ä¸€-é¡¹ç›®åœ°å€" class="headerlink" title="ä¸€. é¡¹ç›®åœ°å€"></a>ä¸€. é¡¹ç›®åœ°å€</h2><p>Answer å®˜æ–¹ç½‘å€ï¼š<a href="https://answer.dev/">https://answer.dev/</a></p><p>Answer å®˜æ–¹ GitHubï¼š<a href="https://github.com/answerdev/answer">https://github.com/answerdev/answer</a></p><p>Answer å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://answer.dev/docs/installation/">https://answer.dev/docs/installation/</a></p><h2 id="äºŒ-Dockeré•œåƒ"><a href="#äºŒ-Dockeré•œåƒ" class="headerlink" title="äºŒ. Dockeré•œåƒ"></a>äºŒ. Dockeré•œåƒ</h2><p><a href="https://hub.docker.com/r/danielszabo99/microbin">https://hub.docker.com/r/danielszabo99/microbin</a></p><h2 id="ä¸‰-é¡¹ç›®ä»‹ç»"><a href="#ä¸‰-é¡¹ç›®ä»‹ç»" class="headerlink" title="ä¸‰. é¡¹ç›®ä»‹ç»"></a>ä¸‰. é¡¹ç›®ä»‹ç»</h2><blockquote><p>Answeræ˜¯ä¸€ä¸ªç±»ä¼¼çŸ¥ä¹çš„å¼€æºé—®ç­”ç¤¾åŒºã€‚æ”¯æŒDockeréƒ¨ç½²ï¼Œç›®å‰GitHubæ‹¥æœ‰5.4Kçš„starã€‚</p></blockquote><h2 id="å››-åŠŸèƒ½ä»‹ç»"><a href="#å››-åŠŸèƒ½ä»‹ç»" class="headerlink" title="å››. åŠŸèƒ½ä»‹ç»"></a>å››. åŠŸèƒ½ä»‹ç»</h2><p>éå¸¸å°å·§<br>æ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼ˆä¾‹å¦‚ï¼šserver.com/file/pig-dog-catï¼‰<br>æ”¯æŒrawçš„æ–‡æœ¬æœåŠ¡ï¼ˆä¾‹å¦‚ï¼Œserver.com/raw/pig-dog-catï¼‰<br>å¯ä»¥ç”¨æ¥URLç¼©çŸ­å’Œé‡å®šå‘<br>æ”¯æŒäºŒç»´ç <br>æ•°æ®åº“éå¸¸ç®€å•ï¼ˆJSON+æ–‡ä»¶ï¼‰ï¼Œå¯ç§»æ¤æ€§å¼ºï¼Œæ˜“äºå¤‡ä»½å’Œæ•´åˆ<br>æ”¯æŒåˆ—å‡ºä½¿ç”¨è¿‡çš„åˆ—è¡¨<br>æ”¯æŒç§æœ‰é“¾æ¥å’Œå…¬å¼€é“¾æ¥ï¼Œå¯ç¼–è¾‘ï¼Œå¯ä»¥è®¾ç½®é“¾æ¥çš„æœ‰æ•ˆæ€§<br>æ”¯æŒä»£ç è¯­æ³•é«˜äº®<br>è‡ªåŠ¨æš—é»‘æ¨¡å¼å’Œè‡ªå®šä¹‰æ ·å¼ï¼Œåªéœ€å¾ˆå°‘çš„CSSå’ŒvanillaÂ JSï¼ˆè§water.cssï¼‰<br>é»˜è®¤ä»¥åŠ¨ç‰©çš„åå­—ä½œä¸ºç»“å°¾ï¼ˆå¯ä¿®æ”¹æˆéšæœºå­—ç¬¦ï¼‰</p><h2 id="äº”-éƒ¨ç½²"><a href="#äº”-éƒ¨ç½²" class="headerlink" title="äº”. éƒ¨ç½²"></a>äº”. éƒ¨ç½²</h2><p>docker-copmpose éƒ¨ç½²</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">answer:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">answerdev/answer</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&#x27;9008:80&#x27;</span>            <span class="comment"># å†’å·å·¦è¾¹å¯ä»¥æ”¹æˆè‡ªå·±æœåŠ¡å™¨æœªè¢«å ç”¨çš„ç«¯å£</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">on-failure</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./answer-data:/data</span>  <span class="comment"># å†’å·å·¦è¾¹å¯ä»¥æ”¹è·¯å¾„ï¼Œç°åœ¨æ˜¯è¡¨ç¤ºæŠŠæ•°æ®å­˜æ”¾åœ¨åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ answer-data æ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mariadb:10</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">on-failure</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="attr">MYSQL_ROOT_PASSWORD:</span> <span class="string">answer</span>   <span class="comment"># æ•°æ®åº“ç”¨æˆ·rootçš„å¯†ç ï¼Œå»ºè®®è‡ªè¡Œä¿®æ”¹ä¸€ä¸ª</span></span><br><span class="line">      <span class="attr">MYSQL_USER:</span> <span class="string">answer</span>     </span><br><span class="line">      <span class="attr">MYSQL_PASSWORD:</span> <span class="string">answer</span>   <span class="comment"># æ•°æ®åº“ç”¨æˆ·answerçš„å¯†ç ï¼Œå»ºè®®è‡ªè¡Œä¿®æ”¹ä¸€ä¸ª</span></span><br><span class="line">      <span class="attr">MYSQL_DATABASE:</span> <span class="string">answer</span> </span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./mariadb:/var/lib/mysql</span>  <span class="comment"># å†’å·å·¦è¾¹å¯ä»¥æ”¹è·¯å¾„ï¼Œç°åœ¨æ˜¯è¡¨ç¤ºæŠŠæ•°æ®å­˜æ”¾åœ¨åœ¨å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„ mariadb æ–‡ä»¶å¤¹ä¸­</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">--character-set-server=utf8mb4</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span></span><br></pre></td></tr></table></figure><h2 id="å…­-æ•ˆæœ"><a href="#å…­-æ•ˆæœ" class="headerlink" title="å…­. æ•ˆæœ"></a>å…­. æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_2f2f5fe7b710450a248e624a3299d855.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_2f2f5fe7b710450a248e624a3299d855.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_13c7b65b321acf267ffd7b70a31c1fad.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_13c7b65b321acf267ffd7b70a31c1fad.png"></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vmware esxi gpuç›´é€š</title>
      <link href="/2024/05/28/vmware%20esxi%20gpu%E7%9B%B4%E9%80%9A/"/>
      <url>/2024/05/28/vmware%20esxi%20gpu%E7%9B%B4%E9%80%9A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="vmware-esxi-gpuç›´é€š"><a href="#vmware-esxi-gpuç›´é€š" class="headerlink" title="vmware esxi gpuç›´é€š"></a>vmware esxi gpuç›´é€š</h1><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://www.dinghui.org/vmware-esxi-directpath-gpu.html">https://www.dinghui.org/vmware-esxi-directpath-gpu.html</a></p><p><a href="https://www.dinghui.org/vmware-esxi-nvidia-gpu.html">https://www.dinghui.org/vmware-esxi-nvidia-gpu.html</a></p><p><a href="https://docs.vmware.com/cn/VMware-vSphere/7.0/com.vmware.vsphere.resmgmt.doc/GUID-9044A2BA-D4E5-4221-87F4-0B1C8612B748.html">https://docs.vmware.com/cn/VMware-vSphere/7.0/com.vmware.vsphere.resmgmt.doc/GUID-9044A2BA-D4E5-4221-87F4-0B1C8612B748.html</a></p>]]></content>
      
      
      <categories>
          
          <category> gpu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> gpu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ</title>
      <link href="/2024/05/28/cloudfaler%E9%83%A8%E7%BD%B2github%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E5%8A%A0%E9%80%9F/"/>
      <url>/2024/05/28/cloudfaler%E9%83%A8%E7%BD%B2github%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E5%8A%A0%E9%80%9F/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ"><a href="#cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ" class="headerlink" title="cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ"></a>cloudfaleréƒ¨ç½²githubæ–‡ä»¶ä¸‹è½½åŠ é€Ÿ</h1><p>é¡¹ç›®æ‰˜ç®¡åœ°å€ï¼š<a href="https://github.com/hunshcn/gh-proxy">https://github.com/hunshcn/gh-proxy</a></p><p>æ„å»º: åªéœ€è¦å¤åˆ¶ä¸‹æ–¹jsä»£ç åˆ°cloudflaer  workersä¸­ä¿å­˜éƒ¨ç½²å³å¯ å»ºè®®ç»‘å®šåŸŸå</p><p>cloudflaer workersåœ°å€ï¼š</p><p><a href="https://dash.cloudflare.com/65b0f21580ba74305f1bdcbc6d30210c/workers-and-pages">https://dash.cloudflare.com/65b0f21580ba74305f1bdcbc6d30210c/workers-and-pages</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&#x27;use strict&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * static files (404.html, sw.js, conf.js)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">ASSET_URL</span> = <span class="string">&#x27;https://hunshcn.github.io/gh-proxy/&#x27;</span></span><br><span class="line"><span class="comment">// å‰ç¼€ï¼Œå¦‚æœè‡ªå®šä¹‰è·¯ç”±ä¸ºexample.com/gh/*ï¼Œå°†PREFIXæ”¹ä¸º &#x27;/gh/&#x27;ï¼Œæ³¨æ„ï¼Œå°‘ä¸€ä¸ªæ éƒ½ä¼šé”™ï¼</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PREFIX</span> = <span class="string">&#x27;/&#x27;</span></span><br><span class="line"><span class="comment">// åˆ†æ”¯æ–‡ä»¶ä½¿ç”¨jsDelivré•œåƒçš„å¼€å…³ï¼Œ0ä¸ºå…³é—­ï¼Œé»˜è®¤å…³é—­</span></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Config</span> = &#123;</span><br><span class="line">    <span class="attr">jsdelivr</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> whiteList = [] <span class="comment">// ç™½åå•ï¼Œè·¯å¾„é‡Œé¢æœ‰åŒ…å«å­—ç¬¦çš„æ‰ä¼šé€šè¿‡ï¼Œe.g. [&#x27;/username/&#x27;]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">ResponseInit</span>&#125; */</span></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">PREFLIGHT_INIT</span> = &#123;</span><br><span class="line">    <span class="attr">status</span>: <span class="number">204</span>,</span><br><span class="line">    <span class="attr">headers</span>: <span class="keyword">new</span> <span class="title class_">Headers</span>(&#123;</span><br><span class="line">        <span class="string">&#x27;access-control-allow-origin&#x27;</span>: <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;access-control-allow-methods&#x27;</span>: <span class="string">&#x27;GET,POST,PUT,PATCH,TRACE,DELETE,HEAD,OPTIONS&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;access-control-max-age&#x27;</span>: <span class="string">&#x27;1728000&#x27;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> exp1 = <span class="regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:releases|archive)\/.*$/i</span></span><br><span class="line"><span class="keyword">const</span> exp2 = <span class="regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:blob|raw)\/.*$/i</span></span><br><span class="line"><span class="keyword">const</span> exp3 = <span class="regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/(?:info|git-).*$/i</span></span><br><span class="line"><span class="keyword">const</span> exp4 = <span class="regexp">/^(?:https?:\/\/)?raw\.(?:githubusercontent|github)\.com\/.+?\/.+?\/.+?\/.+$/i</span></span><br><span class="line"><span class="keyword">const</span> exp5 = <span class="regexp">/^(?:https?:\/\/)?gist\.(?:githubusercontent|github)\.com\/.+?\/.+?\/.+$/i</span></span><br><span class="line"><span class="keyword">const</span> exp6 = <span class="regexp">/^(?:https?:\/\/)?github\.com\/.+?\/.+?\/tags.*$/i</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">any</span>&#125; <span class="variable">body</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">number</span>&#125; <span class="variable">status</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Object&lt;string, string&gt;</span>&#125; <span class="variable">headers</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">makeRes</span>(<span class="params">body, status = <span class="number">200</span>, headers = &#123;&#125;</span>) &#123;</span><br><span class="line">    headers[<span class="string">&#x27;access-control-allow-origin&#x27;</span>] = <span class="string">&#x27;*&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(body, &#123;status, headers&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">urlStr</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">newUrl</span>(<span class="params">urlStr</span>) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title function_">URL</span>(urlStr)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="title function_">addEventListener</span>(<span class="string">&#x27;fetch&#x27;</span>, <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> ret = <span class="title function_">fetchHandler</span>(e)</span><br><span class="line">        .<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> <span class="title function_">makeRes</span>(<span class="string">&#x27;cfworker error:\n&#x27;</span> + err.<span class="property">stack</span>, <span class="number">502</span>))</span><br><span class="line">    e.<span class="title function_">respondWith</span>(ret)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">checkUrl</span>(<span class="params">u</span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> [exp1, exp2, exp3, exp4, exp5, exp6]) &#123;</span><br><span class="line">        <span class="keyword">if</span> (u.<span class="title function_">search</span>(i) === <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">FetchEvent</span>&#125; <span class="variable">e</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">fetchHandler</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> req = e.<span class="property">request</span></span><br><span class="line">    <span class="keyword">const</span> urlStr = req.<span class="property">url</span></span><br><span class="line">    <span class="keyword">const</span> urlObj = <span class="keyword">new</span> <span class="title function_">URL</span>(urlStr)</span><br><span class="line">    <span class="keyword">let</span> path = urlObj.<span class="property">searchParams</span>.<span class="title function_">get</span>(<span class="string">&#x27;q&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (path) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Response</span>.<span class="title function_">redirect</span>(<span class="string">&#x27;https://&#x27;</span> + urlObj.<span class="property">host</span> + <span class="variable constant_">PREFIX</span> + path, <span class="number">301</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// cfworker ä¼šæŠŠè·¯å¾„ä¸­çš„ `//` åˆå¹¶æˆ `/`</span></span><br><span class="line">    path = urlObj.<span class="property">href</span>.<span class="title function_">substr</span>(urlObj.<span class="property">origin</span>.<span class="property">length</span> + <span class="variable constant_">PREFIX</span>.<span class="property">length</span>).<span class="title function_">replace</span>(<span class="regexp">/^https?:\/+/</span>, <span class="string">&#x27;https://&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> (path.<span class="title function_">search</span>(exp1) === <span class="number">0</span> || path.<span class="title function_">search</span>(exp5) === <span class="number">0</span> || path.<span class="title function_">search</span>(exp6) === <span class="number">0</span> || path.<span class="title function_">search</span>(exp3) === <span class="number">0</span> || path.<span class="title function_">search</span>(exp4) === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">httpHandler</span>(req, path)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (path.<span class="title function_">search</span>(exp2) === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="title class_">Config</span>.<span class="property">jsdelivr</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> newUrl = path.<span class="title function_">replace</span>(<span class="string">&#x27;/blob/&#x27;</span>, <span class="string">&#x27;@&#x27;</span>).<span class="title function_">replace</span>(<span class="regexp">/^(?:https?:\/\/)?github\.com/</span>, <span class="string">&#x27;https://cdn.jsdelivr.net/gh&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="title class_">Response</span>.<span class="title function_">redirect</span>(newUrl, <span class="number">302</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            path = path.<span class="title function_">replace</span>(<span class="string">&#x27;/blob/&#x27;</span>, <span class="string">&#x27;/raw/&#x27;</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">httpHandler</span>(req, path)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (path.<span class="title function_">search</span>(exp4) === <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> newUrl = path.<span class="title function_">replace</span>(<span class="regexp">/(?&lt;=com\/.+?\/.+?)\/(.+?\/)/</span>, <span class="string">&#x27;@$1&#x27;</span>).<span class="title function_">replace</span>(<span class="regexp">/^(?:https?:\/\/)?raw\.(?:githubusercontent|github)\.com/</span>, <span class="string">&#x27;https://cdn.jsdelivr.net/gh&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="title class_">Response</span>.<span class="title function_">redirect</span>(newUrl, <span class="number">302</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="variable constant_">ASSET_URL</span> + path)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">Request</span>&#125; <span class="variable">req</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">string</span>&#125; <span class="variable">pathname</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">httpHandler</span>(<span class="params">req, pathname</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> reqHdrRaw = req.<span class="property">headers</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// preflight</span></span><br><span class="line">    <span class="keyword">if</span> (req.<span class="property">method</span> === <span class="string">&#x27;OPTIONS&#x27;</span> &amp;&amp;</span><br><span class="line">        reqHdrRaw.<span class="title function_">has</span>(<span class="string">&#x27;access-control-request-headers&#x27;</span>)</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="literal">null</span>, <span class="variable constant_">PREFLIGHT_INIT</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> reqHdrNew = <span class="keyword">new</span> <span class="title class_">Headers</span>(reqHdrRaw)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> urlStr = pathname</span><br><span class="line">    <span class="keyword">let</span> flag = !<span class="title class_">Boolean</span>(whiteList.<span class="property">length</span>)</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">of</span> whiteList) &#123;</span><br><span class="line">        <span class="keyword">if</span> (urlStr.<span class="title function_">includes</span>(i)) &#123;</span><br><span class="line">            flag = <span class="literal">true</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (!flag) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="string">&quot;blocked&quot;</span>, &#123;<span class="attr">status</span>: <span class="number">403</span>&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (urlStr.<span class="title function_">search</span>(<span class="regexp">/^https?:\/\//</span>) !== <span class="number">0</span>) &#123;</span><br><span class="line">        urlStr = <span class="string">&#x27;https://&#x27;</span> + urlStr</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> urlObj = <span class="title function_">newUrl</span>(urlStr)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/** <span class="doctag">@type</span> &#123;<span class="type">RequestInit</span>&#125; */</span></span><br><span class="line">    <span class="keyword">const</span> reqInit = &#123;</span><br><span class="line">        <span class="attr">method</span>: req.<span class="property">method</span>,</span><br><span class="line">        <span class="attr">headers</span>: reqHdrNew,</span><br><span class="line">        <span class="attr">redirect</span>: <span class="string">&#x27;manual&#x27;</span>,</span><br><span class="line">        <span class="attr">body</span>: req.<span class="property">body</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">proxy</span>(urlObj, reqInit)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">URL</span>&#125; <span class="variable">urlObj</span></span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> &#123;<span class="type">RequestInit</span>&#125; <span class="variable">reqInit</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">proxy</span>(<span class="params">urlObj, reqInit</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(urlObj.<span class="property">href</span>, reqInit)</span><br><span class="line">    <span class="keyword">const</span> resHdrOld = res.<span class="property">headers</span></span><br><span class="line">    <span class="keyword">const</span> resHdrNew = <span class="keyword">new</span> <span class="title class_">Headers</span>(resHdrOld)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> status = res.<span class="property">status</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (resHdrNew.<span class="title function_">has</span>(<span class="string">&#x27;location&#x27;</span>)) &#123;</span><br><span class="line">        <span class="keyword">let</span> _location = resHdrNew.<span class="title function_">get</span>(<span class="string">&#x27;location&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_">checkUrl</span>(_location))</span><br><span class="line">            resHdrNew.<span class="title function_">set</span>(<span class="string">&#x27;location&#x27;</span>, <span class="variable constant_">PREFIX</span> + _location)</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            reqInit.<span class="property">redirect</span> = <span class="string">&#x27;follow&#x27;</span></span><br><span class="line">            <span class="keyword">return</span> <span class="title function_">proxy</span>(<span class="title function_">newUrl</span>(_location), reqInit)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    resHdrNew.<span class="title function_">set</span>(<span class="string">&#x27;access-control-expose-headers&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">    resHdrNew.<span class="title function_">set</span>(<span class="string">&#x27;access-control-allow-origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    resHdrNew.<span class="title function_">delete</span>(<span class="string">&#x27;content-security-policy&#x27;</span>)</span><br><span class="line">    resHdrNew.<span class="title function_">delete</span>(<span class="string">&#x27;content-security-policy-report-only&#x27;</span>)</span><br><span class="line">    resHdrNew.<span class="title function_">delete</span>(<span class="string">&#x27;clear-site-data&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(res.<span class="property">body</span>, &#123;</span><br><span class="line">        status,</span><br><span class="line">        <span class="attr">headers</span>: resHdrNew,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²</title>
      <link href="/2024/05/24/spug%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/05/24/spug%E8%87%AA%E5%8A%A8%E5%8C%96%E8%BF%90%E7%BB%B4%E5%B9%B3%E5%8F%B0%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²"><a href="#spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²" class="headerlink" title="spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²"></a>spugè‡ªåŠ¨åŒ–è¿ç»´å¹³å°éƒ¨ç½²</h2><blockquote><p>å¼€æºä¼ä¸šå®˜ç½‘ï¼š<a href="https://www.spug.cc/">https://www.spug.cc</a></p></blockquote><p>docker-composeéƒ¨ç½²</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&quot;3.3&quot;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">mysql:5.7</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">spug-db</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">--port</span> <span class="number">3306</span> <span class="string">--character-set-server=utf8mb4</span> <span class="string">--collation-server=utf8mb4_unicode_ci</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/data/spug/mysql:/var/lib/mysql</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_USER=spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_PASSWORD=spug.cc</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=spug.cc</span></span><br><span class="line">  <span class="attr">spug:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:spug-service</span> </span><br><span class="line">    <span class="comment">#openspug/spug-service</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">spug</span></span><br><span class="line">    <span class="attr">privileged:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/data/spug/service:/data/spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">/data/spug/repos:/data/repos</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="comment"># å¦‚æœ80ç«¯å£è¢«å ç”¨å¯æ›¿æ¢ä¸ºå…¶ä»–ç«¯å£ï¼Œä¾‹å¦‚: - &quot;8000:80&quot;</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;80:80&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_USER=spug</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_PASSWORD=spug.cc</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_HOST=db</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MYSQL_PORT=3306</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">db</span></span><br></pre></td></tr></table></figure><p>åˆå§‹åŒ–ç™»å½•ç®¡ç†å‘˜ç”¨æˆ·,ä»¥ä¸‹æ“ä½œä¼šåˆ›å»ºä¸€ä¸ªç”¨æˆ·åä¸º <code>admin</code> å¯†ç ä¸º <code>test123</code> çš„ç®¡ç†å‘˜è´¦æˆ·ï¼Œå¯è‡ªè¡Œæ›¿æ¢ç®¡ç†å‘˜è´¦æˆ·/å¯†ç ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec spug init_spug admin test123</span><br></pre></td></tr></table></figure><p>ç™»å½•ï¼š<a href="http://localhost/">http://localhost</a></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘é¡µæ·»åŠ  Live2D çœ‹æ¿å¨˜</title>
      <link href="/2024/05/21/%E7%BD%91%E9%A1%B5%E6%B7%BB%E5%8A%A0%20Live2D%20%E7%9C%8B%E6%9D%BF%E5%A8%98/"/>
      <url>/2024/05/21/%E7%BD%91%E9%A1%B5%E6%B7%BB%E5%8A%A0%20Live2D%20%E7%9C%8B%E6%9D%BF%E5%A8%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ç½‘é¡µæ·»åŠ -Live2D-çœ‹æ¿å¨˜"><a href="#ç½‘é¡µæ·»åŠ -Live2D-çœ‹æ¿å¨˜" class="headerlink" title="ç½‘é¡µæ·»åŠ  Live2D çœ‹æ¿å¨˜"></a>ç½‘é¡µæ·»åŠ  Live2D çœ‹æ¿å¨˜</h1><p>å‚è€ƒ/è½¬è½½å¤„ï¼š</p><p><a href="https://www.fghrsh.net/post/123.html">https://www.fghrsh.net/post/123.html</a><br><a href="https://github.com/fghrsh/live2d/_demo">https://github.com/fghrsh/live2d\_demo</a><br><a href="https://www.cnblogs.com/goodmemoryblog/p/14279625.html">https://www.cnblogs.com/goodmemoryblog/p/14279625.html</a><br><a href="https://www.cnblogs.com/yjlaugus/p/8724881.html#/c/subject/p/8724881.html">https://www.cnblogs.com/yjlaugus/p/8724881.html#/c/subject/p/8724881.html</a><br><a href="https://www.cnblogs.com/Lantxy/p/13112000.html">https://www.cnblogs.com/Lantxy/p/13112000.html</a></p><p>æœ¬æ–‡è½¬è½½é“¾æ¥ï¼š<a href="https://www.cnblogs.com/eve-d/p/15683541.html">ç½‘é¡µæ·»åŠ  Live2D çœ‹æ¿å¨˜ï¼ˆèœé¸Ÿçº§è¯¦ç»†æ•™ç¨‹ï¼‰ - å¦–å¦–æœªåˆ - åšå®¢å›­ (cnblogs.com)</a></p><p>Live2Då¼€æºé¡¹ç›®åœ°å€ï¼š</p><p><a href="https://github.com/xiazeyu/live2d-widget-models">https://github.com/xiazeyu/live2d-widget-models</a><br><a href="https://github.com/GEGEWU-CLOUD/live2d-widget-models">https://github.com/GEGEWU-CLOUD/live2d-widget-models</a></p><p>L2Dwidget.min.js å­˜äº:</p><p><a href="https://drive.wn-apple-teawine.fun/api/raw/?path=/public-tools/Live2D/%E9%80%9A%E7%94%A8js/L2Dwidget.min.js">https://drive.wn-apple-teawine.fun/api/raw/?path=/public-tools/Live2D/é€šç”¨js/L2Dwidget.min.js</a></p><p>è®°å½•è‡ªå·±å­¦ä¹ æ“ä½œçš„è¿‡ç¨‹ï¼š<br>çœ‹ç€åˆ«äººåšå®¢ä¸»é¡µçš„çœ‹æ¿å¨˜å¥½èŒå¥½è´´å¿ƒï¼Œè‡ªå·±ä¹Ÿæƒ³å¼„ä¸€ä¸ªå•Šï¼Œæ€ä¹ˆåŠï¼Œä¸ä¼šå•Šã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å½“ã€å½“ã€å½“ï¼Œæœ¬èœé¸Ÿå°†äº²è‡ªå®è·µï¼Œå¼„ä¸€ä¸ªï¼Œæ­¤å¤„è®°å½•è‡ªå·±çš„å­¦ä¹ å®è·µè¿‡ç¨‹ï¼Œä¹Ÿä¾›å¤§å®¶å‚è€ƒã€‚</p><h2 id="ä¸€ã€åŸºæœ¬å·¥ä½œ"><a href="#ä¸€ã€åŸºæœ¬å·¥ä½œ" class="headerlink" title="ä¸€ã€åŸºæœ¬å·¥ä½œ"></a>ä¸€ã€åŸºæœ¬å·¥ä½œ</h2><h3 id="1ã€è¦è‡ªå®šä¹‰åšå®¢ï¼Œé¦–å…ˆç™»å½•è‡ªå·±çš„è´¦å·ï¼Œåœ¨è‡ªå·±åšå®¢ä¸»é¡µæ‰¾åˆ°ç®¡ç†ï¼Œç‚¹å‡»è®¾ç½®"><a href="#1ã€è¦è‡ªå®šä¹‰åšå®¢ï¼Œé¦–å…ˆç™»å½•è‡ªå·±çš„è´¦å·ï¼Œåœ¨è‡ªå·±åšå®¢ä¸»é¡µæ‰¾åˆ°ç®¡ç†ï¼Œç‚¹å‡»è®¾ç½®" class="headerlink" title="1ã€è¦è‡ªå®šä¹‰åšå®¢ï¼Œé¦–å…ˆç™»å½•è‡ªå·±çš„è´¦å·ï¼Œåœ¨è‡ªå·±åšå®¢ä¸»é¡µæ‰¾åˆ°ç®¡ç†ï¼Œç‚¹å‡»è®¾ç½®"></a>1ã€è¦è‡ªå®šä¹‰åšå®¢ï¼Œé¦–å…ˆç™»å½•è‡ªå·±çš„è´¦å·ï¼Œåœ¨è‡ªå·±åšå®¢ä¸»é¡µæ‰¾åˆ°ç®¡ç†ï¼Œç‚¹å‡»è®¾ç½®</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e77040f256eadd57f3446ab8d6e60d16.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e77040f256eadd57f3446ab8d6e60d16.png"></p><h3 id="2ã€ç‚¹å‡»è®¾ç½®åï¼Œè¿›å…¥åˆ°åŸºæœ¬è®¾ç½®é¡µé¢ï¼Œçœ‹æ˜¯å¦æœ‰jsæƒé™ï¼Œå¦‚æœæ²¡æœ‰å°±å…ˆç”³è¯·"><a href="#2ã€ç‚¹å‡»è®¾ç½®åï¼Œè¿›å…¥åˆ°åŸºæœ¬è®¾ç½®é¡µé¢ï¼Œçœ‹æ˜¯å¦æœ‰jsæƒé™ï¼Œå¦‚æœæ²¡æœ‰å°±å…ˆç”³è¯·" class="headerlink" title="2ã€ç‚¹å‡»è®¾ç½®åï¼Œè¿›å…¥åˆ°åŸºæœ¬è®¾ç½®é¡µé¢ï¼Œçœ‹æ˜¯å¦æœ‰jsæƒé™ï¼Œå¦‚æœæ²¡æœ‰å°±å…ˆç”³è¯·"></a>2ã€ç‚¹å‡»è®¾ç½®åï¼Œè¿›å…¥åˆ°åŸºæœ¬è®¾ç½®é¡µé¢ï¼Œçœ‹æ˜¯å¦æœ‰jsæƒé™ï¼Œå¦‚æœæ²¡æœ‰å°±å…ˆç”³è¯·</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_048d8db540e75eec0fd0bbf8e94904b3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_048d8db540e75eec0fd0bbf8e94904b3.png">âš ï¸ï¼šå·²ç»æœ‰äº†jsæƒé™ï¼Œä¸‹é¢çš„æ“ä½œæ‰æœ‰æ•ˆ</p><h2 id="äºŒã€æ·»åŠ çœ‹æ¿å¨˜æ“ä½œ"><a href="#äºŒã€æ·»åŠ çœ‹æ¿å¨˜æ“ä½œ" class="headerlink" title="äºŒã€æ·»åŠ çœ‹æ¿å¨˜æ“ä½œ"></a>äºŒã€æ·»åŠ çœ‹æ¿å¨˜æ“ä½œ</h2><h3 id="1ã€æœ€æœ€æœ€ç²¾ç®€ç‰ˆï¼š"><a href="#1ã€æœ€æœ€æœ€ç²¾ç®€ç‰ˆï¼š" class="headerlink" title="1ã€æœ€æœ€æœ€ç²¾ç®€ç‰ˆï¼š"></a>1ã€æœ€æœ€æœ€ç²¾ç®€ç‰ˆï¼š</h3><p>åœ¨åšå®¢ä¾§è¾¹æ å…¬å‘Šå¤„æ·»åŠ å¦‚ä¸‹ä»£ç </p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_574d813c1585364829bf47ae76ffda46.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_574d813c1585364829bf47ae76ffda46.png"></p><p>ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ç½‘é¡µä¾§è¾¹æ·»åŠ çŒ«å’ª --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://files.cnblogs.com/files/liuzhou1/L2Dwidget.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  L2Dwidget.<span class="title function_">init</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;model&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">jsonPath</span>: <span class="string">&quot;https://unpkg.com/live2d-widget-model-tororo@1.0.5/assets/tororo.model.json&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;scale&quot;</span>: <span class="number">1</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;display&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;position&quot;</span>: <span class="string">&quot;right&quot;</span>, <span class="comment">//æ¨¡å‹çš„è¡¨ç°ä½ç½®</span></span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;width&quot;</span>: <span class="number">150</span>, <span class="comment">//æ¨¡å‹çš„å®½åº¦</span></span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;height&quot;</span>: <span class="number">300</span>, <span class="comment">//æ¨¡å‹çš„é«˜åº¦</span></span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;hOffset&quot;</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;vOffset&quot;</span>: -<span class="number">20</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;mobile&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;show&quot;</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;scale&quot;</span>: <span class="number">0.5</span></span></span><br><span class="line"><span class="language-javascript">  &#125;,</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;react&quot;</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;opacityDefault&quot;</span>: <span class="number">0.7</span>, <span class="comment">//æ¨¡å‹é»˜è®¤é€æ˜åº¦</span></span></span><br><span class="line"><span class="language-javascript">  <span class="string">&quot;opacityOnHover&quot;</span>: <span class="number">0.2</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- ç½‘é¡µä¾§è¾¹æ·»åŠ çŒ«å’ª --&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€åä¿å­˜ï¼Œå³å¯æˆåŠŸ</p><p>ä¸€åªå¯çˆ±çš„å°çŒ«å’ªå°±æœ‰å•¦</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_5ec4c415016c2d8230473f35c8b9898e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_5ec4c415016c2d8230473f35c8b9898e.png"></p><p>å¦‚æœæƒ³æ¢å…¶ä»–æ¨¡ç‰ˆï¼Œå¯ä»¥ä¿®æ”¹ <code>jsonPath</code> çš„è·¯å¾„ï¼Œå¯é€‰çš„æ¨¡å‹ï¼ˆä»æ­¤å¤„æ•´ç†æ¥ï¼š<a href="https://www.cnblogs.com/goodmemoryblog/p/14279625.html%EF%BC%89%E6%9C%89%EF%BC%9A">https://www.cnblogs.com/goodmemoryblog/p/14279625.htmlï¼‰æœ‰ï¼š</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//é»‘çŒ«å’ªï¼šhttps://unpkg.com/live2d-widget-model-hijiki@1.0.5/assets/hijiki.model.json</span><br><span class="line">//ç™½çŒ«å’ªï¼šhttps://unpkg.com/live2d-widget-model-tororo@1.0.5/assets/tororo.model.json</span><br><span class="line">//èŒå¨˜ï¼šhttps://unpkg.com/live2d-widget-model-shizuku@1.0.5/assets/shizuku.model.json</span><br><span class="line">//ç‹—ç‹—ï¼šhttps://unpkg.com/live2d-widget-model-wanko@1.0.5/assets/wanko.model.json</span><br><span class="line">//èŒå¦¹1å·ï¼šhttps://unpkg.com/live2d-widget-model-z16@1.0.5/assets/z16.model.json</span><br><span class="line">//èŒå¦¹2å·ï¼šhttps://unpkg.com/live2d-widget-model-koharu@1.0.5/assets/koharu.model.json</span><br><span class="line">//èŒå¦¹3å·ï¼šhttps://unpkg.com/live2d-widget-model-hibiki@1.0.5/assets/hibiki.model.json</span><br><span class="line">//å¦¹å­4å·ï¼šhttps://unpkg.com/live2d-widget-model-izumi@1.0.5/assets/izumi.model.json</span><br><span class="line">//å¦¹å­5å·ï¼šhttps://unpkg.com/live2d-widget-model-miku@1.0.5/assets/miku.model.json</span><br><span class="line">//6å·ï¼šhttps://unpkg.com/live2d-widget-model-nico@1.0.5/assets/nico.model.json</span><br><span class="line">//7å·ï¼šhttps://unpkg.com/live2d-widget-model-ni-j@1.0.5/assets/ni-j.model.json</span><br><span class="line">//8å·ï¼šhttps://unpkg.com/live2d-widget-model-nipsilon@1.0.5/assets/nipsilon.model.json</span><br><span class="line">//9å·ï¼šhttps://unpkg.com/live2d-widget-model-nito@1.0.5/assets/nito.model.json</span><br><span class="line">//10å·ï¼šhttps://unpkg.com/live2d-widget-model-tsumiki@1.0.5/assets/tsumiki.model.json</span><br><span class="line">//11å·ï¼šhttps://unpkg.com/live2d-widget-model-unitychan@1.0.5/assets/unitychan.model.json</span><br><span class="line">//å¸…å“¥1å·ï¼šhttps://unpkg.com/live2d-widget-model-chitose@1.0.5/assets/chitose.model.json</span><br><span class="line">//å¸…å“¥2å·ï¼šhttps://unpkg.com/live2d-widget-model-haruto@1.0.5/assets/haruto.model.json</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2ã€æ·»åŠ å¯ä»¥è¯´è¯çš„çœ‹æ¿å¨˜ï¼Œæ“ä½œå¦‚ä¸‹ï¼š"><a href="#2ã€æ·»åŠ å¯ä»¥è¯´è¯çš„çœ‹æ¿å¨˜ï¼Œæ“ä½œå¦‚ä¸‹ï¼š" class="headerlink" title="2ã€æ·»åŠ å¯ä»¥è¯´è¯çš„çœ‹æ¿å¨˜ï¼Œæ“ä½œå¦‚ä¸‹ï¼š"></a>2ã€æ·»åŠ å¯ä»¥è¯´è¯çš„çœ‹æ¿å¨˜ï¼Œæ“ä½œå¦‚ä¸‹ï¼š</h3><p>å‚è€ƒåœ°å€ï¼š<a href="https://www.cnblogs.com/Lantxy/p/13112000.html%E3%80%82">https://www.cnblogs.com/Lantxy/p/13112000.htmlã€‚</a> æ„Ÿè°¢ğŸ™åšä¸»</p><p>æˆå“ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8bdf0fcd97ff7dbc79a468a55689bbf5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8bdf0fcd97ff7dbc79a468a55689bbf5.png"></p><p>1ï¼‰åœ¨åŸºæœ¬å·¥ä½œçš„åŸºç¡€ä¸Šï¼ˆåœ¨ç®¡ç†=ã€‹è®¾ç½®é¡µé¢ï¼‰ï¼Œæ‰¾åˆ°é¡µé¢å®šåˆ¶CSSä»£ç ï¼Œå°†ä»£ç æ·»åŠ è¿›å»ï¼Œä¸ç¦ç”¨æ¨¡ç‰ˆé»˜è®¤CSSï¼Œä¸ç„¶é¡µé¢çš„åŸºç¡€ç»“æ„ä¼šä¹±ï¼Œå½“ç„¶ä½ å¯ä»¥è‡ªå·±å»å†™/æ¢æ ·å¼ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_dff8d272ae66a655129e0cefc10d7c8a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_dff8d272ae66a655129e0cefc10d7c8a.png"></p><p>CSSä»£ç ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">*&#123;</span><br><span class="line"><span class="attribute">transition</span>: all <span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#home</span> &#123;</span><br><span class="line"><span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">80%</span>;<span class="comment">/*åŸå§‹65*/</span></span><br><span class="line"><span class="attribute">min-width</span>: <span class="number">980px</span>;<span class="comment">/*é¡µé¢é¡¶éƒ¨çš„å®½åº¦*/</span></span><br><span class="line">&quot;&gt;rgba(<span class="number">245</span>, <span class="number">245</span>, <span class="number">245</span>, <span class="number">0.7</span>);</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">30px</span>;</span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">50px</span>;</span><br><span class="line"><span class="attribute">margin-bottom</span>: <span class="number">50px</span>;</span><br><span class="line"><span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">6px</span> <span class="built_in">rgba</span>(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">0.3</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line"><span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&quot;http://ww4.sinaimg.cn/large/637d0877gw1exlma5gj0wj21hc0u04p6.jpg&quot;</span>);</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">12</span>, <span class="number">100</span>, <span class="number">129</span>, <span class="number">1</span>) <span class="built_in">url</span>(<span class="string">&#x27;http://images.cnblogs.com/cnblogs_com/Penn000/1013849/o_123.jpg&#x27;</span>) fixed no-repeat;</span><br><span class="line"><span class="attribute">background-position</span>: <span class="number">50%</span> <span class="number">5%</span>;</span><br><span class="line"><span class="attribute">background-size</span>: cover;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#navList</span> <span class="selector-tag">li</span>&#123;</span><br><span class="line"><span class="attribute">cursor</span>: pointer;</span><br><span class="line"><span class="attribute">transition</span>: all <span class="number">0.2s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#navList</span> <span class="selector-tag">li</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.5</span>) <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line"><span class="attribute">color</span>:<span class="number">#FF0</span>;</span><br><span class="line"><span class="attribute">opacity</span>:<span class="number">0.5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#blogTitle</span> &#123;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">100px</span>; <span class="comment">/*é«˜åº¦*/</span></span><br><span class="line"><span class="attribute">clear</span>: both;</span><br><span class="line">&quot;&gt;rgba(<span class="number">245</span>, <span class="number">245</span>, <span class="number">245</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#blogTitle</span> <span class="selector-tag">h1</span> &#123;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">36px</span>;</span><br><span class="line"><span class="attribute">font-weight</span>: bold;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">1.8em</span>;<span class="comment">/*åŸå§‹ 1.6em*/</span></span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">10px</span>;<span class="comment">/*åŸå§‹ 15px */</span></span><br><span class="line"><span class="attribute">color</span>: <span class="number">#548B54</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#blogTitle</span> <span class="selector-tag">h2</span> &#123;</span><br><span class="line"><span class="attribute">font-weight</span>: normal;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">17px</span>;<span class="comment">/*åŸå§‹ 16px ï¼›font-size: 1.0rem;*/</span></span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">1.8</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#111</span>;</span><br><span class="line"><span class="attribute">font-weight</span>: bold;</span><br><span class="line"><span class="attribute">text-align</span>: right;</span><br><span class="line"><span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#navigator</span>&#123;</span><br><span class="line">&quot;&gt;rgba(<span class="number">33</span>, <span class="number">160</span>, <span class="number">139</span>, <span class="number">0.9</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#navList</span> <span class="selector-tag">a</span><span class="selector-pseudo">:link</span>, <span class="selector-id">#navList</span> <span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>, <span class="selector-id">#navList</span> <span class="selector-tag">a</span><span class="selector-pseudo">:active</span>&#123;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#eee</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line"><span class="attribute">font-weight</span>: bold;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.blogStats</span>&#123;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#eee</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.postTitle</span> &#123;</span><br><span class="line"><span class="attribute">border-left</span>: <span class="number">8px</span> solid <span class="built_in">rgba</span>(<span class="number">33</span>, <span class="number">160</span>, <span class="number">139</span>, <span class="number">0.68</span>);</span><br><span class="line"><span class="attribute">margin-left</span>: <span class="number">10px</span>;</span><br><span class="line"><span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line"><span class="attribute">float</span>: right;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">clear</span>: both;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.postTitle</span> <span class="selector-tag">a</span><span class="selector-pseudo">:link</span>, <span class="selector-class">.postTitle</span> <span class="selector-tag">a</span><span class="selector-pseudo">:visited</span>, <span class="selector-class">.postTitle</span> <span class="selector-tag">a</span><span class="selector-pseudo">:active</span> &#123;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#21759b</span>;</span><br><span class="line"><span class="attribute">transition</span>: all <span class="number">0.4s</span> linear <span class="number">0s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.postTitle</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line"><span class="attribute">margin-left</span>: <span class="number">30px</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#0f3647</span>;</span><br><span class="line"><span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.postCon</span> &#123;</span><br><span class="line"><span class="attribute">float</span>: right;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">1.5em</span>;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">clear</span>: both;</span><br><span class="line"><span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.day</span> <span class="selector-class">.postTitle</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line"><span class="attribute">padding-left</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.day</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*æ–‡ç« é™„åŠ ä¿¡æ¯*/</span></span><br><span class="line"><span class="selector-class">.postDesc</span> &#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">images/posted_time.png</span>) no-repeat <span class="number">0</span> <span class="number">1px</span>;</span><br><span class="line"><span class="attribute">color</span>: <span class="number">#757575</span>;</span><br><span class="line"><span class="attribute">float</span>: left;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">clear</span>: both;</span><br><span class="line"><span class="attribute">text-align</span>: left;</span><br><span class="line"><span class="attribute">font-family</span>: <span class="string">&quot;å¾®è½¯é›…é»‘&quot;</span> , <span class="string">&quot;å®‹ä½“&quot;</span> , <span class="string">&quot;é»‘ä½“&quot;</span> ,Arial;</span><br><span class="line"><span class="attribute">font-size</span>: <span class="number">13px</span>;</span><br><span class="line"><span class="attribute">padding-right</span>: <span class="number">20px</span>;<span class="comment">/*5px padding-left: 90px;posted å‘è¡¨æ—¶é—´å·¦è¾¹è·ç¦»*/</span></span><br><span class="line"><span class="attribute">margin-top</span>: <span class="number">20px</span>;</span><br><span class="line"><span class="attribute">line-height</span>: <span class="number">1.8</span>;</span><br><span class="line"><span class="attribute">padding-bottom</span>: <span class="number">35px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.newsItem</span>, <span class="selector-class">.catListEssay</span>, <span class="selector-class">.catListLink</span>, <span class="selector-class">.catListNoteBook</span>, <span class="selector-class">.catListTag</span>, <span class="selector-class">.catListPostCategory</span>,</span><br><span class="line"><span class="selector-class">.catListPostArchive</span>, <span class="selector-class">.catListImageCategory</span>, <span class="selector-class">.catListArticleArchive</span>, <span class="selector-class">.catListView</span>,</span><br><span class="line"><span class="selector-class">.catListFeedback</span>, <span class="selector-class">.mySearch</span>, <span class="selector-class">.catListComment</span>, <span class="selector-class">.catListBlogRank</span>, <span class="selector-class">.catList</span>, <span class="selector-class">.catListArticleCategory</span> ,<span class="selector-id">#blog-calendar</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>);</span><br><span class="line"><span class="attribute">margin-bottom</span>: <span class="number">35px</span>;</span><br><span class="line"><span class="attribute">word-wrap</span>: break-word;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.CalTitle</span>&#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.catListTitle</span>&#123;</span><br><span class="line">&quot;&gt;rgba(<span class="number">33</span>, <span class="number">160</span>, <span class="number">139</span>, <span class="number">0.9</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#topics</span>&#123;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.c_ad_block</span>&#123;</span><br><span class="line"><span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#tbCommentBody</span>&#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#q</span>&#123;<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.CalNextPrev</span>&#123;<span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0</span>);&#125;</span><br></pre></td></tr></table></figure><p>2ï¼‰åœ¨åšå®¢ä¾§è¾¹æ åŠ å…¥ï¼Œä¸‹é¢ä»£ç </p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1870159a9879f476f71cf451334326e8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1870159a9879f476f71cf451334326e8.png"></p><p>âš ï¸ï¼šå°†ä»£ç ä¸­çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/waifu.css&quot;</span>/&gt;</span><br><span class="line">&lt;<span class="built_in">link</span> rel=<span class="string">&quot;stylesheet&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;text/css&quot;</span> href=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css&quot;</span>/&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/live2d.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script src=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/waifu-tips.js&quot;</span>&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>æ¢æˆè‡ªå·±çš„é“¾æ¥åœ°å€ï¼Œæ­¥éª¤å¦‚ä¸‹</p><p>iã€å‚è€ƒä¸‹é¢åœ°å€ä¸‹è½½éœ€è¦ä¸Šä¼ çš„æ–‡ä»¶</p><p>âš ï¸ï¼š<a href="https://www.cnblogs.com/Lantxy/p/13112000.html%EF%BC%8C%E5%80%9F%E7%94%A8%E5%8D%9A%E4%B8%BB%E7%9A%84%E4%B8%8B%E8%BD%BD%E5%9C%B0%E5%9D%80%EF%BC%8C%E6%84%9F%E8%B0%A2%F0%9F%99%8F">https://www.cnblogs.com/Lantxy/p/13112000.htmlï¼Œå€Ÿç”¨åšä¸»çš„ä¸‹è½½åœ°å€ï¼Œæ„Ÿè°¢ğŸ™</a></p><p>iiã€å°†4ä¸ªæ–‡ä»¶ä¸‹è½½å¥½ï¼Œåœ¨åšå®¢å›­çš„æ–‡ä»¶ä¸­ä¸Šä¼ ï¼Œç‚¹å‡»è¿›å»ï¼Œå¤åˆ¶ä¸Šé¢åœ°å€æ›¿æ¢ç›¸åº”ä½ç½®</p><p>ç‚¹å‡»æ–‡ä»¶ï¼š</p><p>é€‰æ‹©æ–‡ä»¶ä¸Šä¼ ï¼ŒæˆåŠŸåä¾¿æœ‰ä¸‹é¢å››ä¸ªæ–‡ä»¶ï¼Œç‚¹å‡»ä¸Šä¼ åçš„æ–‡ä»¶</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_99426f652dfc59f2251960920fe4fa99.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_99426f652dfc59f2251960920fe4fa99.png"></p><p>åœ¨è·³è½¬çš„é¡µé¢ï¼Œæ‹¿åˆ°è‡ªå·±çš„é“¾æ¥åœ°å€ï¼Œæ›¿æ¢ç›¸åº”çš„åœ°æ–¹ï¼Œå››ä¸ªæ–‡ä»¶æ­¥éª¤ä¸€æ ·</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1fc3cac4eea4ea295052a0b2c54d42fa.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1fc3cac4eea4ea295052a0b2c54d42fa.png"></p><p>æ·»åŠ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/1999/xhtml&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html; charset=UTF-8&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>Live2D çœ‹æ¿å¨˜ v1.2 / Demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/waifu.css&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;h2&gt;&lt;a href=&quot;https://www.fghrsh.net/post/123.html&quot; style=&quot;color: #38A3DB&quot;&gt;Live2D çœ‹æ¿å¨˜ v1.2&lt;/a&gt; / Demo&lt;/h2&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;touxiangdiv&quot;</span> <span class="attr">align</span>=<span class="string">&quot;center&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">id</span>=<span class="string">&quot;touxiang&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://pic.cnblogs.com/avatar/2063441/20200611132410.png&quot;</span> /&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;waifu&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;waifu-tips&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">id</span>=<span class="string">&quot;live2d&quot;</span> <span class="attr">width</span>=<span class="string">&quot;280&quot;</span> <span class="attr">height</span>=<span class="string">&quot;250&quot;</span> <span class="attr">class</span>=<span class="string">&quot;live2d&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;waifu-tool&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;fui-chat&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;fui-user&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;fui-cross&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/live2d.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/waifu-tips.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"><span class="title function_">initModel</span>(<span class="string">&quot;assets/&quot;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-id">#touxiang</span>&#123;</span></span><br><span class="line"><span class="language-css"><span class="attribute">width</span>:auto;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><p>å…ˆå­˜é—®é¢˜ï¼Œè¿™ä¸ªèµ„æºçš„é“¾æ¥åœ°å€å‡ºäº†çš„ç‚¹é—®é¢˜å¯¼è‡´ï¼Œé¡µé¢çš„çœ‹æ¿å¨˜æ²¡åŠ è½½å‡ºæ¥</p><p>3ã€é«˜çº§ç‰ˆtodoã€‚ã€‚ã€‚</p><link rel="stylesheet" type="text/css" href="https://blog-static.cnblogs.com/files/eve-d/waifu.css"><link rel="stylesheet" type="text/css" href="https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css"><link rel="stylesheet" type="text/css" href="https://blog-static.cnblogs.com/files/eve-d/flat-ui.min.css"><link rel="stylesheet" type="text/css" href="https://blog-static.cnblogs.com/files/eve-d/waifu.css">]]></content>
      
      
      <categories>
          
          <category> Live2D </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Live2D </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜</title>
      <link href="/2024/05/19/linux%E5%AE%BF%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%9C%A8docker%E5%AE%B9%E5%99%A8%E4%B8%AD%E4%B8%8D%E6%89%A7%E8%A1%8C%E9%97%AE%E9%A2%98/"/>
      <url>/2024/05/19/linux%E5%AE%BF%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E5%9C%A8docker%E5%AE%B9%E5%99%A8%E4%B8%AD%E4%B8%8D%E6%89%A7%E8%A1%8C%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜"><a href="#linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜" class="headerlink" title="linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜"></a>linuxå®¿ä¸»æœºé…ç½®å®šæ—¶ä»»åŠ¡åœ¨dockerå®¹å™¨ä¸­ä¸æ‰§è¡Œé—®é¢˜</h2><h3 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><p>å»æ‰äº¤äº’å¼æ‰§è¡Œ-ité€‰æ‹© å¯æ‰§è¡Œæ–‡ä»¶dockerç¼–å†™ä¸ºè·¯å¾„å³<code>/usr/bin/docker</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">10 * * * * /opt/maxkb/cp_logo_create_app_maxkb.sh </span><br><span class="line">0 9 * * * /usr/bin/docker <span class="built_in">exec</span> webstack_mysql bash /home/mysqlbak/webstack-dbbak.sh</span><br><span class="line">0 10 * * * /usr/bin/docker <span class="built_in">exec</span> confluse_mysql bash /home/db_bak_sh/confluence_dbbak.sh</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç </title>
      <link href="/2024/05/16/confluence%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E5%A4%B1%E6%95%88%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/"/>
      <url>/2024/05/16/confluence%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81%E5%A4%B1%E6%95%88%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç "><a href="#confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç " class="headerlink" title="confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç "></a>confluenceç®¡ç†å‘˜å¯†ç å¤±æ•ˆé‡ç½®å¯†ç </h1><p><strong>wiki é‡ç½® admin ç”¨æˆ·å¯†ç </strong></p><p>åœ¨ /var/atlassian/application-data/confluence/confluence.cfg.xml æ–‡ä»¶ä¸­æŸ¥çœ‹ mysql  root ç”¨æˆ·çš„å¯†ç </p><p>é‡ç½® wiki admin ç”¨æˆ·å¯†ç </p><p>mysql&gt; use confluence</p><p>è·å– admin ç”¨æˆ· idï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> u.id, u.user_name, u.active <span class="keyword">from</span> cwd_user u</span><br><span class="line"><span class="keyword">join</span> cwd_membership m <span class="keyword">on</span> u.id<span class="operator">=</span>m.child_user_id <span class="keyword">join</span> cwd_group g <span class="keyword">on</span> m.parent_id<span class="operator">=</span>g.id <span class="keyword">join</span> cwd_directory d <span class="keyword">on</span> d.id<span class="operator">=</span>g.directory_id</span><br><span class="line"><span class="keyword">where</span> g.group_name <span class="operator">=</span> <span class="string">&#x27;confluence-administrators&#x27;</span> <span class="keyword">and</span> d.directory_name<span class="operator">=</span><span class="string">&#x27;Confluence Internal Directory&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å°† admin ç”¨æˆ·å¯†ç é‡ç½®ä¸º admin</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> cwd_user <span class="keyword">set</span> credential <span class="operator">=</span></span><br><span class="line"><span class="string">&#x27;x61Ey612Kl2gpFL56FT9weDnpSo4AV8j8+qx2AuTHdRyY036xxzTTrw10Wq3+4qQyB+XURPWx1ONxp3Y3pB37A==&#x27;</span></span><br><span class="line"><span class="keyword">where</span> id<span class="operator">=</span>xxxxxx;</span><br></pre></td></tr></table></figure><p>æ³¨æ„æ­¤å¤„xxxxxx ä¸ºä¸Šä¸€æ­¥çš„ id</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨</title>
      <link href="/2024/05/15/%E9%83%A8%E7%BD%B2ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%B9%B6%E5%AF%B9%E6%8E%A5maxkb%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/05/15/%E9%83%A8%E7%BD%B2ollama%E6%9C%AC%E5%9C%B0%E5%A4%A7%E6%A8%A1%E5%9E%8B%E5%B9%B6%E5%AF%B9%E6%8E%A5maxkb%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨"><a href="#éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨" class="headerlink" title="éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨"></a>éƒ¨ç½²ollamaæœ¬åœ°å¤§æ¨¡å‹å¹¶å¯¹æ¥maxkbä½¿ç”¨</h1><blockquote><p>githubæ‰˜ç®¡åœ°å€ï¼š</p><p><a href="https://github.com/ollama/ollama">ollama/ollama: Get up and running with Llama 3, Mistral, Gemma, and other large language models. (github.com)</a></p><p>æ¨¡å‹å®˜ç½‘ï¼š</p><p><a href="https://ollama.com/library/llama3">https://ollama.com/library/llama3</a></p><p>qwenæ¨¡å‹ä¸‹è½½åœ°å€ï¼š</p><p><a href="https://huggingface.co/Qwen/Qwen1.5-0.5B-Chat-GGUF/tree/main">https://huggingface.co/Qwen/Qwen1.5-0.5B-Chat-GGUF/tree/main</a></p><p>liama2ä¸‹è½½ï¼š<a href="https://llama-2.ai/download/">https://llama-2.ai/download/</a></p><p>liama3ä¸‹è½½ï¼š<a href="https://llama.meta.com/llama-downloads/">Download Llama (meta.com)</a></p><p><strong>Llama3-8B-Instructæ¨¡å‹ä¸‹è½½åœ°å€ï¼š</strong></p><p>é­”æ­ç¤¾åŒºï¼ˆå¢ƒå†…ï¼‰ï¼š<a href="https://caovan.com/go?_=48ce46a27aaHR0cHM6Ly9tb2RlbHNjb3BlLmNuL21vZGVscy9MTE0tUmVzZWFyY2gvTWV0YS1MbGFtYS0zLThCLUluc3RydWN0L2ZpbGVz">https://modelscope.cn/models/LLM-Research/Meta-Llama-3-8B-Instruct/files</a></p><p>huggingfaceï¼ˆå¢ƒå¤–ï¼‰ï¼š<a href="https://caovan.com/go?_=72db84b679aHR0cHM6Ly9odWdnaW5nZmFjZS5jby9tZXRhLWxsYW1hL01ldGEtTGxhbWEtMy04Qi1JbnN0cnVjdC90cmVlL21haW4=">https://huggingface.co/meta-llama/Meta-Llama-3-8B-Instruct/tree/main</a></p><p><a href="https://caovan.com/tag/603" title="LLaMA-Factory">LLaMA-Factory</a>é¡¹ç›®åœ°å€ï¼š<a href="https://caovan.com/go?_=8c0f2d3483aHR0cHM6Ly9naXRodWIuY29tL2hpeW91Z2EvTExhTUEtRmFjdG9yeQ==">https://github.com/hiyouga/LLaMA-Factory</a></p><p>llama2ä¸­æ–‡æ¨¡å‹å‚æ•°è¯¦æƒ…ï¼š<a href="https://ollama.com/library/llama2-chinese:7b">llama2-chinese:7b (ollama.com)</a></p><p><strong>Llama3æ¨¡å‹ä¸­æ–‡å¾®è°ƒç‰ˆä¸‹è½½åœ°å€ï¼ˆé“¾æ¥ä¸­æœ‰ä¸‹è½½åœ°å€ï¼‰</strong></p><p><a href="https://github.com/GEGEWU-CLOUD/Llama-Chinese">https://github.com/GEGEWU-CLOUD/Llama-Chinese</a></p><p>Llama 3çš„äº®ç‚¹å’Œç‰¹æ€§å¦‚ä¸‹ï¼š</p><p>åŸºäºè¶…è¿‡15T tokenè®­ç»ƒï¼Œå¤§å°ç›¸å½“äºLlama 2æ•°æ®é›†çš„7å€è¿˜å¤šï¼›<br>è®­ç»ƒæ•ˆç‡æ¯”Llama 2é«˜3å€ï¼›<br>æ”¯æŒ8Ké•¿æ–‡æœ¬ï¼Œæ”¹è¿›çš„tokenizerå…·æœ‰128K tokençš„è¯æ±‡é‡ï¼Œå¯å®ç°æ›´å¥½çš„æ€§èƒ½ï¼›<br>åœ¨å¤§é‡é‡è¦åŸºå‡†æµ‹è¯•ä¸­å‡å…·æœ‰æœ€å…ˆè¿›æ€§èƒ½ï¼›<br>å¢å¼ºæ¨ç†å’Œä»£ç èƒ½åŠ›ï¼›<br>å®‰å…¨æ€§æœ‰é‡å¤§çªç ´ï¼Œå¸¦æœ‰Llama Guard 2ã€Code Shield å’Œ CyberSec Eval 2çš„æ–°ç‰ˆä¿¡ä»»å’Œå®‰å…¨å·¥å…·ï¼Œè¿˜èƒ½æ¯”Llama 2æœ‰æ›´å¥½â€œé”™è¯¯æ‹’ç»è¡¨ç°â€ã€‚</p><p><strong>Ollamaæ˜¯ä»€ä¹ˆ?</strong><br>Olamaæ˜¯ä¸€ä¸ªå…ˆè¿›çš„AIå·¥å…·ï¼Œå®ƒå…è®¸ç”¨æˆ·åœ¨è‡ªå·±çš„ç”µè„‘ä¸Š(ç›®å‰æ”¯æŒmacOså’ŒLinuxï¼ŒWindowså³å°†æ¨å‡º)è½»æ¾è®¾ç½®å’Œè¿è¡Œå¤§å‹è¯­è¨€æ¨¡å‹(LLMs)ã€‚è¿™ä¸ªå·¥å…·çš„äº®ç‚¹åœ¨äºï¼Œå®ƒä¸ä»…æ”¯æŒè¿è¡Œå¦‚Lama 2è¿™æ ·çš„å¼ºå¤§è¯­è¨€æ¨¡å‹ï¼Œè¿˜å…è®¸ç”¨æˆ·è‡ªå®šä¹‰å’Œåˆ›å»ºè‡ªå·±çš„æ¨¡å‹ã€‚</p><p>Metaå‘å¸ƒäº†Llama 3æ¨¡å‹å¯ä½¿ç”¨ollamaéƒ¨ç½²ï¼Œå®˜æ–¹ä»‹ç»æ–‡æ¡£<a href="https://link.zhihu.com/?target=https://ai.meta.com/blog/meta-llama-3/">åœ¨è¿™</a>ã€‚æ€»ç»“ä¸€ä¸‹é‡ç‚¹å†…å®¹ï¼š</p><ol><li><p>æœ¬æ¬¡å…±å‘å¸ƒäº†Llama 8B, 70Bçš„æ¨¡å‹ï¼Œ70Bæ€§èƒ½è¶…è¶ŠGPT3.5ï¼›</p></li><li><p>é¢„å‘Šäº†æ­£åœ¨è®­ç»ƒä¸­çš„400B+æ¨¡å‹ï¼Œæ€§èƒ½è¿½èµ¶GPT4ï¼›</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_767b2d80d661dabc0a5cdffbfcceaf69.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_767b2d80d661dabc0a5cdffbfcceaf69.png"></p><p>å‚è€ƒæ–‡æ¡£ï¼š<a href="https://zhuanlan.zhihu.com/p/693709600">Llama 3 ä½¿ç”¨æ–¹æ³•ä»¥åŠæ¨¡å‹ä¸‹è½½æ•™ç¨‹ - çŸ¥ä¹ (zhihu.com)</a></p></li></ol><p><strong>clone/ä¸‹è½½githubæºç </strong></p><p>åœ¨metaå…¬å¸ƒçš„githubç½‘é¡µ(<a href="https://link.zhihu.com/?target=https://github.com/meta-llama/llama3">https://<strong>github.com/meta-llama/l</strong>lama3</a>)ä¸­ï¼Œcloneæˆ–è€…ä¸‹è½½å¥½æºä»£ç ã€‚</p><p><strong>å…³äºåŸŸåæ— æ•ˆçš„è§£å†³æ–¹æ¡ˆ</strong></p><p><a href="https://bbs.fit2cloud.com/t/topic/4165/4">MaxKB å¯¹æ¥Ollamaæ¨¡å‹æ—¶ï¼Œæç¤º API åŸŸåä¸å¯ç”¨ - MaxKB - ç¤¾åŒºè®ºå› - FIT2CLOUD é£è‡´äº‘</a></p><p><strong>Ollamaä¸»è¦åŠŸèƒ½</strong></p><ul><li>æœ¬åœ°è¯­è¨€æ¨¡å‹æ‰§è¡Œ:Ollamaä½¿ç”¨æˆ·èƒ½å¤Ÿåœ¨æœ¬åœ°è¿è¡Œå¤§å‹è¯­è¨€æ¨¡å‹ï¼Œæä¾›æ›´å¿«ã€æ›´é«˜æ•ˆçš„å¤„ç†èƒ½åŠ›ã€‚</li><li>Llama 2æ¨¡å‹:ç”¨æˆ·å¯ä»¥åˆ©ç”¨Lama 2è¯­è¨€æ¨¡å‹ï¼Œè¯¥æ¨¡å‹æä¾›å…ˆè¿›çš„è‡ªç„¶è¯­è¨€å¤„ç†èƒ½åŠ›ï¼Œé€‚ç”¨äºå¹¿æ³›çš„åº”ç”¨åœºæ™¯</li><li>æ¨¡å‹å®šåˆ¶:Ollamaå…è®¸ç”¨æˆ·æ ¹æ®ç‰¹å®šä»»åŠ¡å’Œéœ€æ±‚å®šåˆ¶å’Œåˆ›å»ºè‡ªå·±çš„è¯­è¨€å‹ã€‚</li><li>æ˜“äºè®¾ç½®:è¯¥å·¥å…·æä¾›ç”¨æˆ·å‹å¥½çš„ç•Œé¢ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿå¿«é€Ÿå¯åŠ¨å¹¶è¿è¡Œæ‰€é€‰è¯­è¨€æ¨¡å‹ã€‚</li><li>å¹³å°å…¼å®¹æ€§:ç›®å‰Ollamaæ”¯æŒmacOSï¼Œç¡®ä¿ä¸macOSç³»ç»Ÿçš„æ— ç¼é›†æˆã€‚</li></ul><p><strong>æ”¯æŒçš„æ¨¡å‹</strong></p><table><thead><tr><th>Model</th><th>Parameters</th><th>Size</th><th>Download</th></tr></thead><tbody><tr><td>Llama 3</td><td>8B</td><td>4.7GB</td><td><code>ollama run llama3</code></td></tr><tr><td>Llama 3</td><td>70B</td><td>40GB</td><td><code>ollama run llama3:70b</code></td></tr><tr><td>Phi-3</td><td>3.8B</td><td>2.3GB</td><td><code>ollama run phi3</code></td></tr><tr><td>Mistral</td><td>7B</td><td>4.1GB</td><td><code>ollama run mistral</code></td></tr><tr><td>Neural Chat</td><td>7B</td><td>4.1GB</td><td><code>ollama run neural-chat</code></td></tr><tr><td>Starling</td><td>7B</td><td>4.1GB</td><td><code>ollama run starling-lm</code></td></tr><tr><td>Code Llama</td><td>7B</td><td>3.8GB</td><td><code>ollama run codellama</code></td></tr><tr><td>Llama 2 Uncensored</td><td>7B</td><td>3.8GB</td><td><code>ollama run llama2-uncensored</code></td></tr><tr><td>LLaVA</td><td>7B</td><td>4.5GB</td><td><code>ollama run llava</code></td></tr><tr><td>Gemma</td><td>2B</td><td>1.4GB</td><td><code>ollama run gemma:2b</code></td></tr><tr><td>Gemma</td><td>7B</td><td>4.8GB</td><td><code>ollama run gemma:7b</code></td></tr><tr><td>Solar</td><td>10.7B</td><td>6.1GB</td><td><code>ollama run solar</code></td></tr></tbody></table></blockquote><h2 id="ä¸€-éƒ¨ç½²"><a href="#ä¸€-éƒ¨ç½²" class="headerlink" title="ä¸€. éƒ¨ç½²"></a>ä¸€. éƒ¨ç½²</h2><h3 id="CPUç‰ˆæœ¬éƒ¨ç½²"><a href="#CPUç‰ˆæœ¬éƒ¨ç½²" class="headerlink" title="CPUç‰ˆæœ¬éƒ¨ç½²"></a>CPUç‰ˆæœ¬éƒ¨ç½²</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cpuæ¨¡å¼</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">ollama:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:ollama</span></span><br><span class="line">    <span class="comment">#ollama/ollama</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">ollama</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./ollama:/root/.ollama</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;11434:11434&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:open-webui-main</span> </span><br><span class="line">    <span class="comment">#ghcr.io/open-webui/open-webui:main</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">open-webui</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3000:8080&quot;</span></span><br><span class="line">    <span class="attr">extra_hosts:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;host.docker.internal:host-gateway&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">open-webui:/app/backend/data</span></span><br><span class="line"></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="attr">open-webui:</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="GPUç‰ˆæœ¬éƒ¨ç½²"><a href="#GPUç‰ˆæœ¬éƒ¨ç½²" class="headerlink" title="GPUç‰ˆæœ¬éƒ¨ç½²"></a>GPUç‰ˆæœ¬éƒ¨ç½²</h3><h3 id="GPUæ¨¡å¼ï¼ˆéœ€è¦æœ‰NVIDIAæ˜¾å¡æ”¯æŒï¼‰"><a href="#GPUæ¨¡å¼ï¼ˆéœ€è¦æœ‰NVIDIAæ˜¾å¡æ”¯æŒï¼‰" class="headerlink" title="GPUæ¨¡å¼ï¼ˆéœ€è¦æœ‰NVIDIAæ˜¾å¡æ”¯æŒï¼‰"></a>GPUæ¨¡å¼ï¼ˆéœ€è¦æœ‰NVIDIAæ˜¾å¡æ”¯æŒï¼‰</h3><h4 id="å®‰è£…è‹±ä¼Ÿè¾¾å®¹å™¨å·¥å…·åŒ…ï¼ˆä»¥Ubuntu22-04ä¸ºä¾‹ï¼‰"><a href="#å®‰è£…è‹±ä¼Ÿè¾¾å®¹å™¨å·¥å…·åŒ…ï¼ˆä»¥Ubuntu22-04ä¸ºä¾‹ï¼‰" class="headerlink" title="å®‰è£…è‹±ä¼Ÿè¾¾å®¹å™¨å·¥å…·åŒ…ï¼ˆä»¥Ubuntu22.04ä¸ºä¾‹ï¼‰"></a>å®‰è£…<a href="https://so.csdn.net/so/search?q=%E8%8B%B1%E4%BC%9F%E8%BE%BE&spm=1001.2101.3001.7020">è‹±ä¼Ÿè¾¾</a>å®¹å™¨å·¥å…·åŒ…ï¼ˆä»¥Ubuntu22.04ä¸ºä¾‹ï¼‰</h4><p>å…¶ä»–ç³»ç»Ÿè¯·å‚è€ƒï¼š<a href="https://docs.nvidia.com/datacenter/cloud-native/container-toolkit/latest/arch-overview.html">è‹±ä¼Ÿè¾¾å®˜æ–¹æ–‡æ¡£</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1.é…ç½®aptæº</span></span><br><span class="line">curl -fsSL https://nvidia.github.io/libnvidia-container/gpgkey | sudo gpg --dearmor -o /usr/share/keyrings/nvidia-container-toolkit-keyring.gpg \</span><br><span class="line">  &amp;&amp; curl -s -L https://nvidia.github.io/libnvidia-container/stable/deb/nvidia-container-toolkit.list | \</span><br><span class="line">    sed <span class="string">&#x27;s#deb https://#deb [signed-by=/usr/share/keyrings/nvidia-container-toolkit-keyring.gpg] https://#g&#x27;</span> | \</span><br><span class="line">    sudo <span class="built_in">tee</span> /etc/apt/sources.list.d/nvidia-container-toolkit.list</span><br><span class="line"><span class="comment"># 2.æ›´æ–°æº</span></span><br><span class="line">sudo apt-get update</span><br><span class="line"><span class="comment"># 3.å®‰è£…å·¥å…·åŒ…</span></span><br><span class="line">sudo apt-get install -y nvidia-container-toolkit</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.7&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">ollama:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">ollama/ollama</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">ollama</span></span><br><span class="line">    <span class="attr">runtime:</span> <span class="string">nvidia</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./ollama:/root/.ollama</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;11434:11434&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²å®Œæˆåè½½å…¥å¤§æ¨¡å‹(CPU GPUç›¸åŒ)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç”Ÿæ•ˆä¸Šä¼ çš„æ¨¡å‹æ–‡ä»¶</span></span><br><span class="line">docker-compose restart</span><br><span class="line"><span class="comment"># å¯åŠ¨qwen:4bæ¨¡å‹</span></span><br><span class="line">docker <span class="built_in">exec</span> -it ollama ollama run qwen:4b-chat</span><br></pre></td></tr></table></figure><p>å¤‡æ³¨ï¼šå¼€å¯ä»£ç†åœ¨æœ¬æœºä¸‹è½½å®Œæˆä¹‹å ä¼šåœ¨å½“å‰ç›®å½•ollamaæ–‡ä»¶å¤¹ ç”Ÿæˆä¸€ä¸ªmodelsçš„æ–‡ä»¶å¤¹æ¨¡å‹æ–‡ä»¶å°±å­˜äºå…¶ä¸­ åªéœ€è¦å°†æ­¤æ–‡ä»¶å¤¹å‹ç¼©ä¸Šä¼ åˆ°æœåŠ¡å™¨å å†æ¬¡æ‰§è¡Œæ­¤é¡¹å‘½ä»¤æœåŠ¡å™¨ä¸Šæ¨¡å‹å³å¯éƒ¨ç½²å®Œæˆ <strong>ä¸Šä¼ åéœ€è¦é‡å¯å®¹å™¨docker-compose restartå†æ‰§è¡Œrunå³å¯</strong>ã€‚</p><p>å»ºè®®ï¼šæœ€å¥½å°†æ•´ä¸ªé¡¹ç›®æ–‡ä»¶åŒ…å«docker-composeæ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨æ‰§è¡Œç›¸åº”æ“ä½œUP ollama createç­‰ã€‚</p><p>llama3:8bæ•ˆæœï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_a21d90e141ec4f1cce9354171386e840.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_a21d90e141ec4f1cce9354171386e840.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_d4f9773272728a7238a432b06356f0ce.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_d4f9773272728a7238a432b06356f0ce.png"></p><h2 id="äºŒ-Ollama-ä¸­-ç¦»çº¿éƒ¨ç½²-qwen-0-5b-æ¨¡å‹ä¸ºä¾‹ã€‚"><a href="#äºŒ-Ollama-ä¸­-ç¦»çº¿éƒ¨ç½²-qwen-0-5b-æ¨¡å‹ä¸ºä¾‹ã€‚" class="headerlink" title="äºŒ. Ollama ä¸­ ç¦»çº¿éƒ¨ç½² qwen:0.5b æ¨¡å‹ä¸ºä¾‹ã€‚"></a>äºŒ. Ollama ä¸­ <strong>ç¦»çº¿éƒ¨ç½²</strong> qwen:0.5b æ¨¡å‹ä¸ºä¾‹ã€‚</h2><p><strong>1. ä¸‹è½½æ¨¡å‹</strong></p><p>è®¿é—® huggingface ä¸‹è½½ qwen1_5-0_5b-chat-q5_k_m.gguf æ¨¡å‹ã€‚</p><p><a href="https://huggingface.co/Qwen/Qwen1.5-0.5B-Chat-GGUF/tree/main">https://huggingface.co/Qwen/Qwen1.5-0.5B-Chat-GGUF/tree/main</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f93341707d2e1b6931f22cad2d81db8a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f93341707d2e1b6931f22cad2d81db8a.png"></p><p><strong>2. ä¸Šä¼  Qwen1.5-0.5B-Chat-GGUF æ¨¡å‹ç¦»çº¿æ–‡ä»¶åˆ° Ollama æ‰€åœ¨æœåŠ¡å™¨</strong></p><p><strong>3. åˆ›å»ºOllama Modelfile</strong></p><p>åˆ›å»ºä¸€ä¸ªåä¸º Modelfile çš„æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">FROM ./qwen1_5-0_5b-chat-q5_k_m.gguf</span><br><span class="line"></span><br><span class="line">TEMPLATE &quot;&quot;&quot;&#123;&#123; if .System &#125;&#125;&lt;|im_start|&gt;system</span><br><span class="line">&#123;&#123; .System &#125;&#125;&lt;|im_end|&gt;&#123;&#123; end &#125;&#125;&lt;|im_start|&gt;user</span><br><span class="line">&#123;&#123; .Prompt &#125;&#125;&lt;|im_end|&gt;</span><br><span class="line">&lt;|im_start|&gt;assistant</span><br><span class="line">&quot;&quot;&quot;</span><br><span class="line"></span><br><span class="line">PARAMETER stop &quot;&lt;|im_start|&gt;&quot;</span><br><span class="line">PARAMETER stop &quot;&lt;|im_end|&gt;&quot;</span><br></pre></td></tr></table></figure><p>è¯´æ˜ï¼šä¸åŒæ¨¡å‹çš„ Modelfile å†…å®¹ä¸åŒï¼Œå¯å‚è€ƒ Ollama å®˜ç½‘ <a href="https://ollama.com/library/qwen:0.5b">å‚æ•°è®¾ç½®</a> ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8bbd7faef16aaea28633b9c3ed3a9415.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8bbd7faef16aaea28633b9c3ed3a9415.png"></p><p><strong>4. åœ¨Ollamaä¸­åˆ›å»ºæ¨¡å‹</strong></p><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºæ¨¡å‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama create qwen:0.5b -f Modelfile</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œç¡®è®¤æ¨¡å‹å­˜åœ¨ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ollama list</span><br></pre></td></tr></table></figure><p><strong>5. åœ¨ MaxKBä¸­ æ·»åŠ  Ollama æ¨¡å‹ å¯¹æ¥ä¸Šé¢åˆ›å»ºçš„ qwen:0.5b æ¨¡å‹</strong></p><p><strong>æ•ˆæœ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_021ed55c6e8335c07278795effa9572b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_021ed55c6e8335c07278795effa9572b.png"></p><h2 id="ä¸‰-å¯¹æ¥å®˜æ–¹webé¢æ¿open-webui-main"><a href="#ä¸‰-å¯¹æ¥å®˜æ–¹webé¢æ¿open-webui-main" class="headerlink" title="ä¸‰. å¯¹æ¥å®˜æ–¹webé¢æ¿open-webui-main"></a>ä¸‰. å¯¹æ¥å®˜æ–¹webé¢æ¿open-webui-main</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e98184a52ba387311de9a9d1f3759c29.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e98184a52ba387311de9a9d1f3759c29.png"></p><h2 id="å››-å¯¹æ¥MaxKB"><a href="#å››-å¯¹æ¥MaxKB" class="headerlink" title="å››. å¯¹æ¥MaxKB"></a>å››. å¯¹æ¥MaxKB</h2><p>è§é“¾æ¥ï¼š<a href="https://blog.fit2cloud.com/?p=3fc407b2-1962-4196-b5b8-c7d27684b446">https://blog.fit2cloud.com/?p=3fc407b2-1962-4196-b5b8-c7d27684b446</a></p><p>å¤‡æ³¨ï¼šapi-keyæ²¡æœ‰å¯éšä¾¿è¾“å³å¯</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_9523bdac22c80d831c4daf934b10cdf3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_9523bdac22c80d831c4daf934b10cdf3.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/qq_38593436/article/details/136407171">https://blog.csdn.net/qq_38593436/article/details/136407171</a></p><p><a href="https://blog.csdn.net/weixin_43012017/article/details/138253446">https://blog.csdn.net/weixin_43012017/article/details/138253446</a></p><p><a href="https://blog.fit2cloud.com/?p=3fc407b2-1962-4196-b5b8-c7d27684b446">https://blog.fit2cloud.com/?p=3fc407b2-1962-4196-b5b8-c7d27684b446</a></p><p><a href="https://github.com/1Panel-dev/MaxKB/wiki/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8Ollama%E7%A6%BB%E7%BA%BF%E9%83%A8%E7%BD%B2LLM%E5%A4%A7%E8%AF%AD%E8%A8%80%E6%A8%A1%E5%9E%8B">å¦‚ä½•ä½¿ç”¨Ollamaç¦»çº¿éƒ¨ç½²LLMå¤§è¯­è¨€æ¨¡å‹ Â· 1Panel-dev/MaxKB Wiki (github.com)</a></p><p><a href="https://wiki.eryajf.net/pages/97047e/#%E6%A8%A1%E5%9E%8B%E7%AE%A1%E7%90%86">å¸¦ä½ è®¤è¯†æœ¬åœ°å¤§è¯­è¨€æ¨¡å‹æ¡†æ¶Ollama(å¯ç›´æ¥ä¸Šæ‰‹) | äºŒä¸«è®²æ¢µ (eryajf.net)</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centosé…ç½®vlan</title>
      <link href="/2024/05/14/centos%E9%85%8D%E7%BD%AEvlan/"/>
      <url>/2024/05/14/centos%E9%85%8D%E7%BD%AEvlan/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="centosé…ç½®vlan"><a href="#centosé…ç½®vlan" class="headerlink" title="centosé…ç½®vlan"></a>centosé…ç½®vlan</h1><h2 id="ä¸€-ç½‘ä¸Šå¤§ä½¬æ–¹å¼ï¼ˆæµ‹è¯•æœªé€šè¿‡ï¼‰"><a href="#ä¸€-ç½‘ä¸Šå¤§ä½¬æ–¹å¼ï¼ˆæµ‹è¯•æœªé€šè¿‡ï¼‰" class="headerlink" title="ä¸€. ç½‘ä¸Šå¤§ä½¬æ–¹å¼ï¼ˆæµ‹è¯•æœªé€šè¿‡ï¼‰"></a>ä¸€. ç½‘ä¸Šå¤§ä½¬æ–¹å¼ï¼ˆæµ‹è¯•æœªé€šè¿‡ï¼‰</h2><ol><li>å®‰è£…ä¾èµ–åŒ…</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install vconfig -y</span><br></pre></td></tr></table></figure><ol start="2"><li>æŸ¥çœ‹æ ¸å¿ƒæ˜¯å¦æä¾›VLAN åŠŸèƒ½</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dmesg | grep -i 802</span><br><span class="line"> </span><br><span class="line">[root@c159 network-scripts]<span class="comment"># dmesg |grep -i 802</span></span><br><span class="line">[    0.318021] pci 0000:00:16.5: [15ad:07a0] <span class="built_in">type</span> 01 class 0x060400</span><br><span class="line">[    0.398023] pci 0000:00:16.2:   bridge window [mem 0xeb100000-0xeb1fffff 64bit pref]</span><br><span class="line">[    1.120802] Key <span class="built_in">type</span> trusted registered</span><br><span class="line">[12888.091996] 8021q: 802.1Q VLAN Support v1.8</span><br><span class="line">[12888.092019] 8021q: adding VLAN 0 to HW filter on device ens192</span><br><span class="line">[12888.092511] 8021q: adding VLAN 0 to HW filter on device ens224</span><br></pre></td></tr></table></figure><ol start="3"><li>æŸ¥çœ‹<code>/proc/net/vlan</code>ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œä½¿ç”¨<code>modprobe</code>æ¨¡å‘½ä»¤è¿›å…¥<code>802.1q.o</code>ï¼Œä¸”ä½¿ç”¨<code>lsmod</code>å‘½ä»¤æ¨¡æ˜¯å¦å·²å…¥æ ¸å¿ƒ</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">modprobe 8021q</span><br><span class="line"> </span><br><span class="line">[root@c159 network-scripts]<span class="comment"># lsmod |grep 802</span></span><br><span class="line">8021q                  33159  0</span><br><span class="line">garp                   14384  1 8021q</span><br><span class="line">mrp                    18542  1 8021q</span><br></pre></td></tr></table></figure><ol start="4"><li>ä½¿ç”¨vconfigå‘½ä»¤å¢åŠ å­æ¥å£:</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vconfig add ens224 60</span><br></pre></td></tr></table></figure><ol start="5"><li>åˆ©ç”¨<code>ls /proc/net/vlan</code>æŸ¥çœ‹</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@c159 network-scripts]<span class="comment"># ls /proc/net/vlan/</span></span><br><span class="line">config  ens224.60  ens224.20  ens224.30</span><br></pre></td></tr></table></figure><p><strong>å¦‚æ²¡æœ‰vconfigåŒ…åˆ™ä¿®æ”¹é…ç½®æ–‡ä»¶å³å¯ï¼ˆè§å…­ä»¥ä¸‹æ­¥éª¤ï¼‰</strong></p><ol start="6"><li>ä¿®æ”¹ç½‘å¡é…ç½®ï¼š</li></ol><p>ifcfg-ens224é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/sysconfig/network-scripts/</span><br><span class="line"><span class="built_in">cp</span> ifcfg-ens224 ifcfg-ens224.60</span><br><span class="line"> </span><br><span class="line">vim ifcfg-ens224</span><br><span class="line"> </span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none  //æ­¤é¡¹dhcpå¯¹vlanç«¯å£æ— å½±å“ï¼Œå¦‚ä¸æ”¾å¿ƒï¼Œå¯æ”¹æˆstatic</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens224</span><br><span class="line">DEVICE=ens224</span><br><span class="line">ONBOOT=no  //æ­¤é¡¹<span class="built_in">yes</span>æˆ–noï¼Œå¯¹vlanç«¯å£æ— å½±å“</span><br></pre></td></tr></table></figure><p>å¯¹åº”vlançš„é…ç½®æ–‡ä»¶ä¸­UUIDä¸€å®šè¦åˆ æ‰ï¼Œä¸ç„¶ä¼šå‡ºç°ä¸å¯çŸ¥çš„é—®é¢˜</p><p>ifcfg-ens224.60é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">vim ifcfg-ens224.60</span><br><span class="line">TYPE=vlan        //TYPEç±»å‹</span><br><span class="line">PHYSDEV=ens224      //vlanç«¯å£å¯¹åº”ç‰©ç†ç¡¬ä»¶åç§°</span><br><span class="line">VLAN_ID=60     //VLAN ID</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens224.60</span><br><span class="line">DEVICE=ens224.60</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">VLAN=<span class="built_in">yes</span>              //è®¾ç½®å…è®¸vlan</span><br><span class="line">IPADDR=10.0.0.80</span><br><span class="line">NETMASK=255.255.255.0</span><br></pre></td></tr></table></figure><h2 id="äºŒ-ç›´æ¥åœ¨ä¸»ç½‘å¡ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰"><a href="#äºŒ-ç›´æ¥åœ¨ä¸»ç½‘å¡ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰" class="headerlink" title="äºŒ. ç›´æ¥åœ¨ä¸»ç½‘å¡ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰"></a>äºŒ. ç›´æ¥åœ¨ä¸»ç½‘å¡ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰</h2><table><thead><tr><th>vlanå†…ç½‘10.0.1.æ®µåœ°å€vlan id</th><th>vlan60</th><th>vlan60</th></tr></thead><tbody><tr><td><strong>æœºå™¨åç§°</strong></td><td>centos1</td><td>centos2</td></tr><tr><td><strong>vlanå†…ç½‘åœ°å€</strong><br><br></td><td>10.0.1.60</td><td>10.0.1.61</td></tr><tr><td><strong>å¤–ç½‘åœ°å€</strong></td><td>10.0.0.10</td><td>10.0.0.128<br></td></tr></tbody></table><blockquote><p>æœ¬æ¬¡ç¯å¢ƒä½¿ç”¨ vmware æ¨¡æ‹Ÿ</p><p>ä¸€å°centos7 ä¸€å°centos8</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_d1ed2ec5c1b9dfd1d195e5b96d71c0f3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_d1ed2ec5c1b9dfd1d195e5b96d71c0f3.png"></p><p><code>GATEWAY</code> æ­¤å‚æ•°æ ¹æ®æƒ…å†µè€ƒè™‘æ˜¯å¦æ·»åŠ </p><p>å¦‚ï¼šåŒç½‘å¡ä¸åŒIPæƒ…å†µ åªå…è®¸æœ‰ä¸€ä¸ªé»˜è®¤ç½‘å…³ å¦‚æœå¦ä¸€å¼ ç½‘å¡éœ€è¦é…ç½®å¤–ç½‘IP é‚£ä¹ˆåªå…è®¸è§„å®šå¤–ç½‘IPçš„ç½‘å¡é…ç½®å¤–ç½‘ç½‘å…³</p><p><code>VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</code> æ˜¯ç½‘ç»œé…ç½®æ–‡ä»¶ä¸­çš„ä¸€ä¸ªé€‰é¡¹ï¼Œå®ƒæŒ‡å®šäº† VLAN æ ‡ç­¾çš„æ ¼å¼ã€‚</p><ul><li><code>VLAN_PLUS_VID_NO_PAD</code> è¡¨ç¤º VLAN æ ‡ç­¾ä»¥ â€œVLANâ€ å¼€å¤´ï¼Œåè·Ÿ VLAN IDï¼Œä¾‹å¦‚ â€œVLAN80â€ã€‚</li><li><code>NO_PAD</code> è¡¨ç¤º VLAN ID ä¸ä¼šåœ¨å‰é¢å¡«å……é›¶ã€‚ä¾‹å¦‚ï¼ŒVLAN ID 80 è¡¨ç¤ºä¸º â€œVLAN80â€ è€Œä¸æ˜¯ â€œVLAN080â€ã€‚</li></ul><p>å› æ­¤ï¼Œ<code>VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</code> çš„æ„æ€æ˜¯ï¼Œä½¿ç”¨ â€œVLANâ€ åŠ ä¸Š VLAN ID çš„æ ¼å¼ï¼Œå¹¶ä¸”ä¸åœ¨ VLAN ID å‰é¢å¡«å……é›¶ã€‚</p></blockquote><p><strong>ç½‘å¡é…ç½®å…¶å®åªéœ€è¦åœ¨ä¸‹æ–¹æ·»åŠ æ­¤é…ç½®å³å¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">IPADDR=10.0.1.61</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.1.220</span><br><span class="line">DNS1=114.114.114.114</span><br><span class="line">DNS2=8.8.8.8</span><br><span class="line">DNS3=223.5.5.5</span><br><span class="line">VLAN=<span class="built_in">yes</span></span><br><span class="line">VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</span><br><span class="line">VLAN_ID=80</span><br></pre></td></tr></table></figure><p><strong>centos8ä¿®æ”¹ç½‘å¡é…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=eui64</span><br><span class="line">NAME=ens224</span><br><span class="line">DEVICE=ens224</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">IPADDR=10.0.1.61</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.1.220</span><br><span class="line">DNS1=114.114.114.114</span><br><span class="line">DNS2=8.8.8.8</span><br><span class="line">DNS3=223.5.5.5</span><br><span class="line">VLAN=<span class="built_in">yes</span></span><br><span class="line">VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</span><br><span class="line">VLAN_ID=60</span><br></pre></td></tr></table></figure><p><strong>centos7é…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">TYPE=<span class="string">&quot;Ethernet&quot;</span></span><br><span class="line">PROXY_METHOD=<span class="string">&quot;none&quot;</span></span><br><span class="line">BROWSER_ONLY=<span class="string">&quot;no&quot;</span></span><br><span class="line">BOOTPROTO=<span class="string">&quot;static&quot;</span></span><br><span class="line">DEFROUTE=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV4_FAILURE_FATAL=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6INIT=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_AUTOCONF=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_DEFROUTE=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_FAILURE_FATAL=<span class="string">&quot;no&quot;</span></span><br><span class="line">IPV6_ADDR_GEN_MODE=<span class="string">&quot;stable-privacy&quot;</span></span><br><span class="line">IPV6_PRIVACY=<span class="string">&quot;no&quot;</span></span><br><span class="line">NAME=<span class="string">&quot;ens35&quot;</span></span><br><span class="line">DEVICE=<span class="string">&quot;ens35&quot;</span></span><br><span class="line">ONBOOT=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPADDR=<span class="string">&quot;10.0.1.60&quot;</span></span><br><span class="line">PREFIX=<span class="string">&quot;24&quot;</span></span><br><span class="line">GATEWAY=<span class="string">&quot;10.0.1.220&quot;</span></span><br><span class="line">DNS1=<span class="string">&quot;114.114.114.114&quot;</span></span><br><span class="line">DNS2=<span class="string">&quot;8.8.8.8&quot;</span></span><br><span class="line">DNS3=<span class="string">&quot;223.5.5.5&quot;</span></span><br><span class="line">VLAN=<span class="built_in">yes</span></span><br><span class="line">VLAN_NAME_TYPE=VLAN_PLUS_VID_NO_PAD</span><br><span class="line">VLAN_ID=60</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>éªŒè¯ï¼š</p><p>ç›¸äº’pingçœ‹å†…ç½‘æ˜¯å¦äº’é€š</p><ul><li><p>ç‰©ç†æœåŠ¡å™¨éªŒè¯<br>ç½‘å¡å˜ä¸ºç»¿è‰²</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2bfbac8a58848ceb401fa888e341bd45.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_2bfbac8a58848ceb401fa888e341bd45.png"></p><p>äº¤æ¢æœºå¯¹åº”æœåŠ¡å™¨çš„ç«¯å£ç¯äº®</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_f5809244b4f7e86f58c42d319e515b3e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/6/image_f5809244b4f7e86f58c42d319e515b3e.png"></p></li><li><p>downæ‰centos7 ens33ç½‘å¡ åœ¨vmwareæ§åˆ¶å°ping centos8 vlan60ç½‘å¡ens35 ping 10.0.1.61  (æˆåŠŸ)</p></li><li><p>å¹¶ä¸”æ­¤æ—¶pingä¸é€šcentos7 10.0.0.10 è¯´æ˜å†…å¤–ç½‘éš”ç¦»ç¯å¢ƒæµ‹è¯•æˆåŠŸ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_46d9d81ccd08ad64cb09535dc5f30812.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_46d9d81ccd08ad64cb09535dc5f30812.png"></p></li><li><p>å°†centos2æœºå™¨vlanä¿®æ”¹ä¸ºå…¶ä»–æ®µå¦‚vlan80åä½¿ç”¨æ­¤æœºå™¨ ping centos1 vlan60 10.0.1.60çœ‹èƒ½å¦pingé€š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1367c682fbe66fce000e3afced063d48.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1367c682fbe66fce000e3afced063d48.png"></p><p>æ­¤æ—¶ä¸¤å°æœºå™¨äº’ç›¸æ— æ³•pingé€š <img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f9f2dc184abb2dd3b0f6ede28a0e7830.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f9f2dc184abb2dd3b0f6ede28a0e7830.png"></p></li></ul><p>æˆåŠŸï¼</p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/zhongbeida_xue/article/details/95355111">https://blog.csdn.net/zhongbeida_xue/article/details/95355111</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ</title>
      <link href="/2024/05/14/Centos8%E4%BD%BF%E7%94%A8network%E7%AE%A1%E7%90%86%E7%BD%91%E7%BB%9C/"/>
      <url>/2024/05/14/Centos8%E4%BD%BF%E7%94%A8network%E7%AE%A1%E7%90%86%E7%BD%91%E7%BB%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ"><a href="#Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ" class="headerlink" title="Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ"></a>Centos8ä½¿ç”¨networkç®¡ç†ç½‘ç»œ</h1><p>å‰è¨€ï¼š</p><p>åœ¨CentOS8ä¸­ï¼Œæˆ‘ä»¬å¸¸ç”¨çš„network.serviceæœåŠ¡å°±è¢«NetworkManager.serviceæœåŠ¡ä»£æ›¿äº†ï¼ŒåŒæ ·çš„ï¼ŒIPçš„é…ç½®æ–¹æ³•ä¹Ÿå‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆå¦‚æœæƒ³ä½¿ç”¨network.serviceæœåŠ¡å»ç®¡ç†/é…ç½®ç³»ç»Ÿç½‘ç»œæ€ä¹ˆåŠå‘¢ï¼Ÿä¸‹é¢å¸¦ä½ æ¢¦å›network.service</p><h3 id="ä¸€ã€å®‰è£…network-scripts"><a href="#ä¸€ã€å®‰è£…network-scripts" class="headerlink" title="ä¸€ã€å®‰è£…network-scripts"></a>ä¸€ã€å®‰è£…network-scripts</h3><p>é™é»˜å®‰è£…(-q)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf install -y  network-scripts</span><br></pre></td></tr></table></figure><p>å®‰è£…è¿‡ç¨‹:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># dnf install -y -q network-scripts</span></span><br><span class="line">è­¦å‘Šï¼š/var/cache/dnf/BaseOS-929b586ef1f72f69/packages/network-scripts-10.00.6-1.el8_2.1.x86_64.rpm: å¤´V3 RSA/SHA256 Signature, å¯†é’¥ ID 8483c65d: NOKEY</span><br><span class="line">å¯¼å…¥ GPG å…¬é’¥ 0x8483C65D:</span><br><span class="line">Userid: <span class="string">&quot;CentOS (CentOS Official Signing Key) &lt;security@centos.org&gt;&quot;</span></span><br><span class="line">æŒ‡çº¹: 99DB 70FA E1D7 CE22 7FB6 4882 05B5 55B3 8483 C65D</span><br><span class="line">æ¥è‡ª: /etc/pki/rpm-gpg/RPM-GPG-KEY-centosofficial</span><br><span class="line">[root@localhost ~]<span class="comment">#</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ï¼ŒæœåŠ¡å®‰è£…å®Œæˆäº†ï¼Œæ¥ä¸‹æ¥å¼€å§‹å¯ç”¨è¯¥æœåŠ¡</p><h3 id="äºŒã€å¯ç”¨network"><a href="#äºŒã€å¯ç”¨network" class="headerlink" title="äºŒã€å¯ç”¨network"></a>äºŒã€å¯ç”¨network</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl start network</span><br><span class="line">systemctl <span class="built_in">enable</span> network</span><br><span class="line">systemctl status network</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-ç¦ç”¨NetworkManager-service"><a href="#ä¸‰-ç¦ç”¨NetworkManager-service" class="headerlink" title="ä¸‰. ç¦ç”¨NetworkManager.service"></a>ä¸‰. ç¦ç”¨NetworkManager.service</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop NetworkManager</span><br><span class="line">systemctl <span class="built_in">disable</span> NetworkManager</span><br><span class="line">æ‰§è¡Œç»“æœï¼š</span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl stop NetworkManager</span></span><br><span class="line">[root@localhost ~]<span class="comment"># systemctl disable NetworkManager</span></span><br><span class="line">Removed /etc/systemd/system/multi-user.target.wants/NetworkManager.service.</span><br><span class="line">Removed /etc/systemd/system/dbus-org.freedesktop.nm-dispatcher.service.</span><br><span class="line">Removed /etc/systemd/system/network-online.target.wants/NetworkManager-wait-online.service.</span><br></pre></td></tr></table></figure><p>åˆ°è¿™é‡Œï¼ŒNetworkManageræœåŠ¡å°±åœæ­¢å·¥ä½œäº†ï¼Œè¿™æ—¶å€™å¯ä»¥å…ˆå®‰è£…network-scriptsï¼ˆä¹Ÿå°±æ˜¯network.service)äº†</p><h3 id="å››ã€å¸è½½NetworkManagerï¼ˆå¯é€‰-å»ºè®®ä¿ç•™ï¼‰"><a href="#å››ã€å¸è½½NetworkManagerï¼ˆå¯é€‰-å»ºè®®ä¿ç•™ï¼‰" class="headerlink" title="å››ã€å¸è½½NetworkManagerï¼ˆå¯é€‰ å»ºè®®ä¿ç•™ï¼‰"></a>å››ã€å¸è½½<code>NetworkManager</code>ï¼ˆå¯é€‰ å»ºè®®ä¿ç•™ï¼‰</h3><p>æ‰§è¡Œå¸è½½å‘½ä»¤ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf remove -y NetworkManager</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_a6a352e2ac83bc5373276f96402b5ff4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_a6a352e2ac83bc5373276f96402b5ff4.png"></p><p>æœ¬æ–‡å‚è€ƒ</p><p><a href="https://blog.csdn.net/qq_36154886/article/details/109839926">https://blog.csdn.net/qq_36154886/article/details/109839926</a></p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ</title>
      <link href="/2024/05/13/centos8%E4%BD%BF%E7%94%A8nmcli%E9%85%8D%E7%BD%AEbond1%E4%B8%8Evlan%E7%BB%84%E5%90%88/"/>
      <url>/2024/05/13/centos8%E4%BD%BF%E7%94%A8nmcli%E9%85%8D%E7%BD%AEbond1%E4%B8%8Evlan%E7%BB%84%E5%90%88/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ-æµ‹è¯•æœªé€šè¿‡"><a href="#centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ-æµ‹è¯•æœªé€šè¿‡" class="headerlink" title="centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ(æµ‹è¯•æœªé€šè¿‡)"></a>centos8ä½¿ç”¨nmclié…ç½®bond1ä¸vlanç»„åˆ(æµ‹è¯•æœªé€šè¿‡)</h2><blockquote><p>æœ¬æ¬¡å®éªŒç¯å¢ƒä½¿ç”¨<strong>workstdtion</strong> è™šæ‹Ÿæœºäº¤æ¢æœº æ¨¡æ‹Ÿç‰©ç†è®¾å¤‡åˆ’åˆ†vlan</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_bba0d14b526d9a8ddba1b176cfdfaeb8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_bba0d14b526d9a8ddba1b176cfdfaeb8.png"></p><p>NetworkManagerå’Œnetwork.serviceéƒ½æ˜¯ç”¨æ¥ç®¡ç†ç½‘ç»œçš„å·¥å…·ã€‚åœ¨CentOS 7ç‰ˆæœ¬ä¸­ï¼ŒNetworkManagerå’Œnetwork.serviceé»˜è®¤å®‰è£…æ—¶æ˜¯å…±å­˜çš„ï¼Œä½†ä¹ æƒ¯ä½¿ç„¶æˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯ç¦ç”¨æ‰NetworkManagerè€Œä»ç„¶ä½¿ç”¨é…ç½®æ–‡ä»¶+network.serviceçš„æ–¹å¼æ¥é…ç½®å’Œç®¡ç†ä¸»æœºä¸Šçš„ç½‘ç»œã€‚</p><p>RHEL 8/CentOS 8ç‰ˆæœ¬å¼€å§‹network.serviceé»˜è®¤æ²¡æœ‰å®‰è£…ï¼Œé»˜è®¤åªä½¿ç”¨NetworkManagerä½œä¸ºç½‘ç»œç®¡ç†å·¥å…·ã€‚è€Œä¸”RedHatå®˜æ–¹æŒ‡å‡ºåœ¨åç»­çš„ç‰ˆæœ¬ä¸­ä¼šå½»åº•ä¸æ”¯æŒnetwork.serviceï¼Œè¿™æ ·ä¸€æ¥é™¤äº†NetworkManageræˆ‘ä»¬ä¹Ÿæ²¡æœ‰é€‰æ‹©ä½™åœ°ã€‚æ—¢ç„¶æ— åŠ›åæŠ—ï¼Œé‚£ä¹ˆå°±è¦å­¦ä¼šäº«å—ã€‚</p><p>å…¶å®NetworkManagerä¹Ÿæœ‰ä¼˜ç‚¹ï¼Œæ¯”å¦‚ä½¿ç”¨æ–¹å¼å¤šæ ·åŒ–ï¼šå‘½ä»¤è¡Œã€æ–‡æœ¬ç•Œé¢ã€å›¾å½¢ç•Œé¢ã€web portalå‡å¯æ”¯æŒã€‚nmcliå‘½ä»¤è¡Œæ”¯æŒtabè¡¥é½ï¼Œä½¿ç”¨æ„Ÿå—ç±»ä¼¼é…ç½®äº¤æ¢æœºï¼›nmtuiå·¥å…·å¯ä»¥åœ¨shellç»ˆç«¯å¼€å¯æ–‡æœ¬å›¾å½¢ç•Œé¢ã€‚è€Œä¸”Linuxä¸»æµçŸ¥å‘è¡Œç‰ˆï¼ŒRedHatç³»ã€Suseç³»ã€Debian/Ubuntuç³»å‡æ”¯æŒNetworkManagerã€‚</p><p>åœ¨nmcliä¸­æœ‰2ä¸ªå‘½ä»¤æœ€ä¸ºå¸¸ç”¨ï¼š</p><p>nmcli connection</p><p>è¯‘ä½œè¿æ¥ï¼Œå¯ç†è§£ä¸ºé…ç½®æ–‡ä»¶ï¼Œç›¸å½“äºifcfg-ethXã€‚å¯ä»¥ç®€å†™ä¸ºnmcli c</p><p>nmcli device</p><p>è¯‘ä½œè®¾å¤‡ï¼Œå¯ç†è§£ä¸ºå®é™…å­˜åœ¨çš„ç½‘å¡(åŒ…æ‹¬ç‰©ç†ç½‘å¡å’Œè™šæ‹Ÿç½‘å¡)ã€‚å¯ä»¥ç®€å†™ä¸ºnmcli d</p><p>NetworkManageræœ‰2ä¸ªåŸºæœ¬çš„æ¦‚å¿µï¼šè¿æ¥(Connection)å’Œè®¾å¤‡(Device)ã€‚</p><p>Deviceæ˜¯æ“ä½œç³»ç»Ÿå±‚é¢èƒ½å¤Ÿè¯†åˆ«åˆ°çš„ç½‘å¡è®¾å¤‡ï¼Œå¦‚æœ¬åœ°å›ç¯loã€æœ¬åœ°ç½‘å¡eth0ï¼ˆnmcli då‘½ä»¤å¯ä»¥æŸ¥çœ‹åˆ°ï¼‰ã€‚</p><p>Connectionå¯ä»¥è®¤ä¸ºæ˜¯Deviceå¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªDeviceå¯ä»¥å¯¹åº”å¤šä¸ªConnectionã€‚åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªConnectionæ˜¯å¤„äºæ¿€æ´»çŠ¶æ€çš„ï¼ˆnmcli cå‘½ä»¤è¾“å‡ºç»“æœä¸­ç»¿è‰²çš„è¡Œï¼‰ã€‚</p></blockquote><h3 id="ä¸€-é…ç½®bondä¸vlanç»„åˆï¼ˆé‡å¯ç³»ç»Ÿä¾¿ä¼šå¤±æ•ˆï¼‰"><a href="#ä¸€-é…ç½®bondä¸vlanç»„åˆï¼ˆé‡å¯ç³»ç»Ÿä¾¿ä¼šå¤±æ•ˆï¼‰" class="headerlink" title="ä¸€. é…ç½®bondä¸vlanç»„åˆï¼ˆé‡å¯ç³»ç»Ÿä¾¿ä¼šå¤±æ•ˆï¼‰"></a>ä¸€. é…ç½®bondä¸vlanç»„åˆï¼ˆé‡å¯ç³»ç»Ÿä¾¿ä¼šå¤±æ•ˆï¼‰</h3><p><strong>æ‹“è¡¥å›¾</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_715204becfedcdac807aa604cbd4594e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_715204becfedcdac807aa604cbd4594e.png"></p><p><strong>å…ˆå†³æ¡ä»¶</strong></p><p>æŸ¥çœ‹/proc/net/vlan ç›®å½•æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œä½¿ç”¨modprobeæ¨¡å‘½ä»¤è¿›å…¥802.1q.oï¼Œä¸”ä½¿ç”¨lsmodå‘½ä»¤æ¨¡æ˜¯å¦å·²å…¥æ ¸å¿ƒ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åŠ è½½æ¨¡å—</span></span><br><span class="line">modprobe 8021q</span><br><span class="line"> </span><br><span class="line">[root@c159 network-scripts]<span class="comment"># lsmod |grep 802</span></span><br><span class="line">8021q                  33159  0</span><br><span class="line">garp                   14384  1 8021q</span><br><span class="line">mrp                    18542  1 8021q</span><br></pre></td></tr></table></figure><p>å¾ˆç®€å•åªéœ€è¦å‡ è¡Œå‘½ä»¤</p><p>å‚æ•°å¯é€‰</p><ul><li><code>ipv4.method disabled</code>ï¼šè¿™ä¸ªé€‰é¡¹ç¦ç”¨äº†IPv4åœ°å€çš„è‡ªåŠ¨è·å–ï¼Œæ„å‘³ç€ç³»ç»Ÿä¸ä¼šå°è¯•è·å–IPv4åœ°å€ã€‚</li><li><code>ipv6.method ignore</code>ï¼šè¿™ä¸ªé€‰é¡¹å‘Šè¯‰ç³»ç»Ÿå¿½ç•¥IPv6åœ°å€çš„é…ç½®ï¼Œç³»ç»Ÿä¸ä¼šä¸ºè¯¥æ¥å£åˆ†é…IPv6åœ°å€ã€‚</li><li>mode 1 å³ä¸º mode active-backup</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨NetworkManageré…ç½®vlan</span></span><br><span class="line">nmcli con add <span class="built_in">type</span> bond con-name bond0 ifname bond0  mode 1 ipv4.method disabled ipv6.method ignore</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens224 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens256 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> vlan con-name bond0.80 ifname bond0.80 dev bond0 <span class="built_in">id</span> 80 ipv4.addresses 10.0.0.100/24 ipv4.gateway 10.0.0.220 ipv4.dns 114.114.114.114 </span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å‘½ä»¤ç”Ÿæˆifcfg-bond0.80è¯¦æƒ… å¹¶æ–°å¢æ­¤è¡Œï¼ˆSLAVE=yesï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost network-scripts]<span class="comment"># cat ifcfg-bond0.80</span></span><br><span class="line">VLAN=<span class="built_in">yes</span></span><br><span class="line">TYPE=Vlan</span><br><span class="line">PHYSDEV=bond0</span><br><span class="line">VLAN_ID=80</span><br><span class="line">REORDER_HDR=<span class="built_in">yes</span></span><br><span class="line">GVRP=no</span><br><span class="line">MVRP=no</span><br><span class="line">HWADDR=</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=dhcp</span><br><span class="line">IPADDR=10.0.0.100</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=114.114.114.114</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=default</span><br><span class="line">NAME=bond0.80</span><br><span class="line">UUID=b96b405e-6a6d-4000-bca3-2fc060c945c2</span><br><span class="line">DEVICE=bond0.80</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">SLAVE=<span class="built_in">yes</span>   <span class="comment">#æ–°å¢</span></span><br></pre></td></tr></table></figure><h3 id="äºŒ-éªŒè¯"><a href="#äºŒ-éªŒè¯" class="headerlink" title="äºŒ. éªŒè¯"></a>äºŒ. éªŒè¯</h3><p>æŸ¥çœ‹bond: <code>cat /proc/net/bonding/bond0</code></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_b43f2d08cd6c439a2de7279ac31d2178.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_b43f2d08cd6c439a2de7279ac31d2178.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/5201351/p/4990187.html">linux-Centos 7ä¸‹bondä¸vlanæŠ€æœ¯çš„ç»“åˆ - 520_1351 - åšå®¢å›­ (cnblogs.com)</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨NetworkManageré…ç½®bond 0</span></span><br><span class="line"><span class="comment"># nmcli con add type bond ifname bond0 con-name bond0 mode active-backup</span></span><br><span class="line"><span class="comment"># nmcli con add type bond-slave ifname ens224 master bond0</span></span><br><span class="line"><span class="comment"># nmcli con add type bond-slave ifname ens256 master bond0</span></span><br><span class="line"><span class="comment"># nmcli con modify bond0 ipv4.address 10.0.0.100/24 ipv4.gateway 10.0.0.254 ipv4.dns 114.114.114.114 ipv4.method manual ipv6.method ignore</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ä½¿ç”¨NetworkManageré…ç½®vlan</span></span><br><span class="line">nmcli con add <span class="built_in">type</span> bond ifname bond0 con-name bond0 mode active-backup ipv4.method disabled ipv6.method ignore</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens224 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens256 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> vlan con-name bond0.80 ifname bond0.80 dev bond0 <span class="built_in">id</span> 101 ipv4.addresses 10.0.0.100/24 ipv4.gateway 10.0.0.254 ipv4.dns 114.114.114.114 ipv4.method disabled ipv6.method ignore</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos8ä½¿ç”¨nmclié…ç½®bond(active-backup)åŠnetworkç®¡ç†ä¸‹é…ç½®</title>
      <link href="/2024/05/07/centos8%E4%BD%BF%E7%94%A8nmcli%E9%85%8D%E7%BD%AEbond(active-backup)%E5%8F%8Anetwork%E7%AE%A1%E7%90%86%E4%B8%8B%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/05/07/centos8%E4%BD%BF%E7%94%A8nmcli%E9%85%8D%E7%BD%AEbond(active-backup)%E5%8F%8Anetwork%E7%AE%A1%E7%90%86%E4%B8%8B%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="centos8ä½¿ç”¨nmclié…ç½®bond-active-backup-åŠnetworkç®¡ç†ä¸‹é…ç½®"><a href="#centos8ä½¿ç”¨nmclié…ç½®bond-active-backup-åŠnetworkç®¡ç†ä¸‹é…ç½®" class="headerlink" title="centos8ä½¿ç”¨nmclié…ç½®bond(active-backup)åŠnetworkç®¡ç†ä¸‹é…ç½®"></a>centos8ä½¿ç”¨nmclié…ç½®bond(active-backup)åŠnetworkç®¡ç†ä¸‹é…ç½®</h1><blockquote><p>éœ€è¦ï¼šè‡³å°‘ 3 å¼ ç½‘å¡ ï¼ˆ <strong>ä¸€å¼ ç½‘å¡é…ç½®IPç”¨äºè¿œç¨‹è¿æ¥ å‰©ä½™ä¸¤å¼ ç½‘å¡ é…ç½®bond</strong> ï¼‰</p><p>ä¸¤å¼ ç½‘å¡æ˜¯æ— æ³•å®ç°çš„</p></blockquote><h2 id="Bonding-èšåˆé“¾è·¯å·¥ä½œæ¨¡å¼"><a href="#Bonding-èšåˆé“¾è·¯å·¥ä½œæ¨¡å¼" class="headerlink" title="Bonding èšåˆé“¾è·¯å·¥ä½œæ¨¡å¼"></a>Bonding èšåˆé“¾è·¯å·¥ä½œæ¨¡å¼</h2><p>bondèšåˆé“¾è·¯æ¨¡å¼å…±æœ‰7ç§æ¨¡å¼ï¼š0-6 Mode</p><ul><li>mod=0 ï¼Œå³ï¼š(balance-rr) Round-robin policyï¼ˆè½®è¯¢ï¼‰èšåˆå£æ•°æ®æŠ¥æ–‡æŒ‰åŒ…è½®è¯¢ä»ç‰©ç†æ¥å£è½¬å‘ã€‚<br>è´Ÿè½½å‡è¡¡â€”æ‰€æœ‰é“¾è·¯å¤„äºè´Ÿè½½å‡è¡¡çŠ¶æ€ï¼Œè½®è¯¢æ–¹å¼å¾€æ¯æ¡é“¾è·¯å‘é€æŠ¥æ–‡è¿™æ¨¡å¼çš„ç‰¹ç‚¹å¢åŠ äº†å¸¦å®½ï¼ŒåŒæ—¶æ”¯æŒå®¹é”™èƒ½åŠ›ï¼Œå½“æœ‰é“¾è·¯å‡ºé—®é¢˜ï¼Œä¼šæŠŠæµé‡åˆ‡æ¢åˆ°æ­£å¸¸çš„é“¾è·¯ä¸Šã€‚<br>æ€§èƒ½é—®é¢˜â€”ä¸€ä¸ªè¿æ¥æˆ–è€…ä¼šè¯çš„æ•°æ®åŒ…å¦‚æœä»ä¸åŒçš„æ¥å£å‘å‡ºçš„è¯ï¼Œä¸­é€”å†ç»è¿‡ä¸åŒçš„é“¾è·¯ï¼Œåœ¨å®¢æˆ·ç«¯å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°æ•°æ®åŒ…æ— åºåˆ°è¾¾çš„é—®é¢˜ï¼Œè€Œæ— åºåˆ°è¾¾çš„æ•°æ®åŒ…éœ€è¦é‡æ–°è¦æ±‚è¢«å‘é€ï¼Œè¿™æ ·ç½‘ç»œçš„ååé‡å°±ä¼šä¸‹é™ã€‚Bond0åœ¨å¤§å‹åŠ›çš„ç½‘ç»œä¼ è¾“ä¸‹ï¼Œæ€§èƒ½å¢é•¿çš„å¹¶ä¸æ˜¯å¾ˆç†æƒ³ã€‚<br>éœ€è¦äº¤æ¢æœºè¿›è¡Œç«¯å£ç»‘å®š</li><li>mod=1ï¼Œå³ï¼š (active-backup) Active-backup policyï¼ˆä¸»-å¤‡ä»½ç­–ç•¥ï¼‰åªæœ‰ActiveçŠ¶æ€çš„ç‰©ç†æ¥å£æ‰è½¬å‘æ•°æ®æŠ¥æ–‡ã€‚<br>å®¹é”™èƒ½åŠ›â€”åªæœ‰ä¸€ä¸ªslaveæ˜¯æ¿€æ´»çš„(active)ã€‚ä¹Ÿå°±æ˜¯è¯´åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªç½‘å¡å¤„äºå·¥ä½œçŠ¶æ€ï¼Œå…¶ä»–çš„slaveéƒ½å¤„äºå¤‡ä»½çŠ¶æ€ï¼Œåªæœ‰åœ¨å½“å‰æ¿€æ´»çš„slaveæ•…éšœåæ‰æœ‰å¯èƒ½ä¼šå˜ä¸ºæ¿€æ´»çš„(active)ã€‚<br>æ— è´Ÿè½½å‡è¡¡â€”æ­¤ç®—æ³•çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æä¾›é«˜ç½‘ç»œè¿æ¥çš„å¯ç”¨æ€§ï¼Œä½†æ˜¯å®ƒçš„èµ„æºåˆ©ç”¨ç‡è¾ƒä½ï¼Œåªæœ‰ä¸€ä¸ªæ¥å£å¤„äºå·¥ä½œçŠ¶æ€ï¼Œåœ¨æœ‰ N ä¸ªç½‘ç»œæ¥å£çš„æƒ…å†µä¸‹ï¼Œèµ„æºåˆ©ç”¨ç‡ä¸º1/Nã€‚</li><li>mod=2ï¼Œå³ï¼š(balance-xor) XOR policyï¼ˆå¹³è¡¡ç­–ç•¥ï¼‰èšåˆå£æ•°æ®æŠ¥æ–‡æŒ‰æºç›®MACã€æºç›®IPã€æºç›®ç«¯å£è¿›è¡Œå¼‚æˆ–HASHè¿ç®—å¾—åˆ°ä¸€ä¸ªå€¼ï¼Œæ ¹æ®è¯¥å€¼æŸ¥æ‰¾æ¥å£è½¬å‘æ•°æ®æŠ¥æ–‡<br>è´Ÿè½½å‡è¡¡â€”åŸºäºæŒ‡å®šçš„ä¼ è¾“HASHç­–ç•¥ä¼ è¾“æ•°æ®åŒ…ã€‚<br>å®¹é”™èƒ½åŠ›â€”è¿™æ¨¡å¼çš„ç‰¹ç‚¹å¢åŠ äº†å¸¦å®½ï¼ŒåŒæ—¶æ”¯æŒå®¹é”™èƒ½åŠ›ï¼Œå½“æœ‰é“¾è·¯å‡ºé—®é¢˜ï¼Œä¼šæŠŠæµé‡åˆ‡æ¢åˆ°æ­£å¸¸çš„é“¾è·¯ä¸Šã€‚<br>æ€§èƒ½é—®é¢˜â€”è¯¥æ¨¡å¼å°†é™å®šæµé‡ï¼Œä»¥ä¿è¯åˆ°è¾¾ç‰¹å®šå¯¹ç«¯çš„æµé‡æ€»æ˜¯ä»åŒä¸€ä¸ªæ¥å£ä¸Šå‘å‡ºã€‚æ—¢ç„¶ç›®çš„åœ°æ˜¯é€šè¿‡MACåœ°å€æ¥å†³å®šçš„ï¼Œå› æ­¤è¯¥æ¨¡å¼åœ¨â€œæœ¬åœ°â€ç½‘ç»œé…ç½®ä¸‹å¯ä»¥å·¥ä½œå¾—å¾ˆå¥½ã€‚å¦‚æœæ‰€æœ‰æµé‡æ˜¯é€šè¿‡å•ä¸ªè·¯ç”±å™¨ï¼Œç”±äºåªæœ‰ä¸€ä¸ªç½‘å…³ï¼Œæºå’Œç›®æ ‡macéƒ½å›ºå®šäº†ï¼Œé‚£ä¹ˆè¿™ä¸ªç®—æ³•ç®—å‡ºçš„çº¿è·¯å°±ä¸€ç›´æ˜¯åŒä¸€æ¡ï¼Œé‚£ä¹ˆè¿™ç§æ¨¡å¼å°±æ²¡æœ‰å¤šå°‘æ„ä¹‰äº†ã€‚<br>éœ€è¦äº¤æ¢æœºé…ç½®ä¸ºport channel</li><li>mod=3ï¼Œå³ï¼šbroadcastï¼ˆå¹¿æ’­ç­–ç•¥ï¼‰è¿™ç§æ¨¡å¼çš„ç‰¹ç‚¹æ˜¯ä¸€ä¸ªæŠ¥æ–‡ä¼šå¤åˆ¶ä¸¤ä»½å¾€bondä¸‹çš„ä¸¤ä¸ªæ¥å£åˆ†åˆ«å‘é€å‡ºå»ï¼Œ<br>å½“æœ‰å¯¹ç«¯äº¤æ¢æœºå¤±æ•ˆï¼Œæ„Ÿè§‰ä¸åˆ°ä»»ä½•downtimeï¼Œä½†æ­¤æ³•è¿‡äºæµªè´¹èµ„æºï¼›ä¸è¿‡è¿™ç§æ¨¡å¼æœ‰å¾ˆå¥½çš„å®¹é”™æœºåˆ¶ã€‚æ­¤æ¨¡å¼é€‚ç”¨äºé‡‘èè¡Œä¸šï¼Œå› ä¸ºä»–ä»¬éœ€è¦é«˜å¯é æ€§çš„ç½‘ç»œï¼Œä¸å…è®¸å‡ºç°ä»»ä½•é—®é¢˜ã€‚</li><li>mod=4ï¼Œå³ï¼š(802.3ad) IEEE 802.3ad Dynamic link aggregationï¼ˆIEEE 802.3ad åŠ¨æ€é“¾æ¥èšåˆï¼‰<br>åœ¨åŠ¨æ€èšåˆæ¨¡å¼ä¸‹ï¼Œèšåˆç»„å†…çš„æˆå‘˜ç«¯å£ä¸Šå‡å¯ç”¨LACPï¼ˆé“¾è·¯æ±‡èšæ§åˆ¶åè®®ï¼‰åè®®ï¼Œå…¶ç«¯å£çŠ¶æ€é€šè¿‡è¯¥åè®®è‡ªåŠ¨è¿›è¡Œç»´æŠ¤ã€‚<br>è´Ÿè½½å‡è¡¡â€”åŸºäºæŒ‡å®šçš„ä¼ è¾“HASHç­–ç•¥ä¼ è¾“æ•°æ®åŒ…ã€‚é»˜è®¤ç®—æ³•ä¸blance-xorä¸€æ ·ã€‚<br>å®¹é”™èƒ½åŠ›â€”è¿™æ¨¡å¼çš„ç‰¹ç‚¹å¢åŠ äº†å¸¦å®½ï¼ŒåŒæ—¶æ”¯æŒå®¹é”™èƒ½åŠ›ï¼Œå½“æœ‰é“¾è·¯å‡ºé—®é¢˜ï¼Œä¼šæŠŠæµé‡åˆ‡æ¢åˆ°æ­£å¸¸çš„é“¾è·¯ä¸Šã€‚å¯¹æ¯”blance-xorï¼Œè¿™ç§æ¨¡å¼å®šæœŸå‘é€LACPDUæŠ¥æ–‡ç»´æŠ¤é“¾è·¯èšåˆçŠ¶æ€ï¼Œä¿è¯é“¾è·¯è´¨é‡ã€‚éœ€è¦äº¤æ¢æœºæ”¯æŒLACPåè®®</li><li>mod=5ï¼Œå³ï¼š(balance-tlb) Adaptive transmit load balancingï¼ˆé€‚é…å™¨ä¼ è¾“è´Ÿè½½å‡è¡¡ï¼‰<br>åœ¨æ¯ä¸ªç‰©ç†æ¥å£ä¸Šæ ¹æ®å½“å‰çš„è´Ÿè½½ï¼ˆæ ¹æ®é€Ÿåº¦è®¡ç®—ï¼‰åˆ†é…å¤–å‡ºæµé‡ã€‚å¦‚æœæ­£åœ¨æ¥æ”¶æ•°æ®çš„ç‰©ç†æ¥å£å£å‡ºæ•…éšœäº†ï¼Œå¦ä¸€ä¸ªç‰©ç†æ¥å£æ¥ç®¡è¯¥æ•…éšœç‰©ç†å£çš„MACåœ°å€ã€‚<br>éœ€è¦ethtoolæ”¯æŒè·å–æ¯ä¸ªslaveçš„é€Ÿç‡</li><li>mod=6ï¼Œå³ï¼š(balance-alb) Adaptive load balancingï¼ˆé€‚é…å™¨é€‚åº”æ€§è´Ÿè½½å‡è¡¡ï¼‰<br>è¯¥æ¨¡å¼åŒ…å«äº†balance-tlbæ¨¡å¼ï¼ŒåŒæ—¶åŠ ä¸Šé’ˆå¯¹IPV4æµé‡çš„æ¥æ”¶è´Ÿè½½å‡è¡¡ï¼Œè€Œä¸”ä¸éœ€è¦ä»»ä½•switch(äº¤æ¢æœº)çš„æ”¯æŒã€‚æ¥æ”¶è´Ÿè½½å‡è¡¡æ˜¯é€šè¿‡ARPåå•†å®ç°çš„ã€‚bondingé©±åŠ¨æˆªè·æœ¬æœºå‘é€çš„ARPåº”ç­”ï¼Œå¹¶æŠŠæºç¡¬ä»¶åœ°å€æ”¹å†™ä¸ºbondä¸­æŸä¸ªç‰©ç†æ¥å£çš„å”¯ä¸€ç¡¬ä»¶åœ°å€ï¼Œä»è€Œä½¿å¾—ä¸åŒçš„å¯¹ç«¯ä½¿ç”¨ä¸åŒçš„ç¡¬ä»¶åœ°å€è¿›è¡Œé€šä¿¡ã€‚<br>mod=6ä¸mod=0çš„åŒºåˆ«ï¼šmod=6ï¼Œå…ˆæŠŠeth0æµé‡å æ»¡ï¼Œå†å eth1ï¼Œâ€¦.ethXï¼›è€Œmod=0çš„è¯ï¼Œä¼šå‘ç°2ä¸ªå£çš„æµé‡éƒ½å¾ˆç¨³å®šï¼ŒåŸºæœ¬ä¸€æ ·çš„å¸¦å®½ã€‚è€Œmod=6ï¼Œä¼šå‘ç°ç¬¬ä¸€ä¸ªå£æµé‡å¾ˆé«˜ï¼Œç¬¬2ä¸ªå£åªå äº†å°éƒ¨åˆ†æµé‡</li></ul><h2 id="é¦–å…ˆ"><a href="#é¦–å…ˆ" class="headerlink" title="é¦–å…ˆ"></a>é¦–å…ˆ</h2><p>é“¾æ¥ï¼š</p><p><a href="https://developer.aliyun.com/article/503848">https://developer.aliyun.com/article/503848</a></p><p><a href="https://www.cnblogs.com/5201351/p/4990187.html">https://www.cnblogs.com/5201351/p/4990187.html</a></p><p>å…ˆæŸ¥çœ‹ä¸€ä¸‹å†…æ ¸æ˜¯å¦å·²ç»æ”¯æŒbonding</p><p>1ï¼‰å¦‚æœå†…æ ¸å·²ç»æŠŠbondingç¼–è¯‘è¿›å†…æ ¸ï¼Œé‚£ä¹ˆè¦åšçš„å°±æ˜¯åŠ è½½è¯¥æ¨¡å—åˆ°å½“å‰å†…æ ¸ï¼›å…¶æ¬¡æŸ¥çœ‹ifenslaveè¯¥å·¥å…·æ˜¯å¦ä¹Ÿå·²ç»ç¼–è¯‘</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">modprobe  -l   bond\*  æˆ–è€… modinfo   bonding</span><br><span class="line"><span class="comment"># åŠ è½½</span></span><br><span class="line">modprobe --first-time bonding</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">modprobe   bonding </span><br><span class="line">lsmod | grep <span class="string">&#x27;bonding&#x27;</span></span><br><span class="line"><span class="comment"># è®¾ç½®å¼€æœºåŠ è½½</span></span><br><span class="line"><span class="built_in">echo</span>  <span class="string">&#x27;modprobe bonding &amp;&gt; /dev/null&#x27;</span>  &gt;&gt;  /etc/rc.local </span><br><span class="line"><span class="built_in">which</span>  ifenslave</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šé»˜è®¤å†…æ ¸å®‰è£…å®Œåå°±å·²ç»æ”¯æŒbondingæ¨¡å—äº†ï¼Œæ— éœ€è¦è‡ªå·±æ‰‹åŠ¨ç¼–è¯‘</p><h2 id="æ¦‚è§ˆï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰"><a href="#æ¦‚è§ˆï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰" class="headerlink" title="æ¦‚è§ˆï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰"></a>æ¦‚è§ˆï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰</h2><blockquote><p>ç¤ºä¾‹å‘½ä»¤ï¼š</p><p>nmcli connection add type bond ifname bond0 con-name bond0 miimon 100 mode active-backup primary ens33 ipv4.method manual ipv4.addresses 192.168.221.232/24 ipv4.gateway 192.168.221.25</p><p>å‚æ•°ï¼ˆè‹¥æ²¡æœ‰æŒ‡å®š åˆ™éœ€è¦æ‰‹åŠ¨æ›´æ”¹é…ç½® bond ç½‘å¡æ–‡ä»¶ ifcfg-bond0 ï¼‰ï¼š</p><ul><li>ipv4.gateway 192.168.221.25 ï¼š ä¸ºå¯é€‰å‚æ•°å³é…ç½®bondçš„ç½‘å…³</li><li>/24 ï¼šå³bondçš„å­ç½‘æ©ç </li><li>ipv4.dns 8.8.8.8ï¼šé…ç½®bondçš„dnsï¼ˆå¯é€‰å‚æ•°ï¼‰</li></ul></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ bondingæ¥å£</span></span><br><span class="line">nmcli con add <span class="built_in">type</span> bond con-name bond0 ifname bond0 mode 1 miimon 100  ipv4.method manual ipv4.addresses 10.0.0.100/24 ipv4.gateway 10.0.0.220 ipv4.dns 223.5.5.5</span><br><span class="line"><span class="comment"># æ·»åŠ ä»å±æ¥å£</span></span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens224 master bond0</span><br><span class="line">nmcli con add <span class="built_in">type</span> bond-slave ifname ens256 master bond0</span><br><span class="line"><span class="comment"># æ³¨ï¼šå¦‚æ— ä¸ºä»å±æ¥å£æä¾›è¿æ¥åï¼Œåˆ™è¯¥åç§°æ˜¯æ¥å£åç§°åŠ ç±»å‹æ„æˆ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># è¦å¯åŠ¨ç»‘å®šï¼Œåˆ™å¿…é¡»é¦–å…ˆå¯åŠ¨ä»å±æ¥å£</span></span><br><span class="line">nmcli con up bond-slave-ens224</span><br><span class="line">nmcli con up bond-slave-ens256</span><br><span class="line"><span class="comment"># å¯åŠ¨ç»‘å®š</span></span><br><span class="line">nmcli con up bond0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤bond</span></span><br><span class="line">nmcli con del bond0</span><br><span class="line"><span class="comment"># åˆ é™¤ç»‘å®šçš„ç½‘å¡</span></span><br><span class="line">nmcli con del bond-slave-ens160</span><br><span class="line">nmcli con del bond-slave-ens224</span><br></pre></td></tr></table></figure><h2 id="è¯´æ˜-æœ¬æ¬¡ä½¿ç”¨vmwareå®éªŒ-ï¼š"><a href="#è¯´æ˜-æœ¬æ¬¡ä½¿ç”¨vmwareå®éªŒ-ï¼š" class="headerlink" title="è¯´æ˜(æœ¬æ¬¡ä½¿ç”¨vmwareå®éªŒ )ï¼š"></a>è¯´æ˜(æœ¬æ¬¡ä½¿ç”¨vmwareå®éªŒ )ï¼š</h2><blockquote><p>ä¸‹æ–¹ä¿ç•™ens160ä¸ens224 å®é™…ä¸º ens224 ä¸ ens256</p></blockquote><p>å¸¸ç”¨çš„æ¨¡å¼ä¸º 0,1,3,6<br>mode 1ã€5ã€6       ä¸éœ€è¦äº¤æ¢æœºè®¾ç½®<br>mode 0ã€2ã€3ã€4  éœ€è¦äº¤æ¢æœºè®¾ç½®<br>active-backupã€balance-tlb å’Œ balance-alb æ¨¡å¼ä¸éœ€è¦äº¤æ¢æœºçš„ä»»ä½•ç‰¹æ®Šé…ç½®ã€‚å…¶ä»–ç»‘å®šæ¨¡å¼éœ€è¦é…ç½®äº¤æ¢æœºä»¥ä¾¿æ•´åˆé“¾æ¥ã€‚å¦‚ï¼šCisco äº¤æ¢æœºéœ€è¦åœ¨æ¨¡å¼ 0ã€2 å’Œ 3 ä¸­ä½¿ç”¨ EtherChannelï¼Œä½†åœ¨æ¨¡å¼4ä¸­éœ€è¦ LACPå’ŒEtherChannel</p><h2 id="ä¸€-nmcliå®ç°Bondingï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰"><a href="#ä¸€-nmcliå®ç°Bondingï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰" class="headerlink" title="ä¸€. nmcliå®ç°Bondingï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰"></a>ä¸€. nmcliå®ç°Bondingï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰</h2><h3 id="1-ä¸¤å—ç½‘å¡éƒ½è®¾ç½®ä¸º-Nat-æ¨¡å¼"><a href="#1-ä¸¤å—ç½‘å¡éƒ½è®¾ç½®ä¸º-Nat-æ¨¡å¼" class="headerlink" title="1. ä¸¤å—ç½‘å¡éƒ½è®¾ç½®ä¸º Nat æ¨¡å¼"></a>1. ä¸¤å—ç½‘å¡éƒ½è®¾ç½®ä¸º Nat æ¨¡å¼</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ip a</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:f2:66:78 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp3s0</span><br><span class="line">    inet 10.0.0.10/27 brd 10.0.0.31 scope global noprefixroute ens160</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::20c:29ff:fef2:6678/64 scope <span class="built_in">link</span> noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: ens224: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:f2:66:82 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp19s0</span><br><span class="line">4: ens256: &lt;BROADCAST,MULTICAST,SLAVE&gt; mtu 1500 qdisc fq_codel master bond0 state DOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:f2:66:82 brd ff:ff:ff:ff:ff:ff permaddr 00:0c:29:f2:66:8c</span><br><span class="line">    altname enp27s0</span><br><span class="line">5: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 52:54:00:d4:a9:b3 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºbond0ï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰"><a href="#2-åˆ›å»ºbond0ï¼ˆéœ€è¦è‡³å°‘-3-å¼ ç½‘å¡ï¼‰" class="headerlink" title="2. åˆ›å»ºbond0ï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰"></a>2. åˆ›å»ºbond0ï¼ˆéœ€è¦è‡³å°‘ 3 å¼ ç½‘å¡ï¼‰</h3><p>å‚æ•°è¯´æ˜ï¼š</p><ul><li>bond0 ä¸ºbond0çš„åç§°</li><li>ifname æŒ‡å®šDEVICEåç§°</li><li>type æŒ‡å®šbondç±»å‹</li><li>mode æŒ‡å®šbondæ¨¡å¼</li><li>ipv4.addresses æŒ‡å®šbond0åœ°å€</li></ul><p>æ·»åŠ é“¾è·¯èšåˆ bond æ¨¡å¼ï¼Œå®šä¹‰ bond0</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ·»åŠ é“¾è·¯èšåˆ bond æ¨¡å¼ï¼Œå®šä¹‰ bond0</span></span><br><span class="line">nmcli connection add con-name bond0 ifname bond0 <span class="built_in">type</span> bond miimon 100 mode active-backup ipv4.method manual ipv4.addresses 10.0.0.100/24</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_368aa9c5e4593d8aa1812c310f7d5e12.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_368aa9c5e4593d8aa1812c310f7d5e12.png"></p><p>è¿™é‡Œæ¼”ç¤ºæ¨¡å¼é‡‡ç”¨ active-backup ï¼Œå¯¹åº”ä¸»å¤‡æ¨¡å¼ï¼Œå³ mode=1 å¦‚éœ€è¦çš„æ˜¯å…¶ä»–æ¨¡å¼åªéœ€è¦æ›´æ”¹ï¼šactive-backup æ”¹ä¸ºå…¶ä»–æ¯”å¦‚æ”¹ä¸ºï¼š balance-rr</p><p>ä¿®æ”¹ç½‘å£é…ç½®æ–‡ä»¶ï¼ˆè‡ªåŠ¨ç”Ÿæˆçš„ç½‘å¡é…ç½®æ–‡ä»¶ä¸­å·²åŒ…å«ä¸‹è¿°éƒ¨åˆ†é…ç½®ï¼Œè¯·ä»”ç»†æ ¸å¯¹ï¼Œç¡®<br>ä¿ä¸‹è¿°é…ç½®å†…å®¹æ— é—æ¼ä¸”æ­£ç¡®ï¼‰<br>vim ifcfg-bond0<br>åœ¨ /etc/sysconfig/network-scripts/ ç›®å½•ä¸‹ï¼Œç¼–å†™ ifcfg-bond0<br>DEVICE=bond0<br>ONBOOT=yes<br>BOOTPROTO=none<br>IPADDR=10.0.0.12<br>NETMASK=24<br>TYPE=Bond<br>BONDING_OPTS=mode=active-backup<br>GATEWAY=10.0.0.220<br>DNS1=223.5.5.5</p><p><strong>æŸ¥çœ‹æ·»åŠ è¯¦æƒ…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ·»åŠ è¯¦æƒ…</span></span><br><span class="line">nmcli connection</span><br><span class="line"></span><br><span class="line">// è¿”å›</span><br><span class="line">NAME    UUID                                  TYPE      DEVICE </span><br><span class="line">ens160  ff7bd1f0-e937-42c0-bba2-1b069e9477c7  ethernet  ens160 </span><br><span class="line">bond0   2a465bf9-89ea-4a3b-b6ae-a94dde548b77  bond      bond0  </span><br><span class="line">virbr0  f51041d3-c680-4162-90d8-0da1c1a32fcd  bridge    virbr0 </span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç”Ÿæˆçš„ç½‘å¡é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">ls</span> /etc/sysconfig/network-scripts/</span><br><span class="line"></span><br><span class="line">// è¿”å›</span><br><span class="line">ifcfg-bond0  ifcfg-ens160</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ­¤æ—¶ç”Ÿæˆé…ç½®æ–‡ä»¶ifcfg-bond0 æŸ¥çœ‹æ–‡ä»¶è¯¦æƒ…</span></span><br><span class="line">[root@localhost network-scripts]<span class="comment"># cat /etc/sysconfig/network-scripts/ifcfg-bond0</span></span><br><span class="line">BONDING_OPTS=mode=active-backup</span><br><span class="line">TYPE=Bond</span><br><span class="line">BONDING_MASTER=<span class="built_in">yes</span></span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">IPADDR=10.0.0.10</span><br><span class="line">PREFIX=24</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=default</span><br><span class="line">NAME=bond0</span><br><span class="line">UUID=2a465bf9-89ea-4a3b-b6ae-a94dde548b77</span><br><span class="line">DEVICE=bond0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">GATEWAY=10.0.0.220  <span class="comment"># æ–°åŠ </span></span><br><span class="line">DNS1=223.5.5.5      <span class="comment"># æ–°åŠ </span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="3-æ·»åŠ ç«¯å£è‡³bond0ä¸­"><a href="#3-æ·»åŠ ç«¯å£è‡³bond0ä¸­" class="headerlink" title="3. æ·»åŠ ç«¯å£è‡³bond0ä¸­"></a>3. æ·»åŠ ç«¯å£è‡³bond0ä¸­</h2><p>å°†ç½‘å¡ens160  å’Œens224 æ·»åŠ è‡³ bond0 ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection add <span class="built_in">type</span> bond-slave ifname ens160 master bond0</span><br><span class="line">nmcli connection add <span class="built_in">type</span> bond-slave ifname ens224 master bond0</span><br><span class="line"><span class="comment"># æ³¨æ„é¡ºåº</span></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹è¯¦æƒ…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ·»åŠ è¯¦æƒ…</span></span><br><span class="line">nmcli con</span><br><span class="line"></span><br><span class="line">// è¿”å›</span><br><span class="line">NAME               UUID                                  TYPE      DEVICE </span><br><span class="line">ens160             ff7bd1f0-e937-42c0-bba2-1b069e9477c7  ethernet  ens160 </span><br><span class="line">bond0              3a11f05c-c92f-4804-be4f-c04506e819d2  bond      bond0  </span><br><span class="line">virbr0             ba243c12-4f52-4b97-bfbd-c1d57dde75a9  bridge    virbr0 </span><br><span class="line">bond-slave-ens224  6ffdb9e4-6e02-4c53-a266-64702b3c5e40  ethernet  ens224 </span><br><span class="line">bond-slave-ens160  034ea11e-1f8c-43e0-b062-90559525284f  ethernet  --  </span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç”Ÿæˆçš„ç½‘å¡é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">ls</span> /etc/sysconfig/network-scripts/</span><br><span class="line"></span><br><span class="line">// è¿”å›</span><br><span class="line">ifcfg-bond0  ifcfg-bond-slave-ens160  ifcfg-bond-slave-ens224  ifcfg-ens160</span><br></pre></td></tr></table></figure><p><strong>å¯ç”¨bond0</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¦å¯åŠ¨ç»‘å®šï¼Œåˆ™å¿…é¡»é¦–å…ˆå¯åŠ¨ä»å±æ¥å£ </span></span><br><span class="line">nmcli con up bond-slave-ens160</span><br><span class="line">nmcli con up bond-slave-ens224</span><br><span class="line"><span class="comment"># å¯åŠ¨ç»‘å®š</span></span><br><span class="line">nmcli con up bond0</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e2c2c083a0072a5bc7dcabf6335b41d1.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_e2c2c083a0072a5bc7dcabf6335b41d1.png"></p><h3 id="4-æ•ˆæœ"><a href="#4-æ•ˆæœ" class="headerlink" title="4. æ•ˆæœ"></a>4. æ•ˆæœ</h3><p>æŸ¥çœ‹IP</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens160: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc mq master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff permaddr 00:0c:29:2d:25:5a</span><br><span class="line">    altname enp3s0</span><br><span class="line">3: ens224: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc mq master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp19s0</span><br><span class="line">4: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 52:54:00:d9:ea:56 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">5: bond0: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.0.0.10/24 brd 10.0.0.255 scope global noprefixroute bond0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e3a9:7228:e43a:9138/64 scope <span class="built_in">link</span> noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹bondçŠ¶æ€</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">Every 1.0s: <span class="built_in">cat</span> /proc/net/bonding/bond0                                                                                   localhost.localdomain: Tue May  7 11:33:36 2024</span><br><span class="line"></span><br><span class="line">Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)</span><br><span class="line"></span><br><span class="line">Bonding Mode: fault-tolerance (active-backup)</span><br><span class="line">Primary Slave: None</span><br><span class="line">Currently Active Slave: ens224  <span class="comment"># ens224 æ˜¯ä¸»</span></span><br><span class="line">MII Status: up</span><br><span class="line">MII Polling Interval (ms): 100</span><br><span class="line">Up Delay (ms): 0</span><br><span class="line">Down Delay (ms): 0</span><br><span class="line">Peer Notification Delay (ms): 0</span><br><span class="line"></span><br><span class="line">Slave Interface: ens224</span><br><span class="line">MII Status: up</span><br><span class="line">Speed: 10000 Mbps</span><br><span class="line">Duplex: full</span><br><span class="line">Link Failure Count: 0</span><br><span class="line">Permanent HW addr: 00:0c:29:2d:25:64</span><br><span class="line">Slave queue ID: 0</span><br><span class="line"></span><br><span class="line">Slave Interface: ens160</span><br><span class="line">MII Status: up</span><br><span class="line">Speed: 10000 Mbps</span><br><span class="line">Duplex: full</span><br><span class="line">Link Failure Count: 0</span><br><span class="line">Permanent HW addr: 00:0c:29:2d:25:5a</span><br><span class="line">Slave queue ID: 0</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f3cfde6318f3ab37148e4d6822104dba.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_f3cfde6318f3ab37148e4d6822104dba.png"></p><h3 id="5-æ‰©å±•-åˆ é™¤bond"><a href="#5-æ‰©å±•-åˆ é™¤bond" class="headerlink" title="5. æ‰©å±• åˆ é™¤bond"></a>5. æ‰©å±• åˆ é™¤bond</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ é™¤bond</span></span><br><span class="line">nmcli con del mybond0</span><br><span class="line"><span class="comment"># æŸ¥çœ‹è¯¦æƒ…</span></span><br><span class="line">nmcli con</span><br><span class="line"><span class="comment"># åˆ é™¤ä»å±</span></span><br><span class="line">nmcli con del bond-slave-ens33</span><br><span class="line">nmcli con del bond-slave-ens36</span><br></pre></td></tr></table></figure><h1 id="äºŒ-ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®bond-æ­¤ç§é€‚ç”¨äºé€‚ç”¨networkç®¡ç†"><a href="#äºŒ-ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®bond-æ­¤ç§é€‚ç”¨äºé€‚ç”¨networkç®¡ç†" class="headerlink" title="äºŒ. ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®bond(æ­¤ç§é€‚ç”¨äºé€‚ç”¨networkç®¡ç†)"></a>äºŒ. ç›´æ¥ä¿®æ”¹é…ç½®æ–‡ä»¶æ–¹å¼é…ç½®bond(æ­¤ç§é€‚ç”¨äºé€‚ç”¨networkç®¡ç†)</h1><p><strong>æ¦‚è§ˆ(å‘½ä»¤æ–¹å¼ä¸‰è¡Œå‘½ä»¤å³å¯æ¨èä½¿ç”¨æ­¤ç§)ï¼š</strong></p><p>å¯ä»¥<strong>å…ˆæ‰“å¼€NetworkManager</strong>æœåŠ¡æ‰§è¡Œå®Œæˆä¸‹æ–¹å‘½ä»¤å<strong>å†å°†å…¶å…³é—­</strong> æœ€å<strong>é‡å¯network</strong>æœåŠ¡</p><p>å‚æ•°ï¼šmode active-backup miimon 100 å¯å†™ä¸º mode 1 miimon 100</p><p>ä½¿ç”¨mode 1 miimon 100æ—¶</p><p>BONDING_OPTS=mode=active-backup å˜ä¸º BONDING_OPTS=â€mode=active-backup miimon=100â€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection add con-name bond0 ifname bond0 <span class="built_in">type</span> bond mode active-backup miimon 100 ipv4.addresses 10.0.0.60/24 ipv4.gateway 10.0.0.220 ipv4.dns 223.5.5.5</span><br><span class="line"></span><br><span class="line">nmcli connection add con-name ens224 ifname ens224 <span class="built_in">type</span> bond-slave master bond0</span><br><span class="line">nmcli connection add con-name ens256 ifname ens256 <span class="built_in">type</span> bond-slave master bond0</span><br></pre></td></tr></table></figure><h2 id="1-NATç½‘ç»œé…ç½®ï¼ˆæ‰€æœ‰æœåŠ¡å™¨ï¼‰ï¼š"><a href="#1-NATç½‘ç»œé…ç½®ï¼ˆæ‰€æœ‰æœåŠ¡å™¨ï¼‰ï¼š" class="headerlink" title="1.NATç½‘ç»œé…ç½®ï¼ˆæ‰€æœ‰æœåŠ¡å™¨ï¼‰ï¼š"></a>1.NATç½‘ç»œé…ç½®ï¼ˆæ‰€æœ‰æœåŠ¡å™¨ï¼‰ï¼š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yumÂ installÂ bash-completion</span><br><span class="line"><span class="built_in">cd</span>Â /etc/sysconfig/network-scripts/</span><br></pre></td></tr></table></figure><h3 id="bond0é…ç½®-å®é™…ä¸­è®°å¾—å°†dhcpæ”¹ä¸ºstatic"><a href="#bond0é…ç½®-å®é™…ä¸­è®°å¾—å°†dhcpæ”¹ä¸ºstatic" class="headerlink" title="bond0é…ç½®(å®é™…ä¸­è®°å¾—å°†dhcpæ”¹ä¸ºstatic)"></a>bond0é…ç½®(å®é™…ä¸­è®°å¾—å°†dhcpæ”¹ä¸ºstatic)</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s1 network-scripts]<span class="comment"># cat ifcfg-bond0 </span></span><br><span class="line">BONDING_OPTS=mode=active-backup</span><br><span class="line">TYPE=Bond</span><br><span class="line">BONDING_MASTER=<span class="built_in">yes</span></span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none</span><br><span class="line">IPADDR=10.0.0.60</span><br><span class="line">PREFIX=24</span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=default</span><br><span class="line">NAME=bond0</span><br><span class="line">UUID=a0a8a96c-ec86-4cbe-8b36-849bb4aa20a6</span><br><span class="line">DEVICE=bond0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>ens224é…ç½®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s1 network-scripts]<span class="comment"># cat ifcfg-ens224 </span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOND_PORT_QUEUE_ID=0</span><br><span class="line">BOND_PORT_PRIO=0</span><br><span class="line">NAME=ens224</span><br><span class="line">UUID=8855f02c-a2e6-48e7-86ad-0320382a445a</span><br><span class="line">DEVICE=ens224</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">MASTER=bond0</span><br><span class="line">SLAVE=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p>ens256é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s1 network-scripts]<span class="comment"># cat ifcfg-ens224 </span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOND_PORT_QUEUE_ID=0</span><br><span class="line">BOND_PORT_PRIO=0</span><br><span class="line">NAME=ens224</span><br><span class="line">UUID=8855f02c-a2e6-48e7-86ad-0320382a445a</span><br><span class="line">DEVICE=ens224</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">MASTER=bond0</span><br><span class="line">SLAVE=<span class="built_in">yes</span></span><br><span class="line">[root@k8s1 network-scripts]<span class="comment"># cat ifcfg-ens256</span></span><br><span class="line">TYPE=Ethernet</span><br><span class="line">BOND_PORT_QUEUE_ID=0</span><br><span class="line">BOND_PORT_PRIO=0</span><br><span class="line">NAME=ens256</span><br><span class="line">UUID=c3358675-54e0-43f0-afc9-e8a3a13ad9ed</span><br><span class="line">DEVICE=ens256</span><br><span class="line">ONBOOT=<span class="built_in">yes</span></span><br><span class="line">MASTER=bond0</span><br><span class="line">SLAVE=<span class="built_in">yes</span></span><br></pre></td></tr></table></figure><p><strong>é‡å¯ç½‘å¡ç”Ÿæ•ˆï¼šsystemctl restart network</strong></p><p><strong>éªŒè¯</strong></p><ul><li>é‡å¯ç³»ç»Ÿçœ‹èƒ½å¦æ­£å¸¸å¯åŠ¨bond0    ï¼ˆæ­£å¸¸å¯åŠ¨ï¼‰</li><li>æ‰‹åŠ¨downæ‰ç½‘å¡çœ‹èƒ½å¦æ­£å¸¸åˆ‡æ¢ï¼ˆæŸ¥çœ‹bondå‘½ä»¤ <code>cat /proc/net/bonding/bond0</code>ï¼‰(æ­£å¸¸åˆ‡æ¢)</li><li>æŸ¥çœ‹ç½‘å¡çŠ¶æ€ï¼š<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@k8s1 network-scripts]<span class="comment"># ip a</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens160: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:5a brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp3s0</span><br><span class="line">    inet 10.0.0.10/24 brd 10.0.0.255 scope global noprefixroute ens160</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet 10.0.0.187/24 brd 10.0.0.255 scope global secondary dynamic noprefixroute ens160</span><br><span class="line">       valid_lft 1174sec preferred_lft 1174sec</span><br><span class="line">    inet6 fe80::20c:29ff:fe2d:255a/64 scope <span class="built_in">link</span> noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: ens224: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc mq master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    altname enp19s0</span><br><span class="line">4: ens256: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc mq master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff permaddr 00:0c:29:2d:25:6e</span><br><span class="line">    altname enp27s0</span><br><span class="line">5: virbr0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 52:54:00:d9:ea:56 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">6: bond0: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:2d:25:64 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.0.0.60/24 brd 10.0.0.255 scope global noprefixroute bond0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::95d7:d04b:3ab3:49f1/64 scope <span class="built_in">link</span> noprefixroute </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure></li></ul><p>4.å†…å¤–ç½‘é€šä¿¡ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Â pingÂ www.baidu.com</span></span><br><span class="line"><span class="comment">#Â pingÂ 192.168.20.2</span></span><br></pre></td></tr></table></figure><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/qq_43652666/article/details/119175635">https://blog.csdn.net/qq_43652666/article/details/119175635</a></p><p><a href="https://blog.csdn.net/m0_59586152/article/details/125503956">https://blog.csdn.net/m0_59586152/article/details/125503956</a></p><p><a href="https://www.cnblogs.com/waacode/p/17539417.html">https://www.cnblogs.com/waacode/p/17539417.html</a></p><p><a href="https://www.modb.pro/db/128078">ç¬¬25ç¯‡ centos 8 åŒç½‘å¡ç»‘å®šï¼ˆbondé“¾è·¯èšåˆï¼‰ - å¢¨å¤©è½® (modb.pro)</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰</title>
      <link href="/2024/05/05/lvm%E6%9B%B4%E6%8D%A2%E7%A3%81%E7%9B%98%EF%BC%88%E5%AD%98%E5%9C%A8vg%E5%8D%B7%E7%BB%84%E7%9A%84%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%EF%BC%89/"/>
      <url>/2024/05/05/lvm%E6%9B%B4%E6%8D%A2%E7%A3%81%E7%9B%98%EF%BC%88%E5%AD%98%E5%9C%A8vg%E5%8D%B7%E7%BB%84%E7%9A%84%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%EF%BC%89/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰"><a href="#lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰" class="headerlink" title="lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰"></a>lvmæ›´æ¢ç£ç›˜ï¼ˆå­˜åœ¨vgå·ç»„çš„ç£ç›˜æŸåï¼‰</h1><blockquote><p>åªå«æœ‰pvçš„ç£ç›˜æŸåæ›´æ¢ | <a href="http://sunlight.zznnwn.cloudns.biz/2024/04/24/%E5%A4%9A%E5%9D%97%E7%A3%81%E7%9B%98%E9%85%8D%E7%BD%AElvm%E5%8D%B7%20%E4%B8%8D%E5%90%ABvg%E5%8D%B7%E7%9A%84%E6%9F%90%E5%9D%97%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%E8%A7%A3%E5%86%B3/">ä¼ é€é—¨&gt;&gt;</a></p><p>å¯¹äºæœºæ¢°ç¡¬ç›˜è€Œè¨€ï¼Œç»å¸¸ä¼šå‡ºç°åé“ï¼Œå½±å“æ•´ä½“çš„ç£ç›˜è¯»å†™é€Ÿåº¦ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦æ›´æ¢æ•…éšœçš„ç¡¬ç›˜ï¼Œæ¥ä¸‹æ¥æ¨¡æ‹Ÿæ“ä½œæ•´ä¸ªæ›´æ¢è¿‡ç¨‹ã€‚</p></blockquote><h2 id="ä¸€-æµ‹è¯•ç¯å¢ƒé…ç½®-åˆ›å»ºlvmå·æŒ‚è½½å¹¶ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸€-æµ‹è¯•ç¯å¢ƒé…ç½®-åˆ›å»ºlvmå·æŒ‚è½½å¹¶ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸€. æµ‹è¯•ç¯å¢ƒé…ç½® åˆ›å»ºlvmå·æŒ‚è½½å¹¶ä¸Šä¼ æ–‡ä»¶"></a>ä¸€. æµ‹è¯•ç¯å¢ƒé…ç½® åˆ›å»ºlvmå·æŒ‚è½½å¹¶ä¸Šä¼ æ–‡ä»¶</h2><h3 id="1-æµ‹è¯•ç¯å¢ƒ"><a href="#1-æµ‹è¯•ç¯å¢ƒ" class="headerlink" title="1.æµ‹è¯•ç¯å¢ƒ"></a>1.æµ‹è¯•ç¯å¢ƒ</h3><p>æ“ä½œç³»ç»Ÿï¼šubuntu20.04</p><p>ç¡¬ç›˜ï¼šå‡†å¤‡3å—5GBçš„ç¡¬ç›˜ç”¨äºæµ‹è¯•</p><h3 id="2-å‰ææ¡ä»¶åˆ›å»ºlvmå·"><a href="#2-å‰ææ¡ä»¶åˆ›å»ºlvmå·" class="headerlink" title="2.å‰ææ¡ä»¶åˆ›å»ºlvmå·"></a>2.å‰ææ¡ä»¶åˆ›å»ºlvmå·</h3><p>ä½¿ç”¨sdbã€sdcåŠ å…¥LVMå¹¶é…ç½®lvï¼Œåˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºPV</span></span><br><span class="line">pvcreate /dev/sd&#123;b..c&#125;   </span><br><span class="line"><span class="comment"># åˆ›å»ºVG</span></span><br><span class="line">vgcreate vg00 /dev/sdb /dev/sdc  </span><br><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ª8GBçš„LV</span></span><br><span class="line">lvcreate -n lv00 -L 8G vg00  </span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8827a051a031111cb47e8e85d0f319fe.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8827a051a031111cb47e8e85d0f319fe.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_fb1428a67eb75bf19a574c17ca127574.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_fb1428a67eb75bf19a574c17ca127574.png"></p><h3 id="3-æ ¼å¼åŒ–LVå¹¶æŒ‚è½½"><a href="#3-æ ¼å¼åŒ–LVå¹¶æŒ‚è½½" class="headerlink" title="3. æ ¼å¼åŒ–LVå¹¶æŒ‚è½½"></a>3. æ ¼å¼åŒ–LVå¹¶æŒ‚è½½</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ ¼å¼åŒ–ä¸ºext4æ ¼å¼</span></span><br><span class="line">mkfs.ext4 /dev/vg00/lv00  </span><br><span class="line"><span class="comment"># åˆ›å»ºæŒ‚è½½ç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> /lv00_datadir   </span><br><span class="line"><span class="comment"># æŒ‚è½½</span></span><br><span class="line">mount /dev/vg00/lv00 /lv00_datadir  </span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1827ebb3ba929ebaa9a949fca6455667.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_1827ebb3ba929ebaa9a949fca6455667.png"></p><p>ä¸Šä¼ æµ‹è¯•æ–‡ä»¶ï¼Œæˆ‘åœ¨è¿™é‡Œä¸Šä¼ ä¸€ä¸ªé•œåƒæ–‡ä»¶ï¼Œçº¦ä¸º15Må·¦å³ï¼›</p><p>ä½¿ç”¨md5sumå‘½ä»¤æ¥éªŒè¯ç¡¬ç›˜æ›´æ¢åæ•°æ®çš„å®Œæ•´æ€§ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹æ–‡ä»¶md5</span></span><br><span class="line"><span class="built_in">md5sum</span> /lv00_datadir/cirros-0.4.0-x86_64-disk.img</span><br><span class="line">// è¿”å›</span><br><span class="line">443b7623e27ecf03dc9e01ee93f67afe  /lv00_datadir/cirros-0.4.0-x86_64-disk.img</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8449f31b43f6f17a71494598fc1e2ec4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8449f31b43f6f17a71494598fc1e2ec4.png"></p><h2 id="äºŒ-æ›´æ¢ç£ç›˜-è¿ç§»åé“ç£ç›˜æ•°æ®"><a href="#äºŒ-æ›´æ¢ç£ç›˜-è¿ç§»åé“ç£ç›˜æ•°æ®" class="headerlink" title="äºŒ. æ›´æ¢ç£ç›˜ è¿ç§»åé“ç£ç›˜æ•°æ®"></a>äºŒ. æ›´æ¢ç£ç›˜ è¿ç§»åé“ç£ç›˜æ•°æ®</h2><p>å‡è®¾ sdb ç›®å‰å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œéœ€è¦ä½¿ç”¨ sdd æ¥æ›¿æ¢ï¼š</p><h3 id="1-é…ç½®sdd"><a href="#1-é…ç½®sdd" class="headerlink" title="1.é…ç½®sdd"></a>1.é…ç½®sdd</h3><p>å°† sdd åˆ†åŒºååŠ å…¥åˆ° VG ä¸­ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†sddåˆ›å»ºpvå·</span></span><br><span class="line">pvcreate /dev/sdd</span><br><span class="line"><span class="comment"># å°†sddåŠ å…¥vgå·</span></span><br><span class="line">vgextend vg00 /dev/sdd</span><br></pre></td></tr></table></figure><h3 id="2-è¿ç§»æ•°æ®"><a href="#2-è¿ç§»æ•°æ®" class="headerlink" title="2. è¿ç§»æ•°æ®"></a>2. è¿ç§»æ•°æ®</h3><h4 id="2-1-é€šè¿‡pvdisplayå‘½ä»¤æ¥æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š"><a href="#2-1-é€šè¿‡pvdisplayå‘½ä»¤æ¥æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š" class="headerlink" title="2.1 é€šè¿‡pvdisplayå‘½ä»¤æ¥æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š"></a>2.1 é€šè¿‡pvdisplayå‘½ä»¤æ¥æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹pvå·è¯¦æƒ…</span><br><span class="line">pvdisplay /dev/sdb</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_817b1d5249e0b48e8d3076f68c3ba559.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_817b1d5249e0b48e8d3076f68c3ba559.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶çš„sdbåŸºæœ¬è¢«ç”¨æ»¡äº†ï¼Œç›¸åº”åœ°sddè¿˜æ²¡æœ‰å¼€å§‹ä½¿ç”¨ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_4089272617ed1608011e87085bb86d9b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_4089272617ed1608011e87085bb86d9b.png"></p><h4 id="2-2-è¿ç§»æ•°æ®ï¼Œå°†sdbä¸­çš„æ•°æ®è¿ç§»åˆ°sddä¸­ï¼š"><a href="#2-2-è¿ç§»æ•°æ®ï¼Œå°†sdbä¸­çš„æ•°æ®è¿ç§»åˆ°sddä¸­ï¼š" class="headerlink" title="2.2 è¿ç§»æ•°æ®ï¼Œå°†sdbä¸­çš„æ•°æ®è¿ç§»åˆ°sddä¸­ï¼š"></a>2.2 è¿ç§»æ•°æ®ï¼Œå°†sdbä¸­çš„æ•°æ®è¿ç§»åˆ°sddä¸­ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># è¿ç§»sdb pvå·ä¸­çš„æ•°æ®åˆ° sdd</span><br><span class="line">pvmove /dev/sdb /dev/sdd</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8ca50c610533e1eded58b727b1b8c044.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_8ca50c610533e1eded58b727b1b8c044.png"></p><p>å†æ¬¡æŸ¥çœ‹ç£ç›˜sdbä¸Šæ˜¯å¦å­˜æœ‰æ•°æ®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pvdisplay /dev/sdb</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_980104501d271293dbf431880b22eca2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_980104501d271293dbf431880b22eca2.png"></p><p>æˆ–è€…ä½¿ç”¨pvscanæŸ¥çœ‹ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_2caa41a0e2c1b5e0807bdc99e46b3054.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_2caa41a0e2c1b5e0807bdc99e46b3054.png"></p><h4 id="2-3-ç§»å‡ºsdb"><a href="#2-3-ç§»å‡ºsdb" class="headerlink" title="2.3 ç§»å‡ºsdb"></a>2.3 ç§»å‡ºsdb</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†sdbä»VGä¸­ç§»å‡º</span></span><br><span class="line">vgreduce vg00 /dev/sdb  </span><br><span class="line"><span class="comment"># åˆ é™¤PV</span></span><br><span class="line">pvremove /dev/sdb  </span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_93fa85b202ffddcbdada05ec2e6aa091.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_93fa85b202ffddcbdada05ec2e6aa091.png"></p><h4 id="2-4-æ£€æŸ¥æ•°æ®å®Œæ•´æ€§"><a href="#2-4-æ£€æŸ¥æ•°æ®å®Œæ•´æ€§" class="headerlink" title="2.4 æ£€æŸ¥æ•°æ®å®Œæ•´æ€§"></a>2.4 æ£€æŸ¥æ•°æ®å®Œæ•´æ€§</h4><p>è¿˜æ˜¯ä½¿ç”¨md5sumå‘½ä»¤æ¥æ£€æŸ¥æ•°æ®å®Œæ•´æ€§ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5sum /lv00_datadir/cirros-0.4.0-x86_64-disk.img</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_51b7a5f9066d34eac92af24ffd2babeb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_51b7a5f9066d34eac92af24ffd2babeb.png"></p><p>æ›´æ¢å‰ä¸æ›´æ¢åè®¡ç®—å‡ºæ¥çš„å€¼éƒ½æ˜¯ä¸€æ ·ï¼Œè¯´æ˜æ•°æ®å®Œæ•´ï¼Œæµ‹è¯•æˆåŠŸã€‚</p><p>æœ¬æ–‡å‚è€ƒï¼š<a href="https://mp.weixin.qq.com/s?__biz=MzkwOTY0NTYzOA==&mid=2247485700&idx=1&sn=35450d4ddf918e6478a1e0af1eaff545&chksm=c136cb2df641423bf4b25c3918b69898582ed4263b0cc2bd633534de05e1b4bc7c7a95ba671d&mpshare=1&scene=24&srcid=0502Gk8XleBsbnh0t6JiGCo9&sharer_shareinfo=84be6c1a5a08f273b8d004edbbc0418a&sharer_shareinfo_first=84be6c1a5a08f273b8d004edbbc0418a#rd">ä¼šæˆé•¿çš„å°å­¦ç”Ÿ</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerè®¾ç½®iptables=falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•</title>
      <link href="/2024/04/29/docker%E8%AE%BE%E7%BD%AEiptables=false%E5%90%8E%E6%97%A0%E6%B3%95%E8%A7%A3%E6%9E%90DNS%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/"/>
      <url>/2024/04/29/docker%E8%AE%BE%E7%BD%AEiptables=false%E5%90%8E%E6%97%A0%E6%B3%95%E8%A7%A3%E6%9E%90DNS%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="dockerè®¾ç½®iptables-falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•"><a href="#dockerè®¾ç½®iptables-falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•" class="headerlink" title="dockerè®¾ç½®iptables=falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•"></a>dockerè®¾ç½®iptables=falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•</h1><blockquote><p>æœ¬æ–‡å‚è€ƒï¼š<a href="https://blog.csdn.net/wang805447391/article/details/120719570">dockerè®¾ç½®iptables=falseåæ— æ³•è§£æDNSçš„è§£å†³æ–¹æ³•_docker iptables false</a></p><p>dockeré»˜è®¤ä½¿ç”¨iptablesè¿›è¡Œç½‘ç»œé…ç½®ï¼Œä¸ufwæœ‰ç‚¹ä¸å…¼å®¹ï¼Œufwæ— æ³•ç®¡æ§dockeræš´éœ²å‡ºæ¥çš„ç«¯å£ï¼Œå¯èƒ½ä¼šé€ æˆä¸€å®šçš„å®‰å…¨é—®é¢˜ï¼Œæ‰€ä»¥æŸäº›æƒ…å†µä¸‹éœ€è¦å°†dockerçš„iptablesè®¾ç½®ä¸ºfalseã€‚<br>è®¾ç½®ä¹‹åè¿›å…¥dockerå®¹å™¨å†…éƒ¨å‘ç°æ— æ³•è®¿é—®ç½‘ç»œï¼Œåªèƒ½ä¸172.17.0.1ç½‘æ®µé€šä¿¡ã€‚</p></blockquote><h2 id="è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š"><a href="#è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š"></a>è§£å†³æ–¹æ¡ˆå¦‚ä¸‹ï¼š</h2><p>sudo systemctl edit docker.service</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[Service]</span><br><span class="line">ExecStartPre=/usr/sbin/iptables -t nat -A POSTROUTING -s 172.0.0.0/16 ! -o docker0 -j MASQUERADE</span><br><span class="line">ExecStopPost=/usr/sbin/iptables -t nat -D POSTROUTING -s 172.0.0.0/16 ! -o docker0 -j MASQUERADE</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_411fbc44b1e7914f452aa767b676f8ce.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_411fbc44b1e7914f452aa767b676f8ce.png"></p><p>é…ç½®è§£é‡Šï¼š</p><p>è¿™æ®µé…ç½®çš„ä½œç”¨æ˜¯ä¸ºDockerå®¹å™¨è®¾ç½®ç½‘ç»œåœ°å€è½¬æ¢ï¼ˆNATï¼‰ï¼Œä½¿å¾—ä»172.17.0.0/16å­ç½‘å‘å‡ºçš„æµé‡ç»è¿‡docker0æ¥å£æ—¶è¿›è¡ŒMASQUERADEï¼ˆä¼ªè£…ï¼‰å¤„ç†ï¼Œä»¥å®ç°ç½‘ç»œåœ°å€çš„è½¬æ¢å’Œéšè—ã€‚</p><p>åœ¨è¿™æ®µé…ç½®ä¸­ï¼š</p><ul><li><code>ExecStartPre</code> è¡ŒæŒ‡å®šäº†åœ¨å¯åŠ¨æœåŠ¡ä¹‹å‰æ‰§è¡Œçš„æ“ä½œï¼Œå³å‘iptablesä¸­æ·»åŠ ä¸€ä¸ªPOSTROUTINGè§„åˆ™ï¼Œå¯¹ä»172.17.0.0/16å­ç½‘å‘å‡ºçš„æµé‡è¿›è¡ŒMASQUERADEå¤„ç†ï¼Œä½†æ’é™¤äº†æµé‡ç»è¿‡docker0æ¥å£çš„æƒ…å†µã€‚</li><li><code>ExecStopPost</code> è¡ŒæŒ‡å®šäº†åœ¨åœæ­¢æœåŠ¡ä¹‹åæ‰§è¡Œçš„æ“ä½œï¼Œå³ä»iptablesä¸­åˆ é™¤ä¹‹å‰æ·»åŠ çš„ç›¸åŒè§„åˆ™ã€‚</li></ul><p>è¿™ç§é…ç½®é€šå¸¸ç”¨äºåœ¨Dockerç¯å¢ƒä¸­ç®¡ç†ç½‘ç»œæµé‡ï¼Œç¡®ä¿å®¹å™¨å†…éƒ¨çš„æµé‡èƒ½å¤Ÿæ­£å¸¸åœ°ä¸å¤–éƒ¨é€šä¿¡ï¼Œå¹¶ä¸”å¯¹å¤–éƒ¨ç½‘ç»œéšè—äº†å®¹å™¨å†…éƒ¨çš„çœŸå®IPåœ°å€ã€‚</p><h2 id="ç”Ÿæ•ˆé…ç½®"><a href="#ç”Ÿæ•ˆé…ç½®" class="headerlink" title="ç”Ÿæ•ˆé…ç½®"></a>ç”Ÿæ•ˆé…ç½®</h2><p>sudo systemctl daemon-reload  å³å¯</p><p>systemctl restart docker  æµ‹è¯•dockerèƒ½å¦æ­£å¸¸å¯åŠ¨</p><p>å‚è€ƒèµ„æ–™ï¼š<br><a href="https://gist.github.com/circa10a/e6cfc673af9282d17dfb958ef6adabeb">https://gist.github.com/circa10a/e6cfc673af9282d17dfb958ef6adabeb</a><br><a href="https://github.com/moby/moby/issues/26776">https://github.com/moby/moby/issues/26776</a></p>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤šå—ç£ç›˜é…ç½®lvmå· ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³</title>
      <link href="/2024/04/24/%E5%A4%9A%E5%9D%97%E7%A3%81%E7%9B%98%E9%85%8D%E7%BD%AElvm%E5%8D%B7%20%E4%B8%8D%E5%90%ABvg%E5%8D%B7%E7%9A%84%E6%9F%90%E5%9D%97%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%E8%A7%A3%E5%86%B3/"/>
      <url>/2024/04/24/%E5%A4%9A%E5%9D%97%E7%A3%81%E7%9B%98%E9%85%8D%E7%BD%AElvm%E5%8D%B7%20%E4%B8%8D%E5%90%ABvg%E5%8D%B7%E7%9A%84%E6%9F%90%E5%9D%97%E7%A3%81%E7%9B%98%E6%8D%9F%E5%9D%8F%E8%A7%A3%E5%86%B3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å¤šå—ç£ç›˜é…ç½®lvmå·-ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³"><a href="#å¤šå—ç£ç›˜é…ç½®lvmå·-ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³" class="headerlink" title="å¤šå—ç£ç›˜é…ç½®lvmå· ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³"></a>å¤šå—ç£ç›˜é…ç½®lvmå· ä¸å«vgå·çš„æŸå—ç£ç›˜æŸåè§£å†³</h1><p><strong>è§£æ</strong></p><p>Linux çš„ LVM ä¼šé»˜è®¤å­˜å‚¨ç”¨æˆ·å¯¹ PV/VG/LV çš„æ¯ä¸€æ­¥æ“ä½œï¼Œå¹¶è‡ªåŠ¨æŠŠå½“å‰çš„ VG çš„ä¿¡æ¯å¤‡ä»½åˆ°ä¸€ä¸ªæ–‡ä»¶é‡Œé¢ï¼Œä½ç½®æ˜¯ /etc/lvm/backup/VG åæˆ–è€… /etc/lvm/archive/VG åã€‚è¿™ä¸ªæ–‡ä»¶é‡Œé¢è®°å½•çš„ä¸œè¥¿å¤§æ¦‚è·Ÿ vgdisplay/pvdisplay/lvdisplay è¾“å‡ºçš„ä¿¡æ¯ä¸€è‡´ï¼Œé‡Œé¢ä¹ŸåŒ…æ‹¬äº†å¯¹äºæ¢å¤ VG ä¿¡æ¯è‡³å…³é‡è¦çš„ PV UUIDã€‚</p><p><strong>é€‚ç”¨åœºæ™¯ï¼š</strong></p><p>è¯¯æ“ä½œã€ç£ç›˜å¼‚å¸¸æ‰ç”µç­‰åŸå› å¯èƒ½ä¼šé€ æˆç¡¬ç›˜çš„é€»è¾‘æŸåï¼Œå½“LVMä¸­æŸå—ç¡¬ç›˜å‡ºç°å¼‚å¸¸æ—¶ï¼Œä¼šå¯¼è‡´éƒ¨åˆ†é€»è¾‘å·æˆ–æ•´ä¸ªå·ç»„æ— æ³•è®¿é—®çš„æƒ…å†µã€‚æˆ‘ä»¬æŸ¥çœ‹pvæ—¶ä¼šå‘ç°æç¤ºunknow device,å¹¶æç¤ºâ€œCouldnâ€™t find device with uuid xxxâ€ã€‚é—®é¢˜å¦‚å›¾ï¼Œæœ¬æ–‡ä»‹ç»äº†LVMä¸­æŸå—ç¡¬ç›˜æŸåçš„ç¾éš¾ä¿®å¤ï¼Œæ¥å°½å¯èƒ½æ¢å¤ç¾éš¾æ‰€é€ æˆçš„æ•°æ®æŸå¤±ã€‚</p><h2 id="ä¸€-å…·ä½“ç°è±¡"><a href="#ä¸€-å…·ä½“ç°è±¡" class="headerlink" title="ä¸€. å…·ä½“ç°è±¡"></a><strong>ä¸€. å…·ä½“ç°è±¡</strong></h2><p><strong>æ¨¡æ‹Ÿåå¢ƒï¼šä¸¤å—ç£ç›˜é…ç½® lvm</strong> æŒ‚è½½äº<strong>home</strong>ç›®å½•ï¼Œæ¨¡æ‹Ÿå…¶ä¸­ä¸€å—ç£ç›˜æŸåï¼ˆæ‰‹åŠ¨å¸è½½å…¶ä¸­ä¸€å—ç£ç›˜ï¼‰</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_01d0781150239f60d611e745039163f0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_01d0781150239f60d611e745039163f0.png"></p><p>æŒ‚è½½ç›®å½•å†™å…¥æ–‡ä»¶æµ‹è¯•æ¢å¤ èƒ½å¦æ¢å¤æ•°æ®</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d66d4886fa622e78c8eb0e4a953bc95a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d66d4886fa622e78c8eb0e4a953bc95a.png"></p><p><strong>ç°è±¡</strong>ï¼š<strong>æ­¤æ—¶æœ‰ä¸€å—pvå¤„äºunknowçŠ¶æ€ é‡å¯ç³»ç»Ÿåç°è±¡å¦‚ä¸‹</strong></p><ul><li>lsblk æŸ¥çœ‹æ²¡æœ‰çœ‹åˆ°  /dev/mapper å¼€å¤´çš„lvmå·</li><li>pvs æŸ¥çœ‹æœ‰ä¸€å—ç£ç›˜ pv å¤„äº unknow çŠ¶æ€ å¹¶ä¸”æ˜¾ç¤ºï¼šWARNING: Couldnâ€™t find device with uuid FCda1V-EwWN-qtfc-6SZ4-Vu1e-v8FG-XUCr5H æ‰¾ä¸åˆ°è¿™ä¸ªuuidçš„è®¾å¤‡</li><li>mount æŒ‚è½½æ˜¾ç¤ºæ‰¾ä¸åˆ°è®¾å¤‡</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_2f4b8b5f102e1cf6be27e0f7225fc7a8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_2f4b8b5f102e1cf6be27e0f7225fc7a8.png"></p><h2 id="äºŒ-è§£å†³"><a href="#äºŒ-è§£å†³" class="headerlink" title="äºŒ. è§£å†³"></a><strong>äºŒ. è§£å†³</strong></h2><ol><li><p>æœåŠ¡å™¨æ–°æ·»åŠ ä¸€å—ç£ç›˜ ç£ç›˜çš„å¤§å°å’Œ æŸåç£ç›˜çš„å¤§å°ä¸€è‡´ æ­¤æ¬¡æ–°æ·»åŠ ç£ç›˜ä¸º /dev/sdd</p></li><li><p>ä½¿ç”¨pvså®šä½æŸåç£ç›˜uuid: 8Acrc0-21LJ-yWfm-f7gb-2uvf-ogLu-cG6OIT</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7ad156f3d7d7bb8786b4b9794428c366.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7ad156f3d7d7bb8786b4b9794428c366.png"></p></li><li><p>ä½¿ç”¨åŸæ¥çš„PV UUIDæ¥åˆ›å»ºPVï¼Œå¹¶ä½¿ç”¨lvmé…ç½®å¤‡ä»½æ–‡ä»¶æ¥æ¢å¤ä¿¡æ¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹pvè¿”å›æŸåç£ç›˜uuid: 8Acrc0-21LJ-yWfm-f7gb-2uvf-ogLu-cG6OIT</span></span><br><span class="line">pvs</span><br><span class="line"><span class="comment"># ä½¿ç”¨åŸæ¥çš„PV UUIDæ¥åˆ›å»ºPVï¼Œå¹¶ä½¿ç”¨lvmé…ç½®å¤‡ä»½æ–‡ä»¶æ¥æ¢å¤ä¿¡æ¯ï¼ˆæœ¬æ–‡ä½¿ç”¨ï¼‰</span></span><br><span class="line">pvcreate --uuid  8Acrc0-21LJ-yWfm-f7gb-2uvf-ogLu-cG6OIT --restorefile /etc/lvm/backup/vg_mf  /dev/sdd</span><br><span class="line"><span class="comment"># æˆ–ä½¿ç”¨ç±»ä¼¼å¦‚ä¸‹å‘½ä»¤</span></span><br><span class="line">pvcreate /dev/vdc -u qaTzJn-Hdgc-aeC5-EUT0-H1l1-tPiA-rYXnDx --restorefile /etc/lvm/archive/vgtest_00002-645033136.vg</span><br></pre></td></tr></table></figure></li><li><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°sdcå·²ç»æˆåŠŸæ›¿æ¢ä¸ºäº†sdd</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_9029ced509c4251026a34bf3d3959213.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_9029ced509c4251026a34bf3d3959213.png"></p></li><li><p>å¦‚æœæ›¿æ¢åçš„/dev/sdd çš„atträ¸ºa-m è¡¨ç¤º/dev/sddä¸ºmissingçŠ¶æ€ åˆ™éœ€è¦æ‰§è¡Œä¸‹æ–¹å‘½ä»¤æ¢å¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ›¿æ¢åçš„/dev/sdd çš„atträ¸ºa-m è¡¨ç¤º/dev/sddä¸ºmissingçŠ¶æ€ åˆ™éœ€è¦æ‰§è¡Œä¸‹æ–¹å‘½ä»¤æ¢å¤ï¼ˆæœ¬æ–‡ä½¿ç”¨ï¼‰</span></span><br><span class="line">vgextend --restoremissing vg_mf /dev/sdd</span><br><span class="line"><span class="comment"># æˆ–ä½¿ç”¨ç±»ä¼¼å¦‚ä¸‹å‘½ä»¤æ–¹å¼</span></span><br><span class="line">vgcfgrestore -f archive/vgtest_00002-645033136.vg vgtest</span><br></pre></td></tr></table></figure></li><li><p>ç¡®è®¤ç¡¬ç›˜<strong>æ²¡æœ‰åœ¨</strong> missing çŠ¶æ€åï¼Œå¯¹å·ç»„è¿›è¡Œæ¢å¤ï¼Œæç¤ºæ¢å¤vgï¼Œæ²¡æœ‰æŠ¥é”™ï¼Œä½¿ç”¨lvscanå‘ç°å½“å‰lvçŠ¶æ€ä¸ºinactiveã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ·æ–°</span></span><br><span class="line">lvscan</span><br><span class="line"><span class="comment"># æ¢å¤å·ç»„ä¿¡æ¯</span></span><br><span class="line">vgcfgrestore -f  /etc/lvm/backup/vg_mf   vg_mf</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_dec1593e4a081755a2714700aa9fc7f9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_dec1593e4a081755a2714700aa9fc7f9.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_f5fbb85873ba0a7afb2d618093af9743.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_f5fbb85873ba0a7afb2d618093af9743.png"></p></li><li><p>æ¿€æ´»vgï¼Œå†æ¬¡æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ·æ–°</span></span><br><span class="line">lvscan</span><br><span class="line"><span class="comment"># æ¿€æ´»vg</span></span><br><span class="line">vgchange -ay vg_mf</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶å†æ¬¡ä½¿ç”¨ lvscan æŸ¥çœ‹ lvm å·çŠ¶æ€å˜ä¸º active</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_92c783e15b2248b4ca139d58f27f9000.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_92c783e15b2248b4ca139d58f27f9000.png"></p></li><li><p>æœ€åé‡æ–°æŒ‚è½½</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç£ç›˜uuid</span></span><br><span class="line">blkid</span><br><span class="line"><span class="comment"># æŒ‚è½½lvmå·</span></span><br><span class="line">mount /dev/mapper/vg_mf-lv_mf  /home</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_11474a9f9fdc89f0de5d179adac186d2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_11474a9f9fdc89f0de5d179adac186d2.png"></p><p>éªŒè¯æ•°æ®æ˜¯å¦æ¢å¤</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_e38c176548f7b5581090fcad7b034dfe.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_e38c176548f7b5581090fcad7b034dfe.png"></p><p>ä½†æ˜¯è¿™ç§æ–¹å¼å­˜åœ¨ä¸€ä¸ªbug æœ‰æ—¶å€™é‡å¯lsblk çœ‹ä¸åˆ°lvmå·ä¿¡æ¯ éœ€è¦é‡æ–°æ¿€æ´»vgå· æŒ‚è½½.ã€‚</p></li></ol><p>æ­¤æ—¶æ¢å¤æˆåŠŸã€‚</p><p><strong>æœ¬æ–‡å‚è€ƒ</strong></p><ul><li><a href="https://developer.aliyun.com/article/766142">https://developer.aliyun.com/article/766142</a></li><li><a href="https://blog.csdn.net/m0_64339281/article/details/134873834">https://blog.csdn.net/m0_64339281/article/details/134873834</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²</title>
      <link href="/2024/04/22/%E5%BC%80%E6%BA%90%E8%81%8A%E5%A4%A9%E7%B3%BB%E7%BB%9Ffiora%E4%B8%8EVocechat%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/22/%E5%BC%80%E6%BA%90%E8%81%8A%E5%A4%A9%E7%B3%BB%E7%BB%9Ffiora%E4%B8%8EVocechat%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²"><a href="#å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²" class="headerlink" title="å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²"></a>å¼€æºèŠå¤©ç³»ç»Ÿfioraä¸Vocechatéƒ¨ç½²</h1><h2 id="ä¸€-Vocechatéƒ¨ç½²"><a href="#ä¸€-Vocechatéƒ¨ç½²" class="headerlink" title="ä¸€. Vocechatéƒ¨ç½²"></a>ä¸€. Vocechatéƒ¨ç½²</h2><blockquote><p>å®˜ç½‘ï¼š<a href="https://doc.voce.chat/zh-cn/install/install-by-docker">Docker å®‰è£… | VoceChat</a></p><p>githubä»“åº“ï¼š<a href="https://github.com/privoce">https://github.com/privoce</a></p><p>ios å®‰å“ appä¸‹è½½ï¼š<a href="https://voce.chat/zh-CN#download">VoceChat Website</a></p><p>ç¼ºç‚¹ï¼šä½¿ç”¨firebaseé€šçŸ¥æ¨é€ å¯¹å›½å†…ä¸å‹å¥½ åŸºæœ¬æ— æ³•ä½¿ç”¨</p><p>ç®¡ç†å‘˜éœ€åœ¨ Firebase Cloud Console ä¸­é…ç½® <strong>FCM</strong>ã€‚</p><p>âš ï¸ è¯·æ³¨æ„ï¼šå¦‚æœä½¿ç”¨è‡ªå®šä¹‰çš„æ¨é€é…ç½®ï¼Œåˆ™ç§»åŠ¨ç«¯ï¼ˆiOS åŠ Androidï¼‰çš„æ¨é€æœåŠ¡å°†ä¼šä¸å¯ç”¨ï¼Œè¿™ä¸ iOS å’Œ Android çš„åº”ç”¨ç­¾åç›¸å…³ã€‚å› æ­¤åªæœ‰ç½‘é¡µç«¯å¯ä»¥æ”¶åˆ°æ¨é€æ¶ˆæ¯ã€‚ç›®å‰åœ¨æœ€æ–°çš„ç½‘é¡µç«¯ä¸­æä¾›äº†ä¸€å¥—é»˜è®¤é…ç½®ï¼Œè¯¦æƒ…å¯ä»¥è®¿é—®è®¾ç½® -&gt; Firebaseã€‚è¿œæœŸè§„åˆ’ä¼šæä¾›ç§»åŠ¨ç«¯ SDKï¼Œåˆ°æ—¶å¯ä»¥ç”±ç”¨æˆ·ç”¨è‡ªå·±çš„é¡¹ç›®ç­¾åã€‚</p><p>âš ï¸ å¦‚æœæ‚¨çš„ VoceChat åç«¯éƒ¨ç½²åœ¨ä¸­å›½å¤§é™†ï¼Œåˆ™æ¨é€å¯èƒ½å› ç½‘ç»œç®¡åˆ¶è€Œä¸å¯ç”¨ï¼Œå› ä¸ºç›®å‰çš„æ¨é€æœåŠ¡ä¾èµ– Google Firebaseã€‚æˆ‘ä»¬è®¡åˆ’é€æ­¥å°†æ¨é€æ›¿æ¢æˆç›´æ¥æ”¯æŒ APNs åŠå…¶ä»–å›½å†…å®‰å“æ‰‹æœºå‚å•†æ”¯æŒçš„å¹³å°ã€‚</p><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><p>Vocechatæ˜¯ä¸€å¥—æ”¯æŒç‹¬ç«‹éƒ¨ç½²çš„ä¸ªäººäº‘ç¤¾äº¤åª’ä½“èŠå¤©æœåŠ¡ï¼Œå…·æœ‰è½»é‡çº§ã€å¼€æºå’Œå¯è‡ªæ‰˜ç®¡ç­‰ç‰¹ç‚¹ã€‚å®ƒåšé‡‡ä¼—é•¿ï¼Œä»Slackã€Discordã€RocketChatã€Solidã€Matrixç­‰äº§å“å’Œè§„èŒƒä¸­æ±²å–ä¼˜ç‚¹ï¼Œé€‚ç”¨äºå›¢é˜Ÿå†…éƒ¨äº¤æµã€ä¸ªäººèŠå¤©æœåŠ¡æ­å»ºã€ç½‘ç«™å®¢æœä»¥åŠç½‘ç«™å†…åµŒç¤¾åŒºç­‰åœºæ™¯ã€‚</p><p>Vocechatèƒ½è½»æ˜“éƒ¨ç½²åœ¨ç§æœ‰äº‘ä¸Šï¼Œç”¨æˆ·å¯ä»¥è½»æ¾å°†å…¶éƒ¨ç½²åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·æ•°æ®å®Œå…¨ç”±ç”¨æˆ·è‡ªå·±æŒæ¡ï¼Œä¼ è¾“è¿‡ç¨‹åŠ å¯†ï¼Œä¿è¯äº†æ•°æ®çš„å®‰å…¨æ€§ã€‚æ­¤å¤–ï¼ŒVocechatçš„ä½“ç§¯ä»…ä¸º15MBï¼Œå‡ ä¹å¯ä»¥å¡è¿›ä»»ä½•æœåŠ¡å™¨é‡Œï¼ŒåŒæ—¶æ‹¥æœ‰æ­£å¸¸èŠå¤©æ‰€éœ€è¦çš„æ‰€æœ‰å¿…å¤‡åŠŸèƒ½ï¼Œå¦‚å›å¤ã€è½¬å‘ã€ç‚¹èµã€é’‰é€‰æ¶ˆæ¯ç­‰ã€‚å…¶ç•Œé¢ç®€æ´ï¼Œèƒ½å¤Ÿå¿«é€Ÿä¸Šæ‰‹ï¼Œæ”¯æŒåœ¨çº¿ä¸Šä¼ æ–‡ä»¶ã€å›¾ç‰‡ã€è§†é¢‘ï¼Œå¹¶ä¸”æ”¯æŒåœ¨çº¿æ’­æ”¾è§†é¢‘ã€‚</p><p>åœ¨å›¢é˜Ÿå†…éƒ¨äº¤æµæ–¹é¢ï¼ŒVocechatå¯ä»¥ä½œä¸ºä¸€ä¸ªé«˜æ•ˆçš„æ²Ÿé€šå·¥å…·ï¼Œæ”¯æŒæˆå‘˜é—´çš„å®æ—¶èŠå¤©ã€æ–‡ä»¶å…±äº«å’Œåä½œã€‚å¯¹äºä¸ªäººèŠå¤©æœåŠ¡æ­å»ºï¼ŒVocechatæä¾›äº†ä¸°å¯Œçš„è‡ªå®šä¹‰é€‰é¡¹ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚è¿›è¡Œä¸ªæ€§åŒ–è®¾ç½®ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿå¯ä»¥ä½œä¸ºç½‘ç«™å®¢æœå·¥å…·ï¼Œæä¾›ä¸è®¿å®¢çš„å®æ—¶äº¤æµåŠŸèƒ½ï¼Œæå‡å®¢æˆ·æœåŠ¡è´¨é‡ã€‚æ­¤å¤–ï¼ŒVocechatè¿˜å¯ä»¥ä»¥æ’ä»¶çš„å½¢å¼æ’å…¥åˆ°ç½‘é¡µä¸­ï¼Œæä¾›ç½‘é¡µèŠå¤©ç­‰å„ç§ä¸°å¯Œçš„åŠŸèƒ½ã€‚</p><h4 id="é¡¹ç›®ç»„æˆ"><a href="#é¡¹ç›®ç»„æˆ" class="headerlink" title="é¡¹ç›®ç»„æˆ"></a>é¡¹ç›®ç»„æˆ</h4><table><thead><tr><th><strong><strong>åç§°</strong></strong></th><th><strong><strong>æŠ€æœ¯</strong></strong></th><th><strong><strong>é¡¹ç›®</strong></strong></th><th><strong><strong>License</strong></strong></th><th><strong><strong>è¯´æ˜</strong></strong></th></tr></thead><tbody><tr><td>æœåŠ¡ç«¯:</td><td>Rust</td><td>vocechat-server(æš‚æœªå¼€æº)</td><td>å¾…å®š</td><td>èŠå¤©æœåŠ¡ç«¯ï¼Œæ”¯æŒä¸»æµå¹³å°: Linux x86_64, Windows 32/64, Arm32, Arch64</td></tr><tr><td>å®¢æˆ·ç«¯:</td><td>Flutter</td><td><a href="https://github.com/privoce/vocechat-client" title="vocechat-client">vocechat-client</a></td><td>Apache-2.0</td><td>èŠå¤©å®¢æˆ·ç«¯ï¼Œæ”¯æŒ Android, iOS å¹³å°çš„å®¢æˆ·ç«¯</td></tr><tr><td>Web:</td><td>React</td><td><a href="https://github.com/privoce/vocechat-web" title="vocechat-web">vocechat-web</a></td><td>GPL-3.0</td><td>èŠå¤©åŠŸèƒ½çš„æµè§ˆå™¨ç‰ˆæœ¬ï¼Œæ•´åˆäº†ç®¡ç†</td></tr><tr><td>Web-SDK:</td><td>React</td><td>vocechat-web-sdk(æš‚æœªå¼€æº)</td><td>GPL-3.0</td><td>å¯ä»¥æ•´åˆåˆ°å…¶ä»– Web äº§å“ä¸­ï¼Œä½¿å…¶èµ‹èƒ½èŠå¤©åŠŸèƒ½</td></tr></tbody></table></blockquote><p><strong>åŠŸèƒ½ä»‹ç»</strong></p><ul><li>æ”¯æŒä¸­è‹±æ–‡</li><li>æ”¯æŒAndroidã€iOSç«¯</li><li>æ”¯æŒDockerå®‰è£…ï¼Œéƒ¨ç½²æå…¶ç®€å•</li><li>å¤‡ä»½ç®€å•</li><li>æ”¯æŒå¯¹æ¥è‡ªæœ‰è´¦å·ç³»ç»Ÿ</li><li>æ”¯æŒç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆæ¯”å¦‚GitHubã€MetaMaskã€Googleç­‰ï¼‰</li><li>æ”¯æŒè®¿é—®æ§åˆ¶ &amp; è®¿å®¢æ¨¡å¼</li><li>APIæ–‡æ¡£è¯¦ç»†</li><li>æ”¯æŒè‡ªå»ºé¢‘é“</li></ul><p><strong>åŠŸèƒ½åˆ—è¡¨ &amp; è®¡åˆ’</strong></p><ul><li>ç¾¤èŠã€ç§èŠ / 2021-Q4</li><li>å¼•ç”¨, at / 2021-Q4</li><li>å›¾ç‰‡ã€å¤§æ–‡ä»¶ä¼ è¾“ / 2021-Q4</li><li>ç½®é¡¶ / 2022-Q1</li><li>è½¬å‘ / 2022-Q1</li><li>æ”¶è— / 2022-Q1</li><li>é˜…åå³ç„šï¼ˆé«˜çº§åŠŸèƒ½ï¼‰ / 2022-Q1</li><li>è¯­éŸ³ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰/ 2022-Q4</li><li>è§†é¢‘ï¼ˆé«˜çº§åŠŸèƒ½ï¼‰/ 2022-Q4</li></ul><h2 id="docker-composeéƒ¨ç½²"><a href="#docker-composeéƒ¨ç½²" class="headerlink" title="docker-composeéƒ¨ç½²"></a>docker-composeéƒ¨ç½²</h2><p>é•œåƒå¯é€‰</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">privoce/vocechat-server:latest</span></span><br><span class="line"><span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:vocechat-server</span></span><br></pre></td></tr></table></figure><p>éƒ¨ç½²</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">    <span class="attr">vocechat:</span></span><br><span class="line">        <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:vocechat-server</span></span><br><span class="line">        <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">        <span class="attr">ports:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;8000:3000&#x27;</span></span><br><span class="line">        <span class="attr">container_name:</span> <span class="string">vocechat-server</span></span><br><span class="line">        <span class="attr">volumes:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">&#x27;./data:/home/vocechat-server/data&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="æœºå™¨äººä½¿ç”¨"><a href="#æœºå™¨äººä½¿ç”¨" class="headerlink" title="æœºå™¨äººä½¿ç”¨"></a>æœºå™¨äººä½¿ç”¨</h2><p>APIåœ°å€ï¼š<a href="http://10.0.0.10:8000/api/swagger">http://10.0.0.10:8000/api/swagger</a></p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5fb9785cb7a0243bc3a8210f6267e92a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5fb9785cb7a0243bc3a8210f6267e92a.png"></p><h2 id="äºŒ-fioraéƒ¨ç½²"><a href="#äºŒ-fioraéƒ¨ç½²" class="headerlink" title="äºŒ. fioraéƒ¨ç½²"></a>äºŒ. fioraéƒ¨ç½²</h2><blockquote><p>githubä»“åº“ï¼š<a href="https://github.com/yinxin630/fiora">https://github.com/yinxin630/fiora</a></p><p>ä¸­æ–‡æ•™ç¨‹ï¼š<a href="https://yinxin630.github.io/fiora/zh-Hans/docs/faq">https://yinxin630.github.io/fiora/zh-Hans/docs/faq</a></p><p><strong>ä¿®æ”¹å®¢æˆ·ç«¯é…ç½®éœ€è¦é‡æ–°æ„å»ºå®¢æˆ·ç«¯</strong></p><table><thead><tr><th>Key</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>Server</td><td>string</td><td>/</td><td>å®¢æˆ·ç«¯è¦è¿æ¥çš„æœåŠ¡ç«¯åœ°å€</td></tr><tr><td>MaxImageSize</td><td>number</td><td>3145728 (3MB)</td><td>å®¢æˆ·ç«¯å¯ä»¥ä¸Šä¼ çš„æœ€å¤§å›¾ç‰‡å¤§å°</td></tr><tr><td>MaxBackgroundImageSize</td><td>number</td><td>5242880 (5MB)</td><td>å®¢æˆ·ç«¯å¯ä»¥ä¸Šä¼ çš„æœ€å¤§èƒŒæ™¯å›¾å¤§å°</td></tr><tr><td>MaxAvatarSize</td><td>number</td><td>1572864 (1.5MB)</td><td>å®¢æˆ·ç«¯å¯ä»¥ä¸Šä¼ çš„æœ€å¤§å¤´åƒå›¾ç‰‡å¤§å°</td></tr><tr><td>MaxFileSize</td><td>number</td><td>10485760 (10MB)</td><td>å®¢æˆ·ç«¯å¯ä»¥ä¸Šä¼ çš„æœ€å¤§æ–‡ä»¶å¤§å°</td></tr><tr><td>DefaultTheme</td><td>string</td><td>cool</td><td>é»˜è®¤ä¸»é¢˜</td></tr><tr><td>Sound</td><td>string</td><td>default</td><td>é»˜è®¤é€šçŸ¥éŸ³</td></tr><tr><td>TagColorMode</td><td>string</td><td>fixedColor</td><td>é»˜è®¤æ ‡ç­¾é¢œè‰²æ¨¡å¼</td></tr><tr><td>FrontendMonitorAppId</td><td>string</td><td>fixedColor</td><td>å²³é¹°ç›‘æ§ appId<a href="https://yueying.effirst.com/index">https://yueying.effirst.com/index</a></td></tr><tr><td>DisableDeleteMessage</td><td>boolean</td><td>false</td><td>ç¦æ­¢ç”¨æˆ·æ’¤å›æ¶ˆæ¯</td></tr></tbody></table><h3 id="æœåŠ¡ç«¯å˜é‡é…ç½®"><a href="#æœåŠ¡ç«¯å˜é‡é…ç½®" class="headerlink" title="æœåŠ¡ç«¯å˜é‡é…ç½®#"></a>æœåŠ¡ç«¯å˜é‡é…ç½®<a href="https://yinxin630.github.io/fiora/zh-Hans/docs/config#%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%85%8D%E7%BD%AE" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">#</a></h3><p><strong>ä¿®æ”¹æœåŠ¡ç«¯é…ç½®éœ€è¦é‡å¯åº”ç”¨</strong></p><table><thead><tr><th>Key</th><th>ç±»å‹</th><th>é»˜è®¤å€¼</th><th>æè¿°</th></tr></thead><tbody><tr><td>Host</td><td>string</td><td>your ip</td><td>æœåŠ¡ç«¯ host</td></tr><tr><td>Port</td><td>number</td><td>9200</td><td>æœåŠ¡ç«¯ç«¯å£å·</td></tr><tr><td>Database</td><td>string</td><td>mongodb://localhost:27017/fiora</td><td>mongoDB æ•°æ®åº“åœ°å€</td></tr><tr><td>RedisHost</td><td>string</td><td>localhost</td><td>redis åœ°å€ä¸»æœºå</td></tr><tr><td>RedisPort</td><td>number</td><td>6379</td><td>redis ç«¯å£</td></tr><tr><td>JwtSecret</td><td>string</td><td>jwtSecret (æ¨èä¿®æ”¹å®ƒæ¥ä¿è¯å®‰å…¨æ€§)</td><td>jwt token åŠ å¯† secret</td></tr><tr><td>MaxGroupCount</td><td>number</td><td>3</td><td>ç”¨æˆ·æœ€å¤§å¯ä»¥åˆ›å»ºçš„ç¾¤ç»„ä¸ªæ•°</td></tr><tr><td>AllowOrigin</td><td>string</td><td>null</td><td>å…è®¸çš„å®¢æˆ·ç«¯ origin åˆ—è¡¨, null æ—¶å…è®¸æ‰€æœ‰ origin è¿æ¥, å¤šä¸ªå€¼é€—å·åˆ†å‰²</td></tr><tr><td>tokenExpiresTime</td><td>number</td><td>2592000000 (30 å¤©)</td><td>ç™»é™† token è¿‡æœŸæ—¶é—´</td></tr><tr><td>Administrator</td><td>string</td><td>â€˜â€™</td><td>ç®¡ç†å‘˜ç”¨æˆ· id åˆ—è¡¨, å¤šä¸ªå€¼é€—å·åˆ†å‰²</td></tr><tr><td>DisableRegister</td><td>boolean</td><td>false</td><td>ç¦æ­¢æ³¨å†Œè´¦å·</td></tr><tr><td>DisableCreateGroup</td><td>boolean</td><td>false</td><td>ç¦æ­¢åˆ›å»ºç¾¤ç»„</td></tr><tr><td>ALIYUN_OSS</td><td>boolean</td><td>false</td><td>å¯ç”¨é˜¿é‡Œäº‘ OSS</td></tr><tr><td>ACCESS_KEY_ID</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS access key id. å‚è€ƒ:<a href="https://help.aliyun.com/document_detail/48699.html">https://help.aliyun.com/document_detail/48699.html</a></td></tr><tr><td>ACCESS_KEY_SECRET</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS access key secret. å‚è€ƒå’Œ ACCESS_KEY_ID ç›¸åŒ</td></tr><tr><td>ROLE_ARN</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS RoleARN. å‚è€ƒ:<a href="https://help.aliyun.com/document_detail/28649.html">https://help.aliyun.com/document_detail/28649.html</a></td></tr><tr><td>REGION</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS åœ°åŸŸ. ä¾‹å¦‚:<code>oss-cn-zhangjiakou</code></td></tr><tr><td>BUCKET</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS bucket åç§°</td></tr><tr><td>ENDPOINT</td><td>string</td><td>â€˜â€™</td><td>é˜¿é‡Œäº‘ OSS åŸŸå. ä¾‹å¦‚:<code>cdn</code></td></tr></tbody></table></blockquote><p><strong>é•œåƒå¯é€‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®˜æ–¹é•œåƒ</span></span><br><span class="line">redis</span><br><span class="line">mongo</span><br><span class="line">suisuijiang/fiora</span><br><span class="line"><span class="comment"># zznné˜¿é‡Œäº‘é•œåƒ</span></span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:redis4</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:mongo5.0.18</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:fiora</span><br></pre></td></tr></table></figure><h3 id="docker-composeéƒ¨ç½²-1"><a href="#docker-composeéƒ¨ç½²-1" class="headerlink" title="docker-composeéƒ¨ç½²"></a><code>docker-compose</code>éƒ¨ç½²</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">fiora_redis:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:redis4</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">fiora_redis</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fiora-network</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">fiora_db:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:mongo5.0.18</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">fiora_db</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;27017:27017&quot;</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fiora-network</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">fiora:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:fiora</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">fiora</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;9200:9200&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">Database=mongodb://fiora_db:27017/fiora</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">RedisHost=fiora_redis</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DisableRegister=true</span>  <span class="comment"># è®¾ç½®ä¸å…è®¸æ³¨å†Œç”¨æˆ·</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fiora-network</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">fiora-network:</span></span><br><span class="line">    <span class="attr">driver:</span> <span class="string">bridge</span></span><br></pre></td></tr></table></figure><p>ç›®å½•è¯´æ˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">|-- [.githubb]                // github actions</span><br><span class="line">|-- [.vscode]                 // vscode å·¥ä½œåŒºé…ç½®</span><br><span class="line">|-- [bin]                     // æœåŠ¡ç«¯è„šæœ¬</span><br><span class="line">|-- [build]                   // webpack é…ç½®</span><br><span class="line">|-- [client]                  // web å®¢æˆ·ç«¯</span><br><span class="line">|-- [config]                  // åº”ç”¨é…ç½®</span><br><span class="line">|-- [dist]                    // æ„å»ºå®¢æˆ·ç«¯è¾“å‡ºç›®å½•</span><br><span class="line">|-- [docs]                    // æ–‡æ¡£</span><br><span class="line">|-- [public]                  // æœåŠ¡ç«¯é™æ€èµ„æº</span><br><span class="line">|-- [server]                  // æœåŠ¡ç«¯</span><br><span class="line">|-- [<span class="built_in">test</span>]                    // å•å…ƒæµ‹è¯•</span><br><span class="line">|-- [types]                   // typescript ç±»å‹</span><br><span class="line">|-- [utils]                   // å·¥å…·æ–¹æ³•</span><br><span class="line">|-- .babelrc                  // babel é…ç½®</span><br><span class="line">|-- .eslintignore             // eslint å¿½ç•¥</span><br><span class="line">|-- .eslintrc                 // eslint é…ç½®</span><br><span class="line">|-- .gitignore                // git å¿½ç•¥</span><br><span class="line">|-- .nodemonrc                // nodemon é…ç½®</span><br><span class="line">|-- .prettierrc               // prettier é…ç½®</span><br><span class="line">|-- Dockerfile                // docker æ–‡ä»¶</span><br><span class="line">|-- LICENSE                   // fiora è®¸å¯</span><br><span class="line">|-- docker-compose.yaml       // docker compose é…ç½®</span><br><span class="line">|-- jest.*.sj                 // jest é…ç½®</span><br><span class="line">|-- package.json              // npm</span><br><span class="line">|-- tsconfig.json             // typescript é…ç½®</span><br><span class="line">|-- yarn.lock                 // yarn</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>æ­¤å®‰è£…å°±å®Œæˆäº†ï¼Œä¿®æ”¹æ–‡ä»¶ï¼Œfioraé¡µé¢ä¿®æ”¹è·¯å¾„</strong></p><ul><li>ä»¥ä¸‹logoï¼š<br>/opt/fiora/public/favicon-96.png<br>/opt/fiora/public/favicon-192.png<br>/opt/fiora/public/favicon-512.png<br>ä»¥ä¸‹ä¸»é¡µä¿®æ”¹è·¯å¾„<br>/opt/fiora/client/templates/index.html<br>ä»¥ä¸‹ä¾§è¾¹æ ä¿®æ”¹è·¯å¾„<br>/opt/fiora/client/modules/Sidebar/</li></ul><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>ä¸å…è®¸æ³¨å†Œæ—¶æ‰“å¼€ï¼ˆéœ€è¦æ³¨å†Œæ—¶å–æ¶ˆæ³¨é‡Šå³å¯ï¼‰ï¼š</p><ul><li>DisableRegister=true  # è®¾ç½®ä¸å…è®¸æ³¨å†Œç”¨æˆ·</li></ul><p>å…¶ä»–é…ç½®å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_63660670/article/details/130824723">https://blog.csdn.net/weixin_63660670/article/details/130824723</a></p>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²</title>
      <link href="/2024/04/21/%E5%BC%80%E6%BA%90%E6%A8%A1%E5%9E%8B%E6%8E%A5%E5%85%A5%E5%B9%B3%E5%8F%B0MaxKB%E9%83%A8%E7%BD%B2%E5%8F%8A%E5%AF%B9%E6%8E%A5OneApi/"/>
      <url>/2024/04/21/%E5%BC%80%E6%BA%90%E6%A8%A1%E5%9E%8B%E6%8E%A5%E5%85%A5%E5%B9%B3%E5%8F%B0MaxKB%E9%83%A8%E7%BD%B2%E5%8F%8A%E5%AF%B9%E6%8E%A5OneApi/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²åŠå¯¹æ¥OneApi"><a href="#å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²åŠå¯¹æ¥OneApi" class="headerlink" title="å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²åŠå¯¹æ¥OneApi"></a>å¼€æºæ¨¡å‹æ¥å…¥å¹³å°MaxKBéƒ¨ç½²åŠå¯¹æ¥OneApi</h1><blockquote><p>æœ¬å¹³å°ç”±å›½å†…å€¼å¾—å°Šæ•¬çš„å¼ºå¤§å…¬å¸é£è‡´äº‘å¼€æºçš„æ”¯æŒå¤šç”¨æˆ·éš”ç¦»çš„æ¨¡å‹æ¥å…¥å¹³å°</p><p>MaxKB æ˜¯ä¸€æ¬¾åŸºäº LLM å¤§è¯­è¨€æ¨¡å‹çš„çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿã€‚</p><ul><li><p>å¤šæ¨¡å‹æ”¯æŒï¼šæ”¯æŒå¯¹æ¥ä¸»æµçš„å¤§æ¨¡å‹ï¼ŒåŒ…æ‹¬æœ¬åœ°ç§æœ‰å¤§æ¨¡å‹ï¼ˆå¦‚ Llama 2ï¼‰ã€OpenAIã€é€šä¹‰åƒé—®ã€Kimiã€Azure OpenAI å’Œç™¾åº¦åƒå¸†å¤§æ¨¡å‹ç­‰ï¼›</p></li><li><p>å¼€ç®±å³ç”¨ï¼šæ”¯æŒç›´æ¥ä¸Šä¼ æ–‡æ¡£ã€è‡ªåŠ¨çˆ¬å–åœ¨çº¿æ–‡æ¡£ï¼Œæ”¯æŒæ–‡æœ¬è‡ªåŠ¨æ‹†åˆ†ã€å‘é‡åŒ–ï¼Œæ™ºèƒ½é—®ç­”äº¤äº’ä½“éªŒå¥½ï¼›</p></li><li><p>æ— ç¼åµŒå…¥ï¼šæ”¯æŒé›¶ç¼–ç å¿«é€ŸåµŒå…¥åˆ°ç¬¬ä¸‰æ–¹ä¸šåŠ¡ç³»ç»Ÿã€‚</p></li><li><p>é»˜è®¤ç”¨æˆ·å¯†ç  ç”¨æˆ·å: admin  å¯†ç : MaxKB@123..</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ab8425771622018b1cac85a6fcd23de4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ab8425771622018b1cac85a6fcd23de4.png"></p></li></ul></blockquote><h2 id="ä¸€-éƒ¨ç½²"><a href="#ä¸€-éƒ¨ç½²" class="headerlink" title="ä¸€. éƒ¨ç½²"></a>ä¸€. éƒ¨ç½²</h2><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1panel/maxkb</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:zznnwn-maxkb</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:maxkb-zd</span><br></pre></td></tr></table></figure><p>dockerå‘½ä»¤æ–¹å¼éƒ¨ç½²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name=maxkb -p 8080:8080 -v ~/.maxkb:/var/lib/postgresql/data 1panel/maxkb</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”¨æˆ·å: admin</span></span><br><span class="line"><span class="comment"># å¯†ç : MaxKB@123..</span></span><br></pre></td></tr></table></figure><p>docker-composeæ–¹å¼éƒ¨ç½²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  maxkb:</span><br><span class="line">    <span class="comment">#image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:zznnwn-maxkb</span></span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:maxkb-zd</span><br><span class="line">    <span class="comment"># 1panel/maxkb</span></span><br><span class="line">    container_name: maxkb</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;8080:8080&quot;</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ~/.maxkb:/var/lib/postgresql/data</span><br></pre></td></tr></table></figure><h2 id="äºŒ-ä½¿ç”¨"><a href="#äºŒ-ä½¿ç”¨" class="headerlink" title="äºŒ. ä½¿ç”¨"></a>äºŒ. ä½¿ç”¨</h2><ul><li>ç³»ç»Ÿè®¾ç½®â€”â€”æ¨¡å‹â€”â€”æ·»åŠ æ¨¡å‹</li><li>çŸ¥è¯†åº“â€”â€”åˆ›å»ºçŸ¥è¯†åº“</li><li>åº”ç”¨â€”â€”åˆ›å»ºç‰¹å®šåŠŸèƒ½åº”ç”¨</li></ul><h2 id="ä¸‰-å¯¹æ¥oneapi"><a href="#ä¸‰-å¯¹æ¥oneapi" class="headerlink" title="ä¸‰. å¯¹æ¥oneapi"></a>ä¸‰. å¯¹æ¥oneapi</h2><ul><li>APIåŸŸåï¼š<a href="http://192.168.30.69:3000/v1">http://192.168.30.69:3000/v1</a></li><li>API KEY:  ä½¿ç”¨oneapiç”Ÿæˆçš„key</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/706aff61c16b2461c19832f3ff3478e_6235ec82459de423aa720924cc3adec8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/706aff61c16b2461c19832f3ff3478e_6235ec82459de423aa720924cc3adec8.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_dee2044e670622e3092cfed2755c916e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_dee2044e670622e3092cfed2755c916e.png"></p><h2 id="å››-æ•ˆæœ"><a href="#å››-æ•ˆæœ" class="headerlink" title="å››. æ•ˆæœ"></a>å››. æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c968720d48c42e71925c7c325bf39e88.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c968720d48c42e71925c7c325bf39e88.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://github.com/1panel-dev/MaxKB">https://github.com/1panel-dev/MaxKB</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kvmæ•™ç¨‹</title>
      <link href="/2024/04/20/kvm%E6%95%99%E7%A8%8B/"/>
      <url>/2024/04/20/kvm%E6%95%99%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="kvmæ•™ç¨‹"><a href="#kvmæ•™ç¨‹" class="headerlink" title="kvmæ•™ç¨‹"></a>kvmæ•™ç¨‹</h1><h3 id="è™šæ‹ŸåŒ–çš„å®šä¹‰"><a href="#è™šæ‹ŸåŒ–çš„å®šä¹‰" class="headerlink" title="è™šæ‹ŸåŒ–çš„å®šä¹‰"></a>è™šæ‹ŸåŒ–çš„å®šä¹‰</h3><p>è™šæ‹ŸåŒ–æŠ€æœ¯æœ€æ—©å‡ºç°åœ¨60å¹´ä»£çš„IBMå¤§å‹æœºç³»ç»Ÿï¼Œè¿™äº›æœºå™¨é€šè¿‡Hypervisor(åˆç§°è™šæ‹Ÿæœºç›‘æ§å™¨)çš„ç¨‹åºåœ¨ä¸€å°ç‰©ç†çš„æœåŠ¡å™¨ä¸Šå¯ä»¥è·‘å¤šå°è™šæ‹Ÿæœº(VirtualMachineï¼ŒVM)ï¼Œè™šæ‹Ÿæœºå…±äº«ç‰©ç†æœºçš„CPUã€å†…å­˜ã€10 ç­‰ç¡¬ä»¶èµ„æºï¼Œä½†é€»è¾‘ä¸Šè™šæ‹Ÿæœºä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»çš„ã€‚</p><h3 id="å¸¸è§çš„Hypervisorç±»å‹"><a href="#å¸¸è§çš„Hypervisorç±»å‹" class="headerlink" title="å¸¸è§çš„Hypervisorç±»å‹"></a>å¸¸è§çš„Hypervisorç±»å‹</h3><p><strong>ç±»å‹1-è£¸æœºå‹</strong>:  ç›´æ¥è¿è¡Œåœ¨ç¡¬ä»¶è®¾å¤‡ä¸Šçš„ï¼Œè¿™ç§æ¶æ„æ­å»ºçš„è™šæ‹ŸåŒ–ç¯å¢ƒç§°ä¸ºè£¸æœºè™šæ‹ŸåŒ–ç¯å¢ƒï¼Œä¾‹å¦‚:VMware ESXl<br><strong>ç±»å‹I1-ä¸»æœºæ‰˜ç®¡å‹</strong>:  è¿è¡Œåœ¨å…·æœ‰è™šæ‹ŸåŒ–åŠŸèƒ½çš„æ“ä½œç³»ç»Ÿä¸Šçš„ï¼Œè¿™ç§æ¶æ„æ„å»ºçš„æ˜¯ä¸»æœºè™šæ‹ŸåŒ–ç¯å¢ƒï¼Œä¾‹<br><strong>å¦‚</strong>: VMware Workstation.VirtualBoxã€KVMã€xenç­‰ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_2121384e9f54523bd1280ade709ccda4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_2121384e9f54523bd1280ade709ccda4.png"></p><h3 id="è™šæ‹ŸåŒ–çš„ç±»å‹"><a href="#è™šæ‹ŸåŒ–çš„ç±»å‹" class="headerlink" title="è™šæ‹ŸåŒ–çš„ç±»å‹"></a>è™šæ‹ŸåŒ–çš„ç±»å‹</h3><p><strong>æœåŠ¡å™¨è™šæ‹ŸåŒ–</strong>: å¯åœ¨ä¸€å°ç‰©ç†æœºä¸Šè¿è¡Œå¤šä¸ªè™šæ‹Ÿæœºï¼Œå„è™šæ‹Ÿæœºä¹‹é—´ç›¸äº’éš”ç¦»äº’ä¸å½±å“ï¼Œè™šæ‹Ÿæœºçš„å®Œæ•´çŠ¶æ€ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œç§»åŠ¨å’Œå¤åˆ¶è™šæ‹Ÿæœºå°±åƒç§»åŠ¨å’Œå¤åˆ¶æ–‡ä»¶ä¸€æ ·è½»æ¾ï¼Œå¯å°†ä»»æ„è™šæ‹Ÿæœºè°ƒé…æˆ–è¿ç§»åˆ°å…¶ä»–ç†æœåŠ¡å™¨ä¸Šã€‚</p><p><strong><strong>å®¹å™¨è™šæŠ€æœ¯</strong>: å…¸å‹çš„å°±æ˜¯dockerã€Linux Container(LXC)ç­‰</strong></p><p><strong>ç½‘ç»œè™šæ‹ŸåŒ–</strong>: é€šè¿‡è½¯ä»¶å®šä¹‰ç½‘ç»œï¼Œå³ç½‘ç»œçš„åˆ›å»ºä¸å†ä¾èµ–äºç‰©ç†è®¾å¤‡ï¼Œå¦‚å…¬æœ‰äº‘å‚å•†å…è®¸ç”¨æˆ·è‡ªå·±åˆ›å»ºæ–°çš„ç½‘ç»œï¼Œåœ¨kubernetesã€openstackä¸­éƒ½ä¼šä½¿ç”¨åˆ°ç½‘ç»œè™šæ‹ŸåŒ–ã€‚</p><h3 id="è™šæ‹ŸåŒ–æŠ€æœ¯åˆ†ç±»"><a href="#è™šæ‹ŸåŒ–æŠ€æœ¯åˆ†ç±»" class="headerlink" title="è™šæ‹ŸåŒ–æŠ€æœ¯åˆ†ç±»"></a>è™šæ‹ŸåŒ–æŠ€æœ¯åˆ†ç±»</h3><p><strong>å…¨è™šæ‹ŸåŒ–</strong>: Hypervisor ç›´æ¥å®‰è£…åœ¨ç‰©ç†æœºä¸Šï¼Œå¤šä¸ªè™šæ‹Ÿæœºåœ¨ Hypervisor ä¸Šè¿è¡Œï¼ŒHypervisor å®ç°æ–¹å¼ä¸€èˆ¬æ˜¯ä¸€ä¸ªç‰¹æ®Šå®šåˆ¶çš„ Linux ç³»ç»Ÿï¼Œ<strong>ä¾‹å¦‚</strong>: Xenå’ŒVMWare ESXi éƒ½å±äºè¿™ä¸ªç±»å‹ã€‚ï¼ˆé€‚ç”¨äºä¼ä¸šç§æœ‰ï¼‰**</p><p><strong>ç¡¬ä»¶è¾…åŠ©è™šæ‹ŸåŒ–</strong>: KVMæ˜¯ç¡¬ä»¶è¾…åŠ©çš„è™šæ‹ŸåŒ–æŠ€æœ¯ï¼Œä¸»è¦è´Ÿè´£æ¯”è¾ƒç¹ççš„<strong>CPU</strong>å’Œ<strong>å†…å­˜è™šæ‹ŸåŒ–</strong>ï¼Œè€Œ<strong>Qemu</strong>åˆ™è´Ÿè´£<strong>I/0</strong>è™šæ‹ŸåŒ–ã€‚ï¼ˆé€‚ç”¨äºå…¬æœ‰äº‘ï¼‰</p><p><strong>è™šæ‹ŸåŒ–æ¨¡æ‹Ÿå™¨</strong>: Qemu æ¨¡æ‹Ÿå™¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¤§å¤šæ•°çš„åšæ³•éƒ½æ˜¯é…åˆKVMæ¥å®Œæˆè™šæ‹ŸåŒ–å·¥ä½œï¼ŒKVMå®Œæˆå¤æ‚åŠè¦æ±‚æ¯”è¾ƒé«˜çš„CPUå’Œå†…å­˜çš„è™šæ‹ŸåŒ–ï¼Œè€ŒQemuå®Œæˆåƒç¡¬ç›˜ã€é¼ æ ‡ã€é”®ç›˜ç­‰è®¾å¤‡çš„è™šæ‹ŸåŒ–ã€‚ï¼ˆé€‚ç”¨äºå…¬æœ‰äº‘ï¼‰</p><h3 id="KVMè™šæ‹ŸåŒ–ä»‹ç»"><a href="#KVMè™šæ‹ŸåŒ–ä»‹ç»" class="headerlink" title="KVMè™šæ‹ŸåŒ–ä»‹ç»"></a>KVMè™šæ‹ŸåŒ–ä»‹ç»</h3><p><strong>KVM</strong> æ˜¯Kernel-based Virtual Machine(åŸºäºå†…æ ¸çš„è™šæ‹Ÿæœº)çš„ç®€ç§°ï¼Œæ˜¯ä¸€ä¸ªå¼€æºçš„Linuxç³»ç»Ÿå†…æ ¸è™šæ‹ŸåŒ–æ¨¡å—ï¼Œè‡ªLinux2.6ä¹‹åé›†æˆåœ¨Linuxçš„å„ä¸ªä¸»è¦å‘è¡Œç‰ˆæœ¬ä¸­ï¼ŒKVMç›®å‰å·²æˆä¸ºå­¦æœ¯ç•Œä¸»æµçš„hypervisorã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ab78ebf3ee7974ceac39b802b6d3b861.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ab78ebf3ee7974ceac39b802b6d3b861.png"></p><h3 id="è™šæ‹Ÿæœºå¸¸ç”¨çš„ç®¡ç†å·¥å…·"><a href="#è™šæ‹Ÿæœºå¸¸ç”¨çš„ç®¡ç†å·¥å…·" class="headerlink" title="è™šæ‹Ÿæœºå¸¸ç”¨çš„ç®¡ç†å·¥å…·"></a>è™šæ‹Ÿæœºå¸¸ç”¨çš„ç®¡ç†å·¥å…·</h3><p><strong>libvirt:</strong> æ˜¯è°ƒç”¨KVMåˆ›å»ºè™šæ‹Ÿæœºçš„å·¥å…·ï¼Œå…¶ä¸ä½†èƒ½ç®¡ç†KVMï¼Œè¿˜èƒ½ç®¡ç†VMwareã€Xenã€Hyper-Vã€virtualBoxç­‰è™šæ‹ŸåŒ–æ–¹æ¡ˆã€‚</p><p><strong>virsh</strong>: æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ç®¡ç†KVMè™šæ‹ŸåŒ–çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</p><p><strong>virt-manager</strong>:  virt-manageræ˜¯ä¸€ä¸ªè™šæ‹ŸåŒ–ç®¡ç†å›¾å½¢è½¯ä»¶ï¼ŒåŒ…æ‹¬è™šæ‹Ÿæœºçš„åˆ›å»ºã€åˆ é™¤ã€å¯åŠ¨ã€åœæ­¢ä»¥åŠä¸€äº›ç®€å•çš„ç›‘æ§åŠŸèƒ½ç­‰ã€‚ï¼ˆå¾ˆå°‘ä½¿ç”¨ä¸å®‰è£…ï¼‰</p><p><strong>openstack</strong>:  openstackæ˜¯ä¸€ä¸ªå¼€æºçš„è™šæ‹ŸåŒ–é›†ç¾¤ç»Ÿä¸€ç®¡ç†çš„å¹³å°ï¼Œå¸¸ç”¨äºæ„å»ºå¤§è§„æ¨¡çš„è™šæ‹ŸåŒ–ç¯å¢ƒï¼Œç”¨äºç®¡ç†æˆåƒä¸Šä¸‡è™šæ‹Ÿæœºçš„åˆ›å»ºã€å¯åŠ¨ã€åˆ é™¤ç­‰æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ</p><blockquote><p>ç”Ÿäº§ç¯å¢ƒä¸­ åˆ›å»ºè™šæ‹Ÿæœºä¸€å¾‹ä½¿ç”¨æ­¤å‘½ä»¤ï¼ˆä¸‹æ–¹ä¸¤å‚æ•°æ ¹æ®å®¿ä¸»æœºcpu memå®é™…åˆç†èŒƒå›´æ›´æ”¹ï¼‰</p><ul><li><strong>maxmemory</strong>=2048   æœ€å¤§æ”¯æŒçš„å†…å­˜æ ¸å¿ƒæ•°</li><li><strong>maxvcpus</strong>=4             æœ€å¤§æ”¯æŒçš„CPUæ ¸å¿ƒæ•°</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºè™šæ‹Ÿæœº</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web04 \</span><br><span class="line">--memory 1024,maxmemory=2048 \</span><br><span class="line">--vcpus 1,maxvcpus=4 --disk /kvm/web04-vda.qcow2,format=qcow2,size=10 \</span><br><span class="line">--cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso --network bridge=br0 --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br></pre></td></tr></table></figure></blockquote><h2 id="äºŒ-å®‰è£…kvmè™šæ‹ŸåŒ–ç®¡ç†å·¥å…·ï¼ˆæœ¬æ•™ç¨‹ç¯å¢ƒworkstdtionï¼‰"><a href="#äºŒ-å®‰è£…kvmè™šæ‹ŸåŒ–ç®¡ç†å·¥å…·ï¼ˆæœ¬æ•™ç¨‹ç¯å¢ƒworkstdtionï¼‰" class="headerlink" title="äºŒ. å®‰è£…kvmè™šæ‹ŸåŒ–ç®¡ç†å·¥å…·ï¼ˆæœ¬æ•™ç¨‹ç¯å¢ƒworkstdtionï¼‰"></a>äºŒ. å®‰è£…kvmè™šæ‹ŸåŒ–ç®¡ç†å·¥å…·ï¼ˆæœ¬æ•™ç¨‹ç¯å¢ƒworkstdtionï¼‰</h2><table><thead><tr><th><strong>ä¸»æœºåç§°</strong></th><th><strong>IPåœ°å€</strong></th><th><strong>ç³»ç»Ÿç¯å¢ƒ</strong></th><th><strong>ç¡¬ä»¶ç¯å¢ƒ</strong></th></tr></thead><tbody><tr><td><strong>kvm01</strong></td><td><strong>10.0.0.10</strong></td><td><strong>centos7.9</strong></td><td><strong>4C8G50G</strong></td></tr></tbody></table><h3 id="è™šæ‹ŸæœºCPUå¼€å¯è™šæ‹ŸåŒ–åŠŸèƒ½"><a href="#è™šæ‹ŸæœºCPUå¼€å¯è™šæ‹ŸåŒ–åŠŸèƒ½" class="headerlink" title="è™šæ‹ŸæœºCPUå¼€å¯è™šæ‹ŸåŒ–åŠŸèƒ½"></a>è™šæ‹ŸæœºCPUå¼€å¯è™šæ‹ŸåŒ–åŠŸèƒ½</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_17270590f1aeca75a8028b0714cd4f21.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_17270590f1aeca75a8028b0714cd4f21.png"></p><p><strong>å¼€æœºåæ£€æµ‹CPUæ˜¯å¦æ”¯æŒåµŒå¥—è™šæ‹ŸåŒ–</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# egrep -o &#x27;vmx|svm&#x27; /proc/cpuinfo</span><br><span class="line">vmx</span><br><span class="line">vmx  æ˜¾ç¤ºå·²è½½å…¥çš„ç³»ç»Ÿæ¨¡å—</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…KVMç›¸å…³è½¯ä»¶åŒ…"><a href="#å®‰è£…KVMç›¸å…³è½¯ä»¶åŒ…" class="headerlink" title="å®‰è£…KVMç›¸å…³è½¯ä»¶åŒ…"></a>å®‰è£…KVMç›¸å…³è½¯ä»¶åŒ…</h3><p><strong>å‡†å¤‡å·¥ä½œ æœ¬æ–‡æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬æœ¬é¡¹ç›®ä¸æ‰§è¡Œ</strong>ï¼ˆå¯é€‰ï¼‰</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rm /etc/yum.repos.d</span><br><span class="line">mount /dev/cdrom /mnt</span><br><span class="line">vim /etc/fstab </span><br><span class="line">/dev/cdrom  /mnt  iso9660  default 0 Â 0 </span><br><span class="line">vim  /etc/yum.repos.d/local.repo</span><br><span class="line">[local]</span><br><span class="line">name=local</span><br><span class="line">baseurl=file:///mnt</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br></pre></td></tr></table></figure><p><strong>libvirt</strong>:  ç”¨äºåˆ›å»ºè™šæ‹Ÿæœº</p><p><strong>virt-install</strong>ï¼šè™šæ‹Ÿæœºçš„å®‰è£…å·¥å…·å’Œå…‹éš†å·¥å…·(éå¸¸é‡è¦çš„åŠŸèƒ½)</p><p><strong>qemu-kvm</strong>:  ç®¡ç†è™šæ‹Ÿæœºçš„ç£ç›˜</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># æ£€æµ‹æº</span><br><span class="line">yum repolist</span><br><span class="line"># å®‰è£…è½¯ä»¶</span><br><span class="line">yum insta1l libvirt virt-install qemu-kvm -y</span><br><span class="line"># å¯åŠ¨æœåŠ¡</span><br><span class="line">systemctl start libvirtd &amp;&amp; systemctl enable libvirtd &amp;&amp; systemctl status libvirtd</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºKVMè™šæ‹Ÿæœºï¼ˆé€‰æ‹©è½»é‡é•œåƒæ–¹ä¾¿å®éªŒä¸Šä¼ ä¸‹è½½ï¼‰"><a href="#åˆ›å»ºKVMè™šæ‹Ÿæœºï¼ˆé€‰æ‹©è½»é‡é•œåƒæ–¹ä¾¿å®éªŒä¸Šä¼ ä¸‹è½½ï¼‰" class="headerlink" title="åˆ›å»ºKVMè™šæ‹Ÿæœºï¼ˆé€‰æ‹©è½»é‡é•œåƒæ–¹ä¾¿å®éªŒä¸Šä¼ ä¸‹è½½ï¼‰"></a>åˆ›å»ºKVMè™šæ‹Ÿæœºï¼ˆé€‰æ‹©è½»é‡é•œåƒæ–¹ä¾¿å®éªŒä¸Šä¼ ä¸‹è½½ï¼‰</h3><p><strong>æå‰å°†centosé•œåƒä¸Šä¼ åˆ°ç³»ç»Ÿå†…ç”¨äºç»™kvmè™šæ‹Ÿæœºå®‰è£…ç³»ç»Ÿ</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æå‰å°†centos7é•œåƒä¼ åˆ°ç³»ç»Ÿå†…ç”¨äºç»™KVMè™šæ‹Ÿæœºå®‰è£…ç³»ç»Ÿ</span></span><br><span class="line"><span class="built_in">mv</span> CentOS-7-x86_64-Minimal-2009.iso /opt</span><br><span class="line"><span class="comment"># åˆ›å»ºKVMè™›æ‹Ÿæœº</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web01 \</span><br><span class="line">--memory 1024 \</span><br><span class="line">--vcpus 1 --disk /opt/web01-vda.raw,format=raw,size=10 --cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso \</span><br><span class="line">--network network=default --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br><span class="line"></span><br><span class="line"><span class="comment"># å‚æ•°è§£é‡Š:</span></span><br><span class="line">--virt-type kvm Â <span class="comment"># è™šæ‹ŸåŒ–çš„ç±»å‹</span></span><br><span class="line">--os-type=linux Â <span class="comment"># ç³»ç»Ÿç±»å‹</span></span><br><span class="line">--os-variant Â  Â  <span class="comment"># rhel7ç³»ç»Ÿç‰ˆæœ¬</span></span><br><span class="line">--name webO1 Â  Â  <span class="comment"># è™šæ‹Ÿæœºçš„åå­—</span></span><br><span class="line">--memory 1024 Â  Â <span class="comment"># è™šæ‹Ÿæœºçš„å†…å­˜</span></span><br><span class="line">--vcpus 1 Â  Â  Â  Â <span class="comment"># è™šæ‹Ÿcpuçš„æ ¸æ•°</span></span><br><span class="line">--disk /opt/web0l-vda.raw,format=raw,size=10 Â <span class="comment"># ç£ç›˜ä½ç½®åŠåç§°,ç£ç›˜æ ¼å¼,ç©ºé—´å¤§å°(G)</span></span><br><span class="line">--cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso <span class="comment"># ç³»ç»Ÿé•œåƒä½ç½®åŠåç§°</span></span><br><span class="line">--network network=default Â  Â  <span class="comment"># ä½¿ç”¨é»˜è®¤ç½‘ç»œ(é»˜è®¤NAT)</span></span><br><span class="line">--graphics vnc,listen=0.0.0.0 <span class="comment"># å¼€å¯VNC</span></span><br><span class="line">--noautoconsole Â  Â  Â  Â  Â  Â  Â  <span class="comment"># æœåŠ¡å™¨ç«¯æ”¯æŒconsoleç™»å½• </span></span><br></pre></td></tr></table></figure><p><strong>ç¿»è¯‘</strong>ï¼šå®‰è£…å®Œæˆåéœ€è¦å»æ§åˆ¶å°å®Œæˆå®‰è£… ç”µè„‘å®‰è£…ä¸€ä¸ªæˆ–è€…ä½¿ç”¨mobaxtermè¿æ¥å®Œæˆå®‰è£…</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_94db20daccc7489e24ae4fbc9e524935.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_94db20daccc7489e24ae4fbc9e524935.png"></p><p>è™šæ‹Ÿæœºvncæš´éœ²ç«¯å£<strong>5900</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm opt]<span class="comment"># ss -ntulp</span></span><br><span class="line">Netid State Â  Â   Recv-Q Send-Q Â  Local Address:Port Â  Â   Peer Address:Port Â  Â  Â  Â  Â  Â  Â </span><br><span class="line">tcp Â  LISTEN Â  Â  0 Â  Â  Â 1 Â  Â  *:5900 Â   <span class="built_in">users</span>:((&quot;qemu-kvm&quot;,pid=<span class="number">3551</span>,fd=<span class="number">19</span>))</span><br></pre></td></tr></table></figure><p><strong>è¿æ¥è¿‡æ¥ä¹‹åä¾¿åœ¨æ­¤å®‰è£…é¡µé¢</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d271ac8899700a02171525adff77649f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d271ac8899700a02171525adff77649f.png"></p><p>æ­¤æ—¶æŒ‰ç…§æ­£å¸¸å®‰è£…æµç¨‹å³å¯ å®‰è£…å®Œæˆåç‚¹å‡»é‡å¯æ­¤æ—¶ä¸ä¼šé‡å¯ éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨æ‰“å¼€ï¼ˆé€šè¿‡ <strong>ss -ntulp</strong> æŸ¥çœ‹ <strong>qemo-kvm</strong> ç«¯å£ é€šè¿‡ <strong>vnc</strong> è¿æ¥è™šæ‹ŸæœºæŸ¥çœ‹è™šæ‹Ÿæœº <strong>IP</strong> åœ°å€ï¼‰å…¶å®æ­¤æ—¶æˆ‘ä»¬ å¯ä»¥é€šè¿‡å®¿ä¸»æœº ä½¿ç”¨æ­¤è™šæ‹Ÿæœº <strong>IPï¼š192.168.122.39</strong> è¿ä¸Šè™šæ‹Ÿæœº  å¹¶ä¸”ç”±äºæ­¤æ­¤è™šæ‹Ÿæœºç½‘ç»œæ˜¯ <strong>NAT</strong> æ¨¡å¼ æ˜¯å¯ä»¥å€ŸåŠ©å®¿ä¸»æœºå»è®¿é—® <strong>å¤–ç½‘</strong> çš„ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5387c7f9aad4ae74127c22f44a330630.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5387c7f9aad4ae74127c22f44a330630.png"></p><h2 id="ä¸‰-kvmå¸¸ç”¨å‘½ä»¤ä½¿ç”¨"><a href="#ä¸‰-kvmå¸¸ç”¨å‘½ä»¤ä½¿ç”¨" class="headerlink" title="ä¸‰. kvmå¸¸ç”¨å‘½ä»¤ä½¿ç”¨"></a>ä¸‰. kvmå¸¸ç”¨å‘½ä»¤ä½¿ç”¨</h2><blockquote><p><a href="https://zznn-cloud.github.io/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/?highlight=%E5%88%9B%E5%BB%BA">æ­¤å‰åˆ›å»ºwindowsç±»å‹è™šæ‹Ÿæœºè§é“¾æ¥</a></p><h3 id="ä¸€-virshå¸¸ç”¨å‘½ä»¤æ¦‚è§ˆ"><a href="#ä¸€-virshå¸¸ç”¨å‘½ä»¤æ¦‚è§ˆ" class="headerlink" title="ä¸€. virshå¸¸ç”¨å‘½ä»¤æ¦‚è§ˆ"></a>ä¸€. virshå¸¸ç”¨å‘½ä»¤æ¦‚è§ˆ</h3><p>ç»ƒä¹ å‘½ä»¤ä¹‹å‰å®‰è£… <code>yum install -y bash-*</code>ç”¨äºå‘½ä»¤è¡¥å…¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹åˆšé€šè¿‡é•œåƒå¯åŠ¨çš„è™šæ‹Ÿæœºè™šæ‹Ÿæœº / æŸ¥çœ‹--os-variantæ”¯æŒçš„ç±»å‹</span><br><span class="line">virsh list Â  Â  Â  Â  Â  Â  # åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœº</span><br><span class="line">osinfo-query os Â  Â  Â  Â # æŸ¥çœ‹æ”¯æŒçš„ç±»å‹</span><br><span class="line"># virt-installå¸¸ç”¨å‘½ä»¤</span><br><span class="line">virsh list --all Â  Â  Â  # åˆ—å‡ºæ‰€æœ‰è™šæœº</span><br><span class="line">virsh start  web01 Â  Â  # å¯åŠ¨æŒ‡å®šè™šæœº</span><br><span class="line">virsh reboot web01 Â  Â  # é‡å¯æŒ‡å®šè™šæœºï¼ˆå…³é—­çŠ¶æ€æ— æ³•é‡å¯ï¼‰</span><br><span class="line">virsh console name Â  Â  # è¿æ¥è™šæ‹Ÿæœº</span><br><span class="line">virsh destroy name Â  Â  # æ‹”æ‰ç”µæºï¼ˆå¾ˆå°‘ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">virsh undefine web01 Â  # åˆ é™¤è™šæœºæ–‡ä»¶å³åˆ é™¤è™šæ‹Ÿæœºï¼ˆä¸ä¼šåˆ é™¤ç£ç›˜æ–‡ä»¶ï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">virsh domblklist web01 Â  Â  Â  Â  Â  Â  # æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜ä¿¡æ¯</span><br><span class="line">virsh dominfo Â   web01 Â  Â  Â  Â  Â  Â  # æŸ¥çœ‹è™šæ‹Ÿæœºé…ç½®ä¿¡æ¯</span><br><span class="line">virsh domiflist  web01 Â  Â  Â  Â  Â  Â  # æŸ¥çœ‹è™šæ‹Ÿç½‘å¡ä¿¡æ¯</span><br><span class="line">virsh dumpxml Â   web01 Â  Â  Â  Â  Â  Â  # ä»¥ xmlæ ¼å¼æŸ¥çœ‹è™šæ‹Ÿæœº</span><br><span class="line">virsh define Â  Â  file-name Â  Â  Â  Â # å¯¼å…¥è™šæ‹Ÿæœº</span><br><span class="line">virsh edit Â  Â  Â  name Â  Â  Â  Â  Â  Â  # ç¼–è¾‘è™šæ‹Ÿæœºé…ç½®ï¼ˆä¸€èˆ¬æ˜¯åœ¨åˆšå®šä¹‰å®Œè™šæ‹Ÿæœºä¹‹åï¼‰è‡ªå¸¦è¯­æ³•æ£€æµ‹</span><br><span class="line">virsh domrename  old-name  new-name Â  # è™šæ‹Ÿæœºé‡å‘½å</span><br><span class="line">virsh vncdisplay web01 Â  Â  Â  Â  Â  Â  Â  Â # æŸ¥çœ‹vncç«¯å£</span><br><span class="line">virsh autostart  name Â  Â  Â  Â  Â  Â  Â  Â  # è™šæ‹Ÿæœºéšæœºé‡å¯</span><br><span class="line">virsh autostart --disable name Â  Â  Â  Â # å–æ¶ˆè™šæ‹Ÿæœºéšæœºé‡å¯</span><br><span class="line"></span><br><span class="line"># å›¾å½¢ç•Œé¢ï¼š</span><br><span class="line">é€šè¿‡æ‰§è¡Œåvirt-managerï¼Œå¯åŠ¨libvirtçš„å›¾å½¢ç•Œé¢ï¼Œåœ¨å›¾å½¢ç•Œé¢ä¸‹å¯ä»¥ä¸€æ­¥ä¸€æ­¥çš„åˆ›å»ºè™šæ‹Ÿæœºï¼Œç®¡ç†è™šæ‹Ÿæœºï¼Œè¿˜å¯ä»¥ç›´æ¥æ§åˆ¶è™šæ‹Ÿæœºçš„æ¡Œé¢ã€‚</span><br><span class="line"># å‘½ä»¤è¡Œï¼š</span><br><span class="line">virsh list Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ˜¾ç¤ºæœ¬åœ°æ´»åŠ¨è™šæ‹Ÿæœº</span><br><span class="line">virsh list â€“all Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # æ˜¾ç¤ºæœ¬åœ°æ‰€æœ‰çš„è™šæ‹Ÿæœºï¼ˆæ´»åŠ¨çš„+ä¸æ´»åŠ¨çš„ï¼‰</span><br><span class="line">virsh define ubuntu.xml Â  Â  Â  Â  Â  Â  Â  Â  # é€šè¿‡é…ç½®æ–‡ä»¶å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆè¿™ä¸ªè™šæ‹Ÿæœºè¿˜ä¸æ˜¯æ´»åŠ¨çš„ï¼‰</span><br><span class="line">virsh start ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # å¯åŠ¨åå­—ä¸ºubuntuçš„éæ´»åŠ¨è™šæ‹Ÿæœº</span><br><span class="line">virsh create ubuntu.xml Â  Â  Â  Â  Â  Â  Â  Â  # åˆ›å»ºè™šæ‹Ÿæœºï¼ˆåˆ›å»ºåï¼Œè™šæ‹Ÿæœºç«‹å³æ‰§è¡Œï¼Œæˆä¸ºæ´»åŠ¨ä¸»æœºï¼‰</span><br><span class="line">virsh suspend ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æš‚åœè™šæ‹Ÿæœº</span><br><span class="line">virsh resume ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # å¯åŠ¨æš‚åœçš„è™šæ‹Ÿæœº</span><br><span class="line">virsh shutdown web01 Â  Â  Â  Â  Â # æ­£å¸¸å…³é—­è™šæ‹Ÿæœº</span><br><span class="line">virsh destroy ubuntu Â  Â  Â  Â  Â # å¼ºåˆ¶æ‹”æ‰ç”µæºå…³é—­è™šæ‹Ÿæœºï¼ˆå¾ˆå°‘ä½¿ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">virsh domname 2 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  # æ˜¾ç¤ºidå·ä¸º2çš„è™šæ‹Ÿæœºå Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><br><span class="line">virsh domid ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ˜¾ç¤ºè™šæ‹Ÿæœºidå· Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span><br><span class="line">virsh domuuid ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„uuid Â  Â  Â  Â  Â  </span><br><span class="line">virsh domstate ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰çŠ¶æ€ Â  Â  Â  Â  Â </span><br><span class="line">virsh dumpxml ubuntu Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰é…ç½®æ–‡ä»¶ï¼ˆå¯èƒ½å’Œå®šä¹‰è™šæ‹Ÿæœºæ—¶çš„é…ç½®ä¸åŒï¼Œå› ä¸ºå½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œéœ€è¦ç»™# è™šæ‹Ÿæœºåˆ†é…idå·ã€uuidã€vncç«¯å£å·ç­‰ç­‰ï¼‰ Â  Â  Â  Â  Â </span><br><span class="line">virsh setmem ubuntu 512000 Â  Â  Â  Â  Â  Â  Â  # ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®å†…å­˜å¤§å° Â </span><br><span class="line">virsh setvcpus ubuntu 4 Â  Â  Â  Â  Â  Â  Â  Â  Â # ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®cpuä¸ªæ•° Â  Â  Â  Â  Â </span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="äºŒ-å¤‡ä»½æ¢å¤è™šæ‹Ÿæœº"><a href="#äºŒ-å¤‡ä»½æ¢å¤è™šæ‹Ÿæœº" class="headerlink" title="äºŒ. å¤‡ä»½æ¢å¤è™šæ‹Ÿæœº"></a>äºŒ. å¤‡ä»½æ¢å¤è™šæ‹Ÿæœº</h3><p><strong>å¤‡ä»½è™šæ‹Ÿæœº</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å‡ºè™šæ‹Ÿæœºé…ç½®æ–‡ä»¶</span></span><br><span class="line">virsh dumpxml web01 &gt; web01_bak.xml</span><br><span class="line"><span class="comment"># æ­¤æ—¶æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸‹æ¢å¤è™šæ‹Ÿæœºå…ˆåˆ é™¤è™šæ‹Ÿæœº</span></span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤è™šæ‹Ÿæœºï¼ˆå…ˆå…³æœºå†åˆ é™¤ï¼‰ æ­¤æ—¶ç£ç›˜æ–‡ä»¶ä»ç„¶æ˜¯è¢«ä¿ç•™çš„</strong></p><p><strong>å¤‡æ³¨</strong>ï¼šæ­¤æ­¥éª¤ä¸ºæ¨¡æ‹Ÿæ¢å¤è™šæ‹Ÿæœºæ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">virsh shutdown web01</span><br><span class="line">virsh undefine web01 </span><br><span class="line">virsh list --all</span><br></pre></td></tr></table></figure><p><strong>æ¢å¤è™šæ‹Ÿæœºï¼ˆä»¥åˆšæ‰çš„å¤‡ä»½æ–‡ä»¶å¯¼å…¥è™šæ‹Ÿæœºï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»å¤‡ä»½æ–‡ä»¶å¯¼å…¥è™šæ‹Ÿæœº</span></span><br><span class="line">virsh define web01_bak.xml</span><br><span class="line"><span class="comment"># æ­¤æ—¶å†çœ‹åˆšæ‰çš„è™šæ‹Ÿæœºåˆå›æ¥äº†</span></span><br><span class="line">virsh list --all</span><br><span class="line"></span><br><span class="line">Id Â   Name Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  State</span><br><span class="line">-----------------------------------------</span><br><span class="line"> - Â   web01 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   shut off</span><br></pre></td></tr></table></figure><p><strong>ä¸ºä»€ä¹ˆåˆå›æ¥äº†å‘¢ å› ä¸ºæˆ‘ä»¬ä½¿ç”¨virsh undefine  åˆ é™¤çš„æ˜¯ /etc/libvirt/qemu è·¯å¾„ä¸‹å¯¹åº”çš„è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_cbceb58948ef431e9a1f63b2c22da55b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_cbceb58948ef431e9a1f63b2c22da55b.png"></p><h3 id="ä¸‰-è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶è¿ç§»"><a href="#ä¸‰-è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶è¿ç§»" class="headerlink" title="ä¸‰. è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶è¿ç§»"></a>ä¸‰. è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶è¿ç§»</h3><p>å¤‡æ³¨ï¼šæˆ‘ä»¬åˆ›å»ºè™šæ‹Ÿæœºæ—¶ä¼š ç”Ÿæˆäº†ä¸€ä¸ªrawæ ¼å¼çš„ç£ç›˜æ–‡ä»¶ web01-vda.raw</p><p><strong>åˆ›å»ºkvmè·¯å¾„ï¼Œå°†è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶ç§»åŠ¨åˆ°è¯¥ç›®å½•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºkvmè·¯å¾„ï¼Œå°†è™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶ç§»åŠ¨åˆ°è¯¥ç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> /kvm &amp;&amp; <span class="built_in">mv</span> /opt/web01-vda.raw /kvm &amp;&amp; <span class="built_in">cd</span> /kvm &amp;&amp; <span class="built_in">ls</span></span><br></pre></td></tr></table></figure><p><strong>ç¼–è¾‘è™šæ‹Ÿæœºé…ç½®ï¼ˆè‡ªå¸¦è¯­æ³•æ£€æµ‹ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¤‡ä»½è™šæ‹Ÿæœºé…ç½®ï¼ˆç¼–è¾‘å‰å…ˆå¤‡ä»½ï¼‰</span></span><br><span class="line">virsh dumpxml web01 &gt; web01_bak.xml</span><br><span class="line"><span class="comment"># ç¼–è¾‘è™šæ‹Ÿæœºé…ç½®</span></span><br><span class="line">virsh edit web01</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿®æ”¹è·¯å¾„ /opt/web01-vda.raw &gt;&gt; /kvm/web01-vda.rawï¼ˆä¿®æ”¹å‰ï¼‰</span></span><br><span class="line">  &lt;devices&gt;</span><br><span class="line"> Â   &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;</span><br><span class="line"> Â   &lt;disk <span class="built_in">type</span>=<span class="string">&#x27;file&#x27;</span> device=<span class="string">&#x27;disk&#x27;</span>&gt;</span><br><span class="line"> Â  Â   &lt;driver name=<span class="string">&#x27;qemu&#x27;</span> <span class="built_in">type</span>=<span class="string">&#x27;raw&#x27;</span>/&gt;</span><br><span class="line"> Â  Â   &lt;<span class="built_in">source</span> file=<span class="string">&#x27;/opt/web01-vda.raw&#x27;</span>/&gt; Â  <span class="comment"># æ­¤è·¯å¾„</span></span><br><span class="line"> Â  Â   &lt;target dev=<span class="string">&#x27;vda&#x27;</span> bus=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line"> Â  Â   &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x06&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line"> Â   &lt;/disk&gt;</span><br><span class="line"> Â   &lt;disk <span class="built_in">type</span>=<span class="string">&#x27;file&#x27;</span> device=<span class="string">&#x27;cdrom&#x27;</span>&gt;</span><br><span class="line"> Â  Â   &lt;driver name=<span class="string">&#x27;qemu&#x27;</span> <span class="built_in">type</span>=<span class="string">&#x27;raw&#x27;</span>/&gt;</span><br><span class="line"></span><br><span class="line"> <span class="comment"># ä¿®æ”¹å</span></span><br><span class="line"> Â  &lt;devices&gt;</span><br><span class="line"> Â   &lt;emulator&gt;/usr/libexec/qemu-kvm&lt;/emulator&gt;</span><br><span class="line"> Â   &lt;disk <span class="built_in">type</span>=<span class="string">&#x27;file&#x27;</span> device=<span class="string">&#x27;disk&#x27;</span>&gt;</span><br><span class="line"> Â  Â   &lt;driver name=<span class="string">&#x27;qemu&#x27;</span> <span class="built_in">type</span>=<span class="string">&#x27;raw&#x27;</span>/&gt;</span><br><span class="line"> Â  Â   &lt;<span class="built_in">source</span> file=<span class="string">&#x27;/kvm/web01-vda.raw&#x27;</span>/&gt; Â  Â <span class="comment"># æ­¤è·¯å¾„</span></span><br><span class="line"> Â  Â   &lt;target dev=<span class="string">&#x27;vda&#x27;</span> bus=<span class="string">&#x27;virtio&#x27;</span>/&gt;</span><br><span class="line"> Â  Â   &lt;address <span class="built_in">type</span>=<span class="string">&#x27;pci&#x27;</span> domain=<span class="string">&#x27;0x0000&#x27;</span> bus=<span class="string">&#x27;0x00&#x27;</span> slot=<span class="string">&#x27;0x06&#x27;</span> <span class="keyword">function</span>=<span class="string">&#x27;0x0&#x27;</span>/&gt;</span><br><span class="line"> Â   &lt;/disk&gt;</span><br><span class="line"><span class="comment"># æ­¤æ—¶å¯åŠ¨è™šæ‹Ÿæœº</span></span><br><span class="line">virsh start web01</span><br><span class="line"></span><br><span class="line">[root@kvm kvm]<span class="comment"># virsh start web01</span></span><br><span class="line">Domain web01 started</span><br><span class="line"></span><br><span class="line">[root@kvm kvm]<span class="comment"># virsh list --all</span></span><br><span class="line"> Id Â   Name Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  State</span><br><span class="line">----------------------------------------------------</span><br><span class="line"> 5 Â  Â  web01 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   running</span><br></pre></td></tr></table></figure><h3 id="å››-è™šæ‹Ÿæœºé‡å‘½åï¼ˆåªèƒ½åœ¨å…³æœºçŠ¶æ€æ”¹åï¼‰"><a href="#å››-è™šæ‹Ÿæœºé‡å‘½åï¼ˆåªèƒ½åœ¨å…³æœºçŠ¶æ€æ”¹åï¼‰" class="headerlink" title="å››. è™šæ‹Ÿæœºé‡å‘½åï¼ˆåªèƒ½åœ¨å…³æœºçŠ¶æ€æ”¹åï¼‰"></a>å››. è™šæ‹Ÿæœºé‡å‘½åï¼ˆåªèƒ½åœ¨å…³æœºçŠ¶æ€æ”¹åï¼‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³æœº</span></span><br><span class="line">virsh shutdown web01</span><br><span class="line"><span class="comment"># æ”¹å</span></span><br><span class="line">virsh domrename web01 centos-web01</span><br></pre></td></tr></table></figure><h3 id="äº”-æŸ¥çœ‹è™šæ‹Ÿæœº-vnc-ç«¯å£ï¼ˆè™šæ‹Ÿæœºå¤ªå¤šä¹‹å-VNC-ç«¯å£å°±ä¼šä¸ä¸€æ ·ï¼‰åªæœ‰å¯åŠ¨çŠ¶æ€æ‰ä¼šæœ‰-VNC-ç«¯å£"><a href="#äº”-æŸ¥çœ‹è™šæ‹Ÿæœº-vnc-ç«¯å£ï¼ˆè™šæ‹Ÿæœºå¤ªå¤šä¹‹å-VNC-ç«¯å£å°±ä¼šä¸ä¸€æ ·ï¼‰åªæœ‰å¯åŠ¨çŠ¶æ€æ‰ä¼šæœ‰-VNC-ç«¯å£" class="headerlink" title="äº”. æŸ¥çœ‹è™šæ‹Ÿæœº vnc ç«¯å£ï¼ˆè™šæ‹Ÿæœºå¤ªå¤šä¹‹å VNC ç«¯å£å°±ä¼šä¸ä¸€æ ·ï¼‰åªæœ‰å¯åŠ¨çŠ¶æ€æ‰ä¼šæœ‰ VNC ç«¯å£"></a>äº”. æŸ¥çœ‹è™šæ‹Ÿæœº vnc ç«¯å£ï¼ˆè™šæ‹Ÿæœºå¤ªå¤šä¹‹å VNC ç«¯å£å°±ä¼šä¸ä¸€æ ·ï¼‰åªæœ‰å¯åŠ¨çŠ¶æ€æ‰ä¼šæœ‰ VNC ç«¯å£</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨</span></span><br><span class="line">virsh start web01</span><br><span class="line"><span class="comment"># æŸ¥çœ‹vncç«¯å£</span></span><br><span class="line">virsh vncdisplay web01</span><br><span class="line">// è¿”å›</span><br><span class="line">:0</span><br></pre></td></tr></table></figure><p>**å¤‡æ³¨ï¼šå•å°è™šæ‹Ÿæœºæ—¶è¿”å› å…¶å®æ­¤ **<strong>0</strong> ä»£è¡¨é»˜è®¤ç«¯å£ <strong>5900</strong> å¤šå°æ—¶ä¾¿ä¼šç½‘ä¸Šå¢åŠ  å¦‚ä¸¤å°æ—¶ æ˜¾ç¤º <strong>1</strong> å³ ä» <strong>5900</strong> å¾€ä¸ŠåŠ  <strong>1</strong> å³ <strong>5901</strong></p><h3 id="å…­-è™šæ‹Ÿæœºéšæœºè‡ªå¯ï¼ˆ-ä¸ºäº†å®¿ä¸»æœºé‡å¯åè™šæ‹Ÿæœºä¹Ÿä¼šé‡å¯-ï¼‰å¦åˆ™å®¿ä¸»æœºé‡å¯-è™šæ‹Ÿæœºä¸ä¼šè‡ªå¯åŠ¨"><a href="#å…­-è™šæ‹Ÿæœºéšæœºè‡ªå¯ï¼ˆ-ä¸ºäº†å®¿ä¸»æœºé‡å¯åè™šæ‹Ÿæœºä¹Ÿä¼šé‡å¯-ï¼‰å¦åˆ™å®¿ä¸»æœºé‡å¯-è™šæ‹Ÿæœºä¸ä¼šè‡ªå¯åŠ¨" class="headerlink" title="å…­.  è™šæ‹Ÿæœºéšæœºè‡ªå¯ï¼ˆ ä¸ºäº†å®¿ä¸»æœºé‡å¯åè™šæ‹Ÿæœºä¹Ÿä¼šé‡å¯ ï¼‰å¦åˆ™å®¿ä¸»æœºé‡å¯ è™šæ‹Ÿæœºä¸ä¼šè‡ªå¯åŠ¨"></a>å…­.  è™šæ‹Ÿæœºéšæœºè‡ªå¯ï¼ˆ ä¸ºäº†å®¿ä¸»æœºé‡å¯åè™šæ‹Ÿæœºä¹Ÿä¼šé‡å¯ ï¼‰å¦åˆ™å®¿ä¸»æœºé‡å¯ è™šæ‹Ÿæœºä¸ä¼šè‡ªå¯åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ä¸å®¿ä¸»æœºä¸€èµ·éšæœºè‡ªå¯</span></span><br><span class="line">virsh autostart web01</span><br><span class="line"><span class="comment"># æŸ¥çœ‹é‚£äº›è™šæ‹Ÿæœºè®¾ç½®äº†éšæœºè‡ªå¯ï¼ˆä¸€ä¸ªéƒ½æ²¡æœ‰è®¾ç½®çš„è¯æ­¤ç›®å½•ä¸ä¼šç”Ÿæˆä¸è™šæ‹Ÿæœºç›¸åŒåå­—çš„æ–‡ä»¶ï¼‰</span></span><br><span class="line"><span class="built_in">cd</span> /etc/libvirt/qemu/autostart &amp;&amp; <span class="built_in">ls</span></span><br><span class="line">web01.xml</span><br><span class="line"><span class="comment"># å–æ¶ˆéšæœºè‡ªå¯ï¼ˆæ­¤æ—¶æ­¤/etc/libvirt/qemu/autostartç›®å½•å¯¹åº”æ–‡ä»¶å·²æ¶ˆå¤±ï¼‰</span></span><br><span class="line">virsh autostart web01 --<span class="built_in">disable</span></span><br></pre></td></tr></table></figure><h3 id="ä¸ƒ-é€šè¿‡consoleç™»å½•kvm"><a href="#ä¸ƒ-é€šè¿‡consoleç™»å½•kvm" class="headerlink" title="ä¸ƒ. é€šè¿‡consoleç™»å½•kvm"></a>ä¸ƒ. é€šè¿‡<code>console</code>ç™»å½•<code>kvm</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é€šè¿‡consoleç™»å½•è™šæ‹Ÿæœºæ§åˆ¶å°</span></span><br><span class="line">virsh console web01</span><br><span class="line">// è¿”å›</span><br><span class="line">Connected to domain web01</span><br><span class="line">Escape character is ^] Â <span class="comment"># ctrl + ] é€€å‡ºï¼Œé»˜è®¤æ— æ³•ç™»å½•</span></span><br></pre></td></tr></table></figure><p><strong>è™šæ‹Ÿæœºé…ç½®å…è®¸<code>console</code>ç™»å½•</strong></p><p>è¿›å…¥ <strong>KVM</strong> è™šæ‹Ÿæœºä¿®æ”¹å†…æ ¸å‚æ•°å…è®¸ <strong>console</strong> ç™»å½•ï¼Œå…ˆé€šè¿‡ <strong>VNC</strong> æŸ¥çœ‹è™šæ‹Ÿæœº <strong>IP</strong> åœ°å€ï¼Œåœ¨é€šè¿‡å®¿ä¸»æœº <strong>ssh</strong> æ–¹å¼ç™»å½•åˆ° <strong>KVM</strong> å†…éƒ¨å¢åŠ è¯¥é…ç½®é¡¹: grubby-update-kernel=ALL-args=â€console=ttyS0,115200n8â€</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿›å…¥kvmè™šæ‹Ÿæœº</span></span><br><span class="line">ssh -p22 root@192.168.122.39</span><br><span class="line"><span class="comment"># ä¿®æ”¹å†…æ ¸å‚æ•°</span></span><br><span class="line">grubby --update-kernel=ALL --args=<span class="string">&quot;console=ttyS0,115200n8&quot;</span></span><br><span class="line"><span class="comment"># é‡å¯è™šæ‹Ÿæœºç”Ÿæ•ˆ</span></span><br><span class="line">reboot</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯ console ç™»å½•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># console ç™»å½•è™šæ‹Ÿæœº</span></span><br><span class="line">virsh console web01</span><br><span class="line">// è¿”å›</span><br><span class="line">Connected to domain web01</span><br><span class="line">Escape character is ^] Â  <span class="comment"># å›è½¦</span></span><br><span class="line"></span><br><span class="line">CentOS Linux 7 (Core)</span><br><span class="line">Kernel 3.10.0-1160.el7.x86_64 on an x86_64</span><br><span class="line"></span><br><span class="line">localhost login: Â  Â  Â  Â  <span class="comment"># æ­¤æ—¶å‡ºç°ç™»å½•é€‰é¡¹</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ee9df9423348cd4db4a62b05f970e4a5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ee9df9423348cd4db4a62b05f970e4a5.png"></p></blockquote><h2 id="å››-KVMç£ç›˜ç®¡ç†"><a href="#å››-KVMç£ç›˜ç®¡ç†" class="headerlink" title="å››. KVMç£ç›˜ç®¡ç†"></a>å››. <code>KVM</code>ç£ç›˜ç®¡ç†</h2><p><strong>kvmç£ç›˜æ ¼å¼ä»‹ç»</strong></p><p><strong>raw</strong>: è€ç‰Œæ ¼å¼ï¼Œç”¨ä¸€ä¸ªå­—æ¥è¯´å°±æ˜¯è£¸ï¼Œä¹Ÿå°±æ˜¯èµ¤è£¸è£¸ï¼ŒæŒ‡å®šå¤šå¤§ç©ºé—´å°±åˆ›å»ºå¤šå¤§ç©ºé—´ï¼Œç›´æ¥å ç”¨æŒ‡å®šå¤§å°çš„ç©ºé—´åˆ† <strong>50G</strong> å ç”¨ <strong>50G</strong> ï¼Œæ€§èƒ½ä¸Šæ¥è¯´çš„è¯è¿˜æ˜¯ä¸é”™çš„ï¼Œä¸æ”¯æŒå¿«ç…§åŠŸèƒ½ã€‚</p><p><strong><strong>cow</strong>: æ›¾ç» qemu çš„å†™æ—¶æ‹·è´çš„é•œåƒæ ¼å¼ï¼ˆç”¨æˆ·åœ¨ä¿®æ”¹æ•°æ®æ—¶ï¼Œç³»ç»Ÿä¼šæ‹·è´ä¸€ä»½æºæ–‡ä»¶å‰¯æœ¬åˆ°å†…å­˜ä¸­è®©å…¶ä¿®æ”¹ï¼Œç­‰åˆ°æ•°æ®çœŸæ­£è¢«ä¿®æ”¹æ—¶æ‰åˆ†é…ç©ºé—´ï¼‰ç›®å‰ç”±äºå†å²é—ç•™åŸå› ä¸æ”¯æŒçª—å£æ¨¡å¼ã€‚ä»æŸç§æ„ä¹‰ä¸Šæ¥è¯´æ˜¯ä¸ªå¼ƒå©´ï¼Œè¿˜æ²¡ç­‰å®ƒæˆç†Ÿå°±æ­»åœ¨è…¹ä¸­ï¼Œåæ¥è¢« qcow æ ¼å¼æ‰€å–ä»£ã€‚</strong> <strong><strong>qcow</strong>: ä¸€ä»£çš„ qemu çš„ cow æ ¼å¼ï¼Œåˆšåˆšå‡ºç°çš„æ—¶å€™æœ‰æ¯”è¾ƒå¥½çš„ç‰¹æ€§ï¼Œä½†å…¶æ€§èƒ½å’Œ raw æ ¼å¼å¯¹æ¯”è¿˜æ˜¯æœ‰å¾ˆå¤§çš„å·®è·ï¼Œç›®å‰å·²ç»è¢«æ–°ç‰ˆæœ¬çš„qcow2 å–ä»£ã€‚</strong></p><p><strong>qcow2</strong>: æ˜¯ openstack é»˜è®¤ä¹Ÿæ˜¯æ¯”è¾ƒæ¨èçš„æ ¼å¼ï¼Œæ–‡ä»¶æ¯”è¾ƒå°è€Œä¸”åšå¿«ç…§ä¹Ÿæ¯”è¾ƒå°ï¼Œç©ºé—´æ˜¯åŠ¨æ€å¢é•¿ï¼ˆç”¨å¤šå°‘å å¤šå°‘ ä½†ä¸ä¼šè¶…è¿‡å®šä¹‰çš„å®¹é‡ï¼‰ï¼Œæ˜¯ç›®å‰æ¯”è¾ƒä¸»æµçš„ä¸€ç§è™šæ‹ŸåŒ–é•œåƒæ ¼å¼ï¼Œç»è¿‡ä¸€ä»£çš„ä¼˜åŒ–ï¼Œç›®å‰ qcow2 çš„æ€§èƒ½ä¸Šæ¥è¿‘ raw è£¸æ ¼å¼çš„æ€§èƒ½ã€‚</p><p><strong>æˆ‘ä»¬åˆ›å»ºæ—¶å°±æ˜¯ä½¿ç”¨ raw æ ¼å¼åˆ›å»ºçš„</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_6aadb90398f3b87f7888616461239e9d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_6aadb90398f3b87f7888616461239e9d.png"></p><p><strong>æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜</span></span><br><span class="line">virsh domblklist web01</span><br><span class="line">// è¿”å›</span><br><span class="line">Target Â  Â  Source</span><br><span class="line">------------------------------------------------</span><br><span class="line">vda Â  Â  Â  Â  /kvm/web01-vda.raw</span><br><span class="line">hda Â  Â  Â  Â  -</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹ç£ç›˜è¯¦ç»†ä¿¡æ¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç£ç›˜è¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">qemu-img info /kvm/web01-vda.raw</span><br><span class="line">// è¿”å›</span><br><span class="line">image: /kvm/web01-vda.raw</span><br><span class="line">file format: raw</span><br><span class="line">virtual size: 10G (10737418240 bytes)</span><br><span class="line">disk size: 1.7G</span><br></pre></td></tr></table></figure><h3 id="1-åˆ›å»º-qcow2-æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº"><a href="#1-åˆ›å»º-qcow2-æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº" class="headerlink" title="1. åˆ›å»º qcow2 æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº"></a><code>1.</code> åˆ›å»º qcow2 æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º qcow2 æ ¼å¼ç£ç›˜çš„è™šæ‹Ÿæœº</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web02 \</span><br><span class="line">--memory 1024 \</span><br><span class="line">--vcpus 1 --disk /kvm/web02-vda.qcow2,format=qcow2,size=10 --cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso \</span><br><span class="line">--network network=default --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹ VNC ç«¯å£ å¯è§ç«¯å£æ˜¯ 5901</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm kvm]<span class="comment"># virsh vncdisplay web02</span></span><br><span class="line">:1</span><br></pre></td></tr></table></figure><p><strong>VNC è¿æ¥</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7185c32c48a56a379db496bfe893fee4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7185c32c48a56a379db496bfe893fee4.png"></p><h3 id="2-qcow2æ ¼å¼ç£ç›˜è™šæ‹Ÿæœºä½¿ç”¨"><a href="#2-qcow2æ ¼å¼ç£ç›˜è™šæ‹Ÿæœºä½¿ç”¨" class="headerlink" title="2. qcow2æ ¼å¼ç£ç›˜è™šæ‹Ÿæœºä½¿ç”¨"></a><code>2. qcow2</code>æ ¼å¼ç£ç›˜è™šæ‹Ÿæœºä½¿ç”¨</h3><p><strong>æŸ¥çœ‹ç£ç›˜æ ¼å¼</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹ç£ç›˜æ ¼å¼</span></span><br><span class="line">qemu-img info web02-vda.qcow2</span><br><span class="line">//è¿”å›</span><br><span class="line">image: web02-vda.qcow2</span><br><span class="line">file format: qcow2</span><br><span class="line">virtual size: 10G (10737418240 bytes)</span><br><span class="line">disk size: 1.5G Â  Â  Â  Â  <span class="comment"># ç”¨å¤šå°‘å å¤šå°‘</span></span><br><span class="line">cluster_size: 65536</span><br><span class="line">Format specific information:</span><br><span class="line"> Â   compat: 1.1</span><br><span class="line"> Â   lazy refcounts: <span class="literal">true</span></span><br></pre></td></tr></table></figure><p><strong>æ“ä½œ</strong>ï¼š</p><ul><li><strong>å¼€æœºè™šæ‹Ÿæœºå®¿ä¸»æœºé‡å¯è™šæ‹Ÿæœºè‡ªå¯åŠ¨</strong><code>virsh autostart web01</code></li><li><strong>ç™»å½•ï¼š</strong><code>ssh -p22 root@192.168.122.46</code></li><li><strong>è™šæ‹Ÿæœºé…ç½®å…è®¸ console ç™»å½•ï¼š</strong><code>grubby --update-kernel=ALL --args=&quot;console=ttyS0,115200n8&quot;</code></li><li><strong>ç”Ÿæ•ˆï¼ˆ</strong><code>virsh shutdown web02 &amp;&amp; virsh start web02</code>ï¼‰</li><li><strong>é€šè¿‡consoleç™»å½•ï¼š</strong><code>virsh console web02</code></li></ul><h2 id="äº”-kvmç£ç›˜è™šæ‹Ÿæœºå¿«ç…§ç®¡ç†"><a href="#äº”-kvmç£ç›˜è™šæ‹Ÿæœºå¿«ç…§ç®¡ç†" class="headerlink" title="äº”. kvmç£ç›˜è™šæ‹Ÿæœºå¿«ç…§ç®¡ç†"></a>äº”. <code>kvm</code>ç£ç›˜è™šæ‹Ÿæœºå¿«ç…§ç®¡ç†</h2><p><strong>raw ç£ç›˜æ ¼å¼è™šæ‹Ÿæœº****ä¸æ”¯æŒåšå¿«ç…§</strong>ï¼Œqcow2 <strong>æ”¯æŒå¿«ç…§</strong>ï¼Œå¹¶ä¸”å¿«ç…§å°±ä¿å­˜åœ¨ qcow2 çš„ç£ç›˜æ–‡ä»¶ä¸­ã€‚</p><h3 id="1-åˆ›å»ºå¿«ç…§"><a href="#1-åˆ›å»ºå¿«ç…§" class="headerlink" title="1.åˆ›å»ºå¿«ç…§"></a><code>1.</code>åˆ›å»ºå¿«ç…§</h3><p><strong>æ ¼å¼: virsh snapshot-create-as   â€“name  å¿«ç…§åç§°   è™šæ‹Ÿæœºåç§°</strong></p><blockquote><p><strong>è§£é‡Šï¼š</strong></p><p><strong>virsh snapshot-create-as åˆ›å»ºå¿«ç…§</strong> <strong>â€“name                   å¿«ç…§åç§°</strong> <strong>web02                    è™šæ‹Ÿæœºåç§°</strong></p></blockquote><p>ä¸º <strong>web02</strong> è™šæ‹Ÿæœºåˆ›å»ºå¿«ç…§ï¼ˆå¼€å…³æœºéƒ½å¯ä»¥åšå¿«ç…§ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸º web02 è™šæ‹Ÿæœºåˆ›å»ºå¿«ç…§</span></span><br><span class="line">virsh snapshot-create-as --name  kuaizhao_web2_env_ok  web2</span><br><span class="line">//è¿”å›</span><br><span class="line">Domain snapshot kuaizhao_web2_env_ok created</span><br><span class="line"><span class="comment"># åˆ›å»ºæˆåŠŸåæŸ¥çœ‹å¿«ç…§</span></span><br><span class="line">virsh snapshot-list web02</span><br><span class="line">//è¿”å›</span><br><span class="line"> Name Â  Â  Â  Â  Â  Â  Â  Â  Creation Time Â  Â  Â  Â  Â  Â  State</span><br><span class="line">------------------------------------------------------------</span><br><span class="line"> kuaizhao_web2_env_ok 2024-04-21 16:30:45 +0800 running</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯å¿«ç…§</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç™»å½•è™šæ‹Ÿæœº</span></span><br><span class="line">virsh console web02</span><br><span class="line"><span class="comment"># åˆ›å»ºå¿«ç…§æµ‹è¯•æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">touch</span> kuaizhao-test.txt</span><br></pre></td></tr></table></figure><h3 id="2-è¿˜åŸå¿«ç…§"><a href="#2-è¿˜åŸå¿«ç…§" class="headerlink" title="2. è¿˜åŸå¿«ç…§"></a><code>2.</code> è¿˜åŸå¿«ç…§</h3><p><strong>æ ¼å¼:  virsh snapshot-revert  è™šæ‹Ÿæœºåç§°  â€“snapshotname  å¿«ç…§åç§°</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰§è¡Œæ¢å¤å¿«ç…§</span></span><br><span class="line">virsh snapshot-revert web02 --snapshotname kuaizhao_web2_env_ok</span><br></pre></td></tr></table></figure><p><strong>å¤‡æ³¨ï¼šæŸ¥çœ‹åˆ›å»ºçš„æ–‡ä»¶è¿˜å­˜åœ¨ä¸ ï¼ˆä¸å­˜åœ¨ æ­¤æ—¶éªŒè¯æˆåŠŸï¼‰</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d7d30c0888f72a011b3c3eafe594c960.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d7d30c0888f72a011b3c3eafe594c960.png"></p><blockquote><p><strong>æç¤ºï¼šåˆ«åˆ é™¤è™šæ‹Ÿæœºï¼Œåˆ é™¤è™šæ‹Ÿæœºåæ²¡æœ‰è™šæ‹Ÿæœºé…ç½®æ–‡ä»¶æ— æ³•è¿˜åŸ</strong></p></blockquote><h3 id="3-åˆ é™¤å¿«ç…§"><a href="#3-åˆ é™¤å¿«ç…§" class="headerlink" title="3. åˆ é™¤å¿«ç…§"></a><code>3.</code> åˆ é™¤å¿«ç…§</h3><p><strong>æ ¼å¼:  virsh  snapshot-delete è™šæ‹Ÿæœºåç§°  â€“snapshotname  å¿«ç…§åç§°</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ é™¤å¿«ç…§</span></span><br><span class="line">virsh snapshot-delete web02 --snapshotname kuaizhao_web2_env_ok </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ˜¯å¦åˆ é™¤æˆåŠŸ</span></span><br><span class="line">virsh snapshot-list web02</span><br><span class="line">//è¿”å›</span><br><span class="line"> Name Â  Â  Â  Â  Â  Â  Â  Â  Creation Time Â  Â  Â  Â  Â  Â  State</span><br><span class="line">------------------------------------------------------------</span><br></pre></td></tr></table></figure><h2 id="å…­-kvmè™šæ‹Ÿæœºå…‹éš†"><a href="#å…­-kvmè™šæ‹Ÿæœºå…‹éš†" class="headerlink" title="å…­. kvmè™šæ‹Ÿæœºå…‹éš†"></a>å…­. <code>kvm</code>è™šæ‹Ÿæœºå…‹éš†</h2><p><strong>è™šæ‹Ÿæœºçš„å…‹éš†æ–¹å¼åˆ†ä¸ºå®Œæ•´å…‹éš†ä¸é“¾æ¥å…‹éš†ï¼Œä¸‹å›¾æ˜¯VMwareè™šæ‹Ÿæœºå¯¹å®Œæ•´å…‹éš†ä¸é“¾æ¥å…‹éš†çš„è§£é‡Š</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_197336118a437919c95a1c428c7843e3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_197336118a437919c95a1c428c7843e3.png"></p><h3 id="1-KVMå®Œæ•´å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰"><a href="#1-KVMå®Œæ•´å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰" class="headerlink" title="1. KVMå®Œæ•´å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰"></a><code>1.</code> KVMå®Œæ•´å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰</h3><p><strong>æ ¼å¼:  virt-clone â€“auto-c1one -o  è™šæ‹Ÿæœºåç§° -n  å…‹éš†åç§°</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">virt-clone --auto-clone -o  web01 -n  web01-clone</span><br><span class="line">virsh list --all</span><br></pre></td></tr></table></figure><p><strong>virt-clone è¿™ä¸ªå‘½ä»¤æ˜¯åŸºäºå…¨å…‹éš†çš„ï¼Œä¹Ÿå°±æ˜¯æ‹·è´è™šæ‹Ÿç£ç›˜æ–‡ä»¶å’Œè™šæ‹Ÿé…ç½®æ–‡ä»¶æ¥å®ç°çš„å®Œæ•´å…‹éš†ï¼Œé€Ÿåº¦æ…¢ï¼Œå ç”¨ç©ºé—´å¤šï¼Œå…‹éš†åç£ç›˜æ–‡ä»¶ä½äºè™šæ‹Ÿæœºç£ç›˜æ–‡ä»¶å­˜æ”¾å¤„ å…‹éš†åè™šæ‹Ÿæœºé…ç½®æ–‡ä»¶ä½äº /etc/libvirt/qemu ã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_fba87f13fbf52ded0499e19cf7ba2d85.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_fba87f13fbf52ded0499e19cf7ba2d85.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ff39c0b60324fd6b2061dee1d709a4fc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ff39c0b60324fd6b2061dee1d709a4fc.png"></p><p><strong>éªŒè¯å…‹éš†åçš„è™šæ‹Ÿæœº (æˆåŠŸ)</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨å…‹éš†åçš„è™šæ‹Ÿæœº </span></span><br><span class="line">virsh start web01-clone</span><br><span class="line"><span class="comment"># å…‹éš†åçš„è™šæ‹Ÿæœºå’Œè™šæ‹Ÿæœºæ˜¯ä¸€æ ·çš„æ‰€ä»¥å¯ä»¥é€šè¿‡consoleç™»å½•</span></span><br><span class="line">virsh console web01-clone</span><br></pre></td></tr></table></figure><p><strong>æ­¤æ—¶å¯ä»¥çœ‹åˆ°IPåœ°å€æ˜¯ä¸ä¸€æ ·çš„ å…‹éš†ä»¥åæˆ‘ä»¬ä¸éœ€è¦å»æ‰‹åŠ¨æ›´æ”¹åˆ«çš„ä¾‹å¦‚IPç­‰é…ç½®</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d5eebd88967b1ae72a00a4a5dc1dbf82.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d5eebd88967b1ae72a00a4a5dc1dbf82.png"></p><h3 id="1-KVMé“¾æ¥å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰"><a href="#1-KVMé“¾æ¥å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰" class="headerlink" title="1. KVMé“¾æ¥å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰"></a><code>1.</code> KVMé“¾æ¥å…‹éš†ï¼ˆè™šæ‹Ÿæœºå¿…é¡»ä¸ºå…³é—­çŠ¶æ€ï¼‰</h3><p>kvmå¹¶æ²¡æœ‰æä¾›é“¾æ¥å…‹éš†çš„å‘½ä»¤æˆ–å·¥å…·ï¼Œåªèƒ½æ‰‹åŠ¨å®ç°ï¼Œå®ç°æ–¹å¼æ˜¯é€šè¿‡åˆ›å»ºä¸€ä¸ªç£ç›˜é“¾æ¥æ–‡ä»¶æ¥å®ç°çš„é“¾æ¥å…‹éš†ã€‚<strong>æ ¼å¼:  qemu-img create -f qcow2 -b æºç£ç›˜æ–‡ä»¶  é“¾æ¥ç£ç›˜æ–‡ä»¶ ï¼ˆç£ç›˜æ ¼å¼éœ€è¦ä¿æŒä¸€è‡´ï¼‰</strong></p><ul><li><strong>-f æŒ‡å®šç£ç›˜æ–‡ä»¶æ ¼å¼</strong></li><li><strong>-b æŒ‡å®šåŸºäºæºç£ç›˜æ–‡ä»¶åˆ›å»ºä¸€ä¸ªé“¾æ¥ç£ç›˜æ–‡ä»¶</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºé“¾æ¥å…‹éš†ï¼ˆæ­¤æ—¶å…‰æœ‰ç£ç›˜æ–‡ä»¶æˆ‘ä»¬æ— æ³•åŸºäºè¿™ä¸ªç£ç›˜æ–‡ä»¶å»åˆ›å»ºè™šæ‹Ÿæœº è¿˜å¾—ä¿®æ”¹ç£ç›˜æ–‡ä»¶é…ç½®ï¼‰</span></span><br><span class="line">qemu-img create -f qcow2 -b /kvm/web02-vda.qcow2 /kvm/web02-1ink-clone-1.qcow2</span><br><span class="line"><span class="comment"># æŸ¥çœ‹é“¾æ¥ç£ç›˜æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line">qemu-img info /kvm/web02-1ink-clone-1.qcow2</span><br></pre></td></tr></table></figure><p>backing file: /kvm/web02-vda.qcow2 ï¼ˆæºç£ç›˜æ–‡ä»¶ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¼å‡ºåŸå§‹æœºçš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¿®æ”¹ç£ç›˜æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">virsh dumpxml web02 &gt; web02-link-clone-1.xml</span><br><span class="line"><span class="comment"># éœ€è¦ä¿®æ”¹çš„å†…å®¹å¦‚ä¸‹</span></span><br><span class="line">vim web02-link-clone-1.xml</span><br><span class="line">...</span><br><span class="line"><span class="comment"># ä¿®æ”¹è™šæ‹Ÿæœºåç§°(ä¿®æ”¹ä¸ºå…‹éš†åçš„æœºå™¨çš„åç§°)</span></span><br><span class="line">ç”± &lt;name&gt;web02&lt;/name&gt; æ”¹ &lt;name&gt;web02-link-clone&lt;/name&gt;</span><br><span class="line"><span class="comment"># åˆ é™¤uuidï¼ˆåˆ æ‰ä»¥åå¯åŠ¨æ˜¯ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ï¼‰</span></span><br><span class="line">&lt;uuid&gt;0fb934c1-5232-410f-b290-97604f22307e&lt;/uuid&gt;</span><br><span class="line"><span class="comment"># ä¿®æ”¹ç£ç›˜æ–‡ä»¶è·¯å¾„åŠåç§°</span></span><br><span class="line">ç”± &lt;<span class="built_in">source</span> file=<span class="string">&#x27;/kvm/web02-vda.qcow2&#x27;</span>/&gt; æ”¹ &lt;<span class="built_in">source</span> file=<span class="string">&#x27;/kvm/web02-1ink-clone-1.qcow2&#x27;</span>/&gt;</span><br><span class="line"><span class="comment"># åˆ é™¤macåœ°å€ï¼ˆåˆ æ‰ä»¥åå¯åŠ¨æ˜¯ä¼šè‡ªåŠ¨ç”Ÿæˆçš„ï¼‰</span></span><br><span class="line">&lt;mac address=<span class="string">&#x27;52:54:00:fb:cb:a4&#x27;</span>/&gt;</span><br><span class="line">...</span><br><span class="line">ä¿å­˜ï¼</span><br><span class="line"><span class="comment"># å¯¼å…¥è™šæ‹Ÿæœº</span></span><br><span class="line">virsh define web02-link-clone-1.xml</span><br><span class="line">virsh list</span><br><span class="line"><span class="comment"># å¼€å¯è™šæ‹Ÿæœº</span></span><br><span class="line">virsh start web02-link-clone</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_523d5dd801e9c7ce92e49bc0d6fb1264.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_523d5dd801e9c7ce92e49bc0d6fb1264.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_906abec6cee86807f80f23a43c6ad276.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_906abec6cee86807f80f23a43c6ad276.png"></p><h2 id="ä¸ƒ-KVMè™šæ‹Ÿæœºç½‘ç»œé…ç½®"><a href="#ä¸ƒ-KVMè™šæ‹Ÿæœºç½‘ç»œé…ç½®" class="headerlink" title="ä¸ƒ. KVMè™šæ‹Ÿæœºç½‘ç»œé…ç½®"></a>ä¸ƒ. KVMè™šæ‹Ÿæœºç½‘ç»œé…ç½®</h2><p><strong>kvmè™šæ‹Ÿæœºç½‘ç»œä»‹ç»</strong></p><p><strong>libvirt</strong> æœåŠ¡å®‰è£…åï¼Œé»˜è®¤ä¼šå®‰è£…ä¸€å— <strong>virbr0</strong> çš„è™šæ‹Ÿç½‘å¡ï¼Œlibvirt åœ¨åˆ›å»º KVM è™šæ‹Ÿæœºåï¼Œé»˜è®¤ä½¿ç”¨äº†ä¸€ä¸ªåä¸ºdefaultçš„natç½‘ç»œï¼Œåœ°å€æ®µä¸º 192.168.122.0/24ï¼Œè¿™ä¸ªç½‘ç»œé»˜è®¤ä½¿ç”¨virbr0(è™šæ‹Ÿäº¤æ¢æœº)ä½œä¸ºæ¡¥æ¥æ¥å£ï¼Œä¸ºè™šæ‹Ÿæœºæä¾›ç½‘ç»œè½¬å‘æœåŠ¡ï¼Œé»˜è®¤ç½‘æ®µ 192.168.122.0/24ï¼Œä½¿ç”¨dnsmasq æ¥ä¸ºä½¿ç”¨ nat ç½‘ç»œçš„è™šæ‹Ÿæœºæä¾› dns åŠ dhcp æœåŠ¡ã€‚</p><p><strong>virbr0ç½‘å¡ é»˜è®¤å ç”¨.1è¿™ä¸ªåœ°å€è™šæ‹Ÿæœºåœ°å€ä» .2 å¼€å§‹é…ç½®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">virbr0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line"> Â   <span class="built_in">link</span>/ether 52:54:00:28:9c:13 brd ff:ff:ff:ff:ff:ff</span><br><span class="line"> Â   inet 192.168.122.1/24 brd 192.168.122.255 scope global virbr0</span><br><span class="line"> Â  Â  Â  valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><p><strong>dhcpåˆ†é…åˆ°è™šæ‹Ÿæœºçš„ipåˆ—è¡¨åœ¨ä»¥ä¸‹æ–‡ä»¶æŸ¥çœ‹: /var/lib/libvirt/dnsmasq/default.conf ï¼ˆIPåœ°å€æ®µå¯ä»¥ä½¿ç”¨ï¼Œé»˜è®¤çš„ä¹Ÿå¯ä»¥è‡ªè¡Œä¿®æ”¹ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dhcpåˆ†é…åˆ°è™šæ‹Ÿæœºçš„ipåˆ—è¡¨</span></span><br><span class="line"><span class="built_in">cat</span>  /var/lib/libvirt/dnsmasq/default.conf</span><br><span class="line">...</span><br><span class="line"><span class="comment">##WARNING:  THIS IS AN AUTO-GENERATED FILE. CHANGES TO IT ARE LIKELY TO BE</span></span><br><span class="line"><span class="comment">##OVERWRITTEN AND LOST.  Changes to this configuration should be made using:</span></span><br><span class="line"><span class="comment">## Â   virsh net-edit default</span></span><br><span class="line"><span class="comment">## or other application using the libvirt API.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## dnsmasq conf file created by libvirt</span></span><br><span class="line">strict-order</span><br><span class="line">pid-file=/var/run/libvirt/network/default.pid</span><br><span class="line">except-interface=lo</span><br><span class="line">bind-dynamic</span><br><span class="line">interface=virbr0 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <span class="comment"># kvmè™šæ‹Ÿæœºä½¿ç”¨çš„ç½‘å¡</span></span><br><span class="line">dhcp-range=192.168.122.2,192.168.122.254 Â <span class="comment"># dhcpåˆ†é…çš„åœ°å€æ®µ</span></span><br><span class="line">dhcp-no-override</span><br><span class="line">dhcp-authoritative</span><br><span class="line">dhcp-lease-max=253</span><br><span class="line">dhcp-hostsfile=/var/lib/libvirt/dnsmasq/default.hostsfile</span><br><span class="line">addn-hosts=/var/lib/libvirt/dnsmasq/default.addnhosts</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="1-kvmè™šæ‹Ÿæœºnatç½‘ç»œé…ç½®"><a href="#1-kvmè™šæ‹Ÿæœºnatç½‘ç»œé…ç½®" class="headerlink" title="1.kvmè™šæ‹Ÿæœºnatç½‘ç»œé…ç½®"></a><code>1.</code>kvmè™šæ‹Ÿæœºnatç½‘ç»œé…ç½®</h3><p><strong>ä¿®æ”¹virbr0åœ°å€æ®µ</strong></p><p><strong>å¯ä»¥ä¿®æ”¹ç½‘æ®µï¼Œä¹Ÿå¯ä»¥ç”¨é»˜è®¤ç½‘æ®µï¼Œå¦‚éœ€ä¿®æ”¹é€šè¿‡å¦‚ä¸‹æ–¹å¼:</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹åœ°å€æ®µ (macåœ°å€ä¸æ›´æ”¹ ä¿®æ”¹å¦‚ä¸‹ä¸¤æ®µå³å¯)</span></span><br><span class="line">virsh net-edit default</span><br><span class="line">åŸ</span><br><span class="line">...</span><br><span class="line">  &lt;ip address=<span class="string">&#x27;192.168.122.1&#x27;</span> netmask=<span class="string">&#x27;255.255.255.0&#x27;</span>&gt;</span><br><span class="line"> Â   &lt;dhcp&gt;</span><br><span class="line"> Â  Â   &lt;range start=<span class="string">&#x27;192.168.122.2&#x27;</span> end=<span class="string">&#x27;192.168.122.254&#x27;</span>/&gt;</span><br><span class="line">...</span><br><span class="line">ä¿®æ”¹ä¸º10åœ°å€æ®µ</span><br><span class="line">...</span><br><span class="line">  &lt;ip address=<span class="string">&#x27;192.168.10.1&#x27;</span> netmask=<span class="string">&#x27;255.255.255.0&#x27;</span>&gt;</span><br><span class="line"> Â   &lt;dhcp&gt;</span><br><span class="line"> Â  Â   &lt;range start=<span class="string">&#x27;192.168.10.2&#x27;</span> end=<span class="string">&#x27;192.168.10.254&#x27;</span>/&gt;</span><br><span class="line">...</span><br><span class="line"><span class="comment"># ä¿å­˜</span></span><br></pre></td></tr></table></figure><p><strong>é‡æ–°å®šä¹‰ç½‘ç»œï¼Œdefaultç½‘ç»œçš„é…ç½®æ–‡ä»¶: /etc/libvirt/qemu/networks/default.xml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨æ­¤å‘½ä»¤é‡æ–°å®šä¹‰é…ç½®æ–‡ä»¶ (åˆ·æ–°)</span></span><br><span class="line">virsh net-define /etc/libvirt/qemu/networks/default.xml</span><br><span class="line">//è¿”å›</span><br><span class="line">Network default defined from /etc/libvirt/qemu/networks/default.xml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æ˜¯å¦ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">cat</span> /etc/libvirt/qemu/networks/default.xml</span><br><span class="line">...</span><br><span class="line">  &lt;ip address=<span class="string">&#x27;192.168.10.1&#x27;</span> netmask=<span class="string">&#x27;255.255.255.0&#x27;</span>&gt;</span><br><span class="line"> Â   &lt;dhcp&gt;</span><br><span class="line"> Â  Â   &lt;range start=<span class="string">&#x27;192.168.10.2&#x27;</span> end=<span class="string">&#x27;192.168.10.254&#x27;</span>/&gt;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>åˆ é™¤ç½‘ç»œï¼ˆå…³é—­è¿è¡Œçš„è™šæ‹Ÿæœºï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢ç½‘å¡ï¼ˆå…³é—­è¿è¡Œçš„è™šæ‹Ÿæœºï¼‰</span></span><br><span class="line">virsh net-destroy default</span><br><span class="line"><span class="comment"># å…³é—­æ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºï¼ˆå¯ä¸å…³ï¼‰</span></span><br><span class="line">virsh shutdown web02</span><br></pre></td></tr></table></figure><p><strong>å¯åŠ¨ç½‘å¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ç½‘å¡</span></span><br><span class="line">virsh net-start default</span><br></pre></td></tr></table></figure><p><strong>é‡å¯libvirtd</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é‡å¯libvirtd</span></span><br><span class="line">systemctl restart libvirtd</span><br></pre></td></tr></table></figure><p><strong>éªŒè¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®¿ä¸»æœºæ‰§è¡Œ</span></span><br><span class="line">ip a s</span><br><span class="line"><span class="comment"># éªŒè¯è™šæ‹Ÿæœºç½‘ç»œ æ­¤æ—¶è™šæ‹Ÿæœºç½‘ç»œå·²å˜æˆäº†10æ®µ</span></span><br><span class="line">virsh console web01</span><br><span class="line"><span class="comment"># è·å–IP</span></span><br><span class="line">dhclient</span><br><span class="line">// è¿”å›</span><br><span class="line">2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line"> Â   <span class="built_in">link</span>/ether 52:54:00:00:75:bf brd ff:ff:ff:ff:ff:ff</span><br><span class="line"> Â   inet 192.168.10.39/24 brd 192.168.10.255 scope global dynamic eth0</span><br><span class="line"> Â  Â  Â  valid_lft 3599sec preferred_lft 3599sec</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_257b8884805c43a286817995dfdf648e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_257b8884805c43a286817995dfdf648e.png"></p><p>ä»ç°åœ¨å¼€å§‹ä½¿ç”¨çš„ <strong>default</strong> ç½‘ç»œå°±æ˜¯ <strong>10</strong> æ®µäº†</p><h3 id="2-kvm-è™šæ‹Ÿæœºé…ç½®å›ºå®š-IP"><a href="#2-kvm-è™šæ‹Ÿæœºé…ç½®å›ºå®š-IP" class="headerlink" title="2.kvm è™šæ‹Ÿæœºé…ç½®å›ºå®š IP"></a><code>2.</code>kvm è™šæ‹Ÿæœºé…ç½®å›ºå®š IP</h3><p><strong>å¯åŠ¨ä¸€ä¸ªKVMå¹¶ç™»å½•å¹¶é…ç½®å›ºå®šIPåœ°å€</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">virsh start web02</span><br><span class="line">virsh console web02</span><br><span class="line">ip a s</span><br></pre></td></tr></table></figure><p><strong>kvm é…ç½®å›ºå®š IP åœ°å€ï¼ˆä¸ä¼ ç»Ÿç‰©ç†æœºä¸€æ ·ä¿®æ”¹ç½‘å¡é…ç½®æ–‡ä»¶å°±å¯ä»¥äº†ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=none Â  Â <span class="comment"># å°†é»˜è®¤çš„dhcpä¿®æ”¹ä¸ºnone</span></span><br><span class="line">DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=<span class="built_in">yes</span></span><br><span class="line">IPV6_AUTOCONF=<span class="built_in">yes</span></span><br><span class="line">IPV6_DEFROUTE=<span class="built_in">yes</span></span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=eth0</span><br><span class="line">UUID=0d71e612-7fca-4663-914e-9c9f356d0d82</span><br><span class="line">DEVICE=eth0</span><br><span class="line">ONBOOT=<span class="built_in">yes</span> Â  Â  Â  <span class="comment"># ä¿®æ”¹ä¸ºyes</span></span><br><span class="line"><span class="comment"># æ–°å¢</span></span><br><span class="line">IPADDR=<span class="string">&quot;192.168.10.10&quot;</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span><br><span class="line">GATEWAY=<span class="string">&quot;192.168.10.1&quot;</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â </span><br><span class="line">NETMASK=<span class="string">&quot;255.255.255.0&quot;</span> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span><br><span class="line">DNS1=<span class="string">&quot;223.5.5.5&quot;</span></span><br></pre></td></tr></table></figure><p>ä¿®æ”¹åé‡å¯ç½‘å¡ç”Ÿæ•ˆï¼š<strong>systemctl restart network</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_8ff6fe32b5abd9443531f7335d7b120f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_8ff6fe32b5abd9443531f7335d7b120f.png"></p><p>**æç¤º:  **<strong>KVM</strong> è™šæ‹Ÿæœºè®¿é—®å¤–éƒ¨ç½‘ç»œè®°ä½ <a href="https://wn-apple-teawine.fun/2023/06/02/%E9%85%8D%E7%BD%AEsnat%E4%BD%BF%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AEinternet%E7%9A%84%E5%86%85%E7%BD%91%E6%9C%BA%E5%99%A8%E9%80%9A%E8%BF%87%E5%85%B6%E4%BB%96%E6%9C%BA%E5%99%A8%E5%87%BA%E5%A4%96%E7%BD%91/?highlight=snat">iptables SNAT</a> æ¨¡å¼è¿›è¡Œäº†æºåœ°å€è½¬æ¢ï¼Œå¦‚æœå¤–éƒ¨ç½‘ç»œéœ€è¦è®¿é—®åˆ° <strong>KVM</strong> è™šæ‹Ÿæœºä¸­ï¼Œéœ€è¦åœ¨å®¿ä¸»æœºé€šè¿‡ <strong>iptables</strong> æ·»åŠ ç«¯å£æ˜ å°„æ¥å®ç°ï¼Œå¦‚æœä¸å¸Œæœ›é€šè¿‡ç«¯å£æ˜ å°„æ¥å®ç°ï¼Œå¯ä»¥ä½¿ç”¨ <strong>KVMçš„æ¡¥æ¥ç½‘ç»œ</strong> æ›´åŠ æ–¹ä¾¿ã€‚</p><h2 id="ä¹-kvm-åˆ›å»ºæ¡¥æ¥ç½‘ç»œ"><a href="#ä¹-kvm-åˆ›å»ºæ¡¥æ¥ç½‘ç»œ" class="headerlink" title="ä¹. kvm åˆ›å»ºæ¡¥æ¥ç½‘ç»œ"></a>ä¹. kvm åˆ›å»ºæ¡¥æ¥ç½‘ç»œ</h2><p><strong>åœ¨KVMè™šæ‹Ÿæœºä¸­ï¼ŒBridge(æ¡¥æ¥)æ¨¡å¼å¯ä»¥è®© KVM è™šæ‹Ÿæœºå’Œå®¿ä¸»æœºå…±äº«ä¸€ä¸ªç‰©ç†ç½‘ç»œè®¾å¤‡æ¥è¿æ¥ç½‘ç»œï¼Œè¿™æ · KVM è™šæ‹Ÿæœºå¯ä»¥è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œè€Œå¤–éƒ¨ç½‘ç»œä¹Ÿå¯ä»¥ç›´æ¥è®¿é—® KVM è™šæ‹Ÿæœºï¼ŒBridgeæ¡¥æ¥æ¨¡å¼ä½¿ç”¨éå¸¸æ–¹ä¾¿ï¼Œåº”ç”¨ä¹Ÿéå¸¸å¹¿æ³›ã€‚</strong></p><p><strong>åˆ›å»ºæ¡¥æ¥ç½‘å¡ï¼ˆæ‰§è¡Œåˆ›å»ºåéœ€è¦é‡å¯ç³»ç»Ÿæ‰èƒ½çœ‹åˆ°ï¼‰</strong> å°†å®¿ä¸»æœºå·¥ä½œçš„ç½‘å¡ç»‘å®šåˆ° br0 æ¡¥æ¥ç½‘å¡ä¸Š (br0ç°åœ¨ä¸å­˜åœ¨)</p><ul><li><strong>æ ¼å¼: virsh iface-bridge ens32 br0</strong></li><li><strong>ens33 ä¸ºå®¿ä¸»æœºç½‘å¡</strong></li><li><strong>br0 ä¸ºæ¡¥æ¥ç½‘å¡</strong></li></ul><h3 id="1-åˆ›å»ºæ¡¥æ¥ç½‘å¡"><a href="#1-åˆ›å»ºæ¡¥æ¥ç½‘å¡" class="headerlink" title="1.åˆ›å»ºæ¡¥æ¥ç½‘å¡"></a><code>1.</code>åˆ›å»ºæ¡¥æ¥ç½‘å¡</h3><blockquote><p><a href="http://sunlight.zznnwn.cloudns.biz/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/?highlight=%E9%95%9C%E5%83%8F">å®ç°å½¢å¼å…¶å®åœ¨åšä¸»å¦ä¸€ç¯‡æ–‡ç« ä¸­å·²æœ‰æåŠ | &gt; é“¾æ¥</a></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†å®¿ä¸»æœºå·¥ä½œçš„ç½‘å¡ç»‘å®šåˆ° br0 æ¡¥æ¥ç½‘å¡</span></span><br><span class="line">virsh iface-bridge ens33 br0</span><br><span class="line">//è¿”å›</span><br><span class="line">ä½¿ç”¨é™„åŠ è®¾å¤‡ br0 ç”Ÿæˆæ¡¥æ¥ ens32 å¤±è´¥</span><br><span class="line"><span class="comment"># é‡å¯ç³»ç»Ÿåç™»å½•æŸ¥çœ‹ç½‘å¡</span></span><br><span class="line">ip a s </span><br><span class="line">...</span><br><span class="line">ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master br0 state UP group default qlen 1000</span><br><span class="line"> Â   <span class="built_in">link</span>/ether 00:0c:29:23:67:1e brd ff:ff:ff:ff:ff:ff</span><br><span class="line">3: br0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line"> Â   <span class="built_in">link</span>/ether 00:0c:29:23:67:1e brd ff:ff:ff:ff:ff:ff</span><br><span class="line"> Â   inet 10.0.0.10/8 brd 10.255.255.255 scope global br0</span><br><span class="line">...</span><br><span class="line"><span class="comment"># æ­¤æ—¶pingä¸é€šç™¾åº¦</span></span><br><span class="line">ping www.baidu.com</span><br><span class="line"><span class="comment"># è§£å†³ç½‘å¡æ·»åŠ DNSå³å¯</span></span><br><span class="line">vim /etc/sysconfig/network-scripts/ifcfg-br0</span><br><span class="line">...</span><br><span class="line">DEVICE=<span class="string">&quot;br0&quot;</span></span><br><span class="line">ONBOOT=<span class="string">&quot;yes&quot;</span></span><br><span class="line">TYPE=<span class="string">&quot;Bridge&quot;</span></span><br><span class="line">BOOTPROTO=<span class="string">&quot;none&quot;</span></span><br><span class="line">IPADDR=<span class="string">&quot;10.0.0.10&quot;</span></span><br><span class="line">GATEWAY=<span class="string">&quot;10.0.0.220&quot;</span></span><br><span class="line">IPV6INIT=<span class="string">&quot;yes&quot;</span></span><br><span class="line">IPV6_AUTOCONF=<span class="string">&quot;yes&quot;</span></span><br><span class="line">DHCPV6C=<span class="string">&quot;no&quot;</span></span><br><span class="line">STP=<span class="string">&quot;on&quot;</span></span><br><span class="line">DELAY=<span class="string">&quot;0&quot;</span></span><br><span class="line">DNS1=<span class="string">&quot;223.5.5.5&quot;</span> Â <span class="comment"># æ·»åŠ æ­¤</span></span><br><span class="line">....</span><br><span class="line"><span class="comment"># ç”Ÿæ•ˆ</span></span><br><span class="line">systemctl restart network</span><br></pre></td></tr></table></figure><p><strong>å¤‡æ³¨ï¼šæ­¤æ—¶å®¿ä¸»æœº ens33 ç½‘å¡æ²¡æœ‰è‡ªå·±çš„ IP åœ°å€ï¼Œç½‘å¡å¯„ç”Ÿåœ¨å®ƒèº«ä¸Šï¼Œç½‘æ¡¥ä¸ç‰©ç†ç½‘å£ MAC åœ°å€ç›¸åŒ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_9376b88c60933a7b09a87ec71a768aff.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_9376b88c60933a7b09a87ec71a768aff.png"></p><h2 id="å-åˆ›å»º-kvm-è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘ç»œ"><a href="#å-åˆ›å»º-kvm-è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘ç»œ" class="headerlink" title="å. åˆ›å»º kvm è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘ç»œ"></a>å. åˆ›å»º <code>kvm</code> è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘ç»œ</h2><p><strong>åˆ›å»º kvm è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘å¡ï¼ˆå®‰è£…å®Œæˆç³»ç»Ÿï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»º kvm è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥ç½‘å¡</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web03 \</span><br><span class="line">--memory 1024 \</span><br><span class="line">--vcpus 1 --disk /kvm/web03-vda.qcow2,format=qcow2,size=10 --cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso \</span><br><span class="line">--network bridge=br0 --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br><span class="line"><span class="comment"># æŸ¥çœ‹åˆ—è¡¨</span></span><br><span class="line">virsh list</span><br><span class="line"><span class="comment"># æŸ¥çœ‹vncç«¯å£ï¼ˆ5902ï¼‰</span></span><br><span class="line">virsh vncdisplay web03</span><br><span class="line">:2</span><br></pre></td></tr></table></figure><p><strong>é…ç½®é™æ€åœ°å€ åœ°å€ä¸ºä¸å®¿ä¸»æœºåŒä¸€ä¸ªç½‘æ®µ ä¸”æ²¡æœ‰è¢«å ç”¨çš„ç½‘æ®µ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_288e666dc41e472b5b532cc4fd38d635.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_288e666dc41e472b5b532cc4fd38d635.png"></p><p><strong>éªŒè¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç­‰å¾…ç›¸å½“ä¸€æ®µæ—¶é—´</span></span><br><span class="line">virsh start web03</span><br><span class="line"><span class="comment"># æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">virsh list</span><br><span class="line"><span class="comment"># è¿œç¨‹è¿æ¥æµ‹è¯•ï¼ˆå¯è¿é€šå¤–ç½‘æ­£å¸¸pingé€šç™¾åº¦ï¼‰</span></span><br><span class="line">ssh -p22 root@10.0.0.185</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ccce45df3c03202f8b55bc31adb1b817.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ccce45df3c03202f8b55bc31adb1b817.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_52de4dfd8d24e6c18177342d745e60f6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_52de4dfd8d24e6c18177342d745e60f6.png"></p><h2 id="åä¸€-ä¿®æ”¹kvmè™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼"><a href="#åä¸€-ä¿®æ”¹kvmè™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼" class="headerlink" title="åä¸€. ä¿®æ”¹kvmè™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼"></a>åä¸€. ä¿®æ”¹<code>kvm</code>è™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹çŠ¶æ€</span></span><br><span class="line">virsh list</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹è™šæ‹Ÿæœºç½‘å¡ä¿¡æ¯</strong> <strong>æ ¼å¼: virsh  domiflist è™šæ‹Ÿæœºåç§°</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹è™šæ‹Ÿæœºweb03ç½‘å¡</span></span><br><span class="line">virsh domiflist web03</span><br><span class="line">//è¿”å›</span><br><span class="line">Interface  Type Â  Â  Â  Source Â  Â  Model Â  Â  Â  MAC</span><br><span class="line">-------------------------------------------------------</span><br><span class="line">vnet0 Â  Â   bridge Â  Â  br0 Â  Â  Â   virtio Â  Â  Â 52:54:00:68:3e:8d</span><br></pre></td></tr></table></figure><p><strong>å…³æœºçŠ¶æ€ä¸‹</strong> ä¿®æ”¹ç½‘ç»œæ¨¡å¼ä¸º <strong>bridge</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¿®æ”¹è™šæ‹Ÿæœºé…ç½®</span></span><br><span class="line">virsh edit web02</span><br><span class="line"></span><br><span class="line">åŸ &lt;interface <span class="built_in">type</span>=<span class="string">&#x27;network&#x27;</span>&gt;  æ”¹ &lt;interface <span class="built_in">type</span>=<span class="string">&#x27;bridge&#x27;</span>&gt; Â <span class="comment"># ä¿®æ”¹ç±»å‹</span></span><br><span class="line">åŸ &lt;<span class="built_in">source</span> network=<span class="string">&#x27;default&#x27;</span>/&gt; æ”¹ &lt;<span class="built_in">source</span> bridge=<span class="string">&#x27;br0&#x27;</span>/&gt; Â  Â  <span class="comment"># ç½‘å¡åç§°</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯åŠ¨è™šæ‹ŸæœºéªŒè¯</span></span><br><span class="line">virsh start web02</span><br><span class="line"><span class="comment"># é€šè¿‡vnc/consoleç™»å½•é…ç½®é™æ€IP</span></span><br><span class="line">virsh vncdisplay web02 æˆ– virsh console web02</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4f21ccb77b8d5dd6719b7488e808320c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4f21ccb77b8d5dd6719b7488e808320c.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0e88cdc4e62769bb5458975545f4269e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0e88cdc4e62769bb5458975545f4269e.png"></p><p>é…ç½®å®Œæˆå <strong>ssh</strong> è¿œç¨‹è¿æ¥æµ‹è¯• &gt;&gt; æˆåŠŸã€‚</p><h2 id="åäºŒ-kvmç½‘ç»œåŸç†"><a href="#åäºŒ-kvmç½‘ç»œåŸç†" class="headerlink" title="åäºŒ. kvmç½‘ç»œåŸç†"></a>åäºŒ. <code>kvm</code>ç½‘ç»œåŸç†</h2><p>æ¯å° <strong>KVM</strong> å¯åŠ¨åï¼Œéƒ½ä¼šåœ¨ <strong>å®¿ä¸»æœº</strong> åˆ›å»ºä¸€ä¸ªä»¥ <strong>vnet</strong> å¼€å¤´çš„ç½‘å¡(ä» <strong>vnet0</strong> å¼€å§‹)ï¼Œç”¨äºæ‰“é€š <strong>è™šæ‹Ÿæœº</strong> ä¸ <strong>å®¿ä¸»æœº</strong> ä¹‹é—´çš„ç½‘ç»œã€‚</p><h3 id="0-ç½‘ç»œæ¨¡å¼æ‹–å¸ƒå›¾"><a href="#0-ç½‘ç»œæ¨¡å¼æ‹–å¸ƒå›¾" class="headerlink" title="0.ç½‘ç»œæ¨¡å¼æ‹–å¸ƒå›¾"></a><code>0.</code>ç½‘ç»œæ¨¡å¼æ‹–å¸ƒå›¾</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_502c79bc51c37605ad93625e7c73b987.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_502c79bc51c37605ad93625e7c73b987.png"></p><h3 id="1-å®¿ä¸»æœºç½‘å¡é…ç½®"><a href="#1-å®¿ä¸»æœºç½‘å¡é…ç½®" class="headerlink" title="1.å®¿ä¸»æœºç½‘å¡é…ç½®"></a><code>1.</code>å®¿ä¸»æœºç½‘å¡é…ç½®</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7e62f395165b9a771a1f429a170a2cc0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_7e62f395165b9a771a1f429a170a2cc0.png"></p><p>é€šè¿‡ <strong>brctl show</strong> å¯ä»¥çœ‹åˆ° <strong>vnet</strong> ç½‘å¡ä½¿ç”¨çš„å®¿ä¸»æœºç½‘å¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@kvm ~]# brctl show</span><br><span class="line">bridge name Â  Â  bridge id Â  Â  Â  Â  Â  Â  Â  STP enabled Â  Â  interfaces</span><br><span class="line">br0 Â  Â  Â  Â  Â  Â  8000.000c2923671e Â  Â  Â  yes Â  Â  Â  Â  Â  Â  ens33</span><br><span class="line"> Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â   vnet0</span><br><span class="line">virbr0 Â  Â  Â  Â  Â 8000.525400289c13 Â  Â  Â  yes Â  Â  Â  Â  Â  Â  virbr0-nic</span><br></pre></td></tr></table></figure><h2 id="åä¸‰-kvmè™šæ‹Ÿæœºç¡¬ä»¶çƒ­æ·»åŠ æŠ€æœ¯"><a href="#åä¸‰-kvmè™šæ‹Ÿæœºç¡¬ä»¶çƒ­æ·»åŠ æŠ€æœ¯" class="headerlink" title="åä¸‰.  kvmè™šæ‹Ÿæœºç¡¬ä»¶çƒ­æ·»åŠ æŠ€æœ¯"></a>åä¸‰.  kvmè™šæ‹Ÿæœºç¡¬ä»¶çƒ­æ·»åŠ æŠ€æœ¯</h2><h3 id="1-çƒ­æ·»åŠ ç£ç›˜"><a href="#1-çƒ­æ·»åŠ ç£ç›˜" class="headerlink" title="1.çƒ­æ·»åŠ ç£ç›˜"></a><code>1.</code>çƒ­æ·»åŠ ç£ç›˜</h3><p><strong>æ¡ˆä¾‹: ä¸º web03 è™šæ‹Ÿæœºæ·»åŠ ä¸€å—æ–° qcow2 ç¡¬ç›˜ï¼Œå¹¶å¯¹ç¡¬ç›˜ç©ºé—´è¿›è¡Œæ‰©å®¹ (KVMè™šæ‹Ÿæœºé»˜è®¤ç£ç›˜åç§°: vdaã€vdbã€vdcä¾æ¬¡ç±»æ¨ï¼Œå¯è¿›å…¥KVMå†…éƒ¨æŸ¥çœ‹)</strong></p><p><strong>æ·»åŠ ä¹‹å‰ (åªæœ‰ä¸€å—10Gçš„ç¡¬ç›˜)</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@web03 ~]# lsblk</span><br><span class="line">NAME Â  Â  Â  Â  Â  Â  Â  Â   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sr0 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 11:0 Â  Â 1 1024M Â 0 rom Â </span><br><span class="line">vda Â  Â  Â  Â  Â  Â  Â  Â  Â  252:0 Â  Â 0 Â  10G Â 0 disk </span><br><span class="line">â”œâ”€vda1 Â  Â  Â  Â  Â  Â  Â  Â 252:1 Â  Â 0 Â   1G Â 0 part /boot</span><br><span class="line">â””â”€vda2 Â  Â  Â  Â  Â  Â  Â  Â 252:2 Â  Â 0 Â   9G Â 0 part </span><br><span class="line">  â”œâ”€centos_web03-root 253:0 Â  Â 0 Â   8G Â 0 lvm  /</span><br><span class="line">  â””â”€centos_web03-swap 253:1 Â  Â 0 Â   1G Â 0 lvm  [SWAP]</span><br></pre></td></tr></table></figure><p><strong>åœ¨ kvm ç›®å½•åˆ›å»ºä¸€å— qcow2 æ ¼å¼çš„è™šæ‹Ÿç¡¬ç›˜ï¼Œå®¹é‡ä¸º 10G</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºä¸€å—qcow2æ ¼å¼çš„è™šæ‹Ÿç¡¬ç›˜ï¼Œå®¹é‡ä¸º10G</span></span><br><span class="line">cd /kvm</span><br><span class="line">qemu-img create -f qcow2 /kvm/web03-vdb.qcow2 10G</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ç£ç›˜è¯¦æƒ…</span></span><br><span class="line">qemu-img info /kvm/web03-vdb.qcow2</span><br><span class="line">//è¿”å›</span><br><span class="line">image: /kvm/web03-vdb.qcow2</span><br><span class="line">file format: qcow2</span><br><span class="line">virtual size: 10G (10737418240 bytes)</span><br></pre></td></tr></table></figure><p><strong>æ°¸ä¹…æ·»åŠ ç£ç›˜</strong></p><ul><li><strong>â€“live            åœ¨çº¿æ·»åŠ </strong></li><li><strong>â€“config        æ°¸ä¹…ä¿å­˜é…ç½® ï¼ˆä¸åŠ ä¸´æ—¶ç”Ÿæ•ˆ è™šæ‹Ÿæœºä¸€é‡å¯å°±æ²¡äº†ï¼‰</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ°¸ä¹…æ·»åŠ ç£ç›˜ï¼ˆç»™web03 æ·»åŠ 10Gç£ç›˜ æŒ‡å®šæ·»åŠ åè™šæ‹Ÿæœºç£ç›˜åç§°ä¸º vdb æ ¼å¼ä¸º qcow2 æ ¼å¼ï¼‰</span></span><br><span class="line">virsh attach-disk web03 /kvm/web03-vdb.qcow2 vdb --subdriver qcow2 --live --config</span><br><span class="line">//è¿”å›</span><br><span class="line">Disk attached successfully</span><br></pre></td></tr></table></figure><p><strong>web03è™šæ‹ŸæœºéªŒè¯</strong>ï¼ˆæˆåŠŸæ·»åŠ ä¸€å—10G vdbç£ç›˜ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç™»å½•è™šæ‹Ÿæœº</span></span><br><span class="line">virsh console web03</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ç£ç›˜è¯¦æƒ…</span></span><br><span class="line">lsblk</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ ¼å¼åŒ–æŒ‚è½½éªŒè¯ä½¿ç”¨(æ­£å¸¸ä½¿ç”¨)</span></span><br><span class="line">mkfs.xfs /dev/vdb /mnt</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_df1d528276047646321dc497bb964d7c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_df1d528276047646321dc497bb964d7c.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_98ea2a719d22c44088b0687abc0ff47e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_98ea2a719d22c44088b0687abc0ff47e.png"></p><p><strong>æ°¸ä¹…å‰¥ç¦» (éœ€è¦æå‰å¸è½½)</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è™šæ‹Ÿæœºå…ˆå¸è½½ç£ç›˜</span></span><br><span class="line">umonut /dev/vdb</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"> å®¿ä¸»æœºæ‰§è¡Œæ“ä½œ æ°¸ä¹…å‰¥ç¦»è™šæ‹Ÿæœºç£ç›˜</span></span><br><span class="line">virsh detach-disk web03 vdb --live --config</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è™šæ‹ŸæœºæŸ¥çœ‹ï¼ˆæˆåŠŸï¼‰</span></span><br><span class="line">lsblk</span><br><span class="line">//è¿”å›</span><br><span class="line">NAME Â  Â  Â  Â  Â  Â  Â  Â   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT</span><br><span class="line">sr0 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â 11:0 Â  Â 1 1024M Â 0 rom Â </span><br><span class="line">vda Â  Â  Â  Â  Â  Â  Â  Â  Â  252:0 Â  Â 0 Â  10G Â 0 disk </span><br><span class="line">â”œâ”€vda1 Â  Â  Â  Â  Â  Â  Â  Â 252:1 Â  Â 0 Â   1G Â 0 part /boot</span><br><span class="line">â””â”€vda2 Â  Â  Â  Â  Â  Â  Â  Â 252:2 Â  Â 0 Â   9G Â 0 part </span><br><span class="line">  â”œâ”€centos_web03-root 253:0 Â  Â 0 Â   8G Â 0 lvm  /</span><br><span class="line">  â””â”€centos_web03-swap 253:1 Â  Â 0 Â   1G Â 0 lvm  [SWAP]</span><br></pre></td></tr></table></figure><h3 id="2-å¯¹åˆšæ‰å‰¥ç¦»çš„qcow2ç£ç›˜ç©ºé—´æ‰©å®¹-æ— æ³•åœ¨çº¿æ‰©å®¹ï¼Œå¿…é¡»å…ˆå‰¥ç¦»"><a href="#2-å¯¹åˆšæ‰å‰¥ç¦»çš„qcow2ç£ç›˜ç©ºé—´æ‰©å®¹-æ— æ³•åœ¨çº¿æ‰©å®¹ï¼Œå¿…é¡»å…ˆå‰¥ç¦»" class="headerlink" title="2. å¯¹åˆšæ‰å‰¥ç¦»çš„qcow2ç£ç›˜ç©ºé—´æ‰©å®¹ (æ— æ³•åœ¨çº¿æ‰©å®¹ï¼Œå¿…é¡»å…ˆå‰¥ç¦»)"></a><code>2.</code> å¯¹åˆšæ‰å‰¥ç¦»çš„qcow2ç£ç›˜ç©ºé—´æ‰©å®¹ (æ— æ³•åœ¨çº¿æ‰©å®¹ï¼Œå¿…é¡»å…ˆå‰¥ç¦»)</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç»™åˆ›å»ºçš„ç£ç›˜æ‰©å®¹5G</span></span><br><span class="line">qemu-img resize /kvm/web03-vdb.qcow2 +5G</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹æ‰©å®¹è¯¦æƒ…</span></span><br><span class="line">qemu-img info /kvm/web03-vdb.qcow2</span><br><span class="line">//è¿”å›</span><br><span class="line">image: /kvm/web03-vdb.qcow2</span><br><span class="line">file format: qcow2</span><br><span class="line">virtual size: 15G (16106127360 bytes)</span><br></pre></td></tr></table></figure><p><strong>æ·»åŠ ç£ç›˜åˆ°è™šæ‹Ÿæœºï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ°¸ä¹…æ·»åŠ ç£ç›˜ï¼ˆç»™web03 æ·»åŠ 10Gç£ç›˜ æŒ‡å®šæ·»åŠ åè™šæ‹Ÿæœºç£ç›˜åç§°ä¸º vdb æ ¼å¼ä¸º qcow2 æ ¼å¼ï¼‰</span></span><br><span class="line">virsh attach-disk web03 /kvm/web03-vdb.qcow2 vdb --subdriver qcow2 --live --config</span><br><span class="line">//è¿”å›</span><br><span class="line">Disk attached successfully</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‚è½½éªŒè¯ï¼ˆå…ˆå‰å·²ç»æ ¼å¼åŒ–è¿‡ç£ç›˜ æ­¤æ—¶åˆ‡è®°ä¸èƒ½å†æ ¼å¼åŒ– å¦åˆ™ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ï¼‰</span> </span><br><span class="line">[root@web03 ~]# mount /dev/vdb /mnt</span><br><span class="line">[root@web03 ~]# cd /mnt</span><br><span class="line">[root@web03 mnt]# ls</span><br><span class="line">1.ttx</span><br><span class="line">[root@web03 mnt]# </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ·æ–°åˆ°<span class="built_in">df</span> -Th</span></span><br><span class="line">xfs_growfs /mnt</span><br><span class="line">//è¿”å›</span><br><span class="line">meta-data=/dev/vdb Â  Â  Â  Â  Â  Â  Â  isize=512 Â  Â agcount=4, agsize=655360 blks</span><br><span class="line"> Â  Â  Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sectsz=512 Â  attr=2, projid32bit=1</span><br><span class="line"> Â  Â  Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  crc=1 Â  Â  Â  Â finobt=0 spinodes=0</span><br><span class="line">data Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  bsize=4096 Â  blocks=2621440, imaxpct=25</span><br><span class="line"> Â  Â  Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sunit=0 Â  Â  Â swidth=0 blks</span><br><span class="line">naming Â  =version 2 Â  Â  Â  Â  Â  Â  Â bsize=4096 Â  ascii-ci=0 ftype=1</span><br><span class="line">log Â  Â  Â =internal Â  Â  Â  Â  Â  Â  Â  bsize=4096 Â  blocks=2560, version=2</span><br><span class="line"> Â  Â  Â  Â  = Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sectsz=512 Â  sunit=0 blks, lazy-count=1</span><br><span class="line">realtime =none Â  Â  Â  Â  Â  Â  Â  Â  Â  extsz=4096 Â  blocks=0, rtextents=0</span><br></pre></td></tr></table></figure><p><strong>å…ˆå‰å·²ç»æ ¼å¼åŒ–è¿‡ç£ç›˜ æ­¤æ—¶åˆ‡è®°ä¸èƒ½å†æ ¼å¼åŒ– å¦åˆ™ä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_05199bb86394af821c0bc709165683a0.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_05199bb86394af821c0bc709165683a0.png"></p><h2 id="åå››-çƒ­æ·»åŠ ç½‘å¡"><a href="#åå››-çƒ­æ·»åŠ ç½‘å¡" class="headerlink" title="åå››. çƒ­æ·»åŠ ç½‘å¡"></a>åå››. çƒ­æ·»åŠ ç½‘å¡</h2><h3 id="1-çƒ­æ·»åŠ ç½‘å¡"><a href="#1-çƒ­æ·»åŠ ç½‘å¡" class="headerlink" title="1.çƒ­æ·»åŠ ç½‘å¡"></a><code>1.</code>çƒ­æ·»åŠ ç½‘å¡</h3><p><strong>æ¡ˆä¾‹: ä¸ºKVMè™šæ‹Ÿæœº web03 æ·»åŠ ä¸€å—ç½‘å¡</strong></p><p><strong>æ ¼å¼:  virsh attach-interface   è™šæ‹Ÿæœºåç§°  â€“type bridgeâ€“source  ç½‘æ¡¥å  â€“model  virtio</strong></p><ul><li><strong>â€“type              ç”¨äºæŒ‡å®šç½‘å¡ç±»å‹</strong></li><li><strong>â€“source          å®¿ä¸»æœºç½‘æ¡¥å</strong></li><li><strong>â€“model virtio   é©±åŠ¨æ¨¡å¼(ç”¨äºæŒ‡å®šç½‘å¡ç±»å‹ä»¥ethå¼€å¤´)</strong></li><li><strong>â€“live              åœ¨çº¿æ·»åŠ </strong></li><li><strong>â€“config          æ°¸ä¹…ä¿å­˜é…ç½®(ä¸åŠ ä¸´æ—¶ç”Ÿæ•ˆ)</strong></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç»™ web03 çƒ­æ·»åŠ ä¸€å—bridgeç±»å‹ç½‘å¡</span></span><br><span class="line">virsh attach-interface web03 --type bridge Â --source br0 --model virtio --live --config</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç»™ web03 çƒ­æ·»åŠ ä¸€å—natç±»å‹ç½‘å¡ (åªæœ‰ä¸€å—ç½‘å¡æ¨¡å¼æ—¶ --<span class="built_in">source</span>éœ€è¦æ˜¯ens33)</span></span><br><span class="line">virsh attach-interface web03 --type default --source br0 --model virtio --live --config</span><br></pre></td></tr></table></figure><p><strong>è™šæ‹ŸæœºéªŒè¯ï¼š</strong> <code>ip a s</code> æˆåŠŸæ·»åŠ äº†ä¸€å— <strong>eth1</strong> ç½‘å¡ å¹¶ä¸”ç½‘å¡è‡ªåŠ¨è·å–ä¸º10.0.0.186</p><p>è‹¥è¦ é…ç½®æˆå›ºå®šåœ°å€æ—¶éœ€è¦æ–°å»ºä¸€ä¸ªç½‘å¡é…ç½®æ–‡ä»¶ é…ç½® IP  æˆ–è€…ä½¿ç”¨ nmtui è®¾ç½®ç½‘å¡</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d11dedc5313b8c669b47717ebb3752a8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_d11dedc5313b8c669b47717ebb3752a8.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_bb39dccafdd291a95d611dfe61554255.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_bb39dccafdd291a95d611dfe61554255.png"></p><p><strong>ç½‘å¡ä¸æƒ³è¦äº†æ€ä¹ˆåŠå‘¢ çƒ­åˆ é™¤å³å¯ã€‚</strong></p><h3 id="2-çƒ­åˆ é™¤è™šæ‹Ÿæœºç½‘å¡ï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰"><a href="#2-çƒ­åˆ é™¤è™šæ‹Ÿæœºç½‘å¡ï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰" class="headerlink" title="2.çƒ­åˆ é™¤è™šæ‹Ÿæœºç½‘å¡ï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰"></a><code>2.</code>çƒ­åˆ é™¤è™šæ‹Ÿæœºç½‘å¡ï¼ˆå®¿ä¸»æœºæ‰§è¡Œï¼‰</h3><ul><li><strong>â€“mac +é€šè¿‡macåœ°å€åˆ é™¤ ï¼ˆæŒ‡å®šç½‘å¡macåœ°å€åˆ é™¤ï¼‰</strong></li><li><strong>è™šæ‹Ÿæœºä½¿ç”¨ ip a / ifconfig æŸ¥çœ‹ï¼Œmacåœ°å€</strong></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">çƒ­åˆ é™¤è™šæ‹Ÿæœº web03 ç½‘å¡ (æˆåŠŸå‰¥ç¦»)</span></span><br><span class="line">virsh detach-interface web03 --type bridge --mac 52:54:00:c8:3e:2a --live --config</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_1e84857802829a410b17411183904d57.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_1e84857802829a410b17411183904d57.png"></p><h3 id="åäº”-çƒ­æ·»åŠ å†…å­˜"><a href="#åäº”-çƒ­æ·»åŠ å†…å­˜" class="headerlink" title="åäº”. çƒ­æ·»åŠ å†…å­˜"></a>åäº”. çƒ­æ·»åŠ å†…å­˜</h3><h3 id="1-åˆ›å»ºæ—¶æŒ‡å®šcpu-å†…å­˜æœ€å¤§æ•°é‡"><a href="#1-åˆ›å»ºæ—¶æŒ‡å®šcpu-å†…å­˜æœ€å¤§æ•°é‡" class="headerlink" title="1.åˆ›å»ºæ—¶æŒ‡å®šcpu å†…å­˜æœ€å¤§æ•°é‡"></a><code>1.</code>åˆ›å»ºæ—¶æŒ‡å®šcpu å†…å­˜æœ€å¤§æ•°é‡</h3><p><strong>çƒ­æ·»åŠ å†…å­˜ä¸CPU  å‰ææ˜¯åˆ›å»ºKVMè™šæ‹Ÿæœºæ—¶è®¾ç½®maxmemoryä¸maxvcpuså‚æ•° ä¹Ÿå¯åˆ›å»ºå®Œæˆåé€šè¿‡å‘½ä»¤å®šä¹‰</strong></p><ul><li><strong>maxmemory    å®šä¹‰è™šæœºæœ€å¤§å¯ä»¥åˆ†é…å†…å­˜çš„å¤§å°</strong></li><li><strong>maxvcpus        å®šä¹‰è™šæ‹Ÿæœºæœ€å¤§å¯ä»¥ä½¿ç”¨çš„CPUæ ¸æ•°</strong></li></ul><p><strong>åˆ›å»ºKVMè™šæ‹Ÿæœºï¼Œå¹¶è®¾ç½®maxmemoryä¸maxvcpusçš„å€¼</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºè™šæ‹Ÿæœº</span></span><br><span class="line">virt-install --virt-type kvm \</span><br><span class="line">--os-type=linux \</span><br><span class="line">--os-variant rhel7 \</span><br><span class="line">--name web04 \</span><br><span class="line">--memory 1024,maxmemory=2048 \</span><br><span class="line">--vcpus 1,maxvcpus=4 --disk /kvm/web04-vda.qcow2,format=qcow2,size=10 \</span><br><span class="line">--cdrom /opt/CentOS-7-x86_64-Minimal-2009.iso --network bridge=br0 --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºåé€šè¿‡å‘½ä»¤æŒ‡å®š-cpu-å†…å­˜æœ€å¤§æ•°é‡"><a href="#2-åˆ›å»ºåé€šè¿‡å‘½ä»¤æŒ‡å®š-cpu-å†…å­˜æœ€å¤§æ•°é‡" class="headerlink" title="2.åˆ›å»ºåé€šè¿‡å‘½ä»¤æŒ‡å®š cpu å†…å­˜æœ€å¤§æ•°é‡"></a><code>2.</code>åˆ›å»ºåé€šè¿‡å‘½ä»¤æŒ‡å®š cpu å†…å­˜æœ€å¤§æ•°é‡</h3><blockquote><p><strong>å‘½ä»¤åˆ›å»ºæ—¶æ²¡æœ‰æŒ‡å®šæœ€å¤§å†…å­˜ åˆ™éœ€è¦å…ˆè®¾ç½®ä¸€ä¸‹æœ€å¤§å†…å­˜ å¦åˆ™æ— æ³•æ·»åŠ </strong></p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è®¾ç½®æœ€å¤§å†…å­˜ï¼Œéœ€è¦å…³æœº</span></span><br><span class="line">virsh shutdown  web03</span><br><span class="line">virsh setmaxmem web03 6144M --config Â </span><br><span class="line">// é»˜è®¤æ— å›æ˜¾</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸´æ—¶æ·»åŠ å†…å­˜ï¼Œç¼©å‡å†…å­˜åŒæ ·ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸è¦ç¼©å‡å†…å­˜ ä¼šå¯¼è‡´æœºå™¨å‡ºç°é—®é¢˜</span></span><br><span class="line">virsh setmem web03 4096M </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ°¸ä¹…æ·»åŠ å†…å­˜</span></span><br><span class="line">virsh setmem web03 4096M --config Â </span><br></pre></td></tr></table></figure><p><strong>éªŒè¯</strong>ï¼ˆæ·»åŠ æˆåŠŸï¼‰</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_e5eb9315664b827df6013961c3b6b4d2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_e5eb9315664b827df6013961c3b6b4d2.png"></p><h2 id="åå…­-çƒ­æ·»åŠ cpu"><a href="#åå…­-çƒ­æ·»åŠ cpu" class="headerlink" title="åå…­. çƒ­æ·»åŠ cpu"></a>åå…­. çƒ­æ·»åŠ <code>cpu</code></h2><h3 id="1-åˆ›å»ºè™šæ‹Ÿæœºæ—¶æŒ‡å®š-CPU-æœ€å¤§æ•°æ—¶-çƒ­æ·»åŠ CPU"><a href="#1-åˆ›å»ºè™šæ‹Ÿæœºæ—¶æŒ‡å®š-CPU-æœ€å¤§æ•°æ—¶-çƒ­æ·»åŠ CPU" class="headerlink" title="1. åˆ›å»ºè™šæ‹Ÿæœºæ—¶æŒ‡å®š CPU æœ€å¤§æ•°æ—¶ çƒ­æ·»åŠ CPU"></a><code>1.</code> åˆ›å»ºè™šæ‹Ÿæœºæ—¶æŒ‡å®š <strong>CPU</strong> æœ€å¤§æ•°æ—¶ çƒ­æ·»åŠ <code>CPU</code></h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸´æ—¶çƒ­æ·»åŠ cpuæ ¸æ•°</span></span><br><span class="line">virsh setvcpus web03 4 --live</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ°¸ä¹…æ·»åŠ cpuæ ¸æ•°</span></span><br><span class="line">virsh setvcpus web03 4 --config</span><br></pre></td></tr></table></figure><h3 id="2-åˆ›å»ºå®Œæˆåçƒ­æ·»åŠ è™šæ‹ŸæœºCPUï¼ˆéœ€è¦å…³æœº-ä¸”è®¾ç½®çš„-CPU-æœ€å¤§æ•°ä¸èƒ½è¶…è¿‡å®¿ä¸»æœº-CPU-æ•°ï¼‰"><a href="#2-åˆ›å»ºå®Œæˆåçƒ­æ·»åŠ è™šæ‹ŸæœºCPUï¼ˆéœ€è¦å…³æœº-ä¸”è®¾ç½®çš„-CPU-æœ€å¤§æ•°ä¸èƒ½è¶…è¿‡å®¿ä¸»æœº-CPU-æ•°ï¼‰" class="headerlink" title="2. åˆ›å»ºå®Œæˆåçƒ­æ·»åŠ è™šæ‹ŸæœºCPUï¼ˆéœ€è¦å…³æœº ä¸”è®¾ç½®çš„ CPU æœ€å¤§æ•°ä¸èƒ½è¶…è¿‡å®¿ä¸»æœº  CPU  æ•°ï¼‰"></a><code>2.</code> åˆ›å»ºå®Œæˆåçƒ­æ·»åŠ è™šæ‹ŸæœºCPUï¼ˆéœ€è¦å…³æœº ä¸”è®¾ç½®çš„ CPU æœ€å¤§æ•°ä¸èƒ½è¶…è¿‡å®¿ä¸»æœº  CPU  æ•°ï¼‰</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹è™šæ‹Ÿæœºå½“å‰æœ€å¤§æ”¯æŒçš„æ ¸å¿ƒæ•°</span></span><br><span class="line">virsh edit web03</span><br><span class="line">...</span><br><span class="line">//è¿”å›</span><br><span class="line">  &lt;memory unit=&#x27;KiB&#x27;&gt;2097152&lt;/memory&gt;</span><br><span class="line">  &lt;currentMemory unit=&#x27;KiB&#x27;&gt;2097152&lt;/currentMemory&gt;</span><br><span class="line">  &lt;vcpu placement=&#x27;static&#x27;&gt;1&lt;/vcpu&gt; Â  # 1cpu</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è°ƒæ•´è™šæ‹Ÿæœºæ”¯æŒCPUçš„æœ€å¤§å€¼</span></span><br><span class="line">virsh setvcpus web03 --maximum 6 --config </span><br><span class="line">...</span><br><span class="line">å¦åˆ™ä¼šæŠ¥é”™</span><br><span class="line">virsh setvcpus web03 Â 4 --config</span><br><span class="line">error: invalid argument: requested vcpus is greater than max allowable vcpus for the persistent domain: 4 &gt; 1</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨å‘½ä»¤è°ƒæ•´å æŸ¥çœ‹æ–‡ä»¶æ˜¯å¦æ”¹å˜ (æ–‡ä»¶æˆåŠŸæ”¹å˜)</span></span><br><span class="line">virsh edit web03</span><br><span class="line">...</span><br><span class="line">  &lt;currentMemory unit=&#x27;KiB&#x27;&gt;2097152&lt;/currentMemory&gt;</span><br><span class="line">  &lt;vcpu placement=&#x27;static&#x27; current=&#x27;1&#x27;&gt;6&lt;/vcpu&gt; Â # 6cpu</span><br><span class="line">...</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯åŠ¨è™šæ‹ŸæœºæŸ¥çœ‹é…ç½®</span></span><br><span class="line">virsh start web03</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸´æ—¶çƒ­æ·»åŠ CPUæ ¸å¿ƒæ•°é‡</span></span><br><span class="line">virsh setvcpus web03 4</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ°¸ä¹…æ·»åŠ CPUæ ¸å¿ƒæ•°é‡</span></span><br><span class="line">virsh setvcpus web03 4 --config</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_229143f829ebe75863789362572c1acf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_229143f829ebe75863789362572c1acf.png"></p><p><strong>æœ¬æ–‡çƒ­æ·»åŠ å†…å­˜åŠcpuéƒ¨åˆ†å‚è€ƒå¦‚ä¸‹é“¾æ¥</strong></p><p><a href="https://www.cnblogs.com/yinzhengjie/p/18127842">https://www.cnblogs.com/yinzhengjie/p/18127842</a> <a href="https://blog.csdn.net/m0_46180357/article/details/108935979">https://blog.csdn.net/m0_46180357/article/details/108935979</a></p>]]></content>
      
      
      <categories>
          
          <category> kvm </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kvm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>windows11å®‰è£…docker-desktop,docker-compose</title>
      <link href="/2024/04/20/windows11%E5%AE%89%E8%A3%85docker-desktop,docker-compose/"/>
      <url>/2024/04/20/windows11%E5%AE%89%E8%A3%85docker-desktop,docker-compose/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="windows11å®‰è£…docker-desktop-docker-compose"><a href="#windows11å®‰è£…docker-desktop-docker-compose" class="headerlink" title="windows11å®‰è£…docker-desktop,docker-compose"></a>windows11å®‰è£…docker-desktop,docker-compose</h1><blockquote><p>å¤‡æ³¨ï¼šdocker-desktop æ— æ³•ä¸ vmware çš„è™šæ‹ŸåŒ– Inter-VT-x/EPTæˆ–AMD-V/RVI(V) å…±å­˜ ä½¿ç”¨æ­¤åŠŸèƒ½æ—¶éœ€è¦å…ˆçŸ­æš‚å…³é—­ Hyper-V æœåŠ¡å¹¶é‡å¯ç”µè„‘ CMD å‘½ä»¤å¦‚ä¸‹ éœ€è¦ä½¿ç”¨docker-desktop æ—¶å†å¼€å¯å¹¶é‡å¯ç”µè„‘å³å¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­</span></span><br><span class="line">bcdedit /set hypervisorlaunchtype off </span><br><span class="line"><span class="comment"># å¯åŠ¨ </span></span><br><span class="line">bcdedit /set hypervisorlaunchtype auto</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_118aa809b6e7db0a2c34c57eb7d08ecf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_118aa809b6e7db0a2c34c57eb7d08ecf.png"></p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/CNjcdyl/article/details/124802614">è§£å†³è™šæ‹ŸæœºVM-å¼€å¯ è™šæ‹ŸåŒ– Intel-VT-x/EPT æˆ– AMD-V/RVIï¼ˆVï¼‰ å ç”µè„‘è“å±é‡å¯ æˆ–æ˜¾ç¤ºæ­¤å¹³å°ä¸æ”¯æŒè™šæ‹ŸåŒ–çš„é—®é¢˜ ï¼ˆWin10ï¼‰_è™šæ‹ŸåŒ–inteltv-xeptæˆ–amd-vrvi-</a></p></blockquote><h1 id="ä¸€ã€å®‰è£…é¡ºåº"><a href="#ä¸€ã€å®‰è£…é¡ºåº" class="headerlink" title="ä¸€ã€å®‰è£…é¡ºåº"></a>ä¸€ã€å®‰è£…é¡ºåº</h1><p><a href="https://blog.csdn.net/qq_41644183/article/details/132305487#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85Hyper-V">å®‰è£…Hyper-V</a></p><p><a href="https://blog.csdn.net/qq_41644183/article/details/132305487#%E4%B8%89%E3%80%81%E5%AE%89%E8%A3%85WSL">å®‰è£…WSL</a></p><p><a href="https://blog.csdn.net/qq_41644183/article/details/132305487#%E5%9B%9B%E3%80%81%E5%AE%89%E8%A3%85Docker%20Desktop">å®‰è£…Docker Desktop</a></p><p><a href="https://link.zhihu.com/?target=https://desktop.docker.com/win/main/amd64/Docker%2520Desktop%2520Installer.exe">Docker-windows-appä¸‹è½½é“¾æ¥</a></p><h1 id="äºŒã€å®‰è£…Hyper-V"><a href="#äºŒã€å®‰è£…Hyper-V" class="headerlink" title="äºŒã€å®‰è£…Hyper-V"></a>äºŒã€å®‰è£…Hyper-V</h1><p>1ã€Windows11æ˜¯æ‰¾ä¸åˆ°<a href="https://so.csdn.net/so/search?q=Hyper-V&spm=1001.2101.3001.7020">Hyper-V</a>çš„ï¼Œéœ€è¦è‡ªè¡Œå®‰è£…</p><p>2ã€åˆ›å»ºä¸€ä¸ªhyper.batæ–‡ä»¶ï¼Œç¼–è¾‘ï¼Œå¤åˆ¶ä»¥ä¸‹ä»£ç åˆ°æ–‡ä»¶ä¸­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pushd</span> <span class="string">&quot;%~dp0&quot;</span></span><br><span class="line"><span class="built_in">dir</span> /b %SystemRoot%\servicing\Packages\*Hyper-V*.mum &gt;hyper-v.txt</span><br><span class="line"><span class="keyword">for</span> /f %%i <span class="keyword">in</span> (<span class="string">&#x27;findstr /i . hyper-v.txt 2^&gt;nul&#x27;</span>) <span class="keyword">do</span> dism /online /norestart /add-package:<span class="string">&quot;%SystemRoot%\servicing\Packages\%%i&quot;</span></span><br><span class="line">del hyper-v.txt</span><br><span class="line">Dism /online /enable-feature /featurename:Microsoft-Hyper-V-All /LimitAccess /ALL</span><br></pre></td></tr></table></figure><p>3ã€ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œhyper.batï¼Œè¿è¡Œäº†ä¹‹åéœ€è¦æŒ‰Ctrl+Cåœä¸‹æ¥ï¼Œå¦åˆ™ä¼šä¸€ç›´é‡å¤æ‰§è¡Œï¼Œæœ€åè¾“å…¥Yï¼Œç¡®è®¤å®ŒæˆHyper-Vçš„å®‰è£…<br>4ã€æ‰“å¼€æ§åˆ¶é¢æ¿-&gt;ç¨‹åº-&gt;å¯ç”¨æˆ–å…³é—­WindowsåŠŸèƒ½å‹¾é€‰Hyper-Vï¼ŒåŒæ—¶å‹¾é€‰é€‚ç”¨äºLinuxçš„Windowså­ç³»ç»Ÿä»¥åŠè™šæ‹Ÿæœºå¹³å°ï¼Œé‡å¯ç”µè„‘ï¼ˆå¯ä»¥ç­‰å®‰è£…WSLçš„æ—¶å€™å†é‡å¯ï¼‰<br><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c56711b4323471003c3a8ea0d960d131.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c56711b4323471003c3a8ea0d960d131.png"></p><h1 id="ä¸‰ã€å®‰è£…WSL"><a href="#ä¸‰ã€å®‰è£…WSL" class="headerlink" title="ä¸‰ã€å®‰è£…WSL"></a>ä¸‰ã€å®‰è£…WSL</h1><p>1ã€ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€PowerShellï¼Œè¾“å…¥å‘½ä»¤å®‰è£…WSL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Hyper-V -All</span><br></pre></td></tr></table></figure><p>2ã€å®Œæˆï¼Œé‡å¯ç”µè„‘ï¼Œå®Œæˆå®‰è£…</p><p>3ã€å¦‚æœWSLç‰ˆæœ¬å¤ªä½ï¼Œå‡çº§WSL</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wsl.exe --update</span><br></pre></td></tr></table></figure><h1 id="å››ã€å®‰è£…Docker-Desktop"><a href="#å››ã€å®‰è£…Docker-Desktop" class="headerlink" title="å››ã€å®‰è£…Docker Desktop"></a>å››ã€å®‰è£…Docker Desktop</h1><p>1ã€<a href="https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe">ä¸‹è½½Docker Desktop</a></p><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c8aeee17bdfc44342ee2537961ade9c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c8aeee17bdfc44342ee2537961ade9c.png"></p><h1 id="äº”-å®‰è£…docker-compose"><a href="#äº”-å®‰è£…docker-compose" class="headerlink" title="äº”. å®‰è£…docker-compose"></a>äº”. å®‰è£…docker-compose</h1><p>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/docker/compose/releases/">https://github.com/docker/compose</a></p><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/qq_41644183/article/details/132305487">Dockerå®‰è£…æ•™ç¨‹â€”â€”ä»¥Windows11å®¶åº­ä¸­æ–‡ç‰ˆä¸ºä¾‹_win11å®¶åº­ç‰ˆå®‰è£…docker</a></p><p><a href="https://zhuanlan.zhihu.com/p/552307629">Win11å®‰è£…DockeråŠç®€å•ä½¿ç”¨ - çŸ¥ä¹ (zhihu.com)</a></p><p><a href="https://blog.csdn.net/qq_38215042/article/details/108647680">Windowså®‰è£…ä½¿ç”¨dockerä¸docker-compose_windowsä¸‹å®‰è£…compose-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>confluenceéƒ¨ç½²</title>
      <link href="/2024/04/17/confluence%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/17/confluence%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="confluenceéƒ¨ç½²"><a href="#confluenceéƒ¨ç½²" class="headerlink" title="confluenceéƒ¨ç½²"></a>confluenceéƒ¨ç½²</h1><h1 id="ä¸€-å®‰è£…java-1-8"><a href="#ä¸€-å®‰è£…java-1-8" class="headerlink" title="ä¸€. å®‰è£…java 1.8"></a>ä¸€. å®‰è£…java 1.8</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install software-properties-common</span><br><span class="line">apt-get install openjdk-8-jdk</span><br></pre></td></tr></table></figure><h1 id="äºŒ-éƒ¨ç½²mysql5-7æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨dockeréƒ¨ç½²"><a href="#äºŒ-éƒ¨ç½²mysql5-7æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨dockeréƒ¨ç½²" class="headerlink" title="äºŒ. éƒ¨ç½²mysql5.7æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨dockeréƒ¨ç½²"></a>äºŒ. éƒ¨ç½²mysql5.7æœ¬æ¬¡æˆ‘ä»¬ä½¿ç”¨dockeréƒ¨ç½²</h1><blockquote><p>ç‰¹åˆ«è¯´æ˜ï¼ˆæœ¬æ–‡å·²å†™å…¥docker-composeæ–‡ä»¶ä¸­ï¼‰</p><p>ä¸€å®šè¦è®¾ç½®æ•°æ®åº“éš”ç¦»çº§åˆ« <code>SET GLOBAL tx_isolation=&#39;READ-COMMITTED&#39;; </code>å¦åˆ™ä¼šå¯¼è‡´confluenceè¿ä¸ä¸Šæ•°æ®åº“</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;3.0&quot;</span>                                                                                                                                                 </span><br><span class="line">services:                                                                                                                                                      </span><br><span class="line">  db:                                                                                                                                                          </span><br><span class="line">    image: mysql:5.7                                                                                                                                           </span><br><span class="line">    container_name: confluse_mysql                                                                                                                             </span><br><span class="line">    hostname: db                                                                                                                                               </span><br><span class="line">    restart: always                                                                                                                                            </span><br><span class="line">    ports:                                                                                                                                                     </span><br><span class="line">      - <span class="string">&quot;3307:3306&quot;</span>                                                                                                                                            </span><br><span class="line">    <span class="built_in">command</span>:                                                                                                                                                   </span><br><span class="line">      - mysqld                                                                                                                                                 </span><br><span class="line">      - --symbolic-links=0                                                                                                                                     </span><br><span class="line">      - --transaction-isolation=READ-COMMITTED                                                                                                                 </span><br><span class="line">      - --collation_server=utf8_bin                                                                                                                            </span><br><span class="line">      - --character-set-server=utf8                                                                                                                            </span><br><span class="line">      - --innodb_file_per_table=1                                                                                                                              </span><br><span class="line">      - --innodb_buffer_pool_size=2G                                                                                                                           </span><br><span class="line">      - --max_connections=1000                                                                                                                                 </span><br><span class="line">      - --innodb_flush_log_at_trx_commit=2                                                                                                                     </span><br><span class="line">      - --innodb_read_io_threads=32                                                                                                                            </span><br><span class="line">      - --innodb_write_io_threads=16                                                                                                                           </span><br><span class="line">      - --max_allowed_packet=32M                                                                                                                               </span><br><span class="line">      - --max_heap_table_size=512M                                                                                                                             </span><br><span class="line">      - --bulk_insert_buffer_size=64M                                                                                                                          </span><br><span class="line">      - --tmp_table_size=64M                                                                                                                                   </span><br><span class="line">      - --join_buffer_size=64M                                                                                                                                 </span><br><span class="line">      - --max_allowed_packet=34M                                                                                                                               </span><br><span class="line">      - --innodb_log_file_size=256M                                                                                                                            </span><br><span class="line">    environment:                                                                                                                                               </span><br><span class="line">      - MYSQL_ROOT_PASSWORD=<span class="built_in">test</span>                                                                                                                     </span><br><span class="line">      - MYSQL_DATABASE=confluence_test                                                                                                                         </span><br><span class="line">      - MYSQL_DATABASE=confluence                                                                                                                              </span><br><span class="line">      - MYSQL_USER=confluence                                                                                                                                  </span><br><span class="line">      - MYSQL_PASSWORD=<span class="built_in">test</span>                                                                                                                                  </span><br><span class="line">      - TZ=Asia/Shanghai                                                                                                                                       </span><br><span class="line">    volumes:                                                                                                                                                   </span><br><span class="line">      - confluse-db:/var/lib/mysql                                                                                                                             </span><br><span class="line">      - ./db_bak_sh:/home/db_bak_sh:rw                                                                                                                         </span><br><span class="line">      - ./bak:/opt/confluence_mysql/bak:rw                                                                                                                     </span><br><span class="line">volumes:                                                                                                                                                       </span><br><span class="line">  confluse-db:</span><br></pre></td></tr></table></figure><p>mysqlå¤‡ä»½è„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash                                                                                                                                                          </span></span><br><span class="line"><span class="comment">#mysqlbak_version:1.3                                                                                                                                                </span></span><br><span class="line"><span class="comment">#æ ‡å‡†æ¢æ•°æ®åº“å¤‡ä»½è„šæœ¬                                                                                                                                                </span></span><br><span class="line"><span class="built_in">set</span> -e                                                                                                                                                               </span><br><span class="line"><span class="function"><span class="title">bak_mysql</span></span>()&#123;                                                                                                                                                         </span><br><span class="line">   bak_name=<span class="string">&quot;confluence&quot;</span>                                                                                                                                             </span><br><span class="line">   <span class="built_in">echo</span> <span class="string">&quot;\033[33m å¼€å§‹å¤‡ä»½æ•°æ®åº“:<span class="variable">$&#123;bak_name&#125;</span> \033[0m&quot;</span>                                                                                                                </span><br><span class="line">   bak_dir=<span class="string">&quot;/opt/confluence_mysql/bak&quot;</span>                                                                                                                               </span><br><span class="line">   time=`<span class="built_in">date</span> +%F_%H_%M`                                                                                                                                             </span><br><span class="line">   port_bak=3306                                                                                                                                                     </span><br><span class="line">   user_bak=<span class="string">&quot;root&quot;</span>                                                                                                                                                   </span><br><span class="line">   passwd_bak=<span class="string">&quot;test&quot;</span>                                                                                                                                       </span><br><span class="line">   ip_bak=localhost                                                                                                                                                  </span><br><span class="line"><span class="keyword">if</span> [ ! -d <span class="variable">$&#123;bak_dir&#125;</span> ];                                                                                                                                              </span><br><span class="line">   <span class="keyword">then</span>                                                                                                                                                              </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[33m å¼€å§‹åˆ›å»ºç›®å½•:<span class="variable">$&#123;bak_dir&#125;</span> \033[0m&quot;</span>                                                                                                               </span><br><span class="line">       <span class="built_in">mkdir</span> -p  <span class="variable">$&#123;bak_dir&#125;</span> &amp;&amp; <span class="built_in">chmod</span> 755 <span class="variable">$&#123;bak_dir&#125;</span>                                                                                                                  </span><br><span class="line">   <span class="keyword">else</span>                                                                                                                                                              </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[36m <span class="variable">$&#123;bak_dir&#125;</span>ç›®å½•å·²å­˜åœ¨  \033[0m&quot;</span>                                                                                                                 </span><br><span class="line"><span class="keyword">fi</span>                                                                                                                                                                   </span><br><span class="line">mysqldump -P<span class="variable">$&#123;port_bak&#125;</span> -p<span class="variable">$&#123;passwd_bak&#125;</span> -u<span class="variable">$&#123;user_bak&#125;</span> -h<span class="variable">$&#123;ip_bak&#125;</span> --single-transaction -R -E -B <span class="variable">$&#123;bak_name&#125;</span> |gzip &gt;<span class="variable">$&#123;bak_dir&#125;</span>/<span class="variable">$&#123;bak_name&#125;</span>_<span class="variable">$&#123;ip_bak&#125;</span>_<span class="variable">$&#123;time&#125;</span>.sql.gz   </span><br><span class="line">bak_file=<span class="string">&quot;/opt/confluence_mysql/bak/*.sql.gz&quot;</span>                                                                                                                        </span><br><span class="line"><span class="keyword">if</span> [ $? = 0 ];                                                                                                                                                       </span><br><span class="line">   <span class="keyword">then</span>                                                                                                                                                              </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[36m  <span class="variable">$&#123;time&#125;</span>æ•°æ®åº“:<span class="variable">$&#123;bak_name&#125;</span>å¤‡ä»½æˆåŠŸ,                                                                                                            </span></span><br><span class="line"><span class="string">                å¤‡ä»½ä½ç½®:<span class="variable">$&#123;bak_dir&#125;</span>/<span class="variable">$&#123;bak_name&#125;</span>_<span class="variable">$&#123;ip_bak&#125;</span>_<span class="variable">$&#123;time&#125;</span>.sql.gz  \033[0m&quot;</span> &gt;&gt; /opt/confluence_mysql/bak/confluence_bak.log                                   </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[36m <span class="variable">$&#123;time&#125;</span>æ•°æ®åº“:<span class="variable">$&#123;bak_name&#125;</span>å¤‡ä»½æˆåŠŸ,                                                                                                             </span></span><br><span class="line"><span class="string">                å¤‡ä»½ä½ç½®:<span class="variable">$&#123;bak_dir&#125;</span>/<span class="variable">$&#123;bak_name&#125;</span>_<span class="variable">$&#123;ip_bak&#125;</span>_<span class="variable">$&#123;time&#125;</span>.sql.gz                                                                                             </span></span><br><span class="line"><span class="string">                <span class="variable">$&#123;bak_dir&#125;</span>ç›®å½•æ­£åœ¨åˆ é™¤äº”å¤©å‰çš„å¤‡ä»½ã€‚ \033[0m&quot;</span>                                                                                                        </span><br><span class="line">       find <span class="variable">$&#123;bak_file&#125;</span> -<span class="built_in">type</span> f -mtime +5 |xargs <span class="built_in">rm</span> -f                                                                                                               </span><br><span class="line">   <span class="keyword">else</span>                                                                                                                                                              </span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&quot;\033[31m <span class="variable">$&#123;time&#125;</span>æ•°æ®åº“:<span class="variable">$&#123;bak_name&#125;</span>å¤‡ä»½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ã€‚ \033[0m&quot;</span>                                                                                           </span><br><span class="line"><span class="keyword">fi</span>                                                                                                                                                                   </span><br><span class="line">&#125;                                                                                                                                                                                                                                                                                                                                           </span><br><span class="line"><span class="function"><span class="title">main</span></span>() &#123;                                                                                                                                                                                                                                                                                                                       </span><br><span class="line">    bak_mysql                                                                                                                                                                                                                                                                                                   </span><br><span class="line">&#125;                                                                                                                                                                    </span><br><span class="line">main      </span><br></pre></td></tr></table></figure><p>ç™»å½•mysqlè®¾ç½®ç­–ç•¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it confluse_mysql bash</span><br><span class="line">mysql -uroot -p</span><br><span class="line">SET GLOBAL tx_isolation=<span class="string">&#x27;READ-COMMITTED&#x27;</span>;</span><br></pre></td></tr></table></figure><p><a href="https://wn-apple-teawine.fun/2023/05/15/mysql%E5%A4%87%E4%BB%BD%E8%84%9A%E6%9C%AC/?highlight=mysql%E5%A4%87%E4%BB%BD">mysqlå¤‡ä»½è„šæœ¬</a></p><p>å®šæ—¶ä»»åŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0 9 * * * /usr/bin/docker <span class="built_in">exec</span> webstack_mysql bash /home/mysqlbak/webstack-dbbak.sh</span><br><span class="line">0 10 * * * /usr/bin/docker <span class="built_in">exec</span> confluse_mysql bash /home/db_bak_sh/confluence_dbbak.sh</span><br></pre></td></tr></table></figure><h1 id="ä¸‰-å®‰è£…confluse"><a href="#ä¸‰-å®‰è£…confluse" class="headerlink" title="ä¸‰. å®‰è£…confluse"></a>ä¸‰. å®‰è£…confluse</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£… confluence</span></span><br><span class="line"><span class="built_in">cd</span> /opt</span><br><span class="line">wget https://product-downloads.atlassian.com/software/confluence/downloads/atlassian-confluence-6.12.0-x64.bin</span><br><span class="line"><span class="comment"># èµ‹äºˆæ‰§è¡Œæƒé™</span></span><br><span class="line"><span class="built_in">chmod</span> +x atlassian-confluence-6.12.0-x64.bin</span><br><span class="line"><span class="comment"># æ‰§è¡Œå®‰è£…</span></span><br><span class="line">./atlassian-confluence-6.12.0-x64.bin</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_79ea426efd840b65466f2b7ada4cc900.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_79ea426efd840b65466f2b7ada4cc900.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ebffd9d0bc193d12ca2d33caf5fba471.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ebffd9d0bc193d12ca2d33caf5fba471.png"></p><h1 id="å››-å…¶ä»–"><a href="#å››-å…¶ä»–" class="headerlink" title="å››. å…¶ä»–"></a>å››. å…¶ä»–</h1><blockquote><p>ç ´è§£ confluence</p><p>ç ´è§£æ–‡ä»¶ä¸‹è½½</p><p><a href="https://drive.wn-apple-teawine.fun/api/raw/?path=/public-tools/confluence/confluence%E7%A0%B4%E8%A7%A3%E5%B7%A5%E5%85%B7.zip">confluenceç ´è§£å·¥å…·.rar</a></p><h1 id="ç ´è§£æ­¥éª¤"><a href="#ç ´è§£æ­¥éª¤" class="headerlink" title="ç ´è§£æ­¥éª¤"></a>ç ´è§£æ­¥éª¤</h1><p>windows javaä¸‹è½½åœ°å€:</p><p><a href="https://www.oracle.com/java/technologies/javase/javase8u211-later-archive-downloads.html">Java Archive Downloads - Java SE 8u211 and later (oracle.com)</a></p><p>windowséƒ¨ç½²javaå‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_45710060/article/details/123315280">Javaè¯¦ç»†å®‰è£…é…ç½®æ•™ç¨‹(Windows)ï¼Œä»ä¸‹è½½åˆ°é…ç½®â€”â€”Java-1.8(jdk)å®‰è£…_jre1.8-CSDNåšå®¢</a></p><ul><li><p>æ‹·è´ <strong>/opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar</strong> æ–‡ä»¶åˆ° æœ¬åœ°æœ¬åœ°å¹¶é‡å‘½åä¸º <strong>atlassian-extras-2.4.jar</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æ­¤æ–‡ä»¶æ‹·è´åˆ°å½“å‰ç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span>  /opt/atlassian/confluence/confluence/WEB-INF/lib/atlassian-extras-decoder-v2-3.4.1.jar .</span><br><span class="line"><span class="comment"># é‡å‘½åä¸º atlassian-extras-2.4.jar å†å°†é‡å‘½ååçš„æ–‡ä»¶ä¸‹è½½åˆ°windowsç”µè„‘æœ¬åœ° ç”¨äºå­˜å‚¨ç ´è§£æ–‡ä»¶çš„æ–‡ä»¶å¤¹</span></span><br><span class="line"><span class="built_in">mv</span>  atlassian-extras-decoder-v2-3.4.1.jar  atlassian-extras-2.4.jar</span><br></pre></td></tr></table></figure></li><li><p>æ‰“å¼€ç ´è§£å·¥å…· <strong>confluence_keygen.jar</strong>ï¼ˆæœ¬åœ°éœ€å…ˆå®‰è£… <strong>java</strong> ï¼‰<strong>windows</strong> å‘½ä»¤è¡Œ <strong>cmd</strong> æ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar confluence_keygen.jar</span><br></pre></td></tr></table></figure></li><li><p>æ‰§è¡Œå®Œæˆå åå°ä¼šè‡ªåŠ¨å¯åŠ¨ä¸€ä¸ªç¨‹åº &gt;&gt; æ­¤æ—¶ç‚¹å‡»å·²å¯åŠ¨çš„ç¨‹åºçš„ <strong>.patch!</strong> é€‰é¡¹ æ‰¾åˆ° <strong>atlassian-extras-2.4.jar</strong> æ‰“å¼€</p></li><li><p>å¯ä»¥çœ‹åˆ° <strong>atlassian-extras-2.4.jar</strong> å’Œ <strong>atlassian-extras-2.4.bak</strong> ä¸¤ä¸ªæ–‡ä»¶ï¼Œè¿™é‡Œ <strong>atlassian-extras-2.4.jar</strong> å·²ç»æ˜¯ç ´è§£å¥½çš„äº†ï¼Œå°† <strong>atlassian-extras-2.4.jar</strong> åå­—æ”¹å› <strong>atlassian-extras-decoder-v2-3.4.1.jar</strong> å°† <strong>atlassian-extras-decoder-v2-3.4.1.jar</strong> ä¸Šä¼ åˆ°æœåŠ¡å™¨åŸç›®å½•</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨</span></span><br><span class="line">rz</span><br><span class="line"><span class="comment"># é‡å‘½åä¸ºä¹‹å‰çš„æ–‡ä»¶å</span></span><br><span class="line"><span class="built_in">mv</span> atlassian-extras-2.4.jar  atlassian-extras-decoder-v2-3.4.1.jar</span><br><span class="line"><span class="comment"># å¤åˆ¶åˆ°åŸç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span> atlassian-extras-decoder-v2-3.4.1.jar  /opt/atlassian/confluence/confluence/WEB-INF/lib/</span><br></pre></td></tr></table></figure></li><li><p>å°†ç ´è§£åŒ…ä¸­çš„ mysql é©±åŠ¨ mysql-connector-java-5.1.44-bin.jar æ‹·è´åˆ° /opt/atlassian/confluence/confluence/WEB-INF/lib</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†mysqlé©±åŠ¨æ‹·è´åˆ°æœåŠ¡å™¨ç›®å½•</span></span><br><span class="line"><span class="built_in">cp</span> mysql-connector-java-5.1.44-bin.jar  /opt/atlassian/confluence/confluence/WEB-INF/lib</span><br></pre></td></tr></table></figure></li><li><p>é‡å¯ confluence</p></li></ul><h2 id="åœæ­¢"><a href="#åœæ­¢" class="headerlink" title="åœæ­¢"></a>åœæ­¢</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœæ­¢ç¨‹åº</span></span><br><span class="line"><span class="built_in">cd</span> /opt/atlassian/confluence/bin/</span><br><span class="line">./stop-confluence.sh</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹-confluence-ç›‘å¬åœ°å€ï¼Œç¡®å®š-8090-æ²¡æœ‰ç›‘å¬åœ¨-127-0-0-1-ä¸Š"><a href="#ä¿®æ”¹-confluence-ç›‘å¬åœ°å€ï¼Œç¡®å®š-8090-æ²¡æœ‰ç›‘å¬åœ¨-127-0-0-1-ä¸Š" class="headerlink" title="ä¿®æ”¹ confluence ç›‘å¬åœ°å€ï¼Œç¡®å®š 8090 æ²¡æœ‰ç›‘å¬åœ¨ 127.0.0.1 ä¸Š"></a>ä¿®æ”¹ confluence ç›‘å¬åœ°å€ï¼Œç¡®å®š 8090 æ²¡æœ‰ç›‘å¬åœ¨ 127.0.0.1 ä¸Š</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /opt/atlassian/confluence/conf/server.xml</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹-confluence-ä½¿ç”¨çš„ç›®å½•çš„æƒé™"><a href="#ä¿®æ”¹-confluence-ä½¿ç”¨çš„ç›®å½•çš„æƒé™" class="headerlink" title="ä¿®æ”¹ confluence ä½¿ç”¨çš„ç›®å½•çš„æƒé™"></a>ä¿®æ”¹ confluence ä½¿ç”¨çš„ç›®å½•çš„æƒé™</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ–‡ä»¶å¤¹å…¶æ‰€æœ‰å†…å®¹é€’å½’åœ°ä¿®æ”¹ä¸ºconfluenceç”¨æˆ·å’Œç»„çš„æ‰€æœ‰æƒ</span></span><br><span class="line"><span class="built_in">chown</span> -R confluence:confluence /opt/atlassian</span><br><span class="line"><span class="built_in">chown</span> -R confluence:confluence /var/atlassian</span><br></pre></td></tr></table></figure><h2 id="å¯åŠ¨ï¼Œå¯åŠ¨æ¯”è¾ƒæ…¢ï¼Œéœ€è¦ç­‰ä¸ªä¸¤ä¸‰åˆ†é’Ÿ"><a href="#å¯åŠ¨ï¼Œå¯åŠ¨æ¯”è¾ƒæ…¢ï¼Œéœ€è¦ç­‰ä¸ªä¸¤ä¸‰åˆ†é’Ÿ" class="headerlink" title="å¯åŠ¨ï¼Œå¯åŠ¨æ¯”è¾ƒæ…¢ï¼Œéœ€è¦ç­‰ä¸ªä¸¤ä¸‰åˆ†é’Ÿ"></a>å¯åŠ¨ï¼Œå¯åŠ¨æ¯”è¾ƒæ…¢ï¼Œéœ€è¦ç­‰ä¸ªä¸¤ä¸‰åˆ†é’Ÿ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯åŠ¨ç¨‹åº</span></span><br><span class="line">./start-confluence.sh</span><br></pre></td></tr></table></figure><p>å…³äºæœåŠ¡ç›‘å¬IPçš„åŒºåˆ«ï¼Œå‚è€ƒ</p><p><a href="https://segmentfault.com/a/1190000018629247">https://segmentfault.com/a/1190000018629247</a></p><p>è®¿é—®confluence</p><p><a href="http://ip:8090/">http://ip:8090</a></p><p>å¼€æœºè‡ªå¯åŠ¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®ä¸ºsystemdæ‰˜ç®¡</span></span><br><span class="line">vim /lib/systemd/system/confluence.service</span><br><span class="line"></span><br><span class="line">[Unit]</span><br><span class="line">Description=confluence service</span><br><span class="line">After=network.target</span><br><span class="line">StartLimitIntervalSec=60</span><br><span class="line">StartLimitBurst=5</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">Type=forking</span><br><span class="line">User=confluence</span><br><span class="line">Group=confluence</span><br><span class="line">ExecStart=/opt/atlassian/confluence/bin/start-confluence.sh</span><br><span class="line">ExecStop=/opt/atlassian/confluence/bin/stop-confluence.sh</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartSec=1</span><br><span class="line">SuccessExitStatus=3 4</span><br><span class="line">RestartForceExitStatus=3 4</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line"></span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line"><span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">systemctl start/stop/restart/status confluence</span><br><span class="line">systemctl <span class="built_in">enable</span> confluence</span><br></pre></td></tr></table></figure><p>æŠ¥é”™</p><p>è‹¥éƒ¨ç½²è¿‡ç¨‹ä¸­å‡ºç°æŠ¥é”™ï¼Œå¯ä»¥å…ˆåœæ­¢ confluenceï¼Œç„¶ååˆ é™¤æ•°æ®åº“ï¼Œå¹¶é‡å»ºæ•°æ®åº“ï¼Œç„¶ååˆ é™¤ /var/atlassian/application-data/confluence/confluence.cfg.xml æ–‡ä»¶</p><p>å†å¯åŠ¨ confluenceï¼Œå°±åˆåˆ°äº† confluence çš„ setup é¡µé¢</p><h1 id="å¸è½½wiki"><a href="#å¸è½½wiki" class="headerlink" title="å¸è½½wiki"></a>å¸è½½wiki</h1><p><a href="https://blog.csdn.net/qq_43693598/article/details/111265298">linux å¸è½½confluenceï¼Œåªéœ€ä¸‰æ­¥_confluenceå¸è½½-CSDNåšå®¢</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. åˆ é™¤ä¸»ç›®å½•</span><br><span class="line"><span class="built_in">rm</span> -rf /opt/atlassian/</span><br><span class="line"></span><br><span class="line">2. åˆ é™¤æ•°æ®ç›®å½•</span><br><span class="line"><span class="built_in">rm</span> -rf /var/atlassian/</span><br><span class="line"></span><br><span class="line">3. åˆ é™¤ç”¨æˆ·</span><br><span class="line">userdel -r confluence</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.cnblogs.com/ios9/p/14473523.html">https://www.cnblogs.com/ios9/p/14473523.html</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> å¸¸ç”¨è½¯ä»¶ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å¸¸ç”¨è½¯ä»¶ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²</title>
      <link href="/2024/04/16/homepage%E4%B8%8Esun-panel%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%AF%BC%E8%88%AA%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/16/homepage%E4%B8%8Esun-panel%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%AF%BC%E8%88%AA%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²"><a href="#homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²" class="headerlink" title="homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²"></a>homepageä¸sun-panelè½»é‡çº§å¯¼èˆªéƒ¨ç½²</h1><blockquote><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ghcr.io/gethomepage/homepage:latest</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:homepage</span><br></pre></td></tr></table></figure><p>å…¶ä»–å„ç§å¯¼èˆª</p><p><a href="https://wn-apple-teawine.fun/2023/11/23/web-start%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%AF%BC%E8%88%AA%E6%A0%8F%E9%83%A8%E7%BD%B2">https://wn-apple-teawine.fun/2023/11/23/web-startè½»é‡çº§å¯¼èˆªæ éƒ¨ç½²</a></p><p><a href="https://wn-apple-teawine.fun/2023/08/11/webstack%E9%83%A8%E7%BD%B2">https://wn-apple-teawine.fun/2023/08/11/webstackéƒ¨ç½²</a></p></blockquote><h2 id="ä¸€-éƒ¨ç½²"><a href="#ä¸€-éƒ¨ç½²" class="headerlink" title="ä¸€. éƒ¨ç½²"></a>ä¸€. éƒ¨ç½²</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&quot;3.8&quot;</span></span><br><span class="line">services:</span><br><span class="line">  homepage:</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:homepage</span><br><span class="line">    container_name: homepage</span><br><span class="line">    restart: unless-stopped</span><br><span class="line">    ports:</span><br><span class="line">      - 5006:3000</span><br><span class="line">    environment:</span><br><span class="line">      - PUID=1000</span><br><span class="line">      - PGID=100</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - ./config:/app/config</span><br><span class="line">      - /var/run/docker.sock:/var/run/docker.sock</span><br><span class="line">    network_mode: bridge                                                                                                                   </span><br></pre></td></tr></table></figure><h2 id="äºŒ-é…ç½®ï¼ˆæ–‡ä»¶è·¯å¾„å¯åŠ¨è·¯å¾„æ–‡ä»¶å¤¹configï¼‰"><a href="#äºŒ-é…ç½®ï¼ˆæ–‡ä»¶è·¯å¾„å¯åŠ¨è·¯å¾„æ–‡ä»¶å¤¹configï¼‰" class="headerlink" title="äºŒ. é…ç½®ï¼ˆæ–‡ä»¶è·¯å¾„å¯åŠ¨è·¯å¾„æ–‡ä»¶å¤¹configï¼‰"></a>äºŒ. é…ç½®ï¼ˆæ–‡ä»¶è·¯å¾„å¯åŠ¨è·¯å¾„æ–‡ä»¶å¤¹configï¼‰</h2><p><strong>service.yml</strong>æœ¬æ–‡é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">root@web:/opt/homepage/config<span class="comment"># cat services.yaml </span></span><br><span class="line">---</span><br><span class="line"><span class="comment"># For configuration options and examples, please see:</span></span><br><span class="line"><span class="comment"># https://gethomepage.dev/latest/configs/services</span></span><br><span class="line"></span><br><span class="line">- è¿ç»´ä¸å¼€å‘å·¥å…·:</span><br><span class="line">    - Gitlab:</span><br><span class="line">        href: http://10.0.0.10:8929</span><br><span class="line">        description: ä»£ç æ‰˜ç®¡å¹³å°</span><br><span class="line">    - å¯†ç ç®¡ç†å¹³å°:</span><br><span class="line">        href: https://10.0.0.10</span><br><span class="line">        description: å¯†ç ç®¡ç†å¹³å°</span><br><span class="line"></span><br><span class="line">- AIåŠ©æ‰‹:</span><br><span class="line">    - one-api:</span><br><span class="line">        href: http://10.0.0.10:3000</span><br><span class="line">        description: api-keyåˆ†å‘å¹³å°</span><br><span class="line">    - Fastgpt:</span><br><span class="line">        href: http://10.0.0.10:30001</span><br><span class="line">        description: Fastgpt</span><br><span class="line"></span><br><span class="line">- å®˜ç½‘:</span><br><span class="line">    - å®˜ç½‘1:</span><br><span class="line">        href: http://10.0.0.10/wp-login.php</span><br><span class="line">        description: å®˜ç½‘1</span><br><span class="line">    - å®˜ç½‘2:</span><br><span class="line">        href: http://10.0.0.10:4007/wp-login.php</span><br><span class="line">        description: å®˜ç½‘2</span><br></pre></td></tr></table></figure><p><strong>settings.yaml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line"><span class="comment"># For configuration options and examples, please see:</span></span><br><span class="line"><span class="comment"># https://gethomepage.dev/latest/configs/settings</span></span><br><span class="line"></span><br><span class="line">providers:</span><br><span class="line">  openweathermap: openweathermapapikey</span><br><span class="line">  weatherapi: weatherapiapikey</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¯­è¨€en-AUã€en-GB</span></span><br><span class="line">language: zh-CN</span><br><span class="line"></span><br><span class="line"><span class="comment"># èƒŒæ™¯å›¾</span></span><br><span class="line">background:</span><br><span class="line">  image: https://images.unsplash.com/photo-1502790671504-542ad42d5189?auto=format&amp;fit=crop&amp;w=2560&amp;q=80</span><br><span class="line">  blur: sm <span class="comment">#æ¨¡ç³Šç¨‹åº¦ï¼ŒèŒƒå›´ sm, &quot;&quot;, md, xl... å‚è€ƒ https://tailwindcss.com/docs/backdrop-blur</span></span><br><span class="line">  saturate: 50 <span class="comment">#é¥±å’Œåº¦ï¼ŒèŒƒå›´ 0, 50, 100... å‚è€ƒ https://tailwindcss.com/docs/backdrop-saturate</span></span><br><span class="line">  brightness: 50 <span class="comment">#äº®åº¦ï¼ŒèŒƒå›´ 0, 50, 75... å‚è€ƒ https://tailwindcss.com/docs/backdrop-brightness</span></span><br><span class="line">  opacity: 50 <span class="comment">#ä¸é€æ˜åº¦ï¼ŒèŒƒå›´ 0-100</span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># æ ‡é¢˜</span></span><br><span class="line">title: CKY-å¯¼èˆª</span><br><span class="line"></span><br><span class="line"><span class="comment"># éšè—å‘å¸ƒç‰ˆæœ¬</span></span><br><span class="line"><span class="comment">#hideVersion: true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¼èˆªæ¨ªå±éœ€è¦ä¸service.ymlæ–‡ä»¶åŒæ­¥</span></span><br><span class="line">layout:</span><br><span class="line">  è¿ç»´ä¸å¼€å‘å·¥å…·:</span><br><span class="line">    icon: jellyfin.png</span><br><span class="line">    style: row</span><br><span class="line">    columns: 6</span><br><span class="line">  AIåŠ©æ‰‹:</span><br><span class="line">    icon: jellyfin.png</span><br><span class="line">    style: row</span><br><span class="line">    columns: 6</span><br><span class="line">  å®˜ç½‘:</span><br><span class="line">    icon: jellyfin.png</span><br><span class="line">    style: row</span><br><span class="line">    columns: 6</span><br></pre></td></tr></table></figure><h2 id="ä¸‰-sun-panelå¯¼èˆªéƒ¨ç½²-ä¸å»ºè®®ä½¿ç”¨-å­˜åœ¨bug-æ— æ³•ä¿®æ”¹å¯†ç "><a href="#ä¸‰-sun-panelå¯¼èˆªéƒ¨ç½²-ä¸å»ºè®®ä½¿ç”¨-å­˜åœ¨bug-æ— æ³•ä¿®æ”¹å¯†ç " class="headerlink" title="ä¸‰. sun-panelå¯¼èˆªéƒ¨ç½²(ä¸å»ºè®®ä½¿ç”¨ å­˜åœ¨bug æ— æ³•ä¿®æ”¹å¯†ç )"></a>ä¸‰. sun-panelå¯¼èˆªéƒ¨ç½²(ä¸å»ºè®®ä½¿ç”¨ å­˜åœ¨bug æ— æ³•ä¿®æ”¹å¯†ç )</h2><blockquote><p>å‚è€ƒï¼š<a href="https://mp.weixin.qq.com/s/WbwTVuCcoqHZkXJsBPIGFA">https://mp.weixin.qq.com/s/WbwTVuCcoqHZkXJsBPIGFA</a></p><ul><li><code>/app/conf</code>ï¼šç”¨æ¥å­˜æ”¾é…ç½®æ–‡ä»¶ã€‚</li><li><code>/app/uploads</code>ï¼šå­˜æ”¾ä¸Šä¼ çš„æ–‡ä»¶ã€‚</li><li><code>/app/database</code>ï¼šå­˜æ”¾æ•°æ®åº“æ–‡ä»¶ã€‚</li><li><code>/app/runtime</code>ï¼šå­˜æ”¾è¿è¡Œæ—¥å¿—ï¼ˆä¸å»ºè®®æŒ‚è½½ï¼‰ã€‚</li></ul><p>é»˜è®¤å¯†ç </p><ul><li>è´¦æˆ·ï¼š<a href="mailto:&#x61;&#x64;&#x6d;&#x69;&#110;&#x40;&#115;&#x75;&#110;&#x2e;&#99;&#x63;">&#x61;&#x64;&#x6d;&#x69;&#110;&#x40;&#115;&#x75;&#110;&#x2e;&#99;&#x63;</a></li><li>å¯†ç ï¼š12345678</li></ul></blockquote><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hslr/sun-panel</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:sun-panel</span><br></pre></td></tr></table></figure><p>docker-composeæ–¹å¼éƒ¨ç½²</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  sun-panel:</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:sun-panel</span><br><span class="line">    container_name: sun-panel</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;3002:3002&quot;</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ./conf:/app/conf</span><br><span class="line">      - ./uploads:/app/uploads</span><br><span class="line">      - ./database:/app/database</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c0077360c400276d07c17648c643fa87.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c0077360c400276d07c17648c643fa87.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://github.com/gethomepage/homepage">https://github.com/gethomepage/homepage</a></p><p><a href="https://www.himiku.com/archives/homepage.html">https://www.himiku.com/archives/homepage.html</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu20.04éƒ¨ç½²ftpæœåŠ¡</title>
      <link href="/2024/04/11/ubuntu20.04%E9%83%A8%E7%BD%B2ftp%E6%9C%8D%E5%8A%A1/"/>
      <url>/2024/04/11/ubuntu20.04%E9%83%A8%E7%BD%B2ftp%E6%9C%8D%E5%8A%A1/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ubuntu20-04éƒ¨ç½²ftpæœåŠ¡"><a href="#ubuntu20-04éƒ¨ç½²ftpæœåŠ¡" class="headerlink" title="ubuntu20.04éƒ¨ç½²ftpæœåŠ¡"></a>ubuntu20.04éƒ¨ç½²ftpæœåŠ¡</h1><h2 id="ä¸€-å®‰è£…ftpæœåŠ¡å¹¶åˆ›å»ºç™»å½•ç”¨æˆ·"><a href="#ä¸€-å®‰è£…ftpæœåŠ¡å¹¶åˆ›å»ºç™»å½•ç”¨æˆ·" class="headerlink" title="ä¸€. å®‰è£…ftpæœåŠ¡å¹¶åˆ›å»ºç™»å½•ç”¨æˆ·"></a>ä¸€. å®‰è£…ftpæœåŠ¡å¹¶åˆ›å»ºç™»å½•ç”¨æˆ·</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install vsftpd</span><br></pre></td></tr></table></figure><p>æ·»åŠ ftpç”¨æˆ·</p><p>åˆ›å»ºç”¨æˆ·(ç”¨æˆ·åä¸ºmyftpï¼Œä¸åé¢vsftpdé…ç½®æ–‡ä»¶å¯¹åº”)ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -m myftp -d /home/myftp</span><br><span class="line"><span class="comment"># è‹¥ä¸æƒ³è®©è¯¥ç”¨æˆ·ç™»å½•ç³»ç»Ÿ</span></span><br><span class="line">sudo useradd -m myftp -d /home/myftp -s /bin/bash/nologin</span><br><span class="line"><span class="comment"># è®¾ç½®ç”¨æˆ·å¯†ç </span></span><br><span class="line">sudo passwd myftp</span><br></pre></td></tr></table></figure><p>åˆ›å»ºç”¨æˆ·ç›®å½•,å¹¶èµ‹äºˆæƒé™(<code>æ­¤æ­¥éª¤å¿…é¡»åœ¨åˆ›å»ºç”¨æˆ·ä¹‹å</code>)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">mkdir</span> /home/myftp</span><br><span class="line">sudo <span class="built_in">chmod</span> 755 /home/myftp -R</span><br></pre></td></tr></table></figure><h2 id="äºŒ-ä¿®æ”¹æœåŠ¡é…ç½®"><a href="#äºŒ-ä¿®æ”¹æœåŠ¡é…ç½®" class="headerlink" title="äºŒ. ä¿®æ”¹æœåŠ¡é…ç½®"></a>äºŒ. ä¿®æ”¹æœåŠ¡é…ç½®</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vi /etc/vsftpd.conf</span><br></pre></td></tr></table></figure><p>é…ç½®å¦‚ä¸‹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">listen=YES</span><br><span class="line"><span class="comment">#listen_ipv6=YES      #ä½¿ç”¨IPV6</span></span><br><span class="line">anonymous_enable=NO   <span class="comment">#ä¸å…è®¸åŒ¿åè®¿é—®</span></span><br><span class="line">local_enable=YES      <span class="comment">#å…è®¸æœ¬åœ°ç”¨æˆ·ç™»å½•</span></span><br><span class="line">write_enable=YES      <span class="comment">#å…è®¸FTPå†™å…¥</span></span><br><span class="line">local_umask=022      <span class="comment">#æ–°å»ºæ–‡ä»¶å¤¹æˆ–æ–‡ä»¶çš„æƒé™é»˜è®¤ä¸º077ï¼Œå¤§å¤šæ•°ftpæœåŠ¡å™¨è®¾ç½®ä¸º022</span></span><br><span class="line"><span class="comment">#anon_upload_enable=YES  #ä¸å…è®¸åŒ¿åç”¨æˆ·ä¸Šä¼ æ–‡ä»¶</span></span><br><span class="line"><span class="comment">#anon_mkdir_write_enable=YES #ä¸å…è®¸åŒ¿åç”¨æˆ·æ–°å»ºç›®å½•</span></span><br><span class="line">dirmessage_enable=YES        <span class="comment">#è¿›å…¥ç›®å½•æ—¶å‘è¿œç¨‹ç”¨æˆ·å‘é€æ¶ˆæ¯</span></span><br><span class="line">use_localtime=YES            <span class="comment">#æ˜¾ç¤ºå¸¦æœ‰æ—¶é—´çš„ç›®å½•åˆ—è¡¨</span></span><br><span class="line">xferlog_enable=YES           <span class="comment">#æ¿€æ´»ä¸Šä¼ /ä¸‹è½½çš„æ—¥å¿—è®°å½•</span></span><br><span class="line">connect_from_port_20=YES     <span class="comment">#ç¡®ä¿ftpä¼ è¾“ç«¯å£å·ä¸º20</span></span><br><span class="line"><span class="comment">#chown_uploads=YES           #å¯å°†ä¸Šä¼ çš„åŒ¿åæ–‡ä»¶ç”±æŒ‡å®šç”¨æˆ·æ‹¥æœ‰</span></span><br><span class="line"><span class="comment">#chown_username=whoever</span></span><br><span class="line">xferlog_file=/var/log/vsftpd.log  <span class="comment">#æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨é»˜è®¤è·¯å¾„</span></span><br><span class="line">xferlog_std_format=YES           <span class="comment">#ä½¿ç”¨æ ‡å‡†åŒ–æ ¼å¼çš„æ—¥å¿—æ–‡ä»¶</span></span><br><span class="line"><span class="comment">#idle_session_timeout=600         #ç©ºé—²ä¼šè¯è¶…æ—¶çš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">#data_connection_timeout=120     #æ•°æ®è¿æ¥è¶…æ—¶çš„é»˜è®¤å€¼</span></span><br><span class="line"><span class="comment">#Nopriv_user= ftpsecure         #åˆ›å»ºå”¯ä¸€çš„ç”¨æˆ·ï¼Œå°†è¯¥ç”¨æˆ·ç”¨ä½œå®Œå…¨éš”ç¦»ä¸”æ— ç‰¹æƒçš„ç”¨æˆ·</span></span><br><span class="line"><span class="comment">#async_abor_enable=YES        #è¯†åˆ«å¼‚æ­¥aborè¯·æ±‚ï¼Œå¯èƒ½ä¼šæ‹’ç»ä¸€äº›è€çš„FTPå®¢æˆ·ç«¯çš„è¿æ¥</span></span><br><span class="line"><span class="comment">#ascii_upload_enable=YES      #è®¾ç½®ASCIIä¸Šä¼ ä¸‹è½½</span></span><br><span class="line"><span class="comment">#ascii_download_enable=YES </span></span><br><span class="line">ftpd_banner=Welcome to blah FTP service. <span class="comment">#ç™»å½•æ¬¢è¿è¯­</span></span><br><span class="line"><span class="comment">#deny_email_enable=YES          #æ‹’ç»åŒ¿åemailåœ°å€çš„æ–‡ä»¶ï¼Œé˜²æ­¢æ”»å‡»</span></span><br><span class="line"><span class="comment">#banned_email_file=/etc/vsftpd.banned_emails</span></span><br><span class="line"><span class="comment">#chroot_local_user=YES           #å°†æœ¬åœ°ç”¨æˆ·é™åˆ¶åœ¨ä¸»ç›®å½•ä¸­</span></span><br><span class="line">local_root=/home/myftp             <span class="comment">#è®¾ç½®ä¸»ç›®å½•</span></span><br><span class="line">chroot_local_user=YES            <span class="comment">#é™åˆ¶ç”¨æˆ·æƒé™</span></span><br><span class="line">chroot_list_enable=YES</span><br><span class="line">chroot_list_file=/etc/vsftpd.chroot_list  <span class="comment">#å…è®¸è®¿é—®çš„ç”¨æˆ·åˆ—è¡¨æ–‡ä»¶</span></span><br><span class="line"><span class="comment">#ls_recurse_enable=YES              #æ¿€æ´»ls -ré€‰é¡¹</span></span><br><span class="line">secure_chroot_dir=/var/run/vsftpd/empty   <span class="comment">#ç©ºç›®å½•åç§°</span></span><br><span class="line">pam_service_name=myftp                   <span class="comment">#åˆ›å»ºçš„ftpç”¨æˆ·å</span></span><br><span class="line"><span class="comment">#rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem  #sslçš„RSAè¯ä¹¦ä½ç½®</span></span><br><span class="line"><span class="comment">#rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key #sslçš„RSAç§˜é’¥ä½ç½®</span></span><br><span class="line"><span class="comment">#ssl_enable=NO                          #å¼€å¯sslåŠ å¯†</span></span><br><span class="line"><span class="comment">#utf8_filesystem=YES                    #ä½¿ç”¨utf8æ–‡ä»¶ç³»ç»Ÿ</span></span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹ä¸ºé…ç½®åçš„vsftpd.confæ–‡ä»¶å†…å®¹ï¼Œ#ä¸ºæ³¨é‡Šå†…å®¹ï¼Œå·²åˆ é™¤ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">listen=YES</span><br><span class="line">anonymous_enable=NO</span><br><span class="line">local_enable=YES</span><br><span class="line">write_enable=YES</span><br><span class="line">dirmessage_enable=YES</span><br><span class="line">use_localtime=YES</span><br><span class="line">xferlog_enable=YES</span><br><span class="line">connect_from_port_20=YES</span><br><span class="line">xferlog_file=/var/log/vsftpd.log</span><br><span class="line">xferlog_std_format=YES</span><br><span class="line">ftpd_banner=Welcome to blah FTP service.</span><br><span class="line">local_root=/home/myftp</span><br><span class="line">chroot_local_user=YES</span><br><span class="line">chroot_list_enable=YES</span><br><span class="line">chroot_list_file=/etc/vsftpd.chroot_list</span><br><span class="line">secure_chroot_dir=/var/run/vsftpd/empty</span><br><span class="line">pam_service_name=myftp</span><br><span class="line">rsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem</span><br><span class="line">rsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼š</p><ul><li>local_root=/home/myftp     //è¯¥ç›®å½•ä¸ºä¹‹å‰åˆ›å»ºçš„ç”¨æˆ·ç›®å½•</li><li>pam_service_name=myftp   //é»˜è®¤ä¸ºvsftpdï¼Œéœ€è¦æ›´æ”¹ä¸ºåˆ›å»ºçš„ftpç”¨æˆ·å</li><li>åˆ›å»ºæ–‡ä»¶vsftpd.chroot_list</li><li>sudo vi /etc/vsftpd.chroot_list   å¹¶å°†ä¹‹å‰åˆ›å»ºçš„ç”¨æˆ·å(myftp)æ·»åŠ åˆ°è¯¥æ–‡ä»¶ä¸­ã€‚</li></ul><p>é‡æ–°å¯åŠ¨æœåŠ¡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl restart vsftpd</span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5fd0c9223e7d46a74c05bea17f930c28.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5fd0c9223e7d46a74c05bea17f930c28.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/fangye945a/article/details/85109404">https://blog.csdn.net/fangye945a/article/details/85109404</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxéƒ¨ç½²hexo</title>
      <link href="/2024/04/11/linux%E9%83%A8%E7%BD%B2hexo/"/>
      <url>/2024/04/11/linux%E9%83%A8%E7%BD%B2hexo/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="linuxéƒ¨ç½²hexo"><a href="#linuxéƒ¨ç½²hexo" class="headerlink" title="linuxéƒ¨ç½²hexo"></a>linuxéƒ¨ç½²hexo</h1><h2 id="ä¸€-å®‰è£…node-js"><a href="#ä¸€-å®‰è£…node-js" class="headerlink" title="ä¸€. å®‰è£…node.js"></a>ä¸€. å®‰è£…node.js</h2><h3 id="node-jsä¸‹è½½é“¾æ¥"><a href="#node-jsä¸‹è½½é“¾æ¥" class="headerlink" title="node.jsä¸‹è½½é“¾æ¥"></a>node.jsä¸‹è½½é“¾æ¥</h3><blockquote><p><a href="https://nodejs.org/dist/v16.13.1/node-v16.13.1-linux-x64.tar.xz">èµ„æºä¸‹è½½é“¾æ¥ | &gt;</a></p></blockquote><h2 id="äºŒ-é…ç½®node-js"><a href="#äºŒ-é…ç½®node-js" class="headerlink" title="äºŒ. é…ç½®node.js"></a>äºŒ. é…ç½®node.js</h2><p>node.jsä¸‹è½½å®Œæˆå</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /usr/local/node/</span><br><span class="line"><span class="built_in">cd</span> /usr/local/node/</span><br><span class="line">æ­¤æ—¶å°†å®‰è£…åŒ…ä¸Šä¼ åˆ°æ­¤ç›®å½•åè§£å‹</span><br><span class="line">rz </span><br><span class="line">tar -xvf node-v16.13.1-linux-x64.tar.xz</span><br></pre></td></tr></table></figure><p>é…ç½®ç¯å¢ƒå˜é‡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®ç¯å¢ƒå˜é‡ </span></span><br><span class="line">vim /etc/profile</span><br><span class="line"><span class="comment"># æ·»åŠ å¦‚ä¸‹</span></span><br><span class="line"><span class="comment"># Nodejs</span></span><br><span class="line"><span class="built_in">export</span> PATH=/usr/local/node/node-v16.13.1-linux-x64/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="built_in">source</span>  /etc/profile</span><br></pre></td></tr></table></figure><p>æ­¤æ—¶nodejså®‰è£…å®Œæˆã€‚</p><h2 id="ä¸‰-å®‰è£…cnpm"><a href="#ä¸‰-å®‰è£…cnpm" class="headerlink" title="ä¸‰. å®‰è£…cnpm"></a>ä¸‰. å®‰è£…cnpm</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¾“å…¥ä»¥ä¸‹å†…å®¹ï¼ŒéªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</span></span><br><span class="line"><span class="comment"># å®‰è£…ä¸€ä¸ªnpmçš„åŠ å¼ºç‰ˆ</span></span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line"><span class="comment"># è®¾ç½®ä»“åº“ä¸ºnpmä»“åº“</span></span><br><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmjs.org</span><br><span class="line"><span class="comment"># ç»­å®‰è£…å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œå› ä¸ºcpnmç‰ˆæœ¬å¤ªé«˜çš„åŸå› å¦‚æœå‡ºç°é—®é¢˜çš„å¯ä»¥å¸è½½è¿™ä¸ªæœ€æ–°ç‰ˆæœ¬å®‰è£…ä¸€ä¸ªæŒ‡å®šç‰ˆæœ¬</span></span><br><span class="line">çš„(npmæ˜¯ä»å›½å¤–æ‹‰åŒ… cnpmå›½å†…)</span><br><span class="line">npm uninstall -g cnpm</span><br><span class="line"><span class="comment"># å®‰è£…æŒ‡å®šç‰ˆæœ¬ï¼š7.1.0</span></span><br><span class="line">npm install cnpm@7.1.0 -g</span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">[root@localhost ~]<span class="comment"># npm -version</span></span><br><span class="line">8.1.2</span><br><span class="line">[root@localhost ~]<span class="comment"># npx -v</span></span><br><span class="line">8.1.2</span><br><span class="line">[root@localhost bin]<span class="comment"># npm version</span></span><br></pre></td></tr></table></figure><h2 id="å››-å®‰è£…hexo"><a href="#å››-å®‰è£…hexo" class="headerlink" title="å››. å®‰è£…hexo"></a>å››. å®‰è£…hexo</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ­¤æ—¶å†ä½¿ç”¨cnpmå®‰è£…nodejså³å¯</span></span><br><span class="line"><span class="comment"># å®‰è£…hexo</span></span><br><span class="line">cnpm install -g hexo-cli</span><br></pre></td></tr></table></figure><p>å¤‡æ³¨ï¼šå°†äº‹å…ˆåœ¨windowså‡†å¤‡å¥½çš„å®‰è£…åšå®¢å‹ç¼©åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨è§£å‹å† hexo clean &amp;&amp; hexo g &amp;&amp; hexo så³å¯ã€‚</p><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://blog.csdn.net/weixin_45561352/article/details/122109731">linuxæ­å»ºhexoä¸ªäººåšå®¢_linux hexoåšå®¢-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>fastgptå¯¹æ¥one-apiéƒ¨ç½²</title>
      <link href="/2024/04/09/fastgpt%E5%AF%B9%E6%8E%A5one-api%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/09/fastgpt%E5%AF%B9%E6%8E%A5one-api%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="fastgptå¯¹æ¥one-apiéƒ¨ç½²"><a href="#fastgptå¯¹æ¥one-apiéƒ¨ç½²" class="headerlink" title="fastgptå¯¹æ¥one-apiéƒ¨ç½²"></a>fastgptå¯¹æ¥one-apiéƒ¨ç½²</h1><blockquote><p>é»˜è®¤å¯†é’¥ï¼š<strong>root/1234</strong></p></blockquote><h2 id="one-apiéƒ¨ç½²"><a href="#one-apiéƒ¨ç½²" class="headerlink" title="one-apiéƒ¨ç½²"></a>one-apiéƒ¨ç½²</h2><blockquote><p><a href="http://sunlight.zznnwn.cloudns.biz/2024/04/09/one-api%E9%83%A8%E7%BD%B2/">éƒ¨ç½²é“¾æ¥ | &gt;</a></p></blockquote><h2 id="ä¸€-fastgptä½¿ç”¨docker-composeæ–¹å¼éƒ¨ç½²"><a href="#ä¸€-fastgptä½¿ç”¨docker-composeæ–¹å¼éƒ¨ç½²" class="headerlink" title="ä¸€ fastgptä½¿ç”¨docker-composeæ–¹å¼éƒ¨ç½²"></a>ä¸€ fastgptä½¿ç”¨docker-composeæ–¹å¼éƒ¨ç½²</h2><h3 id="é•œåƒå¯é€‰"><a href="#é•œåƒå¯é€‰" class="headerlink" title="é•œåƒå¯é€‰"></a>é•œåƒå¯é€‰</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:pgvector-v0.5.0</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:mongo5.0.18</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:fastgptv4.7</span><br></pre></td></tr></table></figure><h3 id="å®˜ç½‘éƒ¨ç½²æ–¹å¼ï¼š"><a href="#å®˜ç½‘éƒ¨ç½²æ–¹å¼ï¼š" class="headerlink" title="å®˜ç½‘éƒ¨ç½²æ–¹å¼ï¼š"></a>å®˜ç½‘éƒ¨ç½²æ–¹å¼ï¼š</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> fastgpt</span><br><span class="line"><span class="built_in">cd</span> fastgpt</span><br><span class="line">curl -O https://raw.githubusercontent.com/labring/FastGPT/main/files/deploy/fastgpt/docker-compose.yml</span><br><span class="line">curl -O https://raw.githubusercontent.com/labring/FastGPT/main/projects/app/data/config.json</span><br></pre></td></tr></table></figure><h2 id="äºŒ-æœ¬æ–‡éƒ¨ç½²"><a href="#äºŒ-æœ¬æ–‡éƒ¨ç½²" class="headerlink" title="äºŒ æœ¬æ–‡éƒ¨ç½²"></a>äºŒ æœ¬æ–‡éƒ¨ç½²</h2><blockquote><p>one-apiä¸fastgptåˆ†å¼€éƒ¨ç½² å…ˆéƒ¨ç½²one apiå†éƒ¨ç½²fastgptå³å¦‚ä¸‹</p></blockquote><h3 id="docker-compose-ymlæ–‡ä»¶"><a href="#docker-compose-ymlæ–‡ä»¶" class="headerlink" title="docker-compose.ymlæ–‡ä»¶"></a>docker-compose.ymlæ–‡ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®åº“çš„é»˜è®¤è´¦å·å’Œå¯†ç ä»…é¦–æ¬¡è¿è¡Œæ—¶è®¾ç½®æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment"># å¦‚æœä¿®æ”¹äº†è´¦å·å¯†ç ï¼Œè®°å¾—æ”¹æ•°æ®åº“å’Œé¡¹ç›®è¿æ¥å‚æ•°ï¼Œåˆ«åªæ”¹ä¸€å¤„~</span></span><br><span class="line"><span class="comment"># è¯¥é…ç½®æ–‡ä»¶åªæ˜¯ç»™å¿«é€Ÿå¯åŠ¨ï¼Œæµ‹è¯•ä½¿ç”¨ã€‚æ­£å¼ä½¿ç”¨ï¼Œè®°å¾—åŠ¡å¿…ä¿®æ”¹è´¦å·å¯†ç ï¼Œä»¥åŠè°ƒæ•´åˆé€‚çš„çŸ¥è¯†åº“å‚æ•°ï¼Œå…±äº«å†…å­˜ç­‰ã€‚</span></span><br><span class="line"></span><br><span class="line">version: <span class="string">&#x27;3.3&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  pg:</span><br><span class="line">    image: ankane/pgvector:v0.5.0 <span class="comment"># git</span></span><br><span class="line">    <span class="comment"># image: registry.cn-hangzhou.aliyuncs.com/fastgpt/pgvector:v0.5.0 # é˜¿é‡Œäº‘</span></span><br><span class="line">    container_name: pg</span><br><span class="line">    restart: always</span><br><span class="line">    ports: <span class="comment"># ç”Ÿäº§ç¯å¢ƒå»ºè®®ä¸è¦æš´éœ²</span></span><br><span class="line">      - 5432:5432</span><br><span class="line">    networks:</span><br><span class="line">      - fastgpt</span><br><span class="line">    environment:</span><br><span class="line">      <span class="comment"># è¿™é‡Œçš„é…ç½®åªæœ‰é¦–æ¬¡è¿è¡Œç”Ÿæ•ˆã€‚ä¿®æ”¹åï¼Œé‡å¯é•œåƒæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚éœ€è¦æŠŠæŒä¹…åŒ–æ•°æ®åˆ é™¤å†é‡å¯ï¼Œæ‰æœ‰æ•ˆæœ</span></span><br><span class="line">      - POSTGRES_USER=username</span><br><span class="line">      - POSTGRES_PASSWORD=password</span><br><span class="line">      - POSTGRES_DB=postgres</span><br><span class="line">    volumes:</span><br><span class="line">      - ./pg/data:/var/lib/postgresql/data</span><br><span class="line">  mongo:</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/fastgpt/mongo:5.0.18</span><br><span class="line">    container_name: mongo</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - 27017:27017</span><br><span class="line">    networks:</span><br><span class="line">      - fastgpt</span><br><span class="line">    <span class="built_in">command</span>: mongod --keyFile /data/mongodb.key --replSet rs0</span><br><span class="line">    environment:</span><br><span class="line">      - MONGO_INITDB_ROOT_USERNAME=myusername</span><br><span class="line">      - MONGO_INITDB_ROOT_PASSWORD=mypassword</span><br><span class="line">    volumes:</span><br><span class="line">      - ./mongo/data:/data/db</span><br><span class="line">    entrypoint:</span><br><span class="line">      - bash</span><br><span class="line">      - -c</span><br><span class="line">      - |</span><br><span class="line">        openssl rand -<span class="built_in">base64</span> 128 &gt; /data/mongodb.key</span><br><span class="line">        <span class="built_in">chmod</span> 400 /data/mongodb.key</span><br><span class="line">        <span class="built_in">chown</span> 999:999 /data/mongodb.key</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&#x27;const isInited = rs.status().ok === 1</span></span><br><span class="line"><span class="string">        if(!isInited)&#123;</span></span><br><span class="line"><span class="string">          rs.initiate(&#123;</span></span><br><span class="line"><span class="string">              _id: &quot;rs0&quot;,</span></span><br><span class="line"><span class="string">              members: [</span></span><br><span class="line"><span class="string">                  &#123; _id: 0, host: &quot;mongo:27017&quot; &#125;</span></span><br><span class="line"><span class="string">              ]</span></span><br><span class="line"><span class="string">          &#125;)</span></span><br><span class="line"><span class="string">        &#125;&#x27;</span> &gt; /data/initReplicaSet.js</span><br><span class="line">        <span class="comment"># å¯åŠ¨MongoDBæœåŠ¡</span></span><br><span class="line">        <span class="built_in">exec</span> docker-entrypoint.sh <span class="string">&quot;$<span class="variable">$@</span>&quot;</span> &amp;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç­‰å¾…MongoDBæœåŠ¡å¯åŠ¨</span></span><br><span class="line">        <span class="keyword">until</span> mongo -u myusername -p mypassword --authenticationDatabase admin --<span class="built_in">eval</span> <span class="string">&quot;print(&#x27;waited for connection&#x27;)&quot;</span> &gt; /dev/null 2&gt;&amp;1; <span class="keyword">do</span></span><br><span class="line">          <span class="built_in">echo</span> <span class="string">&quot;Waiting for MongoDB to start...&quot;</span></span><br><span class="line">          <span class="built_in">sleep</span> 2</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‰§è¡Œåˆå§‹åŒ–å‰¯æœ¬é›†çš„è„šæœ¬</span></span><br><span class="line">        mongo -u myusername -p mypassword --authenticationDatabase admin /data/initReplicaSet.js</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç­‰å¾…docker-entrypoint.shè„šæœ¬æ‰§è¡Œçš„MongoDBæœåŠ¡è¿›ç¨‹</span></span><br><span class="line">        <span class="built_in">wait</span> $$!</span><br><span class="line">  fastgpt:</span><br><span class="line">    container_name: fastgpt</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:v4.7 <span class="comment"># git</span></span><br><span class="line">    <span class="comment"># image: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:v4.7 # é˜¿é‡Œäº‘</span></span><br><span class="line">    ports:</span><br><span class="line">      - 30001:3000</span><br><span class="line">    networks:</span><br><span class="line">      - fastgpt</span><br><span class="line">    depends_on:</span><br><span class="line">      - mongo</span><br><span class="line">      - pg</span><br><span class="line">    restart: always</span><br><span class="line">    environment:</span><br><span class="line">      <span class="comment"># root å¯†ç ï¼Œç”¨æˆ·åä¸º: rootã€‚å¦‚æœéœ€è¦ä¿®æ”¹ root å¯†ç ï¼Œç›´æ¥ä¿®æ”¹è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œå¹¶é‡å¯å³å¯ã€‚</span></span><br><span class="line">      - DEFAULT_ROOT_PSW=1234</span><br><span class="line">      <span class="comment"># AIæ¨¡å‹çš„APIåœ°å€å“¦ã€‚åŠ¡å¿…åŠ  /v1ã€‚è¿™é‡Œé»˜è®¤å¡«å†™äº†OneApiçš„è®¿é—®åœ°å€ã€‚</span></span><br><span class="line">      - OPENAI_BASE_URL=http://10.0.0.10:3000/v1                     <span class="comment">#(æ­¤åœ°å€ä¸ºoneapiåœ°å€+/v1)</span></span><br><span class="line">      <span class="comment"># AIæ¨¡å‹çš„API Keyã€‚ï¼ˆè¿™é‡Œé»˜è®¤å¡«å†™äº†OneAPIçš„å¿«é€Ÿé»˜è®¤keyï¼Œæµ‹è¯•é€šåï¼ŒåŠ¡å¿…åŠæ—¶ä¿®æ”¹ï¼‰</span></span><br><span class="line">      - CHAT_API_KEY=sk-z02Gt0o6cWhTS6cbFfbgbggb9d42cF622Bc5e5c471a  <span class="comment">#(æ­¤keyä¸ºone-apiç”Ÿæˆçš„ä»¤ç‰Œ)</span></span><br><span class="line">      <span class="comment"># æ•°æ®åº“æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">      - DB_MAX_LINK=30</span><br><span class="line">      <span class="comment"># ç™»å½•å‡­è¯å¯†é’¥</span></span><br><span class="line">      - TOKEN_KEY=any</span><br><span class="line">      <span class="comment"># rootçš„å¯†é’¥ï¼Œå¸¸ç”¨äºå‡çº§æ—¶å€™çš„åˆå§‹åŒ–è¯·æ±‚</span></span><br><span class="line">      - ROOT_KEY=root_key</span><br><span class="line">      <span class="comment"># æ–‡ä»¶é˜…è¯»åŠ å¯†</span></span><br><span class="line">      - FILE_TOKEN_KEY=filetoken</span><br><span class="line">      <span class="comment"># MongoDB è¿æ¥å‚æ•°. ç”¨æˆ·åmyusername,å¯†ç mypasswordã€‚</span></span><br><span class="line">      - MONGODB_URI=mongodb://myusername:mypassword@mongo:27017/fastgpt?authSource=admin</span><br><span class="line">      <span class="comment"># pg è¿æ¥å‚æ•°</span></span><br><span class="line">      - PG_URL=postgresql://username:password@pg:5432/postgres</span><br><span class="line">    volumes:</span><br><span class="line">      - ./config.json:/app/data/config.json</span><br><span class="line">      - ./fastgpt/tmp:/app/tmp</span><br><span class="line">  <span class="comment"># mysql:</span></span><br><span class="line">  <span class="comment">#   image: mysql:8.0.36</span></span><br><span class="line">  <span class="comment">#   container_name: mysql</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#   ports:</span></span><br><span class="line">  <span class="comment">#     - 3306:3306</span></span><br><span class="line">  <span class="comment">#   networks:</span></span><br><span class="line">  <span class="comment">#     - fastgpt</span></span><br><span class="line">  <span class="comment">#   command: --default-authentication-plugin=mysql_native_password</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     # é»˜è®¤rootå¯†ç ï¼Œä»…é¦–æ¬¡è¿è¡Œæœ‰æ•ˆ</span></span><br><span class="line">  <span class="comment">#     MYSQL_ROOT_PASSWORD: oneapimmysql</span></span><br><span class="line">  <span class="comment">#     MYSQL_DATABASE: oneapi</span></span><br><span class="line">  <span class="comment">#   volumes:</span></span><br><span class="line">  <span class="comment">#     - ./mysql:/var/lib/mysql</span></span><br><span class="line">  <span class="comment"># oneapi:</span></span><br><span class="line">  <span class="comment">#   container_name: oneapi</span></span><br><span class="line">  <span class="comment">#   image: ghcr.io/songquanpeng/one-api:latest</span></span><br><span class="line">  <span class="comment">#   ports:</span></span><br><span class="line">  <span class="comment">#     - 3001:3000</span></span><br><span class="line">  <span class="comment">#   depends_on:</span></span><br><span class="line">  <span class="comment">#     - mysql</span></span><br><span class="line">  <span class="comment">#   networks:</span></span><br><span class="line">  <span class="comment">#     - fastgpt</span></span><br><span class="line">  <span class="comment">#   restart: always</span></span><br><span class="line">  <span class="comment">#   environment:</span></span><br><span class="line">  <span class="comment">#     # mysql è¿æ¥å‚æ•°</span></span><br><span class="line">  <span class="comment">#     - SQL_DSN=root:oneapimmysql@tcp(mysql:3306)/oneapi</span></span><br><span class="line">  <span class="comment">#     # ç™»å½•å‡­è¯åŠ å¯†å¯†é’¥</span></span><br><span class="line">  <span class="comment">#     - SESSION_SECRET=oneapikey</span></span><br><span class="line">  <span class="comment">#     # å†…å­˜ç¼“å­˜</span></span><br><span class="line">  <span class="comment">#     - MEMORY_CACHE_ENABLED=true</span></span><br><span class="line">  <span class="comment">#     # å¯åŠ¨èšåˆæ›´æ–°ï¼Œå‡å°‘æ•°æ®äº¤äº’é¢‘ç‡</span></span><br><span class="line">  <span class="comment">#     - BATCH_UPDATE_ENABLED=true</span></span><br><span class="line">  <span class="comment">#     # èšåˆæ›´æ–°æ—¶é•¿</span></span><br><span class="line">  <span class="comment">#     - BATCH_UPDATE_INTERVAL=10</span></span><br><span class="line">  <span class="comment">#     # åˆå§‹åŒ–çš„ root å¯†é’¥ï¼ˆå»ºè®®éƒ¨ç½²å®Œåæ›´æ”¹ï¼Œå¦åˆ™å®¹æ˜“æ³„éœ²ï¼‰</span></span><br><span class="line">  <span class="comment">#     - INITIAL_ROOT_TOKEN=fastgpt</span></span><br><span class="line">  <span class="comment">#   volumes:</span></span><br><span class="line">  <span class="comment">#     - ./oneapi:/data</span></span><br><span class="line">networks:</span><br><span class="line">  fastgpt:</span><br></pre></td></tr></table></figure><h4 id="é€šä¹‰åƒæ–‡ç‰ˆconfig-jsoné…ç½®"><a href="#é€šä¹‰åƒæ–‡ç‰ˆconfig-jsoné…ç½®" class="headerlink" title="é€šä¹‰åƒæ–‡ç‰ˆconfig.jsoné…ç½®"></a>é€šä¹‰åƒæ–‡ç‰ˆconfig.jsoné…ç½®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;feConfigs&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;lafEnv&quot;</span>: <span class="string">&quot;https://laf.dev&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;systemEnv&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;openapiPrefix&quot;</span>: <span class="string">&quot;fastgpt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vectorMaxProcess&quot;</span>: 15,</span><br><span class="line">    <span class="string">&quot;qaMaxProcess&quot;</span>: 15,</span><br><span class="line">    <span class="string">&quot;pgHNSWEfSearch&quot;</span>: 100</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;llmModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-turbo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;é€šä¹‰åƒé—®&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 16000,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 13000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-plus&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;qwen-plus&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 125000,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 100000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-max&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;qwen-max&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 128000,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 100000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;vectorModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-max-longcontext&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;qwen-max-longcontext&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;defaultToken&quot;</span>: 512,</span><br><span class="line">      <span class="string">&quot;maxToken&quot;</span>: 3000,</span><br><span class="line">      <span class="string">&quot;weight&quot;</span>: 100,</span><br><span class="line">      <span class="string">&quot;dbConfig&quot;</span>: &#123;&#125;,</span><br><span class="line">      <span class="string">&quot;queryConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;reRankModels&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;audioSpeechModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;qwen-1.8b-chat&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;qwen-1.8b-chat&quot;</span>,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;voices&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Alloy&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;alloy&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Alloy&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Echo&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;echo&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Echo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Fable&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;fable&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Fable&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Onyx&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;onyx&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Onyx&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Nova&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;nova&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Nova&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Shimmer&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;shimmer&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Shimmer&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;whisperModel&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;model&quot;</span>: <span class="string">&quot;whisper-1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Whisper1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;charsPointsPrice&quot;</span>: 0</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="chatgptç‰ˆconfigé…ç½®"><a href="#chatgptç‰ˆconfigé…ç½®" class="headerlink" title="chatgptç‰ˆconfigé…ç½®"></a>chatgptç‰ˆconfigé…ç½®</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;feConfigs&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;lafEnv&quot;</span>: <span class="string">&quot;https://laf.dev&quot;</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;systemEnv&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;openapiPrefix&quot;</span>: <span class="string">&quot;fastgpt&quot;</span>,</span><br><span class="line">    <span class="string">&quot;vectorMaxProcess&quot;</span>: 15,</span><br><span class="line">    <span class="string">&quot;qaMaxProcess&quot;</span>: 15,</span><br><span class="line">    <span class="string">&quot;pgHNSWEfSearch&quot;</span>: 100</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;llmModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;gpt-3.5-turbo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 16000,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 13000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;gpt-4-0125-preview&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;gpt-4-turbo&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 125000,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 100000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;gpt-4-vision-preview&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;gpt-4-vision&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;maxContext&quot;</span>: 128000,</span><br><span class="line">      <span class="string">&quot;maxResponse&quot;</span>: 4000,</span><br><span class="line">      <span class="string">&quot;quoteMaxToken&quot;</span>: 100000,</span><br><span class="line">      <span class="string">&quot;maxTemperature&quot;</span>: 1.2,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;censor&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;vision&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;datasetProcess&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInClassify&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInExtractFields&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInToolCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;usedInQueryExtension&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;toolChoice&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">      <span class="string">&quot;functionCall&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">      <span class="string">&quot;customCQPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;customExtractPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultSystemChatPrompt&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">      <span class="string">&quot;defaultConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;vectorModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;text-embedding-ada-002&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Embedding-2&quot;</span>,</span><br><span class="line">      <span class="string">&quot;avatar&quot;</span>: <span class="string">&quot;/imgs/model/openai.svg&quot;</span>,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;defaultToken&quot;</span>: 512,</span><br><span class="line">      <span class="string">&quot;maxToken&quot;</span>: 3000,</span><br><span class="line">      <span class="string">&quot;weight&quot;</span>: 100,</span><br><span class="line">      <span class="string">&quot;dbConfig&quot;</span>: &#123;&#125;,</span><br><span class="line">      <span class="string">&quot;queryConfig&quot;</span>: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;reRankModels&quot;</span>: [],</span><br><span class="line">  <span class="string">&quot;audioSpeechModels&quot;</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;model&quot;</span>: <span class="string">&quot;tts-1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;name&quot;</span>: <span class="string">&quot;OpenAI TTS1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;charsPointsPrice&quot;</span>: 0,</span><br><span class="line">      <span class="string">&quot;voices&quot;</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Alloy&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;alloy&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Alloy&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Echo&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;echo&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Echo&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Fable&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;fable&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Fable&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Onyx&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;onyx&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Onyx&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Nova&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;nova&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Nova&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;label&quot;</span>: <span class="string">&quot;Shimmer&quot;</span>,</span><br><span class="line">          <span class="string">&quot;value&quot;</span>: <span class="string">&quot;shimmer&quot;</span>,</span><br><span class="line">          <span class="string">&quot;bufferId&quot;</span>: <span class="string">&quot;openai-Shimmer&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">&quot;whisperModel&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;model&quot;</span>: <span class="string">&quot;whisper-1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;Whisper1&quot;</span>,</span><br><span class="line">    <span class="string">&quot;charsPointsPrice&quot;</span>: 0</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="fastgptå¯åŠ¨"><a href="#fastgptå¯åŠ¨" class="headerlink" title="fastgptå¯åŠ¨"></a>fastgptå¯åŠ¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-æ‰©å±•"><a href="#ä¸‰-æ‰©å±•" class="headerlink" title="ä¸‰ æ‰©å±•"></a>ä¸‰ æ‰©å±•</h3><h4 id="one-apiä¸fastgptåœ¨ä¸€ä¸ªéƒ¨ç½²æ–‡ä»¶ä¸­é›†æˆï¼ˆæ¨èä½¿ç”¨æ­¤ç§ï¼‰"><a href="#one-apiä¸fastgptåœ¨ä¸€ä¸ªéƒ¨ç½²æ–‡ä»¶ä¸­é›†æˆï¼ˆæ¨èä½¿ç”¨æ­¤ç§ï¼‰" class="headerlink" title="one-apiä¸fastgptåœ¨ä¸€ä¸ªéƒ¨ç½²æ–‡ä»¶ä¸­é›†æˆï¼ˆæ¨èä½¿ç”¨æ­¤ç§ï¼‰"></a>one-apiä¸fastgptåœ¨ä¸€ä¸ªéƒ¨ç½²æ–‡ä»¶ä¸­é›†æˆï¼ˆæ¨èä½¿ç”¨æ­¤ç§ï¼‰</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3.3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">pg:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">ankane/pgvector:v0.5.0</span> <span class="comment"># git</span></span><br><span class="line">    <span class="comment"># image: registry.cn-hangzhou.aliyuncs.com/fastgpt/pgvector:v0.5.0 # é˜¿é‡Œäº‘</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">pg</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span> <span class="comment"># ç”Ÿäº§ç¯å¢ƒå»ºè®®ä¸è¦æš´éœ²</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">5432</span><span class="string">:5432</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fastgpt</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="comment"># è¿™é‡Œçš„é…ç½®åªæœ‰é¦–æ¬¡è¿è¡Œç”Ÿæ•ˆã€‚ä¿®æ”¹åï¼Œé‡å¯é•œåƒæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ã€‚éœ€è¦æŠŠæŒä¹…åŒ–æ•°æ®åˆ é™¤å†é‡å¯ï¼Œæ‰æœ‰æ•ˆæœ</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_USER=username</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_PASSWORD=password</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">POSTGRES_DB=postgres</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./pg/data:/var/lib/postgresql/data</span></span><br><span class="line">  <span class="attr">mongo:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/fastgpt/mongo:5.0.18</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">mongo</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">27017</span><span class="string">:27017</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fastgpt</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">mongod</span> <span class="string">--keyFile</span> <span class="string">/data/mongodb.key</span> <span class="string">--replSet</span> <span class="string">rs0</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MONGO_INITDB_ROOT_USERNAME=myusername</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MONGO_INITDB_ROOT_PASSWORD=mypassword</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./mongo/data:/data/db</span></span><br><span class="line">    <span class="attr">entrypoint:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">bash</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">-c</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">|</span></span><br><span class="line"><span class="string">        openssl rand -base64 128 &gt; /data/mongodb.key</span></span><br><span class="line"><span class="string">        chmod 400 /data/mongodb.key</span></span><br><span class="line"><span class="string">        chown 999:999 /data/mongodb.key</span></span><br><span class="line"><span class="string">        echo &#x27;const isInited = rs.status().ok === 1</span></span><br><span class="line"><span class="string">        if(!isInited)&#123;</span></span><br><span class="line"><span class="string">          rs.initiate(&#123;</span></span><br><span class="line"><span class="string">              _id: &quot;rs0&quot;,</span></span><br><span class="line"><span class="string">              members: [</span></span><br><span class="line"><span class="string">                  &#123; _id: 0, host: &quot;mongo:27017&quot; &#125;</span></span><br><span class="line"><span class="string">              ]</span></span><br><span class="line"><span class="string">          &#125;)</span></span><br><span class="line"><span class="string">        &#125;&#x27; &gt; /data/initReplicaSet.js</span></span><br><span class="line"><span class="string">        # å¯åŠ¨MongoDBæœåŠ¡</span></span><br><span class="line"><span class="string">        exec docker-entrypoint.sh &quot;$$@&quot; &amp;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">        <span class="comment"># ç­‰å¾…MongoDBæœåŠ¡å¯åŠ¨</span></span><br><span class="line">        <span class="string">until</span> <span class="string">mongo</span> <span class="string">-u</span> <span class="string">myusername</span> <span class="string">-p</span> <span class="string">mypassword</span> <span class="string">--authenticationDatabase</span> <span class="string">admin</span> <span class="string">--eval</span> <span class="string">&quot;print(&#x27;waited for connection&#x27;)&quot;</span> <span class="string">&gt;</span> <span class="string">/dev/null</span> <span class="number">2</span><span class="string">&gt;&amp;1;</span> <span class="string">do</span></span><br><span class="line">          <span class="string">echo</span> <span class="string">&quot;Waiting for MongoDB to start...&quot;</span></span><br><span class="line">          <span class="string">sleep</span> <span class="number">2</span></span><br><span class="line">        <span class="string">done</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># æ‰§è¡Œåˆå§‹åŒ–å‰¯æœ¬é›†çš„è„šæœ¬</span></span><br><span class="line">        <span class="string">mongo</span> <span class="string">-u</span> <span class="string">myusername</span> <span class="string">-p</span> <span class="string">mypassword</span> <span class="string">--authenticationDatabase</span> <span class="string">admin</span> <span class="string">/data/initReplicaSet.js</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç­‰å¾…docker-entrypoint.shè„šæœ¬æ‰§è¡Œçš„MongoDBæœåŠ¡è¿›ç¨‹</span></span><br><span class="line">        <span class="string">wait</span> <span class="string">$$!</span></span><br><span class="line">  <span class="attr">fastgpt:</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">fastgpt</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:v4.7</span> <span class="comment"># git</span></span><br><span class="line">    <span class="comment"># image: registry.cn-hangzhou.aliyuncs.com/fastgpt/fastgpt:v4.7 # é˜¿é‡Œäº‘</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="number">30001</span><span class="string">:3000</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fastgpt</span></span><br><span class="line">    <span class="attr">depends_on:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">mongo</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">pg</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="comment"># root å¯†ç ï¼Œç”¨æˆ·åä¸º: rootã€‚å¦‚æœéœ€è¦ä¿®æ”¹ root å¯†ç ï¼Œç›´æ¥ä¿®æ”¹è¿™ä¸ªç¯å¢ƒå˜é‡ï¼Œå¹¶é‡å¯å³å¯ã€‚</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DEFAULT_ROOT_PSW=1234</span></span><br><span class="line">      <span class="comment"># AIæ¨¡å‹çš„APIåœ°å€å“¦ã€‚åŠ¡å¿…åŠ  /v1ã€‚è¿™é‡Œé»˜è®¤å¡«å†™äº†OneApiçš„è®¿é—®åœ°å€ã€‚</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">OPENAI_BASE_URL=http://one-api:3000/v1</span>                     <span class="comment">#(æ­¤åœ°å€ä¸ºoneapiåœ°å€+/v1)</span></span><br><span class="line">      <span class="comment"># AIæ¨¡å‹çš„API Keyã€‚ï¼ˆè¿™é‡Œé»˜è®¤å¡«å†™äº†OneAPIçš„å¿«é€Ÿé»˜è®¤keyï¼Œæµ‹è¯•é€šåï¼ŒåŠ¡å¿…åŠæ—¶ä¿®æ”¹ï¼‰</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CHAT_API_KEY=sk-74E561</span>  <span class="comment">#(æ­¤keyä¸ºone-apiç”Ÿæˆçš„ä»¤ç‰Œ)</span></span><br><span class="line">      <span class="comment"># æ•°æ®åº“æœ€å¤§è¿æ¥æ•°</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">DB_MAX_LINK=30</span></span><br><span class="line">      <span class="comment"># ç™»å½•å‡­è¯å¯†é’¥</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TOKEN_KEY=any</span></span><br><span class="line">      <span class="comment"># rootçš„å¯†é’¥ï¼Œå¸¸ç”¨äºå‡çº§æ—¶å€™çš„åˆå§‹åŒ–è¯·æ±‚</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">ROOT_KEY=root_key</span></span><br><span class="line">      <span class="comment"># æ–‡ä»¶é˜…è¯»åŠ å¯†</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">FILE_TOKEN_KEY=filetoken</span></span><br><span class="line">      <span class="comment"># MongoDB è¿æ¥å‚æ•°. ç”¨æˆ·åmyusername,å¯†ç mypasswordã€‚</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">MONGODB_URI=mongodb://myusername:mypassword@mongo:27017/fastgpt?authSource=admin</span></span><br><span class="line">      <span class="comment"># pg è¿æ¥å‚æ•°</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PG_URL=postgresql://username:password@pg:5432/postgres</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./config.json:/app/data/config.json</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./fastgpt/tmp:/app/tmp</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">one-api:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:one-api-latest</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">one-api</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">TZ=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./one-api:/data</span></span><br><span class="line">    <span class="attr">networks:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">fastgpt</span></span><br><span class="line"></span><br><span class="line"><span class="attr">networks:</span></span><br><span class="line">  <span class="attr">fastgpt:</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="fastgptæ›´æ¢logo"><a href="#fastgptæ›´æ¢logo" class="headerlink" title="fastgptæ›´æ¢logo"></a>fastgptæ›´æ¢logo</h4><p>[å…¶ä»–logoæ›´æ¢å‚è€ƒ | &gt; (<a href="https://doc.fastai.site/docs/development/configuration/">é…ç½®æ–‡ä»¶ä»‹ç» | FastGPT (fastai.site)</a>)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">cp</span> ./logo.svg fastgpt:/app/projects/app/public/icon</span><br><span class="line">docker <span class="built_in">cp</span> ./favicon.ico fastgpt:/app/projects/app/public/</span><br></pre></td></tr></table></figure><h2 id="å››-æ•ˆæœ"><a href="#å››-æ•ˆæœ" class="headerlink" title="å›› æ•ˆæœ"></a>å›› æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_3390fff9c5b4e790c31ef176e89a5c27.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_3390fff9c5b4e790c31ef176e89a5c27.png"></p><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://doc.fastai.site/docs/development/docker/">å®˜ç½‘</a></p><p><a href="https://blog.csdn.net/m0_62536353/article/details/135733446">ä¿å§†çº§æ•™ç¨‹ï¼šFastGPTæ„å»ºä¸ªäººæœ¬åœ°çŸ¥è¯†åº“(Docker composeå¿«é€Ÿéƒ¨ç½²)_fastgptæœ¬åœ°éƒ¨ç½²-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>one-apiéƒ¨ç½²</title>
      <link href="/2024/04/09/one-api%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/09/one-api%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="one-apiéƒ¨ç½²"><a href="#one-apiéƒ¨ç½²" class="headerlink" title="one-apiéƒ¨ç½²"></a>one-apiéƒ¨ç½²</h1><blockquote><p>è°ƒç”¨çš„æ¥å£æ˜¯å›½å¤–çš„ä¾‹å¦‚chatgptæ—¶éœ€è¦é…ç½®ä»£ç†æˆ–è€…ä½¿ç”¨å›½å¤–æœåŠ¡å™¨</p><p>åˆå§‹å¯†ç ï¼šroot/123456</p></blockquote><h2 id="ä½¿ç”¨docker-composeéƒ¨ç½²"><a href="#ä½¿ç”¨docker-composeéƒ¨ç½²" class="headerlink" title="ä½¿ç”¨docker-composeéƒ¨ç½²"></a>ä½¿ç”¨docker-composeéƒ¨ç½²</h2><h3 id="é•œåƒå¯é€‰"><a href="#é•œåƒå¯é€‰" class="headerlink" title="é•œåƒå¯é€‰"></a>é•œåƒå¯é€‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">justsong/one-api:latest </span><br><span class="line">image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:one-api-latest</span><br></pre></td></tr></table></figure><h3 id="dockeræ–¹å¼"><a href="#dockeræ–¹å¼" class="headerlink" title="dockeræ–¹å¼"></a>dockeræ–¹å¼</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨ SQLite çš„éƒ¨ç½²å‘½ä»¤ï¼š</span></span><br><span class="line">docker run --name one-api -d --restart always -p 3000:3000 -e TZ=Asia/Shanghai -v /home/ubuntu/data/one-api:/data justsong/one-api</span><br><span class="line"><span class="comment"># ä½¿ç”¨ MySQL çš„éƒ¨ç½²å‘½ä»¤ï¼Œåœ¨ä¸Šé¢çš„åŸºç¡€ä¸Šæ·»åŠ  `-e SQL_DSN=&quot;root:123456@tcp(localhost:3306)/oneapi&quot;`ï¼Œè¯·è‡ªè¡Œä¿®æ”¹æ•°æ®åº“è¿æ¥å‚æ•°ï¼Œä¸æ¸…æ¥šå¦‚ä½•ä¿®æ”¹è¯·å‚è§ä¸‹é¢ç¯å¢ƒå˜é‡ä¸€èŠ‚ã€‚</span></span><br><span class="line"><span class="comment"># ä¾‹å¦‚ï¼š</span></span><br><span class="line">docker run --name one-api -d --restart always -p 3000:3000 -e SQL_DSN=<span class="string">&quot;root:123456@tcp(localhost:3306)/oneapi&quot;</span> -e TZ=Asia/Shanghai -v /home/ubuntu/data/one-api:/data justsong/one-api</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="docker-composeæ–¹å¼"><a href="#docker-composeæ–¹å¼" class="headerlink" title="docker-composeæ–¹å¼"></a>docker-composeæ–¹å¼</h2><p>ä½¿ç”¨mysqlä½œä¸ºæ•°æ®åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  one-api:</span><br><span class="line">    container_name: one-api</span><br><span class="line">    image: justsong/one-api</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">    environment:</span><br><span class="line">      - SQL_DSN=root:123456@tcp(localhost:3306)/oneapi</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - ./one-api:/data</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨SQliteä½œä¸ºæ•°æ®åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">version: <span class="string">&#x27;3.8&#x27;</span></span><br><span class="line"></span><br><span class="line">services:</span><br><span class="line">  one-api:</span><br><span class="line">    image: registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:one-api-latest</span><br><span class="line">    container_name: one-api</span><br><span class="line">    restart: always</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;3000:3000&quot;</span></span><br><span class="line">    environment:</span><br><span class="line">      - TZ=Asia/Shanghai</span><br><span class="line">    volumes:</span><br><span class="line">      - ./one-api:/data</span><br></pre></td></tr></table></figure><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_a09a324c0e01b3dc1c96ba17b2b32f1b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_a09a324c0e01b3dc1c96ba17b2b32f1b.png"></p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><blockquote><p><a href="%5Bhttps://doc.fastai.site/docs/development/one-api/%5D(https://doc.fastai.site/docs/development/one-api/)">è§é“¾æ¥ | &gt;&gt;</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_f34a8621031f3fc757073165acc4903d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_f34a8621031f3fc757073165acc4903d.png"></p><p><strong>å¯¹æ¥chat-next-webåªéœ€è¦å¡«å†™å¦‚ä¸‹å³å¯</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_41dd190facdda36a483473f4b9721848.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_41dd190facdda36a483473f4b9721848.png"></p></blockquote><h2 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h2><p><a href="https://cloud.sealos.io/">ä½¿ç”¨sealosä¸€é”®éƒ¨ç½²å’Œä½¿ç”¨oneapiï¼ˆç›¸å¯¹ç®€å•ç•¥ï¼‰</a></p><p><a href="%5Bhttps://github.com/GEGEWU-CLOUD/one-api%5D(https://github.com/GEGEWU-CLOUD/one-api)">ä½¿ç”¨dockeréƒ¨ç½²</a></p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntué…ç½®ç½‘å¡bondç‰ˆ openstackéƒ¨ç½²</title>
      <link href="/2024/04/02/ubuntu%E9%85%8D%E7%BD%AE%E7%BD%91%E5%8D%A1bond%E7%89%88%20openstack%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/04/02/ubuntu%E9%85%8D%E7%BD%AE%E7%BD%91%E5%8D%A1bond%E7%89%88%20openstack%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ubuntué…ç½®ç½‘å¡bondç‰ˆ-openstackéƒ¨ç½²"><a href="#ubuntué…ç½®ç½‘å¡bondç‰ˆ-openstackéƒ¨ç½²" class="headerlink" title="ubuntué…ç½®ç½‘å¡bondç‰ˆ openstackéƒ¨ç½²"></a>ubuntué…ç½®ç½‘å¡bondç‰ˆ openstackéƒ¨ç½²</h1><blockquote><p>ç¯å¢ƒï¼š8C24G windows10å®¶åº­ç‰ˆ workstdtion17 pro ubuntu20.04</p><p><del>ç”±äºç”µè„‘æ€§èƒ½åŸå› æ­¤æ¬¡ä½¿ç”¨å•èŠ‚ç‚¹æµ‹è¯•</del></p></blockquote><h2 id="ä¸€-ubuntuç½‘å¡bondé…ç½®"><a href="#ä¸€-ubuntuç½‘å¡bondé…ç½®" class="headerlink" title="ä¸€. ubuntuç½‘å¡bondé…ç½®"></a>ä¸€. ubuntuç½‘å¡bondé…ç½®</h2><p>è§é“¾æ¥ | ï¼š<a href="http://sunlight.zznnwn.cloudns.biz/2024/04/02/workstdtion%E6%A8%A1%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%88%92%E5%88%86vlan%E5%8F%8A%E7%BD%91%E5%8D%A1bond%E8%AE%BE%E7%BD%AE">workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlanåŠç½‘å¡bondè®¾ç½®</a></p><h2 id="äºŒ-ä¸¤æˆ–å•å‰¯æœ¬cephéƒ¨ç½²"><a href="#äºŒ-ä¸¤æˆ–å•å‰¯æœ¬cephéƒ¨ç½²" class="headerlink" title="äºŒ. ä¸¤æˆ–å•å‰¯æœ¬cephéƒ¨ç½²"></a>äºŒ. ä¸¤æˆ–å•å‰¯æœ¬cephéƒ¨ç½²</h2><p>è„šæœ¬éƒ¨ç½²æ–¹å¼è§é“¾æ¥ | ï¼š<a href="https://gegewu-cloud.github.io/2023/09/24/ceph%E9%9B%86%E7%BE%A4%E4%B9%8Bcephadm%E6%B8%85%E7%90%86ceph%E9%9B%86%E7%BE%A4/">cephä¸€é”®éƒ¨ç½²</a></p><p>å¤‡æ³¨<strong>ceph</strong>ç½‘ç»œé€‰æ‹©ï¼š â€“mon-ip  <del>10.56.60.11</del>  â€“cluster-network <del>10.56.50.0/24</del>  â€“allow-overwrite</p><h2 id="ä¸‰-ä¸¤æˆ–å•å‰¯æœ¬openstackéƒ¨ç½²"><a href="#ä¸‰-ä¸¤æˆ–å•å‰¯æœ¬openstackéƒ¨ç½²" class="headerlink" title="ä¸‰. ä¸¤æˆ–å•å‰¯æœ¬openstackéƒ¨ç½²"></a>ä¸‰. ä¸¤æˆ–å•å‰¯æœ¬openstackéƒ¨ç½²</h2><h3 id="1-global-ymlæ–‡ä»¶é…ç½®-ç½‘ç»œä¸ä¸€ä¸­ä¿æŒä¸€è‡´"><a href="#1-global-ymlæ–‡ä»¶é…ç½®-ç½‘ç»œä¸ä¸€ä¸­ä¿æŒä¸€è‡´" class="headerlink" title="1. global.ymlæ–‡ä»¶é…ç½® ç½‘ç»œä¸ä¸€ä¸­ä¿æŒä¸€è‡´"></a>1. global.ymlæ–‡ä»¶é…ç½® ç½‘ç»œä¸ä¸€ä¸­ä¿æŒä¸€è‡´</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -------------------&lt;&lt;åˆ†å‰²çº¿&gt;&gt;------------------------</span></span><br><span class="line"><span class="comment"># kolla-ansible global.ymlé…ç½®</span></span><br><span class="line">kolla_base_distro: <span class="string">&quot;ubuntu&quot;</span></span><br><span class="line">kolla_install_type: <span class="string">&quot;source&quot;</span></span><br><span class="line">openstack_release: <span class="string">&quot;zznnyoga&quot;</span></span><br><span class="line">nova_compute_virt_type: <span class="string">&quot;qemu&quot;</span></span><br><span class="line">node_custom_config: <span class="string">&quot;/etc/kolla/config&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é…ç½®ç§æœ‰é˜¿é‡Œäº‘ä»“åº“</span></span><br><span class="line">docker_registry: <span class="string">&quot;registry.cn-hangzhou.aliyuncs.com&quot;</span>     <span class="comment"># æ‹‰å– docker é•œåƒçš„æº</span></span><br><span class="line">docker_namespace: <span class="string">&quot;zznn&quot;</span>                                 <span class="comment"># docker registry é¡¹ç›®å</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤–éƒ¨cephé…ç½® ï¼ˆ workstdtion ens33 natæ¨¡å¼ ï¼‰</span></span><br><span class="line">swift_storage_interface: <span class="string">&quot;vlan60&quot;</span>             <span class="comment"># ceph å­˜å‚¨ç½‘ç»œçš„æ¥å£ (ceph public network æ‰€åœ¨æ¥å£)</span></span><br><span class="line"><span class="comment"># external_ceph_pool_pgs: 16                  # (hdd osd ä¸ªæ•°) * 3 çš„å€¼æœ€æ¥è¿‘ 2^n çš„æ•°, ä¾‹å¦‚ hdd osd ä¸ªæ•°ä¸º 12, åˆ™ external_ceph_pool_pgs å– 32</span></span><br><span class="line"><span class="comment"># external_ceph_ssd_pool_pgs: 32              # (ssd osd ä¸ªæ•°) * 3 çš„å€¼æœ€æ¥è¿‘ 2^n çš„æ•°, å¦‚æœæ²¡æœ‰ ssd, åˆ™å¯å¿½ç•¥è¯¥é…ç½®</span></span><br><span class="line">failed_swap_on: <span class="string">&quot;yes&quot;</span>                        <span class="comment"># é»˜è®¤ç¦æ­¢å¼€å¯ swap</span></span><br><span class="line">enable_external_ceph: <span class="string">&quot;yes&quot;</span>                  <span class="comment"># å¼€å¯å¤–éƒ¨ceph</span></span><br><span class="line">external_ceph_admin_permission: <span class="string">&quot;yes&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># openstackå†…éƒ¨æ¥å£é…ç½® ï¼ˆens33 natæ¨¡å¼ ens37 ä¸»æœºæ¨¡å¼ï¼ˆ å…¶å®æ­¤å¤„ens37åº”è¯¥ä½¿ç”¨å¤–éƒ¨IPå³ä½¿ç”¨ æ¡¥æ¥æ¨¡å¼çš„ens38 ä½†vmwareç¯å¢ƒè¿™æ ·ä¹Ÿè¡Œ å› ä¸ºwindowsç«¯å¯ä»¥pingé€šä¸»æœºæ¨¡å¼ç”Ÿæˆçš„IP ï¼‰ï¼‰</span></span><br><span class="line">keepalived_virtual_router_id: <span class="string">&quot;99&quot;</span>           <span class="comment"># keepalived å”¯ä¸€çš„ IDï¼Œéœ€è¦å’Œå±€åŸŸç½‘å†…å…¶ä»–  keepalived ID ä¸ä¸€è‡´, å–å€¼èŒƒå›´ 0~255</span></span><br><span class="line">kolla_internal_vip_address: <span class="string">&quot;10.56.70.100&quot;</span>   <span class="comment"># å†…éƒ¨ vip ï¼Œéœ€è¦å’Œ /etc/hosts ä¸­çš„ IP ç½‘æ®µä¸€è‡´ ï¼ˆworkstdtionå®éªŒç¯å¢ƒåˆ’åˆ†lanåŒºæ®µ20åªèƒ½å†…éƒ¨é€šä¿¡ ï¼‰</span></span><br><span class="line">network_interface: <span class="string">&quot;vlan70&quot;</span>                   <span class="comment"># å†…éƒ¨ vip æ¥å£ï¼ŒæœåŠ¡å™¨å†…éƒ¨é€šè®¯åœ°å€</span></span><br><span class="line">kolla_external_vip_address: <span class="string">&quot;192.168.1.99&quot;</span>   <span class="comment"># å¤–éƒ¨ vipï¼Œç”¨äº horizon dashboard ç•Œé¢æ“ä½œç­‰(è‹¥å¼€å¯é«˜å¯ç”¨ï¼šenable_haproxy: &quot;yes&quot;éœ€è¦é…ç½®ä¸ºæ²¡æœ‰å ç”¨çš„ip)</span></span><br><span class="line">horizon_port: <span class="string">&quot;10000&quot;</span>                    <span class="comment"># dashboard çš„ç«¯å£</span></span><br><span class="line">kolla_external_vip_interface: <span class="string">&quot;bond3&quot;</span>    <span class="comment"># å¤–éƒ¨ vip æ¥å£, è‹¥è¯¥ç½‘å¡åˆ’åˆ†äº† vlanï¼Œåˆ™éœ€è¦å¡«å†™é…ç½®å¤–ç½‘çš„å­æ¥å£workstdtionæ¨¡æ‹Ÿens38æ¡¥æ¥æ¨¡å¼ç½‘å¡ä¸º192.168.31æ®µ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä»–é…ç½®</span></span><br><span class="line"><span class="comment"># kolla_external_vip_interface: &quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">api_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">storage_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">cluster_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">tunnel_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line">dns_interface: <span class="string">&quot;&#123;&#123; network_interface &#125;&#125;&quot;</span></span><br><span class="line"><span class="comment"># neutron_external_interface: &quot;ens38&quot; # è®¿é—®openstackçš„ç‰©ç†ç½‘å¡ä¸éœ€è¦é…ç½®IPï¼Œä¸šåŠ¡å£</span></span><br><span class="line">neutron_plugin_agent: <span class="string">&quot;openvswitch&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¤–ç½‘è®¾ç½®ï¼ˆ ens38 natæ¨¡å¼ æ­¤å¤„ens38ä¸ºä¸šåŠ¡å£ä¸é…ç½®IP é‡‡ç”¨åŠå…¬ç½‘192.168.31æ®µä½œä¸ºå¤–ç½‘ æ¥çº¿æ¥åŠå…¬ç½‘çš„å…‰çº¤æˆ–ç½‘çº¿ ï¼‰</span></span><br><span class="line"><span class="comment"># neutron_external_interface: &quot;ens38&quot;      # flat ç½‘ç»œä½¿ç”¨çš„ç‰©ç†ç½‘å¡,è‹¥éœ€è¦è¿æ¥ä¸“ç½‘</span></span><br><span class="line">neutron_external_interface: <span class="string">&quot;bond2,vlan80&quot;</span>        <span class="comment"># workstdtionæ¨¡æ‹Ÿæ¡¥æ¥æ¨¡å¼ç½‘å¡ ç”¨äºæ¨¡æ‹Ÿå¤–ç½‘å¯é…ç½®ç½‘ç»œä¹Ÿå¯ä¸é…ç½® ç‰©ç†æœåŠ¡å™¨éœ€è¦æ¥å¤–ç½‘ç½‘çº¿</span></span><br><span class="line">neutron_bridge_name: <span class="string">&quot;&#123;% for i in range(neutron_external_interface.split(&#x27;,&#x27;)|length) %&#125;br-ex&#123;&#123; loop.index0 + 1 &#125;&#125;&#123;% if not loop.last %&#125;,&#123;% endif %&#125;&#123;% endfor %&#125;&quot;</span></span><br><span class="line"><span class="comment"># ç½‘æ¡¥åå­—, neutron_external_interface æœ‰å¤šå°‘ä¸ªæ¥å£å°±è¦æŒ‡å®šå¤šå°‘ä¸ªç½‘æ¡¥åç§°</span></span><br><span class="line">enable_neutron_dns: <span class="string">&quot;no&quot;</span>                                  <span class="comment"># neutron æ˜¯å¦å¼€å¯ dns, å¦‚æœå¼€å¯ dns, å¯èƒ½é­å— dns åå°„å‹ ddos æ”»å‡», å¦‚æœä¸å¼€å¯, horizon ä¸­åˆ›å»ºå­ç½‘æ—¶éœ€è¦æŒ‡å®šå…¬å…± dns, å¦‚ 223.5.5.5</span></span><br><span class="line">enable_neutron_mtu_1550: <span class="string">&quot;no&quot;</span>                             <span class="comment"># ä¸è¦ä¿®æ”¹è¯¥å‚æ•°ï¼Œå¦åˆ™å¯èƒ½ä¼šå¸¦æ¥ä¸€äº›ç½‘ç»œé—®é¢˜</span></span><br><span class="line">enable_neutron_ext_net: <span class="string">&quot;yes&quot;</span>                             <span class="comment"># æ˜¯å¦è‡ªåŠ¨åˆ›å»º flat ç½‘ç»œ</span></span><br><span class="line">neutron_ext_net_cidr: <span class="string">&quot;192.168.1.0/24&quot;</span></span><br><span class="line">neutron_ext_net_range: <span class="string">&quot;start=192.168.1.70,end=192.168.1.120&quot;</span></span><br><span class="line">neutron_ext_net_gateway: <span class="string">&quot;192.168.1.1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¦ç”¨æ—¶é’Ÿæ£€æŸ¥(å¯é€‰)</span></span><br><span class="line"><span class="comment"># prechecks_enable_host_ntp_checks: &quot;false&quot;</span></span><br><span class="line"><span class="comment"># skylineå¯é€‰</span></span><br><span class="line"><span class="comment"># enable_skyline: &quot;yes&quot;</span></span><br><span class="line"><span class="comment"># å…¶ä»–é…ç½®</span></span><br><span class="line">enable_ceph: <span class="string">&quot;no&quot;</span></span><br><span class="line">enable_haproxy: <span class="string">&quot;yes&quot;</span></span><br><span class="line">enable_chrony: <span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="comment"># enable_mariabackup: &quot;no&quot;</span></span><br><span class="line"><span class="comment"># enable_ceph_rgw: &quot;yes&quot;</span></span><br><span class="line">enable_cinder: <span class="string">&quot;yes&quot;</span></span><br><span class="line">enable_manila_backend_cephfs_native: <span class="string">&quot;yes&quot;</span></span><br><span class="line"><span class="comment"># enable_neutron_qos: &quot;yes&quot;  </span></span><br><span class="line"><span class="comment"># enable_ceph_rgw_keystone: &quot;yes&quot;</span></span><br><span class="line">glance_backend_ceph: <span class="string">&quot;yes&quot;</span></span><br><span class="line">glance_enable_rolling_upgrade: <span class="string">&quot;no&quot;</span></span><br><span class="line">gnocchi_backend_storage: <span class="string">&quot;ceph&quot;</span></span><br><span class="line">cinder_backend_ceph: <span class="string">&quot;yes&quot;</span></span><br><span class="line">nova_backend_ceph: <span class="string">&quot;yes&quot;</span></span><br><span class="line">ironic_dnsmasq_dhcp_range:</span><br><span class="line">tempest_image_id:</span><br><span class="line">tempest_flavor_ref_id:</span><br><span class="line">tempest_public_network_id:</span><br><span class="line">tempest_floating_network_name:</span><br><span class="line"></span><br><span class="line"><span class="comment"># ------------åˆ†å‰²çº¿--------------</span></span><br><span class="line"><span class="comment"># 2023.10.30æ–°å¢(æ–°å¢vpn qos æ•°æ®åº“) ---------------------&gt;&gt; ä¸‹æ–¹æ–°å¢é…ç½®------------</span></span><br><span class="line">enable_neutron_dvr: <span class="string">&quot;yes&quot;</span>                <span class="comment"># æ‚¨å¯ç”¨äº† OpenStack Neutron çš„ DVRï¼ˆDistributed Virtual Routerï¼‰åŠŸèƒ½ã€‚DVR æ˜¯ä¸€é¡¹åŠŸèƒ½ï¼Œå®ƒå…è®¸è™šæ‹Ÿè·¯ç”±å™¨ï¼ˆVirtual Routerï¼‰çš„æ•°æ®é¢åŠŸèƒ½åœ¨è®¡ç®—èŠ‚ç‚¹ä¸Šåˆ†å¸ƒå¼æ‰§è¡Œï¼Œè€Œä¸æ˜¯é›†ä¸­æ‰§è¡Œåœ¨ç½‘ç»œèŠ‚ç‚¹ä¸Šã€‚è¿™æœ‰åŠ©äºæé«˜ç½‘ç»œæ€§èƒ½å’Œæ‰©å±•æ€§ã€‚</span></span><br><span class="line">enable_neutron_vpnaas: <span class="string">&quot;yes&quot;</span>             <span class="comment"># vpn</span></span><br><span class="line">enable_neutron_qos: <span class="string">&quot;yes&quot;</span>                <span class="comment"># qos</span></span><br><span class="line">enable_nova_ssh: <span class="string">&quot;yes&quot;</span>                   <span class="comment"># è¿™å…è®¸ç”¨æˆ·é€šè¿‡ SSH åè®®è®¿é—®è™šæ‹Ÿæœºå®ä¾‹ï¼Œä»¥è¿›è¡Œè¿œç¨‹ç®¡ç†å’Œæ“ä½œã€‚</span></span><br><span class="line"><span class="comment"># enable_neutron_provider_networks: &quot;yes&quot;  # æä¾›è€…ç½‘ç»œæ˜¯ä¸€ç§ç½‘ç»œç±»å‹ï¼Œå…è®¸ OpenStack ç§Ÿæˆ·è¿æ¥åˆ°å¤–éƒ¨ç½‘ç»œï¼Œé€šå¸¸æ˜¯ç‰©ç†ç½‘ç»œæˆ–å…¶ä»–å¤–éƒ¨ç½‘ç»œæœåŠ¡ã€‚</span></span><br><span class="line"><span class="comment"># enable_trove: &quot;yes&quot;                      # Trove æ˜¯ OpenStack çš„æ•°æ®åº“å³æœåŠ¡ </span></span><br></pre></td></tr></table></figure><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>å¯ä»¥çœ‹åˆ°æ­¤ç§æ–¹å¼å³ä½¿æ˜¯æµ‹è¯•ç¯å¢ƒceph osdå†™å…¥é€Ÿåº¦ä¹Ÿå¯ä»¥è¾¾åˆ°<del>1M/s</del>ä»¥ä¸Š</p><p>æ³¨ï¼šæ­¤ç§æµ‹è¯•æ—¶å‘ç°æµ®åŠ¨IPæ— æ³•ä½¿ç”¨åŸå› å¦‚ä¸‹</p><p>æ–‡ä»¶ï¼š</p><ul><li>/etc/kolla/neutron-server/ml2_conf.ini</li><li>/etc/kolla/neutron-openvswitch-agent/openvswitch_agent.ini</li><li>bond2 vlan80 ä¸æµ®åŠ¨IPç½‘æ®µå‡ä¸åœ¨ä¸€èµ· bond2 ä¸Š<del>ç½‘å¡ç½‘å£éœ€è¦æ¥ä¸æµ®åŠ¨IPåŒç½‘æ®µçš„ç½‘çº¿</del> <strong>å¹¶ä¸”ä¸èƒ½é…ç½® IP</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹é…ç½®æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cat</span> /etc/kolla/neutron-openvswitch-agent/openvswitch_agent.ini</span><br><span class="line"></span><br><span class="line">[agent]</span><br><span class="line">tunnel_types = vxlan</span><br><span class="line">l2_population = <span class="literal">true</span></span><br><span class="line">arp_responder = <span class="literal">true</span></span><br><span class="line">enable_distributed_routing = True</span><br><span class="line">extensions = qos</span><br><span class="line"></span><br><span class="line">[securitygroup]</span><br><span class="line">firewall_driver = neutron.agent.linux.iptables_firewall.OVSHybridIptablesFirewallDriver</span><br><span class="line"></span><br><span class="line">[ovs]</span><br><span class="line">bridge_mappings = physnet1:br-ex1,physnet2:br-ex2</span><br><span class="line">datapath_type = system</span><br><span class="line">ovsdb_connection = tcp:127.0.0.1:6640</span><br><span class="line">ovsdb_timeout = 10</span><br><span class="line">local_ip = 10.56.70.11     <span class="comment"># IPä¸º56æ®µIPä½†æµ®åŠ¨IPä¸º192.168æ®µ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹äº¤æ¢æœºå†…éƒ¨</span></span><br><span class="line">(venv3) root@ceph1:/etc/kolla/neutron-openvswitch-agent<span class="comment"># docker exec -it openvswitch_vswitchd bash</span></span><br><span class="line">(openvswitch-vswitchd)[root@ceph1 /]<span class="comment"># ovs-vsctl show</span></span><br><span class="line">0b40fa1b-d121-4e67-ae65-2a702169c162</span><br><span class="line">    Manager <span class="string">&quot;ptcp:6640:127.0.0.1&quot;</span></span><br><span class="line">        is_connected: <span class="literal">true</span></span><br><span class="line">    Bridge br-ex1</span><br><span class="line">        Controller <span class="string">&quot;tcp:127.0.0.1:6633&quot;</span></span><br><span class="line">            is_connected: <span class="literal">true</span></span><br><span class="line">        fail_mode: secure</span><br><span class="line">        datapath_type: system</span><br><span class="line">        Port br-ex1</span><br><span class="line">            Interface br-ex1</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port bond2                       <span class="comment"># å¯ä»¥çœ‹åˆ°æ­¤å¤„ä½¿ç”¨çš„å¤–ç½‘ç½‘å¡æ˜¯bond2 ä½†æ˜¯æ­¤æ—¶bond2æ˜¯</span></span><br><span class="line">            Interface bond2</span><br><span class="line">        Port phy-br-ex1</span><br><span class="line">            Interface phy-br-ex1</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=int-br-ex1&#125;</span><br><span class="line">    Bridge br-ex2</span><br><span class="line">        Controller <span class="string">&quot;tcp:127.0.0.1:6633&quot;</span></span><br><span class="line">            is_connected: <span class="literal">true</span></span><br><span class="line">        fail_mode: secure</span><br><span class="line">        datapath_type: system</span><br><span class="line">        Port phy-br-ex2</span><br><span class="line">            Interface phy-br-ex2</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=int-br-ex2&#125;</span><br><span class="line">        Port br-ex2</span><br><span class="line">            Interface br-ex2</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port vlan80</span><br><span class="line">            Interface vlan80</span><br><span class="line">    Bridge br-tun</span><br><span class="line">        Controller <span class="string">&quot;tcp:127.0.0.1:6633&quot;</span></span><br><span class="line">            is_connected: <span class="literal">true</span></span><br><span class="line">        fail_mode: secure</span><br><span class="line">        datapath_type: system</span><br><span class="line">        Port br-tun</span><br><span class="line">            Interface br-tun</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port patch-int</span><br><span class="line">            Interface patch-int</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=patch-tun&#125;</span><br><span class="line">    Bridge br-int</span><br><span class="line">        Controller <span class="string">&quot;tcp:127.0.0.1:6633&quot;</span></span><br><span class="line">            is_connected: <span class="literal">true</span></span><br><span class="line">        fail_mode: secure</span><br><span class="line">        datapath_type: system</span><br><span class="line">        Port tapc4f556bc-44</span><br><span class="line">            tag: 3</span><br><span class="line">            Interface tapc4f556bc-44</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port patch-tun</span><br><span class="line">            Interface patch-tun</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=patch-int&#125;</span><br><span class="line">        Port qvo0650711e-a1</span><br><span class="line">            tag: 2</span><br><span class="line">            Interface qvo0650711e-a1</span><br><span class="line">        Port int-br-ex1</span><br><span class="line">            Interface int-br-ex1</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=phy-br-ex1&#125;</span><br><span class="line">        Port qg-97668e2d-78</span><br><span class="line">            tag: 3</span><br><span class="line">            Interface qg-97668e2d-78</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port int-br-ex2</span><br><span class="line">            Interface int-br-ex2</span><br><span class="line">                <span class="built_in">type</span>: patch</span><br><span class="line">                options: &#123;peer=phy-br-ex2&#125;</span><br><span class="line">        Port sg-02263924-70</span><br><span class="line">            tag: 2</span><br><span class="line">            Interface sg-02263924-70</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port tap823e4df9-c8</span><br><span class="line">            tag: 2</span><br><span class="line">            Interface tap823e4df9-c8</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port fg-69b4fc5a-cc</span><br><span class="line">            tag: 3</span><br><span class="line">            Interface fg-69b4fc5a-cc</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port br-int</span><br><span class="line">            Interface br-int</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br><span class="line">        Port qr-69d003b3-f2</span><br><span class="line">            tag: 2</span><br><span class="line">            Interface qr-69d003b3-f2</span><br><span class="line">                <span class="built_in">type</span>: internal</span><br></pre></td></tr></table></figure><h3 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">(venv3)</span> <span class="string">root@ceph1:~#</span> <span class="string">cat</span> <span class="string">/etc/netplan/00-installer-config.yaml</span> </span><br><span class="line"><span class="comment"># This is the network config written by &#x27;subiquity&#x27;</span></span><br><span class="line"><span class="attr">network:</span></span><br><span class="line">  <span class="attr">ethernets:</span></span><br><span class="line">    <span class="attr">ens33:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens37:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens38:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens39:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens40:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens41:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens42:</span> &#123;&#125;</span><br><span class="line">    <span class="attr">ens43:</span> &#123;&#125;</span><br><span class="line">  <span class="attr">bonds:</span></span><br><span class="line">    <span class="attr">bond0:</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;10.56.50.11/24&quot;</span>]  <span class="comment"># æ­¤ç½‘å£ç”¨ä¸‡å…†å£ ç”¨äºceph osdé—´é€šä¿¡ï¼ˆ--cluster-networkï¼‰</span></span><br><span class="line">      <span class="attr">interfaces:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">ens37</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer3+4</span></span><br><span class="line">    <span class="attr">bond1:</span></span><br><span class="line">      <span class="attr">interfaces:</span>  </span><br><span class="line">        <span class="bullet">-</span> <span class="string">ens38</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer3+4</span></span><br><span class="line">    <span class="attr">bond2:</span></span><br><span class="line">      <span class="attr">interfaces:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">ens39</span>   <span class="comment"># æ¥ä¸æµ®åŠ¨IPåŒç½‘æ®µçš„ç½‘çº¿</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer3+4</span></span><br><span class="line">    <span class="attr">bond3:</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;192.168.1.10/24&quot;</span>]      <span class="comment"># æ­¤ç½‘å£ç”¨åƒå…†å£ &gt;&gt; ç”µå£ ç”¨äºè¿œç¨‹è¿æ¥ ä¸ºæµ®åŠ¨IP</span></span><br><span class="line">      <span class="attr">gateway4:</span> <span class="number">192.168</span><span class="number">.1</span><span class="number">.1</span></span><br><span class="line">      <span class="attr">interfaces:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="string">ens33</span></span><br><span class="line">      <span class="attr">parameters:</span></span><br><span class="line">        <span class="attr">mode:</span> <span class="number">802.</span><span class="string">3ad</span></span><br><span class="line">        <span class="attr">mii-monitor-interval:</span> <span class="number">100</span></span><br><span class="line">        <span class="attr">lacp-rate:</span> <span class="string">fast</span></span><br><span class="line">        <span class="attr">transmit-hash-policy:</span> <span class="string">layer3+4</span></span><br><span class="line">  <span class="attr">vlans:</span></span><br><span class="line">    <span class="attr">vlan60:</span></span><br><span class="line">      <span class="attr">id:</span> <span class="number">60</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">bond1</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;10.56.60.11/24&quot;</span>]</span><br><span class="line">    <span class="attr">vlan70:</span></span><br><span class="line">      <span class="attr">id:</span> <span class="number">70</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">bond1</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;10.56.70.11/24&quot;</span>]</span><br><span class="line">    <span class="attr">vlan80:</span></span><br><span class="line">      <span class="attr">id:</span> <span class="number">80</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">bond1</span></span><br><span class="line">      <span class="comment">#addresses: [&quot;10.56.80.11/24&quot;]  #æµ®åŠ¨IPä½¿ç”¨æ¥å£ä¸é…ç½®IP</span></span><br><span class="line">    <span class="attr">vlan90:</span></span><br><span class="line">      <span class="attr">id:</span> <span class="number">90</span></span><br><span class="line">      <span class="attr">link:</span> <span class="string">bond1</span></span><br><span class="line">      <span class="attr">addresses:</span> [<span class="string">&quot;10.56.90.11/24&quot;</span>]</span><br><span class="line">  <span class="attr">version:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶é—®é¢˜è§£å†³ã€‚</p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><h3 id="cephçŠ¶æ€"><a href="#cephçŠ¶æ€" class="headerlink" title="cephçŠ¶æ€"></a>cephçŠ¶æ€</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">(venv3) root@ceph1:~# ceph -s</span><br><span class="line">  cluster:</span><br><span class="line">    id:     dc7fa486-f1a0-11ee-a64f-c194d5eb9f2e</span><br><span class="line">    health: HEALTH_WARN</span><br><span class="line">            5 pool(s) have no replicas configured</span><br><span class="line"> </span><br><span class="line">  services:</span><br><span class="line">    mon: 1 daemons, quorum ceph1 (age 62m)</span><br><span class="line">    mgr: ceph1.phqsba(active, since 62m)</span><br><span class="line">    osd: 1 osds: 1 up (since 62m), 1 in (since 2h)</span><br><span class="line"> </span><br><span class="line">  data:</span><br><span class="line">    pools:   5 pools, 129 pgs</span><br><span class="line">    objects: 157 objects, 220 MiB</span><br><span class="line">    usage:   111 MiB used, 20 GiB / 20 GiB avail</span><br><span class="line">    pgs:     129 active+clean</span><br></pre></td></tr></table></figure><h3 id="openstackåˆ›å»ºå®ä¾‹éªŒè¯æ•ˆæœ-gt-gt"><a href="#openstackåˆ›å»ºå®ä¾‹éªŒè¯æ•ˆæœ-gt-gt" class="headerlink" title="openstackåˆ›å»ºå®ä¾‹éªŒè¯æ•ˆæœ &gt;&gt;"></a>openstackåˆ›å»ºå®ä¾‹éªŒè¯æ•ˆæœ &gt;&gt;</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ea5efea6d38310a022b2f7c573e3afcd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_ea5efea6d38310a022b2f7c573e3afcd.png"></p><p>æ­¤æ—¶é›†ç¾¤æµ‹è¯•åœ†æ»¡å®Œæˆã€‚</p>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlanåŠç½‘å¡bondè®¾ç½®</title>
      <link href="/2024/04/02/workstdtion%E6%A8%A1%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%88%92%E5%88%86vlan%E5%8F%8A%E7%BD%91%E5%8D%A1bond%E8%AE%BE%E7%BD%AE/"/>
      <url>/2024/04/02/workstdtion%E6%A8%A1%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%88%92%E5%88%86vlan%E5%8F%8A%E7%BD%91%E5%8D%A1bond%E8%AE%BE%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlanåŠç½‘å¡bondè®¾ç½®"><a href="#workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlanåŠç½‘å¡bondè®¾ç½®" class="headerlink" title="workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlanåŠç½‘å¡bondè®¾ç½®"></a>workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlanåŠç½‘å¡bondè®¾ç½®</h1><h2 id="workstdtionè®¾ç½®"><a href="#workstdtionè®¾ç½®" class="headerlink" title="workstdtionè®¾ç½®"></a>workstdtionè®¾ç½®</h2><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c2444bc85394584e2798df97ef8b9549.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c2444bc85394584e2798df97ef8b9549.png"></p><h2 id="ä¸€-ç¬¬ä¸€ç§ubuntuç³»ç»Ÿç½‘å¡é…ç½®"><a href="#ä¸€-ç¬¬ä¸€ç§ubuntuç³»ç»Ÿç½‘å¡é…ç½®" class="headerlink" title="ä¸€. ç¬¬ä¸€ç§ubuntuç³»ç»Ÿç½‘å¡é…ç½®"></a>ä¸€. ç¬¬ä¸€ç§ubuntuç³»ç»Ÿç½‘å¡é…ç½®</h2><blockquote><p>æŸ¥çœ‹ç«¯å£é€Ÿç‡ï¼š</p><ul><li><p>åˆ¤æ–­æ˜¯åƒå…†ç½‘å¡è¿˜æ˜¯ç™¾å…†ç½‘å¡ æŸ¥çœ‹æ”¯æŒçš„é€Ÿç‡ &gt; <strong>ethtool ens33</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Speed: 1000Mb/s</span><br><span class="line">Duplex: Full</span><br><span class="line">Port: Twisted Pair</span><br></pre></td></tr></table></figure></li></ul></blockquote><p>å®Œæ•´ç½‘å¡é…ç½®å¦‚ä¸‹ï¼šå…±æ¥å››æ ¹ç½‘çº¿ <strong>bond0&gt;&gt;bond3</strong> å¤„ç½‘å¡éœ€è¦æ˜¯<strong>up</strong>çŠ¶æ€ ç‰©ç†æœåŠ¡å™¨æ—¶åªéœ€è¦æ’å…¥ç½‘çº¿æŸ¥çœ‹ç«¯å£çŠ¶æ€å³å¯åˆ¤æ–­ç½‘å£çŠ¶æ€</p><ul><li><p>bond3 æµ®åŠ¨IP 192.168.1.10/24 ç½‘å£ä¸Š ä½äºåƒå…†å£ æ¥ä¸€æ ¹äº¤æ¢æœºä¸Šåˆ’åˆ†çš„ä¸€æ ¹åŒç½‘æ®µç½‘çº¿ ç”¨äºè¿œç¨‹è¿æ¥</p></li><li><p>bond0 ä¸‡å…†å£æ¥ä¸€æ ¹äº¤æ¢æœºåˆ’åˆ†çš„ 50 æ®µç½‘ç»œ ç”¨äºceph osd å†…éƒ¨é€šä¿¡cephï¼ˆâ€“cluster-networkï¼‰ç½‘ç»œ</p></li><li><p>bond1 ä¸Šé¢æ¥äº¤æ¢æœºä¸Šå¯¹ è¯¥ç½‘å£åˆ’åˆ†äº†vlan60 vlan70 vlan80 vlan90 çš„ç½‘çº¿</p></li><li><p><code>bond2</code> ä¸Šé¢æ¥äº¤æ¢æœºä¸Šå¯¹ <del>192.168.1.10/24 ç½‘æ®µåˆ’åˆ†çš„æµ®åŠ¨IP æ± </del> çš„ç½‘çº¿ ä¾‹å¦‚ï¼š<del>æœ¬æ–‡åˆ™éœ€è¦ä¸ºæ¡¥æ¥æ¨¡å¼æ¨¡æ‹Ÿæµ®åŠ¨</del>IP  å¹¶ä¸”æ­¤ç½‘å£ä¸é…ç½®IPï¼ˆä¸‹æ–¹æ–‡ä»¶æµ‹è¯•å·²é…ç½®äº†IP <del>å®é™…è¿‡ç¨‹ä¸­è‡ªè¡Œæ³¨é‡Š</del>ï¼‰<code>å®éªŒä¸­å•èŠ‚ç‚¹vmwareç¯å¢ƒbond2ä¸‹ç½‘å¡ens39æ¡¥æ¥æ¨¡å¼ éƒ¨ç½²å•èŠ‚ç‚¹stackä¸€åˆ‡æ­£å¸¸ ä½†æ˜¯åŒèŠ‚ç‚¹bond2ä¸‹ç½‘å¡ens39 åŒèŠ‚ç‚¹ens39ç½‘å¡å‡é…ç½®æ¡¥æ¥æ¨¡å¼æ—¶ åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹å¯ç”¨ &gt;&gt; æ­¤æ—¶ åªéœ€è¦å°†åŒèŠ‚ç‚¹ä¸Šæ–¹å‡æ²¡æœ‰åˆ’åˆ†bondçš„ä»»æ„ç½‘å¡æ¡¥æ¥å¦‚ens41 ä¿®æ”¹globalæ–‡ä»¶ç”¨äºæµ®åŠ¨IPæ± ä½¿ç”¨çš„ç½‘å¡ä¸ºens41 å†é‡æ–°éƒ¨ç½² å³ æ­£å¸¸</code>ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_6e28aee0f289c98393d974c614fc09c3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_6e28aee0f289c98393d974c614fc09c3.png"></p></li><li><p>ä¸‰å°æœåŠ¡å™¨ æ­¤ç§é…ç½®å®Œæˆå æ˜¯å¯ä»¥äº’é€šçš„æ— è®º<strong>ping</strong>é‚£ä¸ªç½‘æ®µéƒ½æ˜¯é€šçš„<br>ubuntuç½‘å¡bondæ¥çº¿ä¸cephåŠstarté›†æˆ<strong>æ½å›¾</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_cea9571e22249bca02d6cb339ed3c060.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_cea9571e22249bca02d6cb339ed3c060.png"></p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># This is the network config written by &#x27;subiquity&#x27;</span></span><br><span class="line">network:</span><br><span class="line">  ethernets:</span><br><span class="line">    ens33: &#123;&#125;</span><br><span class="line">    ens37: &#123;&#125;</span><br><span class="line">    ens38: &#123;&#125;</span><br><span class="line">    ens39: &#123;&#125;</span><br><span class="line">    ens40: &#123;&#125;</span><br><span class="line">    ens41: &#123;&#125;</span><br><span class="line">    ens42: &#123;&#125;</span><br><span class="line">    ens43: &#123;&#125;</span><br><span class="line">  bonds:</span><br><span class="line">    bond0:</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.50.11/24&quot;</span>]  <span class="comment"># æ­¤ç½‘å£ç”¨ä¸‡å…†å£ ç”¨äºceph osdé—´é€šä¿¡ï¼ˆ--cluster-networkï¼‰</span></span><br><span class="line">      interfaces:</span><br><span class="line">        - ens37</span><br><span class="line">      parameters:</span><br><span class="line">        mode: 802.3ad</span><br><span class="line">        mii-monitor-interval: 100</span><br><span class="line">        lacp-rate: fast</span><br><span class="line">        transmit-hash-policy: layer3+4</span><br><span class="line">    bond1:</span><br><span class="line">      interfaces:  </span><br><span class="line">        - ens38</span><br><span class="line">      parameters:</span><br><span class="line">        mode: 802.3ad</span><br><span class="line">        mii-monitor-interval: 100</span><br><span class="line">        lacp-rate: fast</span><br><span class="line">        transmit-hash-policy: layer3+4</span><br><span class="line">    bond2:</span><br><span class="line">      interfaces:</span><br><span class="line">        - ens39</span><br><span class="line">      parameters:</span><br><span class="line">        mode: 802.3ad</span><br><span class="line">        mii-monitor-interval: 100</span><br><span class="line">        lacp-rate: fast</span><br><span class="line">        transmit-hash-policy: layer3+4</span><br><span class="line">    bond3:</span><br><span class="line">      addresses: [<span class="string">&quot;192.168.1.10/24&quot;</span>]      <span class="comment"># æ­¤ç½‘å£ç”¨åƒå…†å£ &gt;&gt; ç”µå£ ç”¨äºè¿œç¨‹è¿æ¥ åŠæµ®åŠ¨IPä½¿ç”¨</span></span><br><span class="line">      gateway4: 192.168.1.1</span><br><span class="line">      interfaces:</span><br><span class="line">        - ens33</span><br><span class="line">      parameters:</span><br><span class="line">        mode: 802.3ad</span><br><span class="line">        mii-monitor-interval: 100</span><br><span class="line">        lacp-rate: fast</span><br><span class="line">        transmit-hash-policy: layer3+4</span><br><span class="line">  vlans:</span><br><span class="line">    vlan60:</span><br><span class="line">      <span class="built_in">id</span>: 60</span><br><span class="line">      <span class="built_in">link</span>: bond1</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.60.11/24&quot;</span>]</span><br><span class="line">    vlan70:</span><br><span class="line">      <span class="built_in">id</span>: 70</span><br><span class="line">      <span class="built_in">link</span>: bond1</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.70.11/24&quot;</span>]</span><br><span class="line">    vlan80:</span><br><span class="line">      <span class="built_in">id</span>: 80</span><br><span class="line">      <span class="built_in">link</span>: bond1</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.80.11/24&quot;</span>]</span><br><span class="line">    vlan90:</span><br><span class="line">      <span class="built_in">id</span>: 90</span><br><span class="line">      <span class="built_in">link</span>: bond1</span><br><span class="line">      addresses: [<span class="string">&quot;10.56.90.11/24&quot;</span>]</span><br><span class="line">  version: 2</span><br></pre></td></tr></table></figure><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">  System information as of Wed 03 Apr 2024 04:59:36 AM UTC</span><br><span class="line"></span><br><span class="line">  System load:              0.02</span><br><span class="line">  Usage of /:               26.9% of 39.07GB</span><br><span class="line">  Memory usage:             11%</span><br><span class="line">  Swap usage:               0%</span><br><span class="line">  Processes:                261</span><br><span class="line">  Users logged <span class="keyword">in</span>:          1</span><br><span class="line">  IPv4 address <span class="keyword">for</span> bond0:   10.56.50.11</span><br><span class="line">  IPv4 address <span class="keyword">for</span> bond3:   192.168.1.10</span><br><span class="line">  IPv6 address <span class="keyword">for</span> bond3:   240e:36f:151f:a000:e407:31ff:fee2:70f9</span><br><span class="line">  IPv4 address <span class="keyword">for</span> docker0: 172.17.0.1</span><br><span class="line">  IPv4 address <span class="keyword">for</span> vlan60:  10.56.60.11</span><br><span class="line">  IPv4 address <span class="keyword">for</span> vlan70:  10.56.70.11</span><br><span class="line">  IPv4 address <span class="keyword">for</span> vlan80:  10.56.80.11</span><br><span class="line">  IPv4 address <span class="keyword">for</span> vlan90:  10.56.90.11</span><br><span class="line"><span class="comment">#-----------------------------------------------------------------</span></span><br><span class="line">root@ceph1:~<span class="comment"># ip a</span></span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond3 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e6:07:31:e2:70:f9 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">3: ens37: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond0 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 5a:c0:b2:8b:fe:e7 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">4: ens38: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond1 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">5: ens39: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel master bond2 state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 76:88:82:b8:46:ba brd ff:ff:ff:ff:ff:ff</span><br><span class="line">6: ens40: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:45:8a:b0 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::20c:29ff:fe45:8ab0/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">7: ens41: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:45:8a:ba brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::20c:29ff:fe45:8aba/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">8: ens42: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:45:8a:c4 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::20c:29ff:fe45:8ac4/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">9: ens43: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 00:0c:29:45:8a:ce brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::20c:29ff:fe45:8ace/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">10: bond0: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 5a:c0:b2:8b:fe:e7 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.50.11/24 brd 10.56.50.255 scope global bond0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::58c0:b2ff:fe8b:fee7/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">11: bond1: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">12: bond2: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether 76:88:82:b8:46:ba brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 fe80::7488:82ff:feb8:46ba/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">13: bond3: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e6:07:31:e2:70:f9 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.1.10/24 brd 192.168.1.255 scope global bond3</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 240e:36f:151f:a000:e407:31ff:fee2:70f9/64 scope global dynamic mngtmpaddr noprefixroute </span><br><span class="line">       valid_lft 198193sec preferred_lft 111793sec</span><br><span class="line">    inet6 fe80::e407:31ff:fee2:70f9/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">14: vlan90@bond1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.90.11/24 brd 10.56.90.255 scope global vlan90</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">15: vlan60@bond1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.60.11/24 brd 10.56.60.255 scope global vlan60</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">16: vlan70@bond1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.70.11/24 brd 10.56.70.255 scope global vlan70</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">17: vlan80@bond1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000</span><br><span class="line">    <span class="built_in">link</span>/ether e2:ce:28:a9:28:0d brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 10.56.80.11/24 brd 10.56.80.255 scope global vlan80</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::e0ce:28ff:fea9:280d/64 scope <span class="built_in">link</span> </span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">18: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default </span><br><span class="line">    <span class="built_in">link</span>/ether 02:42:98:b9:c1:30 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ­¤æ—¶ä¾¿å¯é…ç½®openstack ä¸ ceph è§ &gt;&gt; | <a href="http://sunlight.zznnwn.cloudns.biz/2024/04/02/ubuntu%E9%85%8D%E7%BD%AE%E7%BD%91%E5%8D%A1bond%E7%89%88%20openstack%E9%83%A8%E7%BD%B2/">bondç‰ˆopesnatck</a> ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ubuntu-bond </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ubuntu-bond </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£</title>
      <link href="/2024/04/01/kolla-ansible%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E4%B9%8B%E6%96%B0%E5%A2%9Eglance%E7%AD%89%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D%E6%96%87%E6%A1%A3/"/>
      <url>/2024/04/01/kolla-ansible%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E4%B9%8B%E6%96%B0%E5%A2%9Eglance%E7%AD%89%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£"><a href="#kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£" class="headerlink" title="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£"></a>kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£</h1><h2 id="cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º"><a href="#cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º" class="headerlink" title="cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º"></a>cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º</h2><p>å®˜ç½‘ç‰ˆæœ¬ï¼ˆæµ‹è¯•æ­¤ç§ç‰ˆæœ¬ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph auth get-or-create client.glance mon <span class="string">&#x27;profile rbd&#x27;</span> osd <span class="string">&#x27;profile rbd pool=images&#x27;</span> mgr <span class="string">&#x27;profile rbd pool=images&#x27;</span> -o ceph.client.glance.keyring </span><br><span class="line">ceph auth get-or-create client.cinder mon <span class="string">&#x27;profile rbd&#x27;</span> osd <span class="string">&#x27;profile rbd pool=volumes, profile rbd pool=vms, profile rbd-read-only pool=images&#x27;</span> mgr <span class="string">&#x27;profile rbd pool=volumes, profile rbd pool=vms&#x27;</span> -o ceph.client.cinder.keyring</span><br><span class="line">ceph auth get-or-create client.cinder-backup mon <span class="string">&#x27;profile rbd&#x27;</span> osd <span class="string">&#x27;profile rbd pool=backups&#x27;</span> mgr <span class="string">&#x27;profile rbd pool=backups&#x27;</span> -o ceph.client.cinder-backup.keyring</span><br></pre></td></tr></table></figure><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬å¯†é’¥åˆ›å»ºå¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/ceph</span><br><span class="line">ceph auth get-or-create client.cinder mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=volumes, allow rwx pool=vms, allow rx pool=images&#x27;</span> -o ceph.client.cinder.keyring</span><br><span class="line">ceph auth get-or-create client.glance mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=images&#x27;</span>  -o ceph.client.glance.keyring</span><br><span class="line">ceph auth get-or-create client.cinder-backup mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=backups, allow rwx pool=volumes&#x27;</span>  -o ceph.client.cinder-backup.keyring</span><br><span class="line">ceph auth get-or-create client.nova mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=vms, allow rwx pool=volumes, allow rx pool=images&#x27;</span>  -o ceph.client.nova.keyring</span><br></pre></td></tr></table></figure><h2 id="ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®"><a href="#ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®" class="headerlink" title="ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®"></a>ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®</h2><blockquote><p>ä¸‹æ–¹å†…å®¹æ¥è‡ª | ï¼š</p><p><a href="https://wn-apple-teawine.fun/2023/06/02/ceph%E4%B8%8Eopenstack-yoga%E9%9B%86%E6%88%90">https://wn-apple-teawine.fun/2023/06/02/cephä¸openstack-yogaé›†æˆ</a></p><p>å¯å‚è€ƒå®˜ç½‘ï¼š</p><p><a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/">https://docs.ceph.com/en/reef/rbd/rbd-openstack/</a></p><p><del><strong>volume</strong>ä¸<strong>cinder-backup</strong>åˆ©ç”¨<strong>kolla-ansible</strong>åˆå¹¶é…ç½®æ–‡ä»¶å±æ€§åç”Ÿæˆçš„é…ç½®æ–‡ä»¶åˆ†åˆ«ä½äº</del></p><p>/etc/kolla/cinder-volume/cinder.conf<br>/etc/kolla/cinder-backup/cinder.conf</p><p><del><strong>glance</strong>ä¸<strong>nova</strong>åˆ†åˆ«ä½äº</del></p><p>/etc/kolla/glance-api/glance-api.conf<br>/etc/kolla/nova-compute/nova.conf</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># glanceçš„é…ç½®é•œåƒå­˜å‚¨</span></span><br><span class="line">vi /etc/kolla/config/glance/glance-api.conf</span><br><span class="line"><span class="comment"># æ·»åŠ ï¼š</span></span><br><span class="line">[glance_store]</span><br><span class="line">stores=rbd</span><br><span class="line">default_store=rbd</span><br><span class="line">rbd_store_pool=images</span><br><span class="line">rbd_store_user=glance</span><br><span class="line">rbd_store_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># cinderçš„é…ç½®å·å­˜å‚¨</span></span><br><span class="line">vi /etc/kolla/config/cinder/cinder-volume.conf</span><br><span class="line"><span class="comment"># æ·»åŠ :</span></span><br><span class="line">[DEFAULT]</span><br><span class="line">enabled_backends=rbd-1</span><br><span class="line">[rbd-1]</span><br><span class="line">rbd_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line"><span class="comment"># rbd_flatten_volume_from_snapshot = true</span></span><br><span class="line">rbd_user=cinder  </span><br><span class="line">backend_host=rbd:volumes</span><br><span class="line">rbd_pool=volumes</span><br><span class="line">volume_backend_name=rbd-1</span><br><span class="line">volume_driver=cinder.volume.drivers.rbd.RBDDriver     <span class="comment"># æ­¤ä¸ºé©±åŠ¨</span></span><br><span class="line">rbd_secret_uuid=ea241bba-2031-4b0e-b750-c8356cbb46a8 </span><br><span class="line"></span><br><span class="line">æ–°å¢ï¼šï¼ˆ rbd_flatten_volume_from_snapshot = <span class="literal">true</span></span><br><span class="line">ï¼‰</span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šrbd_secret_uuidåœ¨/etc/kolla/passwords.yml æ–‡ä»¶ä¸­æ‰¾</span></span><br><span class="line"><span class="comment"># cat /etc/kolla/passwords.yml | grep rbd_secret_uuid</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cinder-backupçš„é…ç½®</span></span><br><span class="line">vi /etc/kolla/config/cinder/cinder-backup.conf</span><br><span class="line"><span class="comment"># æ·»åŠ :</span></span><br><span class="line">[DEFAULT]</span><br><span class="line">backup_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line">backup_ceph_user=cinder-backup   </span><br><span class="line">backup_ceph_chunk_size=134217728</span><br><span class="line">backup_ceph_pool=backups</span><br><span class="line"><span class="comment"># æœ¬æ¬¡ä½¿ç”¨cinder.backup.drivers.ceph.CephBackupDriver</span></span><br><span class="line">backup_driver=cinder.backup.drivers.ceph.CephBackupDriver    <span class="comment">#æ­¤ä¸ºé©±åŠ¨å¯é€‰cinder.backup.drivers.ceph</span></span><br><span class="line">backup_ceph_stripe_unit=0</span><br><span class="line">backup_ceph_stripe_count=0</span><br><span class="line">restore_discard_excess_bytes=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># novaçš„é…ç½®</span></span><br><span class="line">vi /etc/kolla/config/nova/nova-compute.conf</span><br><span class="line"><span class="comment"># æ·»åŠ ï¼š   </span></span><br><span class="line">[libvirt]   </span><br><span class="line">virt_type=kvm  </span><br><span class="line">cpu_mode=none </span><br><span class="line">images_rbd_pool=vms</span><br><span class="line">images_type=rbd</span><br><span class="line">images_rbd_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line">rbd_user=nova</span><br><span class="line"><span class="comment"># disk_cachemodes= &quot;network=writeback&quot;</span></span><br><span class="line"><span class="comment"># inject_password=true</span></span><br><span class="line"><span class="comment"># å¦‚æœæ˜¯åœ¨è™šæ‹Ÿæœºä¸Šéƒ¨ç½²çš„è¯éœ€è¦å°†virt_type æ”¹ä¸ºqemuï¼Œå¦‚æœä¸æ”¹æˆqemuï¼Œåœ¨openstackä¹‹ä¸Šåœ¨èµ·è™šæœºï¼Œè¿™ä¸ªè™šæœºæ˜¯èµ·ä¸æ¥çš„ </span></span><br><span class="line">ï¼ˆå®é™…ç¯å¢ƒå‚è€ƒ</span><br><span class="line">æ–°å¢: disk_cachemodes= <span class="string">&quot;network=writeback&quot;</span> inject_password=<span class="literal">true</span>,images_type=rbd </span><br><span class="line">åˆ é™¤: virt_type=kvm, cpu_mode = none :åˆ é™¤æ–°å¢é…ç½®æ­¤ç§æ—¶æˆåŠŸ ï¼‰</span><br></pre></td></tr></table></figure></blockquote><h2 id="glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api-confï¼‰"><a href="#glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api-confï¼‰" class="headerlink" title="glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api.confï¼‰"></a>glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api.confï¼‰</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/glance/glance-api.conf</p><blockquote><p>å®˜ç½‘å¼•ç”¨</p><h4 id="KILO-AND-AFTER-gt-gt"><a href="#KILO-AND-AFTER-gt-gt" class="headerlink" title="KILO AND AFTER&gt;&gt;"></a>KILO AND AFTER<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#kilo-and-after" title="Permalink to this heading">&gt;&gt;</a></h4><p>Edit <code>/etc/glance/glance-api.conf</code> and add under the <code>[glance_store]</code> section:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[glance_store]</span><br><span class="line">stores = rbd</span><br><span class="line">default_store = rbd</span><br><span class="line">rbd_store_pool = images</span><br><span class="line">rbd_store_user = glance</span><br><span class="line">rbd_store_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">rbd_store_chunk_size = 8</span><br></pre></td></tr></table></figure><p>For more information about the configuration options available in Glance please refer to the OpenStack Configuration Reference: <a href="http://docs.openstack.org/">http://docs.openstack.org/</a>.</p><h4 id="ENABLE-COPY-ON-WRITE-CLONING-OF-IMAGESïƒ"><a href="#ENABLE-COPY-ON-WRITE-CLONING-OF-IMAGESïƒ" class="headerlink" title="ENABLE COPY-ON-WRITE CLONING OF IMAGESïƒ"></a>ENABLE COPY-ON-WRITE CLONING OF IMAGES<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#enable-copy-on-write-cloning-of-images" title="Permalink to this heading">ïƒ</a></h4><p>Note that this exposes the back end location via Glanceâ€™s API, so the endpoint with this option enabled should not be publicly accessible.</p><h5 id="ANY-OPENSTACK-VERSION-EXCEPT-MITAKAïƒ"><a href="#ANY-OPENSTACK-VERSION-EXCEPT-MITAKAïƒ" class="headerlink" title="ANY OPENSTACK VERSION EXCEPT MITAKAïƒ"></a>ANY OPENSTACK VERSION EXCEPT MITAKA<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#any-openstack-version-except-mitaka" title="Permalink to this heading">ïƒ</a></h5><p>If you want to enable copy-on-write cloning of images, also add under the <code>&lt;span class=&quot;pre&quot;&gt;[DEFAULT]&lt;/span&gt;</code> section:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_image_direct_url = True</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_image_direct_url = True</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨OpenStackä¸­ï¼ŒGlanceæ˜¯ç”¨äºç®¡ç†è™šæ‹Ÿæœºé•œåƒçš„ç»„ä»¶ï¼Œè€ŒCephåˆ™æ˜¯ä¸€ç§åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œå¸¸è¢«ç”¨äºOpenStackçš„åç«¯å­˜å‚¨ã€‚åœ¨ä½ æåˆ°çš„é…ç½®ä¸­ï¼Œ<code>show_image_direct_url = True</code> æ˜¯ç”¨äºé…ç½® Glance çš„ <code>glance-api.conf</code> æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒç”¨äºå¯ç”¨æˆ–ç¦ç”¨æ˜¾ç¤ºé•œåƒç›´æ¥URLçš„åŠŸèƒ½ã€‚å½“ä½ è®¾ç½® <code>show_image_direct_url = True</code> æ—¶ï¼ŒGlance API å°†åŒ…å«ä¸€ä¸ªåä¸º <code>direct_url</code> çš„å±æ€§ï¼Œè¯¥å±æ€§åŒ…å«æŒ‡å‘å­˜å‚¨é•œåƒç›´æ¥URLçš„é“¾æ¥ã€‚è¿™ä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ç›´æ¥URLè®¿é—®é•œåƒï¼Œè€Œä¸å¿…é€šè¿‡ Glance API æœåŠ¡ã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ˜¯æœ‰ç”¨çš„ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½ å¸Œæœ›é€šè¿‡ç›´æ¥é“¾æ¥å…±äº«é•œåƒç»™å…¶ä»–ç”¨æˆ·æˆ–ç³»ç»Ÿï¼Œè€Œæ— éœ€é€šè¿‡ Glance API ã€‚åœ¨ Ceph å’Œ OpenStack é›†æˆçš„æƒ…å†µä¸‹ï¼Œä½ éœ€è¦ç¡®ä¿ Glance é…ç½®æ–‡ä»¶ä¸­çš„ <code>default_store</code> è®¾ç½®ä¸º <code>rbd</code>ï¼Œä»¥ä¾¿å°†é•œåƒå­˜å‚¨åœ¨ Ceph RBDï¼ˆå—è®¾å¤‡ï¼‰åç«¯ã€‚åŒæ—¶ï¼Œä½ éœ€è¦é…ç½®å¥½ Ceph çš„è®¿é—®æƒé™ï¼Œç¡®ä¿ OpenStack çš„å„ä¸ªç»„ä»¶å¯ä»¥æ­£ç¡®åœ°è®¿é—®å’Œä½¿ç”¨ Ceph å­˜å‚¨ã€‚</p></blockquote><h2 id="ciner-å®˜ç½‘å‚è€ƒ"><a href="#ciner-å®˜ç½‘å‚è€ƒ" class="headerlink" title="ciner(å®˜ç½‘å‚è€ƒ)"></a>ciner(å®˜ç½‘å‚è€ƒ)</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/cinder/cinder-volume.conf</p><blockquote><p>OpenStack requires a driver to interact with Ceph block devices. You must also specify the pool name for the block device. On your OpenStack node, edit <code>/etc/cinder/cinder.conf</code> by adding:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">...</span><br><span class="line">enabled_backends = ceph</span><br><span class="line">glance_api_version = 2</span><br><span class="line">...</span><br><span class="line">[ceph]</span><br><span class="line">volume_driver = cinder.volume.drivers.rbd.RBDDriver</span><br><span class="line">volume_backend_name = ceph</span><br><span class="line">rbd_pool = volumes</span><br><span class="line">rbd_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">rbd_flatten_volume_from_snapshot = false</span><br><span class="line">rbd_max_clone_depth = 5</span><br><span class="line">rbd_store_chunk_size = 4</span><br><span class="line">rados_connect_timeout = -1</span><br></pre></td></tr></table></figure><p>If you are using <a href="https://docs.ceph.com/en/reef/rados/configuration/auth-config-ref/#enabling-disabling-cephx">cephx authentication</a>, also configure the user and uuid of the secret you added to <code> libvirt</code> as documented earlier:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ceph]</span><br><span class="line">...</span><br><span class="line">rbd_user = cinder</span><br><span class="line">rbd_secret_uuid = 457eb676-33da-42ec-9a8c-9293d545c337</span><br></pre></td></tr></table></figure><p>Note that if you are configuring multiple cinder back ends, <code>&lt;span class=&quot;pre&quot;&gt;glance_api_version&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span class=&quot;pre&quot;&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span class=&quot;pre&quot;&gt;2&lt;/span&gt;</code> must be in the <code>&lt;span class=&quot;pre&quot;&gt;[DEFAULT]&lt;/span&gt;</code> section.</p></blockquote><p><strong>enabled_backends = ceph</strong>  æ­¤é…ç½®å®é™…ä¸Šåç«¯æ‰‹åŠ¨æ“ä½œä¸ºå¦‚ä¸‹ å®é™…ä¸Šå°±æ˜¯åˆ›å»ºç£ç›˜æ—¶é€‰æ‹©çš„ç±»å‹ æ–°ç‰ˆæœ¬ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»º é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆå³å¯</p><p>æ¯”å¦‚ æˆ‘æ‰‹åŠ¨åˆ›å»ºrbd-1ç±»å‹æ—¶åˆ™ä¼šæŠ¥é”™ï¼š</p><p>æ‰§è¡Œ cinder type-key 1f90a0e1-3657-4d42-9965-4e9ab76ed635  set volume_backend_name=rbd-1 æŠ¥é”™<br>ERROR: Volume Type is currently in use. (HTTP 400) (Request-ID: req-48ab8f51-d024-45e4-a9f8-376f7c71bf45)</p><blockquote><p>cinder type-create ceph</p><p>cinder type-key 8a8a69b6-ec9f-4a09-8126-a211fce34ef3 set  volume_backend_name=ceph</p><p>cinder type-list</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_081d10d51610d49db32c3074544340f6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_081d10d51610d49db32c3074544340f6.png"></p></blockquote><h2 id="ciner-backup"><a href="#ciner-backup" class="headerlink" title="ciner-backup"></a>ciner-backup</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/cinder/cinder-backup.conf</p><p>äº‹å®ä¸Šé»˜è®¤ä½¿ç”¨çš„é©±åŠ¨æ˜¯swifté©±åŠ¨ ZzNnWn.ä½¿ç”¨é©±åŠ¨ä¸º<strong>cinder.backup.drivers.ceph.CephBackupDriver</strong> éœ€è¦æ³¨æ„çš„æ˜¯<strong>cinder.backup.drivers.ceph</strong>æ­¤é©±åŠ¨å·²å¼ƒç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">backup_driver= cinder.backup.drivers.swift.SwiftBackupDriver</span><br><span class="line">backup_driver=cinder.backup.drivers.swift.SwiftBackupDriver</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c901ca872c1b350140046935d9a97ad.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c901ca872c1b350140046935d9a97ad.png"></p><blockquote><p>å®˜ç½‘å¼•ç”¨</p><h3 id="CONFIGURING-CINDER-BACKUPïƒ"><a href="#CONFIGURING-CINDER-BACKUPïƒ" class="headerlink" title="CONFIGURING CINDER BACKUPïƒ"></a>CONFIGURING CINDER BACKUP<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#configuring-cinder-backup" title="Permalink to this heading">ïƒ</a></h3><p>OpenStack Cinder Backup requires a specific daemon so donâ€™t forget to install it. On your Cinder Backup node, edit <code>/etc/cinder/cinder.conf</code> and add:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">backup_driver = cinder.backup.drivers.ceph</span><br><span class="line">backup_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">backup_ceph_user = cinder-backup</span><br><span class="line">backup_ceph_chunk_size = 134217728</span><br><span class="line">backup_ceph_pool = backups</span><br><span class="line">backup_ceph_stripe_unit = 0</span><br><span class="line">backup_ceph_stripe_count = 0</span><br><span class="line">restore_discard_excess_bytes = <span class="literal">true</span></span><br></pre></td></tr></table></figure></blockquote><h2 id="novaä¸ceph"><a href="#novaä¸ceph" class="headerlink" title="novaä¸ceph"></a>novaä¸ceph</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/nova/nova-compute.conf</p><p>æ­¤å¤„åº”è®¾ç½®ä¸ºå¦‚ä¸‹</p><p>rbd_secret_uuid é€šè¿‡å¦‚ä¸‹ä¸¤ç§æ–¹å¼çš†å¯æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install libvirt-clients -y</span><br><span class="line">virsh secret-list  (æ­¤ç§ä¸ºå·²ä¸openstacké›†æˆæ‰èƒ½ä½¿ç”¨)</span><br><span class="line"><span class="built_in">cat</span> /etc/kolla/passwords.yml |grep rbd_secret_uuid</span><br></pre></td></tr></table></figure><p>å®Œæ•´é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># novaçš„é…ç½®</span></span><br><span class="line">vi /etc/kolla/config/nova/nova-compute.conf</span><br><span class="line"><span class="comment"># æ·»åŠ ï¼š   </span></span><br><span class="line">[libvirt]   </span><br><span class="line">virt_type=kvm  </span><br><span class="line">cpu_mode=none </span><br><span class="line">images_rbd_pool=vms</span><br><span class="line">images_type=rbd</span><br><span class="line">images_rbd_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line">rbd_user=nova</span><br><span class="line"><span class="comment"># rbd_secret_uuid=ea241bba-2031-4b0e-b750-c8356cbb46a8 (å¯é€‰ä¸éœ€è¦é…ç½®åç«¯ä¼šè‡ªåŠ¨ç”Ÿæˆ)</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5cdbe807c394a81c86e7f04b76d40922.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5cdbe807c394a81c86e7f04b76d40922.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4e38f71c5e42268c245ab6d95a5044b5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4e38f71c5e42268c245ab6d95a5044b5.png"></p><blockquote><p>å®˜ç½‘å¼•ç”¨</p><h3 id="CONFIGURING-NOVA-TO-ATTACH-CEPH-RBD-BLOCK-DEVICEïƒ"><a href="#CONFIGURING-NOVA-TO-ATTACH-CEPH-RBD-BLOCK-DEVICEïƒ" class="headerlink" title="CONFIGURING NOVA TO ATTACH CEPH RBD BLOCK DEVICEïƒ"></a>CONFIGURING NOVA TO ATTACH CEPH RBD BLOCK DEVICE<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#configuring-nova-to-attach-ceph-rbd-block-device" title="Permalink to this heading">ïƒ</a></h3><p>In order to attach Cinder devices (either normal block or by issuing a boot from volume), you must tell Nova (and libvirt) which user and UUID to refer to when attaching the device. libvirt will refer to this user when connecting and authenticating with the Ceph cluster.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[libvirt]</span><br><span class="line">...</span><br><span class="line">rbd_user = cinder</span><br><span class="line">rbd_secret_uuid = 457eb676-33da-42ec-9a8c-9293d545c337</span><br></pre></td></tr></table></figure><p>These two flags are also used by the Nova ephemeral back end.</p><h3 id="CONFIGURING-NOVAïƒ"><a href="#CONFIGURING-NOVAïƒ" class="headerlink" title="CONFIGURING NOVAïƒ"></a>CONFIGURING NOVA<a href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#configuring-nova" title="Permalink to this heading">ïƒ</a></h3><p>In order to boot virtual machines directly from Ceph volumes, you must configure the ephemeral backend for Nova.</p><p>It is recommended to enable the RBD cache in your Ceph configuration file; this has been enabled by default since the Giant release. Moreover, enabling the client admin socket allows the collection of metrics and can be invaluable for troubleshooting.</p><p>This socket can be accessed on the hypervisor (Nova compute) node:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph daemon /var/run/ceph/ceph-client.cinder.19195.32310016.asok help</span><br></pre></td></tr></table></figure><p>To enable RBD cache and admin sockets, ensure that on each hypervisorâ€™s <code>&lt;span class=&quot;pre&quot;&gt;ceph.conf&lt;/span&gt;</code> contains:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">    rbd cache = true</span><br><span class="line">    rbd cache writethrough until flush = true</span><br><span class="line">    admin socket = /var/run/ceph/guests/$cluster-$type.$id.$pid.$cctid.asok</span><br><span class="line">    log file = /var/log/qemu/qemu-guest-$pid.log</span><br><span class="line">    rbd concurrent management ops = 20</span><br></pre></td></tr></table></figure><p>Configure permissions for these directories:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /var/run/ceph/guests/ /var/log/qemu/</span><br><span class="line">chown qemu:libvirtd /var/run/ceph/guests /var/log/qemu/</span><br></pre></td></tr></table></figure><p>Note that user <code>&lt;span class=&quot;pre&quot;&gt;qemu&lt;/span&gt;</code> and group <code>&lt;span class=&quot;pre&quot;&gt;libvirtd&lt;/span&gt;</code> can vary depending on your system. The provided example works for RedHat based systems.</p><p>Tip</p><p>If your virtual machine is already running you can simply restart it to enable the admin socket</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•</title>
      <link href="/2024/04/01/openstack%E4%B8%8Eceph%E9%9B%86%E6%88%90%E5%AE%8C%E6%88%90%E5%90%8E%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/"/>
      <url>/2024/04/01/openstack%E4%B8%8Eceph%E9%9B%86%E6%88%90%E5%AE%8C%E6%88%90%E5%90%8E%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•"><a href="#openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•" class="headerlink" title="openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•"></a>openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•</h1><h2 id="ä¸€-glanceå¯¹æ¥åŠŸèƒ½æµ‹è¯•"><a href="#ä¸€-glanceå¯¹æ¥åŠŸèƒ½æµ‹è¯•" class="headerlink" title="ä¸€. glanceå¯¹æ¥åŠŸèƒ½æµ‹è¯•"></a>ä¸€. glanceå¯¹æ¥åŠŸèƒ½æµ‹è¯•</h2><h3 id="ä¸Šä¼ é•œåƒã€success-ã€‘"><a href="#ä¸Šä¼ é•œåƒã€success-ã€‘" class="headerlink" title="ä¸Šä¼ é•œåƒã€success!ã€‘"></a>ä¸Šä¼ é•œåƒã€success!ã€‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸Šä¼ é•œåƒ</span></span><br><span class="line">root@localhost:~<span class="comment"># openstack image create &quot;cirros-0.4.0-x86_64&quot; --file cirros-0.4.0-x86_64-disk.img --disk-format qcow2 --container-format bare --public</span></span><br><span class="line"><span class="comment"># éªŒè¯</span></span><br><span class="line">root@localhost:~<span class="comment"># glance image-list</span></span><br><span class="line">+--------------------------------------+---------------------+</span><br><span class="line">| ID                                   | Name                |</span><br><span class="line">+--------------------------------------+---------------------+</span><br><span class="line">| 73d31ccc-8eae-49e9-a0a7-2731e5a3806a | cirros-0.4.0-x86_64 |</span><br><span class="line">+--------------------------------------+---------------------+</span><br><span class="line">root@localhost:~<span class="comment"># rbd -p images ls</span></span><br><span class="line">73d31ccc-8eae-49e9-a0a7-2731e5a3806a</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å—è®¾å¤‡(é•œåƒ)è¯¦æƒ…</span></span><br><span class="line">root@localhost:~<span class="comment"># rbd -p images info 73d31ccc-8eae-49e9-a0a7-2731e5a3806a</span></span><br><span class="line">rbd image <span class="string">&#x27;73d31ccc-8eae-49e9-a0a7-2731e5a3806a&#x27;</span>:</span><br><span class="line">        size 12 MiB <span class="keyword">in</span> 2 objects</span><br><span class="line">        order 23 (8 MiB objects)</span><br><span class="line">        snapshot_count: 1</span><br><span class="line">        <span class="built_in">id</span>: 1c4b9299cdad7</span><br><span class="line">        block_name_prefix: rbd_data.1c4b9299cdad7</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        access_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        modify_timestamp: Tue Apr  2 05:43:02 2024</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¿«ç…§ã€å­˜åœ¨ã€‘"><a href="#æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¿«ç…§ã€å­˜åœ¨ã€‘" class="headerlink" title="æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¿«ç…§ã€å­˜åœ¨ã€‘"></a>æŸ¥çœ‹æ˜¯å¦å­˜åœ¨å¿«ç…§ã€å­˜åœ¨ã€‘</h3><p><strong>protected: True</strong>(æ­¤å¤„â€“æ­¤æ ‡ç­¾è¡¨ç¤ºè¢«ä¿æŠ¤èµ·æ¥äº† æ— æ³•ç›´æ¥åˆ é™¤ åé¢é›†æˆnovaå ä½¿ç”¨æ­¤é•œåƒåˆ›å»ºè™šæ‹Ÿæœº ä»–ä¼šé’ˆå¯¹æ­¤é•œåƒå¿«ç…§ å…‹éš†ä¸€ä¸ªå‡ºæ¥)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:~<span class="comment"># rbd snap ls images/73d31ccc-8eae-49e9-a0a7-2731e5a3806a</span></span><br><span class="line">SNAPID  NAME  SIZE    PROTECTED  TIMESTAMP   </span><br><span class="line">    13  snap  12 MiB  <span class="built_in">yes</span>        Tue Apr  2 05:43:04 2024</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å¿«ç…§è¯¦æƒ…</span></span><br><span class="line">root@localhost:~<span class="comment"># rbd info images/73d31ccc-8eae-49e9-a0a7-2731e5a3806a@snap</span></span><br><span class="line">rbd image <span class="string">&#x27;73d31ccc-8eae-49e9-a0a7-2731e5a3806a&#x27;</span>:</span><br><span class="line">        size 12 MiB <span class="keyword">in</span> 2 objects</span><br><span class="line">        order 23 (8 MiB objects)</span><br><span class="line">        snapshot_count: 1</span><br><span class="line">        <span class="built_in">id</span>: 1c4b9299cdad7</span><br><span class="line">        block_name_prefix: rbd_data.1c4b9299cdad7</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        access_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        modify_timestamp: Tue Apr  2 05:43:02 2024</span><br><span class="line">        protected: True  (æ­¤å¤„--æ­¤æ ‡ç­¾è¡¨ç¤ºè¢«ä¿æŠ¤èµ·æ¥äº†)</span><br></pre></td></tr></table></figure><h3 id="æ—¥å¿—æŸ¥çœ‹"><a href="#æ—¥å¿—æŸ¥çœ‹" class="headerlink" title="æ—¥å¿—æŸ¥çœ‹"></a>æ—¥å¿—æŸ¥çœ‹</h3><p>kolla-ansibleéƒ¨ç½²çš„é›†ç¾¤<strong>glance</strong>å‡ºç°é—®é¢˜å¯åœ¨<code>/var/log/kolla/glance/glance-api.log</code>ä¸­æŸ¥çœ‹<strong>æ­¤æ—¶glanceå¯¹æ¥å®Œæˆã€‚</strong></p><h2 id="äºŒ-cinerå¯¹æ¥åŠŸèƒ½æµ‹è¯•"><a href="#äºŒ-cinerå¯¹æ¥åŠŸèƒ½æµ‹è¯•" class="headerlink" title="äºŒ. cinerå¯¹æ¥åŠŸèƒ½æµ‹è¯•"></a>äºŒ. cinerå¯¹æ¥åŠŸèƒ½æµ‹è¯•</h2><h3 id="å‰ç«¯é¡µé¢åˆ›å»ºç£ç›˜åç«¯cephæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€success-ã€‘"><a href="#å‰ç«¯é¡µé¢åˆ›å»ºç£ç›˜åç«¯cephæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€success-ã€‘" class="headerlink" title="å‰ç«¯é¡µé¢åˆ›å»ºç£ç›˜åç«¯cephæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€success!ã€‘"></a>å‰ç«¯é¡µé¢åˆ›å»ºç£ç›˜åç«¯cephæŸ¥çœ‹æ˜¯å¦æˆåŠŸã€success!ã€‘</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c52afb0c1b17c459ac6dc022eff72bf8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_c52afb0c1b17c459ac6dc022eff72bf8.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">oot@localhost:~<span class="comment"># rbd -p volumes ls |grep cdfce732-c69f-4ea6-9f95-181c19b932dd</span></span><br><span class="line">volume-cdfce732-c69f-4ea6-9f95-181c19b932dd</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="æ‰©å®¹äº‘ç¡¬ç›˜ã€success-ã€‘"><a href="#æ‰©å®¹äº‘ç¡¬ç›˜ã€success-ã€‘" class="headerlink" title="æ‰©å®¹äº‘ç¡¬ç›˜ã€success!ã€‘"></a>æ‰©å®¹äº‘ç¡¬ç›˜ã€success!ã€‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:~<span class="comment"># rbd -p volumes info volume-cdfce732-c69f-4ea6-9f95-181c19b932dd</span></span><br><span class="line">rbd image <span class="string">&#x27;volume-cdfce732-c69f-4ea6-9f95-181c19b932dd&#x27;</span>:</span><br><span class="line">        size 5 GiB <span class="keyword">in</span> 1280 objects   ã€æˆåŠŸæ‰©å®¹åˆ°äº†5Gã€‘</span><br><span class="line">        order 22 (4 MiB objects)</span><br><span class="line">        snapshot_count: 0</span><br><span class="line">        <span class="built_in">id</span>: 1ce49280a276</span><br><span class="line">        block_name_prefix: rbd_data.1ce49280a276</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        access_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        modify_timestamp: Tue Apr  2 07:01:15 2024</span><br></pre></td></tr></table></figure><h3 id="åˆ›å»ºå¿«ç…§ã€å‰ç«¯-åç«¯-success-ã€‘"><a href="#åˆ›å»ºå¿«ç…§ã€å‰ç«¯-åç«¯-success-ã€‘" class="headerlink" title="åˆ›å»ºå¿«ç…§ã€å‰ç«¯/åç«¯ success!ã€‘"></a>åˆ›å»ºå¿«ç…§ã€å‰ç«¯/åç«¯ success!ã€‘</h3><p>æŸ¥çœ‹åç«¯å¿«ç…§åŠå¿«ç…§è¯¦æƒ…</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">root@localhost:~<span class="comment"># rbd -p  volumes ls</span></span><br><span class="line">volume-0069c8f9-4f25-4233-91a9-a2f27006f208</span><br><span class="line">volume-0b204bfd-a83b-4d02-aa5c-b7894d710f07</span><br><span class="line">volume-69c5a7f6-fdc8-4c81-9a24-9ffc3aa413ce</span><br><span class="line">volume-ad6ee530-b73e-4605-b0aa-fc6813e10b8a</span><br><span class="line">volume-cdfce732-c69f-4ea6-9f95-181c19b932dd</span><br><span class="line">root@localhost:~<span class="comment"># rbd -p volumes snap ls  volume-cdfce732-c69f-4ea6-9f95-181c19b932dd</span></span><br><span class="line">SNAPID  NAME                                           SIZE   PROTECTED  TIMESTAMP             </span><br><span class="line">    10  snapshot-d8b94a76-c1b1-48c6-a5f7-d7a478b5cf8c  5 GiB  <span class="built_in">yes</span>        Tue Apr  2 07:23:35 2024</span><br><span class="line">root@localhost:~<span class="comment"># rbd info volumes/volume-cdfce732-c69f-4ea6-9f95-181c19b932dd@snapshot-d8b94a76-c1b1-48c6-a5f7-d7a478b5cf8c</span></span><br><span class="line">rbd image <span class="string">&#x27;volume-cdfce732-c69f-4ea6-9f95-181c19b932dd&#x27;</span>:</span><br><span class="line">        size 5 GiB <span class="keyword">in</span> 1280 objects</span><br><span class="line">        order 22 (4 MiB objects)</span><br><span class="line">        snapshot_count: 1</span><br><span class="line">        <span class="built_in">id</span>: 1ce49280a276</span><br><span class="line">        block_name_prefix: rbd_data.1ce49280a276</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering, exclusive-lock, object-map, fast-diff, deep-flatten</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        access_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        modify_timestamp: Tue Apr  2 07:01:15 2024</span><br><span class="line">        protected: True</span><br></pre></td></tr></table></figure><h3 id="æ—¥å¿—æŸ¥çœ‹-1"><a href="#æ—¥å¿—æŸ¥çœ‹-1" class="headerlink" title="æ—¥å¿—æŸ¥çœ‹"></a>æ—¥å¿—æŸ¥çœ‹</h3><p>æŠ¥é”™æŸ¥çœ‹cineræ—¥å¿—æ–‡ä»¶ç›®å½•ï¼š/var/log/kolla/cinder/</p><p>cinder-api-access.log  cinder-api-error.log  cinder-api.log  cinder-backup.log  cinder-scheduler.log  cinder-volume.log</p><p><strong>ciner</strong>å¯¹æ¥å®Œæˆã€‚</p><h2 id="ä¸‰-ciner-backupå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€å‰ç«¯-åç«¯success-ã€‘"><a href="#ä¸‰-ciner-backupå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€å‰ç«¯-åç«¯success-ã€‘" class="headerlink" title="ä¸‰. ciner-backupå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€å‰ç«¯/åç«¯success!ã€‘"></a>ä¸‰. ciner-backupå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€å‰ç«¯/åç«¯success!ã€‘</h2><h3 id="åˆ›å»ºäº‘ç¡¬ç›˜å¤‡ä»½"><a href="#åˆ›å»ºäº‘ç¡¬ç›˜å¤‡ä»½" class="headerlink" title="åˆ›å»ºäº‘ç¡¬ç›˜å¤‡ä»½"></a>åˆ›å»ºäº‘ç¡¬ç›˜å¤‡ä»½</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_baec65a01ef1848667e37913f18fb4a2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_baec65a01ef1848667e37913f18fb4a2.png"></p><p>å‰ç«¯åˆ›å»ºå®Œæˆå…¶å®åç«¯å®ç°æ–¹å¼å¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¸®åŠ©</span></span><br><span class="line">cinder -h |grep backup</span><br><span class="line">cinder <span class="built_in">help</span> backup-create</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># cinder list</span></span><br><span class="line">+--------------------------------------+-----------+-------------+------+----------------+-------------+----------+-------------+</span><br><span class="line">| ID                                   | Status    | Name        | Size | Consumes Quota | Volume Type | Bootable | Attached to |</span><br><span class="line">+--------------------------------------+-----------+-------------+------+----------------+-------------+----------+-------------+</span><br><span class="line">| cdfce732-c69f-4ea6-9f95-181c19b932dd | available | cinder-test | 5    | True           | __DEFAULT__ | <span class="literal">false</span>    |             |</span><br><span class="line">+--------------------------------------+-----------+-------------+------+----------------+-------------+----------+-------------+</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯¹å…¶è¿›è¡Œå¤‡ä»½</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># cinder backup-create cdfce732-c69f-4ea6-9f95-181c19b932dd --name backup-demo</span></span><br><span class="line">+-----------+--------------------------------------+</span><br><span class="line">| Property  | Value                                |</span><br><span class="line">+-----------+--------------------------------------+</span><br><span class="line">| <span class="built_in">id</span>        | c9c3ef24-e310-4685-aa54-64cd6fa7d08b |</span><br><span class="line">| name      | backup-demo                          |</span><br><span class="line">| volume_id | cdfce732-c69f-4ea6-9f95-181c19b932dd |</span><br><span class="line">+-----------+--------------------------------------+</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># cinder backup-list</span></span><br><span class="line">+--------------------------------------+--------------------------------------+-----------+-------------+------+--------------+-----------+----------------------------------+</span><br><span class="line">| ID                                   | Volume ID                            | Status    | Name        | Size | Object Count | Container | User ID                          |</span><br><span class="line">+--------------------------------------+--------------------------------------+-----------+-------------+------+--------------+-----------+----------------------------------+</span><br><span class="line">| 6774233c-007a-4d49-a8a7-38dc9993b440 | cdfce732-c69f-4ea6-9f95-181c19b932dd | available | <span class="built_in">test</span>        | 5    | 0            | backups   | d9737a89a5754af99610d37225abd070 |</span><br><span class="line">| c9c3ef24-e310-4685-aa54-64cd6fa7d08b | cdfce732-c69f-4ea6-9f95-181c19b932dd | available | backup-demo | 5    | 0            | backups   | d9737a89a5754af99610d37225abd070 |</span><br><span class="line">+--------------------------------------+--------------------------------------+-----------+-------------+------+--------------+-----------+----------------------------------+</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·è¯¦æƒ…</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># cinder backup-show 6774233c-007a-4d49-a8a7-38dc9993b440</span></span><br><span class="line">+-----------------------------------+--------------------------------------+</span><br><span class="line">| Property                          | Value                                |</span><br><span class="line">+-----------------------------------+--------------------------------------+</span><br><span class="line">| availability_zone                 | None                                 |</span><br><span class="line">| container                         | backups                              |</span><br><span class="line">| created_at                        | 2024-04-02T07:48:41.000000           |</span><br><span class="line">| data_timestamp                    | 2024-04-02T07:48:41.000000           |</span><br><span class="line">| description                       | None                                 |</span><br><span class="line">| fail_reason                       | None                                 |</span><br><span class="line">| has_dependent_backups             | False                                |</span><br><span class="line">| <span class="built_in">id</span>                                | 6774233c-007a-4d49-a8a7-38dc9993b440 |</span><br><span class="line">| is_incremental                    | False                                |</span><br><span class="line">| metadata                          | &#123;&#125;                                   |</span><br><span class="line">| name                              | <span class="built_in">test</span>                                 |</span><br><span class="line">| object_count                      | 0                                    |</span><br><span class="line">| os-backup-project-attr:project_id | 2cb7b9ee85ab4d8a8257723a08c8a032     |</span><br><span class="line">| size                              | 5                                    |</span><br><span class="line">| snapshot_id                       | None                                 |</span><br><span class="line">| status                            | available                            |</span><br><span class="line">| updated_at                        | 2024-04-02T07:49:01.000000           |</span><br><span class="line">| user_id                           | d9737a89a5754af99610d37225abd070     |</span><br><span class="line">| volume_id                         | cdfce732-c69f-4ea6-9f95-181c19b932dd |</span><br><span class="line">+-----------------------------------+--------------------------------------+</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å·å®é™…ä¸Šå°±æ˜¯æŠŠå·æ‹·è´è¿‡æ¥ä¸€ä»½</span></span><br><span class="line">root@localhost:/var/log/kolla/cinder<span class="comment"># rbd -p backups ls</span></span><br><span class="line">volume-cdfce732-c69f-4ea6-9f95-181c19b932dd.backup.6774233c-007a-4d49-a8a7-38dc9993b440</span><br><span class="line">volume-cdfce732-c69f-4ea6-9f95-181c19b932dd.backup.c9c3ef24-e310-4685-aa54-64cd6fa7d08b</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>ciner-backup</strong>å¯¹æ¥å®Œæˆã€‚</p><h2 id="å››-nova-libvirt-ä¸cephå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€successï¼ã€‘"><a href="#å››-nova-libvirt-ä¸cephå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€successï¼ã€‘" class="headerlink" title="å››. nova(libvirt)ä¸cephå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€successï¼ã€‘"></a>å››. nova(libvirt)ä¸cephå¯¹æ¥åŠŸèƒ½æµ‹è¯•ã€successï¼ã€‘</h2><h3 id="åˆ›å»ºè™šæ‹Ÿæœºæµ‹è¯•-å‰ç«¯åˆ›å»ºåç«¯éªŒè¯"><a href="#åˆ›å»ºè™šæ‹Ÿæœºæµ‹è¯•-å‰ç«¯åˆ›å»ºåç«¯éªŒè¯" class="headerlink" title="åˆ›å»ºè™šæ‹Ÿæœºæµ‹è¯• (å‰ç«¯åˆ›å»ºåç«¯éªŒè¯)"></a>åˆ›å»ºè™šæ‹Ÿæœºæµ‹è¯• (å‰ç«¯åˆ›å»ºåç«¯éªŒè¯)</h3><p><strong>æŸ¥çœ‹ç³»ç»Ÿç›˜</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(venv3) root@localhost:~<span class="comment"># rbd -p volumes ls |grep 39a0ae42-08b3-4885-850f-12536e3d2051</span></span><br><span class="line">volume-39a0ae42-08b3-4885-850f-12536e3d2051</span><br><span class="line">(venv3) root@localhost:~<span class="comment"># rbd device list</span></span><br><span class="line">(venv3) root@localhost:~<span class="comment">#</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_245c6b28748b4fb29da0f259cc4be37d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_245c6b28748b4fb29da0f259cc4be37d.png"></p>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦åŠgrafanaé¢æ¿è®¾ç½®</title>
      <link href="/2024/03/28/zabbix%E7%9B%91%E6%8E%A7%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AE%E6%8A%A5%E8%AD%A6%E5%8F%8Agrafana%E9%9D%A2%E6%9D%BF%E8%AE%BE%E7%BD%AE/"/>
      <url>/2024/03/28/zabbix%E7%9B%91%E6%8E%A7%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AE%E6%8A%A5%E8%AD%A6%E5%8F%8Agrafana%E9%9D%A2%E6%9D%BF%E8%AE%BE%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦"><a href="#zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦" class="headerlink" title="zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦"></a>zabbixç›‘æ§äº¤æ¢æœºé…ç½®æŠ¥è­¦</h1><h2 id="ä¸€-ä¼ä¸šå¾®ä¿¡æŠ¥è­¦"><a href="#ä¸€-ä¼ä¸šå¾®ä¿¡æŠ¥è­¦" class="headerlink" title="ä¸€. ä¼ä¸šå¾®ä¿¡æŠ¥è­¦"></a>ä¸€. ä¼ä¸šå¾®ä¿¡æŠ¥è­¦</h2><p>åç«¯é…ç½®<br>è¯­è¨€ï¼š<strong>shell</strong><br>è„šæœ¬ï¼š/usr/lib/zabbix/alertscripts/weixin.sh<br>ç»„åæ”¹ä¸ºï¼š<strong>zabbix:zabbix</strong><br><strong>chmod a+x weixin.sh</strong>  èµ‹äºˆæ‰§è¡Œæƒé™<br><strong>weixin.sh</strong>è„šæœ¬å†…å®¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># è„šæœ¬ä½¿ç”¨ï¼šzz=`ls -l`</span></span><br><span class="line"><span class="comment"># ./weixin.sh test  &#123;&quot;errcode&quot;:0,&quot;errmsg&quot;:&quot;$zz&quot;,&quot;invaliduser&quot;:&quot;&quot;&#125;</span></span><br><span class="line"><span class="comment"># ./weixin.sh test  &#123;&quot;errcode&quot;:0,&quot;GEGEWU-TEST&quot;:&quot;\nåºŠå‰æ˜æœˆå…‰\nç–‘æ˜¯åœ°ä¸Šéœœ\nä¸¾å¤´æœ›æ˜æœˆ\nä½å¤´æ€æ•…ä¹¡&quot;,&quot;invaliduser&quot;:&quot;&quot;&#125;</span></span><br><span class="line">CorpID=<span class="string">&quot;ww83dd692579d&quot;</span>                             <span class="comment"># ä½ çš„ä¼ä¸šid</span></span><br><span class="line">Secret=<span class="string">&quot;LSwoGzg-lXJFFkSztBptbgAfLrps&quot;</span>    <span class="comment"># ä½ çš„SecretID</span></span><br><span class="line">GURL=<span class="string">&quot;https://qyapi.weixin.qq.com/cgi-bin/gettoken?corpid=<span class="variable">$CorpID</span>&amp;corpsecret=<span class="variable">$Secret</span>&quot;</span></span><br><span class="line">Token=$(/usr/bin/curl -s -G <span class="variable">$GURL</span> |awk -F\&quot;: <span class="string">&#x27;&#123;print $4&#125;&#x27;</span>|awk -F\&quot; <span class="string">&#x27;&#123;print $2&#125;&#x27;</span>)</span><br><span class="line"><span class="comment"># echo $Token</span></span><br><span class="line">PURL=<span class="string">&quot;https://qyapi.weixin.qq.com/cgi-bin/message/send?access_token=<span class="variable">$Token</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">body</span></span>()&#123;</span><br><span class="line">        <span class="built_in">local</span> int agentid=1000002               <span class="comment"># ä½ çš„agentdid</span></span><br><span class="line">        <span class="built_in">local</span> UserID=<span class="string">&quot;@all&quot;</span>                     <span class="comment"># å‘é€çš„ç”¨æˆ·ID</span></span><br><span class="line">        <span class="built_in">local</span> PartyID=2                         <span class="comment"># éƒ¨é—¨ID</span></span><br><span class="line">        <span class="built_in">local</span> Msg=$(<span class="built_in">echo</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span> | <span class="built_in">cut</span> -d<span class="string">&quot; &quot;</span> -f3-) <span class="comment"># å‘é€ç»™æ‰€æœ‰äºº</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;&#123;\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;touser&quot;: &quot;&#x27;</span><span class="string">&quot;<span class="variable">$UserID</span>&quot;</span>\&quot;<span class="string">&quot;,\n&quot;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;toparty&quot;: &quot;&#x27;</span><span class="string">&quot;<span class="variable">$PartyID</span>&quot;</span>\&quot;<span class="string">&quot;,\n&quot;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;msgtype&quot;: &quot;text&quot;,\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;agentid&quot;: &quot;&#x27;</span><span class="string">&quot;<span class="variable">$agentid</span>&quot;</span>\&quot;<span class="string">&quot;,\n&quot;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;text&quot;: &#123;\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t\t&quot;content&quot;: &quot;&#x27;</span><span class="string">&quot;<span class="variable">$Msg</span>&quot;</span>\&quot;<span class="string">&quot;\n&quot;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&#125;,\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;\t&quot;safe&quot;:&quot;0&quot;\n&#x27;</span></span><br><span class="line">        <span class="built_in">printf</span> <span class="string">&#x27;&#125;\n&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line">/usr/bin/curl --data-ascii <span class="string">&quot;<span class="subst">$(body $1 $2 $3)</span>&quot;</span> <span class="variable">$PURL</span></span><br></pre></td></tr></table></figure><p>å¯ç”¨æ€§æµ‹è¯•</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6423a1843860753100db9c0cb961464a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6423a1843860753100db9c0cb961464a.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9eeec69992482f2c02585016a1a9ebc.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9eeec69992482f2c02585016a1a9ebc.png"></p><p>ä»¥ä¸Šå¾®ä¿¡æŠ¥è­¦åç«¯é…ç½®å®Œæ¯•ï¼</p><h3 id="1-zabbixå‰ç«¯é¡µé¢é…ç½®å‘Šè­¦"><a href="#1-zabbixå‰ç«¯é¡µé¢é…ç½®å‘Šè­¦" class="headerlink" title="1. zabbixå‰ç«¯é¡µé¢é…ç½®å‘Šè­¦"></a>1. zabbixå‰ç«¯é¡µé¢é…ç½®å‘Šè­¦</h3><h4 id="1-0-ç®¡ç†-ç”¨æˆ·-é…ç½®æŠ¥è­¦æ—¶é—´-ç­‰çº§"><a href="#1-0-ç®¡ç†-ç”¨æˆ·-é…ç½®æŠ¥è­¦æ—¶é—´-ç­‰çº§" class="headerlink" title="1.0. ç®¡ç†-ç”¨æˆ· é…ç½®æŠ¥è­¦æ—¶é—´ ç­‰çº§"></a>1.0. ç®¡ç†-ç”¨æˆ· é…ç½®æŠ¥è­¦æ—¶é—´ ç­‰çº§</h4><p>ç‰¹åˆ«è¯´æ˜ï¼šæ”¶ä»¶äºº-2   2 ä¸ºæŠ¥è­¦<strong>æœºå™¨äººæ‰€åœ¨çš„béƒ¨é—¨id</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_888125f3de45e9c9945bac3b5d692349.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_888125f3de45e9c9945bac3b5d692349.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_b6fa1a78467aa2bbbaad45ef6447659a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_b6fa1a78467aa2bbbaad45ef6447659a.png"></p><h4 id="1-1-æŠ¥è­¦åª’ä»‹ç±»å‹"><a href="#1-1-æŠ¥è­¦åª’ä»‹ç±»å‹" class="headerlink" title="1.1. æŠ¥è­¦åª’ä»‹ç±»å‹"></a>1.1. æŠ¥è­¦åª’ä»‹ç±»å‹</h4><p><strong>ç®¡ç†-æŠ¥è­¦åª’ä»‹ç±»å‹-åˆ›å»ºåª’ä½“ç±»å‹</strong></p><p><strong>è„šæœ¬å‚æ•°</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;ALERT.SENDTO&#125;</span><br><span class="line">&#123;ALERT.SUBJECT&#125;</span><br><span class="line">&#123;ALERT.MESSAGE&#125;</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8c5386fe48f1b7a90f3c7ef75ed02192.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8c5386fe48f1b7a90f3c7ef75ed02192.png"></p><p><strong>è®¾ç½®é»˜è®¤æŠ¥è­¦å‘é€ä¿¡æ¯</strong></p><p>ç®¡ç†-æŠ¥è­¦åª’ä»‹ç±»å‹-åˆ›å»ºåª’ä½“ç±»å‹-message templates 3-ç‚¹å‡»æ·»åŠ -é€‰æ‹©-é—®é¢˜</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ä¸»é¢˜ï¼š</span><br><span class="line">æ•…éšœ&#123;TRIGGER.STATUS&#125;,æœºå™¨:&#123;HOSTNAME1&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;æ•…éšœ!</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line"> </span><br><span class="line">å‘Šè­¦æœºå™¨:&#123;HOSTNAME1&#125;</span><br><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;</span><br><span class="line">å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125;</span><br><span class="line">é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br></pre></td></tr></table></figure><p><strong>ç‚¹å‡»é€‰æ‹©ï¼šproblem recovery</strong></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ä¸»é¢˜ï¼š</span><br><span class="line">æ¢å¤&#123;TRIGGER.STATUS&#125;, æœºå™¨:&#123;HOSTNAME1&#125;: &#123;TRIGGER.NAME&#125;å·²æ¢å¤!</span><br><span class="line"> </span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line">å‘Šè­¦æœºå™¨:&#123;HOSTNAME1&#125;</span><br><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;</span><br><span class="line">å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125;</span><br><span class="line">é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br></pre></td></tr></table></figure><p><strong>è®¾ç½®å¥½åæ ·å¼</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_5f6c7c481dd5a5e6f394abbc3edfbc91.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_5f6c7c481dd5a5e6f394abbc3edfbc91.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7317fad2e7265063fc284c4657d37336.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7317fad2e7265063fc284c4657d37336.png"></p><p><strong>é…ç½®-åŠ¨ä½œ-Tigger actions-åˆ›å»ºåŠ¨ä½œå¾®ä¿¡å‘Šè­¦</strong></p><ul><li>åç§° :  å¾®ä¿¡æŠ¥è­¦</li><li>è®¡ç®—æ–¹å¼ : å’Œï¼ˆåŒæ—¶æ»¡è¶³ï¼‰(A and B) and C</li><li>æ¡ä»¶</li></ul><table><thead><tr><th>æ ‡ç­¾</th><th>åç§°</th><th>åŠ¨ä½œ</th></tr></thead><tbody><tr><td><strong>A</strong></td><td>è§¦å‘å™¨åç§° ä¸å«<em>Dialer</em></td><td>ç§»é™¤</td></tr><tr><td><strong>B</strong></td><td>è§¦å‘å™¨åç§° åŒ…å«<em>down</em></td><td>ç§»é™¤</td></tr><tr><td><strong>C</strong></td><td>ä¸»æœºç¾¤ç»„ ä¸ç­‰äº<em>å¼ å®¶å£</em></td><td>ç§»é™¤</td></tr><tr><td>æ·»åŠ </td><td></td><td></td></tr></tbody></table><p>  <strong>æœ¬æ–‡ä½¿ç”¨æ­¤<br>  åç§° :  å¾®ä¿¡æŠ¥è­¦</strong><br>  è®¡ç®—æ–¹å¼ : ä¸/æˆ– ï¼ˆé»˜è®¤ï¼‰</p><table><thead><tr><th>æ ‡ç­¾</th><th>åç§°</th><th>åŠ¨ä½œ</th></tr></thead><tbody><tr><td><strong>A</strong></td><td>è§¦å‘å™¨ç¤ºè­¦åº¦ å¤§äºç­‰äº è­¦å‘Š</td><td>ç§»é™¤</td></tr><tr><td><strong>B</strong></td><td>è§¦å‘å™¨ç¤ºè­¦åº¦Â å¤§äºç­‰äº æœªåˆ†ç±»</td><td>ç§»é™¤</td></tr><tr><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td></tr></tbody></table><p>  <img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8beb0459a4e8371c8d40f0b0e0bba60b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8beb0459a4e8371c8d40f0b0e0bba60b.png"></p><p>  <img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3ea30163e5c0105262ced1c11bf11d7d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3ea30163e5c0105262ced1c11bf11d7d.png"></p><ul><li><p>å·²å¯ç”¨ [X]</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_30dad5e3e18fbd9afa4fd05d59d22ec8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_30dad5e3e18fbd9afa4fd05d59d22ec8.png"></p></li></ul><p><strong>è®¾ç½®æ“ä½œ</strong></p><p>å‘Šè­¦ç»†èŠ‚</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è®¾å¤‡:&#123;HOST.NAME&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;å‘Šè­¦!\nå‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;\nå‘Šè­¦åœ°å€:&#123;HOST.IP&#125;\nå‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br></pre></td></tr></table></figure><p>æ¢å¤ç»†èŠ‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;\nå‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;å·²æ¢å¤ï¼\nå½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;\nå‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;\næ¢å¤æ—¶é—´:&#123;EVENT.RECOVERY.DATE&#125; &#123;EVENT.RECOVERY.TIME&#125;\næŒç»­æ—¶é—´:&#123;EVENT.AGE&#125;</span><br></pre></td></tr></table></figure><p><strong>æ›´æ–°æš‚æ—¶ä¸å†™</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_2c6085aabbe2423e90b8f16a44cd3b1e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_2c6085aabbe2423e90b8f16a44cd3b1e.png"></p><h4 id="1-2-æˆ–è€…è®¾ç½®å¦‚ä¸‹å†—é•¿ç‰ˆæœ¬è®¾ç½®æ–¹å¼å¦‚ä¸‹å‚è€ƒ"><a href="#1-2-æˆ–è€…è®¾ç½®å¦‚ä¸‹å†—é•¿ç‰ˆæœ¬è®¾ç½®æ–¹å¼å¦‚ä¸‹å‚è€ƒ" class="headerlink" title="1.2. æˆ–è€…è®¾ç½®å¦‚ä¸‹å†—é•¿ç‰ˆæœ¬è®¾ç½®æ–¹å¼å¦‚ä¸‹å‚è€ƒ"></a>1.2. æˆ–è€…è®¾ç½®å¦‚ä¸‹å†—é•¿ç‰ˆæœ¬è®¾ç½®æ–¹å¼å¦‚ä¸‹å‚è€ƒ</h4><p>æ“ä½œ æ·»åŠ <br>æ­¥éª¤é€‰æ‹©ï¼š1-1<br>æ­¥éª¤æ—¶é—´ï¼š0 ï¼ˆé»˜è®¤ï¼‰<br>ç”¨æˆ·ç¾¤ç»„é»˜è®¤ç®¡ç†å‘˜ç¾¤ç»„ ï¼šZabbix administrators<br>ä»…å‘é€åˆ°ï¼šå¾®ä¿¡å‘Šè­¦<br>cus message ï¼š [X]</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ä¸»é¢˜ï¼š</span><br><span class="line">æ•…éšœ&#123;TRIGGER.STATUS&#125;,æœºå™¨:&#123;HOSTNAME1&#125;å‘ç”Ÿ: &#123;TRIGGER.NAME&#125;æ•…éšœ!</span><br><span class="line"> </span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line">å‘Šè­¦æœºå™¨:&#123;HOSTNAME1&#125;</span><br><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å‘Šè­¦ä¿¡æ¯: &#123;TRIGGER.NAME&#125;</span><br><span class="line">å‘Šè­¦é¡¹ç›®:&#123;TRIGGER.KEY1&#125;</span><br><span class="line">é—®é¢˜è¯¦æƒ…:&#123;ITEM.NAME&#125;:&#123;ITEM.VALUE&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;:&#123;ITEM.VALUE1&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br><span class="line">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span><br></pre></td></tr></table></figure><p>æ¢å¤æ“ä½œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">ä¸»é¢˜ï¼š</span><br><span class="line">æœºå™¨:&#123;HOST.NAME&#125;: &#123;TRIGGER.NAME&#125;å·²æ¢å¤!</span><br><span class="line"> </span><br><span class="line">æ¶ˆæ¯ï¼š</span><br><span class="line">æœºå™¨:&#123;HOST.NAME&#125;: &#123;TRIGGER.NAME&#125;å·²æ¢å¤!</span><br><span class="line">å‘Šè­¦ä¸»æœº:&#123;HOST.NAME&#125;</span><br><span class="line">å‘Šè­¦åœ°å€:&#123;HOST.IP&#125;</span><br><span class="line">ç›‘æ§å–å€¼:&#123;ITEM.LASTVALUE&#125;</span><br><span class="line">å‘Šè­¦ç­‰çº§:&#123;TRIGGER.SEVERITY&#125;</span><br><span class="line">å½“å‰çŠ¶æ€:&#123;TRIGGER.STATUS&#125;</span><br><span class="line">å‘Šè­¦æ—¶é—´:&#123;EVENT.DATE&#125; &#123;EVENT.TIME&#125;</span><br><span class="line">æ¢å¤æ—¶é—´:&#123;EVENT.RECOVERY.DATE&#125; &#123;EVENT.RECOVERY.TIME&#125;</span><br><span class="line">æŒç»­æ—¶é—´:&#123;EVENT.AGE&#125;</span><br><span class="line">äº‹ä»¶ID:&#123;EVENT.ID&#125;</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šæ›´æ–°æ“ä½œæš‚æ—¶ä¸å†™ã€‚<br>æ­¤æ—¶ç‚¹å‡»å¯ç”¨æ–°åˆ›å»ºçš„å¾®ä¿¡å‘Šè­¦ï¼šå³å¯ç”¨åŠ¨ä½œ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3119571721f2605c8403618b944a5384.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3119571721f2605c8403618b944a5384.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_82a0baf528dbe6863ab110882f7d84e8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_82a0baf528dbe6863ab110882f7d84e8.png"></p><h2 id="äºŒ-zabbixå‡ºå›¾æ·»åŠ äº¤æ¢æœºè®¾ç½®"><a href="#äºŒ-zabbixå‡ºå›¾æ·»åŠ äº¤æ¢æœºè®¾ç½®" class="headerlink" title="äºŒ. zabbixå‡ºå›¾æ·»åŠ äº¤æ¢æœºè®¾ç½®"></a>äºŒ. zabbixå‡ºå›¾æ·»åŠ äº¤æ¢æœºè®¾ç½®</h2><h3 id="2-1-æ·»åŠ è®¾å¤‡"><a href="#2-1-æ·»åŠ è®¾å¤‡" class="headerlink" title="2.1. æ·»åŠ è®¾å¤‡"></a>2.1. æ·»åŠ è®¾å¤‡</h3><p><strong>é…ç½®-ç¾¤ç»„-åˆ›å»ºç¾¤ç»„ï¼ˆå¦‚æœªæ¥ç§‘æŠ€åŸï¼‰</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6fb86456c1f1b9eba430942b08b77ff.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6fb86456c1f1b9eba430942b08b77ff.png"></p><p><strong>ç›‘æµ‹-ä¸»æœº-æ·»åŠ ä¸»æœºï¼ˆæ ¹æ®äº¤æ¢æœºå‚å•†é€‰æ‹©åˆé€‚çš„ç›‘æ§æ¨¡æ¿å¦‚åä¸ºåˆ™é€‰æ‹©åä¸ºï¼‰</strong></p><p>ä¸»æœºåç§°ï¼š10.0.0.10<br>å¯è§åç§°ï¼šåä¸ºCE6851<br>æ¨¡æ¿ï¼š Huawei VRP by SNMP<br>ç¾¤ç»„ï¼šæœªæ¥ç§‘æŠ€åŸ<br>interfaces<br>ç±»å‹ï¼šsnmp<br>ç‰ˆæœ¬ snmpV2<br>snmp communityï¼ˆå›¢ä½“åï¼‰ï¼š passwd<br>è¿æ¥åˆ°ip DNS ç«¯å£ï¼š161<br>ç”±agentä»£ç†ç¨‹åºç›‘æµ‹ (æ— agentä»£ç†ç¨‹åº)<br>å·²å¯ç”¨</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e19dd19666176395dc07dfda08b59091.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e19dd19666176395dc07dfda08b59091.png"></p><p><strong>æ¨¡æ¿é€‰æ‹©ï¼ˆä»¥åä¸ºäº¤æ¢æœºä¸ºä¾‹ï¼‰</strong></p><p>æ¨¡æ¿-ä¸»æœºç¾¤ç»„<code>-Templates/Network devices-HuaweiVRPbySNMP</code></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f42f938f9b0285953e4100811df34b7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f42f938f9b0285953e4100811df34b7.png"></p><h3 id="2-2-åä¸ºCEç³»ä¾‹ç‰¹åˆ«è¯´æ˜"><a href="#2-2-åä¸ºCEç³»ä¾‹ç‰¹åˆ«è¯´æ˜" class="headerlink" title="2.2. åä¸ºCEç³»ä¾‹ç‰¹åˆ«è¯´æ˜"></a>2.2. åä¸ºCEç³»ä¾‹ç‰¹åˆ«è¯´æ˜</h3><p>è§ğŸ”—é“¾æ¥ | <strong><a href="https://blog.csdn.net/m0_59586152/article/details/125200506">ç‰¹åˆ«ä»‹ç»å…³äºhuaweiCEç³»åˆ—çš„cpuç›‘æ§(æ­¤å¤„zabbixè‡ªå¸¦çš„ç›‘æ§æœ‰æ—¶å€™æ— æ³•é‡‡é›†æˆåŠŸ)</a></strong></p><h2 id="ä¸‰-grafanaé¢æ¿é…ç½®ï¼ˆå»ºè®®grafanaç‰ˆæœ¬ä¸º8-5-2ï¼‰"><a href="#ä¸‰-grafanaé¢æ¿é…ç½®ï¼ˆå»ºè®®grafanaç‰ˆæœ¬ä¸º8-5-2ï¼‰" class="headerlink" title="ä¸‰. grafanaé¢æ¿é…ç½®ï¼ˆå»ºè®®grafanaç‰ˆæœ¬ä¸º8.5.2ï¼‰"></a>ä¸‰. grafanaé¢æ¿é…ç½®ï¼ˆå»ºè®®grafanaç‰ˆæœ¬ä¸º8.5.2ï¼‰</h2><h3 id="3-1-å®‰è£…zabbixæ’ä»¶"><a href="#3-1-å®‰è£…zabbixæ’ä»¶" class="headerlink" title="3.1. å®‰è£…zabbixæ’ä»¶"></a>3.1. å®‰è£…zabbixæ’ä»¶</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@gegewu1:/opt/grafana-8.5.2/bin<span class="comment"># ./grafana-cli plugins install alexanderzobnin-zabbix-app</span></span><br><span class="line">âœ” Downloaded alexanderzobnin-zabbix-app v4.2.8 zip successfully</span><br><span class="line"> </span><br><span class="line">Please restart Grafana after installing plugins. Refer to Grafana documentation <span class="keyword">for</span> instructions <span class="keyword">if</span> necessary.</span><br><span class="line"> </span><br><span class="line">root@gegewu1:/opt/grafana-8.5.2/bin<span class="comment">#</span></span><br><span class="line"> </span><br></pre></td></tr></table></figure><p>é…ç½®zabbixæºæ—¶éœ€è¦å°†80ç«¯å£å†™å‡ºå¦åˆ™ä¼šæ·»åŠ å¤±è´¥å³ï¼š<a href="http://10.0.0.10/zabbix/api_jsonrpc.php">http://10.0.0.10:80/zabbix/api_jsonrpc.php</a></p><p><strong>é…ç½®å¥½å‰ç«¯zabbixç»„ä»¶å é€‰æ‹©åˆé€‚éœ€è¦ç›‘æ§çš„ç«¯å£å³å¯</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_a1cb215aaf904a7b1c6517dae8c43a38.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_a1cb215aaf904a7b1c6517dae8c43a38.png"></p><p><strong>æ•ˆæœ</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_9e24dccc0ed9e1529e55edd526aef9ea.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_9e24dccc0ed9e1529e55edd526aef9ea.png"></p><p>æœ¬æ–‡å‚è€ƒ |<br><a href="https://blog.csdn.net/m0_59586152/article/details/125136342">https://blog.csdn.net/m0_59586152/article/details/125136342</a><br><a href="https://blog.csdn.net/m0_59586152/article/details/125200506">https://blog.csdn.net/m0_59586152/article/details/125200506</a></p>]]></content>
      
      
      <categories>
          
          <category> zabbix </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zabbix </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wordpressè®¾ç½®WP SMTPé‚®ä»¶æé†’</title>
      <link href="/2024/03/27/wordpress%E8%AE%BE%E7%BD%AEWP%20SMTP%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92/"/>
      <url>/2024/03/27/wordpress%E8%AE%BE%E7%BD%AEWP%20SMTP%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="wordpressè®¾ç½®WP-SMTPé‚®ä»¶æé†’"><a href="#wordpressè®¾ç½®WP-SMTPé‚®ä»¶æé†’" class="headerlink" title="wordpressè®¾ç½®WP SMTPé‚®ä»¶æé†’"></a>wordpressè®¾ç½®WP SMTPé‚®ä»¶æé†’</h2><blockquote><p>æœ¬æ–‡ä½¿ç”¨wordpressæ’ä»¶ &gt; <a href="https://wordpress.org/plugins/wp-smtp/">WP SMTP</a> å®‰è£… &gt; <a href="https://wn-apple-teawine.fun/2023/10/08/wordpress%E5%8D%9A%E5%AE%A2-docker-compose%E6%9E%84%E5%BB%BA/?highlight=%E5%90%84%E7%A7%8D">wordpresså®‰è£…é“¾æ¥</a></p><p>æ’ä»¶å®‰è£…åŒ…ç•™å­˜åœ°å€ | <a href="https://drive.zznnwn.cloudns.biz/api/raw/?path=/boke/wordpress/WP-SMTP/wp-smtp.1.2.6.zip">ä¼ é€é—¨</a></p></blockquote><h3 id="wordpresså®‰è£…WP-SMTPæ’ä»¶æ–¹æ³•"><a href="#wordpresså®‰è£…WP-SMTPæ’ä»¶æ–¹æ³•" class="headerlink" title="wordpresså®‰è£…WP SMTPæ’ä»¶æ–¹æ³•"></a>wordpresså®‰è£…WP SMTPæ’ä»¶æ–¹æ³•</h3><p>æ’ä»¶ &gt; æ·»åŠ æ’ä»¶ &gt; ä¸Šä¼ æ’ä»¶ &gt; é€‰æ‹©æ–‡ä»¶ | æ­¤æ—¶å¹³å°ä¼šè‡ªåŠ¨å®‰è£…æ­¤æ’ä»¶</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6dc16744541929c15f31c5105b4877d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6dc16744541929c15f31c5105b4877d.png"></p><h3 id="é…ç½®smtpæœåŠ¡"><a href="#é…ç½®smtpæœåŠ¡" class="headerlink" title="é…ç½®smtpæœåŠ¡"></a>é…ç½®smtpæœåŠ¡</h3><p>ä¸»è¦é…ç½®é‚®ç®±æˆæƒç  è®¾ç½® &gt; è®¨è®º &gt; å¼€å¯è¯„è®ºæé†’</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8079623496c957fa91390f39150ee7e8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8079623496c957fa91390f39150ee7e8.png"></p><h3 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_d8ba9af400a0c44fca7a8b7aa6bd50bd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_d8ba9af400a0c44fca7a8b7aa6bd50bd.png"></p><p><strong>æœ¬æ–‡å‚è€ƒ</strong></p><p><a href="https://blog.naibabiji.com/tutorial/wordpress-smtp-cha-jian.html#wp_smtp">https://blog.naibabiji.com/tutorial/wordpress-smtp-cha-jian.html#wp_smtp</a></p>]]></content>
      
      
      <categories>
          
          <category> wordpress </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wordpress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxå‘½ä»¤ç­›é€‰å‡ºipv4åœ°å€å¹¶å»é‡è®¡ç®—å‡ºç°æ¬¡æ•°</title>
      <link href="/2024/03/25/linux%E5%91%BD%E4%BB%A4%E7%AD%9B%E9%80%89%E5%87%BAipv4%E5%9C%B0%E5%9D%80%E5%B9%B6%E5%8E%BB%E9%87%8D%E8%AE%A1%E7%AE%97%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0/"/>
      <url>/2024/03/25/linux%E5%91%BD%E4%BB%A4%E7%AD%9B%E9%80%89%E5%87%BAipv4%E5%9C%B0%E5%9D%80%E5%B9%B6%E5%8E%BB%E9%87%8D%E8%AE%A1%E7%AE%97%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>linuxå‘½ä»¤ç­›é€‰å‡ºipv4åœ°å€å¹¶å»é‡è®¡ç®—å‡ºç°æ¬¡æ•°<a href>                                              </a></strong></p><p>ä»£ç å¦‚ä¸‹ï¼š</p><ul><li><strong>grep -oE â€œ\b([0-9]{1,3}.){3}[0-9]{1,3}\bâ€ 1.txt |sort -nr |uniq -c</strong></li><li><strong>ss -ant |grep ESTAB |awk -F â€˜[ :]+â€™  â€˜{print $4}â€™ |grep -v â€˜[â€˜ |sort -rn |uniq -c</strong></li><li><strong>cat 1.txt  |awk -F â€˜[ :]+â€™  â€˜/^ip/{print $2}â€™ |sort -nr |uniq -c</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@k8s:~<span class="comment"># cat 1.txt </span></span><br><span class="line">ip: 10.10.10.1:1080</span><br><span class="line">ip: 10.10.10.2:1080</span><br><span class="line">ip: 10.10.10.4:2050</span><br><span class="line">ip: 10.10.10.2:1020</span><br><span class="line">root@k8s:~<span class="comment"># ss -ant |grep -oE &quot;\b([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;\b&quot; 1.txt</span></span><br><span class="line">10.10.10.1</span><br><span class="line">10.10.10.2</span><br><span class="line">10.10.10.4</span><br><span class="line">10.10.10.2</span><br><span class="line">root@k8s:~<span class="comment"># grep -oE &quot;\b([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;\b&quot; 1.txt |sort -nr |uniq -c</span></span><br><span class="line">      1 10.10.10.4</span><br><span class="line">      2 10.10.10.2</span><br><span class="line">      1 10.10.10.1</span><br><span class="line">root@k8s:~<span class="comment"># ss -ant |grep ESTAB |awk -F &#x27;[ :]+&#x27;  &#x27;&#123;print $4&#125;&#x27; |grep -v &#x27;\[&#x27; |sort -rn |uniq -c</span></span><br><span class="line">      1 172.16.0.1</span><br><span class="line">    124 127.0.0.1</span><br><span class="line">     10 10.0.0.240</span><br><span class="line">root@k8s:~<span class="comment"># cat 1.txt  |awk -F &#x27;[ :]+&#x27;  &#x27;/^ip/&#123;print $2&#125;&#x27; |sort -nr |uniq -c</span></span><br><span class="line">      1 10.10.10.4</span><br><span class="line">      2 10.10.10.2</span><br><span class="line">      1 10.10.10.1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shellå®ç°è®¡ç®—æ–æ³¢é‚£å¥‘æ•°åˆ—</title>
      <link href="/2024/03/24/Shell%E5%AE%9E%E7%8E%B0%E8%AE%A1%E7%AE%97%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/"/>
      <url>/2024/03/24/Shell%E5%AE%9E%E7%8E%B0%E8%AE%A1%E7%AE%97%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="Shellå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—"><a href="#Shellå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—" class="headerlink" title="Shellå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—"></a>Shellå®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—è®¡ç®—</h3><p><a href="https://zh.numberempire.com/fibonaccinumbers.php">æ–æ³¢é‚£å¥‘æ•°è®¡ç®—å™¨ (numberempire.com)</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">fibonacci</span></span>() &#123;</span><br><span class="line">    n=<span class="variable">$1</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$n</span> -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> 0</span><br><span class="line">    <span class="keyword">elif</span> [ <span class="variable">$n</span> -eq 1 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> 1</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        a=0</span><br><span class="line">        b=1</span><br><span class="line">        i=2</span><br><span class="line">        <span class="keyword">while</span> [ <span class="variable">$i</span> -le <span class="variable">$n</span> ]; <span class="keyword">do</span></span><br><span class="line">            c=$((a + b))</span><br><span class="line">            a=<span class="variable">$b</span></span><br><span class="line">            b=<span class="variable">$c</span></span><br><span class="line">            i=$((i + <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$b</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;è¯·è¾“å…¥Nå€¼ï¼ˆN &lt; 50ï¼‰: &quot;</span> N</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$N</span> -ge 0 ] &amp;&amp; [ <span class="variable">$N</span> -lt 50 ]; <span class="keyword">then</span></span><br><span class="line">    result=$(fibonacci <span class="variable">$N</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ç¬¬ <span class="variable">$N</span> é¡¹ä¸º: <span class="variable">$result</span>&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;è¾“å…¥çš„Nå€¼ä¸åœ¨æœ‰æ•ˆèŒƒå›´å†…ï¼&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_caa7837e83fa0efebe83bac133122bd4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_caa7837e83fa0efebe83bac133122bd4.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9d599e5ba7c00c4a861753f0f01a4cb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9d599e5ba7c00c4a861753f0f01a4cb.png"></p>]]></content>
      
      
      <categories>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹</title>
      <link href="/2024/03/23/ceph%E9%9B%86%E7%BE%A4%E6%89%A9%E5%AE%B9%E4%B8%8E%E7%BC%A9%E5%AE%B9%E8%8A%82%E7%82%B9/"/>
      <url>/2024/03/23/ceph%E9%9B%86%E7%BE%A4%E6%89%A9%E5%AE%B9%E4%B8%8E%E7%BC%A9%E5%AE%B9%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹"><a href="#cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹" class="headerlink" title="cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹"></a>cephé›†ç¾¤æ‰©å®¹ä¸ç¼©å®¹èŠ‚ç‚¹</h3><p><a href="https://wn-apple-teawine.fun/2023/08/29/cephadm%E9%83%A8%E7%BD%B2ceph-quincy%E7%89%88%E6%9C%AC/"><strong>ä¸€. æ‰©å®¹å¸¸è§„æ·»åŠ èŠ‚ç‚¹å³å¯</strong></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­è‡ªåŠ¨æ·»åŠ osd</span></span><br><span class="line">ceph orch apply osd --all-available-devices --unmanaged=<span class="literal">true</span></span><br><span class="line"><span class="comment"># æ·»åŠ ceph-4ä¸ºæ–°èŠ‚ç‚¹</span></span><br><span class="line">ssh-copy-id ceph-4</span><br><span class="line">ssh-copy-id -f -i /etc/ceph/ceph.pub root@ceph-4</span><br><span class="line"><span class="comment"># ceph-4 æ¢æº </span></span><br><span class="line"><span class="comment"># è®¾ç½®ceph quincyæº </span></span><br><span class="line"><span class="comment"># è®¾ç½®dockeré•œåƒåŠ é€Ÿ &gt;&gt; ç•¥ (ceph-4æ“ä½œ)</span></span><br><span class="line">hostnamectl set-hostname ceph-4</span><br><span class="line">apt install -y python3 systemd lvm2 ceph-common</span><br><span class="line">curl -sSL https://get.daocloud.io/docker | sh</span><br><span class="line"><span class="comment"># ä¸»èŠ‚ç‚¹æ‰§è¡Œæ·»åŠ èŠ‚ç‚¹</span></span><br><span class="line">ceph orch host add ceph-4</span><br></pre></td></tr></table></figure><p><strong>äºŒ. èŠ‚ç‚¹ç¼©å®¹( æ³¨æ„é¡ºåº )â€“æš‚æœªæµ‹è¯•</strong></p><blockquote><p>æ­¤å¤„éœ€è¦æ³¨æ„å‰¯æœ¬æ•°  æ¯”å¦‚é›†ç¾¤ä¸ºä¸‰å‰¯æœ¬ä¸‰å°æœåŠ¡å™¨ç¼©å‡ä¸ºä¸¤å°æ—¶ æ­¤æ—¶é›†ç¾¤ç¼ºå¤±ä¸€èŠ‚ç‚¹å°±å˜æˆäº† ä¸¤å‰¯æœ¬ ç§»é™¤èŠ‚ç‚¹éœ€è¦è°ƒæ•´å‰¯æœ¬æ•° å‰¯æœ¬æ•°ä¸èƒ½å°äº<code>2</code>å³æœ€å°èƒ½æ”¯æŒçš„ç¼©å‡ä¸º3èŠ‚ç‚¹ &gt;&gt; 2èŠ‚ç‚¹</p></blockquote><p><a href="https://gegewu-cloud.github.io/2023/09/01/ceph%E9%9B%86%E7%BE%A4%E4%B9%8Bosd%E5%9D%8F%E7%9B%98%E5%89%94%E9%99%A4/">osdåç›˜å‰”é™¤å‚è€ƒæ­¤å¤„é“¾æ¥å³å¯</a></p><p><a href="https://wn-apple-teawine.fun/2023/10/29/ceph%E9%9B%86%E7%BE%A4%E4%B9%8Bceph-quincy%E7%89%88%E6%9C%ACcephadm%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F%E4%BF%AE%E6%94%B9ceph%E9%85%8D%E7%BD%AE/">cephadméƒ¨ç½²æ–¹å¼æ›´æ”¹é…ç½®å‚è€ƒæ­¤å¤„å«ceph-deployæ–¹å¼æ›´æ”¹å‰¯æœ¬æ•°</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆè®¾ç½®ä¸è¿ç§»æ•°æ®</span></span><br><span class="line">ceph osd <span class="built_in">set</span> noout</span><br><span class="line"><span class="comment"># è‹¥èŠ‚ç‚¹ä¸º3èŠ‚ç‚¹é”å®¹ä¸º2èŠ‚ç‚¹åˆ™éœ€è¦ æ›´æ”¹å‰¯æœ¬æ•°ä¸º2 cephçš„crashmapé»˜è®¤ä»¥ä¸»æœºä¸ºå•ä½ (å‰¯æœ¬æ•°ä¸èƒ½å°äº2)</span></span><br><span class="line">ceph config <span class="built_in">help</span> osd_pool_default_size                     <span class="comment"># æŸ¥çœ‹å½“å‰å‰¯æœ¬æ•°é…ç½®</span></span><br><span class="line">ceph config-key <span class="built_in">set</span> config/global/osd_pool_default_size 2  <span class="comment"># è®¾ç½®å‰¯æœ¬æ•°ä¸º2</span></span><br><span class="line">systemctl restart ceph.target                              <span class="comment"># é‡å¯ç”Ÿæ•ˆ</span></span><br><span class="line"><span class="comment"># å·²ç»å­˜åœ¨çš„pooléœ€è¦æ‰‹åŠ¨è®¾ç½®å‰¯æœ¬æ•° (å‰¯æœ¬æ•°ä¸èƒ½å°äº2)</span></span><br><span class="line">ceph osd pool  <span class="built_in">set</span> ceph-demo size  2</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…¶ä»–å¦‚mds mgr monç­‰èŠ‚ç‚¹æ•°é‡ä¹Ÿè¦å¯¹åº”ç¼©å‡</span></span><br><span class="line">ceph orch apply mon --placement=<span class="string">&quot;2 ceph-1 ceph-2&quot;</span>   </span><br><span class="line">ceph orch apply mgr --placement=<span class="string">&quot;2 ceph-1 ceph-2&quot;</span></span><br><span class="line">ceph orch apply rgw  foo --placement=<span class="string">&quot;2 ceph-1 ceph-2&quot;</span> --port=8000</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä»é›†ç¾¤ä¸­åˆ é™¤å…³äºè¯¥ceph-3ä¸»æœºçš„æ‰€æœ‰å®ˆæŠ¤è¿›ç¨‹</span></span><br><span class="line">ceph orch host drain ceph-3</span><br><span class="line"><span class="comment"># å°†_no_scheduleæ ‡ç­¾åº”ç”¨äºä¸»æœºè‡³äºç»´æŠ¤æ¨¡å¼</span></span><br><span class="line">ceph orch host label add ceph-3 _no_schedule</span><br><span class="line"></span><br><span class="line"><span class="comment"># å…³é—­è‡ªåŠ¨æ·»åŠ osd</span></span><br><span class="line">ceph orch apply osd --all-available-devices --unmanaged=<span class="literal">true</span></span><br><span class="line"><span class="comment"># ç§»é™¤osd</span></span><br><span class="line">ceph osd out osd.1</span><br><span class="line">ceph osd purge osd.1 --yes-i-really-mean-it</span><br><span class="line">ceph osd <span class="built_in">rm</span> osd.1</span><br><span class="line">ceph orch daemon <span class="built_in">rm</span> osd.1 --force</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ceph </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ceph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cephfsæ­å»ºåŠæƒé™ç®¡ç†</title>
      <link href="/2024/03/23/cephfs%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/"/>
      <url>/2024/03/23/cephfs%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="cephfsæ­å»ºåŠæƒé™ç®¡ç†-æœ¬æ–‡å•èŠ‚ç‚¹æµ‹è¯•"><a href="#cephfsæ­å»ºåŠæƒé™ç®¡ç†-æœ¬æ–‡å•èŠ‚ç‚¹æµ‹è¯•" class="headerlink" title="cephfsæ­å»ºåŠæƒé™ç®¡ç†(æœ¬æ–‡å•èŠ‚ç‚¹æµ‹è¯•)"></a>cephfsæ­å»ºåŠæƒé™ç®¡ç†(æœ¬æ–‡å•èŠ‚ç‚¹æµ‹è¯•)</h3><p><strong>æ‹–å¸ƒå›¾</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3e7fad3ed82c19ee8bc03e153c89c81f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3e7fad3ed82c19ee8bc03e153c89c81f.png"></p><p><strong>æ¶æ„</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c33ff0f84010148834f8b19aae653197.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c33ff0f84010148834f8b19aae653197.png"></p><p><strong>cephFSç®€ä»‹</strong></p><p>æ¯ä¸ªCephFSæ–‡ä»¶ç³»ç»Ÿè‡³å°‘éœ€è¦ä¸€ä¸ªMDSï¼ˆmetadata serverï¼‰ï¼Œä¸€èˆ¬æ˜¯ä¸‰ä¸ªã€‚CephFS æ˜¯ä¸ªä¸ POSIX æ ‡å‡†å…¼å®¹çš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ–‡ä»¶ç›®å½•å’Œå…¶ä»–å…ƒæ•°æ®å­˜å‚¨åœ¨RADOSä¸­ï¼ŒMDSç¼“å­˜å…ƒä¿¡æ¯å’Œæ–‡ä»¶ç›®å½•ä¿¡æ¯ã€‚</p><p>cephfsçš„æ ¸å¿ƒç»„ä»¶æœ‰ï¼šMDSã€Clientsã€RADOSã€‚</p><p>å‚è€ƒï¼š<a href="https://cloud.tencent.com/developer/article/1664666">CephFS ä»‹ç»åŠä½¿ç”¨ç»éªŒåˆ†äº«</a>ã€‚</p><blockquote><p>å„ä¸ªç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»å¦‚ä¸‹ï¼š</p><ul><li>client ã€Š==ã€‹ MDSï¼šå…ƒæ•°æ®æ“ä½œå’Œcapalitiesã€‚</li><li>Client ã€Š==ã€‹ OSDï¼š æ•°æ®IOã€‚</li><li>MDS ã€Š==ã€‹ OSDï¼šå…ƒæ•°æ®IOã€‚</li></ul></blockquote><p>cephfsæ”¯æŒç”¨æˆ·çº§åˆ«å’Œå†…æ ¸çº§åˆ«çš„æŒ‚è½½ä½¿ç”¨ï¼Œå¯æ‰©å±•æ€§é«˜ï¼Œå¹¶ä¸”å¯ä»¥å…±äº«æ–‡ä»¶ç³»ç»Ÿï¼Œå¤šä¸ªclientså¯ä»¥åŒæ—¶è¯»å†™ã€‚MDSæ”¯æŒé«˜å¯ç”¨æ€§ï¼Œé»˜è®¤é‡‡ç”¨çš„æ˜¯ä¸»å¤‡æ¨¡å¼ï¼ˆä¹Ÿå¯ä»¥é€šè¿‡é…ç½®æ”¹ä¸ºå¤šä¸»ï¼‰ï¼Œå¹¶ä¸”cephfsæ”¯æŒæ–‡ä»¶ç³»ç»Ÿçš„é…é¢é™åˆ¶ã€‚</p><blockquote><p>cephfsä¸­MDSå¤šä¸»çš„ä¼˜åŠ¿åŠç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ul><li>å½“å…ƒæ•°æ®é»˜è®¤çš„å•ä¸ª MDS æˆä¸ºç“¶é¢ˆæ—¶ï¼Œé…ç½®å¤šä¸ªæ´»è·ƒçš„ MDS å®ˆæŠ¤è¿›ç¨‹ï¼Œæå‡é›†ç¾¤æ€§èƒ½ã€‚</li><li>å¤šä¸ªæ´»è·ƒçš„ MDS æœ‰åˆ©äºæ€§èƒ½æå‡ã€‚</li><li>å¤šä¸ªæ´»è·ƒçš„MDS å¯ä»¥å®ç°MDSè´Ÿè½½å‡è¡¡ã€‚</li><li>å¤šä¸ªæ´»è·ƒçš„MDS å¯ä»¥å®ç°å¤šç§Ÿæˆ·èµ„æºéš”ç¦»ã€‚</li><li>å®ƒèƒ½å¤Ÿå°†æ–‡ä»¶ç³»ç»Ÿæ ‘åˆ†å‰²æˆå­æ ‘ï¼Œæ¯ä¸ªå­æ ‘å¯ä»¥äº¤ç»™ç‰¹å®šçš„MDSè¿›è¡Œæƒå¨ç®¡ç†ï¼Œä»è€Œè¾¾åˆ°äº†éšç€å…ƒæ•°æ®æœåŠ¡å™¨æ•°é‡çš„å¢åŠ ï¼Œé›†ç¾¤æ€§èƒ½çº¿æ€§åœ°æ‰©å±•ã€‚</li><li>æ¯ä¸ªå­æ ‘éƒ½æ˜¯åŸºäºå…ƒæ•°æ®åœ¨ç»™å®šç›®å½•æ ‘ä¸­çš„çƒ­åŠ¨æ€åˆ›å»ºçš„ã€‚</li><li>ä¸€æ—¦åˆ›å»ºäº†å­æ ‘ï¼Œå®ƒçš„å…ƒæ•°æ®å°±è¢«è¿ç§»åˆ°ä¸€ä¸ªæœªåŠ è½½çš„MDSã€‚</li><li>åç»­å®¢æˆ·ç«¯å¯¹å…ˆå‰æˆæƒçš„MDSçš„è¯·æ±‚è¢«è½¬å‘ã€‚</li></ul></blockquote><h3 id="ä¸€-åˆ›å»ºmds"><a href="#ä¸€-åˆ›å»ºmds" class="headerlink" title="ä¸€. åˆ›å»ºmds"></a>ä¸€. <strong>åˆ›å»º</strong>mds</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é¦–å…ˆå¼€å¯mdsç»„ä»¶ï¼Œcephfsï¼šæ–‡ä»¶ç³»ç»Ÿåç§°ï¼›â€“placementï¼šæŒ‡å®šé›†ç¾¤å†…éœ€è¦å‡ ä¸ªmdsï¼Œåé¢è·Ÿä¸»æœºåï¼ˆç­‰å¾…ä¸€åˆ†é’Ÿå®Œæˆåˆ›å»ºï¼‰</span></span><br><span class="line">ceph orch apply mds cephfs --placement=<span class="string">&quot;2 ceph1 ceph2&quot;</span></span><br><span class="line"><span class="comment"># è¿”å›</span></span><br><span class="line">Scheduled mds.cephfs update...</span><br><span class="line"><span class="comment"># åˆ›å»ºcephfsï¼Œceph qç‰ˆä¸æŒ‡å®špgçš„è¯ï¼Œé»˜è®¤è‡ªåŠ¨è°ƒæ•´ ä¸èƒ½ä½¿ç”¨ rbd init åˆå§‹åŒ–</span></span><br><span class="line">ceph osd pool create cephfs_data 8 8</span><br><span class="line">ceph osd pool create cephfs_metadata 8 8</span><br><span class="line"><span class="comment"># è¿”å›</span></span><br><span class="line">pool <span class="string">&#x27;cephfs_metadata&#x27;</span> created</span><br><span class="line"><span class="comment"># å°†ä¸¤ä¸ªpoolå…³è”èµ·æ¥</span></span><br><span class="line">ceph fs new cephfsdemo cephfs_metadata cephfs_data</span><br><span class="line"><span class="comment"># è¿”å›</span></span><br><span class="line">new fs with metadata pool 3 and data pool 2</span><br><span class="line"><span class="comment"># æŸ¥çœ‹å„èŠ‚ç‚¹æ˜¯å¦å·²å¯åŠ¨mdså®¹å™¨ï¼›è¿˜å¯ä»¥ä½¿ç”¨ceph orch ps æŸ¥çœ‹æŸä¸€èŠ‚ç‚¹è¿è¡Œçš„å®¹å™¨</span></span><br><span class="line">ceph orch ps --daemon-type mds</span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹mdsä¿¡æ¯</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹cephfsä¿¡æ¯</span></span><br><span class="line">ceph fs <span class="built_in">ls</span></span><br><span class="line">name: cephfs, metadata pool: cephfs_metadata, data pools: [cephfs_data ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹mdsçŠ¶æ€</span></span><br><span class="line">ceph mds <span class="built_in">stat</span></span><br><span class="line">cephfs:1 &#123;0=cephfs.ceph-1.uuemyr=up:active&#125; 1 up:standby</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ¥çœ‹mdsè¯¦ç»†ä¿¡æ¯</span></span><br><span class="line">ceph fs status </span><br><span class="line"></span><br><span class="line">RANK  STATE           MDS              ACTIVITY     DNS    INOS   DIRS   CAPS  </span><br><span class="line"> 0    active  cephfs.ceph-2.iuvxfu  Reqs:    0 /s    16     19     13      1</span><br></pre></td></tr></table></figure><p>åˆ é™¤<code>cephfs</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph fs <span class="built_in">rm</span> &lt;fs-name&gt; --yes-i-really-mean-it </span><br></pre></td></tr></table></figure><h3 id="äºŒ-æŒ‚è½½cephfs"><a href="#äºŒ-æŒ‚è½½cephfs" class="headerlink" title="äºŒ. æŒ‚è½½cephfs"></a>äºŒ. æŒ‚è½½<code>cephfs</code></h3><p><strong>ä¸´æ—¶æŒ‚è½½</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä½¿ç”¨å†…æ ¸çº§åˆ«æŒ‚è½½ï¼š</span></span><br><span class="line"> <span class="built_in">mkdir</span> -p /mnt/cephfs/</span><br><span class="line"> mount -t ceph 10.0.0.124:6789:/ /mnt/cephfs/ -o name=admin  ï¼ˆè‡ªåŠ¨è¯†åˆ«admin keyï¼‰</span><br><span class="line"> æˆ–</span><br><span class="line"> mount -t ceph 10.0.0.124:6789:/ /mnt/cephfs -o name=admin,secret=AQCeoO1j+e+lMhAAP2izu6rTQSGz0oyJkLw9UQ==</span><br><span class="line"> æˆ–</span><br><span class="line"> <span class="comment"># æ–‡ä»¶å¯†é’¥æŒ‚è½½ï¼š</span></span><br><span class="line"> <span class="built_in">echo</span> AQDqOnNf7tGvHhAAZoXbhXRbETxRLBTl5DT1MQ== &gt;&gt; admin.key</span><br><span class="line"> mount -t ceph 192.168.229.114:6789:/ /cephfs/ -o name=admin,secretfile=admin.key</span><br><span class="line"><span class="comment"># æ‰©å±•æŸ¥çœ‹key:  </span></span><br><span class="line">ceph auth <span class="built_in">ls</span></span><br><span class="line">æŒ‡å®šç”¨æˆ·æŒ‚è½½ éœ€è¦å…ˆå»ºç«‹cephxè®¤è¯ç”¨æˆ·å†…æ ¸çº§åˆ«é…ç½®æ°¸ä¹…æŒ‚è½½</span><br></pre></td></tr></table></figure><p><strong>ç”¨æˆ·æ€æŒ‚è½½ï¼ˆä¾‹å­ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install ceph-fuse     <span class="comment"># å®‰è£…å®¢æˆ·ç«¯</span></span><br><span class="line">$ apt -y install ceph-fuse</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">mkdir</span> /ceph-fuse   <span class="comment"># åˆ›å»ºæŒ‚è½½ç‚¹å¹¶æŒ‚è½½ä½¿ç”¨</span></span><br><span class="line"></span><br><span class="line">$ ceph-fuse -n client.admin -m 192.168.99.11:6789,192.168.99.12:6789,192.168.99.13:6789 /ceph-fuse</span><br><span class="line"><span class="comment"># monitoråœ°å€å¯ä»¥å¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªï¼ˆå¦‚æœå…¶ä¸­ä¸€ä¸ªå®•æœºä¸å½±å“ä½¿ç”¨ï¼‰</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">df</span> -hT /ceph-fuse       <span class="comment"># æŸ¥çœ‹ç¡®è®¤</span></span><br><span class="line">æ–‡ä»¶ç³»ç»Ÿ       ç±»å‹            å®¹é‡  å·²ç”¨  å¯ç”¨ å·²ç”¨% æŒ‚è½½ç‚¹</span><br><span class="line">ceph-fuse      fuse.ceph-fuse   94G     0   94G    0% /ceph-fuse</span><br></pre></td></tr></table></figure><p><strong>æ°¸ä¹…æŒ‚è½½</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å†™å…¥é…ç½®æ–‡ä»¶ï¼š/etc/fstab </span></span><br><span class="line"><span class="comment"># å¯†é’¥æ–‡ä»¶</span></span><br><span class="line">  10.0.0.124:6789:/ /mnt/cephfs ceph name=admin,secretfile=/root/adminkey,noatime 0 0</span><br><span class="line"><span class="comment"># ç›´æ¥æŒ‡å®šå¯†é’¥</span></span><br><span class="line">  10.0.0.124:6789:/ /mnt/cephfs ceph name=admin,secret=AQCeoO1j+e+lMhAAP2izu6rTQSGz0oyJkLw9UQ==,noatime,_netdev 0 0</span><br><span class="line"></span><br><span class="line">å…³æœºéªŒè¯ï¼šæ­£å¸¸æŒ‚è½½ / monut -a å³å¯éªŒè¯</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7a032c8de07240c963b4846f8b971faf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7a032c8de07240c963b4846f8b971faf.png"></p><h3 id="ä¸‰-cephæƒé™æ§åˆ¶"><a href="#ä¸‰-cephæƒé™æ§åˆ¶" class="headerlink" title="ä¸‰. cephæƒé™æ§åˆ¶"></a>ä¸‰. <a href="https://www.cnblogs.com/lvzhenjiang/p/14907610.html#35-%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4%E6%8C%82%E8%BD%BD%E4%BD%BF%E7%94%A8"><strong>cephæƒé™æ§åˆ¶</strong></a></h3><h4 id="3-6-ä¸åŒç”¨æˆ·æŒ‚è½½ä¸åŒç›®å½•"><a href="#3-6-ä¸åŒç”¨æˆ·æŒ‚è½½ä¸åŒç›®å½•" class="headerlink" title="3.6 ä¸åŒç”¨æˆ·æŒ‚è½½ä¸åŒç›®å½•"></a>3.6 ä¸åŒç”¨æˆ·æŒ‚è½½ä¸åŒç›®å½•</h4><h5 id="3-6-1-æ·»åŠ æ–°çš„poolåˆ°cephfs"><a href="#3-6-1-æ·»åŠ æ–°çš„poolåˆ°cephfs" class="headerlink" title="3.6.1 æ·»åŠ æ–°çš„poolåˆ°cephfs"></a>3.6.1 æ·»åŠ æ–°çš„poolåˆ°cephfs</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cephfsä¸­å¢åŠ æ–°çš„pool</span></span><br><span class="line">ceph osd pool create cephfs_data1 4 4           # åˆ›å»ºpool</span><br><span class="line">ceph fs add_data_pool cephfsdemo cephfs_data1  # åŠ åˆ°cephfsä¸­  </span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-6-2-åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•-bruceï¼Œæ•°æ®å­˜å‚¨åœ¨-pool-cephfs-data1-ä¸­"><a href="#3-6-2-åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•-bruceï¼Œæ•°æ®å­˜å‚¨åœ¨-pool-cephfs-data1-ä¸­" class="headerlink" title="3.6.2 åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•/bruceï¼Œæ•°æ®å­˜å‚¨åœ¨ pool cephfs_data1 ä¸­"></a>3.6.2 åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•/bruceï¼Œæ•°æ®å­˜å‚¨åœ¨ <code>pool cephfs_data1</code> ä¸­</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºbruceçš„ç”¨æˆ·ï¼Œè¿™ä¸ªç”¨æˆ·åªèƒ½è®¿é—®ç›®å½•/bruceï¼Œæ•°æ®å­˜å‚¨åœ¨ `pool cephfs_data1` ä¸­</span></span><br><span class="line">ceph auth get-or-create client.bruce mon &#x27;allow r&#x27; mds &#x27;allow r, allow rw path=/bruce&#x27; osd &#x27;allow rw pool=cephfs_data1&#x27; -o ceph.client.bruce.keyring</span><br><span class="line">// è¿”å›</span><br><span class="line">[client.bruce]</span><br><span class="line">key = AQCtFc9g/CmyERAAzi7ORpEWIxlMiiFC1GK7nA==</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_85fe5cb0da273b96eb63b2ca004dc93c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_85fe5cb0da273b96eb63b2ca004dc93c.png"></p><h5 id="3-6-3-å®¢æˆ·ç«¯æŒ‚è½½"><a href="#3-6-3-å®¢æˆ·ç«¯æŒ‚è½½" class="headerlink" title="3.6.3 å®¢æˆ·ç«¯æŒ‚è½½"></a>3.6.3 å®¢æˆ·ç«¯æŒ‚è½½</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å®¢æˆ·ç«¯æŒ‚è½½</span></span><br><span class="line">mkdir /data1</span><br><span class="line">mount -t ceph 192.168.99.11:6789,192.168.99.12:6789,192.168.99.13:6789:/ /data1/ -o name=bruce,secret=AQCtFc9g/CmyERAAzi7ORpEWIxlMiiFC1GK7nA==</span><br></pre></td></tr></table></figure><h3 id="å››ã€cephfsæƒé™ä¸è®¿é—®æ§åˆ¶"><a href="#å››ã€cephfsæƒé™ä¸è®¿é—®æ§åˆ¶" class="headerlink" title="å››ã€cephfsæƒé™ä¸è®¿é—®æ§åˆ¶"></a>å››ã€cephfsæƒé™ä¸è®¿é—®æ§åˆ¶</h3><h4 id="4-1-æ·»åŠ ç”¨æˆ·"><a href="#4-1-æ·»åŠ ç”¨æˆ·" class="headerlink" title="4.1 æ·»åŠ ç”¨æˆ·"></a>4.1 æ·»åŠ ç”¨æˆ·</h4><p>æ·»åŠ ç”¨æˆ·<code>jerryï¼Œjerry</code>åªæœ‰å¯¹<code>/jerry</code>è·¯å¾„ä¸‹çš„æ–‡ä»¶å…·æœ‰è¯»å†™æƒé™ï¼Œå¯¹å…¶ä»–è·¯å¾„ä¸‹çš„æ–‡ä»¶åªæœ‰è¯»çš„æƒé™</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆ›å»ºæƒé™å¯†é’¥</span></span><br><span class="line">ceph auth get-or-create client.jerry mon &#x27;allow r&#x27; mds &#x27;allow rw,allow rw path=/jerry&#x27; osd &#x27;allow rw pool=cephfs_data2&#x27; -o ceph.client.jerry.keyring</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä½¿ç”¨jerryç”¨æˆ·æŒ‚è½½</span></span><br><span class="line">mount -t ceph 10.0.0.10:6789:/ /data -o name=jerry,secret=AQAo0/9lI2g7KRAA8AqwdIUhGQcS4tJgltSlzw==</span><br></pre></td></tr></table></figure><h4 id="4-2-è·å–æƒé™åˆ—è¡¨"><a href="#4-2-è·å–æƒé™åˆ—è¡¨" class="headerlink" title="4.2 è·å–æƒé™åˆ—è¡¨"></a>4.2 è·å–æƒé™åˆ—è¡¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth list</span></span><br></pre></td></tr></table></figure><h4 id="4-3-åˆ é™¤ç”¨æˆ·"><a href="#4-3-åˆ é™¤ç”¨æˆ·" class="headerlink" title="4.3 åˆ é™¤ç”¨æˆ·"></a>4.3 åˆ é™¤ç”¨æˆ·</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth del client.jerry</span></span><br></pre></td></tr></table></figure><h4 id="4-4-è·å–æŸä¸ªç”¨æˆ·çš„key"><a href="#4-4-è·å–æŸä¸ªç”¨æˆ·çš„key" class="headerlink" title="4.4 è·å–æŸä¸ªç”¨æˆ·çš„key"></a>4.4 è·å–æŸä¸ªç”¨æˆ·çš„key</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth get-key client.bruce</span></span><br></pre></td></tr></table></figure><h4 id="4-5-ä¿®æ”¹ç”¨æˆ·æƒé™"><a href="#4-5-ä¿®æ”¹ç”¨æˆ·æƒé™" class="headerlink" title="4.5 ä¿®æ”¹ç”¨æˆ·æƒé™"></a>4.5 ä¿®æ”¹ç”¨æˆ·æƒé™</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth caps client.jerry mon <span class="string">&#x27;allow r&#x27;</span> mds <span class="string">&#x27;allow r, allow rw path=/jerry, allow rw path=/test&#x27;</span> osd <span class="string">&#x27;allow rw&#x27;</span></span></span><br></pre></td></tr></table></figure><h4 id="4-6-æ³¨æ„äº‹é¡¹"><a href="#4-6-æ³¨æ„äº‹é¡¹" class="headerlink" title="4.6 æ³¨æ„äº‹é¡¹"></a>4.6 æ³¨æ„äº‹é¡¹</h4><blockquote><ul><li>å½“ç”¨java apiæ“ä½œcephfsæ—¶ï¼Œapiæ— æ³•æŒ‡å®šæ–°å»ºæ–‡ä»¶orç›®å½•çš„æ‰€å±ç”¨æˆ·oræ‰€å±ç»„ï¼Œè¿™ä¸¤ä¸ªå±æ€§å–å†³äºè¿è¡Œjavaç¨‹åºæ—¶çš„å½“å‰ç”¨æˆ·(uid)åŠå…¶æ‰€å±çš„ç”¨æˆ·ç»„(gid)</li><li>ç»è¿‡æµ‹è¯•å‘ç°ï¼Œcephfsæ–‡ä»¶orç›®å½•çš„æƒé™æ˜¯linuxæœ¬èº«ç”¨æˆ·æƒé™å’Œcephfsç”¨æˆ·æƒé™çš„äº¤é›†</li><li>ä¿®æ”¹ç”¨æˆ·æƒé™åï¼Œåœ¨æœ¬åœ°éœ€è¦é‡æ–°æŒ‚è½½æ‰å¯ç”Ÿæ•ˆ</li><li>å»ºç›®å½•ï¼Œè®¾ç½®æƒé™æ— éœ€å‰åé¡ºåº</li></ul></blockquote><p><strong>æœ¬æ–‡å‚è€ƒï¼š</strong></p><p>å®˜ç½‘ï¼š<br><a href="https://docs.ceph.com/en/quincy/cephfs/#ceph-file-system">https://docs.ceph.com/en/quincy/cephfs/#ceph-file-system</a><br>æŒ‚è½½ï¼š<br><a href="https://docs.ceph.com/en/quincy/cephfs/mount-using-kernel-driver/">https://docs.ceph.com/en/quincy/cephfs/mount-using-kernel-driver/</a><br>cephfsä»‹ç»+å„ç§æµ‹è¯•ï¼š<br><a href="http://www.yangguanjun.com/2017/07/16/cephfs-test-method-lite/">http://www.yangguanjun.com/2017/07/16/cephfs-test-method-lite/</a></p>]]></content>
      
      
      <categories>
          
          <category> ceph </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ceph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ceph rbdæ•°æ®å†™å…¥æµç¨‹</title>
      <link href="/2024/03/20/ceph%20rbd%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B/"/>
      <url>/2024/03/20/ceph%20rbd%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="ceph-rbdæ•°æ®å†™å…¥æµç¨‹"><a href="#ceph-rbdæ•°æ®å†™å…¥æµç¨‹" class="headerlink" title="ceph rbdæ•°æ®å†™å…¥æµç¨‹"></a>ceph rbdæ•°æ®å†™å…¥æµç¨‹</h3><p><strong>æ‹“è¡¥å›¾ï¼š</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_14d0de28111417c8dc2aa9088c5b6136.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_14d0de28111417c8dc2aa9088c5b6136.png"></p><p><strong>å›¾ç‰‡è§£æï¼š</strong><br><code>å­˜å‚¨è¿‡ç¨‹ï¼š</code>ä¸€ä¸ªæ–‡ä»¶åˆ‡å‰²ä¸ºå¾ˆå¤šéƒ¨åˆ† æ¯”å¦‚ä¸€ä¸ª100Mçš„æ–‡ä»¶æœ€ç»ˆä¼šåˆ‡å‰²æˆ25ä¸ª4Mï¼ˆé»˜è®¤4Mï¼‰çš„æ–‡ä»¶<br><code>åˆ‡å‰²ä¹‹åï¼š</code>æ¯ä¸ª<code>object</code>éƒ½ä¼šæœ‰ä¸€ä¸ª<code>object id  object id</code> éœ€è¦å­˜å‚¨åˆ°pgé‡Œé¢å» æ­¤å¤„è¿›è¡Œä¸€ä¸ªè¿ç®—æŠŠ<code>object id ä½œä¸ºä¸€ä¸ªå“ˆå¸Œ   &gt;&gt; å¯¹å…¶è¿›è¡Œæ©ç è¿ç®— &gt;&gt; å¾—åˆ°pgid </code>pgä¸Šé¢ï¼š<code> å­˜å‚¨å¤šä¸ªobject</code> &gt;&gt; é€šè¿‡<code>crush</code>ç®—æ³•æŠŠ<code>pg</code>åšä¸€æ¬¡è¿ç®—åˆ†é…åˆ° é›†ç¾¤ä¸­å¯¹åº”çš„<code>osd</code>èŠ‚ç‚¹ä¸Š(æ ¹æ®<code>crush</code>å±‚æ¬¡çš„ä¸åŒ<code>osd</code>ä¹Ÿä¼šè½åˆ°ä¸åŒçš„åœ°æ–¹ )<br>æ¯”å¦‚<code>crush</code>ç®—æ³•å®šä¹‰çš„æ˜¯ä»¥æœºæ¶ä¸ºå•ä½çš„ æ­¤æ—¶ä¾¿ä¼šè½åˆ°ä¸åŒçš„æœºæ¶ä¸Šçš„<code>osd</code>ä¸Šä»è€Œç¡®ä¿æ•°æ®çš„é«˜å¯ç”¨æ€§</p><p><strong>å®é™…æ“ä½œæ¼”ç¤ºï¼š</strong></p><p>æ–‡ä»¶åˆ‡å‰²å¤§å°éªŒè¯ æ¼”ç¤ºæ–‡ä»¶ id: rbd_data.38074c091b82.0000000000000200</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">rbd info ceph-demo/rbd-demo.img   æˆ–    rbd -p ceph-demo info rbd-demo.img ï¼ˆæŸ¥çœ‹å‘½ä»¤ï¼‰</span><br><span class="line">rbd image <span class="string">&#x27;rbd-demo.img&#x27;</span>:</span><br><span class="line">        size 11 GiB <span class="keyword">in</span> 2816 objects</span><br><span class="line">        order 22 (4 MiB objects)</span><br><span class="line">        snapshot_count: 0</span><br><span class="line">        <span class="built_in">id</span>: 38074c091b82</span><br><span class="line">        block_name_prefix: rbd_data.38074c091b82</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Sat Nov  5 21:41:38 2022</span><br><span class="line">        access_timestamp: Sat Nov  5 21:41:38 2022</span><br><span class="line">        modify_timestamp: Sat Nov  5 21:41:38 2022</span><br></pre></td></tr></table></figure><p>è§£æï¼š</p><p>å…±ï¼š11G  åˆ†ä¸ºï¼š2816ä¸ªæ–‡ä»¶  æ¯ä¸ªæ–‡ä»¶ï¼š4M<br>objectçš„å‰ç¼€éƒ½æ˜¯ä»¥ï¼š rbd_data.38074c091b82 å¼€å¤´<br>æŸ¥çœ‹éªŒè¯ï¼š<code>rados -p ceph-demo ls |grep rbd\_data.38074c091b82</code>   (æŸ¥çœ‹æ‰€æœ‰æ–‡ä»¶)<br>æŸ¥çœ‹å¤§å°ï¼š<code>rados -p ceph-demo stat rbd\_data.38074c091b82.0000000000000200</code>  ï¼ˆæ¯ä¸ªéƒ½æ˜¯4Mï¼‰</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f53063cda709eabdb71f3cd486276b4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f53063cda709eabdb71f3cd486276b4.png"></p><p><strong>æŸ¥çœ‹æ–‡ä»¶æœ€ç»ˆè½åœ¨çš„åœ°æ–¹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ceph osd map ceph-demo rbd_data.38074c091b82.0000000000000200     (æŸ¥çœ‹æ–‡ä»¶æœ€ç»ˆè½äº)</span><br><span class="line">//è¿”å›</span><br><span class="line">osdmap e49 pool <span class="string">&#x27;ceph-demo&#x27;</span> (1) object <span class="string">&#x27;rbd_data.38074c091b82.0000000000000200&#x27;</span> -&gt; pg 1.7811abdf (1.5f) -&gt; up ([0,1], p0) acting ([0,1], p0)</span><br><span class="line"></span><br><span class="line">ceph osd tree</span><br><span class="line">ID CLASS WEIGHT  TYPE NAME       STATUS REWEIGHT PRI-AFF </span><br><span class="line">-1       0.01178 root default          </span><br><span class="line">-3       0.00589     host node-1       </span><br><span class="line"> 0   hdd 0.00589         osd.0       up  1.00000 1.00000 </span><br><span class="line">-5       0.00589     host node-2       </span><br><span class="line"> 1   hdd 0.00589         osd.1       up  1.00000 1.00000 </span><br><span class="line"></span><br><span class="line">è§£æï¼š æ–‡ä»¶poolæ± deph-demo &gt;&gt; è½åœ¨pgidä¸ºï¼š1.7811abdf ä¸Šé¢ &gt;&gt; è§£ææ©ç å“ˆå¸Œåˆ†é…äº &gt;&gt; osd.0 osd.1ä¸Šé¢</span><br><span class="line">ä¸€ä¸ªæ–‡ä»¶æ‹†åˆ†ä¸ºå¤šä¸ªobjectè¿™äº›objectéƒ½ä¼šè½åœ¨ä¸åŒçš„pgä¸Š  pgæœ€ç»ˆè½åœ¨ä¸åŒçš„osdä¸Š </span><br><span class="line">éªŒè¯ï¼š</span><br><span class="line"><span class="keyword">for</span>å¾ªç¯éªŒè¯</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `rados -p ceph-demo <span class="built_in">ls</span> |grep rbd_data.38074c091b82` ; <span class="keyword">do</span> ceph osd map ceph-demo <span class="variable">$i</span>;  <span class="keyword">done</span></span><br><span class="line">è½äºä¸åŒçš„pgä¸Š</span><br></pre></td></tr></table></figure><p>è§£æï¼š æ–‡ä»¶poolæ± deph-demo &gt;&gt; è½åœ¨pgidä¸ºï¼š1.7811abdf ä¸Šé¢ &gt;&gt; è§£ææ©ç å“ˆå¸Œåˆ†é…äº &gt;&gt; osd.0 osd.1ä¸Šé¢ä¸€ä¸ªæ–‡ä»¶æ‹†åˆ†ä¸ºå¤šä¸ªobjectè¿™äº›objectéƒ½ä¼šè½åœ¨ä¸åŒçš„pgä¸Š  pgæœ€ç»ˆè½åœ¨ä¸åŒçš„osdä¸Š</p><p>éªŒè¯ï¼šforå¾ªç¯éªŒè¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> \`rados -p ceph-demo <span class="built_in">ls</span> |grep rbd\_data.38074c091b82\` ; <span class="keyword">do</span> ceph osd map ceph-demo \<span class="variable">$i</span>;  <span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>è½äºä¸åŒçš„pgä¸Š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_29628694717b3300ec37f4ed88d5abbb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_29628694717b3300ec37f4ed88d5abbb.png"></p><p><strong>rbdæ˜¯ç˜¦åˆ†é…çš„ä¼šæ ¹æ®ä½¿ç”¨æƒ…å†µå»è‡ªåŠ¨çš„æ‰©è¿™äº›ç©ºé—´</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rados -p ceph-demo <span class="built_in">ls</span> |grep rbd_data.38074c091b82 |<span class="built_in">wc</span> -l        <span class="comment"># å½“å‰è¿™ä¸ªå—æœ‰äº”åå¤šä¸ªobject</span></span><br><span class="line">//è¿”å› </span><br><span class="line">56 </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å½“å‰è¿™ä¸ªå—æœ‰äº”åå¤šä¸ªobject  æ¯ä¸ª4M å®é™…åˆ†é…äº†ä¹Ÿå°±äºŒç™¾å¤šMçš„ç©ºé—´  å½“å‰åªç”¨äº†40å¤šM ä½¿ç”¨å¢é•¿çš„è¯ä¼šåŠ¨æ€çš„å»æ‰©å®¹objectçš„æ•°é‡ æ»¡è¶³ æˆ‘ä»¬éœ€è¦çš„ç©ºé—´</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -n 1 <span class="string">&#x27;rados -p ceph-demo ls |grep rbd_data.38074c091b82 |wc -l &#x27;</span>    ï¼ˆåŠ¨æ€ç›‘è§†objectæ–‡ä»¶å˜åŒ–ï¼‰</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7c31491c234c587d7d0cc391e7fce3d6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7c31491c234c587d7d0cc391e7fce3d6.png"></p><p>å¾€æŒ‚è½½çš„ç›®å½•å†™å…¥æ•°æ®ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /mnt/rbd-demo</span><br><span class="line"></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=test.img bs=1M count=1024       (å¾€ç›®å½•å†™å…¥1Gæ•°æ®)</span><br><span class="line"><span class="comment"># å†™å…¥çœŸå®æ•°æ®</span></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/urandom of=file bs=100M count=9000 iflag=fullblock status=progress</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ€ç»ˆobjectå¢åŠ åˆ°313ä¸ª</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_cc6f5bd1aac93adf5cc215f62178f499.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_cc6f5bd1aac93adf5cc215f62178f499.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_64fcc6f1de8cc79e192aa157631a06d9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_64fcc6f1de8cc79e192aa157631a06d9.png"></p>]]></content>
      
      
      <categories>
          
          <category> ceph </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ceph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>éŸ³ä¹</title>
      <link href="/2024/03/16/%E9%9F%B3%E4%B9%90/"/>
      <url>/2024/03/16/%E9%9F%B3%E4%B9%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>éŸ³ä¹</strong></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="https://music.163.com/outchain/player?type=2&id=557584888&auto=1&height=66"> </iframe><hr><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="https://music.163.com/outchain/player?type=2&id=523250334&auto=1&height=66"> </iframe>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>onedrive-vercel-indexéƒ¨ç½²</title>
      <link href="/2024/03/15/onedrive-vercel-index%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/03/15/onedrive-vercel-index%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="onedrive-vercel-index-éƒ¨ç½²"><a href="#onedrive-vercel-index-éƒ¨ç½²" class="headerlink" title="onedrive-vercel-index éƒ¨ç½²"></a>onedrive-vercel-index éƒ¨ç½²</h3><p>æ¦‚è§ˆï¼šå‚è€ƒä¸‹æ–¹å®˜ç½‘å³å¯ éƒ¨ç½²ç›¸å¯¹ç®€å•</p><h3 id="æ³¨å†Œä¸€ä¸ªåº”ç”¨ç¨‹åº"><a href="#æ³¨å†Œä¸€ä¸ªåº”ç”¨ç¨‹åº" class="headerlink" title="æ³¨å†Œä¸€ä¸ªåº”ç”¨ç¨‹åº"></a><a href="https://ovi.swo.moe/zh/docs/advanced#%E6%B3%A8%E5%86%8C%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F">æ³¨å†Œä¸€ä¸ªåº”ç”¨ç¨‹åº</a></h3><p>æ‰“å¼€ä»¥ä¸‹é“¾æ¥ï¼š</p><ul><li><a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade">Microsoft Azure App registrations</a> ï¼ˆOneDrive å›½é™…ç‰ˆä¼ä¸šç‰ˆä¸æ•™è‚²ç‰ˆE5 è®¢é˜…ä¸“ç”¨æœ¬æ–‡ä½¿ç”¨æ­¤ç‰ˆæœ¬ï¼‰</li><li><a href="https://portal.azure.cn/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade">Microsoft Azure.cn App registrations</a>ï¼ˆOneDrive ä¸–çºªäº’è”ä¸“ç”¨ï¼‰</li></ul><h3 id="serrectéœ€è¦åŠ å¯†é“¾æ¥è§å‚è€ƒé“¾æ¥"><a href="#serrectéœ€è¦åŠ å¯†é“¾æ¥è§å‚è€ƒé“¾æ¥" class="headerlink" title="serrectéœ€è¦åŠ å¯†é“¾æ¥è§å‚è€ƒé“¾æ¥"></a>serrectéœ€è¦åŠ å¯†é“¾æ¥è§å‚è€ƒé“¾æ¥</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e934dc8c7a9ad014792319e375d506ab.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e934dc8c7a9ad014792319e375d506ab.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_32138b6f42071fff75dbd218321a5a77.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_32138b6f42071fff75dbd218321a5a77.png"></p><h3 id="æœ¬æ–‡å‚è€ƒï¼š"><a href="#æœ¬æ–‡å‚è€ƒï¼š" class="headerlink" title="æœ¬æ–‡å‚è€ƒï¼š"></a>æœ¬æ–‡å‚è€ƒï¼š</h3><p><a href="https://ovi.swo.moe/zh/docs/advanced">https://ovi.swo.moe/zh/docs/advanced</a><br><a href="https://ovi.swo.moe/zh/docs/getting-started">https://ovi.swo.moe/zh/docs/getting-started</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8sä»ªè¡¨ç›˜éƒ¨ç½²</title>
      <link href="/2024/03/12/k8s%E4%BB%AA%E8%A1%A8%E7%9B%98%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/03/12/k8s%E4%BB%AA%E8%A1%A8%E7%9B%98%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="k8sä»ªè¡¨ç›˜éƒ¨ç½²"><a href="#k8sä»ªè¡¨ç›˜éƒ¨ç½²" class="headerlink" title="k8sä»ªè¡¨ç›˜éƒ¨ç½²"></a>k8sä»ªè¡¨ç›˜éƒ¨ç½²</h2><p><strong>ä»ªè¡¨ç›˜æ–‡ä»¶ä¸‹è½½é“¾æ¥</strong><br><a href="https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml">https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml</a><br><a href="https://drive.zznnwn.cloudns.biz/onedrive/k8s%E9%83%A8%E7%BD%B2%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8F%8Acni/%E4%BD%BF%E7%94%A8container%E4%BD%9C%E4%B8%BA%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8C%E6%97%B6/recommended_v270.yaml">https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/recommended_v270.yaml</a></p><h3 id="éƒ¨ç½²ä»ªè¡¨ç›˜"><a href="#éƒ¨ç½²ä»ªè¡¨ç›˜" class="headerlink" title="éƒ¨ç½²ä»ªè¡¨ç›˜"></a>éƒ¨ç½²ä»ªè¡¨ç›˜</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f &quot;https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml&quot;</span><br><span class="line">kubectl apply -f &quot;https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/recommended_v270.yaml&quot;</span><br></pre></td></tr></table></figure><p><strong>å‘½åç©ºé—´ä¸­çš„åç§°åˆ›å»ºæœåŠ¡å¸æˆ·(admin-user.yml)</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kubernetes-dashboard</span></span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²admin-user.yml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f admin-user.yml </span><br><span class="line">kubectl apply -f <span class="string">&quot;https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/admin-user.yml&quot;</span></span><br></pre></td></tr></table></figure><p>åˆ›å»º ClusterRoleBinding(<code>ClusterRoleBinding.yml</code>)</p><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåœ¨ä½¿ç”¨ æˆ–ä»»ä½•å…¶ä»–å¸¸ç”¨å·¥å…·é¢„é…é›†ç¾¤åï¼Œé›†ç¾¤ä¸­å·²å­˜åœ¨ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å®ƒå¹¶åªä¸ºæˆ‘ä»¬çš„ . å¦‚æœå®ƒä¸å­˜åœ¨ï¼Œåˆ™éœ€è¦å…ˆåˆ›å»ºæ­¤è§’è‰²å¹¶æ‰‹åŠ¨æˆäºˆæ‰€éœ€çš„æƒé™ã€‚<code>kops kubeadm ClusterRole cluster-admin ClusterRoleBinding ServiceAccount</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterRoleBinding</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line">  <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br><span class="line">  <span class="attr">kind:</span> <span class="string">ClusterRole</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">cluster-admin</span></span><br><span class="line"><span class="attr">subjects:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kubernetes-dashboard</span></span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²ClusterRoleBinding.yml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f ClusterRoleBinding.yml </span><br><span class="line">kubectl apply -f <span class="string">&quot;https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/ClusterRoleBinding.yml&quot;</span></span><br></pre></td></tr></table></figure><p><strong>è·å– ServiceAccount çš„æŒæœ‰è€…ä»¤ç‰Œ</strong></p><p>ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¯ç”¨äºç™»å½•çš„ä»¤ç‰Œã€‚æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard create token admin-user</span><br></pre></td></tr></table></figure><p><strong>å®ƒåº”è¯¥æ‰“å°å¦‚ä¸‹å†…å®¹ï¼š</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLXY1N253Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIwMzAzMjQzYy00MDQwLTRhNTgtOGE0Ny04NDllZTliYTc5YzEiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9.Z2JrQlitASVwWbc-s6deLRFVk5DWD3P_vjUFXsqVSY10pbjFLG4njoZwh8p3tLxnX_VBsr7_6bwxhWSYChp9hwxznemD5x5HLtjb16kI9Z7yFWLtohzkTwuFbqmQaMoget_nYcQBUC5fDmBHRfFvNKePh_vSSb2h_aYXa8GV5AcfPQpY7r461itme1EXHQJqv-SN-zUnguDguCTjD80pFZ_CmnSE1z9QdMHPB8hoB4V68gtswR1VLa6mSYdgPwCHauuOobojALSaMc3RH7MmFUumAgguhqAkX3Omqd3rJbYOMRuMjhANqd08piDC3aIabINX6gP5-Tuuw2svnV6NYQ</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-an-api-token-for-a-serviceaccount">Kubernetes æ–‡æ¡£</a>ï¼Œäº†è§£æœ‰å…³ ServiceAccount çš„ API ä»¤ç‰Œçš„æ›´å¤šä¿¡æ¯ã€‚</p><h4 id="è·å–-ServiceAccount-çš„é•¿æœŸæŒæœ‰è€…ä»¤ç‰Œ-å»ºè®®ä½¿ç”¨æ­¤ç§"><a href="#è·å–-ServiceAccount-çš„é•¿æœŸæŒæœ‰è€…ä»¤ç‰Œ-å»ºè®®ä½¿ç”¨æ­¤ç§" class="headerlink" title="è·å– ServiceAccount çš„é•¿æœŸæŒæœ‰è€…ä»¤ç‰Œ(å»ºè®®ä½¿ç”¨æ­¤ç§)"></a>è·å– ServiceAccount çš„é•¿æœŸæŒæœ‰è€…ä»¤ç‰Œ(å»ºè®®ä½¿ç”¨æ­¤ç§)</h4><p>æˆ‘ä»¬è¿˜å¯ä»¥åˆ›å»ºä¸€ä¸ªå¸¦æœ‰ secret çš„ä»¤ç‰Œï¼Œè¯¥ä»¤ç‰Œç»‘å®šäº†æœåŠ¡å¸æˆ·ï¼Œä»¤ç‰Œå°†ä¿å­˜åœ¨ Secret ä¸­æ–‡ä»¶(<code>secret_token.yml</code>)</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Secret</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kubernetes-dashboard</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">kubernetes.io/service-account.name:</span> <span class="string">&quot;admin-user&quot;</span>   </span><br><span class="line"><span class="attr">type:</span> <span class="string">kubernetes.io/service-account-token</span>  </span><br></pre></td></tr></table></figure><p><strong>éƒ¨ç½²</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f secret_token.yml</span><br><span class="line">kubectl apply -f <span class="string">&quot;https://drive.zznnwn.cloudns.biz/onedrive/k8séƒ¨ç½²é…ç½®æ–‡ä»¶åŠcni/ä½¿ç”¨containerä½œä¸ºå®¹å™¨è¿è¡Œæ—¶/secret_token.yml&quot;</span></span><br></pre></td></tr></table></figure><p>åˆ›å»º Secret åï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥è·å–ä¿å­˜åœ¨ Secret ä¸­çš„ Tokenï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get secret admin-user -n kubernetes-dashboard -o jsonpath=&#123;&quot;.data.token&quot;&#125; | base64 -d</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-a-long-lived-api-token-for-a-serviceaccount">Kubernetes æ–‡æ¡£</a>ï¼Œäº†è§£æœ‰å…³ ServiceAccount çš„é•¿æœŸ API ä»¤ç‰Œçš„æ›´å¤šä¿¡æ¯ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_451018f8aaf9cdda00b42a1da75d3b46.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_451018f8aaf9cdda00b42a1da75d3b46.png"></p><h3 id="æœ€åå°†dashboardç«¯å£æš´éœ²åœ¨å¤–ç”¨äºè®¿é—®"><a href="#æœ€åå°†dashboardç«¯å£æš´éœ²åœ¨å¤–ç”¨äºè®¿é—®" class="headerlink" title="æœ€åå°†dashboardç«¯å£æš´éœ²åœ¨å¤–ç”¨äºè®¿é—®"></a>æœ€åå°†<code>dashboard</code>ç«¯å£æš´éœ²åœ¨å¤–ç”¨äºè®¿é—®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl  patch svc kubernetes-dashboard -n kubernetes-dashboard \</span><br><span class="line">-p <span class="string">&#x27;&#123;&quot;spec&quot;:&#123;&quot;type&quot;:&quot;NodePort&quot;,&quot;ports&quot;:[&#123;&quot;port&quot;:443,&quot;targetPort&quot;:8443,&quot;nodePort&quot;:30443&#125;]&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_57bf21fb0b0a561b21cf24556ecc01a5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_57bf21fb0b0a561b21cf24556ecc01a5.png"></p><h3 id="æ‰©å±•ä¸€é”®éƒ¨ç½²"><a href="#æ‰©å±•ä¸€é”®éƒ¨ç½²" class="headerlink" title="æ‰©å±•ä¸€é”®éƒ¨ç½²"></a>æ‰©å±•ä¸€é”®éƒ¨ç½²</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://drive.zznnwn.cloudns.biz/onedrive/è„šæœ¬/k8sä¸€é”®éƒ¨ç½²è„šæœ¬/k8s-dashboard.sh | bash</span><br></pre></td></tr></table></figure><h3 id="ç™»é™†ä»ªè¡¨ç›˜"><a href="#ç™»é™†ä»ªè¡¨ç›˜" class="headerlink" title="ç™»é™†ä»ªè¡¨ç›˜"></a>ç™»é™†ä»ªè¡¨ç›˜</h3><p>è®¿é—®ï¼š<a href="https://localhost:8443/#/login">https://localhost:8443/#/login</a></p><h3 id="æ¸…ç†å’Œåç»­æ­¥éª¤"><a href="#æ¸…ç†å’Œåç»­æ­¥éª¤" class="headerlink" title="æ¸…ç†å’Œåç»­æ­¥éª¤"></a>æ¸…ç†å’Œåç»­æ­¥éª¤</h3><p>åˆ é™¤ admin å’Œ .<code>ServiceAccount ClusterRoleBinding</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard delete serviceaccount admin-user</span><br><span class="line">kubectl -n kubernetes-dashboard delete clusterrolebinding admin-user</span><br></pre></td></tr></table></figure><p>è¦äº†è§£æœ‰å…³å¦‚ä½•åœ¨ Kubernetes ä¸­æˆäºˆ/æ‹’ç»æƒé™çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·é˜…è¯»å®˜æ–¹<a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/">èº«ä»½éªŒè¯</a>å’Œ<a href="https://kubernetes.io/docs/reference/access-authn-authz/authorization/">æˆæƒ</a>æ–‡æ¡£ã€‚</p><h4 id="æœ¬æ–‡å‚è€ƒ"><a href="#æœ¬æ–‡å‚è€ƒ" class="headerlink" title="æœ¬æ–‡å‚è€ƒ"></a>æœ¬æ–‡å‚è€ƒ</h4><p><a href="https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/web-ui-dashboard/">https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/web-ui-dashboard/</a><br><a href="https://github.com/kubernetes/dashboard/blob/master/docs/user/access-control/creating-sample-user.md">https://github.com/kubernetes/dashboard/blob/master/docs/user/access-control/creating-sample-user.md</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹</title>
      <link href="/2024/03/12/k8s%E5%8E%BB%E9%99%A4%E6%B1%A1%E7%82%B9%E8%8A%82%E7%82%B9/"/>
      <url>/2024/03/12/k8s%E5%8E%BB%E9%99%A4%E6%B1%A1%E7%82%B9%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹"><a href="#k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹" class="headerlink" title="k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹"></a>k8så»é™¤æ±¡ç‚¹èŠ‚ç‚¹</h3><p><strong>ç°è±¡</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹èŠ‚ç‚¹è¯¦æƒ…</span></span><br><span class="line">kubectl describe pods nginx-7b7485646b-n9f8g  -n default  </span><br><span class="line"></span><br><span class="line"><span class="comment">################æŠ¥é”™ä¿¡æ¯##############</span></span><br><span class="line"></span><br><span class="line">Node-Selectors:                                                                                                          </span><br><span class="line">Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists <span class="keyword">for</span> 300s                                         </span><br><span class="line">                             node.kubernetes.io/unreachable:NoExecute op=Exists <span class="keyword">for</span> 300s                                       </span><br><span class="line">Events:                                                                                                                        </span><br><span class="line">  Type     Reason            Age    From               Message                                                                 </span><br><span class="line">  ----     ------            ----   ----               -------                                                                 </span><br><span class="line">  Warning  FailedScheduling  2m54s  default-scheduler  0/1 nodes are available: 1 node(s) had untolerated taint &#123;node-role.kubernetes.io/control-plane: &#125;. </span><br><span class="line">preemption: 0/1 nodes are available: 1 Preemption is not helpful <span class="keyword">for</span> scheduling.. </span><br></pre></td></tr></table></figure><p><strong>è§£å†³</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@k8s:~<span class="comment"># kubectl describe nodes |grep Taints                                                                                                      </span></span><br><span class="line">Taints:             node-role.kubernetes.io/control-plane:NoSchedule                                                                                 </span><br><span class="line">                                                                                                                                                                                        </span><br><span class="line">root@k8s:~<span class="comment"># kubectl get node                                                                                                                         </span></span><br><span class="line">NAME   STATUS   ROLES           AGE     VERSION                                                                                                      </span><br><span class="line">k8s    Ready    control-plane   4h22m   v1.26.5                                                                                                      </span><br><span class="line">root@k8s:~<span class="comment"># kubectl taint nodes k8s  node-role.kubernetes.io/control-plane-</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_169b466f0666661a0ccb13ce6795653b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_169b466f0666661a0ccb13ce6795653b.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8så¸¸ç”¨å‘½ä»¤</title>
      <link href="/2024/03/12/k8s%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2024/03/12/k8s%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="k8så¸¸ç”¨å‘½ä»¤"><a href="#k8så¸¸ç”¨å‘½ä»¤" class="headerlink" title="k8så¸¸ç”¨å‘½ä»¤"></a>k8så¸¸ç”¨å‘½ä»¤</h3><p>è¿™æ˜¯ä¸€ä¸ªç”¨äºç®¡ç† Kubernetes é›†ç¾¤çš„ kubectl å‘½ä»¤ã€‚è®©æˆ‘ä»¬è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‘½ä»¤çš„å„ä¸ªéƒ¨åˆ†ï¼š</p><ul><li><strong>kubectl</strong>: è¿™æ˜¯ Kubernetes å‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºä¸ Kubernetes é›†ç¾¤è¿›è¡Œäº¤äº’ï¼Œä¾‹å¦‚åˆ›å»ºã€ç®¡ç†å’Œç›‘è§†èµ„æºã€‚</li><li><strong>get</strong>: è¿™æ˜¯ kubectl å‘½ä»¤çš„ä¸€ä¸ªå­å‘½ä»¤ï¼Œç”¨äºæ£€ç´¢ï¼ˆè·å–ï¼‰Kubernetes é›†ç¾¤ä¸­çš„èµ„æºçš„ä¿¡æ¯ã€‚</li><li><strong>svc</strong>: è¿™æ˜¯ â€œserviceâ€ çš„ç¼©å†™ï¼Œè¡¨ç¤ºä½ å¸Œæœ›è·å–æœåŠ¡ï¼ˆServiceï¼‰çš„ç›¸å…³ä¿¡æ¯ã€‚</li><li><strong>deploy</strong>: è¿™æ˜¯ â€œdeploymentâ€ çš„ç¼©å†™ï¼Œè¡¨ç¤ºä½ å¸Œæœ›è·å–éƒ¨ç½²ï¼ˆDeploymentï¼‰çš„ç›¸å…³ä¿¡æ¯ã€‚</li><li><strong>-n kube-system</strong>: è¿™æ˜¯ä¸€ä¸ªæ ‡å¿—ï¼ˆflagï¼‰ï¼Œç”¨äºæŒ‡å®šè¦æ£€ç´¢èµ„æºæ‰€åœ¨çš„å‘½åç©ºé—´ï¼ˆnamespaceï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œâ€-n kube-systemâ€ è¡¨ç¤ºä½ å¸Œæœ›è·å–ä½äº kube-system å‘½åç©ºé—´ä¸­çš„æœåŠ¡çš„ä¿¡æ¯ã€‚</li></ul><p><strong>é€šè¿‡ymlåˆ›å»ºåˆ é™¤åº”ç”¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply  -f kuboard-offline.yml</span><br><span class="line">kubectl delete -f kuboard-offline.yml</span><br><span class="line">kubectl apply  -f nginx-deployment.yml</span><br></pre></td></tr></table></figure><p><strong>é€šè¿‡å‘½ä»¤è¡Œåˆ›å»ºåº”ç”¨</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å¸®åŠ©å‘½ä»¤</span></span><br><span class="line">kubectl create deployment --<span class="built_in">help</span></span><br><span class="line"><span class="comment"># å¼€å§‹å‘å¸ƒåº”ç”¨ æŒ‡å®šåç§°æ˜¯demo é•œåƒæ˜¯nginx:1.7.9 å‰¯æœ¬æ•°æ˜¯3</span></span><br><span class="line">kubectl create deployment demo --image=nginx:1.7.9 --replicas=3</span><br><span class="line"><span class="comment">#åˆ›å»ºserviceæš´éœ²ç«¯å£ä½¿ç”¨vipè®¿é—®</span></span><br><span class="line">kubectl expose deployment demo --port=80 --target-port=80 </span><br><span class="line"></span><br><span class="line">kubectl create deployment nginx --image=registry.cn-hangzhou.aliyuncs.com/xiaohh-docker/nginx:latest</span><br><span class="line">kubectl expose deployment nginx --port=80 --<span class="built_in">type</span>=LoadBalancer</span><br><span class="line">kubectl delete deployment nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºservice </span></span><br><span class="line">kubectl create -f nginx-service.yaml</span><br><span class="line"><span class="comment"># æŸ¥çœ‹æš´éœ²åœ¨å¤–éƒ¨çš„ç«¯å£</span></span><br><span class="line">kubectl get service/nginx-service</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤pod</span></span><br><span class="line">kubectl delete deployment demo </span><br></pre></td></tr></table></figure><p><strong>æš´éœ²å¤–éƒ¨ç«¯å£ç”¨äºè®¿é—®</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl  patch svc kubernetes-dashboard -n kubernetes-dashboard \</span><br><span class="line">-p <span class="string">&#x27;&#123;&quot;spec&quot;:&#123;&quot;type&quot;:&quot;NodePort&quot;,&quot;ports&quot;:[&#123;&quot;port&quot;:443,&quot;targetPort&quot;:8443,&quot;nodePort&quot;:30443&#125;]&#125;&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>æŸ¥çœ‹podè¯¦æƒ…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŸ¥çœ‹å‘½åç©ºé—´ä¸ºkube-systemçš„podè¯¦æƒ…</span></span><br><span class="line">kubectl get pods -n kube-system</span><br><span class="line">kubectl get pods -n kube-system -o wide</span><br><span class="line">kubectl describe pod kubernetes-dashboard-7bdfc744fc-hmhh2 -n kube-system</span><br><span class="line"><span class="comment"># è·å–ä½äº kube-system/kubernetes-dashboard å‘½åç©ºé—´ä¸­çš„æ‰€æœ‰æœåŠ¡ï¼ˆServiceï¼‰çš„ä¿¡æ¯ã€‚è¿™å°†åˆ—å‡º kube-system å‘½åç©ºé—´ä¸­æ‰€æœ‰æœåŠ¡çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬æœåŠ¡çš„åç§°ã€ç±»å‹ã€é›†ç¾¤IPç­‰ã€‚</span></span><br><span class="line">kubectl get svc -n kube-system</span><br><span class="line">kubectl get svc -n kubernetes-dashboard </span><br><span class="line"><span class="comment"># æŸ¥çœ‹ç³»ç»Ÿpodä»¥å¤–çš„podè¯¦æƒ…/æŸ¥çœ‹è‡ªå·±éƒ¨ç½²çš„åº”ç”¨</span></span><br><span class="line">kubectl get pods -o wide</span><br><span class="line">kubectl get deployments.apps</span><br><span class="line">kubectl describe pods nginx-deployment-57c68fcd95-sgd25</span><br><span class="line"><span class="comment"># æŸ¥çœ‹demoåº”ç”¨ï¼ˆå®¹å™¨ï¼‰service(svc)è¯¦ç»†</span></span><br><span class="line">kubectl describe service demo</span><br><span class="line"><span class="comment"># æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€</span></span><br><span class="line">kubectl get nodes</span><br><span class="line">kubectl get cs</span><br><span class="line"><span class="comment"># corednsç»„ä»¶ç”¨äºåšåç§°è§£æ ä¸»è¦æ˜¯é€šè¿‡daemonsets.appsçš„å½¢å¼åœ¨é‡Œé¢éƒ¨ç½²ä¸¤ä¸ªdaemonsetåˆ†åˆ«æ˜¯kube-flannel-ds å’Œ kube-proxy</span></span><br><span class="line">kubectl get daemonsets.apps -n kube-system</span><br></pre></td></tr></table></figure><p><strong>ç™»é™†è¿›å…¥podç›¸å½“äºdocker exec</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç™»å½•å®¹å™¨æŸ¥çœ‹volumesè¯¦æƒ…</span></span><br><span class="line">kubectl <span class="built_in">exec</span> -it volume-rbd-demo /bin/bash</span><br><span class="line">kubectl <span class="built_in">exec</span> -it volume-rbd-demo -- <span class="built_in">df</span> -h</span><br></pre></td></tr></table></figure><p><strong>éƒ¨åˆ†å‘½ä»¤å®Œæ•´å†™æ³•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get deployment --namespace=kubernetes-dashboard kubernetes-dashboard</span><br><span class="line"><span class="comment"># æˆ–</span></span><br><span class="line">$ kubectl describe deployment --namespace=kubernetes-dashboard kubernetes-dashboard</span><br><span class="line"><span class="comment"># æŸ¥çœ‹service</span></span><br><span class="line">$ kubectl get service --namespace=kubernetes-dashboard kubernetes-dashboard </span><br><span class="line">è¿”å›</span><br><span class="line">NAME                   TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)   AGE</span><br><span class="line">kubernetes-dashboard   ClusterIP   10.108.163.102   &lt;none&gt;        443/TCP   5m15s</span><br><span class="line"><span class="comment"># å¦å¤–æŸ¥çœ‹podçŠ¶æ€ (æ­¤æ—¶è¯´æ˜å®‰è£…å®Œæˆ</span></span><br><span class="line">$ kubectl --namespace=kubernetes-dashboard get pod -o wide | grep dashboard</span><br><span class="line">è¿”å›</span><br><span class="line">dashboard-metrics-scraper-79459f84f-5g8h6   1/1     Running   0          5m34s   172.16.0.9   ceph1   &lt;none&gt;   </span><br><span class="line">kubernetes-dashboard-76dc96b85f-nhwjd       1/1     Running   0          5m34s   172.16.0.8   ceph1   &lt;none&gt;</span><br><span class="line"><span class="comment"># æŸ¥çœ‹svc</span></span><br><span class="line">kubectl -n kubernetes-dashboard get svc</span><br><span class="line">NAME                        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE</span><br><span class="line">dashboard-metrics-scraper   ClusterIP   10.104.31.122    &lt;none&gt;        8000/TCP   32m</span><br><span class="line">kubernetes-dashboard        ClusterIP   10.108.163.102   &lt;none&gt;        443/TCP    32m</span><br><span class="line"><span class="comment"># å¦‚æœçŠ¶æ€ä¸€ç›´åˆ›å»ºä¸­, ä½¿ç”¨describeæŸ¥çœ‹å…·ä½“è¿‡ç¨‹ ï¼ˆå¦‚ä¸‹å›æ˜¾åˆ™éœ€è¦è®¾ç½®æ‹‰å–é•œåƒæ–¹æ³•ï¼‰</span></span><br><span class="line">$ kubectl describe pod --namespace=kubernetes-dashboard</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸€é”®éƒ¨ç½²k8sè„šæœ¬</title>
      <link href="/2024/03/11/%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E5%8D%95%E8%8A%82%E7%82%B9k8s%E8%84%9A%E6%9C%AC/"/>
      <url>/2024/03/11/%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E5%8D%95%E8%8A%82%E7%82%B9k8s%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>ä½¿ç”¨containerä½œä¸ºk8så®¹å™¨è¿è¡Œæ—¶æœåŠ¡å™¨ä¸éœ€è¦å®‰è£…cni<br><strong>kube-flannel.ymlé…ç½®åŸé“¾æ¥</strong><br><a href="https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml">https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</a></p></blockquote><h2 id="é¡¹ç›®é“¾æ¥-gt-gt-gt-gt-gt-gt-gt-gt-gt-gt-gt"><a href="#é¡¹ç›®é“¾æ¥-gt-gt-gt-gt-gt-gt-gt-gt-gt-gt-gt" class="headerlink" title="é¡¹ç›®é“¾æ¥ | &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;"></a>é¡¹ç›®é“¾æ¥ | &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</h2><p><a href="https://gitee.com/apple-Teawine/k8s/tree/master/deploy-k8s-container%E7%89%88">é¡¹ç›®é“¾æ¥</a></p><h2 id="éƒ¨ç½²å®Œæˆåæµ‹è¯•é›†ç¾¤çŠ¶æ€"><a href="#éƒ¨ç½²å®Œæˆåæµ‹è¯•é›†ç¾¤çŠ¶æ€" class="headerlink" title="éƒ¨ç½²å®Œæˆåæµ‹è¯•é›†ç¾¤çŠ¶æ€"></a>éƒ¨ç½²å®Œæˆåæµ‹è¯•é›†ç¾¤çŠ¶æ€</h2><h3 id="éƒ¨ç½²ä¸€ä¸ªNGNINX"><a href="#éƒ¨ç½²ä¸€ä¸ªNGNINX" class="headerlink" title="éƒ¨ç½²ä¸€ä¸ªNGNINX"></a>éƒ¨ç½²ä¸€ä¸ª<code>NGNINX</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl create deployment nginx  --image=nginx:1.14-alpine</span><br></pre></td></tr></table></figure><h3 id="æš´éœ²ç«¯å£-type-NodePorté›†ç¾¤ä¹‹å¤–è®¿é—®"><a href="#æš´éœ²ç«¯å£-type-NodePorté›†ç¾¤ä¹‹å¤–è®¿é—®" class="headerlink" title="æš´éœ²ç«¯å£--type=NodePorté›†ç¾¤ä¹‹å¤–è®¿é—®"></a>æš´éœ²ç«¯å£<code>--type=NodePort</code>é›†ç¾¤ä¹‹å¤–è®¿é—®</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl expose deploy nginx  --port=80 --target-port=80  --<span class="built_in">type</span>=NodePort</span><br></pre></td></tr></table></figure><h3 id="æŸ¥çœ‹å¤–éƒ¨è®¿é—®ç«¯å£ã€ä¸‰æ¡å‘½ä»¤éƒ½èƒ½ä½¿ç”¨ã€‘"><a href="#æŸ¥çœ‹å¤–éƒ¨è®¿é—®ç«¯å£ã€ä¸‰æ¡å‘½ä»¤éƒ½èƒ½ä½¿ç”¨ã€‘" class="headerlink" title="æŸ¥çœ‹å¤–éƒ¨è®¿é—®ç«¯å£ã€ä¸‰æ¡å‘½ä»¤éƒ½èƒ½ä½¿ç”¨ã€‘"></a>æŸ¥çœ‹å¤–éƒ¨è®¿é—®ç«¯å£ã€ä¸‰æ¡å‘½ä»¤éƒ½èƒ½ä½¿ç”¨ã€‘</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubecet get svc </span><br><span class="line">kubecet get svc -n deauflt</span><br><span class="line">kubectl get pod,svc</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_a3f218144218f3b84fc841c95cfa40e7.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_a3f218144218f3b84fc841c95cfa40e7.png"></p><p>æœ¬æ–‡å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_58648684/article/details/130699568">https://blog.csdn.net/weixin_58648684/article/details/130699568</a><br><a href="https://cn.linux-console.net/?p=3508">https://cn.linux-console.net/?p=3508</a>  containerå®‰è£…å‚è€ƒ<br><a href="https://wn-apple-teawine.fun/2023/06/04/ubuntu%E9%83%A8%E7%BD%B2kubernetes">https://wn-apple-teawine.fun/2023/06/04/ubuntuéƒ¨ç½²kubernetes</a><br><a href="https://www.cnblogs.com/way2backend/p/16970506.html#3-%E5%AE%89%E8%A3%85containerd">https://www.cnblogs.com/way2backend/p/16970506.html#3-%E5%AE%89%E8%A3%85containerd</a><br><a href="https://blog.csdn.net/IOT_AI/article/details/131916926">[Ubuntu 22.04] å®‰è£…containerd_ubuntu22.04 å®‰è£…containerd-CSDNåšå®¢</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨Linuxä¸Šä»¥All-in-Oneæ¨¡å¼å®‰è£…KubeSphere</title>
      <link href="/2024/03/10/%E5%9C%A8Linux%E4%B8%8A%E4%BB%A5All-in-One%E6%A8%A1%E5%BC%8F%E5%AE%89%E8%A3%85KubeSphere/"/>
      <url>/2024/03/10/%E5%9C%A8Linux%E4%B8%8A%E4%BB%A5All-in-One%E6%A8%A1%E5%BC%8F%E5%AE%89%E8%A3%85KubeSphere/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>é¦–å…ˆæœåŠ¡å™¨æ‰§è¡Œåˆå§‹åŒ–è„šæœ¬ å®‰è£…docker</p><p>æœ¬æ–‡å‚è€ƒï¼š<a href="https://kubesphere.io/zh/docs/v3.4/quick-start/all-in-one-on-linux/">https://kubesphere.io/zh/docs/v3.4/quick-start/all-in-one-on-linux/</a></p><h3 id="èŠ‚ç‚¹è¦æ±‚"><a href="#èŠ‚ç‚¹è¦æ±‚" class="headerlink" title="èŠ‚ç‚¹è¦æ±‚"></a>èŠ‚ç‚¹è¦æ±‚</h3><ul><li>èŠ‚ç‚¹å¿…é¡»èƒ½å¤Ÿé€šè¿‡ <code>SSH</code> è¿æ¥ã€‚</li><li>èŠ‚ç‚¹ä¸Šå¯ä»¥ä½¿ç”¨ <code>sudo</code>/<code>curl</code>/<code>openssl</code>/<code>tar</code> å‘½ä»¤ã€‚</li></ul><h3 id="å®¹å™¨è¿è¡Œæ—¶"><a href="#å®¹å™¨è¿è¡Œæ—¶" class="headerlink" title="å®¹å™¨è¿è¡Œæ—¶"></a>å®¹å™¨è¿è¡Œæ—¶</h3><p>æ‚¨çš„é›†ç¾¤å¿…é¡»æœ‰ä¸€ä¸ªå¯ç”¨çš„å®¹å™¨è¿è¡Œæ—¶ã€‚å¦‚æœæ‚¨ä½¿ç”¨ KubeKey æ­å»ºé›†ç¾¤ï¼ŒKubeKey ä¼šé»˜è®¤å®‰è£…æœ€æ–°ç‰ˆæœ¬çš„ Dockerã€‚æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨åˆ›å»ºé›†ç¾¤å‰æ‰‹åŠ¨å®‰è£… Docker æˆ–å…¶ä»–å®¹å™¨è¿è¡Œæ—¶ã€‚</p><table><thead><tr><th>æ”¯æŒçš„å®¹å™¨è¿è¡Œæ—¶</th><th>ç‰ˆæœ¬</th></tr></thead><tbody><tr><td>Docker</td><td>19.3.8 +</td></tr><tr><td>containerd</td><td>æœ€æ–°ç‰ˆ</td></tr><tr><td>CRI-Oï¼ˆè¯•éªŒç‰ˆï¼Œæœªç»å……åˆ†æµ‹è¯•ï¼‰</td><td>æœ€æ–°ç‰ˆ</td></tr><tr><td>iSulaï¼ˆè¯•éªŒç‰ˆï¼Œæœªç»å……åˆ†æµ‹è¯•ï¼‰</td><td>æœ€æ–°ç‰ˆ</td></tr></tbody></table><h3 id="ä¾èµ–é¡¹è¦æ±‚"><a href="#ä¾èµ–é¡¹è¦æ±‚" class="headerlink" title="ä¾èµ–é¡¹è¦æ±‚"></a>ä¾èµ–é¡¹è¦æ±‚</h3><p>KubeKey å¯ä»¥å°† Kubernetes å’Œ KubeSphere ä¸€åŒå®‰è£…ã€‚é’ˆå¯¹ä¸åŒçš„ Kubernetes ç‰ˆæœ¬ï¼Œéœ€è¦å®‰è£…çš„ä¾èµ–é¡¹å¯èƒ½æœ‰æ‰€ä¸åŒã€‚æ‚¨å¯ä»¥å‚è€ƒä»¥ä¸‹åˆ—è¡¨ï¼ŒæŸ¥çœ‹æ˜¯å¦éœ€è¦æå‰åœ¨èŠ‚ç‚¹ä¸Šå®‰è£…ç›¸å…³çš„ä¾èµ–é¡¹ã€‚</p><table><thead><tr><th>ä¾èµ–é¡¹</th><th>Kubernetes ç‰ˆæœ¬ â‰¥ 1.18</th><th>Kubernetes ç‰ˆæœ¬ &lt; 1.18</th></tr></thead><tbody><tr><td><code>socat</code></td><td>å¿…é¡»</td><td>å¯é€‰ä½†å»ºè®®</td></tr><tr><td><code>conntrack</code></td><td>å¿…é¡»</td><td>å¯é€‰ä½†å»ºè®®</td></tr><tr><td><code>ebtables</code></td><td>å¯é€‰ä½†å»ºè®®</td><td>å¯é€‰ä½†å»ºè®®</td></tr><tr><td><code>ipset</code></td><td>å¯é€‰ä½†å»ºè®®</td><td>å¯é€‰ä½†å»ºè®®</td></tr></tbody></table><p>KubeKey æ˜¯ç”¨ Go è¯­è¨€å¼€å‘çš„ä¸€æ¬¾å…¨æ–°çš„å®‰è£…å·¥å…·ï¼Œä»£æ›¿äº†ä»¥å‰åŸºäº ansible çš„å®‰è£…ç¨‹åºã€‚KubeKey ä¸ºç”¨æˆ·æä¾›äº†çµæ´»çš„å®‰è£…é€‰æ‹©ï¼Œå¯ä»¥åˆ†åˆ«å®‰è£… KubeSphere å’Œ Kubernetes æˆ–äºŒè€…åŒæ—¶å®‰è£…ï¼Œæ—¢æ–¹ä¾¿åˆé«˜æ•ˆã€‚</p><h3 id="ç½‘ç»œå’Œ-DNS-è¦æ±‚"><a href="#ç½‘ç»œå’Œ-DNS-è¦æ±‚" class="headerlink" title="ç½‘ç»œå’Œ DNS è¦æ±‚"></a>ç½‘ç»œå’Œ DNS è¦æ±‚</h3><ul><li>è¯·ç¡®ä¿ <code>/etc/resolv.conf</code> ä¸­çš„ DNS åœ°å€å¯ç”¨ï¼Œå¦åˆ™ï¼Œå¯èƒ½ä¼šå¯¼è‡´é›†ç¾¤ä¸­çš„ DNS å‡ºç°é—®é¢˜ã€‚</li><li>å¦‚æœæ‚¨çš„ç½‘ç»œé…ç½®ä½¿ç”¨é˜²ç«å¢™è§„åˆ™æˆ–å®‰å…¨ç»„ï¼Œè¯·åŠ¡å¿…ç¡®ä¿åŸºç¡€è®¾æ–½ç»„ä»¶å¯ä»¥é€šè¿‡ç‰¹å®šç«¯å£ç›¸äº’é€šä¿¡ã€‚å»ºè®®æ‚¨å…³é—­é˜²ç«å¢™ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://kubesphere.io/zh/docs/v3.3/installing-on-linux/introduction/port-firewall/">ç«¯å£è¦æ±‚</a>ã€‚</li><li>æ”¯æŒçš„ CNI æ’ä»¶ï¼šCalico å’Œ Flannelã€‚å…¶ä»–æ’ä»¶ä¹Ÿé€‚ç”¨ï¼ˆä¾‹å¦‚ Cilium å’Œ Kube-OVN ç­‰ï¼‰ï¼Œä½†è¯·æ³¨æ„å®ƒä»¬æœªç»å……åˆ†æµ‹è¯•ã€‚</li></ul><p>æç¤º</p><ul><li>å»ºè®®æ‚¨çš„æ“ä½œç³»ç»Ÿå¤„äºå¹²å‡€çŠ¶æ€ï¼ˆä¸å®‰è£…ä»»ä½•å…¶ä»–è½¯ä»¶ï¼‰ï¼Œå¦åˆ™å¯èƒ½ä¼šå‘ç”Ÿå†²çªã€‚</li><li>å¦‚æœæ‚¨æ— æ³•ä» <code>dockerhub.io</code> ä¸‹è½½å®¹å™¨é•œåƒï¼Œå»ºè®®æå‰å‡†å¤‡ä»“åº“çš„é•œåƒåœ°å€ï¼ˆå³åŠ é€Ÿå™¨ï¼‰ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://kubesphere.io/zh/docs/v3.4/faq/installation/configure-booster/">ä¸ºå®‰è£…é…ç½®åŠ é€Ÿå™¨</a>ã€‚</li></ul><p>ç¡¬ä»¶æ¨èé…ç½®</p><table><thead><tr><th>æ“ä½œç³»ç»Ÿ</th><th>æœ€ä½é…ç½®</th></tr></thead><tbody><tr><td><strong>Ubuntu</strong> <em>16.04</em>, <em>18.04</em>, <em>20.04</em>, <em>22.04</em></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr><tr><td><strong>Debian</strong> <em>Buster</em>, <em>Stretch</em></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr><tr><td><strong>CentOS</strong> <em>7.x</em></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr><tr><td><strong>Red Hat Enterprise Linux 7</strong></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr><tr><td><strong>SUSE Linux Enterprise Server 15/openSUSE Leap 15.2</strong></td><td>2 æ ¸ CPUï¼Œ4 GB å†…å­˜ï¼Œ40 GB ç£ç›˜ç©ºé—´</td></tr></tbody></table></blockquote><p><strong>ä¸€. å®‰è£…ä¾èµ–</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install -y socat conntrack ipset</span><br></pre></td></tr></table></figure><p><strong>äºŒ. æ‰§è¡Œéƒ¨ç½²k8s</strong></p><blockquote><p>æ­¤æ­¥éª¤éƒ¨ç½²å¾ˆå¯èƒ½å› ä¸ºç½‘ç»œåŸå› å¯¼è‡´å¤±è´¥</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è‹¥æ­¤å‘½ä»¤å¤±è´¥åˆ™ä½¿ç”¨ä¸‹æ–¹å…ˆä¸‹è½½è½¯ä»¶åŒ…è§£å‹åæ‰§è¡Œ</span></span><br><span class="line">curl -sfL https://get-kk.kubesphere.io | VERSION=v3.0.13 sh -</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ä¸‹è½½è½¯ä»¶åŒ…</span></span><br><span class="line">cd /opt &amp;&amp; curl -flO https://kubernetes.pek3b.qingstor.com/kubekey/releases/download/v3.0.13/kubekey-v3.0.13-linux-amd64.tar.gz</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">è§£å‹</span></span><br><span class="line">tar -xvf kubekey-v3.0.13-linux-amd64.tar.gz</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æœ¬æ–‡ä½¿ç”¨</span></span><br><span class="line">./kk create cluster --with-kubernetes v1.26.5 --container-manager containerd --with-kubesphere v3.4.1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">å¯é€‰</span></span><br><span class="line">./kk create cluster --with-kubernetes v1.26.5 --container-manager containerd --with-local-storage</span><br></pre></td></tr></table></figure><p>k8sç‰ˆæœ¬å·å‚è€ƒï¼š<a href="https://kubernetes.io/zh-cn/releases/">å‘è¡Œç‰ˆæœ¬ | Kubernetes</a></p><p><strong>ä¸‰. æœ€åï¼šéªŒè¯å®‰è£…ç»“æœ</strong></p><p>è¾“å…¥ä»¥ä¸‹å‘½ä»¤ä»¥æ£€æŸ¥å®‰è£…ç»“æœã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l &#x27;app in (ks-install, ks-installer)&#x27; -o jsonpath=&#x27;&#123;.items[0].metadata.name&#125;&#x27;) -f</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¿¡æ¯ä¼šæ˜¾ç¤º Web æ§åˆ¶å°çš„ IP åœ°å€å’Œç«¯å£å·ï¼Œé»˜è®¤çš„ NodePort æ˜¯ <code>30880</code>ã€‚ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨é»˜è®¤çš„å¸æˆ·å’Œå¯†ç  (<code>admin/P@88w0rd</code>) é€šè¿‡ <code>&lt;NodeIP&gt;:30880</code> è®¿é—®æ§åˆ¶å°ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœåŠ¡å™¨é­å—SYNæ´ªæ°´æ”»å‡»</title>
      <link href="/2024/03/05/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%81%AD%E5%8F%97SYN%E6%B4%AA%E6%B0%B4%E6%94%BB%E5%87%BB/"/>
      <url>/2024/03/05/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%81%AD%E5%8F%97SYN%E6%B4%AA%E6%B0%B4%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>å¼•ç”¨GPT3.5å›ç­”ï¼š</p><p>SYN æ´ªæ°´æ”»å‡»ï¼ˆSYN floodingï¼‰çš„æƒ…å†µã€‚SYN æ´ªæ°´æ”»å‡»æ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œæ”»å‡»æ–¹å¼ï¼Œæ”»å‡»è€…å‘é€å¤§é‡ä¼ªé€ çš„ TCP è¿æ¥è¯·æ±‚ï¼ˆSYN åŒ…ï¼‰ï¼Œå¯¼è‡´æœåŠ¡å™¨èµ„æºè€—å°½æˆ–ç½‘ç»œæ‹¥å¡ã€‚</p><p>å†…æ ¸æ£€æµ‹åˆ°å¯èƒ½çš„ SYN æ´ªæ°´æ”»å‡»åï¼Œä¼šé‡‡å–ä¸€äº›æªæ–½æ¥åº”å¯¹ï¼Œå…¶ä¸­ä¹‹ä¸€æ˜¯å‘é€ cookiesã€‚TCP SYN cookies æ˜¯ä¸€ç§ç”¨äºé˜²æ­¢ SYN æ´ªæ°´æ”»å‡»çš„æŠ€æœ¯ï¼Œå®ƒå…è®¸æœåŠ¡å™¨åœ¨é­å— SYN æ´ªæ°´æ”»å‡»æ—¶ç»§ç»­å¤„ç†è¿æ¥è¯·æ±‚ï¼Œè€Œæ— éœ€ç»´æŠ¤åŠå¼€è¿æ¥çš„çŠ¶æ€ã€‚</p><p>å®ƒæ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œæ”»å‡»ç±»å‹ï¼Œæ—¨åœ¨ä½¿æœåŠ¡å™¨ä¸å¯ç”¨ã€‚åœ¨è¿™ç§æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å‘é€å¤§é‡ä¼ªé€ çš„ SYN æ•°æ®åŒ…åˆ°æœåŠ¡å™¨ä¸Šï¼Œä½¿æœåŠ¡å™¨æ— æ³•å¤„ç†æ‰€æœ‰è¿™äº›è¿æ¥è¯·æ±‚ï¼Œä»è€Œè€—å°½å…¶èµ„æºã€‚</p></blockquote><h4 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h4><p><strong>ç°è±¡ï¼š</strong></p><p><code>Mar  5 18:04:28 ybh83aa9pnppbp kernel: TCP: request_sock_TCP: Possible SYN flooding on port 22. Sending cookies.  Check SNMP counters.</code></p><p>è¿™ä¸ªæ˜¯é­å—åˆ°äº†Â SYN æ´ªæ°´æ”»å‡»ï¼ˆSYN floodingï¼‰<br>æ‚¨å¯¹22ç«¯å£åšä¸ªç™½åå•é™åˆ¶å°±è¡Œäº†<br>æˆ–è€…ä½¿ç”¨è¿™ä¸ªå·¥å…·è¿›è¡Œé˜²å¾¡è¿™ç§æ”»å‡»<br><a href="https://github.com/fail2ban/fail2ban">https://github.com/fail2ban/fail2ban</a></p><blockquote><p>å¼•ç”¨GPT3.5å›ç­”ï¼š</p><p>è¿™ä¸ªé”™è¯¯è¡¨æ˜ä½ çš„LinuxæœåŠ¡å™¨å¯èƒ½å—åˆ°äº† SYN æ´ªæ°´æ”»å‡»ï¼Œå®ƒæ˜¯ä¸€ç§å¸¸è§çš„ç½‘ç»œæ”»å‡»ç±»å‹ï¼Œæ—¨åœ¨ä½¿æœåŠ¡å™¨ä¸å¯ç”¨ã€‚åœ¨è¿™ç§æ”»å‡»ä¸­ï¼Œæ”»å‡»è€…å‘é€å¤§é‡ä¼ªé€ çš„ SYN æ•°æ®åŒ…åˆ°æœåŠ¡å™¨ä¸Šï¼Œä½¿æœåŠ¡å™¨æ— æ³•å¤„ç†æ‰€æœ‰è¿™äº›è¿æ¥è¯·æ±‚ï¼Œä»è€Œè€—å°½å…¶èµ„æºã€‚</p><p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥é‡‡å–ä»¥ä¸‹æªæ–½ï¼š</p><ol><li><p><strong>å¢åŠ  SYN æ”¶é˜Ÿåˆ—çš„å¤§å°</strong>ï¼šé€šè¿‡è°ƒæ•´å†…æ ¸å‚æ•°ï¼Œå¢åŠ æœåŠ¡å™¨ä¸Š SYN æ”¶é˜Ÿåˆ—çš„å¤§å°ï¼Œä½¿å…¶èƒ½å¤Ÿå¤„ç†æ›´å¤šçš„è¿æ¥è¯·æ±‚ã€‚ä½ å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>/proc/sys/net/ipv4/tcp_max_syn_backlog</code> å‚æ•°æ¥å®ç°ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†é˜Ÿåˆ—å¤§å°å¢åŠ åˆ° 1024ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_max_syn_backlog=1024</span><br></pre></td></tr></table></figure></li><li><p><strong>é…ç½®é˜²ç«å¢™</strong>ï¼šä½¿ç”¨é˜²ç«å¢™æ¥è¿‡æ»¤æ¥è‡ªå¤–éƒ¨ç½‘ç»œçš„æ¶æ„æµé‡ã€‚å¯ä»¥é…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œé™åˆ¶æ¯ä¸ª IP åœ°å€å¯¹ SSH ç«¯å£çš„è¿æ¥é€Ÿç‡ï¼Œæˆ–è€…ä½¿ç”¨å·¥å…·å¦‚ Fail2Ban æ¥è‡ªåŠ¨æ£€æµ‹å¹¶å°é”æ¶æ„ IP åœ°å€ã€‚</p></li><li><p><strong>ä½¿ç”¨ SYN Cookie</strong>ï¼šå¯ç”¨ SYN Cookie å¯ä»¥é˜²æ­¢æœåŠ¡å™¨è¢« SYN æ´ªæ°´æ”»å‡»æ‰€æ‹’ç»æœåŠ¡ã€‚è¿™ä¸ªé€‰é¡¹ä¼šåœ¨æœåŠ¡å™¨ç«¯åœ¨æ”¶åˆ° SYN è¯·æ±‚æ—¶ä¸åˆ†é…èµ„æºï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªåŠ å¯†çš„ Cookie å‘é€ç»™å®¢æˆ·ç«¯ã€‚åªæœ‰å½“å®¢æˆ·ç«¯è¿”å›å¸¦æœ‰æ­£ç¡® Cookie çš„ ACK è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨æ‰ä¼šåˆ†é…èµ„æºå¹¶å®Œæˆ TCP æ¡æ‰‹ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯ç”¨ SYN Cookieï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_syncookies=1</span><br></pre></td></tr></table></figure></li><li><p><strong>æ›´æ–°ç³»ç»Ÿå’Œè½¯ä»¶</strong>ï¼šç¡®ä¿ä½ çš„ç³»ç»Ÿå’Œæ‰€æœ‰å®‰å…¨ç›¸å…³çš„è½¯ä»¶éƒ½æ˜¯æœ€æ–°çš„ç‰ˆæœ¬ï¼Œå› ä¸ºå‚å•†é€šå¸¸ä¼šä¿®å¤å·²çŸ¥çš„æ¼æ´å’Œå®‰å…¨é—®é¢˜ã€‚</p></li><li><p><strong>ç›‘æ§ç½‘ç»œæµé‡</strong>ï¼šå®šæœŸç›‘æ§æœåŠ¡å™¨ä¸Šçš„ç½‘ç»œæµé‡ï¼Œå¹¶åœ¨æ£€æµ‹åˆ°å¼‚å¸¸æµé‡æ—¶åŠæ—¶é‡‡å–è¡ŒåŠ¨ã€‚</p></li><li><p><strong>é™åˆ¶ SSH è®¿é—®</strong>ï¼šå¦‚æœå¯èƒ½ï¼Œå°è¯•é™åˆ¶ SSH è®¿é—®åªå…è®¸æ¥è‡ªç‰¹å®š IP åœ°å€èŒƒå›´çš„è¿æ¥ï¼Œä»¥å‡å°‘æœåŠ¡å™¨å—åˆ°æ”»å‡»çš„é£é™©ã€‚</p></li></ol><p>å¦‚æœä»¥ä¸Šæªæ–½éƒ½ä¸èƒ½è§£å†³é—®é¢˜ï¼Œä½ å¯èƒ½éœ€è¦è¿›ä¸€æ­¥çš„è°ƒæŸ¥å’Œåˆ†æï¼Œå¯èƒ½éœ€è¦ä¸ç½‘ç»œå®‰å…¨ä¸“å®¶åˆä½œï¼Œä»¥æ‰¾å‡ºæ›´æ·±å±‚æ¬¡çš„è§£å†³æ–¹æ¡ˆã€‚</p></blockquote><h4 id="fail2banå®‰è£…åŠä½¿ç”¨å‚è€ƒ"><a href="#fail2banå®‰è£…åŠä½¿ç”¨å‚è€ƒ" class="headerlink" title="fail2banå®‰è£…åŠä½¿ç”¨å‚è€ƒ"></a>fail2banå®‰è£…åŠä½¿ç”¨å‚è€ƒ</h4><p><a href="https://blog.csdn.net/dudu1225/article/details/121242917">Fail2banå®‰è£…åŠé…ç½®</a><br><a href="https://blog.csdn.net/qq_46229380/article/details/109802360">Fail2banå®‰è£…åŠé…ç½®å‹ç¼©åŒ…æ–¹å¼å®‰è£…</a><br><a href="https://www.jianshu.com/p/4fdec5794d08">CentOS7ä¸‹å®‰è£…å’Œä½¿ç”¨Fail2ban - ç®€ä¹¦ (jianshu.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windowsæˆ–Linux SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†</title>
      <link href="/2024/02/19/Windows%E6%88%96Linux%20SSH%E8%BF%9E%E6%8E%A5%E6%88%96%E8%80%85%E6%9C%8D%E5%8A%A1%E5%81%B6%E5%8F%91%E6%80%A7%E6%96%AD%E5%BC%80%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/"/>
      <url>/2024/02/19/Windows%E6%88%96Linux%20SSH%E8%BF%9E%E6%8E%A5%E6%88%96%E8%80%85%E6%9C%8D%E5%8A%A1%E5%81%B6%E5%8F%91%E6%80%A7%E6%96%AD%E5%BC%80%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="Windowsæˆ–Linux-SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†"><a href="#Windowsæˆ–Linux-SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†" class="headerlink" title="Windowsæˆ–Linux SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†"></a>Windowsæˆ–Linux SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†</h3><p><a href="https://support.huaweicloud.com/trouble-ecs/ecs-trouble.pdf">æŸ¥çœ‹PDF</a></p><p><a href>åˆ†äº«</a></p><h4 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h4><p>è¯¥æ–‡æ¡£é€‚ç”¨äºåœ¨SSHè¿æ¥Linuxäº‘æœåŠ¡å™¨æˆ–è€…è®¿é—®è¯¥æœåŠ¡å™¨ä¸Šçš„åº”ç”¨æ—¶å¶ç°è¿æ¥æ–­å¼€ã€‚</p><h4 id="çº¦æŸä¸é™åˆ¶"><a href="#çº¦æŸä¸é™åˆ¶" class="headerlink" title="çº¦æŸä¸é™åˆ¶"></a>çº¦æŸä¸é™åˆ¶</h4><ol><li>ä¿®æ”¹ç³»ç»Ÿå†…æ ¸å‚æ•°å¯èƒ½äº§ç”Ÿå†…æ ¸ä¸ç¨³å®šï¼Œè¯·è¯„ä¼°é£é™©åè¿›è¡Œæ“ä½œã€‚</li><li>ä¸ºäº†ç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œä¿®æ”¹å†…æ ¸å‚æ•°åå»ºè®®åœ¨åˆç†çš„æ—¶é—´é‡å¯ç³»ç»Ÿã€‚</li></ol><h4 id="æ ¹å› åˆ†æ"><a href="#æ ¹å› åˆ†æ" class="headerlink" title="æ ¹å› åˆ†æ"></a>æ ¹å› åˆ†æ</h4><ol><li><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹ç³»ç»Ÿå†…æ ¸æ˜¯å¦å¼€å¯äº†TIME_WAITå¿«é€Ÿå›æ”¶å’Œé‡åˆ©ç”¨ç­–ç•¥</p><p><strong>sysctl -a |grep tcp_tw</strong></p><p>å¦‚<a href="https://support.huaweicloud.com/trouble-ecs/ecs_trouble_0317.html#ecs_trouble_0317__fig258143323916">å›¾1</a>æ‰€ç¤ºï¼Œç¡®è®¤å·²å¼€å¯è¯¥ç­–ç•¥ã€‚</p><p><strong>å›¾1</strong> TIME_WAIT<br><img src="https://support.huaweicloud.com/trouble-ecs/zh-cn_image_0174991741.png"></p></li><li><p>ç”±äºæœåŠ¡ç«¯å¼€å¯äº†TIME_WAITå¿«é€Ÿå›æ”¶å’Œé‡åˆ©ç”¨ç­–ç•¥å¯¼è‡´ï¼Œå³å¯ç”¨äº†net.ipv4.tcp_tw_recycleæˆ–è€…net.ipv4.tcp_tw_reuseã€‚ç³»ç»Ÿé»˜è®¤æ˜¯ä¸å¯ç”¨è¯¥åŠŸèƒ½ã€‚<br><img src="https://res-static.hc-cdn.cn/aem/content/dam/cloudbu-site/archive/china/zh-cn/support/resource/framework/v3/images/support-doc-new-note.svg">è¯´æ˜ï¼šå®¢æˆ·ç«¯é€šå¸¸åœ¨NATç¯å¢ƒä¸‹ï¼Œå¤šå°ç»ˆç«¯ä½¿ç”¨åŒä¸€ä¸ªå…¬ç½‘ipï¼Œæ— æ³•å®ç°æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„ä¸€å¯¹ä¸€è¿æ¥ã€‚å¦‚æœå¼€å¯æ­¤å‚æ•°æœåŠ¡ç«¯ä¼šå›æ”¶å¤„äºTIME_WAITçŠ¶æ€çš„TCPè¿æ¥ï¼Œå¯¼è‡´è¿æ¥æ–­å¼€ã€‚</p></li></ol><h4 id="æ“ä½œæ–¹æ³•ï¼š"><a href="#æ“ä½œæ–¹æ³•ï¼š" class="headerlink" title="æ“ä½œæ–¹æ³•ï¼š"></a>æ“ä½œæ–¹æ³•ï¼š</h4><p>å…³é—­ä¸Šè¿°ä¸¤ä¸ªå†…æ ¸å‚æ•°ï¼Œæ‰“å¼€/etc/sysctl.confï¼Œæ·»åŠ æˆ–è€…ä¿®æ”¹ä¸‹åˆ—ä¸¤è¡Œã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.tcp_tw_recycle = 0</span><br><span class="line">net.ipv4.tcp_tw_reuse = 0</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œä½¿ä¿®æ”¹çš„é…ç½®ç”Ÿæ•ˆã€‚<br><strong># sysctl -p</strong></p><p><img src="https://res-static.hc-cdn.cn/aem/content/dam/cloudbu-site/archive/china/zh-cn/support/resource/framework/v3/images/support-doc-new-note.svg">è¯´æ˜ï¼šå¯åŠ¨ä¸­ä¿®æ”¹å†…æ ¸å‚æ•°å¯èƒ½å­˜åœ¨å†…æ ¸åŠ è½½è¯¥å‚æ•°ä¸ç¨³å®šçš„æƒ…å†µï¼Œå»ºè®®åœ¨åˆé€‚çš„æ—¶é—´è¿›è¡Œé‡å¯ã€‚</p><p>ä¸Šæ–‡å‚è€ƒï¼š<a href="https://support.huaweicloud.com/trouble-ecs/ecs_trouble_0317.html">SSHè¿æ¥æˆ–è€…æœåŠ¡å¶å‘æ€§æ–­å¼€é—®é¢˜å¤„ç†_å¼¹æ€§äº‘æœåŠ¡å™¨ ECS_æ•…éšœæ’é™¤_SSHè¿æ¥ (huaweicloud.com)</a></p><h4 id="windowsæœåŠ¡å¶å‘æ€§æ–­è¿è§£å†³"><a href="#windowsæœåŠ¡å¶å‘æ€§æ–­è¿è§£å†³" class="headerlink" title="windowsæœåŠ¡å¶å‘æ€§æ–­è¿è§£å†³"></a>windowsæœåŠ¡å¶å‘æ€§æ–­è¿è§£å†³</h4><p>æ­¤æ–‡å‚è€ƒï¼š</p><p><a href="https://zhuanlan.zhihu.com/p/604394878">https://zhuanlan.zhihu.com/p/604394878</a><br><a href="https://blog.csdn.net/boonya/article/details/105700988">https://blog.csdn.net/boonya/article/details/105700988</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzkzNzI1MzE2Mw==&mid=2247484249&idx=1&sn=d522df8c29cdc5c2bb1c466403c0d737&chksm=c293031df5e48a0b7856b9a553dbf1df27015afe09c939f114ad35ad486a30737dd4b258f4e5&scene=21#wechat_redirect">è¿ç»´æ’æŸ¥ç¯‡ | æœåŠ¡å™¨äº§ç”Ÿå¤§é‡çš„TIME_WAITçš„åŸå› ä½ çŸ¥é“å—ï¼Ÿ</a></p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openstackä¸Šä½¿ç”¨windowsé•œåƒåˆ¶ä½œ</title>
      <link href="/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/"/>
      <url>/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä¸€-workstdtion-vsphere-åˆ¶ä½œopenstacké•œåƒ"><a href="#ä¸€-workstdtion-vsphere-åˆ¶ä½œopenstacké•œåƒ" class="headerlink" title="ä¸€.  workstdtion/ vsphere åˆ¶ä½œopenstacké•œåƒ"></a>ä¸€.  <code>workstdtion</code>/ vsphere åˆ¶ä½œ<code>openstack</code>é•œåƒ</h2><h3 id="note"><a href="#note" class="headerlink" title="note:"></a>note:</h3><h4 id="æ¼”ç¤ºwindows-server2016ç‰ˆæœ¬-é…ç½®æ—¶éœ€è¦è‡³å°‘ç»™Cç›˜50Gç©ºé—´"><a href="#æ¼”ç¤ºwindows-server2016ç‰ˆæœ¬-é…ç½®æ—¶éœ€è¦è‡³å°‘ç»™Cç›˜50Gç©ºé—´" class="headerlink" title="æ¼”ç¤ºwindows-server2016ç‰ˆæœ¬ / é…ç½®æ—¶éœ€è¦è‡³å°‘ç»™Cç›˜50Gç©ºé—´"></a>æ¼”ç¤º<code>windows-server2016</code>ç‰ˆæœ¬ / é…ç½®æ—¶éœ€è¦è‡³å°‘ç»™Cç›˜<code>50G</code>ç©ºé—´</h4><h3 id="å‰è¨€ï¼š"><a href="#å‰è¨€ï¼š" class="headerlink" title="å‰è¨€ï¼š"></a>å‰è¨€ï¼š</h3><blockquote><p><strong>å› ä¸º windows é»˜è®¤ä¸æ”¯æŒ virtio é©±åŠ¨ï¼Œè€Œé€šè¿‡ openstack ç®¡ç†çš„è™šæ‹Ÿæœºæ˜¯éœ€è¦ virtio é©±åŠ¨çš„ï¼Œæ‰€ä»¥éœ€è¦ç»™ windows å®‰è£…é©±åŠ¨ï¼ŒåŒ…æ‹¬ç¡¬ç›˜é©±åŠ¨å’Œç½‘å¡é©±åŠ¨å¦å¤–è¿˜éœ€è¦å®‰è£…CloudbaseInitSetupå’Œqemu-ga (qemu-guest-agent)</strong> <a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/</a> <strong>ä»¥ä¸Šåœ°å€å¯ä¸‹è½½æœ€æ–°ç¨³å®šç‰ˆçš„ virtio-win-x.x.xxx.iso æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«äº†ç¡¬ç›˜é©±åŠ¨å’Œç½‘å¡é©±åŠ¨ä»¥åŠ</strong></p></blockquote><h3 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><ul><li><a href="https://www.jianshu.com/p/60caf1c2f10a">https://www.jianshu.com/p/60caf1c2f10a</a>                                                                 ï¼ˆç®€ä¹¦ï¼‰</li><li><a href="https://support.huaweicloud.com/usermanual-ims/zh-cn_topic_0030730602.html">https://support.huaweicloud.com/usermanual-ims/zh-cn_topic_0030730602.html</a>   ï¼ˆåä¸ºäº‘ could-initä½¿ç”¨ï¼‰</li><li><a href="https://cloud.tencent.com/document/product/213/30000">https://cloud.tencent.com/document/product/213/30000</a>                                             (è…¾è®¯äº‘  could-inité…ç½®)</li><li><a href="https://blog.51cto.com/readshlinux/1902888">https://blog.51cto.com/readshlinux/1902888</a>                                                                (51ctoä¿®æ”¹å¯†ç è„šæœ¬)</li></ul><h3 id="å‘½ä»¤å‚è€ƒï¼š"><a href="#å‘½ä»¤å‚è€ƒï¼š" class="headerlink" title="å‘½ä»¤å‚è€ƒï¼š"></a>å‘½ä»¤å‚è€ƒï¼š</h3><ul><li><a href="http://linuxcoming.com/blog/2019/09/03/linux_basic_tools_virt_install_os_variant.html">http://linuxcoming.com/blog/2019/09/03/linux_basic_tools_virt_install_os_variant.html</a></li><li><strong>é©±åŠ¨æ— æ³•å®‰è£…å‚è€ƒï¼š</strong></li><li><a href="https://zhidao.baidu.com/question/2207933972086796788.html">https://zhidao.baidu.com/question/2207933972086796788.html</a></li></ul><h4 id="å®‰è£…å¿…å¤‡è½¯ä»¶"><a href="#å®‰è£…å¿…å¤‡è½¯ä»¶" class="headerlink" title="å®‰è£…å¿…å¤‡è½¯ä»¶"></a>å®‰è£…å¿…å¤‡è½¯ä»¶</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å®‰è£…å¿…å¤‡è½¯ä»¶</span><br><span class="line">yum install -y qemu-kvm libvirt virt-install bridge-utils</span><br></pre></td></tr></table></figure><h3 id="1-ä¸‹è½½Cloudbase-Initå·¥å…·-ä¸‹è½½Cloudbase-Initå·¥å…·å®‰è£…åŒ…ã€‚"><a href="#1-ä¸‹è½½Cloudbase-Initå·¥å…·-ä¸‹è½½Cloudbase-Initå·¥å…·å®‰è£…åŒ…ã€‚" class="headerlink" title="1.ä¸‹è½½Cloudbase-Initå·¥å…·  ä¸‹è½½Cloudbase-Initå·¥å…·å®‰è£…åŒ…ã€‚"></a><code>1</code>.ä¸‹è½½<code>Cloudbase-Init</code>å·¥å…·  ä¸‹è½½<code>Cloudbase-Init</code>å·¥å…·å®‰è£…åŒ…ã€‚</h3><p><strong>æ ¹æ®Windowsæ“ä½œç³»ç»Ÿçš„ä¸åŒä½æ•°ï¼Œæ‚¨éœ€è¦ä¸‹è½½ä¸åŒç‰ˆæœ¬çš„Cloudbase-Initå·¥å…·å®‰è£…åŒ…ã€‚</strong></p><p><strong>Cloudbaseå®˜ç½‘ï¼š</strong></p><p><a href="https://links.jianshu.com/go?to=http://www.cloudbase.it/cloud-init-for-windows-instances/">http://www.cloudbase.it/cloud-init-for-windows-instances/</a>ã€‚</p><p><strong>Cloudbase-Initåˆ†ä¸ºç¨³å®šç‰ˆæœ¬å’ŒBetaç‰ˆæœ¬ä¸¤ç§ã€‚</strong> <strong>ç¨³å®šç‰ˆæœ¬è·å–è·¯å¾„ï¼š</strong></p><p><strong>64ä½ï¼š</strong></p><p><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x64.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x64.msi</a><br><a href="https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_11_x64.msi">https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_11_x64.msi</a><br><a href="https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_9_x64.msi">https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_9_x64.msi</a></p><p><strong>32ä½ï¼š</strong></p><p><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x86.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x86.msi</a></p><p><strong>Betaç‰ˆæœ¬è·å–è·¯å¾„ï¼š</strong></p><p><strong>64ä½ï¼š</strong><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_x64.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_x64.msi</a></p><p><strong>32ä½ï¼š</strong><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_x86.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_x86.msi</a></p><p><strong>virtio-winé©±åŠ¨ä¸‹è½½:</strong></p><p><strong><a href="https://links.jianshu.com/go?to=https://github.com/virtio-win/kvm-guest-drivers-windows">https://github.com/virtio-win/kvm-guest-drivers-windows</a></strong></p><p><strong>æˆ–</strong></p><p><a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/</a></p><h4 id="windows-isoé•œåƒä¸‹è½½åœ°å€ï¼š"><a href="#windows-isoé•œåƒä¸‹è½½åœ°å€ï¼š" class="headerlink" title="windows-isoé•œåƒä¸‹è½½åœ°å€ï¼š"></a>windows-isoé•œåƒä¸‹è½½åœ°å€ï¼š</h4><p><a href="https://msdn.itellyou.cn/">https://msdn.itellyou.cn/</a></p><hr><h4 id="é¦–å…ˆå¼€å¯vcenter-vmwareè™šæ‹ŸåŒ–ï¼š"><a href="#é¦–å…ˆå¼€å¯vcenter-vmwareè™šæ‹ŸåŒ–ï¼š" class="headerlink" title="é¦–å…ˆå¼€å¯vcenter/vmwareè™šæ‹ŸåŒ–ï¼š"></a>é¦–å…ˆå¼€å¯vcenter/vmwareè™šæ‹ŸåŒ–ï¼š</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c7a56db15460c4c9ec3337ba89289ef2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c7a56db15460c4c9ec3337ba89289ef2.png"></p><h5 id="æ³¨æ„äº‹é¡¹ï¼š-ç›®å½•å»ºè®®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•-ä¸èƒ½åœ¨-rootç›®å½•æ‰§è¡Œåˆ›å»ºå·¥ä½œç›®å½•-ä¼šæŠ¥é”™-æƒé™é”™è¯¯"><a href="#æ³¨æ„äº‹é¡¹ï¼š-ç›®å½•å»ºè®®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½•-ä¸èƒ½åœ¨-rootç›®å½•æ‰§è¡Œåˆ›å»ºå·¥ä½œç›®å½•-ä¼šæŠ¥é”™-æƒé™é”™è¯¯" class="headerlink" title="æ³¨æ„äº‹é¡¹ï¼š  ç›®å½•å»ºè®®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½• ä¸èƒ½åœ¨/rootç›®å½•æ‰§è¡Œåˆ›å»ºå·¥ä½œç›®å½• ä¼šæŠ¥é”™ æƒé™é”™è¯¯"></a>æ³¨æ„äº‹é¡¹ï¼š  ç›®å½•å»ºè®®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªæ–°ç›®å½• ä¸èƒ½åœ¨/rootç›®å½•æ‰§è¡Œåˆ›å»ºå·¥ä½œç›®å½• ä¼šæŠ¥é”™ æƒé™é”™è¯¯</h5><h4 id="ä¸‹è½½å®Œæˆæˆªå›¾ï¼šå…±3è½¯ä»¶"><a href="#ä¸‹è½½å®Œæˆæˆªå›¾ï¼šå…±3è½¯ä»¶" class="headerlink" title="ä¸‹è½½å®Œæˆæˆªå›¾ï¼šå…±3è½¯ä»¶"></a>ä¸‹è½½å®Œæˆæˆªå›¾ï¼šå…±<code>3</code>è½¯ä»¶</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_29087c9168c1688bc91ff2c661a017a6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_29087c9168c1688bc91ff2c661a017a6.png"></p><h3 id="2-ç½‘å¡é…ç½®ï¼ˆç‰©ç†æœº-vmware-vcenteråˆ›å»ºï¼‰"><a href="#2-ç½‘å¡é…ç½®ï¼ˆç‰©ç†æœº-vmware-vcenteråˆ›å»ºï¼‰" class="headerlink" title="2. ç½‘å¡é…ç½®ï¼ˆç‰©ç†æœº/ vmware / vcenteråˆ›å»ºï¼‰"></a><code>2</code>. ç½‘å¡é…ç½®ï¼ˆç‰©ç†æœº<code>/ vmware / vcenter</code>åˆ›å»ºï¼‰</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># å¤‡ä»½ç½‘å¡</span><br><span class="line">cp ifcfg-ens33 ifcfg-br0</span><br></pre></td></tr></table></figure><h5 id="ä¿®æ”¹ifcfg-ens33"><a href="#ä¿®æ”¹ifcfg-ens33" class="headerlink" title="ä¿®æ”¹ifcfg-ens33"></a>ä¿®æ”¹<code>ifcfg-ens33</code></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">2ã€BOOTPROTO=&quot;dhcp&quot; # æ”¹ä¸º BOOTPROTO=&quot;static&quot;</span><br><span class="line">3ã€BRIDGE=br0 Â  Â  Â  # è°ƒæ•´ä¸ºç½‘æ¡¥æ¨¡å¼ å…¶ä»–ä¸åšæ›´æ”¹</span><br><span class="line"># ä¿ç•™å¦‚ä¸‹é…ç½®å…¶ä»–é…ç½®é€šé€šåˆ é™¤</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens33</span><br><span class="line">BRIDGE=br0</span><br><span class="line">UUID=01d75770-3b87-47e3-bbc3-bebaed2293e3</span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=yes</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6372d21fbb18fb333f61a84f13eed939.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6372d21fbb18fb333f61a84f13eed939.png"></p><h4 id="ä¿®æ”¹ifcfg-br0"><a href="#ä¿®æ”¹ifcfg-br0" class="headerlink" title="ä¿®æ”¹ifcfg-br0"></a>ä¿®æ”¹<code>ifcfg-br0</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">1ã€TYPE=&quot;Ethernet&quot; Â  # ä¿®æ”¹ä¸ºTYPE=&quot;Bridge&quot;</span><br><span class="line">2ã€BOOTPROTO=&quot;dhcp&quot; Â # æ”¹ä¸ºÂ BOOTPROTO=&quot;static&quot;</span><br><span class="line">3ã€NAME=&quot;ens33&quot; Â  Â  Â # ä¿®æ”¹ä¸ºÂ NAME=&quot;br0&quot;Â  åŠÂ DEVICE=&quot;ens33&quot;Â  ä¿®æ”¹ä¸ºÂ DEVICE=&quot;br0&quot;</span><br><span class="line">4ã€æ³¨é‡Š UUIDÂ  Â  Â  Â  Â # UUID=&quot;a8d78ec6-485c-4d14-aae1-1908bc6b9a61&quot;</span><br><span class="line">5ã€é…ç½®é™æ€IP</span><br><span class="line">IPADDR=10.0.0.20</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=223.5.5.5</span><br><span class="line"># å®Œæ•´ç½‘å¡é…ç½® -------------------------------</span><br><span class="line">TYPE=Bridge</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=br0</span><br><span class="line"># UUID=01d75770-3b87-47e3-bbc3-bebaed2293e3</span><br><span class="line">DEVICE=br0</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=10.0.0.20</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=223.5.5.5</span><br><span class="line"># é‡å¯ç½‘å¡</span><br><span class="line">systemctl restart network.service</span><br></pre></td></tr></table></figure><h4 id="å¦‚æœé‡‡ç”¨ï¼ˆäº‘ä¸»æœºï¼‰åˆ›å»ºéœ€è¦ä¿®æ”¹ç½‘å¡ï¼ˆ-å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨äº‘ä¸»æœºå¯èƒ½ä¼šå‡ºç°å„ç§æŠ½é£ç°è±¡-ï¼‰é…ç½®-å¦‚ä¸‹é…ç½®-å¦‚ä¸‹ï¼š"><a href="#å¦‚æœé‡‡ç”¨ï¼ˆäº‘ä¸»æœºï¼‰åˆ›å»ºéœ€è¦ä¿®æ”¹ç½‘å¡ï¼ˆ-å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨äº‘ä¸»æœºå¯èƒ½ä¼šå‡ºç°å„ç§æŠ½é£ç°è±¡-ï¼‰é…ç½®-å¦‚ä¸‹é…ç½®-å¦‚ä¸‹ï¼š" class="headerlink" title="å¦‚æœé‡‡ç”¨ï¼ˆäº‘ä¸»æœºï¼‰åˆ›å»ºéœ€è¦ä¿®æ”¹ç½‘å¡ï¼ˆ å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨äº‘ä¸»æœºå¯èƒ½ä¼šå‡ºç°å„ç§æŠ½é£ç°è±¡ ï¼‰é…ç½® å¦‚ä¸‹é…ç½® å¦‚ä¸‹ï¼š"></a>å¦‚æœé‡‡ç”¨ï¼ˆäº‘ä¸»æœºï¼‰åˆ›å»ºéœ€è¦ä¿®æ”¹ç½‘å¡ï¼ˆ å¼ºçƒˆå»ºè®®ä¸è¦ä½¿ç”¨äº‘ä¸»æœºå¯èƒ½ä¼šå‡ºç°å„ç§æŠ½é£ç°è±¡ ï¼‰é…ç½® å¦‚ä¸‹é…ç½® å¦‚ä¸‹ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@images network-scripts]# cat ifcfg-br0</span><br><span class="line"># Created by cloud-init on instance boot automatically, do not edit.</span><br><span class="line">#</span><br><span class="line">BOOTPROTO=static Â  Â  Â # æ”¹</span><br><span class="line">DEVICE=br0 Â  Â  Â  Â  Â  Â # æ”¹</span><br><span class="line">HWADDR=fa:16:3e:90:a8:67</span><br><span class="line">MTU=1500</span><br><span class="line">ONBOOT=yes</span><br><span class="line">STARTMODE=auto</span><br><span class="line">TYPE=Bridge Â  Â  Â  Â  Â  # æ”¹</span><br><span class="line">USERCTL=no Â  Â  Â  Â  Â  Â </span><br><span class="line">IPADDR=10.0.0.76 Â  Â  Â # æ”¹</span><br><span class="line">PREFIX=24 Â  Â  Â  Â  Â  Â  # æ”¹</span><br><span class="line">GATEWAY=10.0.0.1 Â  Â  Â # æ”¹</span><br><span class="line">DNS1=223.5.5.5 Â  Â  Â  Â # æ”¹</span><br><span class="line">#-------------------------------------------------------------------------</span><br><span class="line">[root@images network-scripts]# cat ifcfg-eth0</span><br><span class="line"># Created by cloud-init on instance boot automatically, do not edit.</span><br><span class="line">#</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEVICE=eth0</span><br><span class="line">#HWADDR=fa:16:3e:90:a8:67 Â  Â  # æ”¹</span><br><span class="line">MTU=1500</span><br><span class="line">ONBOOT=yes</span><br><span class="line">STARTMODE=auto</span><br><span class="line">TYPE=Ethernet Â  Â  Â  Â  Â  Â  Â  Â  # æ”¹</span><br><span class="line">USERCTL=no</span><br><span class="line">BRIDGE=br0 Â  Â  Â  Â  Â  Â  Â  Â  Â  Â # æ”¹</span><br></pre></td></tr></table></figure><h4 id="3-æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ–-ï¼ˆæ”¯æŒï¼‰"><a href="#3-æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ–-ï¼ˆæ”¯æŒï¼‰" class="headerlink" title="3. æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ– ï¼ˆæ”¯æŒï¼‰"></a><code>3</code>. æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ– ï¼ˆæ”¯æŒï¼‰</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹æ˜¯å¦æ”¯æŒè™šæ‹ŸåŒ–</span><br><span class="line">grep -E &#x27;(vmx|svm)&#x27; /proc/cpuinfo</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_a37f9f1aa2fc3773a217aed3042a7fdf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_a37f9f1aa2fc3773a217aed3042a7fdf.png"></p><h3 id="4-åˆ›å»ºé•œåƒæ–‡ä»¶åŒ…"><a href="#4-åˆ›å»ºé•œåƒæ–‡ä»¶åŒ…" class="headerlink" title="4. åˆ›å»ºé•œåƒæ–‡ä»¶åŒ…"></a><code>4</code>. åˆ›å»ºé•œåƒæ–‡ä»¶åŒ…</h3><p><strong>æ–‡ä»¶å­˜æ”¾ç›®å½•å¿…é¡»ä¸ºæ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªç›®å½• åˆ‡è®°ä¸èƒ½åœ¨</strong><code>root</code>ç›®å½•å¦åˆ™ä¼šæŠ¥é”™</p><h4 id="å„ä¸ªç›®å½•å­˜æ”¾æ–‡ä»¶æ¦‚è§ˆï¼š"><a href="#å„ä¸ªç›®å½•å­˜æ”¾æ–‡ä»¶æ¦‚è§ˆï¼š" class="headerlink" title="å„ä¸ªç›®å½•å­˜æ”¾æ–‡ä»¶æ¦‚è§ˆï¼š"></a>å„ä¸ªç›®å½•å­˜æ”¾æ–‡ä»¶æ¦‚è§ˆï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># å…³äºæ–‡ä»¶å­˜æ”¾ç›®å½•å¿…é¡»ä¸ºæ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªç›®å½• æ­¤å¤„å¦‚ä¸‹ï¼š</span><br><span class="line">mkdir -p /data/windows/data</span><br><span class="line">mkdir -p /data/windows/CloudbaseInitSetup</span><br><span class="line"></span><br><span class="line"># /data/windowsç›®å½•å­˜æ”¾ï¼š</span><br><span class="line">[root@cpe-172-100-70-251 windows]# ls -lh</span><br><span class="line">æ€»ç”¨é‡ 101M</span><br><span class="line">-rw-r--r--. 1 root root 101M 3æœˆ Â 22 13:52 CloudbaseInitSetup.iso</span><br><span class="line">drwxr-xr-x. 2 root root Â 124 3æœˆ Â 22 13:49 data</span><br><span class="line">-rw-r--r--. 1 root root 193K 3æœˆ Â 22 13:51 windows_server_2016_x64.qcow2</span><br><span class="line"></span><br><span class="line">#/data/windows/data</span><br><span class="line">[root@cpe-172-100-70-251 data]# ll</span><br><span class="line">æ€»ç”¨é‡ 6801916</span><br><span class="line">-rw-r--r--. 1 qemu qemu 6302720000 3æœˆ Â 22 10:43 cn_windows_server_2016_vl_x64_dvd_11636695.iso</span><br><span class="line">-rw-r--r--. 1 qemu qemu Â 534818816 3æœˆ Â 22 09:18 virtio-win-0.1.229.iso</span><br><span class="line"></span><br><span class="line"># /data/windows/CloudbaseInitSetupç›®å½•å­˜æ”¾ </span><br><span class="line">-rw-r--r--. 1 root root 40M 3æœˆ Â 20 2017 CloudbaseInitSetup_0_9_11_x64.msi Â  ï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨ç‰ˆæœ¬ï¼‰</span><br><span class="line">-rw-r--r--. 1 qemu qemu 61M 3æœˆ Â 22 09:18 CloudbaseInitSetup_1_1_4_x64.msi Â  ï¼ˆç¨³å®šç‰ˆï¼‰</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="æ‰§è¡Œåˆ›å»ºé•œåƒæ–‡ä»¶åŒ…ï¼š"><a href="#æ‰§è¡Œåˆ›å»ºé•œåƒæ–‡ä»¶åŒ…ï¼š" class="headerlink" title="æ‰§è¡Œåˆ›å»ºé•œåƒæ–‡ä»¶åŒ…ï¼š"></a>æ‰§è¡Œåˆ›å»ºé•œåƒæ–‡ä»¶åŒ…ï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># åˆ›å»ºé•œåƒæ–‡ä»¶åŒ… ï¼š/data/windows/ ç›®å½•æ‰§è¡Œ</span><br><span class="line">qemu-img create -f qcow2 windows_server_2016_x64.qcow2 50G</span><br><span class="line"># å°†CloudbaseInitSetup_1_1_4_x64.msi é…ç½®æ”¾åœ¨CloudbaseInitSetup.isoä¸­ ï¼ˆæ‰§è¡Œç›®å½•ï¼š/data/windows/ï¼‰</span><br><span class="line">note: æ­¤æ­¥éª¤ä¸æ‰§è¡Œé€šè¿‡vncç»†åŒ–é…ç½®æ—¶å°†æ— æ³•æ‰¾åˆ°win2k16ç›®å½•ä¸‹ç½‘å¡é©±åŠ¨</span><br><span class="line"># åŸºäºç›®å½•CloudbaseInitSetupåˆ¶ä½œisoé•œåƒå‘½åä¸ºCloudbaseInitSetup.iso</span><br><span class="line">mkisofs -o CloudbaseInitSetup.iso CloudbaseInitSetup/ Â  Â  Â  </span><br><span class="line"># æŸ¥çœ‹é•œåƒæ–‡ä»¶åŒ…</span><br><span class="line">qemu-img  info  windows_server_2016_x64.qcow2</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_57235b7e44eacb3280aa8ad3117a09f1.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_57235b7e44eacb3280aa8ad3117a09f1.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6594c419f60291d68cc7c6093c655a86.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6594c419f60291d68cc7c6093c655a86.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_8dc76fd0808704d1163b1a63b168b02d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_8dc76fd0808704d1163b1a63b168b02d.png"></p><h3 id="åˆ›å»ºé•œåƒè™šæ‹Ÿæœº"><a href="#åˆ›å»ºé•œåƒè™šæ‹Ÿæœº" class="headerlink" title="åˆ›å»ºé•œåƒè™šæ‹Ÿæœº"></a>åˆ›å»ºé•œåƒè™šæ‹Ÿæœº</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"># å‚æ•°</span><br><span class="line">--name windows_server_2016_x64Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â #ç³»ç»Ÿå‘½å</span><br><span class="line">--ram 4096 \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  #å†…å­˜å¤§é»˜è®¤M</span><br><span class="line">--vcpu=4 \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â #CPUæ ¸æ•°</span><br><span class="line">--os-type=windows \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â  Â  Â Â Â  Â Â Â  Â #ç³»ç»Ÿç±»å‹</span><br><span class="line">--os-variant=win2k16 \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â #ç³»ç»Ÿç‰ˆæœ¬</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio \Â  #åˆ›å»ºç³»ç»Ÿç›˜é•œåƒÂ  Â æ ¼å¼qcow2Â  æ€»æˆ</span><br><span class="line"> # windows ISOé•œåƒè·¯å¾„ ç±»å‹ä¸ºCDROM sataç›˜</span><br><span class="line">--disk path=/data/cn_windows_server_2016_x64_dvd_9327743.iso,device=cdrom,bus=sata \Â  Â </span><br><span class="line"> # windows é©±åŠ¨ ISOé•œåƒ è·¯å¾„ ç±»å‹</span><br><span class="line">--disk path=/data/virtio-win-0.1.190.iso,device=cdrom,bus=sata \Â  Â           </span><br><span class="line">--bridge=br0,model=virtio \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â      Â  #ç½‘ç»œæ¡¥æ¥æ¨¡å¼</span><br><span class="line">--graphics vnc,listen=0.0.0.0 \Â Â  Â Â Â  Â Â Â  Â Â Â  Â Â  Â  #vncÂ </span><br><span class="line">--noautoconsole</span><br><span class="line"># äº‘ä¸»æœºåˆ›å»º</span><br><span class="line"># --(éœ€è¦è‡³å°‘60Gç©ºé—´)--------------------------------------------------------------------------------------------</span><br><span class="line"># æ‰§è¡Œåˆ›å»ºwindowsé•œåƒ (windows2016)</span><br><span class="line"># workstdtion / äº‘ä¸»æœº åˆ›å»ºæ–¹å¼å‡å¯é‡‡ç”¨ ï¼ˆæ–¹å¼1ï¼‰</span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2016_x64 --vcpus=2 --memory 1024 --os-type=windows --os-variant=win2k16 \</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2016_x64_dvd_9718765.iso,device=cdrom,size=5   \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=sata \</span><br><span class="line">--bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off</span><br><span class="line"></span><br><span class="line"># äº‘ä¸»æœº åˆ›å»ºï¼ˆå‚è€ƒï¼‰ï¼ˆæ–¹å¼2ï¼‰</span><br><span class="line">sudo virt-install --connect qemu:///system --name windows_server_2016_x64Â --vcpus=2 --memory 1024 --os-type=windows --os-variant=win2k16 \</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2016_x64_dvd_9718765.iso,device=cdrom,size=5  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=sata \</span><br><span class="line">--network network=default,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br><span class="line"># -----------------------------------------------------------------------------------------------------------</span><br><span class="line"># vsphereåˆ›å»º</span><br><span class="line"># -----------------------------------------------------------------------------------------------------------</span><br><span class="line"># windows2016æ–°å¢é©±åŠ¨ï¼ˆæœ¬æ•™ç¨‹æ‰§è¡Œå‘½ä»¤ï¼‰</span><br><span class="line">å‚æ•°ï¼šbus=stat &gt;&gt; bus=ide</span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2016_x64 --vcpus=2 --memory 2048 --os-type=windows --os-variant=win2k16 \</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2016_vl_x64_dvd_11636695.iso,device=cdrom,size=5,bus=ide  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=ide \</span><br><span class="line">--disk path=./CloudbaseInitSetup.iso,device=cdrom,bus=ide \   # æ–°å¢é©±åŠ¨</span><br><span class="line">--bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off  </span><br><span class="line"></span><br><span class="line"># windows2012r2</span><br><span class="line">qemu-img create -f qcow2 windows_server_2012r2_x64.qcow2 30G</span><br><span class="line"></span><br><span class="line">mkisofs -o CloudbaseInitSetup.iso CloudbaseInitSetup/  </span><br><span class="line"></span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2012r2_x64 --vcpus=2 --memory 4096 --os-type=windows --os-variant=win2k12r2 \</span><br><span class="line">--disk windows_server_2012r2_x64.qcow2,bus=virtio --disk size=30 \</span><br><span class="line">--disk path=./data/cn_windows_server_2012_r2_vl_x64_dvd_2979220.iso,device=cdrom,size=5,bus=ide  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=ide \</span><br><span class="line">--disk path=./CloudbaseInitSetup.iso,device=cdrom,bus=ide --bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off  </span><br><span class="line"></span><br><span class="line"># windows2019</span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2019_x64 --vcpus=2 --memory 2048 --os-type=windows --os-variant=win2k19 \</span><br><span class="line">--disk windows_server_2019_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2019_x64_dvd_4de40f33.iso,device=cdrom,size=5,bus=ide  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=ide \</span><br><span class="line">--disk path=./CloudbaseInitSetup.iso,device=cdrom,bus=ide \</span><br><span class="line">--bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off </span><br><span class="line"></span><br><span class="line"># -----------------------------------------------------------------------------------------------------------</span><br><span class="line"># æŸ¥çœ‹åˆšé€šè¿‡é•œåƒå¯åŠ¨çš„è™šæ‹Ÿæœºè™šæ‹Ÿæœº / æŸ¥çœ‹--os-variantæ”¯æŒçš„ç±»å‹</span><br><span class="line">virsh list --all       # åˆ—å‡ºæ‰€æœ‰è™šæœº</span><br><span class="line">osinfo-query os        # æŸ¥çœ‹æ”¯æŒçš„ç±»å‹</span><br><span class="line">virsh shutdown ubuntu  # æ­£å¸¸å…³é—­è™šæ‹Ÿæœº</span><br><span class="line">virsh undefine name    # åˆ é™¤è™šæœº</span><br><span class="line">virsh start name       # å¯åŠ¨æŒ‡å®šè™šæœº</span><br><span class="line">virsh reboot name      # é‡å¯æŒ‡å®šè™šæœº</span><br><span class="line"></span><br><span class="line">[root@localhost windows]# osinfo-query os</span><br><span class="line"> Short ID             | Name                                               | Version  | ID                            </span><br><span class="line">----------------------+----------------------------------------------------+----------+---</span><br><span class="line"> alpinelinux3.5       | Alpine Linux 3.5                                   | 3.5      |  </span><br><span class="line"> alpinelinux3.6       | Alpine Linux 3.6                                   | 3.6      | </span><br><span class="line"> alpinelinux3.7       | Alpine Linux 3.7                                   | 3.7      | </span><br><span class="line"> alpinelinux3.8       | Alpine Linux 3.8                                   | 3.8      | </span><br><span class="line"> alt.p8               | ALT p8 StarterKits                                 | p8       | </span><br><span class="line"> alt.p9               | ALT p9 StarterKits                                 | p9       |</span><br></pre></td></tr></table></figure><h5 id="å‚è€ƒï¼š-1"><a href="#å‚è€ƒï¼š-1" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h5><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_66220ca6a8e52c12bfe4526cba82dbb3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_66220ca6a8e52c12bfe4526cba82dbb3.png"></p><h4 id="å‡ºç°ä¸‹æ–¹å›æ˜¾åˆ™è¯´æ˜windowsé•œåƒåˆ›å»ºæˆåŠŸï¼š"><a href="#å‡ºç°ä¸‹æ–¹å›æ˜¾åˆ™è¯´æ˜windowsé•œåƒåˆ›å»ºæˆåŠŸï¼š" class="headerlink" title="å‡ºç°ä¸‹æ–¹å›æ˜¾åˆ™è¯´æ˜windowsé•œåƒåˆ›å»ºæˆåŠŸï¼š"></a>å‡ºç°ä¸‹æ–¹å›æ˜¾åˆ™è¯´æ˜windowsé•œåƒåˆ›å»ºæˆåŠŸï¼š</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d46cb89118adb196c752bfeefb854b09.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d46cb89118adb196c752bfeefb854b09.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_49e8c464d4892bd3ca53f4cc2a3e94d9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_49e8c464d4892bd3ca53f4cc2a3e94d9.png"></p><h3 id="5-virt-installå¸¸ç”¨å‘½ä»¤ï¼š"><a href="#5-virt-installå¸¸ç”¨å‘½ä»¤ï¼š" class="headerlink" title="5. virt-installå¸¸ç”¨å‘½ä»¤ï¼š"></a><code>5. virt-install</code>å¸¸ç”¨å‘½ä»¤ï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"># æŸ¥çœ‹åˆšé€šè¿‡é•œåƒå¯åŠ¨çš„è™šæ‹Ÿæœºè™šæ‹Ÿæœº / æŸ¥çœ‹--os-variantæ”¯æŒçš„ç±»å‹</span><br><span class="line">virsh list             # åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœº</span><br><span class="line">osinfo-query os        # æŸ¥çœ‹æ”¯æŒçš„ç±»å‹</span><br><span class="line"># virt-installå¸¸ç”¨å‘½ä»¤</span><br><span class="line">virsh list --all       # åˆ—å‡ºæ‰€æœ‰è™šæœº</span><br><span class="line">virsh start  web01     # å¯åŠ¨æŒ‡å®šè™šæœº</span><br><span class="line">virsh reboot web01     # é‡å¯æŒ‡å®šè™šæœºï¼ˆå…³é—­çŠ¶æ€æ— æ³•é‡å¯ï¼‰</span><br><span class="line">virsh console name     # è¿æ¥è™šæ‹Ÿæœº</span><br><span class="line">virsh destroy name     # æ‹”æ‰ç”µæºï¼ˆå¾ˆå°‘ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">virsh undefine web01   # åˆ é™¤è™šæœºæ–‡ä»¶å³åˆ é™¤è™šæ‹Ÿæœºï¼ˆä¸ä¼šåˆ é™¤ç£ç›˜æ–‡ä»¶ï¼‰</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">virsh domblklist web01             # æŸ¥çœ‹è™šæ‹Ÿæœºç£ç›˜ä¿¡æ¯</span><br><span class="line">virsh dominfo    web01             # æŸ¥çœ‹è™šæ‹Ÿæœºé…ç½®ä¿¡æ¯</span><br><span class="line">virsh domiflist  web01             # æŸ¥çœ‹è™šæ‹Ÿç½‘å¡ä¿¡æ¯</span><br><span class="line">virsh dumpxml    web01             # ä»¥ xmlæ ¼å¼æŸ¥çœ‹è™šæ‹Ÿæœº</span><br><span class="line">virsh define     file-name         # å¯¼å…¥è™šæ‹Ÿæœº</span><br><span class="line">virsh edit       name              # ç¼–è¾‘è™šæ‹Ÿæœºé…ç½®ï¼ˆä¸€èˆ¬æ˜¯åœ¨åˆšå®šä¹‰å®Œè™šæ‹Ÿæœºä¹‹åï¼‰è‡ªå¸¦è¯­æ³•æ£€æµ‹</span><br><span class="line">virsh domrename  old-name  new-name   # è™šæ‹Ÿæœºé‡å‘½å</span><br><span class="line">virsh vncdisplay web01                # æŸ¥çœ‹vncç«¯å£</span><br><span class="line">virsh autostart  name                 # è™šæ‹Ÿæœºéšæœºé‡å¯</span><br><span class="line">virsh autostart --disable name        # å–æ¶ˆè™šæ‹Ÿæœºéšæœºé‡å¯</span><br><span class="line"></span><br><span class="line"># å›¾å½¢ç•Œé¢ï¼š</span><br><span class="line">é€šè¿‡æ‰§è¡Œåvirt-managerï¼Œå¯åŠ¨libvirtçš„å›¾å½¢ç•Œé¢ï¼Œåœ¨å›¾å½¢ç•Œé¢ä¸‹å¯ä»¥ä¸€æ­¥ä¸€æ­¥çš„åˆ›å»ºè™šæ‹Ÿæœºï¼Œç®¡ç†è™šæ‹Ÿæœºï¼Œè¿˜å¯ä»¥ç›´æ¥æ§åˆ¶è™šæ‹Ÿæœºçš„æ¡Œé¢ã€‚</span><br><span class="line"># å‘½ä»¤è¡Œï¼š</span><br><span class="line">virsh list                              # æ˜¾ç¤ºæœ¬åœ°æ´»åŠ¨è™šæ‹Ÿæœº</span><br><span class="line">virsh list â€“all                         # æ˜¾ç¤ºæœ¬åœ°æ‰€æœ‰çš„è™šæ‹Ÿæœºï¼ˆæ´»åŠ¨çš„+ä¸æ´»åŠ¨çš„ï¼‰</span><br><span class="line">virsh define ubuntu.xml                 # é€šè¿‡é…ç½®æ–‡ä»¶å®šä¹‰ä¸€ä¸ªè™šæ‹Ÿæœºï¼ˆè¿™ä¸ªè™šæ‹Ÿæœºè¿˜ä¸æ˜¯æ´»åŠ¨çš„ï¼‰</span><br><span class="line">virsh start ubuntu                      # å¯åŠ¨åå­—ä¸ºubuntuçš„éæ´»åŠ¨è™šæ‹Ÿæœº</span><br><span class="line">virsh create ubuntu.xml                 # åˆ›å»ºè™šæ‹Ÿæœºï¼ˆåˆ›å»ºåï¼Œè™šæ‹Ÿæœºç«‹å³æ‰§è¡Œï¼Œæˆä¸ºæ´»åŠ¨ä¸»æœºï¼‰</span><br><span class="line">virsh suspend ubuntu                    # æš‚åœè™šæ‹Ÿæœº</span><br><span class="line">virsh resume ubuntu                     # å¯åŠ¨æš‚åœçš„è™šæ‹Ÿæœº</span><br><span class="line">virsh shutdown web01          # æ­£å¸¸å…³é—­è™šæ‹Ÿæœº</span><br><span class="line">virsh destroy ubuntu          # å¼ºåˆ¶æ‹”æ‰ç”µæºå…³é—­è™šæ‹Ÿæœºï¼ˆå¾ˆå°‘ä½¿ç”¨ï¼‰</span><br><span class="line"></span><br><span class="line">virsh domname 2                         # æ˜¾ç¤ºidå·ä¸º2çš„è™šæ‹Ÿæœºå                      </span><br><span class="line">virsh domid ubuntu                      # æ˜¾ç¤ºè™šæ‹Ÿæœºidå·                     </span><br><span class="line">virsh domuuid ubuntu                    # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„uuid   </span><br><span class="line">virsh domstate ubuntu                   # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰çŠ¶æ€  </span><br><span class="line">virsh dumpxml ubuntu                    # æ˜¾ç¤ºè™šæ‹Ÿæœºçš„å½“å‰é…ç½®æ–‡ä»¶ï¼ˆå¯èƒ½å’Œå®šä¹‰è™šæ‹Ÿæœºæ—¶çš„é…ç½®ä¸åŒï¼Œå› ä¸ºå½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶ï¼Œéœ€è¦ç»™# è™šæ‹Ÿæœºåˆ†é…idå·ã€uuidã€vncç«¯å£å·ç­‰ç­‰ï¼‰  </span><br><span class="line">virsh setmem ubuntu 512000              # ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®å†…å­˜å¤§å°  </span><br><span class="line">virsh setvcpus ubuntu 4                 # ç»™ä¸æ´»åŠ¨è™šæ‹Ÿæœºè®¾ç½®cpuä¸ªæ•°  </span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="é…ç½®snatä½¿é•œåƒå¯ä»¥è®¿é—®internet-åœ¨å®¿ä¸»æœºæ‰§è¡Œ"><a href="#é…ç½®snatä½¿é•œåƒå¯ä»¥è®¿é—®internet-åœ¨å®¿ä¸»æœºæ‰§è¡Œ" class="headerlink" title="é…ç½®snatä½¿é•œåƒå¯ä»¥è®¿é—®internet( åœ¨å®¿ä¸»æœºæ‰§è¡Œ )"></a>é…ç½®<code>snat</code>ä½¿é•œåƒå¯ä»¥è®¿é—®<code>internet</code>( åœ¨å®¿ä¸»æœºæ‰§è¡Œ )</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># å¼€å¯</span><br><span class="line">--å‚æ•°ï¼š</span><br><span class="line">-s 172.100.70.241           # é•œåƒip  ï¼ˆæˆ– å…¶ä»–è™šæ‹Ÿæœºï¼‰</span><br><span class="line">--to-source 172.100.70.251  # å®¿ä¸»æœºipï¼ˆæˆ– æœ¬è™šæ‹Ÿæœºï¼‰</span><br><span class="line">sysctl net.ipv4.ip_forward=1</span><br><span class="line">sysctl -p</span><br><span class="line">iptables -t nat -A POSTROUTING -s 172.100.70.241  -j SNAT --to-source 172.100.70.251</span><br></pre></td></tr></table></figure><h2 id="äºŒ-vncç»†åŒ–é…ç½®-qemu-img-è§ä¸‹ç« "><a href="#äºŒ-vncç»†åŒ–é…ç½®-qemu-img-è§ä¸‹ç« " class="headerlink" title="äºŒ. vncç»†åŒ–é…ç½® qemu-img ( è§ä¸‹ç«  )"></a>äºŒ. <code>vnc</code>ç»†åŒ–é…ç½® <code>qemu-img</code> ( è§ä¸‹ç«  )</h2><h4 id="qemu-imgå‘½ä»¤å‚è€ƒï¼š"><a href="#qemu-imgå‘½ä»¤å‚è€ƒï¼š" class="headerlink" title="qemu-imgå‘½ä»¤å‚è€ƒï¼š"></a><code>qemu-img</code>å‘½ä»¤å‚è€ƒï¼š</h4><p><a href="https://zhuanlan.zhihu.com/p/623104229">https://zhuanlan.zhihu.com/p/623104229</a></p><p><a href="https://support.huaweicloud.com/bestpractice-ims/ims_bp_0030.html">https://support.huaweicloud.com/bestpractice-ims/ims_bp_0030.html</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_e552b52db5a6700f7e86be4d1ee01215.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_e552b52db5a6700f7e86be4d1ee01215.png"></p><h4 id="11-é…ç½®å®Œæˆåå¤„ç†é•œåƒï¼ˆå‹ç¼©é•œåƒï¼‰"><a href="#11-é…ç½®å®Œæˆåå¤„ç†é•œåƒï¼ˆå‹ç¼©é•œåƒï¼‰" class="headerlink" title="11.é…ç½®å®Œæˆåå¤„ç†é•œåƒï¼ˆå‹ç¼©é•œåƒï¼‰"></a><code>11</code>.é…ç½®å®Œæˆåå¤„ç†é•œåƒï¼ˆå‹ç¼©é•œåƒï¼‰</h4><h3 id="å‚è€ƒï¼š-2"><a href="#å‚è€ƒï¼š-2" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># å‚æ•°</span><br><span class="line">-cï¼Œè¡¨ç¤ºå¿…é¡»å‹ç¼©ç›®æ ‡é•œåƒï¼ˆä»…é™qcowæ ¼å¼ï¼‰ã€‚</span><br><span class="line">-fï¼Œç¬¬ä¸€ç§é•œåƒæ ¼å¼ã€‚</span><br><span class="line">-o, optionsï¼šé€‰é¡¹ï¼Œæ˜¯ä»¥é€—å·åˆ†éš”çš„æ ¼å¼ç‰¹å®šé€‰é¡¹åˆ—è¡¨ï¼Œæ ¼å¼ä¸ºname=valueæ ¼å¼ã€‚ä½¿ç”¨â€œ-oï¼Ÿâ€æœ‰å…³ä½¿ç”¨çš„æ ¼å¼æ”¯æŒçš„é€‰é¡¹çš„æ¦‚è¿°ï¼Œæˆ–å‚é˜…ä¸‹é¢çš„æ ¼å¼è¯´æ˜äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚</span><br><span class="line">++++++++++++++++++++++++++++++++++</span><br><span class="line">#--sparse=alwaysç¨€ç–æ‹·è´ï¼Œå¿½ç•¥å…¨0æ•°æ®</span><br><span class="line">cp --sparse=always ws2012r2.qcow2 ws2012r2-new.qcow2 #--sparse=alwaysç¨€ç–æ‹·è´ï¼Œå¿½ç•¥å…¨0æ•°æ®</span><br><span class="line"># rawå’Œqcow2éœ€è¦è½¬æ¢ï¼Œè¿™é‡ŒåŸæœ¬ç”¨çš„qcow2ï¼Œæ‰€ä»¥æœªè½¬æ¢ã€‚</span><br><span class="line"># æ¡ˆä¾‹ï¼š</span><br><span class="line">qemu-img convert -c -f raw -O qcow2 centos7-new.raw centos7-new.qcow2</span><br><span class="line">qemu-img convert -c -O qcow2 centos7-new.qcow2 centos7-mini.qcow2</span><br><span class="line"># å®é™…æ“ä½œ</span><br><span class="line">qemu-img convert -c -O qcow2 windows_server_2016_x64_new.qcow2 windows_server_2016_x64_min.qcow2</span><br><span class="line">++++++++++++++++++++++++++++++++++</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_ea53daa63d24ff564cde1f936d3d4e0f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_ea53daa63d24ff564cde1f936d3d4e0f.png"></p><h4 id="å®é™…æ“ä½œ"><a href="#å®é™…æ“ä½œ" class="headerlink" title="å®é™…æ“ä½œ:"></a>å®é™…æ“ä½œ:</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># rawå’Œqcow2éœ€è¦è½¬æ¢ï¼Œè¿™é‡ŒåŸæœ¬ç”¨çš„qcow2ï¼Œæ‰€ä»¥æœªè½¬æ¢ã€‚</span><br><span class="line"># æ¡ˆä¾‹ï¼š</span><br><span class="line">qemu-img convert -c -f raw -O qcow2 centos7-new.raw centos7-new.qcow2</span><br><span class="line">qemu-img convert -c -f qcow2 -o  raw centos7-new.qcow2 centos7-mini.raw</span><br><span class="line"># å®é™…æ“ä½œ</span><br><span class="line">qemu-img convert -c -f raw -O qcow2 windows_server_2016_x64_new.raw windows_server_2016_x64_min.qcow2</span><br></pre></td></tr></table></figure><h4 id="ä¸Šä¼ åˆ°openstackâ€”skyline"><a href="#ä¸Šä¼ åˆ°openstackâ€”skyline" class="headerlink" title="ä¸Šä¼ åˆ°openstackâ€”skyline:"></a>ä¸Šä¼ åˆ°<code>openstackâ€”skyline</code>:</h4><p><strong>å‚æ•°ï¼š</strong><code>--property os_distro=windows --property os_version=2012 --property os_admin_user=Administrator</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># qcm2æ ¼å¼</span><br><span class="line">openstack image create --disk-format qcow2 --public --property hw_qemu_guest_agent=yes --property os_distro=windows --property os_version=2012 --property os_admin_user=Administrator --file  windows_server_2016_x64.qcow2 windows_server_2016_x64.qcow2</span><br><span class="line"># rawæ ¼å¼</span><br><span class="line">openstack image create --disk-format raw --public --property hw_qemu_guest_agent=yes --property os_distro=windows --property os_version=2012 --property os_admin_user=Administrator --file windows_server_2019_x64.raw windows_server_2019_x64.raw </span><br></pre></td></tr></table></figure><h4 id="ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºäº‘ä¸»æœºï¼š"><a href="#ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºäº‘ä¸»æœºï¼š" class="headerlink" title="ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºäº‘ä¸»æœºï¼š"></a>ä½¿ç”¨å‘½ä»¤è¡Œåˆ›å»ºäº‘ä¸»æœºï¼š</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># æ­¤å‘½ä»¤å¿…é¡»è¦å…ˆå°†é•œåƒä¸Šä¼ åˆ°openstack</span><br><span class="line">openstack server create --config-drive true --image windows2016min.qcow2 --flavor 9 --password ******20! --network demo-net windows2016_test</span><br></pre></td></tr></table></figure><h4 id="æ³¨ï¼š-æ­¤æ—¶é…ç½®å®Œæˆ-é›†æˆå¯ä¿®æ”¹å¯†ç "><a href="#æ³¨ï¼š-æ­¤æ—¶é…ç½®å®Œæˆ-é›†æˆå¯ä¿®æ”¹å¯†ç " class="headerlink" title="æ³¨ï¼š æ­¤æ—¶é…ç½®å®Œæˆ  é›†æˆå¯ä¿®æ”¹å¯†ç "></a>æ³¨ï¼š æ­¤æ—¶é…ç½®å®Œæˆ  é›†æˆå¯ä¿®æ”¹å¯†ç </h4><h4 id="æ•ˆæœï¼š"><a href="#æ•ˆæœï¼š" class="headerlink" title="æ•ˆæœï¼š"></a>æ•ˆæœï¼š</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d0e78dd049d08305a4192234429c341d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d0e78dd049d08305a4192234429c341d.png"></p><h4 id="æ‰©å±•ï¼š-æ—§é¢æ¿-windows-é‡ç½®å¯†ç "><a href="#æ‰©å±•ï¼š-æ—§é¢æ¿-windows-é‡ç½®å¯†ç " class="headerlink" title="æ‰©å±•ï¼š æ—§é¢æ¿ windows é‡ç½®å¯†ç :"></a>æ‰©å±•ï¼š æ—§é¢æ¿ windows é‡ç½®å¯†ç :</h4><p>æ›´æ–°äº‘ä¸»æœºå…ƒæ•°æ®ï¼Œæ·»åŠ <code>change_passwd=True</code>, è½¯é‡å¯äº‘ä¸»æœºã€‚é‡å¯å®Œä¹‹åï¼Œè™šæœºå¯†ç ä¸º <code>admin_pass</code> æŒ‡å®šçš„å¯†ç ã€‚å¯†ç é‡ç½®åå†å°†å…ƒæ•°æ® <code>change_passwd</code> åˆ æ‰ï¼Œæˆ–è€…æ”¹ä¸ºå…¶ä»–å€¼</p><p><strong>æ·»åŠ å &gt;&gt; è½¯é‡å¯   ||  è½¯é‡å¯ä¹‹å &gt;&gt; åˆ é™¤change_passwd=True    æ­¤æ—¶å¯†ç å˜ä¸ºåˆ›å»ºäº‘ä¸»æœºæ—¶è®¾ç½®çš„å¯†ç å³</strong><code>****023!</code>ã€‚</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_65022b246096b0295461a22397c72313.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_65022b246096b0295461a22397c72313.png"></p><p><strong>æ•™ç¨‹ç»“æŸã€‚</strong></p>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èµåŠ©å¢™</title>
      <link href="/2024/02/01/%E8%B5%9E%E5%8A%A9%E5%A2%99/"/>
      <url>/2024/02/01/%E8%B5%9E%E5%8A%A9%E5%A2%99/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>ç½‘ç«™å»ºè®¾ä¸ç»´æŠ¤å®å±ä¸æ˜“ï¼Œå¦‚æœæˆ‘çš„æ–‡ç« å¸®åŠ©åˆ°äº†æ‚¨ï¼Œæˆ–è€…æ‚¨æƒ³æ”¯æŒæˆ‘çš„ç½‘ç«™ï¼Œå¯ä»¥æ‰«æä¸‹æ–¹äºŒç»´ç è¿›è¡ŒèµåŠ©ï¼ˆèµåŠ©æ—¶è¯·å¤‡æ³¨è‡ªå·±çš„ åŒ–å/æ˜µç§° ï¼Œæ‰“èµåå°†åœ¨æ­¤é¡µé¢å±•ç¤ºï¼‰ï¼Œéå¸¸æ„Ÿè°¢æ‚¨çš„æ”¯æŒ~ ğŸŒ¹</p></blockquote><h2 id="èµåŠ©å¢™ğŸŒ¹"><a href="#èµåŠ©å¢™ğŸŒ¹" class="headerlink" title="èµåŠ©å¢™ğŸŒ¹"></a>èµåŠ©å¢™ğŸŒ¹</h2><p>æ‰“èµæ–¹å¼  å¾®ä¿¡  æ”¯ä»˜å®ğŸŒ™ </p><div class="gallery">    <div class="fj-gallery  data" data-rowheight="220" data-limit="10">    <span class="gallery-data">[{"url":"https://wn-apple-teawine.fun/img/wechatpayqr.webp","alt":"å¾®ä¿¡"},{"url":"https://wn-apple-teawine.fun/img/alipayqr.webp","alt":"æ”¯ä»˜å®"}]</span>    </div>    <button class="gallery-load-more"><span>Load More</span><i class="fa-solid fa-arrow-down"></i></button>    </div><table><thead><tr><th>ZzNnWn.</th><th>æ™’åœ¨æ·±æµ·é‡Œ.</th><th>ç²˜äººçš„é¸­å˜´å…½</th></tr></thead><tbody><tr><td>ï¿¥100</td><td>ï¿¥50</td><td>ï¿¥1000</td></tr><tr><td></td><td></td><td></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç®€å†</title>
      <link href="/2024/02/01/%E7%AE%80%E5%8E%86/"/>
      <url>/2024/02/01/%E7%AE%80%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ç®€å†"><a href="#ç®€å†" class="headerlink" title="ç®€å†"></a>ç®€å†</h2><h4 id="åŸºæœ¬ä¿¡æ¯-æ•™è‚²èƒŒæ™¯-æ±‚èŒæ„å‘"><a href="#åŸºæœ¬ä¿¡æ¯-æ•™è‚²èƒŒæ™¯-æ±‚èŒæ„å‘" class="headerlink" title="åŸºæœ¬ä¿¡æ¯ æ•™è‚²èƒŒæ™¯ æ±‚èŒæ„å‘"></a><strong>åŸºæœ¬ä¿¡æ¯</strong> <strong>æ•™è‚²èƒŒæ™¯</strong> <strong>æ±‚èŒæ„å‘</strong></h4><p>å§“åï¼š<br>é‚®ç®±ï¼š<a href="mailto:&#x38;&#x37;&#x38;&#x38;&#x39;&#49;&#x36;&#49;&#x31;&#64;&#x71;&#x71;&#x2e;&#x63;&#111;&#x6d;">&#x38;&#x37;&#x38;&#x38;&#x39;&#49;&#x36;&#49;&#x31;&#64;&#x71;&#x71;&#x2e;&#x63;&#111;&#x6d;</a><br>è¯ä¹¦ï¼šé˜¿é‡Œäº‘ACP<br>æœŸæœ›è–ªèµ„ï¼š15k<br>å²—ä½ï¼šäº‘è®¡ç®—å·¥ç¨‹å¸ˆ</p><h4 id="ä¸“ä¸šæŠ€èƒ½æ¦‚è§ˆ"><a href="#ä¸“ä¸šæŠ€èƒ½æ¦‚è§ˆ" class="headerlink" title="ä¸“ä¸šæŠ€èƒ½æ¦‚è§ˆ"></a><strong>ä¸“ä¸šæŠ€èƒ½æ¦‚è§ˆ</strong></h4><p>Â· ç²¾é€šå„ç±»<strong>linux</strong>ç³»ç»Ÿå„é¡¹é…ç½®æ€§èƒ½è°ƒä¼˜å®‰å…¨ä¼˜åŒ–<strong>shell</strong>è„šæœ¬æ“ä½œç³»ç»ŸåŒ…æ‹¬ä½†ä¸é™äº<strong>ï¼ˆubuntu centos debain åä¸ºæ¬§æ‹‰ é˜¿é‡Œé¾™èœ¥</strong>ç­‰ï¼‰<br>Â· ç²¾é€šäº‘è®¡ç®—<strong>iaas paas</strong>å±‚<br>Â· ç²¾é€šcephåˆ†å¸ƒå¼å­˜å‚¨,<br>Â· ç²¾é€šopenstacké›†ç¾¤ nova cinder neutoen glanceçš„è¿ç»´<br>Â· ç²¾é€šgrafanaå¼€æºæ—¥å¿—ç›‘æ§<strong>loki</strong><br>Â· ç²¾é€šäº‘è¿ç§»æŠ€æœ¯<strong>DTS SMC OSSè¿ç§»ï¼ˆé˜¿é‡Œäº‘ï¼‰</strong><br>Â· ç²¾é€šå†·è¿ç§»æŠ€æœ¯<strong>V2V Qemu-img dd  disk2vhd</strong>ç­‰ ï¼ˆä½¿ç”¨äºä»»ä½•é€‚é…çš„å¹³å°ï¼‰<br>Â· ç²¾é€š<strong>ansible</strong>è‡ªåŠ¨åŒ–è¿ç»´å·¥å…·<br>Â· ç²¾é€š<strong>docker docker-compose Dockerfileã€‚</strong><br>Â· ç²¾é€šå„ç§å¼€æºæ—¶åºæ•°æ®åº“<strong>influxdb promethus-tsdb</strong>ç­‰<br>Â· ç²¾é€šå„ç§ç›‘æ§ç³»ç»Ÿ<strong>prometheus zabbix telegraf nightingale cacti smartping uptime-Kuma</strong>ç­‰<br>Â· ç²¾é€šå„ç§å…³ç³»æ•°æ®åº“<strong>mysql postgreSQL mariadb</strong>æŒæ¡<strong>Mysql</strong>ä»¥åŠ<strong>mariadb</strong>æ•°æ®åº“å®‰å…¨ç­–ç•¥å¦‚ï¼ˆå¯†ç å®‰å…¨ ç™»å½•å®‰å…¨ å®¡è®¡ç­‰ï¼‰<br>Â· ç²¾é€š<strong>keepalived+nginx</strong>é«˜å¯ç”¨.æŒæ¡<strong>mysql</strong>ä¸»ä»å¤åˆ¶ <strong>redis</strong>é›†ç¾¤ã€‚<br>Â· ç²¾é€šéƒ¨ç½²<strong>openstack</strong>äº‘å¹³å° <strong>ç®¡ç†OpenStackäº‘å¹³å°ï¼ŒåŒ…æ‹¬è™šæ‹Ÿæœºå®ä¾‹ã€ç½‘ç»œå’Œå­˜å‚¨èµ„æºçš„é…ç½®ã€‚</strong><br>Â· ç²¾é€š<strong>Cephåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œè´Ÿè´£Cephé›†ç¾¤çš„éƒ¨ç½²ã€ç›‘æ§å’Œæ€§èƒ½è°ƒä¼˜ã€‚</strong><br>Â· ç²¾é€š<strong>tcp udp http https snmp ftp vrrp</strong>ç­‰å„ç§åè®®<br>Â· ç²¾é€š<strong>nginx</strong> è´Ÿè½½å‡è¡¡ï¼ŒåŠ¨é™åˆ†ç¦»ï¼Œåå‘ä»£ç† ç†Ÿç»ƒæŒæ¡å¼€æº<strong>openvpn l2tp frp</strong>æŠ€æœ¯<br>Â· ç²¾é€š<strong>nas</strong>å­˜å‚¨å¤šå‰¯æœ¬<strong>cephfs</strong>ï¼ˆå•å‰¯æœ¬<strong>NFS iscsi</strong>ï¼‰ å¯¹è±¡å­˜å‚¨ è´Ÿè½½å‡è¡¡ <strong>nat</strong>ç½‘å…³** rds** ç­‰<br>Â· ç²¾é€šä½¿ç”¨<strong>kubeadm</strong>éƒ¨ç½²<strong>k8s</strong>ä»¥åŠå®ç°ä¸<strong>ceph</strong>é›†æˆï¼ˆStorageClassï¼‰<br>Â· ç†Ÿç»ƒæŒæ¡<strong>python</strong>è„šæœ¬ï¼ˆç½‘ç»œçˆ¬è™«æ–¹å‘ï¼‰ã€‚</p><h4 id="å·¥ä½œç»éªŒ1"><a href="#å·¥ä½œç»éªŒ1" class="headerlink" title="å·¥ä½œç»éªŒ1"></a><strong>å·¥ä½œç»éªŒ1</strong></h4><p>å…¬å¸ç»è¥èŒƒå›´ï¼šä¸»è¦ç»è¥ç‰©è”ç½‘äº§å“ è½¯ä»¶å¼€å‘ç­‰</p><h4 id="é¡¹ç›®ç»éªŒï¼š"><a href="#é¡¹ç›®ç»éªŒï¼š" class="headerlink" title="é¡¹ç›®ç»éªŒï¼š"></a><strong>é¡¹ç›®ç»éªŒï¼š</strong></h4><p>2020.11â€”â€”2021.04<br>Â· ç»´æŠ¤è®¾è®¡åŠéƒ¨ç½²è‹å·å¸‚å›½å®¶ç”µç½‘å„å¥—ç³»ç»Ÿå¦‚éš§é“å­ç³»ç»Ÿ ç²¾ç›ŠåŒ–ç®¡æ§å¹³å°ç­‰ã€‚<br>2021.04â€”â€”2021.05<br>Â· éƒ¨ç½²ç»´æŠ¤ä¼˜åŒ–å…¬å¸è¾¹ç¼˜è®¡ç®—ç®±äº§å“ï¼Œç¼–å†™<strong>dockerfile</strong>åˆ¶ä½œä¸€é”®å¯åŠ¨ç§æœ‰åŒ–é•œåƒ å¹¶å®åœ°æµ‹è¯•å…¶åŠŸèƒ½ã€‚<br>2021.05â€”â€”2021.07<br>Â· è®¾è®¡éƒ¨ç½²å…¬å¸<strong>vmware vcenter esxi</strong> ç§æœ‰äº‘å¹³å°<br>Â· æ­å»º<strong>openvpn</strong>å®ç°ä¼ä¸šå‘˜å·¥åœ¨å®¶è®¿é—®å…¬å¸å†…ç½‘<br>Â· å¯¹éœ€è¦æš´éœ²å¤–ç½‘æ²¡æœ‰<strong>å¤–ç½‘IP</strong>çš„<strong>web</strong>æœåŠ¡åšå†…ç½‘ç©¿é€ã€‚<br>Â· å¯¹<strong>vcenter</strong>å…¶ä¸­ä¸€å°è™šæ‹Ÿæœºé…ç½®å¤–ç½‘IPå¯¹å¤–æœåŠ¡<br>2021.07â€”â€”2022.02<br>Â· æ—¥å¸¸ç»´æŠ¤<strong>mysql</strong>æ•°æ®åº“ å…¬å¸å„å¥—ç³»ç»Ÿå¦‚ç¦…é“ ç²¾ç›ŠåŒ–ç®¡æ§å¹³å° <strong>nacos</strong>  è™šæ‹ŸåŒ–å¹³å°<strong>vcenter</strong>ç­‰<br>Â· æ£€æŸ¥ç³»ç»Ÿè¿è¡Œæƒ…å†µæ’é”™ç­‰<br>Â· ç¼–å†™è¿ç»´æŠ€æœ¯æ–‡æ¡£<br>Â· åˆ©ç”¨<strong>ansible</strong>ç»™å¤šå°æœåŠ¡å™¨é…ç½®ç¯å¢ƒï¼Œç¼–å†™å‰§æœ¬éƒ¨ç½²ç¨‹åºç¯å¢ƒç­‰ã€‚</p><h4 id="å·¥ä½œç»éªŒ2"><a href="#å·¥ä½œç»éªŒ2" class="headerlink" title="å·¥ä½œç»éªŒ2"></a><strong>å·¥ä½œç»éªŒ2</strong></h4><p><strong>å…¬å¸ä»‹ç»ï¼š</strong></p><p>åä¸­åœ°åŒºæœ€å¤§çš„åˆ†å¸ƒå¼äº‘æœåŠ¡å•† é˜¿é‡Œäº‘åä¸­åœ°åŒºæœ€å¤§ä»£ç†å•† å…¬å¸æœ‰è‡ªå·±çš„äº‘è®¡ç®—å¹³å°MSC-Stackå¯¹å¤–å¸®åŠ©ä¸Šåƒå®¶å®¢æˆ·ä¸Šäº‘ å¯¹ä¸Šåƒå®¶ä¼ä¸šæä¾›æœåŠ¡ å®¢æˆ·åŒ…æ‹¬å°ç±³ åä¸º è‹±ä¼Ÿè¾¾ æ–—é±¼ å­—èŠ‚è·³åŠ¨ç­‰<br><strong>ä¸»è¦äº§å“ï¼š</strong></p><p><strong>MSC-Stackï¼š</strong>åŸºäºopenstackä¸cephåˆ†å¸ƒå¼å­˜å‚¨å¼€å‘çš„ä¸€å¥—äº‘è®¡ç®—å¹³å°ã€‚<br>K8s å ¡å’æœº ä¸»æœºå…¥ä¾µ äº‘ä¸»æœºè´Ÿè½½å‡è¡¡å™¨ natç½‘å…³ç­‰åŠŸèƒ½ ç›®å‰æ‹¥æœ‰æ­¦æ±‰ ç¦å· åŒ—äº¬ æˆéƒ½ å››èŠ‚ç‚¹ã€‚<br>åŸç”ŸOpenStackéƒ¨åˆ†ï¼šä¸€å¥—openstack nç‰ˆå¤–ç½‘ç¯å¢ƒ ä¸€å¥—openstack zedç‰ˆå†…ç½‘ç¯å¢ƒã€‚</p><h4 id="é¡¹ç›®ç»éªŒ"><a href="#é¡¹ç›®ç»éªŒ" class="headerlink" title="é¡¹ç›®ç»éªŒ"></a><strong>é¡¹ç›®ç»éªŒ</strong></h4><p><strong>åŸç”ŸOpenStackï¼ŒMCS-Stackä¸cephäº‘è®¡ç®—éƒ¨åˆ†</strong><br>2022.05â€”â€”2022.06<br>Â· éƒ¨ç½²å…¬å¸<strong>openstac-zed</strong>ç‰ˆæœ¬ç³»ç»Ÿ åç«¯å­˜å‚¨é‡‡ç”¨<strong>ceph</strong>åˆ†å¸ƒå¼å­˜å‚¨ ç¼–å†™<strong>shell</strong>è„šæœ¬éƒ¨ç½²ä¹å·äº‘å¼€æºå‰ç«¯skylineï¼ˆopenstack-uiï¼‰<strong>é˜¶æ®µï¼š<br><strong>è°ƒç ”:</strong>  openstackä¸cephç‰ˆæœ¬é€‚é… æµ‹è¯•æ­é…æƒ…å†µã€‚<br><strong>åˆ¶ä½œé•œåƒï¼š</strong>åˆ¶ä½œ</strong>openstack<strong>æ‰€éœ€é•œåƒ å…ˆæ­å»º</strong>all-in-one<strong>ç¯å¢ƒ</strong>openstack<strong>ä¸</strong>ceph<strong>å†åˆ¶ä½œå…¶é•œåƒ å¹¶æ¨é€åˆ°å…¬å¸å†…ç½‘harboré•œåƒå¹³å°ã€‚<br><strong>æ­å»ºï¼š</strong>æœ€åæ­å»ºé›†ç¾¤ç‰ˆ</strong>openstack**<br>Â· éƒ¨ç½²å®Œæˆå mariadb passwdç­‰æ•°æ®å¤‡ä»½<br>Â· äº‘ä¸»æœºå®‰è£…dockeræ— æ³•è®¿é—®å¤–ç½‘è®¾ç½®MTUè§£å†³<br>Â· <strong>cephadm</strong>çš„æ–¹å¼éƒ¨ç½²åç«¯<strong>ceph</strong>é›†ç¾¤ã€‚**<br>2023.05â€”2023.06<br>Â· è®¡ç®—èŠ‚ç‚¹æ•…éšœæ—¶æ¢å¤äº‘ä¸»æœº<br>Â· åˆ é™¤äº‘ä¸»æœºå¡æ­»ï¼Œå¡åœ¨deletingçŠ¶æ€<br>2022.07â€”2022.08<br>Â· äº‘ç›˜æ‰‹åŠ¨æ‰©å®¹<br>Â· cinder äº‘ç›˜æ— æ³•åˆ é™¤<br>Â· windowsäº‘ä¸»æœºè®¾ç½®å¯†ç æ°¸ä¸è¿‡æœŸ<br>Â· åˆ¶ä½œopenstackäº‘ä¸Šä½¿ç”¨çš„é•œåƒï¼ˆlinux(ubuntu16.04-22.04) centos(7.4-8.3) rocky9.2  debain11 windows server 2012r2 â€”2019ï¼‰<br>2023.08â€”2023.08<br>Â· openstacké›†ç¾¤ç¼©å‡è®¡ç®—èŠ‚ç‚¹ã€‚</p><p><strong>äº‘è®¡ç®—-äº‘è¿ç§»éƒ¨åˆ†</strong><br>2023.06-2023.07<br>Â· ä½¿ç”¨<strong>v2v</strong>ï¼Œå°†å®¢æˆ·<strong>vmware</strong>æ•°å°è™šæ‹Ÿæœºè¿ç§»åˆ°<strong>MCS-Stack</strong>äº‘å¹³å°åŒ…æ‹¬<strong>Linux</strong>ä¸<strong>windows</strong>ã€‚<br>Â· ä½¿ç”¨<strong>disk2vhd</strong>æŠ€æœ¯å°†å®¢æˆ·<strong>OpenStack</strong>äº‘å¹³å°<strong>windows server</strong>è¿ç§»åˆ°<strong>MCS-Stack</strong>äº‘å¹³å°ã€‚<br>2023.09-2023.09<br>Â· é˜¿é‡Œäº‘é¾™èœ¥é•œåƒECSï¼Œä½¿ç”¨<strong>qemu-img</strong>å†·è¿ç§»æŠ€æœ¯è¿ç§»åˆ°<strong>MCS-Stack</strong>äº‘å¹³å° å¹¶ä¿®æ”¹è„šæœ¬é€‚é…<strong>could-init</strong><br>Â· å®¢æˆ·åä¸ºäº‘å…«å°centos7.9ï¼Œäº‘èµ„æºè¿ç§»åˆ°<strong>MCS-Stack</strong>äº‘å¹³å° ä½¿ç”¨<strong>qemu-img</strong>å†·è¿ç§»æŠ€æœ¯ å¹¶å®‰è£…cloud-initç­‰é€‚é…<strong>MCS-Stack</strong>äº‘å¹³å°<br>2023.10-2023.11<br>Â· å°†æŸå®¢æˆ·å›½ç§‘äº‘å¤šå°centosåŠrds,ubuntué˜¿é‡Œäº‘<strong>DTS SMC çƒ­</strong>è¿ç§»ç­‰æ–¹å¼ è¿ç§»åˆ°é˜¿é‡Œäº‘ã€‚<br>Â· ä½¿ç”¨å…±äº«é•œåƒæ–¹å¼å°†æŸå®¢æˆ·<strong>A</strong>è´¦å·ECSèµ„æºè¿ç§»åˆ°<strong>B</strong>è´¦æˆ·åŠå°†å®¢æˆ·ossè¿ç§»åˆ°Bè´¦å·</p><p><strong>å®¢æˆ·æœåŠ¡ä¸‹æ–¹ä¸ºéƒ¨åˆ†ä¾‹å­(2022.04â€”â€”è‡³ä»Š)</strong><br>Â· è§£å†³rdsäº§å“<strong>sql-mode</strong>æŠ¥é”™ï¼Œéƒ¨ç½²<strong>mysql</strong>ä¸»ä»ï¼Œéƒ¨ç½²<strong>redis</strong>é›†ç¾¤<br>Â· éƒ¨ç½²<strong>nginx+keepalived</strong>é«˜å¯ç”¨å®ç°ä¸€ä¸ªå¤–ç½‘IPä¸¤æœåŠ¡å™¨å…¬ç”¨ ä»¥åŠä¸€ä¸ªå†…ç½‘VIPä¸¤æœåŠ¡å™¨å…¬ç”¨<br>Â· å®¢æˆ·åœ¨mcs-stackä¸Šäº‘ä¸»æœº<strong>é­é‡xmrigæŒ–çŸ¿ç—…æ¯’ pnscanç—…æ¯’</strong>æ”»å‡»è§£å†³ã€‚<br>Â· äº‘ä¸»æœºä½¿ç”¨lvmå·ä½¿æ•°æ®ç›˜æ‰©å®¹åˆ°ç³»ç»Ÿç›˜åè¿›å…¥<strong>grub rescue</strong>æ•‘æ´æ¨¡å¼è§£å†³ç­‰ã€‚<br>Â· è§£å†³å®¢æˆ·ä½¿ç”¨dockeræ„å»ºnacosé‡åˆ°çš„ä¸€ç³»åˆ—é—®é¢˜åŒ…æ‹¬æ•°æ®æŒä¹…åŒ– ä½¿ç”¨å¤–éƒ¨æ•°æ®åº“ç­‰ã€‚</p><p><strong>è„šæœ¬éƒ¨åˆ†</strong><br>Â· ç¼–å†™shellè„šæœ¬ç›‘æ§åç«¯<strong>ceph</strong>é›†ç¾¤å¥åº·çŠ¶å†µï¼ˆopenstack é›†æˆäº†prometheuså®æ—¶ç›‘æ§cephé›†ç¾¤çŠ¶å†µï¼‰ã€‚        ï¼ˆå‘Šè­¦æ¨é€åˆ°é’‰é’‰ï¼‰ï¼Œç¼–å†™æ¸…ç©ºzabbixè¡¨shellè„šæœ¬ã€‚<br>Â· ç¼–å†™<strong>zabbix</strong>å‘Šè­¦è„šæœ¬  ï¼ˆä¼ä¸šå¾®ä¿¡å‘Šè­¦ï¼‰ï¼Œç¼–å†™lvmè‡ªåŠ¨æ‰©å®¹è„šæœ¬ï¼ˆäººæœºäº¤äº’ï¼‰ã€‚<br>Â· ç¼–å†™ç¼–è¯‘å®‰è£…nginx keepalivedmysql redisï¼Œ<br>Â· ç›‘æ§vcenter exsi pythonè„šæœ¬ å‘Šè­¦æ¨é€åˆ°é’‰é’‰<br>Â· ç¼–å†™éƒ¨ç½²openstackåˆå§‹åŒ–è„šæœ¬ ä»¥åŠ<strong>all-in-one</strong>ç¯å¢ƒä¸€é”®éƒ¨ç½²openstackè„šæœ¬<br>Â· ç¼–å†™ä¸€é”®æ¸…ç†cephé›†ç¾¤ä»¥åŠä¸€é”®å®‰è£…cephé›†ç¾¤è„šæœ¬ï¼ŒäºŒæ¬¡å¼€å‘kalla-ansibleé›†æˆå…¬å¸å‰ç«¯é¢æ¿ã€‚<br>Â· ç¼–å†™ç›‘æ§oracle pythonè„šæœ¬ å¯¹æŸå¤§ç¥çš„é¡¹ç›®äºŒæ¬¡å¼€å‘ å¢åŠ pythonè„šæœ¬oracleç›‘æ§é¡¹ç›®<br>Â· ç¼–å†™å†·è¿ç§»v2våŠè‡ªåŠ¨è¿ç§»è„šæœ¬ï¼Œ<br>Â· ç¼–å†™é€‚ç”¨äºcentos ubuntu çš„æœåŠ¡å™¨åˆå§‹åŒ–è„šæœ¬åŒ…æ‹¬è‡ªå·±è®¾ç½®æ—¶åŒº æº limit docker pipç­‰<br>Â· ç¼–å†™mysql pgæ•°æ®åº“è‡ªåŠ¨å¤‡ä»½è„šæœ¬ï¼Œç¼–å†™ansibleå‰§æœ¬å®ç°skylineä¸openstacké›†æˆ</p><p><strong>ç›‘æ§éƒ¨åˆ†</strong><br>2022.04-2022.05<br>Â· æŒ‰å®¢æˆ·éœ€æ±‚è®¾è®¡éƒ¨ç½²ç›‘æ§æŸåŒ»é™¢ä¸ƒå°æœåŠ¡å™¨<strong>telegraf+prometheus+grafana</strong>çš„æ–¹å¼ç›‘æ§<strong>linuxå„é¡¹æŒ‡æ ‡</strong><br>Â· <strong>æ­å»ºé‡‡ç”¨telegraf+prometheusæ¶æ„</strong>ç›‘æ§äº¤æ¢æœºç­‰æ•°é€šè®¾å¤‡ ï¼ˆåæœŸæ€§èƒ½ä¸è¶³æ›¿æ¢ä¸ºzabbixï¼‰ã€‚<br>Â· æ­å»ºzabbixç›‘æ§å…¬å¸<strong>ä¸Šç™¾å°äº¤æ¢æœº</strong>å®ç°äº¤æ¢æœºå„ç§ç›‘æ§ä¸é™äºï¼ˆè¿›å‡ºå£æµé‡ cpu å†…å­˜ æ¸©åº¦ç­‰ï¼‰æ­é…è„šæœ¬å®ç°å‘Šè­¦æ¨é€åˆ°ä¼ä¸šå¾®ä¿¡ã€‚<br>2022.07-2022.08<br>Â· æ­å»º<strong>telegraf+influxdb+grafana</strong>ç›‘æ§<strong>æŸå®¢æˆ·ä»£è¿ç»´vcenter</strong>é¡¹ç›® å®ç°å¯¹æ•´ä¸ªé›†ç¾¤çš„ç›‘æ§ åŒ…æ‹¬æ¯ä¸€å°è™šæ‹Ÿæœº æ¯ä¸€å°exsiå®¿ä¸»æœº å®Œå…¨æ»¡è¶³ä¸šåŠ¡éœ€æ±‚ <strong>è¯¥vmwareé¡¹ç›®åŒ…å«500å¤šå°è™šæ‹Ÿæœº</strong>åä¸ª<strong>esxi</strong>èŠ‚ç‚¹ã€‚<br>Â· æ„å»º<strong>telegraf+influxdb+python</strong>è„šæœ¬+<strong>grafana</strong>ç›‘æ§<strong>æŸå®¢æˆ·ä»£è¿ç»´vcenter</strong>é¡¹ç›®ä¸­äº”å°<strong>oracle</strong>æ•°æ®åº“ï¼ˆæ­¤é¡¹ç›®ä¸ºå¯¹æŸå¤§ç¥é¡¹ç›®äºŒæ¬¡å¼€å‘  ä¿®æ”¹<strong>python</strong>è„šæœ¬åˆ¶ä½œ<strong>telegraf-py</strong>ç‰ˆé•œåƒå®ç°å¯¹<strong>oracle</strong>å®Œå…¨ç›‘æ§ï¼‰ã€‚<br>2023.07-2023.07<br>Â· ç¼–è¯‘<strong>nginx-module-vts</strong>æ¨¡å—è¿›<strong>nginx</strong>ä½¿ç”¨<strong>prometheus+grafana</strong>å®ç°å¯¹<strong>nginx</strong>çš„ç›‘æ§ï¼Œéƒ¨ç½²<strong>uptime-Kuma</strong>ç›‘æ§å…¬å¸å„å¥—ç³»ç»Ÿ<br>Â· éƒ¨ç½²<strong>grafana</strong>å¼€æº<strong>loki</strong>ç›‘æ§å…¬å¸å„å°ç‰©ç†æœåŠ¡å™¨ç³»ç»Ÿæ—¥å¿—ã€‚</p><p><strong>ä»£è¿ç»´å®¢æˆ·åŠå…¬å¸å†…éƒ¨ç³»ç»Ÿéƒ¨ç½²åŠç»´æŠ¤éƒ¨åˆ†ï¼ˆ2023.07-è‡³ä»Šï¼‰</strong><br>Â· ä½¿ç”¨<strong>vercelå‡½æ•°è®¡ç®—</strong>æ­å»ºå…¬å¸<strong>chagpté—®ç­”ç³»ç»Ÿå®ç°</strong>è·¨å¢ƒè®¿é—®<strong>openai chatgpt</strong>æœåŠ¡ã€‚<br>Â· éƒ¨ç½²<strong>k8sä¸ceph</strong>é›†æˆï¼ˆ<strong>storeglass</strong>ï¼‰ã€‚<br>Â· éƒ¨ç½²<strong>wiki</strong>å…¬å¸å†…éƒ¨çŸ¥è¯†åº“ç³»ç»Ÿ<br>Â· éƒ¨ç½²<strong>cacti</strong>ç›‘æ§äº¤æ¢æœºå¹³å°<br>Â· <strong>smartping</strong> ç›‘æ§ç½‘ç»œçŠ¶å†µç³»ç»Ÿå¹¶åˆ¶ä½œ<strong>smartping docker</strong>é•œåƒå®ç°å¿«æ·éƒ¨ç½²ã€‚<br>Â· éƒ¨ç½²<strong>webstack</strong>ç½‘ç«™å¯¼èˆªç³»ç»Ÿã€‚<br>Â· <strong>ferryä¸‡èƒ½</strong>å·¥å•ç³»ç»Ÿã€‚<br>Â· <strong>cloudreve</strong>å…¬å¸äº‘ç›˜ç³»ç»Ÿã€‚<br>Â· è°ƒç ”<strong>kanboard</strong>ä¸<strong>ç¦…é“</strong>é¡¹ç›®ç®¡ç†ç³»ç»Ÿ <strong>å› kanboardåŠŸèƒ½å¤šæ ·ä½†å‰ç«¯ç®€é™‹</strong>æœ€ç»ˆé€‰å‹ä½¿ç”¨<strong>ç¦…é“ç³»ç»Ÿ</strong>ã€‚<br>Â· éƒ¨ç½²å…¬å¸<strong>esxié›†ç¾¤ä½¿ç”¨vcenter</strong>ç®¡ç†å¹³å°æ§åˆ¶ã€‚<br>Â· åŸ¹è®­å…¬å¸å„ç§è¿ç»´äººå‘˜ï¼Œç ”å‘éƒ¨ç½²äº‘ç®±ç»´æŠ¤<br>Â· é›†ç¾¤<strong>cronsun</strong>å®šæ—¶ä»»åŠ¡ç®¡ç†ç³»ç»Ÿï¼Œ<strong>bitwarden</strong>å¯†ç ç®¡ç†å¹³å°ã€‚<br>Â· å¸®åŠ©æŸäº‘å¹³å°å®¢æˆ·å°†<strong>nacos</strong>åˆ¶ä½œæˆä¸ºé•œåƒå®ç°<strong>docker</strong>ä¸€é”®å¿«æ·éƒ¨ç½²å®ç°æ•°æ®æŒä¹…åŒ–<br>Â· æ—¥å¸¸ç»´æŠ¤openstacké›†ç¾¤  ç»´æŠ¤åç«¯å­˜å‚¨cephé›†ç¾¤<br>ä¾‹ï¼š äº‘ä¸»æœº æ— æ³•åˆ é™¤ å‰ç«¯å¡æ­» ï¼Œ10 pgs not deep-scrubbed in timeï¼Œcephé›†ç¾¤å®¹é‡å‘Šè­¦ osdæ¢ç›˜æ›´æ¢<br>Â· å…¬å¸äº‘å¹³å°ä¸Šåƒå®¶å®¢æˆ·äº‘èµ„æºçš„æ—¥å¸¸è¿ç»´æœåŠ¡åˆ¶ä½œäº‘ä¸Šç¯å¢ƒä½¿ç”¨çš„å„ç§<strong>windows</strong>ç³»ç»Ÿ<strong>linux</strong>ç³»ç»Ÿçš„é•œåƒ<br>Â· æ­å»ºæŸå®¢æˆ·nginx+keepalivedé«˜å¯ç”¨ å®ç°ä¸»æŒ‚<strong>å¤–ç½‘IP</strong>åŠ<strong>å†…ç½‘VIP</strong>è‡ªåŠ¨åˆ‡æ¢åˆ°å¤‡æœåŠ¡å™¨ï¼ˆè¯¥é¡¹ç›®åªæœ‰ä¸€ä¸ªå¤–ç½‘IPï¼‰<br>Â· æ­å»ºæŸå®¢æˆ·<strong>mysql</strong>ä¸»ä»å¤åˆ¶é¡¹ç›®åæœŸæ›¿æ¢ä¸º<strong>MariaDB Galera****Cluster</strong>å®ç°ä¸»å¤‡è‡ªåŠ¨åˆ‡æ¢ã€‚</p><h4 id="å…¶ä»–-è‡ªæœ‰é¡¹ç›®"><a href="#å…¶ä»–-è‡ªæœ‰é¡¹ç›®" class="headerlink" title="å…¶ä»–/è‡ªæœ‰é¡¹ç›®"></a>å…¶ä»–/è‡ªæœ‰é¡¹ç›®</h4><p>Â· ä¸¤ç«™ç‚¹ä¸ªäººåšå®¢ç³»ç»Ÿ ï¼ˆç¼–å†™æŠ€æœ¯åšå®¢180ä½™ç¯‡ åŠ ä¸Šonenoteç´¯è®¡ä¸‰åä¸‡å­—ï¼‰<br>Â· <strong>Discuss Twikoo</strong>è¯„è®ºç³»ç»Ÿ<br><strong>OneManager</strong> ç½‘ç›˜ç®¡ç†ç³»ç»Ÿï¼ˆæ‰€æœ‰ç½‘ç›˜é€šè¿‡æ­¤<strong>web</strong>ç®¡ç†<strong>onedrive</strong> é˜¿é‡Œäº‘ç›˜ç­‰å®ç°ä¸é™æ ¼å¼ä»»æ„å¯å…±äº«ï¼‰<br>Â· <strong>Blazeb2</strong>å›¾åºŠç®¡ç†ç³»ç»Ÿå…¼å®¹<strong>s3</strong>åè®®ã€‚<br>Â· æ­å»ºNextChatè®¿é—®openai  ChatGptæœåŠ¡<br>NOTEï¼šä¸Šè¿°å„ç§ç³»ç»Ÿå‡é‡‡ç”¨<strong>cloudns</strong>æä¾›åŸŸå <strong>cloudfare</strong>æä¾›åŸŸåè§£æåŠ<strong>CDN</strong>ç¼“å­˜ç­‰ é™¤åšå®¢å¤–å…¶ä½™ç³»ç»Ÿå‡ä½¿ç”¨<strong>vercel</strong>å‡½æ•°è®¡ç®—ï¼ˆfaasï¼‰éƒ¨ç½²ã€‚</p><h4 id="è‡ªæˆ‘è¯„ä»·-å…´è¶£çˆ±å¥½"><a href="#è‡ªæˆ‘è¯„ä»·-å…´è¶£çˆ±å¥½" class="headerlink" title="è‡ªæˆ‘è¯„ä»·/å…´è¶£çˆ±å¥½"></a>è‡ªæˆ‘è¯„ä»·/å…´è¶£çˆ±å¥½</h4><p>è‡ªæˆ‘è¯„ä»·<br>Â· å¼ºæ‰§è¡ŒåŠ›ï¼ˆæ‰§è¡Œçš„æ„æ„¿+æ‰§è¡Œçš„èƒ½åŠ›ï¼‰<br>Â· å¼ºå­¦ä¹ åŠ›ï¼ˆå¯¹æ–°æŠ€æœ¯çš„æ¸´æœ›+åˆ»è‹¦çš„é’»ç ”ç²¾ç¥ï¼‰<br>Â· è¾ƒå¼ºçš„å›¢é˜Ÿåˆä½œæ„è¯†ã€ä¹äºå¹¶å–„äºåˆ†äº«ã€‚<br>å…´è¶£çˆ±å¥½<br>Â· ç¯®çƒ è¶³çƒ ç¾½æ¯›çƒ æ•£æ­¥ ç™»å±± ç­‰å„ç§è¿åŠ¨åŠå¯¹æŠ€æœ¯æœ‰æµ“åšçš„å…´è¶£çˆ±å¥½çæŠ˜è…¾ ã€‚<br>Â· çƒ­çˆ±ä¸­å›½å¤è¯—è¯æ–‡åŒ– åŠæ˜ä»£å†å²ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®</title>
      <link href="/2024/01/31/%E4%BD%BF%E7%94%A8vercel%E5%8F%8Adocker%E6%9E%84%E5%BB%BAchatgpt-nex-web%E5%AE%9E%E7%8E%B0%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/"/>
      <url>/2024/01/31/%E4%BD%BF%E7%94%A8vercel%E5%8F%8Adocker%E6%9E%84%E5%BB%BAchatgpt-nex-web%E5%AE%9E%E7%8E%B0%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®"><a href="#ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®" class="headerlink" title="ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®"></a>ä½¿ç”¨vercelåŠdockeræ„å»ºchatgpt-nex-webå®ç°å›½å†…è®¿é—®</h2><p>æ¦‚è§ˆï¼š</p><ul><li>éœ€è¦åœ¨æŸå®è´­ä¹°openai-key</li><li>å¯è´­ä¹°ç›´è¿keyæˆ–ä¸­è½¬key å¦‚æœè´­ä¹°çš„ä¸ºä¸­è½¬keyåˆ™éœ€è¦å¡«å†™ä¸­è½¬æœåŠ¡åœ°å€</li><li><a href="https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web">chatgpt-nex-webé¡¹ç›®åœ°å€</a> å…ˆforkåˆ°è‡ªå·±ä»“åº“</li><li><a href="https://vercel.com/new/clone?repository-url=https://github.com/Yidadaa/ChatGPT-Next-Web&env=OPENAI_API_KEY&env=CODE&env=GOOGLE_API_KEY&project-name=chatgpt-next-web&repository-name=ChatGPT-Next-Web">verceléƒ¨ç½²åœ°å€</a></li></ul><p>å…¶ä»–ç±»ä¼¼å¼€æºé¡¹ç›®ï¼š</p><ul><li><a href="https://lobehub.com/zh/docs/self-hosting/platform/vercel">Lobe Chat</a></li><li><a href="https://github.com/lobehub/lobe-chat">lobe chatä»£ç ä»“åº“</a></li><li><a href="https://mp.weixin.qq.com/s?__biz=MzkzODY1MTQzOQ==&mid=2247483908&idx=1&sn=b2080d845ce5f0bc0c62373876763fa9&chksm=c2fdb844f58a3152a8164dd750c28d213fbd10d27ab83afd4af88e6105e054935e8c1f095f7d&mpshare=1&scene=24&srcid=050689k9Z1fsXTKMRvZ99D8j&sharer_shareinfo=7581c54658eeb1539b7febee12f3c196&sharer_shareinfo_first=7581c54658eeb1539b7febee12f3c196#rd">lobe Chatéƒ¨ç½²æ•™ç¨‹</a></li></ul><h4 id="ä¸€-æ„å»º"><a href="#ä¸€-æ„å»º" class="headerlink" title="ä¸€. æ„å»º"></a>ä¸€. æ„å»º</h4><p>æ·»åŠ å¦‚ä¸‹ç¯å¢ƒå˜é‡å³å¯</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CODE: passwd</span><br><span class="line">BASE<span class="emphasis">_URL: https://chatapi<span class="strong">***</span></span></span><br><span class="line"><span class="strong"><span class="emphasis">OPENAI_API_KEY: sk-wD6Ha8FsvZfbpH7AD53**</span><span class="strong">****</span><span class="strong">****</span>*</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c4148f2652bb4fe1369077b9bafea30c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c4148f2652bb4fe1369077b9bafea30c.png"></p><p>æ­¤æ—¶æ„å»ºå®Œæˆã€‚</p><h4 id="äºŒ-dockeréƒ¨ç½²"><a href="#äºŒ-dockeréƒ¨ç½²" class="headerlink" title="äºŒ. dockeréƒ¨ç½²"></a>äºŒ. dockeréƒ¨ç½²</h4><p>é•œåƒå¯é€‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yidadaa/chatgpt-next-web</span><br><span class="line">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:chatgpt-next-web-v2.11.3</span><br></pre></td></tr></table></figure><p>docker-composeéƒ¨ç½²</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">chatgpt-next-web:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">yidadaa/chatgpt-next-web</span></span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">chatgpt-next-web_container</span></span><br><span class="line">    <span class="attr">restart:</span> <span class="string">always</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;3001:3000&quot;</span></span><br><span class="line">    <span class="attr">environment:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">OPENAI_API_KEY=sk-En7SyGK0zljZWKlT98836aD3B2Dc420c900021D943Ac41F4</span> <span class="comment"># oneapi key</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">CODE=Jkl123456</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">PROXY_URL=http://192.168.31.163:3002</span>   <span class="comment"># oneapiåœ°å€</span></span><br></pre></td></tr></table></figure><h4 id="ä¸‰-ä½¿ç”¨"><a href="#ä¸‰-ä½¿ç”¨" class="headerlink" title="ä¸‰. ä½¿ç”¨"></a>ä¸‰. ä½¿ç”¨</h4><ul><li><p>è‹¥keyé¢åº¦ä¸å¤Ÿåˆ™éœ€è¦å……å€¼, å…¶ä»–keyä½¿ç”¨æ­¤å¹³å°è®¿é—®chatgptéœ€è¦å¦‚ä¸‹æ“ä½œ</p></li><li><p>ç›´è¿keyç›´æ¥å¡«å†™åå³å¯ä½¿ç”¨ è‡ªå®šä¹‰æ¥å£å¤„ æ¥å£åœ°å€ä¿ç•™é»˜è®¤â€œ/api/openaiâ€</p></li><li><p>ä¸­è½¬keyåˆ™è‡ªå®šä¹‰æ¥å£å¤„ æ¥å£åœ°å€éœ€è¦å¡«å†™ä¸­è½¬æœåŠ¡åœ°å€</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6f3a9535578411a50e84c4b23940099b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6f3a9535578411a50e84c4b23940099b.png"></p></li></ul><p>lobechatæ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_83095fcea8d81d4ab7cfba1b69f2bd33.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/5/image_83095fcea8d81d4ab7cfba1b69f2bd33.png"></p><p>å»ºè®®ä½¿ç”¨cloudfareç»™vercelç»‘å®šåŸŸåè®¿é—®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®</title>
      <link href="/2024/01/29/%E5%85%AC%E6%9C%89%E4%BA%91%E7%A7%81%E6%9C%89%E4%BA%91%E5%AF%B9%E8%B1%A1%E6%A1%B6%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/01/29/%E5%85%AC%E6%9C%89%E4%BA%91%E7%A7%81%E6%9C%89%E4%BA%91%E5%AF%B9%E8%B1%A1%E6%A1%B6%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®"><a href="#å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®" class="headerlink" title="å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®"></a>å…¬æœ‰äº‘ç§æœ‰äº‘å¯¹è±¡æ¡¶ä¿¡æ¯é…ç½®</h2><h3 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h3><p>å…¬æœ‰äº‘ä¸ç§æœ‰äº‘é…ç½®å¯¹è±¡æ¡¶ä¿¡æ¯æ˜¯æœ‰å·®å¼‚çš„</p><h3 id="ä¸€-å…¬æœ‰äº‘-é˜¿é‡Œäº‘ä¸ºä¾‹"><a href="#ä¸€-å…¬æœ‰äº‘-é˜¿é‡Œäº‘ä¸ºä¾‹" class="headerlink" title="ä¸€. å…¬æœ‰äº‘-é˜¿é‡Œäº‘ä¸ºä¾‹"></a>ä¸€. å…¬æœ‰äº‘-é˜¿é‡Œäº‘ä¸ºä¾‹</h3><p>ä½¿ç”¨è½¯ä»¶<strong>s3cmd</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…s3cmd</span></span><br><span class="line">yum install -y epel-release &amp;&amp; yum install -y s3cmd</span><br><span class="line"><span class="comment"># å®‰è£…qemu</span></span><br><span class="line">yum install qemu-kvm libvirt virt-install bridge-utils  -y</span><br></pre></td></tr></table></figure><p>å…¶ä»–å®‰è£…æ–¹å¼ï¼ˆubuntuï¼‰</p><p><a href="https://developer.aliyun.com/article/356106">https://developer.aliyun.com/article/356106</a><br><a href="https://www.s3express.com/download.htm">https://www.s3express.com/download.htm</a>    ï¼ˆs3è½¯ä»¶ä¸‹è½½é“¾æ¥ï¼‰</p><p>ç®€ä»‹ï¼š<br><a href="https://wangyan.org/blog/s3cmd-how-to-use.html">https://wangyan.org/blog/s3cmd-how-to-use.html</a></p><p>s3cmd å®‰è£…ä½¿ç”¨æŒ‡å—<br>s3cmd æ˜¯ä¸€æ¬¾ Amazon S3 å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒä¸ä»…èƒ½ä¸Šä¼ ã€ä¸‹è½½ã€åŒæ­¥ï¼Œè¿˜èƒ½è®¾ç½®æƒé™ï¼Œä¸‹é¢æ˜¯å®Œæ•´çš„å®‰è£…ä½¿ç”¨æŒ‡å—ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ä¸€ã€å®‰è£…æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•ä¸€ï¼šï¼ˆDebian/Ubuntu ï¼‰</span></span><br><span class="line"><span class="string">wget</span> <span class="string">-O-</span> <span class="string">-q</span> <span class="string">http://s3tools.org/repo/deb-all/stable/s3tools.key</span> <span class="string">|</span> <span class="string">sudo</span> <span class="string">apt-key</span> <span class="string">add</span> <span class="bullet">-</span></span><br><span class="line"><span class="string">wget</span> <span class="string">-O/etc/apt/sources.list.d/s3tools.list</span> <span class="string">http://s3tools.org/repo/deb-all/stable/s3tools.list</span></span><br><span class="line"><span class="string">apt-get</span> <span class="string">update</span> <span class="string">&amp;&amp;</span> <span class="string">sudo</span> <span class="string">apt-get</span> <span class="string">install</span> <span class="string">s3cmd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ–¹æ³•äºŒï¼š</span></span><br><span class="line"><span class="string">wget</span> <span class="string">http://nchc.dl.sourceforge.net/project/s3tools/s3cmd/1.0.0/s3cmd-1.0.0.tar.gz</span></span><br><span class="line"><span class="string">tar</span> <span class="string">-zxf</span> <span class="string">s3cmd-1.0.0.tar.gz</span> <span class="string">-C</span> <span class="string">/usr/local/</span></span><br><span class="line"><span class="string">mv</span> <span class="string">/usr/local/s3cmd-1.0.0/</span> <span class="string">/usr/local/s3cmd/</span></span><br><span class="line"><span class="string">ln</span> <span class="string">-s</span> <span class="string">/usr/local/s3cmd/s3cmd</span> <span class="string">/usr/bin/s3cmd</span></span><br></pre></td></tr></table></figure><p>é˜¿é‡Œäº‘é…ç½®å¦‚ä¸‹</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_896f06a76b5634cec9f24ce6f7ec5119.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_896f06a76b5634cec9f24ce6f7ec5119.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">åˆå§‹åŒ–s3cmd</span></span><br><span class="line">s3cmd --configure</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ‰§è¡Œ</span></span><br><span class="line">[root@3z6to251zh02kg system]# s3cmd --configure</span><br><span class="line"></span><br><span class="line">Enter new values or accept defaults in brackets with Enter.</span><br><span class="line">Refer to user manual for detailed description of all options.</span><br><span class="line"></span><br><span class="line">Access key and Secret key are your identifiers for Amazon S3. Leave them empty for using the env variables.</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Access Key: LTAI5t9</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Secret Key: XD0f6iyM0nY8oUJZz</span></span><br><span class="line">Default Region [US]:  # hangzhou</span><br><span class="line"></span><br><span class="line">Use &quot;s3.amazonaws.com&quot; for S3 Endpoint and not modify it to the target Amazon S3.</span><br><span class="line">S3 Endpoint [s3.amazonaws.com]: # oss-cn-hangzhou.aliyuncs.com ï¼ˆbucketsåŸŸååœ¨é˜¿é‡Œäº‘ossæ¦‚è§ˆä¸­æŸ¥çœ‹ï¼‰</span><br><span class="line"></span><br><span class="line">Use &quot;%(bucket)s.s3.amazonaws.com&quot; to the target Amazon S3. &quot;%(bucket)s&quot; and &quot;%(location)s&quot; vars can be used</span><br><span class="line">if the target S3 system supports dns based buckets.</span><br><span class="line">DNS-style bucket+hostname:port template for accessing a bucket [%(bucket)s.s3.amazonaws.com]: # %(bucket)s.oss-cn-hangzhou.aliyuncs.com</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">%(bucket)s.oss-cn-hangzhou.aliyuncs.com</span></span><br><span class="line">Encryption password is used to protect your files from reading</span><br><span class="line">by unauthorized persons while in transfer to S3</span><br><span class="line">Encryption password: </span><br><span class="line">Path to GPG program [/bin/gpg]: </span><br><span class="line"></span><br><span class="line">When using secure HTTPS protocol all communication with Amazon S3</span><br><span class="line">servers is protected from 3rd party eavesdropping. This method is</span><br><span class="line">slower than plain HTTP, and can only be proxied with Python 2.7 or newer</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Use HTTPS protocol [Yes]: Yes</span></span><br><span class="line"></span><br><span class="line">On some networks all internet access must go through a HTTP proxy.</span><br><span class="line">Try setting it here if you can&#x27;t connect to S3 directly</span><br><span class="line">HTTP Proxy server name: </span><br><span class="line"></span><br><span class="line">New settings:</span><br><span class="line">  Access Key: LTAI5t9EwR</span><br><span class="line">  Secret Key: XD0f6iyM0nJZz1</span><br><span class="line">  Default Region: hangzhou</span><br><span class="line">  S3 Endpoint: oss-cn-hangzhou.aliyuncs.com</span><br><span class="line">  DNS-style bucket+hostname:port template for accessing a bucket: %(bucket)s.oss-cn-hangzhou.aliyuncs.com</span><br><span class="line">  Encryption password: </span><br><span class="line">  Path to GPG program: /bin/gpg</span><br><span class="line">  Use HTTPS protocol: True</span><br><span class="line">  HTTP Proxy server name: </span><br><span class="line">  HTTP Proxy server port: 0</span><br><span class="line"></span><br><span class="line">Test access with supplied credentials? [Y/n] y</span><br><span class="line">Please wait, attempting to list all buckets...</span><br><span class="line">Success. Your access key and secret key worked fine :-)</span><br><span class="line"></span><br><span class="line">Now verifying that encryption works...</span><br><span class="line">Not configured. Never mind.</span><br><span class="line"></span><br><span class="line">Save settings? [y/N] y</span><br><span class="line">Configuration saved to &#x27;/root/.s3cfg&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æ­¤æ—¶è®¾ç½®å®Œæˆ</span></span><br></pre></td></tr></table></figure><p>å®¢æˆ·ç«¯è¿æ¥è½¯ä»¶é…ç½®</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_69abbafcc46e7ce35928521f13a67e58.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_69abbafcc46e7ce35928521f13a67e58.png"></p><p>æ­¤æ—¶å³å¯è®¿é—®é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ã€‚</p><h3 id="äºŒ-ç§æœ‰äº‘-æŸäº‘é…ç½®"><a href="#äºŒ-ç§æœ‰äº‘-æŸäº‘é…ç½®" class="headerlink" title="äºŒ. ç§æœ‰äº‘ æŸäº‘é…ç½®"></a>äºŒ. ç§æœ‰äº‘ æŸäº‘é…ç½®</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># åˆ›å»ºbucketsæŠ¥é”™ï¼šåŸå› ç‰ˆæœ¬ä¸ä¸€è‡´ éœ€è¦å°†v2å¯ç”¨</span></span><br><span class="line">è§£å†³ï¼š</span><br><span class="line">vim /root/.s3cfg</span><br><span class="line">signature<span class="emphasis">_v2 = True </span></span><br><span class="line"><span class="emphasis"># æˆ–æ–°å»ºæ–‡ä»¶è¾“å…¥ï¼š</span></span><br><span class="line"><span class="emphasis">vim ~/.s3cfg</span></span><br><span class="line"><span class="emphasis">[default]</span></span><br><span class="line"><span class="emphasis">access_</span>key = 914c4</span><br><span class="line">secret<span class="emphasis">_key = qk45WMQg5VP4MBeAYE</span></span><br><span class="line"><span class="emphasis">host_</span>base = http://111.111.87.99:7480</span><br><span class="line">host<span class="emphasis">_bucket = http://111.111.87.99:7480/914c48814</span></span><br><span class="line"><span class="emphasis">use_</span>https = False</span><br><span class="line">signature<span class="emphasis">_v2 = True </span></span><br></pre></td></tr></table></figure><h3 id="ä¸‰-æ‰©å±•s3cmdå‘½ä»¤ä½¿ç”¨"><a href="#ä¸‰-æ‰©å±•s3cmdå‘½ä»¤ä½¿ç”¨" class="headerlink" title="ä¸‰. æ‰©å±•s3cmdå‘½ä»¤ä½¿ç”¨"></a>ä¸‰. æ‰©å±•<code>s3cmd</code>å‘½ä»¤ä½¿ç”¨</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># å‘½ä»¤ä½¿ç”¨</span></span><br><span class="line"><span class="section">#åˆ›å»ºbucketåç§°ä¸ºs3://cem-demo</span></span><br><span class="line">s3cmd -h                                            # æŸ¥çœ‹å‘½ä»¤è¯¦æƒ…</span><br><span class="line">s3cmd put /etc/fstab  s3://s3cmd-demo/fstab-demo    # ä¸Šä¼ æ–‡ä»¶å°†/etcç›®å½•ä¸‹æ–‡ä»¶fstabä¸Šä¼ </span><br><span class="line">s3cmd ls s3://ceph-s3-bucket                        # æŸ¥çœ‹bucketé‡Œé¢æœ‰ä»€ä¹ˆæŸ¥çœ‹å…·ä½“å†…å®¹åé¢æ¥ç›®å½•</span><br><span class="line">s3cmd put /etc s3://ceph-s3-bucket/fstab-demo/etc/ --recursive # ä¸Šä¼ ç›®å½•ï¼ˆé€’å½’çš„æ–¹å¼è®°å¾—&quot;/&quot;ï¼‰</span><br><span class="line">s3cmd get s3://ceph-s3-bucket/s3browser-6-4-1.rar              # ä¸‹è½½å‘½ä»¤</span><br><span class="line"></span><br><span class="line">s3cmd rm s3://ceph-s3-bucket/fstab-demo                        # åˆ é™¤æ–‡ä»¶å‘½ä»¤</span><br><span class="line">s3cmd rm s3://ceph-s3-bucket/fstab-demo/ --recursive           # åˆ é™¤ç›®å½•å‘½ä»¤</span><br><span class="line">s3cmd mb s3://cmd-demo                                         # åˆ›å»ºç›®å½•</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centosè®¾ç½®ç™»é™†å¯†ç éªŒè¯é”™è¯¯è‡ªåŠ¨é”å®š</title>
      <link href="/2024/01/28/centos%E8%AE%BE%E7%BD%AE%E7%99%BB%E9%99%86%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E9%94%99%E8%AF%AF%E8%87%AA%E5%8A%A8%E9%94%81%E5%AE%9A/"/>
      <url>/2024/01/28/centos%E8%AE%BE%E7%BD%AE%E7%99%BB%E9%99%86%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E9%94%99%E8%AF%AF%E8%87%AA%E5%8A%A8%E9%94%81%E5%AE%9A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>centosè®¾ç½®ç™»é™†å¯†ç éªŒè¯é”™è¯¯è‡ªåŠ¨é”å®š</strong></p><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/weixin_43822878/article/details/93018223">Linuxé™åˆ¶è¿œç¨‹ç™»å½•å°è¯•å¯†ç æ¬¡æ•°åŠé”å®šæ—¶é—´_linux sshè¿æ¥5æ¬¡å°ip1å°æ—¶-CSDNåšå®¢</a></p><p>CentOSä¸­æœ‰ä¸€ä¸ªpam_tally2.soçš„PAMæ¨¡å—ï¼Œæ¥é™å®šç”¨æˆ·çš„ç™»å½•å¤±è´¥æ¬¡æ•°ï¼Œå¦‚æœæ¬¡æ•°è¾¾åˆ°è®¾ç½®çš„é˜ˆå€¼ï¼Œåˆ™é”å®šç”¨æˆ·ã€‚</p><h3 id="ä¸€-system-authè®¾ç½®ç™»é™†é”™è¯¯é”å®šï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨æ­¤ä¼˜åŒ–é…ç½®ï¼‰"><a href="#ä¸€-system-authè®¾ç½®ç™»é™†é”™è¯¯é”å®šï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨æ­¤ä¼˜åŒ–é…ç½®ï¼‰" class="headerlink" title="ä¸€. system-authè®¾ç½®ç™»é™†é”™è¯¯é”å®šï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨æ­¤ä¼˜åŒ–é…ç½®ï¼‰"></a>ä¸€. system-authè®¾ç½®ç™»é™†é”™è¯¯é”å®šï¼ˆæœ¬æ•™ç¨‹ä½¿ç”¨æ­¤ä¼˜åŒ–é…ç½®ï¼‰</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_7a31d3176074dee91ac4da1d3a07e168.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_7a31d3176074dee91ac4da1d3a07e168.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pam.d/system-auth</span><br><span class="line"><span class="comment"># é…ç½®å¦‚ä¸‹</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line"><span class="comment"># This file is auto-generated.</span></span><br><span class="line"><span class="comment"># User changes will be destroyed the next time authconfig is run.</span></span><br><span class="line">auth       required       pam_tally2.so    deny=3    unlock_time=10 even_deny_root root_unlock_time=10</span><br><span class="line">auth        required      pam_env.so</span><br><span class="line">auth        required      pam_faildelay.so delay=2000000</span><br><span class="line">auth        sufficient    pam_unix.so nullok try_first_pass</span><br><span class="line">auth        requisite     pam_succeed_if.so uid &gt;= 1000 quiet_success</span><br><span class="line">auth        required      pam_deny.so</span><br><span class="line"></span><br><span class="line">account     required      pam_unix.so</span><br><span class="line">account     sufficient    pam_localuser.so</span><br><span class="line">account     sufficient    pam_succeed_if.so uid &lt; 1000 quiet</span><br><span class="line">account     required      pam_permit.so</span><br><span class="line"></span><br><span class="line">password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=</span><br><span class="line">password    sufficient    pam_unix.so sha512 shadow nullok try_first_pass use_authtok</span><br><span class="line">password    required      pam_deny.so</span><br><span class="line"></span><br><span class="line">session     optional      pam_keyinit.so revoke</span><br><span class="line">session     required      pam_limits.so</span><br><span class="line">-session     optional      pam_systemd.so</span><br><span class="line">session     [success=1 default=ignore] pam_succeed_if.so service <span class="keyword">in</span> crond quiet use_uid</span><br><span class="line">session     required      pam_unix.so</span><br></pre></td></tr></table></figure><p>å‚æ•°è§£é‡Šï¼š</p><p>æ·»åŠ å‚æ•°ä»‹ç»ï¼šè®¾ç½®å¯†ç å°è¯•é”™è¯¯ä¸‰æ¬¡ï¼Œæ™®é€šç”¨æˆ·å’Œrootç”¨æˆ·éƒ½è¿›è¡Œé”å®šï¼Œæ™®é€šç”¨æˆ·é”å®š10ç§’ï¼Œrootç”¨æˆ·é”å®š10ç§’</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auth       required       pam_tally2.so    deny=3    unlock_time=10 even_deny_root root_unlock_time=10</span><br></pre></td></tr></table></figure><h3 id="äºŒ-ä¸‹æ–¹ä¸ºå…¶ä»–é…ç½®é¡¹å†…å®¹"><a href="#äºŒ-ä¸‹æ–¹ä¸ºå…¶ä»–é…ç½®é¡¹å†…å®¹" class="headerlink" title="äºŒ. ä¸‹æ–¹ä¸ºå…¶ä»–é…ç½®é¡¹å†…å®¹"></a>äºŒ. ä¸‹æ–¹ä¸ºå…¶ä»–é…ç½®é¡¹å†…å®¹</h3><h4 id="1ã€ç¼–è¯‘PAMçš„é…ç½®æ–‡ä»¶"><a href="#1ã€ç¼–è¯‘PAMçš„é…ç½®æ–‡ä»¶" class="headerlink" title="1ã€ç¼–è¯‘PAMçš„é…ç½®æ–‡ä»¶"></a>1ã€ç¼–è¯‘PAMçš„é…ç½®æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># vim /etc/pam.d/login</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line">auth    required    pam_tally2.so    deny=3    unlock_time=100 even_deny_root root_unlock_time=200</span><br><span class="line">auth [user_unknown=ignore success=ok ignore=ignore default=bad] pam_securetty.so</span><br><span class="line">auth       substack     system-auth</span><br><span class="line">auth       include      postlogin</span><br><span class="line">account    required     pam_nologin.so</span><br><span class="line">account    include      system-auth</span><br><span class="line">password   include      system-auth</span><br><span class="line"><span class="comment"># pam_selinux.so close should be the first session rule</span></span><br><span class="line">session    required     pam_selinux.so close</span><br><span class="line">session    required     pam_loginuid.so</span><br><span class="line">session    optional     pam_console.so</span><br><span class="line"><span class="comment"># pam_selinux.so open should only be followed by sessions to be executed in the user context</span></span><br><span class="line">session    required     pam_selinux.so open</span><br><span class="line">session    required     pam_namespace.so</span><br><span class="line">session    optional     pam_keyinit.so force revoke</span><br><span class="line">session    include      system-auth</span><br><span class="line">session    include      postlogin</span><br><span class="line">-session   optional     pam_ck_connector.so</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å„å‚æ•°ä»‹ç»ï¼š</p><blockquote><p>even_deny_root     ä¹Ÿé™åˆ¶rootç”¨æˆ·ï¼›<br>deny                      è®¾ç½®æ™®é€šç”¨æˆ·å’Œrootç”¨æˆ·è¿ç»­é”™è¯¯ç™»é™†çš„æœ€å¤§æ¬¡æ•°ï¼Œè¶…è¿‡æœ€å¤§æ¬¡æ•°ï¼Œåˆ™é”å®šè¯¥ç”¨æˆ·<br>unlock_time          è®¾å®šæ™®é€šç”¨æˆ·é”å®šåï¼Œå¤šå°‘æ—¶é—´åè§£é”ï¼Œå•ä½æ˜¯ç§’ï¼›<br>root_unlock_time  è®¾å®šrootç”¨æˆ·é”å®šåï¼Œå¤šå°‘æ—¶é—´åè§£é”ï¼Œå•ä½æ˜¯ç§’ï¼›<br>æ­¤å¤„ä½¿ç”¨çš„æ˜¯ pam_tally2 æ¨¡å—ï¼Œå¦‚æœä¸æ”¯æŒ pam_tally2 å¯ä»¥ä½¿ç”¨ pam_tally æ¨¡å—ã€‚å¦å¤–ï¼Œä¸åŒçš„pamç‰ˆæœ¬ï¼Œè®¾ç½®å¯èƒ½æœ‰æ‰€ä¸åŒï¼Œå…·ä½“ä½¿ç”¨æ–¹æ³•ï¼Œå¯ä»¥å‚ç…§ç›¸å…³æ¨¡å—çš„ä½¿ç”¨è§„åˆ™ã€‚</p></blockquote><p>åœ¨#%PAM-1.0çš„ä¸‹é¢ï¼Œå³ç¬¬äºŒè¡Œï¼Œæ·»åŠ å†…å®¹ï¼Œä¸€å®šè¦å†™åœ¨å‰é¢ï¼Œå¦‚æœå†™åœ¨åé¢ï¼Œè™½ç„¶ç”¨æˆ·è¢«é”å®šï¼Œä½†æ˜¯åªè¦ç”¨æˆ·è¾“å…¥æ­£ç¡®çš„å¯†ç ï¼Œè¿˜æ˜¯å¯ä»¥ç™»å½•çš„ï¼</p><p>æ·»åŠ å‚æ•°ä»‹ç»ï¼šè®¾ç½®å¯†ç å°è¯•é”™è¯¯ä¸‰æ¬¡ï¼Œæ™®é€šç”¨æˆ·å’Œrootç”¨æˆ·éƒ½è¿›è¡Œé”å®šï¼Œæ™®é€šç”¨æˆ·é”å®š100ç§’ï¼Œrootç”¨æˆ·é”å®š200ç§’</p><p><strong>/etc/pam.d/login</strong> â€”æœ€ç»ˆé…ç½®å›¾ï¼š</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_b79029648b226f7ff2cca46a85548223.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_b79029648b226f7ff2cca46a85548223.png"></p><h4 id="2ã€è¿™ä¸ªåªæ˜¯é™åˆ¶äº†ç”¨æˆ·ä»ttyç™»å½•ï¼Œè€Œæ²¡æœ‰é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œå¦‚æœæƒ³é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œéœ€è¦æ”¹sshdæ–‡ä»¶"><a href="#2ã€è¿™ä¸ªåªæ˜¯é™åˆ¶äº†ç”¨æˆ·ä»ttyç™»å½•ï¼Œè€Œæ²¡æœ‰é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œå¦‚æœæƒ³é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œéœ€è¦æ”¹sshdæ–‡ä»¶" class="headerlink" title="2ã€è¿™ä¸ªåªæ˜¯é™åˆ¶äº†ç”¨æˆ·ä»ttyç™»å½•ï¼Œè€Œæ²¡æœ‰é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œå¦‚æœæƒ³é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œéœ€è¦æ”¹sshdæ–‡ä»¶"></a>2ã€è¿™ä¸ªåªæ˜¯é™åˆ¶äº†ç”¨æˆ·ä»ttyç™»å½•ï¼Œè€Œæ²¡æœ‰é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œå¦‚æœæƒ³é™åˆ¶è¿œç¨‹ç™»å½•ï¼Œéœ€è¦æ”¹sshdæ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># vim /etc/pam.d/sshd</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line">auth    required    pam_tally2.so    deny=3    unlock_time=100 even_deny_root root_unlock_time=200</span><br><span class="line">auth       required     pam_sepermit.so</span><br><span class="line">auth       substack     password-auth</span><br><span class="line">auth       include      postlogin</span><br><span class="line"><span class="comment"># Used with polkit to reauthorize users in remote sessions</span></span><br><span class="line">-auth      optional     pam_reauthorize.so prepare</span><br><span class="line">account    required     pam_nologin.so</span><br><span class="line">account    include      password-auth</span><br><span class="line">password   include      password-auth</span><br><span class="line"><span class="comment"># pam_selinux.so close should be the first session rule</span></span><br><span class="line">session    required     pam_selinux.so close</span><br><span class="line">session    required     pam_loginuid.so</span><br><span class="line"><span class="comment"># pam_selinux.so open should only be followed by sessions to be executed in the user context</span></span><br><span class="line">session    required     pam_selinux.so open env_params</span><br><span class="line">session    required     pam_namespace.so</span><br><span class="line">session    optional     pam_keyinit.so force revoke</span><br><span class="line">session    include      password-auth</span><br><span class="line">session    include      postlogin</span><br><span class="line"><span class="comment"># Used with polkit to reauthorize users in remote sessions</span></span><br><span class="line">-session   optional     pam_reauthorize.so prepare</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>åŒæ ·æ˜¯å¢åŠ åœ¨ç¬¬2è¡Œï¼</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5dbaaaaf8233e87db4cc63de60cab88b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5dbaaaaf8233e87db4cc63de60cab88b.png"></p><p>æŸ¥çœ‹ç”¨æˆ·ç™»å½•å¤±è´¥çš„æ¬¡æ•°:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># pam_tally2 --user</span></span><br><span class="line">Login           Failures Latest failure     From</span><br><span class="line">aihuidi             6    06/20/19 10:11:07  192.168.200.186    åœ¨186è¿™ä¸ªipä¸Šæœ‰ä¸ªæ™®é€šç”¨æˆ·aihuidiç™»å½•å¤±è´¥</span><br></pre></td></tr></table></figure><p>è§£é”æŒ‡å®šç”¨æˆ·:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># pam_tally2 -r -u aihuidi    è§£é”aihuidiç”¨æˆ·</span></span><br><span class="line">Login           Failures Latest failure     From</span><br><span class="line">aihuidi             6    06/20/19 10:11:07  192.168.200.186</span><br><span class="line">[root@node2 ~ ]<span class="comment"># pam_tally2 --user     åœ¨è¿›è¡ŒæŸ¥çœ‹ç”¨æˆ·ç™»å½•å¤±è´¥æ¬¡æ•°</span></span><br><span class="line">[root@node2 ~ ]<span class="comment"># </span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>psï¼šè¿™ä¸ªè¿œç¨‹sshçš„æ—¶å€™ï¼Œè¾“å…¥å¯†ç é”™è¯¯è¶…è¿‡ä¸‰æ¬¡ä½†æ˜¯æ²¡æœ‰æç¤ºï¼Œæˆ‘ç”¨çš„æ˜¯Xshellï¼Œä¸çŸ¥é“å…¶å®ƒç»ˆç«¯æœ‰æ²¡æœ‰æç¤ºï¼Œä½†æ˜¯åªè¦è¶…è¿‡è®¾å®šçš„å€¼ï¼Œè¾“å…¥æ­£ç¡®çš„å¯†ç ä¹Ÿæ˜¯ç™»é™†ä¸äº†çš„ï¼ï¼Œè¿˜æ˜¯è¦ç­‰åˆ°è®¾å®šçš„æ—¶é—´åœ¨é‡æ–°å°è¯•è¾“å…¥æ­£ç¡®å¯†ç è¿›è¡Œç™»å½•è®¤è¯</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª</title>
      <link href="/2024/01/26/hexo%E5%B0%8F%E7%8C%AB%E5%92%AA%E4%B8%8E%E6%BC%AB%E7%94%BB%E5%AF%BC%E8%88%AA/"/>
      <url>/2024/01/26/hexo%E5%B0%8F%E7%8C%AB%E5%92%AA%E4%B8%8E%E6%BC%AB%E7%94%BB%E5%AF%BC%E8%88%AA/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h4 id="hexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª"><a href="#hexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª" class="headerlink" title="hexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª"></a>hexoå°çŒ«å’ªä¸æ¼«ç”»å¯¼èˆª</h4><p>è¯¦è§ï¼š<a href="https://tzy1997.com/articles/hexo1613/">è¯·æ”¶ä¸‹è¿™åªå¯çˆ±çš„çŒ«å’ªå§</a><br>è¯¦è§ï¼š<a href="https://www.fomal.cc/posts/5389e93f.html">æ¼«ç”»å¯¼èˆª</a></p><h3 id="ä¸€-å°çŒ«å’ª"><a href="#ä¸€-å°çŒ«å’ª" class="headerlink" title="ä¸€. å°çŒ«å’ª"></a>ä¸€. å°çŒ«å’ª</h3><p>åˆ¶ä½œä¸€ä¸ªç››æ”¾å†…å®¹çš„ç›’å­ï¼Œåœ¨<code>[BlogRoot]/node_modules/hexo-theme-butterfly/layout/includes/head.pug</code>(å¦‚æœæ˜¯<code>git clone</code> å®‰è£…åœ¨<code>[BlogRoot]/themes/butterfly/layout/includes/head.pug</code>)æœ€åä¸€è¡ŒåŠ å…¥å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">#myscoll</span></span><br></pre></td></tr></table></figure><p>å…¶å®éšä¾¿æ”¾åœ¨å“ªé‡Œéƒ½è¡Œï¼Œåªè¦èƒ½åŠ è½½å‡ºæ¥å°±è¡Œ</p><p>åœ¨<code>[BlogRoot]/node_modules/hexo-theme-butterfly/source/js</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª<code>cat.js</code>ï¼Œå°†ä»¥ä¸‹ä»£ç å¤åˆ¶åˆ°æ–‡ä»¶ä¸­ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span> &gt; <span class="number">992</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getBasicInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">/* çª—å£é«˜åº¦ */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">ViewH</span> = $(<span class="variable language_">window</span>).<span class="title function_">height</span>();</span><br><span class="line">        <span class="comment">/* documenté«˜åº¦ */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">DocH</span> = $(<span class="string">&quot;body&quot;</span>)[<span class="number">0</span>].<span class="property">scrollHeight</span>;</span><br><span class="line">        <span class="comment">/* æ»šåŠ¨çš„é«˜åº¦ */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">ScrollTop</span> = $(<span class="variable language_">window</span>).<span class="title function_">scrollTop</span>();</span><br><span class="line">        <span class="comment">/* å¯æ»šåŠ¨çš„é«˜åº¦ */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="variable constant_">S_V</span> = <span class="title class_">DocH</span> - <span class="title class_">ViewH</span>;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Band</span>_H = <span class="title class_">ScrollTop</span> / (<span class="title class_">DocH</span> - <span class="title class_">ViewH</span>) * <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="title class_">ViewH</span>: <span class="title class_">ViewH</span>,</span><br><span class="line">            <span class="title class_">DocH</span>: <span class="title class_">DocH</span>,</span><br><span class="line">            <span class="title class_">ScrollTop</span>: <span class="title class_">ScrollTop</span>,</span><br><span class="line">            <span class="title class_">Band</span><span class="attr">_H</span>: <span class="title class_">Band</span>_H,</span><br><span class="line">            <span class="attr">S_V</span>: <span class="variable constant_">S_V</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">show</span>(<span class="params">basicInfo</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (basicInfo.<span class="property">ScrollTop</span> &gt; <span class="number">0.001</span>) &#123;</span><br><span class="line">            $(<span class="string">&quot;.neko&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;display&#x27;</span>, <span class="string">&#x27;block&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $(<span class="string">&quot;.neko&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;display&#x27;</span>, <span class="string">&#x27;none&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    (<span class="keyword">function</span> (<span class="params">$</span>) &#123;</span><br><span class="line">        $.fn.<span class="property">nekoScroll</span> = <span class="keyword">function</span> (<span class="params">option</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> defaultSetting = &#123;</span><br><span class="line">                <span class="attr">top</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">                <span class="attr">scroWidth</span>: <span class="number">6</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                <span class="attr">z_index</span>: <span class="number">9999</span>,</span><br><span class="line">                <span class="attr">zoom</span>: <span class="number">0.9</span>,</span><br><span class="line">                <span class="attr">borderRadius</span>: <span class="number">5</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                <span class="attr">right</span>: <span class="number">60</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                <span class="comment">// è¿™é‡Œå¯ä»¥æ¢ä¸ºä½ å–œæ¬¢çš„å›¾ç‰‡ï¼Œä¾‹å¦‚æˆ‘å°±æ¢ä¸ºäº†é›ªäººï¼Œä½†æ˜¯è¦æŠ å›¾</span></span><br><span class="line">                <span class="attr">nekoImg</span>: <span class="string">&quot;https://bu.dusays.com/2022/07/20/62d812db74be9.png&quot;</span>,</span><br><span class="line">                <span class="attr">hoverMsg</span>: <span class="string">&quot;å–µå–µå–µ~&quot;</span>,</span><br><span class="line">                <span class="attr">color</span>: <span class="string">&quot;#6f42c1&quot;</span>,</span><br><span class="line">                <span class="attr">during</span>: <span class="number">500</span>,</span><br><span class="line">                <span class="attr">blog_body</span>: <span class="string">&quot;body&quot;</span>,</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">var</span> setting = $.<span class="title function_">extend</span>(defaultSetting, option);</span><br><span class="line">            <span class="keyword">var</span> getThis = <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;className&quot;</span>) !== <span class="string">&quot;&quot;</span> ? <span class="string">&quot;.&quot;</span> + <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;className&quot;</span>) : <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;id&quot;</span>) !== <span class="string">&quot;&quot;</span> ? <span class="string">&quot;#&quot;</span> +</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;id&quot;</span>) : <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;nodeName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ($(<span class="string">&quot;.neko&quot;</span>).<span class="property">length</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">after</span>(<span class="string">&quot;&lt;div class=\&quot;neko\&quot; id=&quot;</span> + setting.<span class="property">nekoname</span> + <span class="string">&quot; data-msg=\&quot;&quot;</span> + setting.<span class="property">hoverMsg</span> + <span class="string">&quot;\&quot;&gt;&lt;/div&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> basicInfo = <span class="title function_">getBasicInfo</span>();</span><br><span class="line">            $(getThis)</span><br><span class="line">                .<span class="title function_">css</span>(&#123;</span><br><span class="line">                    <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;width&#x27;</span>: setting.<span class="property">scroWidth</span>,</span><br><span class="line">                    <span class="string">&#x27;top&#x27;</span>: setting.<span class="property">top</span>,</span><br><span class="line">                    <span class="string">&#x27;height&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span>,</span><br><span class="line">                    <span class="string">&#x27;background-color&#x27;</span>: setting.<span class="property">bgcolor</span>,</span><br><span class="line">                    <span class="string">&quot;border-radius&quot;</span>: setting.<span class="property">borderRadius</span>,</span><br><span class="line">                    <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                    <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">scImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;-webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.1) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0.1) 75%, transparent 75%, transparent)&#x27;</span>, <span class="string">&#x27;border-radius&#x27;</span>: <span class="string">&#x27;2em&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;background-size&#x27;</span>: <span class="string">&#x27;contain&#x27;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                .<span class="title function_">css</span>(&#123;</span><br><span class="line">                    <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;top&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> - <span class="number">50</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span> * <span class="number">10</span>,</span><br><span class="line">                    <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                    <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">nekoImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="title function_">show</span>(<span class="title function_">getBasicInfo</span>());</span><br><span class="line">            $(<span class="variable language_">window</span>)</span><br><span class="line">                .<span class="title function_">scroll</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="keyword">let</span> basicInfo = <span class="title function_">getBasicInfo</span>();</span><br><span class="line">                    <span class="title function_">show</span>(basicInfo);</span><br><span class="line">                    $(getThis)</span><br><span class="line">                        .<span class="title function_">css</span>(&#123;</span><br><span class="line">                            <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;width&#x27;</span>: setting.<span class="property">scroWidth</span>,</span><br><span class="line">                            <span class="string">&#x27;top&#x27;</span>: setting.<span class="property">top</span>,</span><br><span class="line">                            <span class="string">&#x27;height&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span>,</span><br><span class="line">                            <span class="string">&#x27;background-color&#x27;</span>: setting.<span class="property">bgcolor</span>,</span><br><span class="line">                            <span class="string">&quot;border-radius&quot;</span>: setting.<span class="property">borderRadius</span>,</span><br><span class="line">                            <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                            <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">scImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;-webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.1) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0.1) 75%, transparent 75%, transparent)&#x27;</span>, <span class="string">&#x27;border-radius&#x27;</span>: <span class="string">&#x27;2em&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;background-size&#x27;</span>: <span class="string">&#x27;contain&#x27;</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                        .<span class="title function_">css</span>(&#123;</span><br><span class="line">                            <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;top&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> - <span class="number">50</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span> * <span class="number">10</span>,</span><br><span class="line">                            <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                            <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">nekoImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                        &#125;);</span><br><span class="line">                    <span class="keyword">if</span> (basicInfo.<span class="property">ScrollTop</span> == basicInfo.<span class="property">S_V</span>) &#123;</span><br><span class="line">                        $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                            .<span class="title function_">addClass</span>(<span class="string">&quot;showMsg&quot;</span>)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                            .<span class="title function_">removeClass</span>(<span class="string">&quot;showMsg&quot;</span>);</span><br><span class="line">                        $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                            .<span class="title function_">attr</span>(<span class="string">&quot;data-msg&quot;</span>, setting.<span class="property">hoverMsg</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                btf.<span class="title function_">scrollToDest</span>(<span class="number">0</span>, <span class="number">500</span>)</span><br><span class="line">            &#125;);</span><br><span class="line">            $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                .<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    btf.<span class="title function_">scrollToDest</span>(<span class="number">0</span>, <span class="number">500</span>)</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)(jQuery);</span><br><span class="line"></span><br><span class="line">    $(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//éƒ¨åˆ†è‡ªå®šä¹‰</span></span><br><span class="line">        $(<span class="string">&quot;#myscoll&quot;</span>).<span class="title function_">nekoScroll</span>(&#123;</span><br><span class="line">            <span class="attr">bgcolor</span>: <span class="string">&#x27;rgb(0 0 0 / .5)&#x27;</span>, <span class="comment">//èƒŒæ™¯é¢œè‰²ï¼Œæ²¡æœ‰ç»³å­èƒŒæ™¯å›¾ç‰‡æ—¶æœ‰æ•ˆ</span></span><br><span class="line">            <span class="attr">borderRadius</span>: <span class="string">&#x27;2em&#x27;</span>,</span><br><span class="line">            <span class="attr">zoom</span>: <span class="number">0.9</span></span><br><span class="line">        &#125;</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">//è‡ªå®šä¹‰ï¼ˆå»æ‰ä»¥ä¸‹æ³¨é‡Šï¼Œå¹¶æ³¨é‡Šæ‰å…¶ä»–çš„æŸ¥çœ‹æ•ˆæœï¼‰</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        $(&quot;#myscoll&quot;).nekoScroll(&#123;</span></span><br><span class="line"><span class="comment">            nekoname:&#x27;neko1&#x27;, //nekonameï¼Œç›¸å½“äºid</span></span><br><span class="line"><span class="comment">            nekoImg:&#x27;img/çŒ«å’ª.png&#x27;, //nekoçš„èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line"><span class="comment">            scImg:&quot;img/ç»³1.png&quot;, //ç»³å­çš„èƒŒæ™¯å›¾ç‰‡</span></span><br><span class="line"><span class="comment">            bgcolor:&#x27;#1e90ff&#x27;, //èƒŒæ™¯é¢œè‰²ï¼Œæ²¡æœ‰ç»³å­èƒŒæ™¯å›¾ç‰‡æ—¶æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">            zoom:0.9, //ç»³å­é•¿åº¦çš„ç¼©æ”¾å€¼</span></span><br><span class="line"><span class="comment">            hoverMsg:&#x27;ä½ å¥½~å–µ&#x27;, //é¼ æ ‡æµ®åŠ¨åˆ°nekoä¸Šæ–¹çš„å¯¹è¯æ¡†ä¿¡æ¯</span></span><br><span class="line"><span class="comment">            right:&#x27;100px&#x27;, //è·ç¦»é¡µé¢å³è¾¹çš„è·ç¦»</span></span><br><span class="line"><span class="comment">            fontFamily:&#x27;æ¥·ä½“&#x27;, //å¯¹è¯æ¡†å­—ä½“</span></span><br><span class="line"><span class="comment">            fontSize:&#x27;14px&#x27;, //å¯¹è¯æ¡†å­—ä½“çš„å¤§å°</span></span><br><span class="line"><span class="comment">            color:&#x27;#1e90ff&#x27;, //å¯¹è¯æ¡†å­—ä½“é¢œè‰²</span></span><br><span class="line"><span class="comment">            scroWidth:&#x27;8px&#x27;, //ç»³å­çš„å®½åº¦</span></span><br><span class="line"><span class="comment">            z_index:100, //ä¸ç”¨è§£é‡Šäº†å§</span></span><br><span class="line"><span class="comment">            during:1200, //ä»é¡¶éƒ¨åˆ°åº•éƒ¨æ»‘åŠ¨çš„æ—¶é•¿</span></span><br><span class="line"><span class="comment">        &#125;);</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>[BlogRoot]/node_modules/hexo-theme-butterfly/source/css</code>æ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ª<code>cat.css</code>ï¼Œå°†ä»¥ä¸‹ä»£ç å¤åˆ¶åˆ°æ–‡ä»¶ä¸­ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä¸æ–°å»º css æ–‡ä»¶ï¼Œå¤åˆ¶ä»£ç åˆ°<code>custom.css</code>ä¹Ÿè¡Œï¼Œæ€»ä¹‹æœ‰åœ°æ–¹å¼•å…¥å°±è¡Œã€‚</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-tag">body</span>::-webkit-scrollbar &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&quot;https://bu.dusays.com/2022/07/20/62d812db74be9.png&quot;</span>);</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-size</span>: contain;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">50%</span>);</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">font-family</span>: tzy;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#6f42c1</span>;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&quot;https://bu.dusays.com/2022/07/20/62d812d95e6f5.png&quot;</span>);</span><br><span class="line">    <span class="attribute">background-size</span>: contain;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">9999</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">115%</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-class">.showMsg</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="built_in">attr</span>(data-msg);</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="built_in">attr</span>(data-msg);</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-class">.fontColor</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @description: æ»šåŠ¨æ¡æ ·å¼  è·ŸçŒ«äºŒé€‰ä¸€</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">992px</span>) &#123;</span><br><span class="line">    ::-webkit-scrollbar &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">8px</span> <span class="meta">!important</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">8px</span> <span class="meta">!important</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-track &#123;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">2em</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">255</span> <span class="number">255</span> <span class="number">255</span> / .<span class="number">3</span>);</span><br><span class="line">        <span class="attribute">background-image</span>: <span class="built_in">-webkit-linear-gradient</span>(<span class="number">45deg</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>) <span class="number">25%</span>, transparent <span class="number">25%</span>, transparent <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>) <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>) <span class="number">75%</span>, transparent <span class="number">75%</span>, transparent);</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">2em</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-corner &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: transparent</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶<code>_config.butterfly.yml</code>ä¸­å¼•å…¥<code>cat.js</code>å’Œ<code>cat.css</code>ï¼Œå½“ç„¶è¿˜æœ‰åœ¨bottomçš„æœ€å‰é¢å¼•å…¥<code>jQuery</code>ï¼Œå› ä¸º<code>cat.js</code>çš„è¯­æ³•ä¾èµ–<code>jQuery</code>ã€‚</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/cat.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">src=&quot;https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">data-pjax</span> <span class="string">src=&quot;/js/cat.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€åé‡æ–°ç¼–è¯‘è¿è¡Œå³å¯çœ‹è§æ•ˆæœã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure><h3 id="äºŒ-æ¼«ç”»å¯¼èˆª"><a href="#äºŒ-æ¼«ç”»å¯¼èˆª" class="headerlink" title="äºŒ. æ¼«ç”»å¯¼èˆª"></a>äºŒ. æ¼«ç”»å¯¼èˆª</h3><p>é€‰æ‹©å–œæ¬¢çš„å›¾æ ‡ æ·»åŠ åˆ°é¡¹ç›® åœ¨<a href="https://www.iconfont.cn/">é˜¿é‡Œäº‘å›¾æ ‡åº“</a></p><p>åœ¨<code>[BlogRoot]\themes\butterfly\source\css\custom.css</code>ä¸­å¡«å†™å¦‚ä¸‹å†…å®¹ï¼Œå¼•å…¥Unicodeå’ŒFont-classçš„çº¿ä¸Šèµ„æºï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">@import</span> <span class="string">&quot;//at.alicdn.com/t/c/font_4426032_sy4sytzuoj9.css&quot;</span><span class="string">;</span></span><br></pre></td></tr></table></figure><p>æ›´æ¨èåœ¨åœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶<code>inject</code>é…ç½®é¡¹è¿›è¡Œå…¨å±€å¼•å…¥ï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;//at.alicdn.com/t/c/font_4426032_sy4sytzuoj9.css&quot;</span> <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;//at.alicdn.com/t/c/font_4426032_sy4sytzuoj9.js&quot;&gt;&lt;/script&gt;</span> </span><br></pre></td></tr></table></figure><p>åŒæ—¶å¯ä»¥åœ¨è‡ªå®šä¹‰<code>CSS</code>ä¸­æ·»åŠ å¦‚ä¸‹æ ·å¼æ¥æ§åˆ¶å›¾æ ‡é»˜è®¤å¤§å°å’Œé¢œè‰²ç­‰å±æ€§ï¼ˆ<strong>è‹¥å·²ç»åœ¨é¡¹ç›®è®¾ç½®ä¸­å‹¾é€‰äº†å½©è‰²é€‰é¡¹ï¼Œåˆ™æ— éœ€å†å®šä¹‰å›¾æ ‡é¢œè‰²</strong>ï¼‰ï¼Œå†™æ³•ä¸å­—ä½“æ ·å¼ç±»ä¼¼ï¼Œè¿™ææ€•ä¹Ÿæ˜¯å®ƒè¢«ç§°ä¸º<code>iconfont</code>ï¼ˆå›¾æ ‡å­—ä½“ï¼‰çš„åŸå› :</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.iconfont</span> &#123;</span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">&quot;iconfont&quot;</span> <span class="type">!important;</span></span><br><span class="line">  <span class="string">/*</span> <span class="string">è¿™é‡Œå¯ä»¥è‡ªå®šä¹‰å›¾æ ‡å¤§å°</span> <span class="string">*/</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="string">3em;</span></span><br><span class="line">  <span class="attr">font-style:</span> <span class="string">normal;</span></span><br><span class="line">  <span class="string">-webkit-font-smoothing:</span> <span class="string">antialiased;</span></span><br><span class="line">  <span class="string">-moz-osx-font-smoothing:</span> <span class="string">grayscale;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æœ€åå®šä¹‰å¯¼èˆªæ </p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">ä¸»é¡µ:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-shouye</span>              <span class="comment">#fas fa-home</span></span><br><span class="line">  <span class="string">åˆ†ç±»:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-fenlei</span> <span class="comment">#fa fa-archive</span></span><br><span class="line">  <span class="string">æ ‡ç­¾:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-biaoqian</span>     <span class="comment">#fa fa-tags</span></span><br><span class="line">  <span class="string">å½’æ¡£:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-guidang</span>  <span class="comment">#fa fa-folder-open</span></span><br><span class="line">  <span class="string">å‹é“¾:</span> <span class="string">/link/</span>    <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-kafei</span>  <span class="comment"># fa fa-link</span></span><br><span class="line">  <span class="string">ç•™è¨€æ¿:</span> <span class="string">https://gegewu-cloud.github.io/2023/05/23/ç•™è¨€æ¿/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-lishiliuyan</span> <span class="comment">#fa fa-paper-plane</span></span><br><span class="line">  <span class="string">å…³äº:</span> <span class="string">https://gegewu-cloud.github.io/2023/05/22/å…³äº/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-xing</span> <span class="comment">#fas fa-heart </span></span><br></pre></td></tr></table></figure><p>æ•ˆæœ</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_4b90daa3afa9713b09d6c5b78cbb6671.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_4b90daa3afa9713b09d6c5b78cbb6671.png"></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl</title>
      <link href="/2024/01/25/%E6%B8%85%E7%90%86systemd%E6%97%A5%E5%BF%97%E4%B9%8Bjournalctl/"/>
      <url>/2024/01/25/%E6%B8%85%E7%90%86systemd%E6%97%A5%E5%BF%97%E4%B9%8Bjournalctl/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl"><a href="#æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl" class="headerlink" title="æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl"></a>æ¸…ç†systemdæ—¥å¿—ä¹‹journalctl</h2><p>å‚è€ƒæ–‡çŒ®</p><p><a href="https://itlanyan.com/clear-systemd-journal-logs/">https://itlanyan.com/clear-systemd-journal-logs/</a></p><p><strong>systemd journal</strong>ä¹‹äº<code>systemd</code>çŠ¹å¦‚<strong>syslog</strong>ä¹‹äº<code>init</code>ï¼Œå…¶æ—¥å¿—æ–‡ä»¶ä¿å­˜åœ¨ <strong>/var/log/journal</strong> ç›®å½•ä¸‹ã€‚éšç€æ—¶é—´çš„æµé€ï¼Œè¯¥ç›®å½•ä¸‹ä¼šç§¯ç´¯å¤§é‡æ—¥å¿—æ–‡ä»¶ï¼Œå ç”¨ä¸å°‘çš„ç£ç›˜ç©ºé—´ã€‚å¦‚æœç¡¬ç›˜å®¹é‡è¾ƒå°æˆ–å¯ç”¨ç©ºé—´ç´§å¼ ï¼Œå¯ä»¥è€ƒè™‘æ¸…ç†è¿‡æœŸæ—¥å¿—é‡Šæ”¾å ç”¨çš„ç©ºé—´ã€‚</p><p>æœ¬æ–‡ä»‹ç»æ¸…ç†<a href="https://itlanyan.com/tag/systemd/">systemd</a>æ—¥å¿—çš„æ–¹æ³•ã€‚</p><h3 id="æ¸…ç†systemdæ—¥å¿—"><a href="#æ¸…ç†systemdæ—¥å¿—" class="headerlink" title="æ¸…ç†systemdæ—¥å¿—"></a>æ¸…ç†systemdæ—¥å¿—</h3><p><a href="https://itlanyan.com/clear-systemd-journal-logs/#bnp_indexs">è¿”å›ç›®å½•</a></p><p>æ¸…ç†ä¹‹å‰ï¼Œå¯æŸ¥çœ‹ä¸€ä¸‹systemdæ—¥å¿—æ‰€å ç”¨çš„ç£ç›˜ç©ºé—´ã€‚æ—¢å¯ä»¥ç”¨å¸¸ç”¨çš„ <code>&lt;span class=&quot;pln&quot;&gt;du&lt;/span&gt;</code> å‘½ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo du -sh /var/log/journal/</span><br><span class="line"># ç¤ºä¾‹è¾“å‡º</span><br><span class="line"># 3.9G /var/log/journal/</span><br></pre></td></tr></table></figure><p>ä½†æ›´æ¨èä½¿ç”¨systemdæ—¥å¿—ç®¡ç†ä¸“ç”¨å‘½ä»¤ <code>&lt;span class=&quot;pln&quot;&gt;journalctl&lt;/span&gt;</code>ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">journalctl --disk-usage</span><br><span class="line"># ç¤ºä¾‹è¾“å‡º</span><br><span class="line"># Archived and active journals take up 3.9G on disk.</span><br></pre></td></tr></table></figure><p>çŸ¥é“äº†æ—¥å¿—å ç”¨çš„ç£ç›˜ç©ºé—´ï¼Œæ¥ä¸‹æ¥ä¾¿å¯ä»¥æ¸…ç†è¿‡æœŸæ—¥å¿—ã€‚å¼€å§‹ä¹‹å‰ï¼Œå»ºè®® <code>&lt;span class=&quot;pln&quot;&gt;rotate&lt;/span&gt;</code> å½“å‰æ—¥å¿—(rotateæ˜¯æ—¥å¿—æ“ä½œä¸­çš„ä¸€ä¸ªæœ¯è¯­ï¼Œå…¶å½’æ¡£æ—§æ—¥å¿—ï¼Œåç»­æ—¥å¿—å†™å…¥æ–°åˆ›å»ºçš„æ—¥å¿—æ–‡ä»¶ä¸­)ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo journalctl --rotate</span><br></pre></td></tr></table></figure><p><code>&lt;span class=&quot;pln&quot;&gt;journalctl&lt;/span&gt;</code>æä¾›äº†ä¸‰ç§æ¸…ç†systemdæ—¥å¿—çš„æ–¹å¼ã€‚ç¬¬ä¸€ç§æ˜¯æ¸…ç†æŒ‡å®šæ—¶é—´ä¹‹å‰çš„æ—¥å¿—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># æ¸…ç†7å¤©ä¹‹å‰çš„æ—¥å¿—</span><br><span class="line">sudo journalctl --vacuum-time=7d</span><br><span class="line"># æ¸…ç†2å°æ—¶ä¹‹å‰çš„æ—¥å¿—</span><br><span class="line">sudo journactl --vacuum-time=2h</span><br><span class="line"># æ¸…ç†10ç§’ä¹‹å‰çš„æ—¥å¿—</span><br><span class="line">sudo journalctl --vacuum-time=10s</span><br><span class="line"># ä¸Šè¿°å‘½ä»¤ç¤ºä¾‹è¾“å‡ºï¼š</span><br><span class="line"># Vacuuming done, freed 3.7G of archived journals on disk.</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ˜¯é™åˆ¶æ—¥å¿—å ç”¨çš„ç©ºé—´å¤§å°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># é™åˆ¶systemdæ—¥å¿—å ç”¨ä¸è¶…è¿‡1Gç©ºé—´</span><br><span class="line">sudo journalctl --vacuum-size=1G</span><br><span class="line"># é™åˆ¶systemdæ—¥å¿—å ç”¨ä¸è¶…è¿‡100M</span><br><span class="line">sudo journalctl --vacuum-size=100M</span><br><span class="line"># è¾“å‡ºä¸ç¬¬ä¸€ç§ç±»ä¼¼</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸‰ç§æ˜¯ä¿ç•™æ—¥å¿—æ–‡ä»¶ä¸ªæ•°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># ä¿ç•™æœ€è¿‘çš„5ä¸ªæ—¥å¿—æ–‡ä»¶</span><br><span class="line">sudo journalctl --vacuum-files=5</span><br><span class="line"># è¾“å‡ºä¸ç¬¬ä¸€ç§ç±»ä¼¼</span><br></pre></td></tr></table></figure><p>ä¸çŸ¥é“ <code>journalctl</code> ç®¡ç†æ—¥å¿—åŠŸèƒ½ä¹‹å‰ï¼Œæœ¬äººç”¨è¿‡ <code>find é…åˆ </code><span class="kwd">exec</span><code> (æˆ–è€…ç®¡é“åŠ </code><span class="pln">xargs</span>`)çš„åœŸåŠæ³•æ¸…ç†è¿‡æœŸæ—¥å¿—ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># åˆ é™¤7å¤©å‰çš„æ—¥å¿—</span><br><span class="line">find /var/log/journal -mtime +7 -exec rm -rf &#123;&#125; \;</span><br></pre></td></tr></table></figure><h3 id="ä¸€åŠ³æ°¸é€¸çš„åŠæ³•"><a href="#ä¸€åŠ³æ°¸é€¸çš„åŠæ³•" class="headerlink" title="ä¸€åŠ³æ°¸é€¸çš„åŠæ³•"></a>ä¸€åŠ³æ°¸é€¸çš„åŠæ³•</h3><p><a href="https://itlanyan.com/clear-systemd-journal-logs/#bnp_indexs">è¿”å›ç›®å½•</a></p><p>ä¸Šæ–‡ä»‹ç»çš„æ¸…ç†systemdæ—¥å¿—æ–¹æ³•é€‚åˆä¸€æ¬¡æ€§æ‰‹åŠ¨ç®¡ç†ï¼Œé‡å¤åšå°±æ²¡æ„æ€äº†ã€‚ä¸€åŠ³æ°¸é€¸çš„åŠæ³•æ˜¯é…ç½®systemd journalï¼Œè®©å…¶è‡ªåŠ¨ç®¡ç†æ—¥å¿—ï¼Œä¸å ç”¨è¿‡å¤šç£ç›˜ç©ºé—´ã€‚</p><p>æ–¹æ³•æ˜¯ç¼–è¾‘ <strong>/etc/systemd/journald.conf</strong> æ–‡ä»¶ï¼Œå¯¹å…¶ä¸­çš„å‚æ•°è¿›è¡Œè®¾ç½®ã€‚ä¾‹å¦‚é™åˆ¶æ—¥å¿—æœ€å¤§å ç”¨1Gç©ºé—´ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[Journal]</span><br><span class="line">#Storage=auto</span><br><span class="line">#Compress=yes</span><br><span class="line">#Seal=yes</span><br><span class="line">#SplitMode=uid</span><br><span class="line">#SyncIntervalSec=5m</span><br><span class="line">#RateLimitInterval=30s</span><br><span class="line">#RateLimitBurst=1000</span><br><span class="line">SystemMaxUse=1G</span><br><span class="line">#SystemKeepFree=</span><br><span class="line">#SystemMaxFileSize=</span><br><span class="line">#RuntimeMaxUse=</span><br><span class="line">#RuntimeKeepFree=</span><br><span class="line">#RuntimeMaxFileSize=</span><br></pre></td></tr></table></figure><p>ä¿å­˜é…ç½®æ–‡ä»¶åè®°å¾—é‡æ–°åŠ è½½ï¼š<code>sudo systemctl restart systemd-journald</code></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://itlanyan.com/clear-systemd-journal-logs/#bnp_indexs">è¿”å›ç›®å½•</a></p><ol><li><a href="https://linuxhandbook.com/clear-systemd-journal-logs/">How to Clear Systemd Journal Logs</a></li><li><a href="https://itlanyan.com/find-files-in-linux/">Linuxæ–‡ä»¶æŸ¥æ‰¾</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockeræ–¹å¼éƒ¨ç½²qexo</title>
      <link href="/2024/01/24/docker%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2qexo/"/>
      <url>/2024/01/24/docker%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2qexo/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="dockeræ–¹å¼éƒ¨ç½²qexoğŸ˜˜"><a href="#dockeræ–¹å¼éƒ¨ç½²qexoğŸ˜˜" class="headerlink" title="dockeræ–¹å¼éƒ¨ç½²qexoğŸ˜˜"></a>dockeræ–¹å¼éƒ¨ç½²qexoğŸ˜˜</h2><h4 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h4><p><a href="https://github.com/Qexo/Qexo.git">https://github.com/Qexo/Qexo.git</a>                   (æºç æ–‡ä»¶)<br><a href="https://www.yyds.space/posts/3dfeb390abb4">https://www.yyds.space/posts/3dfeb390abb4</a></p><h4 id="æ¦‚è§ˆï¼š"><a href="#æ¦‚è§ˆï¼š" class="headerlink" title="æ¦‚è§ˆï¼š"></a>æ¦‚è§ˆï¼š</h4><ul><li><p>ä½¿ç”¨Dockerfileæ–‡ä»¶æ„å»ºé•œåƒ</p></li><li><p>å¯åŠ¨å®¹å™¨</p></li><li><p>æ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ</p></li><li><p>åˆ›å»ºæ‰€éœ€ç›®å½•åŠæ–‡ä»¶</p></li><li><p>å¦‚ä¸æƒ³äº†è§£é•œåƒåˆ¶ä½œè¿‡ç¨‹å¯ç›´æ¥ä½¿ç”¨æ­¤docker-compose.ymlæ–‡ä»¶å¯åŠ¨qexoæœåŠ¡<br>é•œåƒå¯é€‰â€œ<strong>registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.0.2</strong>â€<br>docker-compose.ymlæ–‡ä»¶(éœ€è¦ä¿®æ”¹<strong>config.py</strong>æ–‡ä»¶å°†è‡ªå·±çš„æœºå™¨<strong>IP</strong>æˆ–<strong>åŸŸå</strong>åŠ å…¥  |  å…³äº<strong>db.sqlite3</strong>åªéœ€è¦åœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ªåä¸º<strong>db.sqlite3</strong>çš„ç©ºæ–‡ä»¶å³å¯ğŸ˜ )</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">qexo:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.0.2</span> </span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">qexo</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8000:8000&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./db.sqlite3:/app/db/db.sqlite3</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./blog:/app/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./configs.py:/app/configs.py</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="1-åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶"><a href="#1-åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶" class="headerlink" title="1. åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶"></a>1. åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºé…ç½®æ–‡ä»¶ç›®å½•åŠç©ºæ•°æ®åº“æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /app/db /app/data</span><br><span class="line"><span class="built_in">touch</span>    /app/db/db.sqlite3</span><br><span class="line"><span class="comment"># åˆ›å»ºDockerfileå·¥ä½œç›®å½•</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /data/qexo</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/qexo/db</span><br><span class="line"><span class="built_in">cd</span> /data/qexo/db &amp;&amp; <span class="built_in">touch</span> db.sqlite3</span><br><span class="line"><span class="comment"># å°†Qexoæºç æ–‡ä»¶ä¸Šä¼ è‡³å·¥ä½œç›®å½• å¹¶æ‰“åŒ…ä¸ºtar.gzæ ¼å¼æ–‡ä»¶</span></span><br><span class="line"><span class="built_in">cd</span> /data/qexo &amp;&amp; rz</span><br><span class="line"><span class="comment"># é…ç½®ç¼–æ’æ–‡ä»¶</span></span><br><span class="line">vim Dockerfile</span><br></pre></td></tr></table></figure><p><strong>2. Dockerfileæ–‡ä»¶</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">FROM python:3.11.3-alpine</span><br><span class="line"><span class="comment"># ç»´æŠ¤è€…ä¿¡æ¯</span></span><br><span class="line">LABEL maintainer=<span class="string">&quot;xwgegewu@gmail.com&quot;</span></span><br><span class="line"><span class="comment"># è®¾ç½®ç”Ÿäº§æ¨¡å¼ç¯å¢ƒå˜é‡ </span></span><br><span class="line"><span class="comment"># ENV APP_ENV production</span></span><br><span class="line"><span class="comment"># pipyæºè®¾ç½®</span></span><br><span class="line">RUN pip config <span class="built_in">set</span> global.index-url https://mirrors.cloud.tencent.com/pypi/simple/</span><br><span class="line"><span class="comment"># è®¾ç½®æ—¶åŒº</span></span><br><span class="line">RUN sed -i <span class="string">&#x27;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#x27;</span> /etc/apk/repositories &amp;&amp; \</span><br><span class="line">    apk --no-cache add tzdata &amp;&amp; \</span><br><span class="line">    <span class="built_in">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; \</span><br><span class="line">    apk --no-cache del tzdata &amp;&amp; \</span><br><span class="line">    apk --no-cache add git &amp;&amp; \</span><br><span class="line">    <span class="built_in">mkdir</span> /app</span><br><span class="line"><span class="comment"># è®¾ç½®å·¥ä½œç›®å½•</span></span><br><span class="line">WORKDIR /app</span><br><span class="line"><span class="comment"># æ‹·è´æ•°æ®</span></span><br><span class="line"><span class="comment"># RUN git clone https://github.com/Qexo/Qexo.git /app</span></span><br><span class="line">ADD ./Qexo.tar.gz /app/</span><br><span class="line">RUN <span class="built_in">mv</span> /app/Qexo/* /app/</span><br><span class="line"><span class="comment"># å®‰è£…ä¾èµ–</span></span><br><span class="line">RUN pip install --upgrade pip </span><br><span class="line">RUN apk --no-cache add build-base python3-dev libffi-dev</span><br><span class="line">RUN pip install Django==3.2.18</span><br><span class="line">RUN pip install PyMySQL==1.0.2</span><br><span class="line">RUN pip install boto3==1.26.94</span><br><span class="line">RUN pip install requests==2.28.2</span><br><span class="line">RUN pip install PyGithub==1.58.1</span><br><span class="line">RUN pip install python-gitlab==3.13.0</span><br><span class="line">RUN pip install html2text==2020.1.16</span><br><span class="line">RUN pip install PyYAML</span><br><span class="line">RUN pip install urllib3==1.26.15</span><br><span class="line">RUN pip install Markdown==3.4.1</span><br><span class="line">RUN pip install djongo==1.3.6</span><br><span class="line">RUN pip install django-cors-headers==3.14.0</span><br><span class="line">RUN pip install pymongo==3.13.0</span><br><span class="line">RUN pip install dnspython==2.2.1</span><br><span class="line">RUN pip install sqlparse==0.2.4</span><br><span class="line">RUN pip install psycopg2-binary==2.9.5</span><br><span class="line">RUN pip install cryptography==39.0.2</span><br><span class="line">RUN pip install pyopenssl==23.0.0</span><br><span class="line">RUN pip install oss2==2.17.0</span><br><span class="line">RUN pip install beautifulsoup4==4.11.2</span><br><span class="line"><span class="comment"># æ‹·è´å¯åŠ¨è„šæœ¬</span></span><br><span class="line">COPY . /app/</span><br><span class="line">RUN <span class="built_in">chmod</span> +x /app/run.sh</span><br><span class="line"><span class="comment"># æš´éœ²ç«¯å£</span></span><br><span class="line">EXPOSE 8000</span><br><span class="line"><span class="comment"># æŒ‚è½½ç›®å½•</span></span><br><span class="line">VOLUME [<span class="string">&quot;/app/db&quot;</span>, <span class="string">&quot;/app/data&quot;</span>]</span><br><span class="line"><span class="comment"># å¯åŠ¨django</span></span><br><span class="line">ENTRYPOINT [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;/app/run.sh&quot;</span>]</span><br></pre></td></tr></table></figure><h4 id="3-åœ¨-data-qexoåˆ›å»ºé…ç½®æ–‡ä»¶"><a href="#3-åœ¨-data-qexoåˆ›å»ºé…ç½®æ–‡ä»¶" class="headerlink" title="3. åœ¨/data/qexoåˆ›å»ºé…ç½®æ–‡ä»¶"></a>3. åœ¨/data/qexoåˆ›å»ºé…ç½®æ–‡ä»¶</h4><h5 id="configs-py"><a href="#configs-py" class="headerlink" title="configs.py"></a>configs.py</h5><p><strong>DOMAINS</strong>å¤„éœ€è¦åŠ ä¸Šè‡ªå·±çš„æœ¬æœº<strong>IP</strong>æˆ–è€…<strong>åŸŸå</strong> ç›¸å½“äºè®¾ç½®ç™½åå•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd /data/qexo &amp;&amp; vim configs.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•°æ®åº“é…ç½®</span></span><br><span class="line"><span class="keyword">import</span> pymysql,os</span><br><span class="line"></span><br><span class="line">DOMAINS = [<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;10.0.0.10&quot;</span>]</span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.sqlite3&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: os.path.join(<span class="string">&#x27;/app/db&#x27;</span> , <span class="string">&#x27;db.sqlite3&#x27;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="run-sh"><a href="#run-sh" class="headerlink" title="run.sh"></a>run.sh</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">python3 manage.py makemigrations</span><br><span class="line">python3 manage.py migrate</span><br><span class="line">python3 manage.py runserver 0.0.0.0:8000 --noreload</span><br></pre></td></tr></table></figure><h5 id="æ„å»ºdockeré•œåƒ-å¯åŠ¨å®¹å™¨"><a href="#æ„å»ºdockeré•œåƒ-å¯åŠ¨å®¹å™¨" class="headerlink" title="æ„å»ºdockeré•œåƒ å¯åŠ¨å®¹å™¨"></a>æ„å»ºdockeré•œåƒ å¯åŠ¨å®¹å™¨</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ„å»º</span></span><br><span class="line">docker build -t qexo:3.0.2 .</span><br><span class="line"><span class="comment"># å¯åŠ¨å®¹å™¨</span></span><br><span class="line">docker run -d --name qexo -p 8000:8000 -v /data/qexo/db:/app/db -v /data/blog:/app/data qexo:3.0.2</span><br></pre></td></tr></table></figure><h5 id="æŸ¥çœ‹dockeræ—¥å¿—æ˜¯å¦æˆåŠŸè¿è¡Œ"><a href="#æŸ¥çœ‹dockeræ—¥å¿—æ˜¯å¦æˆåŠŸè¿è¡Œ" class="headerlink" title="æŸ¥çœ‹dockeræ—¥å¿—æ˜¯å¦æˆåŠŸè¿è¡Œ"></a>æŸ¥çœ‹dockeræ—¥å¿—æ˜¯å¦æˆåŠŸè¿è¡Œ</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">docker logs qexo</span><br><span class="line"></span><br><span class="line">è·å–æœ¬åœ°é…ç½®æ–‡ä»¶æˆåŠŸ, ä½¿ç”¨æœ¬åœ°æ•°æ®åº“é…ç½®</span><br><span class="line">           _               _ </span><br><span class="line">     /\   | |             | |</span><br><span class="line">    /  \  | |__  _   _  __| |_   _ </span><br><span class="line">   / /\ \ | |_ \| | | |/ _| | | | |</span><br><span class="line">  / ____ \| |_) | |_| | (_| | |_| |</span><br><span class="line"> /_/    \_\____/ \____|\____|\____|</span><br><span class="line">å½“å‰ç¯å¢ƒ: æœ¬åœ°</span><br><span class="line">Operations to perform:</span><br><span class="line">  Apply all migrations: auth, contenttypes, hexoweb, sessions</span><br><span class="line">Running migrations:</span><br><span class="line">  No migrations to apply.</span><br><span class="line">[25/Jan/2024 07:11:16] ERROR: Providerè·å–å¤±è´¥, è·³è¿‡(functions.py.&lt;module&gt;[line:55])</span><br><span class="line">[25/Jan/2024 07:11:40] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 302 0</span><br><span class="line">[25/Jan/2024 07:11:40] INFO: æœªæ£€æµ‹åˆ°åˆå§‹åŒ–é…ç½®, è½¬è·³åˆ°åˆå§‹åŒ–é¡µé¢(views.py.login_view[line:40])</span><br><span class="line">[25/Jan/2024 07:11:40] <span class="string">&quot;GET /login/?next=/ HTTP/1.1&quot;</span> 302 0</span><br><span class="line">[25/Jan/2024 07:11:40] INFO: ä¿å­˜è®¾ç½®CDN_PREV =&gt; https://unpkg.com/(functions.py.save_setting[line:259])</span><br><span class="line">[25/Jan/2024 07:11:40] INFO: ä¿å­˜è®¾ç½®QEXO_NAME =&gt; Hexoç®¡ç†é¢æ¿(functions.py.save_setting[line:259])</span><br></pre></td></tr></table></figure><p>æµè§ˆå™¨è®¿é—®: http://æœ¬æœºIP:8000 å®Œæˆå„é¡¹åˆå§‹åŒ–ç­‰é…ç½®ã€‚</p><h4 id="4-æœ€åæ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ-ç•¥-å¹¶ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæ„å»ºå®¹å™¨"><a href="#4-æœ€åæ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ-ç•¥-å¹¶ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæ„å»ºå®¹å™¨" class="headerlink" title="4. æœ€åæ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ(ç•¥)å¹¶ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæ„å»ºå®¹å™¨"></a>4. æœ€åæ¨é€åˆ°é˜¿é‡Œäº‘é•œåƒæ ˆ(ç•¥)å¹¶ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒæ„å»ºå®¹å™¨</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker login ....</span><br><span class="line">docker tag .....</span><br><span class="line">docker push .....</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> qexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> qexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos7é‡ç½®å¯†ç </title>
      <link href="/2024/01/24/centos7%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/"/>
      <url>/2024/01/24/centos7%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>centos7é‡ç½®å¯†ç </strong></p><h4 id="å‚è€ƒï¼š"><a href="#å‚è€ƒï¼š" class="headerlink" title="å‚è€ƒï¼š"></a>å‚è€ƒï¼š</h4><p><a href="https://blog.csdn.net/gnail_oug/article/details/94721777">https://blog.csdn.net/gnail_oug/article/details/94721777</a></p><h4 id="ç¯å¢ƒï¼š"><a href="#ç¯å¢ƒï¼š" class="headerlink" title="ç¯å¢ƒï¼š"></a>ç¯å¢ƒï¼š</h4><p>centos7.6 / 7.9 é‡ç½®å¯†ç </p><h4 id="æè¿°"><a href="#æè¿°" class="headerlink" title="æè¿°"></a>æè¿°</h4><p>å½“<strong>root</strong>å¯†ç å¿˜äº†ä¹‹åï¼Œå¯ä»¥é€šè¿‡é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºæ—¶é‡æ–°è®¾ç½®å¯†ç ã€‚æ³¨ï¼šæµ‹è¯•ç‰ˆæœ¬ä¸º**CentOS Linux release 7.6.1810 (Core)**ï¼Œå…¶ä»–ç‰ˆæœ¬å¯èƒ½æœ‰äº›åŒºåˆ«ã€‚</p><h4 id="é‡ç½®å¯†ç "><a href="#é‡ç½®å¯†ç " class="headerlink" title="é‡ç½®å¯†ç "></a>é‡ç½®å¯†ç </h4><h5 id="1ã€é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºè¿‡ç¨‹ä¸­ï¼Œå‡ºç°ä»¥ä¸‹ç•Œé¢æ—¶æŒ‰eé”®ï¼Œè¿›å…¥ç¼–è¾‘ç•Œé¢"><a href="#1ã€é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºè¿‡ç¨‹ä¸­ï¼Œå‡ºç°ä»¥ä¸‹ç•Œé¢æ—¶æŒ‰eé”®ï¼Œè¿›å…¥ç¼–è¾‘ç•Œé¢" class="headerlink" title="1ã€é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºè¿‡ç¨‹ä¸­ï¼Œå‡ºç°ä»¥ä¸‹ç•Œé¢æ—¶æŒ‰eé”®ï¼Œè¿›å…¥ç¼–è¾‘ç•Œé¢"></a>1ã€é‡å¯ç³»ç»Ÿï¼Œåœ¨å¼€æœºè¿‡ç¨‹ä¸­ï¼Œå‡ºç°ä»¥ä¸‹ç•Œé¢æ—¶æŒ‰eé”®ï¼Œè¿›å…¥ç¼–è¾‘ç•Œé¢</h5><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_56eb784c63c8b82f62e62f1b5752d680.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_56eb784c63c8b82f62e62f1b5752d680.png"></p><h5 id="2ã€ä¿®æ”¹é…ç½®ä¿®æ”¹å¯†ç "><a href="#2ã€ä¿®æ”¹é…ç½®ä¿®æ”¹å¯†ç " class="headerlink" title="2ã€ä¿®æ”¹é…ç½®ä¿®æ”¹å¯†ç "></a>2ã€ä¿®æ”¹é…ç½®ä¿®æ”¹å¯†ç </h5><ul><li>æŒ‰æ–¹å‘é”®ä¸‹é”®â†“ï¼Œæ‰¾åˆ°è®¾ç½®è¯­è¨€çš„åœ°æ–¹ï¼Œå¦‚<strong>LANG=en_US.UTF-8</strong> åœ¨åé¢è¿½åŠ <strong>rw single init=/bin/bash,<strong>ç„¶åæŒ‰</strong>ctrl+x</strong>é‡å¯ç³»ç»Ÿ</li><li>è¿›å…¥<strong>bash</strong>ç•Œé¢åï¼Œå¯ä»¥è¾“å…¥<strong>passwd</strong>å‘½ä»¤é‡æ–°è®¾ç½®<strong>root</strong>å¯†ç </li><li>å¦‚æœå¼€å¯äº†<strong>SELinux</strong>ï¼Œæ‰§è¡Œå‘½ä»¤<strong>touch /.autorelabel</strong>å‘½ä»¤</li><li>è¾“å…¥<strong>exec /sbin/init</strong>å‘½ä»¤é‡å¯ç³»ç»Ÿ ä½¿ç”¨æ–°è®¾ç½®çš„å¯†ç è¿›å…¥ç³»ç»Ÿä¹‹åï¼Œä¸ºäº†å®‰å…¨èµ·è§ï¼Œå¯ä»¥è¾“å…¥<strong>reboot</strong>é‡æ–°å¯åŠ¨ä¸€æ¬¡ç³»ç»Ÿã€‚</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5f98f5afcf72816ec0aeff6ad4f81deb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5f98f5afcf72816ec0aeff6ad4f81deb.png"></p><p>æ­¤æ—¶æˆåŠŸï¼</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linuxå¸¦å®½ç½‘å¡æµé‡ç›‘æ§å·¥å…·nethogsä½¿ç”¨</title>
      <link href="/2024/01/22/linux%E5%B8%A6%E5%AE%BD%E7%BD%91%E5%8D%A1%E6%B5%81%E9%87%8F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7nethogs%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/01/22/linux%E5%B8%A6%E5%AE%BD%E7%BD%91%E5%8D%A1%E6%B5%81%E9%87%8F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7nethogs%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>linuxå¸¦å®½ç½‘å¡æµé‡ç›‘æ§å·¥å…·nethogsä½¿ç”¨</strong></p><p>å‰è¨€ï¼š</p><p>æ­¤å‰åœ¨å¦å¤–ä¸€ç¯‡åšå®¢é‡Œé¢ä»‹ç»äº†å¦ä¸€æµ‹é€Ÿå·¥å…·<a href="https://gegewu-cloud.github.io/2023/07/14/speedtest-%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E5%B8%A6%E5%AE%BD/?highlight=speed">speedtest</a>ä¸å°‘å°ä¼™ä¼´åé¦ˆè¯´æµ‹é€Ÿä¸å‡†ç¡® æœ¬æ¬¡ä»‹ç»å¦ä¸€å·¥å…·<a href="%5BLinux%E5%B7%A5%E5%85%B7%E4%B9%8Bnethogs%E5%91%BD%E4%BB%A4-CSDN%E5%8D%9A%E5%AE%A2%5D(https://blog.csdn.net/carefree2005/article/details/124199604)">nethogs</a>  å„ç§ç½‘ç»œæµé‡ç›‘æ§å·¥å…· &gt; <a href="https://gegewu-cloud.github.io/2023/11/23/linux%E6%8E%92%E6%9F%A5%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98%E5%B8%B8%E7%94%A8CMD%E6%80%BB%E7%BB%93/">ä¼ é€</a></p><h3 id="ä¸€-å®‰è£…"><a href="#ä¸€-å®‰è£…" class="headerlink" title="ä¸€. å®‰è£…"></a>ä¸€. å®‰è£…</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install - y nethogs</span><br></pre></td></tr></table></figure><h3 id="äºŒ-ä½¿ç”¨"><a href="#äºŒ-ä½¿ç”¨" class="headerlink" title="äºŒ. ä½¿ç”¨"></a>äºŒ. ä½¿ç”¨</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹å¸®åŠ©</span></span><br><span class="line">nethogs -h</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŸ¥çœ‹ç‰ˆæœ¬</span></span><br><span class="line">nethogs -v</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nethogså‘½ä»¤é»˜è®¤ç›‘æ§æ‰€æœ‰ç‰©ç†ç½‘å¡ï¼Œå¯ä»¥åé¢æ¥å£ç½‘å¡åç§°æ–¹å¼æŒ‡å®šç›‘æ§æŸç½‘å¡æµé‡ï¼Œå¯ä»¥æ¥å¤šä¸ªç½‘å¡åç§°ï¼Œç½‘å¡ä¹‹é—´ç©ºæ ¼éš”å¼€</span></span><br><span class="line">nethogs eth0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç›‘æ§æ—¶åˆ·æ–°é¢‘ç‡3ç§’æ€»è®¡2æ¬¡</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">é»˜è®¤åˆ·æ–°é¢‘ç‡é—´éš”1ç§’ï¼Œåˆ·æ–°æ¬¡æ•°ä¸é™åˆ¶ç›´åˆ°ä¸»åŠ¨ç»“æŸè¿›ç¨‹æˆ–è€…é€€å‡ºã€‚</span></span><br><span class="line">nethogs -d 3 -c 2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‰ç…§MBæµé‡æ ¼å¼æ˜¾ç¤ºæ¨¡å¼æ˜¾ç¤º</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">æŒ‡å®šç½‘å¡æµé‡æ˜¾ç¤ºå•ä½ï¼Œé»˜è®¤KBï¼Œ(0 = KB/s, 1 = total KB, 2 = total B, 3 = total MB)</span></span><br><span class="line">nethogs -v 3</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ç›‘æ§æ‰€æœ‰ç½‘å¡æµé‡</span></span><br><span class="line">nethogs -a</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-tè¡¨ç¤ºå¯ç”¨è¿½è¸ªæ¨¡å¼ï¼Œå¯ä»¥è®°å½•æ¯ä¸€æ¬¡çš„å€¼ï¼Œä¹Ÿå¯ä»¥ç»“åˆå…¶ä»–å‚æ•°ä¸€èµ·ä½¿ç”¨ã€‚</span></span><br><span class="line">nethogs -t -d 10 -c 5</span><br></pre></td></tr></table></figure><h3 id="ä¸‰-ä½¿ç”¨è¯­æ³•åŠå‚æ•°è¯´æ˜"><a href="#ä¸‰-ä½¿ç”¨è¯­æ³•åŠå‚æ•°è¯´æ˜" class="headerlink" title="ä¸‰. ä½¿ç”¨è¯­æ³•åŠå‚æ•°è¯´æ˜"></a>ä¸‰. ä½¿ç”¨è¯­æ³•åŠå‚æ•°è¯´æ˜</h3><p>ä½¿ç”¨è¯­æ³•<br>ç”¨æ³•ï¼šnethogs [å‚æ•°] [device]</p><p>å‚æ•°    å‚æ•°è¯´æ˜<br>-V    æ‰“å°å‘½ä»¤ç‰ˆæœ¬<br>-h    æ‰“å°å¸®åŠ©<br>-b    bughuntæ¨¡å¼<br>-d    æŒ‡å®šæ˜¾ç¤ºåˆ·æ–°é¢‘ç‡ï¼Œå•ä½ç§’ï¼Œé»˜è®¤1ç§’<br>-v    æŒ‡å®šæµé‡å•ä½æ¨¡å¼(0 = KB/s, 1 = total KB, 2 = total B, 3 = total MB)<br>-c    è®¾ç½®åˆ·æ–°æ›´æ–°æ¬¡æ•°<br>-t    tracemodeæ¨¡å¼ï¼Œå¯ä»¥è®°å½•ä¸‹æ¯ä¸€æ¬¡åˆ·æ–°çš„æµé‡å€¼<br>-p    æ··æ‚æ¨¡å¼ä¸‹ç›‘å¬æµé‡ï¼ˆä¸å»ºè®®ä½¿ç”¨ï¼‰<br>-s    æŒ‰ç…§å‘é€æµé‡æ’åºè¾“å‡º<br>-a    ç›‘æ§æ‰€æœ‰ç½‘å¡ç«¯å£ï¼ŒåŒ…æ‹¬ç¯å›æ¥å£<br>è¿è¡Œæ¨¡å¼ä¸‹æŒ‰é”®è¯´æ˜<br>æŒ‰é”®    æŒ‰é”®è¯´æ˜<br>q    é€€å‡º<br>s    æŒ‰ç…§å‘é€æµé‡æ’åº<br>r    æŒ‰ç…§æ¥å—æµé‡æ’åº<br>m    åˆ‡æ¢ç«¯å£æµé‡å•ä½æ˜¾ç¤ºæ¨¡å¼åœ¨B,KB,MBä¹‹é—´æµé‡åˆ‡æ¢</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‰©ç†æœåŠ¡å™¨ç»“æ„å›¾</title>
      <link href="/2024/01/17/%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%93%E6%9E%84%E5%9B%BE/"/>
      <url>/2024/01/17/%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%93%E6%9E%84%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>ç‰©ç†æœåŠ¡å™¨ç»“æ„å›¾</strong></p><p><strong>æ¦‚è§ˆğŸ‰ ï¼š</strong></p><p>å¤–è§‚æ¥å£</p><p>äº§å“å†…éƒ¨ç»“æ„</p><div class="gallery">    <div class="fj-gallery  data" data-rowheight="220" data-limit="10">    <span class="gallery-data">[{"url":"https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_e55ad4914ecc2115cae8f66c70a4d2ce.png","alt":""},{"url":"https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_0719498ab66e6038ecc45c5d21398f75.png","alt":""},{"url":"https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_30518c76a3cbacc8c7bfb54189ee5695.png","alt":""}]</span>    </div>    <button class="gallery-load-more"><span>Load More</span><i class="fa-solid fa-arrow-down"></i></button>    </div>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æœ¬ç«™è¯´æ˜</title>
      <link href="/2024/01/17/%E6%9C%AC%E7%AB%99%E8%AF%B4%E6%98%8E/"/>
      <url>/2024/01/17/%E6%9C%AC%E7%AB%99%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>æœ¬ç«™è¯´æ˜</strong>ğŸ’—</p><p>æœ¬ç«™ä¸º<a href="https://gegewu-cloud.github.io/">ZzNnWn.</a>åšä¸»æ–°å¼€åšå®¢ æœ¬ç«™ä½¿ç”¨å›¾åºŠBlazeb2åŠGithubå›¾åºŠ</p><p>ä¹‹å‰ä¸€ç›´ä½¿ç”¨<del>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</del>çš„æ–¹å¼å†™ä½œç®¡ç†åšå®¢ ä¸æ˜¯å¾ˆæ–¹ä¾¿æœ‰æ—¶å€™ä¼šå‡ºç°<strong>hexo d</strong>æŠ¥é”™çš„ç°è±¡  åŠ ä¹‹åšå®¢ç¯‡æ•°å¤ªå¤šåå¯¼è‡´ æ¯æ¬¡æ‰§è¡ŒæŸè€—æ—¶é—´è¿‡é•¿ ä¸€ç›´åœ¨å¯»æ‰¾è§£å†³æ­¤é—®é¢˜çš„æ–¹æ³• ä¸­é€”å·®ç‚¹æ”¾å¼ƒä½¿ç”¨hexo  ä¸€æ¬¡å¶ç„¶çš„æœºä¼š äº†è§£åˆ°<a href="http://sunlight.zznnwn.cloudns.biz/2024/01/16/hexo-butterfly-Qexo%E5%90%8E%E7%AB%AFgithub%E8%87%AA%E5%8A%A8%E5%8C%96.md/">Qexo</a>è¿™ä¸ªæå…¶å¥½ç”¨çš„ç®¡ç†hexoçš„å·¥å…·å‡ ç•ªå°è¯•åå†³å®šæ–°å¼€ä¸€åšå®¢<a href="http://sunlight.zznnwn.cloudns.biz/">ç²˜äººçš„é¸­å˜´å…½. </a> åˆè¡· ç”¨äºè®°å½•æ—¥å¸¸ æœ¬ç«™æŠ€æœ¯ç±»æ–‡ç« è¾ƒå°‘ æŠ€æœ¯ç±»æ–‡ç« åœ¨åšä¸»å¦ä¸€å°ç«™<a href="https://gegewu-cloud.github.io/">ZzNnWn.</a></p><p>ç«™ç‚¹åˆå§‹é“¾æ¥ï¼š<a href="http://sunlight.zznnwn.cloudns.biz/">zznn-cloudåšå®¢</a><br>æ‰˜ç®¡åŸŸååœ°å€ï¼š<a href="http://sunlight.zznnwn.cloudns.biz/">http://sunlight.zznnwn.cloudns.biz/</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_436d9740fba555d84165cf30cad9603a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_436d9740fba555d84165cf30cad9603a.png"></p>]]></content>
      
      
      <categories>
          
          <category> æ—¥å¸¸ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ—¥å¸¸ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux-aliasæ–¹å¼é˜²æ­¢æ ¹ç›®å½•è¯¯åˆ </title>
      <link href="/2024/01/16/linux-alias%E6%96%B9%E5%BC%8F%E9%98%B2%E6%AD%A2%E6%A0%B9%E7%9B%AE%E5%BD%95%E8%AF%AF%E5%88%A0/"/>
      <url>/2024/01/16/linux-alias%E6%96%B9%E5%BC%8F%E9%98%B2%E6%AD%A2%E6%A0%B9%E7%9B%AE%E5%BD%95%E8%AF%AF%E5%88%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>linux-aliasæ–¹å¼é˜²æ­¢æ ¹ç›®å½•è¯¯åˆ ï¼ˆæœ¬æ–‡æ¡£æœªæµ‹è¯•ï¼‰</strong></p><p>å‚è€ƒï¼š</p><ul><li><a href="http://www.opstool.com/article/179">http://www.opstool.com/article/179</a></li><li><a href="https://steemit.com/cn/@oflyhigh/sudo-rm-rf">https://steemit.com/cn/@oflyhigh/sudo-rm-rf</a></li><li><a href="https://zhuanlan.zhihu.com/p/106066854">https://zhuanlan.zhihu.com/p/106066854</a></li></ul><p>rmæ˜¯ä¸€ä¸ªå±é™©çš„å‘½ä»¤ï¼Œä¸ºäº†é˜²æ­¢rm /è¿™æ ·çš„æ“ä½œå‘ç”Ÿã€‚æˆ‘ä»¬å¯ä»¥åœ¨ç”¨æˆ·çš„å®¶ç›®å½•çš„.bashrcé‡Œå°†rm alisaä¸€ä¸‹ï¼ŒåŠ ä¸Šâ€“preserve-rootè¿™ä¸ªå‚æ•°ã€‚å…¶å®é™¤äº†rmå¤–ï¼Œå¦å¤–å‡ ä¸ªå‘½ä»¤ä¹Ÿéœ€è¦è°¨æ…ï¼Œå¦‚chgrpã€chownã€chmodæ€»ç»“ä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨.bashrcé‡ŒåŠ å…¥å¦‚ä¸‹aliasï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> <span class="built_in">chgrp</span>=<span class="string">&#x27;chgrp --preserve-root&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">chown</span>=<span class="string">&#x27;chown --preserve-root&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">chmod</span>=<span class="string">&#x27;chmod --preserve-root&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">rm</span>=<span class="string">&#x27;rm -i --preserve-root&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>è¯¦ç»†è§£é‡Šä¹‹æ ¹ç›®å½•ä¿æŠ¤</strong></p><p>æœ‰ä¸€å®šç»éªŒçš„ç³»ç»Ÿç®¡ç†å‘˜å¯èƒ½è¿™ä¸ªæ—¶å€™ä¼šæƒ³èµ·æ¥ï¼Œ<code>rm</code> å‘½ä»¤æœ‰ä¸€å¯¹ä¸“é—¨é’ˆå¯¹æ ¹ç›®å½•çš„é€‰é¡¹ <code>--preserve-root</code> å’Œ <code>--no-preserve-root</code> ã€‚è¿™å¯¹é€‰é¡¹çš„æ„æ€æ˜¯ï¼š</p><ul><li><code>--preserve-root</code>ï¼šä¿æŠ¤æ ¹ç›®å½•ï¼Œè¿™æ˜¯é»˜è®¤è¡Œä¸ºã€‚</li><li><code>--no-preserve-root</code>ï¼šä¸ä¿æŠ¤æ ¹ç›®å½•ã€‚</li></ul><p>è¿™å¯¹é€‰é¡¹æ˜¯åæ¥æ·»åŠ åˆ° <code>rm</code> å‘½ä»¤çš„ã€‚å¯èƒ½å‡ ä¹æ¯ä¸ªç³»ç»Ÿç®¡ç†å‘˜éƒ½çŠ¯è¿‡æ“ä½œé”™è¯¯ï¼Œè€Œè¿™å…¶ä¸­åˆ é™¤è¿‡æ ¹ç›®å½•çš„æ¯”æ¯”çš†æ˜¯ï¼ˆæˆ‘å°±æ˜¯ä¸€ä¸ªï¼‰ã€‚å‡ºç°è¿™ç§æƒ…å†µçš„åŸå› æœ‰å‡ ç§ï¼š</p><ul><li>è¾“å…¥æ‰‹è¯¯ï¼šæ¯”å¦‚æœ¬æ¥æƒ³è¾“å…¥ <code>rm /tmp/test.txt</code>ï¼Œç»“æœä¸å°å¿ƒé”®ç›˜æ‰“çš„é£èµ·ï¼Œå¤šè¾“å…¥äº†ä¸€ä¸ªç©ºæ ¼å˜æˆï¼š <code>rm / tmp/test.txt</code> ã€‚çœ‹åˆ°æ ¹ç›®å½•ï¼ˆ<code>/</code>ï¼‰åé¢çš„ç©ºæ ¼äº†ä¹ˆï¼Ÿï¼â€”â€”è¿™å°±æ˜¯æˆ‘å½“å‰è‡ªå·±äº²æ‰‹çŠ¯è¿‡çš„é”™è¯¯ï¼Œè€Œä¸”æ˜¯åœ¨ç”Ÿäº§æœåŠ¡å™¨ä¸Šã€‚</li><li>æœªæ­£ç¡®åˆå§‹åŒ–æˆ–å‘½åé”™è¯¯çš„ shell è„šæœ¬å˜é‡ï¼šæ¯”å¦‚åœ¨è„šæœ¬ä¸­ï¼Œ<code>rm -rf /$&#123;tmp_dir&#125;</code>ï¼Œå¦‚æœæ— è®ºæ˜¯ <code>tmp_dir</code> å˜é‡æ²¡æœ‰æ­£ç¡®èµ‹å€¼è¿˜æ˜¯è¾“å…¥é”™è¯¯ï¼ˆåŸæœ¬æˆ–è®¸æ˜¯ <code>tmpdir</code> ï¼Ÿï¼‰ï¼Œé‚£ä¼šå¯¼è‡´ä»€ä¹ˆï¼Ÿå½“ç„¶æ˜¯åˆ é™¤æ ¹ç›®å½•å’¯~</li></ul><p>é‰´äºè¿™ç§æƒ…å†µå±‚å‡ºä¸ç©·ï¼Œåœ¨ Linux åœˆå­å‡ ä¹å’Œâ€œåˆå­¦è€…å¦‚ä½•é€€å‡º viâ€ ä¸€æ ·æˆä¸ºç»å…¸ç¬‘è¯äº†ã€‚æ‰€ä»¥ï¼Œåœ¨ POSIX ç¬¬ä¸ƒç‰ˆè§„èŒƒä¸­ï¼Œ<code>rm</code> å‘½ä»¤<a href="https://link.zhihu.com/?target=http://pubs.opengroup.org/onlinepubs/9699919799/utilities/rm.html">æ·»åŠ </a>äº† <code>--preserve-root</code> é€‰é¡¹ï¼Œå¹¶å°†å…¶ä½œä¸ºé»˜è®¤è¡Œä¸ºï¼Œä»¥é™ä½å‡ºç°è¿™ç§é”™è¯¯çš„å¯èƒ½ã€‚</p><p>ä½†æ˜¯ï¼Œè¿™ä¸ªé€‰é¡¹ä¸èƒ½é˜²èŒƒæœ¬æ–‡ä¸­æ‰€è¿°çš„æ¸…é™¤æ ¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ï¼ˆ<code>/*</code>ï¼‰çš„æ“ä½œã€‚</p><p>æœ‰çš„åŒå­¦å¯èƒ½è¦é—®ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜ä¼šä¸“é—¨å‡ºç° <code>--no-preserve-root</code> é€‰é¡¹å‘¢ï¼Ÿè¿™å¯èƒ½ä¸»è¦æ˜¯å‡ºäº UNIX å“²å­¦çš„è€ƒè™‘ï¼Œç»™äºˆä½ æƒ³è¦çš„ä¸€åˆ‡æƒåŠ›ï¼ŒçŠ¯å‚»æ˜¯ä½ çš„äº‹æƒ…ï¼Œè€Œä¸æ˜¯æ“ä½œç³»ç»Ÿçš„äº‹æƒ…ã€‚ä¸‡ä¸€ï¼Œä½ çœŸçš„æƒ³åˆ é™¤æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å‘¢ï¼Ÿ</p><p>ä½ è¿˜åˆ«è¯´ï¼ŒçœŸæœ‰è¿™ç§éœ€æ±‚ï¼šæ¯”å¦‚ä½ è¦æ¸…é™¤ä¸€ä¸ª chroot ç¯å¢ƒä¸‹çš„æ‰€æœ‰æ–‡ä»¶ã€‚ chroot æˆ‘ä»¬è¿™é‡Œä¸å¤šè®²ï¼Œå®ƒå°±æ˜¯ä»¥ä¸€ä¸ªç›®å½•ä½œä¸ºâ€œç›‘ç‹±â€ï¼Œè¯¥ç›®å½•åœ¨é€»è¾‘ä¸Šå½¢æˆäº†æ–°çš„â€œæ ¹ç›®å½•â€ï¼Œåœ¨è¯¥ç›‘ç‹±å†…çš„æ–‡ä»¶æ“ä½œä¸èƒ½è·¨å‡ºè¯¥ç›®å½•èŒƒç•´ã€‚è¿‘äº›å¹´æµè¡Œçš„ Dockerã€LXC/LXD ä¹‹ç±»çš„å®¹å™¨æŠ€æœ¯ï¼Œéƒ½æ˜¯ä¸€ç§ chroot æŠ€æœ¯ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo-butterfly-Qexoåç«¯githubè‡ªåŠ¨åŒ–</title>
      <link href="/2024/01/16/hexo-butterfly-Qexo%E5%90%8E%E7%AB%AFgithub%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
      <url>/2024/01/16/hexo-butterfly-Qexo%E5%90%8E%E7%AB%AFgithub%E8%87%AA%E5%8A%A8%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>hexo+butterfly+Qexoåç«¯+githubè‡ªåŠ¨åŒ–</strong>ğŸ‘</p><p>å‚è€ƒï¼š</p><p><a href="https://www.oplog.cn/qexo/">https://www.oplog.cn/qexo/</a>                      ï¼ˆå®˜ç½‘ï¼‰<br><a href="https://blog.kwxos.top/posts/18807.html">https://blog.kwxos.top/posts/18807.html</a> ï¼ˆåªæ­¤ä¸€ç¯‡å³å¯ğŸ‘ ï¼‰</p><p>æ¦‚è§ˆï¼š</p><ul><li>æ–°å»ºä¸¤ä¸ªä»“åº“ä¸€ä¸ªæ”¾åšå®¢æºæ–‡ä»¶ ä¸€ä¸ªå­˜æ”¾é™æ€æ–‡ä»¶<br>å­˜æ”¾æºæ–‡ä»¶ä»“åº“ï¼š<a href="https://github.com/zznn-cloud/qexo-blog-source">qexo-blog-source</a>æ­¤ä»“åº“éœ€è®¾ç½®ä¸ºç§æœ‰<br>å­˜æ”¾é™æ€æ–‡ä»¶ä»“åº“ï¼šzznn-cloud.github.io æ­¤ä»“åº“å…¬å¼€</li><li>å¸¸è§„éƒ¨ç½²æ–¹å¼hexo clean &amp;&amp; hexo g &amp;&amp; hexo då°†é™æ€æ–‡ä»¶æ¨é€åˆ°ä»“åº“zznn-cloud.github.io</li><li>ä½¿ç”¨Gitæˆ–è€…vscodeç­‰å·¥å…·å°†åšå®¢æºæ–‡ä»¶æ¨é€åˆ°ä»“åº“qexo-blog-source</li><li>æºæ–‡ä»¶ä»“åº“qexo-blog-source <strong>.github</strong>ä¸‹æ–°å»ºGithub Actioné…ç½®æ–‡ä»¶</li><li>ä½¿ç”¨Verceléƒ¨ç½²qexoç®¡ç†åšå®¢</li><li>æµè§ˆå™¨è®¿é—®zznn-cloud.github.io æ­¤æ—¶éƒ¨ç½²å®Œæˆ</li></ul><blockquote><p><del>note: å…³äºåšå®¢å¦‚ä½•æ­å»ºåŠGithub pageså¦‚ä½•ä½¿ç”¨ç›¸å¯¹ç®€å•æœ¬æ–‡ä¸åšä»‹ç»</del></p></blockquote><h2 id="ä¸€-ä¸¤ä¸ªä»“åº“é…ç½®"><a href="#ä¸€-ä¸¤ä¸ªä»“åº“é…ç½®" class="headerlink" title="ä¸€. ä¸¤ä¸ªä»“åº“é…ç½®"></a>ä¸€. ä¸¤ä¸ªä»“åº“é…ç½®</h2><ol><li><p><a href="https://wn-apple-teawine.fun/2023/08/12/hexo%E4%B8%8Egithub%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/#%E5%8D%81-butterfly%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE">å…¬å¼€ä»“åº“zznn-cloud.github.ioé™æ€æ–‡ä»¶æ¨é€è¾ƒä¸ºç®€å•æ­¤å¤„ç•¥</a></p></li><li><p><strong>github-token</strong>ç”Ÿæˆæ­¤<code>token</code>å¡«å…¥ä¸‹æ–¹<code>action</code>é…ç½®æ–‡ä»¶(é…ç½®æ°¸ä¸è¿‡æœŸä»¥åŠä¸‹æ–¹æƒé™)</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/86b145ca-5730-4187-836e-00aad670b76d.png"></p></li><li><p>ç§æœ‰ä»“åº“<strong>qexo-blog-source</strong>åªéœ€è¦<strong>push</strong>ä¸‹æ–¹æ–‡ä»¶å³å¯</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/5ff789ab-8d59-4a54-b2a2-aeec9ba423b4.png"></p></li><li><p>ç§æœ‰ä»“åº“.githubç›®å½•æ–°å»ºé…ç½®æ–‡ä»¶å¦‚ä¸‹</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/6eb998ca-bee5-4b26-9286-86d3ba8ea862.png"></p><p>é…ç½®å¦‚ä¸‹</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">è‡ªåŠ¨éƒ¨ç½²</span></span><br><span class="line"><span class="comment"># å½“æœ‰æ”¹åŠ¨æ¨é€åˆ°mainåˆ†æ”¯æ—¶ï¼Œå¯åŠ¨Action</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">main</span></span><br><span class="line">      <span class="comment">#2020å¹´10æœˆågithubæ–°å»ºä»“åº“é»˜è®¤åˆ†æ”¯æ”¹ä¸ºmainï¼Œæ³¨æ„æ›´æ”¹</span></span><br><span class="line">  <span class="attr">release:</span></span><br><span class="line">    <span class="attr">types:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">published</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">æ£€æŸ¥åˆ†æ”¯</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">ref:</span> <span class="string">main</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">å®‰è£…</span> <span class="string">Node</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&quot;16.x&quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">å®‰è£…</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          export TZ=&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line"><span class="string">          npm install hexo-cli -g</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ç¼“å­˜</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">cache-npm</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v3</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">cache-name:</span> <span class="string">cache-node-modules</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.os</span> <span class="string">&#125;&#125;-build-$&#123;&#123;</span> <span class="string">env.cache-name</span> <span class="string">&#125;&#125;-$&#123;&#123;</span> <span class="string">hashFiles(&#x27;**/package-lock.json&#x27;)</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-build-</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="comment"># Install pandoc for mathjax (Optional)</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">pandoc</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          cd /tmp</span></span><br><span class="line"><span class="string">          wget -c https://github.com/jgm/pandoc/releases/download/2.14.0.3/pandoc-2.14.0.3-1-amd64.deb</span></span><br><span class="line"><span class="string">          sudo dpkg -i pandoc-2.14.0.3-1-amd64.deb</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">å®‰è£…ä¾èµ–</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="string">steps.cache-npm.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          # npm install gulp-cli -g #å…¨å±€å®‰è£…gulp</span></span><br><span class="line"><span class="string">          npm install --save</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">     <span class="comment"># - name: ä¿®æ”¹åŒæ æ’ä»¶çš„CDN</span></span><br><span class="line">     <span class="comment">#   run: |</span></span><br><span class="line">     <span class="comment">#     sed -i &quot;s/cdn.jsdelivr.net/blogresource.sqwdream.top\/cdn.jsdelivr.net/g&quot; node_modules/hexo-butterfly-article-double-row/index.js</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ç”Ÿæˆé™æ€æ–‡ä»¶</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo bangumi -u #bilibiliç•ªå‰§æ›´æ–°</span></span><br><span class="line"><span class="string">          hexo generate</span></span><br><span class="line"><span class="string">          # gulp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">éƒ¨ç½²åˆ°Github</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">token:</span> <span class="string">github-token</span>  <span class="comment"># githubé«˜æƒé™token</span></span><br><span class="line">          <span class="attr">repository-name:</span> <span class="string">zznn-cloud/zznn-cloud.github.io</span></span><br><span class="line">          <span class="attr">branch:</span> <span class="string">main</span></span><br><span class="line">          <span class="attr">folder:</span> <span class="string">public</span></span><br><span class="line">          <span class="attr">commit-message:</span> <span class="string">&quot;$<span class="template-variable">&#123;&#123; github.event.head_commit.message &#125;&#125;</span> Updated By Github Actions&quot;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="äºŒ-Qexoéƒ¨ç½²åŠé…ç½®"><a href="#äºŒ-Qexoéƒ¨ç½²åŠé…ç½®" class="headerlink" title="äºŒ. Qexoéƒ¨ç½²åŠé…ç½®"></a>äºŒ. Qexoéƒ¨ç½²åŠé…ç½®</h2><ol><li><p>æ­¤å¤„ç”³è¯·vercelå…è´¹çš„æ•°æ®åº“ä½œä¸ºå­˜å‚¨æ•°æ®ä½¿ç”¨</p></li><li><p>ä½¿ç”¨vercelå‡½æ•°è®¡ç®—éƒ¨ç½²Qexoå‰ç«¯</p><p><del>Noteï¼šä¸Šæ–¹ä¸¤æ­¥éª¤è¾ƒä¸ºç®€å•æœ¬æ–‡ä¸åšä»‹ç»</del></p></li><li><p>ä¸€é”®éƒ¨ç½²Qexoä¼ é€é—¨(<a href="https://vercel.com/new/clone?repository-url=https://github.com/am-abudu/Qexo">New Project â€“ Vercel</a></p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/bc9f1111-b88d-49be-a0dd-a61f94e46078.png"></p></li><li><p>Qexoå†™åšå®¢å‚æ•°ç•™å­˜</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/655e81e0-1d98-40ee-9fbe-20f0f9ceea2e.png"></p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/04073e0c-4649-4ea8-8e83-5ab25e43507d.png"></p></li></ol><h1 id="ä¸‰-æ‰©å±•ğŸ˜˜"><a href="#ä¸‰-æ‰©å±•ğŸ˜˜" class="headerlink" title="ä¸‰. æ‰©å±•ğŸ˜˜"></a>ä¸‰. æ‰©å±•ğŸ˜˜</h1><p><strong>Qexo logoç­‰ä¿¡æ¯</strong></p><ul><li><a href="https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo.png">https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo.png</a></li><li><a href="https://unpkg.com/qexo-static@2.2.3/qexo/images/icon.png">https://unpkg.com/qexo-static@2.2.3/qexo/images/icon.png</a></li><li><a href="https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo-dark.png">https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo-dark.png</a></li></ul><p><strong>Githubå›¾åºŠè®¾ç½®</strong>âœŒ</p><p><a href="https://github.com/Qexo/Qexo/wiki/%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE">https://github.com/Qexo/Qexo/wiki/%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE</a></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># ä»“åº“</span></span><br><span class="line">zznn-cloud/zznn-cloud-blog-images</span><br><span class="line"><span class="section"># åˆ†æ”¯</span></span><br><span class="line">main</span><br><span class="line"><span class="section"># é«˜æƒé™token</span></span><br><span class="line">ghp<span class="emphasis">_Qknm...................</span></span><br><span class="line"><span class="emphasis"># ä¿å­˜è·¯å¾„</span></span><br><span class="line"><span class="emphasis">Qexo/&#123;year&#125;/&#123;month&#125;/&#123;filename&#125;_</span>&#123;md5&#125;.&#123;extName&#125;</span><br><span class="line"><span class="section"># è‡ªå®šä¹‰åŸŸå</span></span><br><span class="line">https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/&#123;year&#125;/&#123;month&#125;/&#123;filename&#125;<span class="emphasis">_&#123;md5&#125;.&#123;extName&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_3292d63d8f8d8a13d3e5c4da5693056e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_3292d63d8f8d8a13d3e5c4da5693056e.png"></p></blockquote><p>ç»“è¯­ï¼šQexoæ˜¯ä¸€ä¸ªæå…¶å¥½ç”¨çš„hexoç®¡ç†å¹³å°æ„Ÿè°¢ç»´æŠ¤æ­¤é¡¹ç›®å¤§ä½¬ä»¬çš„è´¡çŒ®ğŸ‘ ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> qexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> qexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>qexo</title>
      <link href="/2023/12/15/test%E6%96%87%E6%A1%A3/"/>
      <url>/2023/12/15/test%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh,è¿™æ˜¯ä¸€ä¸ªæ— æ•ˆçš„å¯†ç ã€‚è¯·æ£€æŸ¥å¹¶é‡è¯•ã€‚" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="1e36074e6806db3b794944b334a845b30ee4a44008c0f95412e8164b226bd2f7">a81b18b76326989181327cf554748c52da21cc33c0731b37b224ba7b570727d3b6d5ddf5cf3c517190be31f0da481a7c1ae1ccf60fc7eaceeb9cc5892e16592bedd0fa34da4e1fbebcabbc85c61b51dc15b4dd5c653dd684e603438464111c4758ada5701ed225dfbd33a33cab2ad7f5093655aeb5eaca0232ba36211d5fc9ff44db582730bf5c727b33bccadb8cb8b77cae0b827153cec6695bba5dd664156870a40827582da63c9bb736da2a1bfc98df7330236d44a7d2f8b10dfdfcd122bd5e2c4b11abfa2950fbe9241cf3f70397f4fefef6014cbf3accc24f189e4e0a0c3b4ec4f45e9219defb3827e97c491cc502d47705a211f980292e5d94782afb28e13979fec10f387caf7a4b98b79a86fe4e7ad3f9160a17314f34ae7dc9de9657330c39bdb079565dd9b9028e55be707459664d80e94aaa904db0f7625599f5d554d2eb884008a91dba287ef5a9e3b8d7f9be0e0cb510ed2de19caaef0d93f43f3fab92059dcb4ae3117d38f5f8569e2599dba450684e50ae2cafed01af668acaccbfd559639df872095f921c09511ba9aa98eaa60ff40792ef9de59eaf803fa0385e164e13c46a17baba7df1020fff0da0f5966c893838d94d1acb2cdefc0c668136b567139a3ccdb81c79fe589a04e4c29f588bc4970922e347038b5255e2073adf5a6f7b1b3da9766823e784de618db79c4e9c7fa9bcb8d349420c1caec932caf6fec3f006905a4da03a87acbb2a0c976d6aa75713e4ac4f627cfdf081140629c8e64f4a4f530949bef04038eb8a5f5bda930b8e4f90f00b0054e7424e220988a14706065271315d9cc90efbea5a21e6b2ab3b97950791af32fea88dc1b4997e0f745f4ee19c3ea33ef460bf37f91a0915fef7997f1476766e49003ee3b4a68b8b45b1fa6c2a9819837b731413ac89ca44f96ed6e06fdde14d31aafd7f10be7182781fcc2f07c927aa8a9b3e18889648d59b4731c1118ab551e3eace4c6cbdcec0dafc9ea2038503b1bf4ce5d78f51c6357e483f7ecd9082168c55ef6208c20227a5499cf042252ea5444d6d925806a4834d574b220e8e14e1ee686f2a699360a0fcedebe1c4b8b0ec701509bb99b96bf2bd69b73b8fd4db9ee9adf0bece84ccfef7bb6759ce3d88f32b8d6f5a4c48f33cc5576c609bf4b89b88fec3a9e95657ff7f1a71f8c2c08068bd8f32c9e0e6adae824595277425c51c9342210ea2ddbd0c468a56e49a07dd603b6c077294df30fd2d37ef48c85b28495a7fba0fdceb2f82d630deea7f8de307fb911599f5c6cb732ffa0c94511fb928a2ea94df54502f6e4ee0a1ec2287b6f0ab5d8cb8a71da9f5cd4fe2f3e86440dfef0c5f538f1fa794b49d86b24907d5ab7bef455fce7a1f5f0f8df94c6b4778617a040daa6e38feff24023cdc7d58888534dac1a361c5</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">è¯·è¾“å…¥è®¿é—®å¯†ç </span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
