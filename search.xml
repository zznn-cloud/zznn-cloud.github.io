<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Hello World</title>
      <link href="/2024/03/29/hello-world/"/>
      <url>/2024/03/29/hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>zabbix监控交换机配置报警</title>
      <link href="/2024/03/28/zabbix%E7%9B%91%E6%8E%A7%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AE%E6%8A%A5%E8%AD%A6/"/>
      <url>/2024/03/28/zabbix%E7%9B%91%E6%8E%A7%E4%BA%A4%E6%8D%A2%E6%9C%BA%E9%85%8D%E7%BD%AE%E6%8A%A5%E8%AD%A6/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh,这是一个无效的密码。请检查并重试。" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="e1a29fc1ae6ae58b72c4628d5f7a0be01ddafcf300d40af19a637654ffe7b0f2">4d04042c6ca46bd44e1433b27a81c2cf1d7ebe395378e6b7d366280b19cd34464dbaf1b441366bd6ad20f97f778b89aeeeaf429e24c71e03e0a8cad736649e91abcfee610148ffd49863b8dcf69717f732bc5b0443b6a4537c6ce8a8359ff7ac906e1b81d8f6edddea231135d781bc9ae284f13735736da6d34c00d44605b7c30e7344cc7f246170a7461e02156e0270386cea09f3da07a7d2caa7b0e9bacdbdd143cef3b90a917a983a84595f7c29b66902127c0d30858c04f2f7e1721dc28e9c11ffae93e14f329e2cab6a3749422546203de4c29fe5d828825a6e109002ba598fc112757a03ae8e8ea9c94edb95fecdfb540ac3e1011dd5be9087f0651bf996a3963dea594910ce82e81af53b92a19c6116387e5a65b97eea37df592e0d94787930c4f56386aa6c8391d20a75839139d0fe9bb4868baee1bb46b5dfef21a6d24fe7c5fdec8e2bcbb9f1f181507ae6567e4d8191ec622a2fe1ba133c88fafdd30a15a27f1577cf64f5fe55bf8b84c7bfe0a79924ebd3e0922353be5d4922b34a08d0491a91e296d2e6175b1d9af4ea4ef21395d0b9b5db87bc4bc4a8047abc8ffb96404ce2951324260a5ae058de66f700ea176ec543f8bf05b3bfc677556f299f2ffcc19242c3dbc9aba2714fe61365643dc65f5d3199565ec7aba18d29f57438cb7c8f9f5b9403b85a02a8f935ff3fca6448d15742aec2ad4e53fbcc2bc7941b3558edfbbbdb430b2a9fce04a66e8864f6764897f9eab6f2ec6cb94dfb5dd9254325f2bab692e63e1a9128f9ef6321e6fcf8508b0672b1d6eb63dcfe16f44936d73d06a2af2fee3c0e3659d8bf864cd77cee1d89d10d3cb2eba5617b11d2211b061535b409e750d19e985b7c0b773bbc904c323188d08129570a0523e7e7f819ed21e6270dee3e089bb8821e4cd36d5fdb22c01c6e6247a24aee68e1b148e3d31c20c7d1037686c5e4d1902cfa06ccc03ddb3c461c853de565b79e8b3b2b186d84e614e05b35b339f35426821eb525dbaf3f451d310f2a4ca5f582aa6883e6ba87fa4d268721f350423076fcaaf64825ebc88cf4918b9e1285c57667f7c282db23a27e8218f4867428c1c20b53a0fbc05c85b6c5267a4342b055f79bafc741579ef8d64174e214bb903b41468fdb3663a4d97da1f6fa65044c66b56f216b966570a68152ecd5f70d5aa8032aa44b8df37d1b6d1069786cc2dac8646c32caa37629e0f63b0f2591d367fdd8116c26f1fa76133d9ff957820fba1dbfbb7b6a24e822c5e0dc33992d768278565b3ee29f66b1076b875cfd69c0968f66a1b2f1af819cc4f99473c628d907b63dee669694db4ee7ae591421398507f9ea66322fc7a4e4695efddbd3609ff027e1218bf3d26a08878648cf5a74e54e5e9507ff0574efc00c6ea43adc3edbe2a9e74bc337c9a41c747a64b6a152a12bb00333e44145a29e5020925f4582c0e3a780c3b9e920e7419fb837d0f5fabccd3ba82976ca206b2365a3f62f1dc3f3c73182b0260681841f9d124c4bc6a58dd2dc69b27b07abfbcba20b9352c81e4c54fa8adb6d5d2e3cf3272fef06af4be744d49d859275b0f4939bf9163010362e42b99af31fc31b6bc42c9de55884354d1e5f5976a0265ab2a4c33bc78b3f1a0a8a7f192aa0e1baa84e63041e61efa722e5b124856760740770dcc91e85783e1cd58aaa77750a1b711891cee003fc47334cee6c2dc947312609d1b73b698775a1756ed3437737ebc31164edea13e2fb11c0d75051a99524af1bfc5fee9da81c0afe205a7365b06c56244bab47042f0be37a11356461a3dba02de68dc8b7372fb753b81d4735972bcb8c31a56ec1aa82da41b36b26784c7fbf6def90c3e49ae2a57ead9dea4734b892945955e948377d0313303b3132a7e8f4fa281361b5563bdccf2920efc615ab9e78c7e9b7e06a9943f7f8d0595c510b97521431b19d2440a2a0701fe7b42bb17f7647555987483068d47493b662b15f6e53a23dd89bc881527fb0d3f2de2caeb586bfd2c4b369b204af35de97678edf3946ae102a194c2afc601085a328cb12fbba824c65cdecf55b0d3eb371eb946818606ddd28527b510b4a440e19a0d3f1603c1644340e8fb947c0386701ece3fca1322980afe1e9d62ba150e4aff48cee7213a2a2a2b8c49f4d065ec5fc2f57bc61055f9b1eef32ada1d1e3d2101718bf442cc67868a19a23a53d0b93c3a0b5b9630918cc0fd81d2f14f52a5a53cc619d78ccadee0d207bc3511be78fb936f7fc83accdcaf2abf17a1c931ee4870eb4070d712d86728013ddef029eee4838de1ef99f3c8ba62b6d1a13a51cf9238632b96eba99ab0517c837df66546777b2533e7c69a59afa010e0150fdc21fb7c352ee6f4819c9f5b04bec25435239fbf9d526221820455f5c8cf3c84ebc56eb10960a4c8aebccc54c085dde5712cfcdd60c57b1e795f3ae784309fc40126a218d974c0c382ae51ca31b41deab844a79338e4920c4584cf0b9a23aa43c16e7532f161811d3e335d2ffb954cc448626a7fb86652b688df8d1992ab5b21337058b3da20508e4365cb62448bd33a46a1663b03b9ef3324da58794100be8cddd55f5aefaa3e3c0001c31ba413acd4e30144f70e0223c1f504a566d4bccd4218474d1325e377c615b9305364809f87295fe3fd757b650247cbf6d0fa8ee868417f3d76a8e8a8e51118b0889323266ed851dfee0ba1dc7e0fbba2a9e48c94030ca521127c1ba6bd62a6e6d00c1feb8a0db468f1bc3bc616eb53de0f4b79fce734b2be6aa1427f095b3bcfb2c809caf61cf3eba4d114c1525ccf21031e68dbbaa684360042e315cb08856721b120d09f663aeaced2881c977ed31a52c0060e2a1e9896d067e129ec6afaa637e05400c58726d02cb5f37c96167c1a8c8f101f95d938a4471092ed1aaf2e165db575a277f109ec1d5cbf2a298760c2343eb9f3f7f12d0d1f5f4f52e650164036a9afb86c6fb0a2dc96ee59a021c1a46b49801e70ef6512db3c39956a7cf2e20249f053ef8e45a9856c6a57734de3fe485142191ad498575342c4ca60fe8d56240a72466a8c7f36061270314445aae4db381131e3d31274793c598f3a6723c0110f7abd0227509a4b5cbd07ee16259454f7c0d77def0bf46cc342cd4e5d8d61e1ed88e6751cf67c028e6345d8571f5e5cdd20e812c304864f73da6852c39b6ad322f75b15254ecf8f52fa44de0ce23d75fc36c9956a976c67ae1ba224dd94e78289e34fbe8adb7853c4bc3407dac55c193326cf2da2779aa1bf082665be8d89e04e02739dfa855cac57bb711098369bda4265869fc2ec6daea49e2459cd5ad5618656eec2604794074a4fd4ed226d310f15372a2c68925330ba211925875235cbdbb3f84c5a391de9e3c09b034ec7d4a376a7fe73784c5a52ed5d2f8214d8f1d96f5e2b8441ed427d39356e18411a23d498c6f6300ef9de9ebafaea20dc567184e3ed73399613c2847e6f1bdb4576989df81c5547c8e3b475be5cbd04ef7c0af6dc230fa14f1ab6e0d0804954ee7922cf6325cf5393edf930a0d9c5eaf0346129f08b5a780e73788cb4566f64c8a7750c8927f26aaba1f39d607ee88769322083b34f1b14d2dceb16c3845f04d543bebbc0d9021258aad4aa89da1b7fe9081c4f85bbe03359fe87540ecd75a45beb31a2f57fd1dc82982a0433e6ee1c2ad2d726b7edb2c60248e62a8f37e268354b766673ecaa857de64ebec64b8f4cd7623e831bc6f4ba8ba549a9c7a16a0784af2cd19f719e7a2951932f836b2fc062ff52f7543d3dd660ae2c0631e586703f13d96631859a692bf88b3bc36b66dbfbcd64390bf7032aa26321f05eab15ba19bd92821752e592b15d441c274ee6986554df59ae03342c871b15838974be7af9832845e9eb9a7b1adf06d7000ac90c325c2a3d0a34ff56b5ea5c9f9f1b369923174681a30801d506af8739983f41b17a5db12aa5e699469d49f3c1b957155885f8c8004afa0886a8f4edf95168d5c802f4470d0cee03973d215d763c44d4b90ab71971a57c9515bb2daec3660d765ce67bd3a5622c5d805d5c0f2b87ae63d719567203c7cc3710563f07b57273a803a2b958f0e438a8e8c2af3574acf994f1e6757d33553cbf327b9aedb17b654e25dab7331ddcd4e1e8623643c0efc3a96e487d5767fa5179fad0b4b552ff1be6d5ef2cf5eaa9db4af3523d23e3c1fabf8e70c5d24148196c7f94f90d0d14e538bf30245b2a43a980f85f005befd8e762b9dc643917d5515ac08c447db1cd0a9bf47dbbf14a5b794a80a6ab638270ad1ecc5cafc3b9f785989a115d8ceee2ee5cb8f583de4060f6efb0d950db52266940f96bde26652487bc2b602a024f13ca37a4a6b013086057defa870c865c97e0447127f039f0fcb4c774014228ef19d56eea6677fade5a133561e21f6438f7217c972398a054d79f2863effda1f57e4b13d841046497f0718d2a70ff079a94fb08b1c2beb769a0535d449a256982040f6fe0f491e3e27cdc3bde3b7e9ae9be8b6b27605ee7ca93019228be929f17133f437bf7a7247e8036a02cb0375090f042dde65fac6763d051e695d0fc7aaac7d824bc8a964481cf1e35e7dc8cd8e680495c66c6210f945fd174bf86b8ebad9b247f1fc95b863058d81d62cc4ec94ba5b1cc59d425949d0e746c1cd181f970720d8f47299818b8f372d941fe8c227234b75ff39f4e771ff645ad489030ee553e7c1ed5aa73c5002f98ae150cf2ca03f1c0c0dc8eefab62cd5c4ae6b1dcb8b3efb630c09f45dfd9fbe8f07786862a1ed629342ab3b527651355ae34b2cfe23d11b7fafdfcd8920304d533fa9e518313d9d4ac8989d2d176be8d410f0691d4095a125a4610180c45d2a82de26ed3ab826ccee60e6e01bbdd0157ddb6ea7d4a94e9711555cc24b24512ef75f171883e9d32c150f1b4e94920937d84a735a15b1ff1cf5260c925893f0a3c5cdb25003156e9719b07c0ac676a1067709e37e7905810193ca0388e022002ae5d8f15cc8241368989faf2fd4673abf52914318965c1cc4098eb5fffc3facca27df487c4bdfff532111be5879f3fb1bb80a65486ff26aa30dede5f0a1b2818bb3ddb762db6f9f2d657c7e017d3895860cbf66d66d14aefc3e946d0a7725515c6df472bdddd2a70a8bb91905bdbbb81b929666245aa85a4ef1a06346d712e41fca8301e21bdf0cc5cff208737291b60113de155bf8827dc6d0dcac410149f712d460f8330028a25a5adcc3ea9fdc8f2e7cedf60d5912935c891cc16183160d2539c93fba9ee80bd05a2d6b64f9619589ca46395cfc1402dcf36ea5a5a3f00e8c686ef551ca78ed83a48908ee35ec366c8a08d9e65a7610184b92f47ffe05f78543066a68ec6bd67e06d4ca2ba42280d3b028132c0c881b7bdab20f074f1fb04e3df876ffa2fd7bf830c6e102d07a5399b1f7fe0bc0eb677a6d9cbcf8e07b8ef830b91f6881fb4742d1776d9ef4f7702a856f82bd26812a0eee60be4fcc9ca143b65f88492420376a86fbecff089c90984a71a943970836b7b67297042039e40586a7a7eede4ea229d10a063d7767a3762c67120aed544f5658e4f8c797c9d7b6714be193871806d55ef4280f415ceab133a430a38724605fb7093116ae49cd498fa0a308e5440bc4cbad3db5abe2a96bf0ac5b0959ffdb1673e375147661ba0d5bf7d0f94126c9942e633e346218afe63b755f2d7de9c62209d55bda829e18a4b698c118897e2705021c242c57e739f8bc4fcc637455cd961cbfc626d26604c3364a7be7a656211f534e5221e8f86aadb271481a673cc01b7cd6e01e8edec046b86f6756f4c685ad1a9e59534a5378a50f693a73e7c1e325550f92d38c591cf5142f3966cb3fa03ba0da6c31c501df63a8b66ce773aa0a010cd647a6849ba73a38b6e52dd3226065b5a4b9e3bd3a50add7bf3144ecde4f57124d9d6d15d955d770dda95e8afaa15777fd058e98e912b41940aa0d741ce89008d215190098a314c166c27336a2399fc31ba1e27e589afbdbd6eb8000abb51f6b011d104492e57b39af261fc79fb99f5b34877ccbc1fbf1170b16446f7cf6d019f72a21e6e8a3498866f33e46b65ca100a1c4f34326b4ba3611cff5da9ab854870b3fe653cc2016d8f42a40e56b99a2954300eb60ec3cc9c4805620ed8f751e32bba3a014c519b0913afe737f4ca9cfbc0650ad7740a4b5dd4e0bbda0f014ae3d7fbc2b85b61c70c4bc76624612c04df9c2747817d0a71888159663fb40458df20507ecddbc005143d51258bb3ef30be332c0edb7e39a3303e0ad202ea070650d8f8784ac033a1a09e2ef05cc41bf7c0b77c3d244024c96de9b33f9dff672e663605131781f9500ba2de793da3a01b2f99a9e1e16fdd198e2718ace1fe49d268f0e4ed43272696e49264475e9425485896bba991e1e4bd0b05a15f857eeee3a74359a4d7cc74dbe811fe578470f85a7e59d93ee067f17e83f5db76eec0b89673a6337360d5652d57d60b92d8523a1e919b980ff556814f92e8d2b425afd8f1e58e86cede015121efad9787f28aaf2b0b6329ced24c7764bb5aded48ca377933975d090e4af3a8129256e28a4b5f87bf51e04a9988a6deb130b7a8b61f266ffa9d7f291e0b63dc200370053dee2e6d78e01ba1df52b7eee227227ece56c4726a77c58edde8a44c6ec6fa30d22ee38915c488a8e47e76a1a9e9f840ca37d2fc6f82495b5e95fbfa7ce17408988ea48afaa5ace20101b124551f0de2235e915270c262cb5f1ced5a325142652914057e70a350b1f99bb85c96224738462b05d0b66bf80dd9f643ec84f74bcffe6841e7b4abf19f97e2c8be190bf30a49bb7bb97ed2f0dc471e839d15e92b0818f3cec773b3eb359de19ccdcb2a5d589276a1494ce6a4d77bdaa68b3b61f01f113aea357c0c2c5ef7503466362b5260b9eba01c277640afb10ffa7571e48684645fd918d5fdea676fc5484e594af62118f07a19fa443d87c48e2e4b23df475ee0c45f215aa7a3bcabe741e46441808f0edb38fa6e00dfc9dffdbd3a64d26a052e63a5acf2dd64b7a0fc5af214d542ed01ad3842a91f05d033436fb4a274fa23daff84be8f262969f6de0857cca329333c35a4a2449f2410ed9f65549306c63f63f7d6e3fa8408c637645c7aff2bcf1617ef442871cbb775accd9a656e48f63b96376ec08ccbf449e361b728087c7faa19fd91c155d482d6ce9ace80ff4cefbcdd56b7b8ce9a5218b95730ad6a06f5e0c7817a957894e0e9fe32f9e259b464e527f4a16c2e7c45e5afa5f45ec524b29a64e4d5e0a6127647e38ad92b86b033cbe441284302813e562b1ff3c6df6389f64ce10f56ca4765faa0134a3f2a0f39696e67dbcddc44f951357e7f84cb3272adebe27f73ced53bd8d5a9400c9e0350a230d8d06370e634330e26c48fa3b4352be9af49d8b5a9a57919f00ab68469eade2aa99ed9df10c2ed6309cdb16619c70c16ed8d75432dbc56632a8107a4407dd8c4216ad1de25a4541cc6786364ff51cb5c4736ce708c96054b9a1f3cfc93c8fdc5b1a0279ab525cda7bc7c5fb4937fa86d93c9e15621818293f19baf16c893412e6b92f1ae7573ccb6c0db7d9ae6e7fbbf8561f21127dfe47a5877c1471f3f1eb62027580e5006cde76ebc4bf7dec2aef1c45d75736456c616ae95037fbbe8b2db944a826360ff1592136be8909465a375a7d1cad0dd7043047d68d340aa5889d7897c89f28c56e289765c6a8ca4f221a05ba2be76621dcf197ebf8adb33c71c5784862e011dd7469804f105245919a5451f0e24479f0e5794a166eb2e94b47055984cf091d16ccecee7798ab19a8ebf13b8d299337bd6ee42220fd47a6ddc1113263f8a69877234bf281f07f678b7c14a466665af322a9b5993d72b3701d5a49ed01e6aade008dcc4b3080e7d8331eb8f4fe6cc7c0f45ec133b6d50f59969262b8e43fcb9f6b9e24c0f96a4d59e605662ee7f0044be5e543bc48e750e02a072a9f43cb12daa6d5a3388d33cd319c3b11396372ab528f8814e761939661e318cc3851ae672c9aac6743ded764e03a53dd9274ac2592de78f58ec27f3249376fa8c5638bef0d140b538b658d1efb482dafe4d2063e7be06d00afa6311c1e185b78815cef67222c16da4440b594f7891a53e7458d92b8dcb7263bc68c38dbf3d260c6a4d17b0289c24e1fc48985d96aa69286723fa6d9185d50734e314ce562d97bb9ae483f6f2d399d00f979bc3f145016c9e933b123532e9316ef06be8c29170fff2a657e1574d0ebd984c0098ab788988c53a05e43cddfd001f2ed9133f9c9cf890c390621d2ec0431184c4f57a799c059efab7908023ea6829d8f0f83b56cb93389c1de61185286b8c0c34be06f0be177f4a08580937ff0534a8143fc77c2bc3a16d465c21dea992c4c392027d29e4ab8a00599dddba60add37f7a046d663155867d4a0b1ce62d2260dabf45caa85c014e0db80a844f83c09f26796d9b193e2de9fdba42e04ac9fd07d32ec567a5cd6d0bd74f53b47943b9b980f9b7aca3d08dbb40f64b2cdb9cb934b8a844c9eebcc5cdfd81d1ea52c093ab5dd782ea939123742653cafd6fbb8281a19c7749aa075db1fe1e2c904a718703d70f46073d9fb5642fffdadbce1963a02955fbf7031b4e2807a5e87463a22b4c73c274f55f44e728494126cba859b54c86eff1a96b1d6a1d2b167ac3c1d9ec598fa2dff63ff0a7342c3b054de5a78bb0d45552098dd4e6cdccdfcfa095278b66f4cf55a6caa2a3a6a40d56de92319518a54178ec317dd38fcc7ad307e558dacbcc01173907c7145e379d4d8c149a2e5c79d2fa4e2ad57fc01e18938be41cfa606ed4313d5fbcc6b9801b7a797849660ea00caae5973158f401d4f58a97949f35567421d430ddd8aea52b51225c204a00fd99daaf601ba71e3d3bc951b417b27923adbbc348c496f5189e3c2a9f403c4258b45bc14e549be86b59a34d0f73fbca97cdcf3b35a9fce6fb551eb1ce46a8c8d6d4d3d622713210bf23ae6651012df46730a7edd53c5b8a2353fb5919c33d0e30ef5265f7939d4921564323f983f0e519943dd697f0c13f45a1d696fe5fd01b3739bc5f19c462ef7709d70fafcbf50ce0df7b6616bd3626591d26a013a1b90abe73462a78690ca798fa206d61dcafbf3d453cd61b555446b0633fb24445c19dfdca9d9675392d6b0ed18a5496125bf57deeca0412d2f509f8ddbce042dfa5d7828708ffa05b5d6c07397ee98fe8d2cc5d34f84ee64eaa846feca0219241a2415ecaff7eb23daed1e2331b38e74fd5b0150482807646c5c600d347b7b09983a888ef1faf3db0a1628f510a3e2c892e2e417d05a80e6e1062915d83930fc687c4bdabc147070068d64b77ff10b0565327b8608587b993e8d8f9f61062a00685ce8b3af9bf923a42ff1a3d5cb0124448473a0ce1e26815b4427993122c98cd9d93cb125cfaab99b7c56518f6896be489b119ce5bb3cb8c788d48ab310e7d7c29f1abeced5b0348bbd72924f70aa5017f31c12b179617ae937a77ed75cf8ff1826ad48c1dadd42e0c78f9d1dd305f1c4303cd73fd0200fe1f0ebbc15e632863a7d333e663dae993609c6990403682e21e00e50e24d71744705994c3d9d42a835c4d1616ddcc0c1760a3dc61b3fe21b6744be92089ab592cc623dfb41e75eeda87dd601e2409e9fb9c7db6560227e336c09852a5432923ad909e6911b719dbec6a4ee8b9437d9b153207489f4b67b775022749604690b21af48a4738661562fd37a725e6b0f1121fe42d43cd78f10a3e7fdd0515a38843c4d278f17c6339062e92c844a73a08cfe45c46f3be264c446021c2c7947d44a23ecbd6a1dcf71f8cc6bf1ff67955a7ad68f843ccde1a97a3cbf97ccf9ec4d882728212f413a1e718e8e7c0739315220f23678acb38a0841b689593a7d3a6dcb33101b54a0d3284602a69ff558607ba5e02ba23ec9afdd63003201f85bd66aebd151c24d06c7a1aa234cdd1c9d9f71c3650dfd4f3537e3a1f4e650aa6b8c822370cf00ee439f16ca96fafe56a9d4810c09c67536f7069d6f2234b379c2fd4186f55955258c48751714da0be505cc184979dc266875cfdd37db134fb6ffdd73a4ea5434b6c3bcc02b064ab244d6cde4c34bd7c82759aa33dd6bf133ce465d2a25118a6a6e5d4644f49cb5986e3e92907b03cd8b323a82a4c3b02a26b460487b81251740f20215258a04a54630ef454996b0e860a5a44ee3d30517f9f0b0e7fcc43f3b57359d92be49e45f42e607c3cc6e815d1d9aa7ed0c3652939eabf4004211a5faebfabb5846debba25342fd89a590ee62e6e05e96791f253dc64144918f311ac96c04e3684a9f0adbd6ff99e8d3f61f848ff6809907da72ad69fbf2942fd2c033e04167700c479a9dfe10009d8cc719c1557bb35d854dff046ae9119b27e9504c52503c380dcf868a3f81bbc2510d8d47da123966e74650c38e094d6f326ce530fe9e49a82e7ff15195cdf7517f90d86ff15a95664e454fe995bc030061f0f355e96e67a1874a44d00463e3d34e00ff2c152b336e0f1572e9ffca25157c3cb127ef52a10c860fc98da78a7aeb380eb2d86b4a80ca965f9e894d747bd2028b7766120d4ed0221be6bdf929ac171c788aa78fd3cfc11f5bb6a19d1d9242cbe9c1e61abde1d3e1e00f300c5e85a4f7e9d0002ff07c8199c9d305432929d5be84e63bad507c5d6e6d9cbce26fb99cf75d2bbe3eb86b268adcd4ee47e48ab2be724ec0b03924e9133a9b44d49265557dfa815fafdd1c87b5b6d9ed08a3eb4cd5014521aae179b01934f4b3d33109edb47cae695138a4b88a8860466fe64e730da8812ba1da13c1923caaf80965d77ce885d78e374f2d2ac6b38a8b0213fb49fa398be285b0399c4c081bae86a064968c71c95b1bbcd0cc8c21bc0824aad4fcadec5ad120ad59ebd15bc701dc65244555f5e4bba94b7b49605a1782dd469df5c882f1dbd816f5f8510ddcf3c9678b0929d439e2914a0f950ca2bb00dd5017ec99085e6d33cce847c13b96f52d5ab0ef790260999624f6c92c0dc5fb509b7d9cdf9f71f26a158dc9e2f0b1546b6c6d44497abc9de0d40dec65b6b09b72716f6b8950bbc7f1048775118a864cfb8e0771c8f02492d5a6920b3bfe2bbd621db5b29b5fa93e391f66ac7dae5cf8be14c936282feeb5a94275c489ebe0efd7727f13eb1d2ed879c18ba1d84154a3c2b669fa8119c9b1b3daad613e7615c4f5fc0edcf8d13154ade870ecd583058de9f848954af2baa8f671e196e8336d22e1fa843d261d2084298a56833d753663d634b19e8d73f4860779f2ce4e218b1be827a8ce0f85c67651fe98c23084bbfc7a6c8fc31f01c278bb8b997ff30677fac48e5e595c3afc2fbb7c5c8c26f3ec3fc4dca9c72b7f5f8081f5ebc2350e8e6000509834e8323d159c738acea977152ea2f025367cda546c8dc5478b44ae00d403470290504a987bff8e53131882fcbdc7cd734c2749ad380a58be21051d7339efd4c7449843371ba6c5c3e3c77a1a7aa238c60e592404d79defc75c2259bf9a1f56460d7323b594c3cff8ac535914b28f48cce0ca9da8f17fc95c26eaa2d6664b0593dadf021501406be8532b4c832cb16f9b2a1ec551cabc811eb3d7256ab24be434123363e01f37265213ec6cda9f46b146d70deed0c9a3fab02b0a291ed5e298bd982faaedd4ba14dfeaec829c0a7c0d478088c2ed1cfab93dbde012ebfb377a7741f1ca3e0efd7a06702222d30bfa3a55b5981733643135d1a42da4d8726e0d6e77ee10ba1ac91d19b11344698ba0d0323831becd575d68f5c63c213cfdd68fd59dc143df04c8bf2e53444a453e5b1fbbcbed1feccc5db81cb983fbb232b5cf9eeef1887014783de296b57fd45d14005c5d5c286de07e8caa5439f09882642789f8c5fd77b9dd67c394e53d5862ce4dbc90c6b53ba8e0358c44b08ac9f8a9690edbe43b7d241ef288ec2fca90cd6b98693679cf309f4f10c836148953adb2d6c6059ba8d8aace0aea82ff973f6a57036c7c34632deca695fe8538a441841dfc979e1defa642e012e454afb9d5a7c5ee70b739735e6ce34e82171e6e76557fe91cd6cc8ef0601c2aacd634820e1a3de6d074d82b3b5e107cbc61a4bcf85bae6779d6f727602edb9619da82944e6f9b182705fd07befc722d4a0c74ff924112442aa7bf72a45ccec5f98917a18b59f4878b55ad395527d02423344bdd61fbc063f31c5ec0ecaad983fe0e76ddb281e7ae92998cb2222cc50e8f3bcd6c6624fb77aacff0534a72b69c004a7451d16743fee6b03e4fbfcda745b495c5f9e967f887b4da89fee5c42fbbcc925213549996f165143216d9fe2637eed36d2bda36e9914ab2553fcdf41183d7be46a99b997555b8c3daee6b208e9425046a7d06100663f7249ed86bfce5b40786bc0cdab7f73c5965114e01b9ca44be413a66cc6b51e6d6f512d7289e89ab430b118faad289e0abb8865440f1660799281c082ef7d996d3361fd3cbfe5146833d9651191a369ca1575a39ee0a4969a7c5c616a041473fd7ecb5338a78a1be1be1301fdb1d491d548b51910e027b111c586c862ef9376c6d38162df4a12bb043d382be402a57b42ee58f3e5e35d4b036daa21a5fdbf59e713673b33ac8438bd4e04f9f0bcc6ba18809844f8b6143356524ef8f91961fb9273e00d71a0c45881616f6c5b603f49bfbb70f977e55db23564f70f5c219007473a55cb771adaeb45b8531b915688bea087657879cf7ae9acb73b3e86e4cfc0d63487aa78fada1c72d7f781bb3f129550004be5a8db0cd1065b732247415c845d3b78ac160ce98e2359e11eaaafe188ae7f96bad0d18b7f7173f23be64ff514a59a24c48881f04caceb0407b0f916ce0c0639176c273a189067e372e58122a2873bdcc8aae3bbc44e29607278b5f307b423b1f44921e311cadefc5f1dc2d07a48e3b8ca1d690f6ad3ef8a30e173b32d52c6c5ff43f1f8ed7f3756d81d1d0ea6628137b5893b767c3cece622a39f48639ab846a982e8b2b93007a43174cbcb1530a54cc083c0c5810fe2549e2e34682ea4aaab2ba1fc8477e7b7bb8eb649448181ccd52b7a121959e8120d7353858cd4d329503851fbf32078de9dd609c49c136ec0666ff056ff067f82a5db8e18de8fa0a2174f0c7de0b8b48a3cc5d89ef1e3a5cdfd8ea824317370ba637260e248eb5433a43a99fd6faa37f76d4f73d9387bf986d571a54e01e8c31e79b794f64c9bbd98cb119cef325ff1310e7bdd08d56acbc0ce172a3735cbc277c8c356da9e01997cd9133865a689db1df59dfff552e2ed2101607aa9f421d4698843558db7852cdd0bce135702a5a220f7c7db18b96f869bf6a2780e2c9fe91efddeef925852af43feae1029c5f180e6626022087541f06d03eaf53810a20bab9eab5fe3335209037e5b3d91f46f0261e980dbccfd6f055878256162d52bf7643ea6820e45645e7de1070ece02fd78862786a5aa3e243d01a4b4ea8980c9924274556aa3ed3ff632697dd33d654fe857b341528d2b521eca4c288005e849f21e23009375c2bff53e321d1a1127874fde05e85830e94ffc68a9e5f76e93a1597593da23ce5ad82e30fd7b7b84e51491f23575ac073d4b6834423e830daa3f82e0fe6ac5f9674778e5b0f461fdb932878718b25cb2952cb14aee308f26612006af9c1da393e29ec3808467aa72b399213fb68895bce192a4b530016d4451d5b5639b04a4f864376512acec1f82c87de857b2828ef595458f6b65cd66e519593b1ae54230dd593db7bd57c3e1ebf7caacd153511af6b06e024cf8932df5b72bb63565cf9aa340be5e146337c71e43ab6419f5278d89befa7d5189058dd893033a8ca91f677ec07c403318552ae3927dd6c0e4f22ea91d5fa9db61a69a3a68f0b15f5aa728ac34ba59ee98f67ff313491d11ad43ce4a40054ba8903dbc3447aa21e699db57b6da017b28d59d2fe27c3a234970fe8c8b65bb40ae79d7dcb8d20e8a06b65355fb9815becf6e66637d88ef96e0720442cb2c057534669f171c527bfa2c5d9be7069dbd5b9e5feef8eecfd61975308ea37f00a8e38156ed7a747edeb3c59713d45be815abd99aec422aae935b388f0291189332587b1f347114b7e725a322919626963c380376b45dcb62a9c0cc1d9a4ffbcbd4bbe050077f49fac918f7fe07580544aac7d178669ef961dc94c68726595d4d43504b94342e954761fb1884981c117b3c0c51177d43dafbd65ffb522c8ef6e81a6e0c081a1ccf7c7cadbe3673186ef074cb107fb850e91054d75e71e5b670a54445556194c15e3c3d5973f6565de21134ccefada9e85d8fa1d5f0a70be1fc583049819f5c67613bb9a38c9a6bd920205af1bd6b2b4cf5255fdfa4e864b4cf2985dec70f93d521f8b61750c14ea05bb020dcba83a0794116c33d0dd95d7dc9c95273b6610a34678c3a21fb2138b3faac6e88dc9f2e5d8399a00eca48165412a720f1faf77c650c3be91db73b4fa4821c71b41dbd38d0c5f38d4bfc2cb18be82cc08e686ff8e9e7360a881fd12395ea22194f85231918e69eb1e4fb2f19e2593fa5a95c3009e545973cf1bf4002866ef1607c121694ca737c11f7c5866263acec5eb8220f13fae12cb30edb560e130a5c988b3548b19ea03e4786d98cffedef4842efb72471af5cef686a15bb6286ee47072ca48c9cb575aaf520bf351a5088e24c6ad1dc135e693f46b009a06e59ce1221003c77a184700b4f51350117a29c6049ae802ae599e6b96fabcd545fd51e6ba80762082260dd6af76c9e42db5b827f9c8627db1e8442016dfb76d548c0cbbc9d9c8d5cef3ee91e9b1d0e0f3595c99c02421b41718bba4bcacc6784ce15caf0c011faaa09cf8c05b2f46da2286642ed6865f3a75a6e719c518233afc669acc1ee9ba56f3456073a6bc260ac69122f7883f3206b78d5daafb7077ef90bd02c823a94d27030b4c442e4c17c23423c1674013da0c3e837941f30be9edda2963e1902ccf6ccd7dd027738de177e341476c35a7d5c985a15ad3614df3c8237fcfd82ff5e7d20743496588b1c1fa9556aa52f24c6c95d6b2df96868b80b50d82087e8714f28691877c67dd35da7cfab424f0fd1787aec3f30a4f1605ec181cc2f4dac02573d0902ba910b821cf1e187de612ccbe127438dc0e789bb1a4d64953fe3a529ae41a2afe752c04803efa3b3b6603ca657a01978fbcaee01fc7a349d8042cf2c759ad2778413e1ac8b2bbf96298cb1db93b3dfc65b6b1c2a00d082abcd107832e43cca8e4b09d72a93bb808603b3055f260b35acf1ccfb574aa14ef1a8cfe5b66ca4be501c4f6ecafbaba2fb9cdf4a687f2af0e06ac6c39835516ccc7d4de16a29f0fe2d7882c88f53da7a75668401babbbf03a71943dff254b94b796349a4244f1fd63d7d2de533b24584a2836e096770800ce477a5f4beda023316203288ee71ca3bd4575ca22005320f0f3cbf0d367826e554659726bcae40f3eb4baf851d8b5d092d6b2b9ae04ea9241ea305a39ff67ed0da41d68474522dc08dc8407fd2420cf6b0a412a3e16cbf670224a685fd96e98d4396c275ed048982960f098a0804d040d4aa921903fa800768cc965ccab8c253e9d335f4259ac2a99f18217c39b9957d4259cd5223b39c1fdafdf83a1c900c37b0219603def2977e310f407b52580401b0df34dc1139dc0323185884d55849273a6ffae9d32fdbce41039f68295829d06591a725e93692276f60eb9db7cb3eccad638cdc73b5cc59ed5dde752aaca110749f8ad26446e73689e2900e675c6c50fa68481f6029f3a4219dc4224511a7eb3ee4f30dee3f865a67f4bc00645ece5834c04ccc43f88b09cdb147208593d7cc46d5a95fc765ff49cc05e8c4742efd70bd2260700f5bdff358a5561dd4a2c62233457501e90416e76ac502ea3da4f8c5ffeff6503db46f02cdb3a51b6137eb0714493539c5210405593456477f14314e88121267380963048c476c6ed19ee09ee2780f9a32254d6c4bfaf448cdd347129894d684b8ad543dca28ecfec8868f2ac60d7c87cbce1e98f970d689e682ccd17bbf8f24083151853417190f2f15402795222f95af889d687146e839664c1db0875cf1cade72d0ada752048df9fb5abc67ef641990eca05bf0c3160e887f3424f6d9484a3a0b83c3178905cf99eed33b3779e020722c99169014f44efe419dcbdd6e26be121cd29df680de8b200aa3310b920531405511049552e9e9961784569e609bdb8578306e2cc204f6414b27f276c3c583d6836b0eb7c85470477f377deeaa57fd7c86b06f6637a23fcbf94b74b3246c92103afcd98e1f452591e7d271c4cbb94739a33d7351d2d4e07edafc3ada22f48ab4eb455c425af53f930e7bb959c296b14d517b16e8f7201bd13ac98ce57f374be60750262f2b37f31c96cba03be83a6fde8ac3cf9c4380dab5955b60c2c87fef4bc6b373575b4e4796fe0619f2e69123b01b8bfb133faa996e71cf7d580610ecb779f9e73bd37630b9ac7ceb23219c93eef97b6dd9ddb5b85becee4ca042edc660a3d38ea4ae4a4c426130638b4a2ed7f1a7f531e428ff5d7bc68cf03af2df4cd35fc3594971c3f85b2529e3e3a725e1a2846ce920f44c46f16ae4ff891f26e3d8ae8c00cead24c1583c12be84af1061ac24d1950be7657491e94198cf18f02c2e9bb5578d85bedbb40308ce1310704b6b785820737301c45df63da1d2554f0fdbae45c4124a9216cad4f30e2b2c62b0fe330db412c3d8411e90113abd9891f35ec908bafe4c87e2e2360ced353e4db5ffec8a60327ff39b2db8a56abbcc037614e041a85a6e17cfde7646b5c0b40a7c9a991f3278228d07a3e5272b81554f39f62a8847a1bc666f5d37a56935e061de4ab64cbe1f6f83280f2fd210481052c1089c34bfdd0c7f2e1c061103c708561ada200387755539a78ce88a0a020b8a51018c4cb53e4e8bb491059af3a93988cf851ffc5dd34b27a91f526614e886e8dc6d5219821052efb55d6fe1d4932389326f1679664c61f6bb64a8a2cb085e2c09c1217e6fbcaad849c2d215ceeb26df67a72189aa0c9707e3cf9c7c80f8a00c18e5c9aae0e094d45d37b2c1e140082e8a54eebeba79b4600c370584639d2ddb666a3bf590a52c367b7312f0cd53e1701fd3acdf7f4eeda10bc13949983b3e45d8b522c2d6a619ef2ec9d729e2523c05c0247b730c50782128630335283d22fb0f37883e23fc0c621655992790c87a3a175fb08bbf2540a79f2bdc19be8adfbd223b2fd60e12a29f47516ccdf352663ebce5d4f19372ce82b233d81e7128488e9594e133053a7222dd106a0e9e06ac5ff230bf36dc7cc8532e0d475fb9d9ceb478c06652c8e77ae6f752b7b2608073a7bad43d514426024bada3ca98063db6d797eea4e807708e33924ea34fcd948ca0dd5f96a37ce0488b412cdd8be76d723e393d7c16a83b7ddb9ad371d67564970914cdec3170e04d531c868d47c520cf684cee18121b36aae18f52ee9a7d321a783d1c27bd0a5d7830b90752c7297bf4189bbc1d89d42f1710fa503d50a208d742ace8e427f748ec4f8c24ad30778a830a47f3d27a0a045c70070b09bac8a653c10bd17f812d0e6aa6acdc0363ba748ff4917126d3b9e3a3e7ad5bef890953bb45ab3190b8b9bc18f96c3fc4e26e3d8e04e06eb0a5eb44acad38a9d556fa72a8186f1f0ef35b4ef1e62560adb34c1424785e9e20a218e8139e8ef29e112db56233c422e69a9d2474dedad3740cbb37098f7f20fab2b25068a542b5226825eeaf575ff451476fd872b5f8a3c505836ff906f452aca7848c6b2d2c052c1e35d46ed0dd8032e5c047b84bc1bf55112c30177f402120cc08d0ae76c73343f26a96c4cfaf55593a22b5e932cc24308e2b85502d868591a2448e0ab76bd386e4097d92513c80e0bdb99e9a690e477fada0b0bc01a698e638b1e83eb307a3a2aa7dc1de19665cabb5a967532c3b64dee0f039ccaf8845ec5b6534105ee4f48158f5d795c65757ffc22d613391e6165ea3653367cabc5197bfb0a88ec2018ae18d4b1dbcf746e1cd3c8596b3a9ccc2a38d71f42dc9ad9083ad7bfc6915f0d6ce91abe66f23545ca4444c879ef0b9ccf37d702b4f4517b4353ddbf3ef991e8e19f4320d797601317a1f848f0f1daf190f6d22d18375cf6d9239b9bfbc48178efeaa83f76e2dab93ef8c66ad1b79578afbc8da7d93415df631cee81e13382b06d80f9d2ee11aee1d680c167827612eeabfa5332e0c2b01a6c4d50486a52d616d0cbdd61c1b96056759d3cdd3b13cfe732b82fcdc012dbcd1206197d105e5176e7f4f990b28766951b4e0480331f2e9bbf6dc1ab967d1ce6257bd53301e6cdb546f94c0384fef4c28c3d00a71ce2821e3025c8eb1255d789d092fc3bb5c67bda61ddbd51cb93bb6d9a75cb207568823c07cb1143eb8c87f6188971955bda1fca9503b6dce677db49d2695c0b449938b12898d4fa00085af2cb1fb8390ffff2c8224dff5d8b7f4b7118b3b618ae117bd9508bdc8eb3355aa8eebdd14715ca2b6c75a3b1b4dd950a1a37c48b7edf505b40ad6c02b23006e1541e0c6626e436ca95d5f5cca738178de1a7671f843056fed94d81fe04013638eff6f04624e1005ce44cfb4390c28dbb3c9f1f5013ce07db6d36185366893eecf2f8487f4004a457840be2dd48e3dc06ebce96c7e7400d0763da197102c95f312c7fc6bd7a226ed3e8790b4be106f0f9bf15e3d363e852ff7086444406253078d8c99377da090ab8dfeb65cb83908335264deb09944757bc885d072a64a242edc8a2a4cb9f7fe3013765e3a9b0438a11c597ba6a088338a2d28e52a49de502ea10fa9fff588288e172be65e2a8d64cb12372e129ffbdb6250b9f931d20106ef6cb6a62d301501ac11273ab8def1371a12fcc6e6a9ff23f7c0dacab970ee58443fc1b5f70bb81d1ea3075ddcc85fabf35a573f6e4ec08d16627a8ed9e97b47ed5a4d41a30ef12dbf4970d8634cac5909bd13cd599ca3666a9b21b314f489c116c9636805081d3231dc16d5c4e8dd4cd3907ee314162c0b95211a5297346175d346e5ce1120860f1afe505d6b7feaefe13d3e9f8deb10d2ebcd020d9ae4b24a04aac2857e0595c1db1910b05a61b705d133ed2f95e0e79e23e99bc9cfe7660bf974e5eddc6a2ef8eee7e46e800df9618ca25d9de087c76baebda1ab144e92a5dc7b4d296be56a64b9ced855c0b218a5fec30183a0e81d83a1f4059adfda44b2ddf2f3a2e576a26863f8081a975d2b811bb1be5d6bffca1dc29f0ee2c5281b30a2ba774f2241043a317b0f637928eecaacba6db187f52e3e296a23ad242c4b24d3fbcbf8ba947ced3c221d5fcd2ee9fcf3f72f0c975a9260801b81c41cbedc7369779570fed491ca512051e326346466573d3eb483f4d2f48bb70ca4334e63e34e2d0275062f7e1a34ac593b0d125f8a1e561de2a272b21cd2da3660c3614159a0e26393a06966c985c3c35001f4779bc7d76e7459996fd3ce92c35b1f55327737b201c422898f6968ece6e1bbf842d56985fab1503ae9d02534bd2d385b8e0505742afe8538239b08cdb458875eaf9a8c3c2d1998811c7ebce871d3c9d2c5919d8e1b54b6990d7c1c768bd6b9aac593e979153d8387fd811efdbdd2a809da8eec1fbcee3a090eb4938134939e4c97f6268e4f3aab7c41e6f5ddd0cf8998f264a28b555785029976a95d1cae890a5b6c25d5b058b7e13a53f5b93c818da0909023b4db1f605147c01a974e0630133cd2a1519d379a73bb4f786b107b312ca98833502d5e9f6776cd8e45ee225c7cba9be54ffbe3b0942f5f99cf53e627f3bb8338b3612b7c59ecc9a81b96e36f7c66160e452f47b7753d58e41cbfebfc20230accfdb945568c1dd002f428b0b400c979dbeb6a5131369d1e92f4289965e3c2495d7e9f04f0c6759489f6c4ea40fd40ac70385a47fcbb48cf70051c07e69345457b856c55b5cec4d0d77ae5953a7e12f32243edf7563d8db8c904bc08a978da3e76e1c3aaf108d1c3ff3eeaef3334c827402a8869e9245ec2d1e0040d797e0df0054f9c556a265f91ede2aa97696be40b796bd5e3ad9326c4406b17f029bb602414597a1df37abaf62db2ba6c1921b240943dc7a5ceadcd75bf3961cb0e5a20b721a9d1c642d546bf6bff4d60fdec933e40ac559784d7196402bdf110300b187459cb1a3cc00e730a69637c006eaf29e1382086d5657920d7fd41ac785f247d91c14b31674d8329b475bc02bbb7b766f7525ce3bfd81b781424f3ba786ce008a8158c5dc74749d43cdd691c46ca377d11574c44c0d20e1760962d482929e04a3ef8297239b1aefc2a48b8901794f80a5add34c20031b45380da008d721a57bc493f0ebd23c7eac2630eba8cac23b784d13bb54c1ac35e5567dc7eabb4114058c8528f1a0f6c19abeacabcaae9ac7aa2ea4abfbcad232114f89c3fa054f2b42c2a0d6ec3ee950daad450389631345e157d76ed83210393532b6eb3188cc1cd872ceb8bc5815ad3e4cd94027b26bf8cb66d6e7874636e977169cc6e85b80a5383a453369eb739e14046145515ac56beea2854e89cc85fa34320d125467947a2aa0c48963e82424f277db6c2f9eaadbcf3fe92bd583584c543806bab2e1ca9b2ea20d4d1b94fa6b1580ab48a452706f41bb9497d145d660831bd719aa03a87429c2a5787794ac60b8f1ab6cb4945f37816a8cd38173e0897bbef6ff0686fb620f2b20bd683e3a29a222c40d3b97f4f38dded164cd17b54485c0ec3b96425a1e87e1651e13ef5b8d306ff1b912927d79bcd893c1b68bb64d8163bc4b84dc0e94550f77434078baad69aa3cf30bbe57719de8c797695413d2d53e1e16e8e10a753c63923c5d8ad1aa9aca8c110726f3ea83ce7db7da9954078e9b56fad4b3774ba9c344a28ebc68b3ce1ac6d7f840288b7d2749608e0c0951a3cce93233ab8c8f8c00e03bb2af8261ba8dd661406b278d7741a53abd32b134c03ee1412abae9de28a61419f6821acba397a4422ad7ab0836ee948d0f088eb64945af8b18725cc91b675a699d3b8f95ca7d51870fb6d456ca8b49e90c0104be131dd06c8150717942c0d84420957a85e17b7822851fbac932198cb30161c6d02542465ba3fbaa5d0eb3b7c86bd49714815d518a8e3487a38dcc3cd3ef199ab878d4d740a382ad4b2d631223e4106ee6c827b3eea81972e6a2e75858879a677982aa19d3c17cb3f344e0581b9dd6f48cbcfe84d45e12209229032183743719fd8f0881c6ed599d0ab4f6753ae89dd50aa0ee1d37512c86e6c70f1486ab46bcaa822b89adeee2bb487e3139922a60ab351d5d34e522dc29f464eb02494368fdb3e5965e74a4e627c4e8ce6f2abd6438f401d5c8c5f9715bdd63d1770d061da716be2f4bc79bb19410e4bb3d7bf0dacc08a68781177092be7fa485c1dc530ac22ce7bf7ebc4baf44bece58b89434541d6175d84fb9edf9191031cfc9d9cd939edf7d3e94a5e9f86879b26c93a202fd9ff63aaa3fbb90bec294b51771d3829cdfab7dc873edbd9489f50cd09a2fcc695bb60033dfbdba82ff8e6ff05c74ef40171ea7002e86d249891fea3db5c5ea33b7f8b06c752b2529db25df431393f75b6c1811b26f67a53387add0b0cab8ec75ed7e8634bb7f9fcbdcbcfb0c8ae5680f72eb5a147559145dbfcd9dfc258d4c7efab7e0787f29a89f7f725ad347bd210e131bc8a244cb69eed6451e337b1fa82585f5b596b04ebd39a600c1ef9da55414c030a4b0f13318d46a1aca4b2b8036317631aff97185381549648d29e992e55e0ad764e7fd5cd1346d1bd94f1b3306dbd35d81bd52ce3ca0ff76e349b999d9c0529a5ac0f2a3924dbed1ae5b7365921f8381c1d4c4873e9a9d4b3978f409b9376c944f0667b1b7ba6a82fd1aec9c2674a49d628aae22be02dd8e961dbb4f0fa173bb73e017bb4b6ce36d19d8925437e2f52d8b5216ba8359224746f1b422e24cd728bea2cbe52c13b522b98edcca384fedaa2ef749ec6b7afaa14a42a8eae0842cceeb9136b2098a13c84c18d6dd6cdc97f33e18f28a678a67c4722f36d50212006982a40a34f130256b02680c9cce06febb7e6a83d886ec82c98a995dd9d5cbf3dff45ca5e799a5c0a965065b0837c7f78c3ddaf3cf61ace6cf1631fc00f77394f6b580f6deb9a0a61af23176f62ebef57ee199152baa4697c21e27b8cb5731822850c87925217cd7cf11e5518b920415947696709d35b0447cc3ee14a625d56adc044d6aff7677fa8a85ddc0c0f1e6be45b422bae643d2496e961e3108749c68f88b0dfbd8397dd639e98dc717a88b98ab3ce9954cac0bd148a1ed08d3290d7f931e578dfecc4438f4f94d59659e673ed824ca3f5e733658d8eadd8d347228a40ee94b36d726afe5a02ff4698b9cb1d777e961c251b77cda29d0d5bb5cf0177037d4bc7133eb0436edc76003072bd3cc5ee63628125f1a03aff51587bb0edfbe039bdaac16d6813d9f600ec30e6bfe92798d4451b5baf3d89f976c49d52cabf51c16fdc9be71244ed4274093f741ca42eba6b6e96d5a70a5cf44435bbb9e01e3461b3c5e1023ec87426e1c69749ff30139f86ce75e2ecd213d25080b5142bbd5f7af1c3024eef34c72c213a8acbe27b7603b9b86569e8947746093f939cb0b50870940d4609d091f6a3dd4e9bde4e8642377399ae04acb0ac8f9062894afc5012d7e35458e95ae40a4c042ab688028320877ab03b7d50d64a51415c07faff1c695aaabe34840184dd7deee65c541c1fc853d294cf8f4a9a20d8f25ef0f367ece43b9c3f6833cf86614eea06ef526c04a940f4d0a8652d2ef3349444db74cae750ffb57cbc7d9cd08b3707fa4c9c49e3b436ce3d0016c453b32e4ebe2f16fa5a1b0ae70b8d9aa36479438bd0e98875ec80d900e8d75f5f85a4325385d11c5b3c9c23647ac61fdec66732674ecb6be903a890355f7999b7dd45f966597e10246f5f996450bf7bae539f0071e8fd2cf9196d9f71a6e5373918f043d5a18440ef6c6fa69a294cc3aff752cac41a49bed1fe680139e574b92e50cd0ca3ccdaae2a4ce5c5e9f9633110ec69a4dd9bd4bc9e5e1a1c7baaa83e10d1241e0afc73c663fe630593c1a0dca03f77c5ccd340a3ed1ca7cf6ff058ad3c5a04862a0e5c22427241440cd576a594dc31f876e75d74a4a0a1713a4b64a65f64c9f53e51bda3bb0de483e32250398eb62814c0a09e0a36ef1cab3ae87e71144b2dc929fd3209541c0e7e0ea8599511cbd491bf5503bccb156f22f1473bbd98ae33d0c57806ec5afa35d7705d322ef9da4fef94657573a5d1202b19e12f9c993e83e300a75d052d5d2d3c8fb8e4329efc3bb821bd152ad67549c7aea8d5afcf906409bbb4b91976b6578424eb8d03756ec59a250a6a625cbff374f50083de6f92c91fcdd57d76b37b721e306a958c19f568a59336e05dcd7064624d1803a71cc4467186915d68a3faec04c599237576d4c749df79d37111e570bb7d5fa3001152c0ce2a79a60a9f3a3fcea2295145201eb10c5406ab03061ec3d76036c2635026b3df36ac0a192f2d89e94144753bfb2fb3a4b494a494e906e92e07efdcf56f48c2d2efb76ea87f681ec88461825d5bac25b2b242f496b3fb3d8d94bff179d2d2da82701ef04fadd3721fed1695c1c8a06c28600fb03f71d10eefb9b0e67655b6edc6d65fd898634d51bb51dae4fbd01a749716993bcec893e81a58a7ce8baa302e9ce706ee4b13f75e90a1baa1d5cb6a84aee596ff96cc0da8f4d32d3face431077e9b628d52bf997e20924b11796a686cb1deef7b06f46395ffee59bd4bd18a31b42fb81bcde606484040fcd1226f38682c05f39b0a9011358f249cca7e618e8e3ace4c8dd4d9d8b8b9ec828f2f6c2515ee4cc15588bebf2e002822506941f1078e6580a5ca8ad17c2f08a9f4f89cf02bc06ac2f82c9538cd68878bedec649a76ef75f9b1abe24530493045110e7087f28a24db02b48867d6b61cbeabfedb7970bf883daa6f558ef0a0afe74306517d69ba4179eb2143c1cd6d4344676e3ecc6cba6953cac3583b3d6f36debf94496d7836a89dca95d7e5706c93c3281177bcbad49482cdfad0f8fbfe112daf599809f11acedd71ae830a7aa0a3599136bb08f925cfcbd14b8c2ccc0aa0fa5949295d2be5fcf606fda0134f9961f69b911b3dcba86f80d9e2fb6848dc0720c09b586b97d875817b74e6d1653e10665acef89716fbd3511ac78948649ca33559392f01191e364eed2afe23b39b4d06b38dc61c9783d84af29ef1894acfb8a4f3e2e4f611298c2cb7c97d943721b001225e53afc000e79850fd666d9f9c415aca7518dada679bddd5b623ddee7daf6e82cb9de9ae1e07168cc9347cd45d20f6645a2cde8703d04ed2f7e0bd182befb0182c5a641f4208eb57cfc2ee2f84d6317c90129da4e83e1a4fd03334a07bc8cf74467fc28a7c627c27e0448d8ab7af84262707a54edd149c0a6a36f109247465f2f5ffbc33c88dcbfacc7aef1d726d0775d2185985d7188f2b2b90ac7a367afadf14ab852599659ec0e7cf8d4f53d35d95d749aaab2cf78d32bedf393c6ff90d4a14e173c76075aec72ad3dd36e4c9b59fcdd0c9b5664386431f1818ae3d67556147cb15bd1439b9499d56dfcf77d8020ffa816671ef7b18bd8093a56412025e91aee398834a1fb3cdf267f72cd87800ffe9bb9f46d1182129c32afe531592bcba89f828b14d6add03e7afe23402e8cddaedf8814e2f489846bd852f0bb0c2a55d6c904fac2e7fc15804f8fb24f04baaa2f4f1cf9028feaf5ed5d367de9ba42e00e81b0c2e5e6876ab97425df2ff6396585a02d29b37eb74ce266ead0b917aaa9bd699dc934483f92d5e18691ffe7ff02fcb9ae319e280a8881c4ace7c4fca61010854420d56b886745a4d40121ad2cd1e854c98284433153929653be4e499147f33e287b032606a6534f0a174846c3fb67dbe7487a0923f04c007e248e09e1ebc7d387cdea633c76c72cc1a831b2a7000d9fc6670704458d2eea8378ebd4322be2b58beb3a01903ada37e4c522bbd31c0208758c7431a449c37c2e175502e3555d25b0c4b6f3120b1c5c22175a27766747d853caf6de02865ec737d6b53df2c954cfc38e10266f97389edb0e56b58b18e28715ffed07f102cc9fa315fe99d4da7cbfd4c8091df51a617b2fbbfa5b1d77d112f0cd92bff17ff6023490c11e07ccc75ee3e5c7402aca2349f0c134303c8e9c7ce4f35c1eb10a7802859ec47bfbf187184b929b3ccf5d705a133ce0eef05261f85897d456dc787ec0ab9ceb6adf921844e628bcc534b05e57ded3ef17fd2735c72fbf223193e64ebe20ae632ccb53edce48e652980c64a692cc8bc5da8dbd6ca5f13a1b812e5e76a77a1f2c97d3db72f97ad0e2cc29d7dcbcd850c501c3279f96cae4dc8655019adeb0bd4ae128d2a7ddb94a509eb8bca0c7561851d150b29dc58bb50ee8ea73952b9f9349e8d0a7e20c1e6ae94ebd785283ecc91cb691518f7cd6f055252e259985d34c9889dfb77467231bc12327726bf37094736701ed52f8fa42d916783d2eb7789379a5c956d58df3ef5941ae92c46609116118c84bc2f9aad79c87b47bbe1ac7e5468c42677580bf0f697c842db605313d485b6195b710f375925bd516d0c02b123d1e6652281cf57871f32824bbc75ccb413b0006717c1cd5ebadb7a5d987f63a7eee9adcdf01c7996fed4bbfbe2d1c395f380249cc507965f2d0f985487da97c7447f90141535e7c51ea193173852de5bdef9f6eb6862525939e5d0bff4b429c84f168f68f96a02f4aa1d2558592aec94ed6da5509f9c5de3cc4a5c93e353f6470474eab07a33289e860af3e85336ae2dbd83e9381bc97ed153f462824b16182c594545c9aedf9894d0bd04ffc3b85387df83cd819072cf199acf97b67878e94ee246ea14b145cf526b09c826c8f204f9e1b2c55f3e040e97aeb7b281605639722a7277d281fe5d2e2ca555bd16bb8bddb6daa2aa02dd62d20ed3d121302a51a6bada8a6a7493c1b310702857ad9039d7591577a26c26eca9e10de617ee8c3ef61dc96ed2a0a6371b9c7651f345dfdf68b94269ee1b3976851cf608b2c1c440a65a5cfe6431e1b3ffe1dd538ea1cd4be4bb61ab3f958f7c5818f2d5706d431d0deda817daed9f05942dd7d0fe7f9b04a4fcf6c625e46fac8a4af0d6f4a25d728e6b1dc0407160762adbd153c8628059447bfd020565dfcbc3c4106d095fc16b0d3b24103921a55e39072ffc90e6e71f1adef6ae0bd3a2b7e4f0dfefc6bf68ce9630b1570962ae3d22bc7038e4a9f1bbc367dfd50527eea26033c6c606039164899687dcd136de4130128f2c890765073afba958e18e746605cff38eec3cccb2da82d11fa98ee2cc975f0f35701f854a48c62b858dd9f924678dcd2848f868a18d99fb1e2dfdc7b70a1af4c284f5d491c91cbb88c5ea293c61f365c6ce08f1980b4472593b79aec2e1a2ef0f008c1a9315aa3a2778bdf7eabc9bafc55aef403e326f191c053966218806850adb044c13af71595d53a153530f759a3f05ccbdaf0a76da9270461f919d4d24e8a736e4f282e58e9395226a409d5e80458434c36b1828156401999935fcc6ed7faac256abc53cbfdca21e2b2e69f605acd18288242cecebe6b6428d762ecde86e159bbe79c7745d7cbd4cf81005256b3c13b561b6d4f30f4ef91f42b3b4239f227510f5368f8d1cf76baafa7ec0691eb480f3e829a7feb44ad5f3c1695ad38ccb4c7e13c77d9bd448a277309b386913077ae50d9ba466de6f3fe9ec1f1fab711ce134c3f151842cad2d549c456a0935db1ba0c3fd1fd75d5ad714eecd377dc3ddfad23ab2bc36871045f8bd1408177c98024824384927394c7928d7920c47d02ecd46b47b844f173b9fd9581b809ba8ee79c4349886f0b7b40394c34f4e93d5193376d4a61d1b7f2ad193ade741be9b9581ae7ee54641ce419cf5ae788004e0c89652612be719a37dbc3f70cec7bec091b9086c4208d2607ce67c98c1936413eed60960a3aea5d020bb9988c3e931ebaf1754842796c4993b41cbf4ff28cc50748f368eabb67ef9d0878d057b30d9b641ee5f64f86a45dc6db80756571720bbacb8267d6e368cb8da2e622b8545950175a997226d07e04e111f56ad27cf388da4317d8acc832fbee7cddff35e3979761709ca0da58d49993b8f0d5013ff281b992ca1428b0e75542c75cd9e9c3e1c6f587a328765e375335867f70a16cfc3d10c8feede1a8c86bb1b6d9264e17fdb3c8ad065d10478979d657a802b3c38102b0fb11e5cbdcdc865f6820bc30fc24bdaf01397501464c2986e4288ef8334b46eda742efe5a07dda56955487222fd26f95c027256a6d93918903e6d59e70d4e16657180bbd5f74a713e28e506e34dc6095b02c56c00441e41e5f9edbed52cf1730c7284d55b33f6368e68f6673e001dd492bb06dd1d10e21d811236c61416c96931ac33aae622db3d27f392157b807c91f0043950dc494185dc3720236fcfbcbf6a8623d8bb7f16f3a4cb09908bc910978dd95cbbf90afa903566b39e937152d40676e9f51abe5c25b5bdde16099c5e8f5552213f8e2d3126baf769e2f87aeb4754eceaa6d900fe1bbc500785d3ca60e9fda820968bb9efa045204e338c910db26c245da50702f051dd3d0acffc9e25f5b68052726887bbf94474f4a898909278d4aff1d28062d12bdc026ae2b599dacb9125c822496119fe7c46c1560c6a7582926fc716fde6f3a5192213190386d5562c5e45f931fd05dbb43352ec04bd25f310bf18b9395c0fbbd75a1cd4c31b098a10bed1f172378184c9fdd919aed306de620f28b457e9e0</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">请输入访问密码</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> zabbix </category>
          
      </categories>
      
      
        <tags>
            
            <tag> zabbix </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>wordpress设置WP SMTP邮件提醒</title>
      <link href="/2024/03/27/wordpress%E8%AE%BE%E7%BD%AEWP%20SMTP%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92/"/>
      <url>/2024/03/27/wordpress%E8%AE%BE%E7%BD%AEWP%20SMTP%E9%82%AE%E4%BB%B6%E6%8F%90%E9%86%92/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="wordpress设置WP-SMTP邮件提醒"><a href="#wordpress设置WP-SMTP邮件提醒" class="headerlink" title="wordpress设置WP SMTP邮件提醒"></a>wordpress设置WP SMTP邮件提醒</h2><blockquote><p>本文使用wordpress插件 &gt; <a href="https://wordpress.org/plugins/wp-smtp/">WP SMTP</a> 安装 &gt; <a href="https://wn-apple-teawine.fun/2023/10/08/wordpress%E5%8D%9A%E5%AE%A2-docker-compose%E6%9E%84%E5%BB%BA/?highlight=%E5%90%84%E7%A7%8D">wordpress安装链接</a></p><p>插件安装包留存地址 | <a href="https://drive.zznnwn.cloudns.biz/api/raw/?path=/boke/wordpress/WP-SMTP/wp-smtp.1.2.6.zip">传送门</a></p></blockquote><h3 id="wordpress安装WP-SMTP插件方法"><a href="#wordpress安装WP-SMTP插件方法" class="headerlink" title="wordpress安装WP SMTP插件方法"></a>wordpress安装WP SMTP插件方法</h3><p>插件 &gt; 添加插件 &gt; 上传插件 &gt; 选择文件 | 此时平台会自动安装此插件</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6dc16744541929c15f31c5105b4877d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c6dc16744541929c15f31c5105b4877d.png"></p><h3 id="配置smtp服务"><a href="#配置smtp服务" class="headerlink" title="配置smtp服务"></a>配置smtp服务</h3><p>主要配置邮箱授权码 设置 &gt; 讨论 &gt; 开启评论提醒</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8079623496c957fa91390f39150ee7e8.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_8079623496c957fa91390f39150ee7e8.png"></p><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_d8ba9af400a0c44fca7a8b7aa6bd50bd.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_d8ba9af400a0c44fca7a8b7aa6bd50bd.png"></p><p><strong>本文参考</strong></p><p><a href="https://blog.naibabiji.com/tutorial/wordpress-smtp-cha-jian.html#wp_smtp">https://blog.naibabiji.com/tutorial/wordpress-smtp-cha-jian.html#wp_smtp</a></p>]]></content>
      
      
      <categories>
          
          <category> wordpress </category>
          
      </categories>
      
      
        <tags>
            
            <tag> wordpress </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux命令筛选出ipv4地址并去重计算出现次数</title>
      <link href="/2024/03/25/linux%E5%91%BD%E4%BB%A4%E7%AD%9B%E9%80%89%E5%87%BAipv4%E5%9C%B0%E5%9D%80%E5%B9%B6%E5%8E%BB%E9%87%8D%E8%AE%A1%E7%AE%97%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0/"/>
      <url>/2024/03/25/linux%E5%91%BD%E4%BB%A4%E7%AD%9B%E9%80%89%E5%87%BAipv4%E5%9C%B0%E5%9D%80%E5%B9%B6%E5%8E%BB%E9%87%8D%E8%AE%A1%E7%AE%97%E5%87%BA%E7%8E%B0%E6%AC%A1%E6%95%B0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>linux命令筛选出ipv4地址并去重计算出现次数<a href>                                              </a></strong></p><p>代码如下：</p><ul><li><strong>grep -oE “\b([0-9]{1,3}.){3}[0-9]{1,3}\b” 1.txt |sort -nr |uniq -c</strong></li><li><strong>ss -ant |grep ESTAB |awk -F ‘[ :]+’  ‘{print $4}’ |grep -v ‘[‘ |sort -rn |uniq -c</strong></li><li><strong>cat 1.txt  |awk -F ‘[ :]+’  ‘/^ip/{print $2}’ |sort -nr |uniq -c</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">root@k8s:~<span class="comment"># cat 1.txt </span></span><br><span class="line">ip: 10.10.10.1:1080</span><br><span class="line">ip: 10.10.10.2:1080</span><br><span class="line">ip: 10.10.10.4:2050</span><br><span class="line">ip: 10.10.10.2:1020</span><br><span class="line">root@k8s:~<span class="comment"># ss -ant |grep -oE &quot;\b([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;\b&quot; 1.txt</span></span><br><span class="line">10.10.10.1</span><br><span class="line">10.10.10.2</span><br><span class="line">10.10.10.4</span><br><span class="line">10.10.10.2</span><br><span class="line">root@k8s:~<span class="comment"># grep -oE &quot;\b([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;\b&quot; 1.txt |sort -nr |uniq -c</span></span><br><span class="line">      1 10.10.10.4</span><br><span class="line">      2 10.10.10.2</span><br><span class="line">      1 10.10.10.1</span><br><span class="line">root@k8s:~<span class="comment"># ss -ant |grep ESTAB |awk -F &#x27;[ :]+&#x27;  &#x27;&#123;print $4&#125;&#x27; |grep -v &#x27;\[&#x27; |sort -rn |uniq -c</span></span><br><span class="line">      1 172.16.0.1</span><br><span class="line">    124 127.0.0.1</span><br><span class="line">     10 10.0.0.240</span><br><span class="line">root@k8s:~<span class="comment"># cat 1.txt  |awk -F &#x27;[ :]+&#x27;  &#x27;/^ip/&#123;print $2&#125;&#x27; |sort -nr |uniq -c</span></span><br><span class="line">      1 10.10.10.4</span><br><span class="line">      2 10.10.10.2</span><br><span class="line">      1 10.10.10.1</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Shell实现计算斐波那契数列</title>
      <link href="/2024/03/24/Shell%E5%AE%9E%E7%8E%B0%E8%AE%A1%E7%AE%97%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/"/>
      <url>/2024/03/24/Shell%E5%AE%9E%E7%8E%B0%E8%AE%A1%E7%AE%97%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="Shell实现斐波那契数列计算"><a href="#Shell实现斐波那契数列计算" class="headerlink" title="Shell实现斐波那契数列计算"></a>Shell实现斐波那契数列计算</h3><p><a href="https://zh.numberempire.com/fibonaccinumbers.php">斐波那契数计算器 (numberempire.com)</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">fibonacci</span></span>() &#123;</span><br><span class="line">    n=<span class="variable">$1</span></span><br><span class="line">    <span class="keyword">if</span> [ <span class="variable">$n</span> -eq 0 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> 0</span><br><span class="line">    <span class="keyword">elif</span> [ <span class="variable">$n</span> -eq 1 ]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> 1</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        a=0</span><br><span class="line">        b=1</span><br><span class="line">        i=2</span><br><span class="line">        <span class="keyword">while</span> [ <span class="variable">$i</span> -le <span class="variable">$n</span> ]; <span class="keyword">do</span></span><br><span class="line">            c=$((a + b))</span><br><span class="line">            a=<span class="variable">$b</span></span><br><span class="line">            b=<span class="variable">$c</span></span><br><span class="line">            i=$((i + <span class="number">1</span>))</span><br><span class="line">        <span class="keyword">done</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$b</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> -p <span class="string">&quot;请输入N值（N &lt; 50）: &quot;</span> N</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$N</span> -ge 0 ] &amp;&amp; [ <span class="variable">$N</span> -lt 50 ]; <span class="keyword">then</span></span><br><span class="line">    result=$(fibonacci <span class="variable">$N</span>)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;斐波那契数列的第 <span class="variable">$N</span> 项为: <span class="variable">$result</span>&quot;</span></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;输入的N值不在有效范围内！&quot;</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_caa7837e83fa0efebe83bac133122bd4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_caa7837e83fa0efebe83bac133122bd4.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9d599e5ba7c00c4a861753f0f01a4cb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e9d599e5ba7c00c4a861753f0f01a4cb.png"></p>]]></content>
      
      
      <categories>
          
          <category> shell </category>
          
      </categories>
      
      
        <tags>
            
            <tag> shell </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ceph集群扩容与缩容节点</title>
      <link href="/2024/03/23/ceph%E9%9B%86%E7%BE%A4%E6%89%A9%E5%AE%B9%E4%B8%8E%E7%BC%A9%E5%AE%B9%E8%8A%82%E7%82%B9/"/>
      <url>/2024/03/23/ceph%E9%9B%86%E7%BE%A4%E6%89%A9%E5%AE%B9%E4%B8%8E%E7%BC%A9%E5%AE%B9%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="ceph集群扩容与缩容节点"><a href="#ceph集群扩容与缩容节点" class="headerlink" title="ceph集群扩容与缩容节点"></a>ceph集群扩容与缩容节点</h3><p><a href="https://wn-apple-teawine.fun/2023/08/29/cephadm%E9%83%A8%E7%BD%B2ceph-quincy%E7%89%88%E6%9C%AC/"><strong>一. 扩容常规添加节点即可</strong></a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 关闭自动添加osd</span></span><br><span class="line">ceph orch apply osd --all-available-devices --unmanaged=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 添加ceph-4为新节点</span></span><br><span class="line">ssh-copy-id ceph-4</span><br><span class="line">ssh-copy-id -f -i /etc/ceph/ceph.pub root@ceph-4</span><br><span class="line"><span class="comment"># ceph-4 换源 </span></span><br><span class="line"><span class="comment"># 设置ceph quincy源 </span></span><br><span class="line"><span class="comment"># 设置docker镜像加速 &gt;&gt; 略 (ceph-4操作)</span></span><br><span class="line">hostnamectl set-hostname ceph-4</span><br><span class="line">apt install -y python3 systemd lvm2 ceph-common</span><br><span class="line">curl -sSL https://get.daocloud.io/docker | sh</span><br><span class="line"><span class="comment"># 主节点执行添加节点</span></span><br><span class="line">ceph orch host add ceph-4</span><br></pre></td></tr></table></figure><p><strong>二. 节点缩容( 注意顺序 )–暂未测试</strong></p><blockquote><p>此处需要注意副本数  比如集群为三副本三台服务器缩减为两台时 此时集群缺失一节点就变成了 两副本 移除节点需要调整副本数 副本数不能小于<code>2</code>即最小能支持的缩减为3节点 &gt;&gt; 2节点</p></blockquote><p><a href="https://gegewu-cloud.github.io/2023/09/01/ceph%E9%9B%86%E7%BE%A4%E4%B9%8Bosd%E5%9D%8F%E7%9B%98%E5%89%94%E9%99%A4/">osd坏盘剔除参考此处链接即可</a></p><p><a href="https://wn-apple-teawine.fun/2023/10/29/ceph%E9%9B%86%E7%BE%A4%E4%B9%8Bceph-quincy%E7%89%88%E6%9C%ACcephadm%E9%83%A8%E7%BD%B2%E6%96%B9%E5%BC%8F%E4%BF%AE%E6%94%B9ceph%E9%85%8D%E7%BD%AE/">cephadm部署方式更改配置参考此处含ceph-deploy方式更改副本数</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首先设置不迁移数据</span></span><br><span class="line">ceph osd <span class="built_in">set</span> noout</span><br><span class="line"><span class="comment"># 若节点为3节点锁容为2节点则需要 更改副本数为2 ceph的crashmap默认以主机为单位 (副本数不能小于2)</span></span><br><span class="line">ceph config <span class="built_in">help</span> osd_pool_default_size                     <span class="comment"># 查看当前副本数配置</span></span><br><span class="line">ceph config-key <span class="built_in">set</span> config/global/osd_pool_default_size 2  <span class="comment"># 设置副本数为2</span></span><br><span class="line">systemctl restart ceph.target                              <span class="comment"># 重启生效</span></span><br><span class="line"><span class="comment"># 已经存在的pool需要手动设置副本数 (副本数不能小于2)</span></span><br><span class="line">ceph osd pool  <span class="built_in">set</span> ceph-demo size  2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 其他如mds mgr mon等节点数量也要对应缩减</span></span><br><span class="line">ceph orch apply mon --placement=<span class="string">&quot;2 ceph-1 ceph-2&quot;</span>   </span><br><span class="line">ceph orch apply mgr --placement=<span class="string">&quot;2 ceph-1 ceph-2&quot;</span></span><br><span class="line">ceph orch apply rgw  foo --placement=<span class="string">&quot;2 ceph-1 ceph-2&quot;</span> --port=8000</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从集群中删除关于该ceph-3主机的所有守护进程</span></span><br><span class="line">ceph orch host drain ceph-3</span><br><span class="line"><span class="comment"># 将_no_schedule标签应用于主机至于维护模式</span></span><br><span class="line">ceph orch host label add ceph-3 _no_schedule</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭自动添加osd</span></span><br><span class="line">ceph orch apply osd --all-available-devices --unmanaged=<span class="literal">true</span></span><br><span class="line"><span class="comment"># 移除osd</span></span><br><span class="line">ceph osd out osd.1</span><br><span class="line">ceph osd purge osd.1 --yes-i-really-mean-it</span><br><span class="line">ceph osd <span class="built_in">rm</span> osd.1</span><br><span class="line">ceph orch daemon <span class="built_in">rm</span> osd.1 --force</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> ceph </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ceph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cephfs搭建及权限管理</title>
      <link href="/2024/03/23/cephfs%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/"/>
      <url>/2024/03/23/cephfs%E6%90%AD%E5%BB%BA%E5%8F%8A%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="cephfs搭建及权限管理-本文单节点测试"><a href="#cephfs搭建及权限管理-本文单节点测试" class="headerlink" title="cephfs搭建及权限管理(本文单节点测试)"></a>cephfs搭建及权限管理(本文单节点测试)</h3><p><strong>拖布图</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3e7fad3ed82c19ee8bc03e153c89c81f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_3e7fad3ed82c19ee8bc03e153c89c81f.png"></p><p><strong>架构</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c33ff0f84010148834f8b19aae653197.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_c33ff0f84010148834f8b19aae653197.png"></p><p><strong>cephFS简介</strong></p><p>每个CephFS文件系统至少需要一个MDS（metadata server），一般是三个。CephFS 是个与 POSIX 标准兼容的文件系统，文件目录和其他元数据存储在RADOS中，MDS缓存元信息和文件目录信息。</p><p>cephfs的核心组件有：MDS、Clients、RADOS。</p><p>参考：<a href="https://cloud.tencent.com/developer/article/1664666">CephFS 介绍及使用经验分享</a>。</p><blockquote><p>各个组件之间的依赖关系如下：</p><ul><li>client 《==》 MDS：元数据操作和capalities。</li><li>Client 《==》 OSD： 数据IO。</li><li>MDS 《==》 OSD：元数据IO。</li></ul></blockquote><p>cephfs支持用户级别和内核级别的挂载使用，可扩展性高，并且可以共享文件系统，多个clients可以同时读写。MDS支持高可用性，默认采用的是主备模式（也可以通过配置改为多主），并且cephfs支持文件系统的配额限制。</p><blockquote><p>cephfs中MDS多主的优势及特点如下：</p><ul><li>当元数据默认的单个 MDS 成为瓶颈时，配置多个活跃的 MDS 守护进程，提升集群性能。</li><li>多个活跃的 MDS 有利于性能提升。</li><li>多个活跃的MDS 可以实现MDS负载均衡。</li><li>多个活跃的MDS 可以实现多租户资源隔离。</li><li>它能够将文件系统树分割成子树，每个子树可以交给特定的MDS进行权威管理，从而达到了随着元数据服务器数量的增加，集群性能线性地扩展。</li><li>每个子树都是基于元数据在给定目录树中的热动态创建的。</li><li>一旦创建了子树，它的元数据就被迁移到一个未加载的MDS。</li><li>后续客户端对先前授权的MDS的请求被转发。</li></ul></blockquote><h3 id="一-创建mds"><a href="#一-创建mds" class="headerlink" title="一. 创建mds"></a>一. <strong>创建</strong>mds</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 首先开启mds组件，cephfs：文件系统名称；–placement：指定集群内需要几个mds，后面跟主机名（等待一分钟完成创建）</span></span><br><span class="line">ceph orch apply mds cephfs --placement=<span class="string">&quot;2 ceph1 ceph2&quot;</span></span><br><span class="line"><span class="comment"># 返回</span></span><br><span class="line">Scheduled mds.cephfs update...</span><br><span class="line"><span class="comment"># 创建cephfs，ceph q版不指定pg的话，默认自动调整 不能使用 rbd init 初始化</span></span><br><span class="line">ceph osd pool create cephfs_data 8 8</span><br><span class="line">ceph osd pool create cephfs_metadata 8 8</span><br><span class="line"><span class="comment"># 返回</span></span><br><span class="line">pool <span class="string">&#x27;cephfs_metadata&#x27;</span> created</span><br><span class="line"><span class="comment"># 将两个pool关联起来</span></span><br><span class="line">ceph fs new cephfsdemo cephfs_metadata cephfs_data</span><br><span class="line"><span class="comment"># 返回</span></span><br><span class="line">new fs with metadata pool 3 and data pool 2</span><br><span class="line"><span class="comment"># 查看各节点是否已启动mds容器；还可以使用ceph orch ps 查看某一节点运行的容器</span></span><br><span class="line">ceph orch ps --daemon-type mds</span><br></pre></td></tr></table></figure><p><strong>查看mds信息</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看cephfs信息</span></span><br><span class="line">ceph fs <span class="built_in">ls</span></span><br><span class="line">name: cephfs, metadata pool: cephfs_metadata, data pools: [cephfs_data ]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看mds状态</span></span><br><span class="line">ceph mds <span class="built_in">stat</span></span><br><span class="line">cephfs:1 &#123;0=cephfs.ceph-1.uuemyr=up:active&#125; 1 up:standby</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看mds详细信息</span></span><br><span class="line">ceph fs status </span><br><span class="line"></span><br><span class="line">RANK  STATE           MDS              ACTIVITY     DNS    INOS   DIRS   CAPS  </span><br><span class="line"> 0    active  cephfs.ceph-2.iuvxfu  Reqs:    0 /s    16     19     13      1</span><br></pre></td></tr></table></figure><p>删除<code>cephfs</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph fs <span class="built_in">rm</span> &lt;fs-name&gt; --yes-i-really-mean-it </span><br></pre></td></tr></table></figure><h3 id="二-挂载cephfs"><a href="#二-挂载cephfs" class="headerlink" title="二. 挂载cephfs"></a>二. 挂载<code>cephfs</code></h3><p><strong>临时挂载</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用内核级别挂载：</span></span><br><span class="line"> <span class="built_in">mkdir</span> -p /mnt/cephfs/</span><br><span class="line"> mount -t ceph 10.0.0.124:6789:/ /mnt/cephfs/ -o name=admin  （自动识别admin key）</span><br><span class="line"> 或</span><br><span class="line"> mount -t ceph 10.0.0.124:6789:/ /mnt/cephfs -o name=admin,secret=AQCeoO1j+e+lMhAAP2izu6rTQSGz0oyJkLw9UQ==</span><br><span class="line"> 或</span><br><span class="line"> <span class="comment"># 文件密钥挂载：</span></span><br><span class="line"> <span class="built_in">echo</span> AQDqOnNf7tGvHhAAZoXbhXRbETxRLBTl5DT1MQ== &gt;&gt; admin.key</span><br><span class="line"> mount -t ceph 192.168.229.114:6789:/ /cephfs/ -o name=admin,secretfile=admin.key</span><br><span class="line"><span class="comment"># 扩展查看key:  </span></span><br><span class="line">ceph auth <span class="built_in">ls</span></span><br><span class="line">指定用户挂载 需要先建立cephx认证用户内核级别配置永久挂载</span><br></pre></td></tr></table></figure><p><strong>用户态挂载（例子）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ yum -y install ceph-fuse     <span class="comment"># 安装客户端</span></span><br><span class="line">$ apt -y install ceph-fuse</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">mkdir</span> /ceph-fuse   <span class="comment"># 创建挂载点并挂载使用</span></span><br><span class="line"></span><br><span class="line">$ ceph-fuse -n client.admin -m 192.168.99.11:6789,192.168.99.12:6789,192.168.99.13:6789 /ceph-fuse</span><br><span class="line"><span class="comment"># monitor地址可以可以指定一个或多个（如果其中一个宕机不影响使用）</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">df</span> -hT /ceph-fuse       <span class="comment"># 查看确认</span></span><br><span class="line">文件系统       类型            容量  已用  可用 已用% 挂载点</span><br><span class="line">ceph-fuse      fuse.ceph-fuse   94G     0   94G    0% /ceph-fuse</span><br></pre></td></tr></table></figure><p><strong>永久挂载</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 写入配置文件：/etc/fstab </span></span><br><span class="line"><span class="comment"># 密钥文件</span></span><br><span class="line">  10.0.0.124:6789:/ /mnt/cephfs ceph name=admin,secretfile=/root/adminkey,noatime 0 0</span><br><span class="line"><span class="comment"># 直接指定密钥</span></span><br><span class="line">  10.0.0.124:6789:/ /mnt/cephfs ceph name=admin,secret=AQCeoO1j+e+lMhAAP2izu6rTQSGz0oyJkLw9UQ==,noatime,_netdev 0 0</span><br><span class="line"></span><br><span class="line">关机验证：正常挂载 / monut -a 即可验证</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7a032c8de07240c963b4846f8b971faf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7a032c8de07240c963b4846f8b971faf.png"></p><h3 id="三-ceph权限控制"><a href="#三-ceph权限控制" class="headerlink" title="三. ceph权限控制"></a>三. <a href="https://www.cnblogs.com/lvzhenjiang/p/14907610.html#35-%E7%94%A8%E6%88%B7%E7%A9%BA%E9%97%B4%E6%8C%82%E8%BD%BD%E4%BD%BF%E7%94%A8"><strong>ceph权限控制</strong></a></h3><h4 id="3-6-不同用户挂载不同目录"><a href="#3-6-不同用户挂载不同目录" class="headerlink" title="3.6 不同用户挂载不同目录"></a>3.6 不同用户挂载不同目录</h4><h5 id="3-6-1-添加新的pool到cephfs"><a href="#3-6-1-添加新的pool到cephfs" class="headerlink" title="3.6.1 添加新的pool到cephfs"></a>3.6.1 添加新的pool到cephfs</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">cephfs中增加新的pool</span></span><br><span class="line">ceph osd pool create cephfs_data1 4 4           # 创建pool</span><br><span class="line">ceph fs add_data_pool cephfsdemo cephfs_data1  # 加到cephfs中  </span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="3-6-2-创建bruce的用户，这个用户只能访问目录-bruce，数据存储在-pool-cephfs-data1-中"><a href="#3-6-2-创建bruce的用户，这个用户只能访问目录-bruce，数据存储在-pool-cephfs-data1-中" class="headerlink" title="3.6.2 创建bruce的用户，这个用户只能访问目录/bruce，数据存储在 pool cephfs_data1 中"></a>3.6.2 创建bruce的用户，这个用户只能访问目录/bruce，数据存储在 <code>pool cephfs_data1</code> 中</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建bruce的用户，这个用户只能访问目录/bruce，数据存储在 `pool cephfs_data1` 中</span></span><br><span class="line">ceph auth get-or-create client.bruce mon &#x27;allow r&#x27; mds &#x27;allow r, allow rw path=/bruce&#x27; osd &#x27;allow rw pool=cephfs_data1&#x27; -o ceph.client.bruce.keyring</span><br><span class="line">// 返回</span><br><span class="line">[client.bruce]</span><br><span class="line">key = AQCtFc9g/CmyERAAzi7ORpEWIxlMiiFC1GK7nA==</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_85fe5cb0da273b96eb63b2ca004dc93c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_85fe5cb0da273b96eb63b2ca004dc93c.png"></p><h5 id="3-6-3-客户端挂载"><a href="#3-6-3-客户端挂载" class="headerlink" title="3.6.3 客户端挂载"></a>3.6.3 客户端挂载</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">客户端挂载</span></span><br><span class="line">mkdir /data1</span><br><span class="line">mount -t ceph 192.168.99.11:6789,192.168.99.12:6789,192.168.99.13:6789:/ /data1/ -o name=bruce,secret=AQCtFc9g/CmyERAAzi7ORpEWIxlMiiFC1GK7nA==</span><br></pre></td></tr></table></figure><h3 id="四、cephfs权限与访问控制"><a href="#四、cephfs权限与访问控制" class="headerlink" title="四、cephfs权限与访问控制"></a>四、cephfs权限与访问控制</h3><h4 id="4-1-添加用户"><a href="#4-1-添加用户" class="headerlink" title="4.1 添加用户"></a>4.1 添加用户</h4><p>添加用户<code>jerry，jerry</code>只有对<code>/jerry</code>路径下的文件具有读写权限，对其他路径下的文件只有读的权限</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建权限密钥</span></span><br><span class="line">ceph auth get-or-create client.jerry mon &#x27;allow r&#x27; mds &#x27;allow rw,allow rw path=/jerry&#x27; osd &#x27;allow rw pool=cephfs_data2&#x27; -o ceph.client.jerry.keyring</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用jerry用户挂载</span></span><br><span class="line">mount -t ceph 10.0.0.10:6789:/ /data -o name=jerry,secret=AQAo0/9lI2g7KRAA8AqwdIUhGQcS4tJgltSlzw==</span><br></pre></td></tr></table></figure><h4 id="4-2-获取权限列表"><a href="#4-2-获取权限列表" class="headerlink" title="4.2 获取权限列表"></a>4.2 获取权限列表</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth list</span></span><br></pre></td></tr></table></figure><h4 id="4-3-删除用户"><a href="#4-3-删除用户" class="headerlink" title="4.3 删除用户"></a>4.3 删除用户</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth del client.jerry</span></span><br></pre></td></tr></table></figure><h4 id="4-4-获取某个用户的key"><a href="#4-4-获取某个用户的key" class="headerlink" title="4.4 获取某个用户的key"></a>4.4 获取某个用户的key</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth get-key client.bruce</span></span><br></pre></td></tr></table></figure><h4 id="4-5-修改用户权限"><a href="#4-5-修改用户权限" class="headerlink" title="4.5 修改用户权限"></a>4.5 修改用户权限</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ceph auth caps client.jerry mon <span class="string">&#x27;allow r&#x27;</span> mds <span class="string">&#x27;allow r, allow rw path=/jerry, allow rw path=/test&#x27;</span> osd <span class="string">&#x27;allow rw&#x27;</span></span></span><br></pre></td></tr></table></figure><h4 id="4-6-注意事项"><a href="#4-6-注意事项" class="headerlink" title="4.6 注意事项"></a>4.6 注意事项</h4><blockquote><ul><li>当用java api操作cephfs时，api无法指定新建文件or目录的所属用户or所属组，这两个属性取决于运行java程序时的当前用户(uid)及其所属的用户组(gid)</li><li>经过测试发现，cephfs文件or目录的权限是linux本身用户权限和cephfs用户权限的交集</li><li>修改用户权限后，在本地需要重新挂载才可生效</li><li>建目录，设置权限无需前后顺序</li></ul></blockquote><p><strong>本文参考：</strong></p><p>官网：<br><a href="https://docs.ceph.com/en/quincy/cephfs/#ceph-file-system">https://docs.ceph.com/en/quincy/cephfs/#ceph-file-system</a><br>挂载：<br><a href="https://docs.ceph.com/en/quincy/cephfs/mount-using-kernel-driver/">https://docs.ceph.com/en/quincy/cephfs/mount-using-kernel-driver/</a><br>cephfs介绍+各种测试：<br><a href="http://www.yangguanjun.com/2017/07/16/cephfs-test-method-lite/">http://www.yangguanjun.com/2017/07/16/cephfs-test-method-lite/</a></p>]]></content>
      
      
      <categories>
          
          <category> ceph </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ceph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ceph rbd数据写入流程</title>
      <link href="/2024/03/20/ceph%20rbd%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B/"/>
      <url>/2024/03/20/ceph%20rbd%E6%95%B0%E6%8D%AE%E5%86%99%E5%85%A5%E6%B5%81%E7%A8%8B/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="ceph-rbd数据写入流程"><a href="#ceph-rbd数据写入流程" class="headerlink" title="ceph rbd数据写入流程"></a>ceph rbd数据写入流程</h3><p><strong>拓补图：</strong></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_14d0de28111417c8dc2aa9088c5b6136.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_14d0de28111417c8dc2aa9088c5b6136.png"></p><p><strong>图片解析：</strong><br><code>存储过程：</code>一个文件切割为很多部分 比如一个100M的文件最终会切割成25个4M（默认4M）的文件<br><code>切割之后：</code>每个<code>object</code>都会有一个<code>object id  object id</code> 需要存储到pg里面去 此处进行一个运算把<code>object id 作为一个哈希   &gt;&gt; 对其进行掩码运算 &gt;&gt; 得到pgid </code>pg上面：<code> 存储多个object</code> &gt;&gt; 通过<code>crush</code>算法把<code>pg</code>做一次运算分配到 集群中对应的<code>osd</code>节点上(根据<code>crush</code>层次的不同<code>osd</code>也会落到不同的地方 )<br>比如<code>crush</code>算法定义的是以机架为单位的 此时便会落到不同的机架上的<code>osd</code>上从而确保数据的高可用性</p><p><strong>实际操作演示：</strong></p><p>文件切割大小验证 演示文件 id: rbd_data.38074c091b82.0000000000000200</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">rbd info ceph-demo/rbd-demo.img   或    rbd -p ceph-demo info rbd-demo.img （查看命令）</span><br><span class="line">rbd image <span class="string">&#x27;rbd-demo.img&#x27;</span>:</span><br><span class="line">        size 11 GiB <span class="keyword">in</span> 2816 objects</span><br><span class="line">        order 22 (4 MiB objects)</span><br><span class="line">        snapshot_count: 0</span><br><span class="line">        <span class="built_in">id</span>: 38074c091b82</span><br><span class="line">        block_name_prefix: rbd_data.38074c091b82</span><br><span class="line">        format: 2</span><br><span class="line">        features: layering</span><br><span class="line">        op_features: </span><br><span class="line">        flags: </span><br><span class="line">        create_timestamp: Sat Nov  5 21:41:38 2022</span><br><span class="line">        access_timestamp: Sat Nov  5 21:41:38 2022</span><br><span class="line">        modify_timestamp: Sat Nov  5 21:41:38 2022</span><br></pre></td></tr></table></figure><p>解析：</p><p>共：11G  分为：2816个文件  每个文件：4M<br>object的前缀都是以： rbd_data.38074c091b82 开头<br>查看验证：<code>rados -p ceph-demo ls |grep rbd\_data.38074c091b82</code>   (查看所有文件)<br>查看大小：<code>rados -p ceph-demo stat rbd\_data.38074c091b82.0000000000000200</code>  （每个都是4M）</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f53063cda709eabdb71f3cd486276b4.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_6f53063cda709eabdb71f3cd486276b4.png"></p><p><strong>查看文件最终落在的地方：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ceph osd map ceph-demo rbd_data.38074c091b82.0000000000000200     (查看文件最终落于)</span><br><span class="line">//返回</span><br><span class="line">osdmap e49 pool <span class="string">&#x27;ceph-demo&#x27;</span> (1) object <span class="string">&#x27;rbd_data.38074c091b82.0000000000000200&#x27;</span> -&gt; pg 1.7811abdf (1.5f) -&gt; up ([0,1], p0) acting ([0,1], p0)</span><br><span class="line"></span><br><span class="line">ceph osd tree</span><br><span class="line">ID CLASS WEIGHT  TYPE NAME       STATUS REWEIGHT PRI-AFF </span><br><span class="line">-1       0.01178 root default          </span><br><span class="line">-3       0.00589     host node-1       </span><br><span class="line"> 0   hdd 0.00589         osd.0       up  1.00000 1.00000 </span><br><span class="line">-5       0.00589     host node-2       </span><br><span class="line"> 1   hdd 0.00589         osd.1       up  1.00000 1.00000 </span><br><span class="line"></span><br><span class="line">解析： 文件pool池deph-demo &gt;&gt; 落在pgid为：1.7811abdf 上面 &gt;&gt; 解析掩码哈希分配于 &gt;&gt; osd.0 osd.1上面</span><br><span class="line">一个文件拆分为多个object这些object都会落在不同的pg上  pg最终落在不同的osd上 </span><br><span class="line">验证：</span><br><span class="line"><span class="keyword">for</span>循环验证</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> `rados -p ceph-demo <span class="built_in">ls</span> |grep rbd_data.38074c091b82` ; <span class="keyword">do</span> ceph osd map ceph-demo <span class="variable">$i</span>;  <span class="keyword">done</span></span><br><span class="line">落于不同的pg上</span><br></pre></td></tr></table></figure><p>解析： 文件pool池deph-demo &gt;&gt; 落在pgid为：1.7811abdf 上面 &gt;&gt; 解析掩码哈希分配于 &gt;&gt; osd.0 osd.1上面一个文件拆分为多个object这些object都会落在不同的pg上  pg最终落在不同的osd上</p><p>验证：for循环验证</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> \`rados -p ceph-demo <span class="built_in">ls</span> |grep rbd\_data.38074c091b82\` ; <span class="keyword">do</span> ceph osd map ceph-demo \<span class="variable">$i</span>;  <span class="keyword">done</span></span><br></pre></td></tr></table></figure><p>落于不同的pg上</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_29628694717b3300ec37f4ed88d5abbb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_29628694717b3300ec37f4ed88d5abbb.png"></p><p><strong>rbd是瘦分配的会根据使用情况去自动的扩这些空间</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rados -p ceph-demo <span class="built_in">ls</span> |grep rbd_data.38074c091b82 |<span class="built_in">wc</span> -l        <span class="comment"># 当前这个块有五十多个object</span></span><br><span class="line">//返回 </span><br><span class="line">56 </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>当前这个块有五十多个object  每个4M 实际分配了也就二百多M的空间  当前只用了40多M 使用增长的话会动态的去扩容object的数量 满足 我们需要的空间</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -n 1 <span class="string">&#x27;rados -p ceph-demo ls |grep rbd_data.38074c091b82 |wc -l &#x27;</span>    （动态监视object文件变化）</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7c31491c234c587d7d0cc391e7fce3d6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_7c31491c234c587d7d0cc391e7fce3d6.png"></p><p>往挂载的目录写入数据：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /mnt/rbd-demo</span><br><span class="line"></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=test.img bs=1M count=1024       (往目录写入1G数据)</span><br><span class="line"><span class="comment"># 写入真实数据</span></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/urandom of=file bs=100M count=9000 iflag=fullblock status=progress</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>可以看到最终object增加到313个</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_cc6f5bd1aac93adf5cc215f62178f499.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_cc6f5bd1aac93adf5cc215f62178f499.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_64fcc6f1de8cc79e192aa157631a06d9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_64fcc6f1de8cc79e192aa157631a06d9.png"></p>]]></content>
      
      
      <categories>
          
          <category> ceph </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ceph </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>音乐</title>
      <link href="/2024/03/16/%E9%9F%B3%E4%B9%90/"/>
      <url>/2024/03/16/%E9%9F%B3%E4%B9%90/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>音乐</strong></p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="https://music.163.com/outchain/player?type=2&id=557584888&auto=1&height=66"> </iframe><hr><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="https://music.163.com/outchain/player?type=2&id=523250334&auto=1&height=66"> </iframe>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>onedrive-vercel-index部署</title>
      <link href="/2024/03/15/onedrive-vercel-index%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/03/15/onedrive-vercel-index%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="onedrive-vercel-index-部署"><a href="#onedrive-vercel-index-部署" class="headerlink" title="onedrive-vercel-index 部署"></a>onedrive-vercel-index 部署</h3><p>概览：参考下方官网即可 部署相对简单</p><h3 id="注册一个应用程序"><a href="#注册一个应用程序" class="headerlink" title="注册一个应用程序"></a><a href="https://ovi.swo.moe/zh/docs/advanced#%E6%B3%A8%E5%86%8C%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F">注册一个应用程序</a></h3><p>打开以下链接：</p><ul><li><a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade">Microsoft Azure App registrations</a> （OneDrive 国际版企业版与教育版E5 订阅专用本文使用此版本）</li><li><a href="https://portal.azure.cn/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade">Microsoft Azure.cn App registrations</a>（OneDrive 世纪互联专用）</li></ul><h3 id="serrect需要加密链接见参考链接"><a href="#serrect需要加密链接见参考链接" class="headerlink" title="serrect需要加密链接见参考链接"></a>serrect需要加密链接见参考链接</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e934dc8c7a9ad014792319e375d506ab.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_e934dc8c7a9ad014792319e375d506ab.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_32138b6f42071fff75dbd218321a5a77.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_32138b6f42071fff75dbd218321a5a77.png"></p><h3 id="本文参考："><a href="#本文参考：" class="headerlink" title="本文参考："></a>本文参考：</h3><p><a href="https://ovi.swo.moe/zh/docs/advanced">https://ovi.swo.moe/zh/docs/advanced</a><br><a href="https://ovi.swo.moe/zh/docs/getting-started">https://ovi.swo.moe/zh/docs/getting-started</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s仪表盘部署</title>
      <link href="/2024/03/12/k8s%E4%BB%AA%E8%A1%A8%E7%9B%98%E9%83%A8%E7%BD%B2/"/>
      <url>/2024/03/12/k8s%E4%BB%AA%E8%A1%A8%E7%9B%98%E9%83%A8%E7%BD%B2/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="k8s仪表盘部署"><a href="#k8s仪表盘部署" class="headerlink" title="k8s仪表盘部署"></a>k8s仪表盘部署</h2><p><strong>仪表盘文件下载链接</strong><br><a href="https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml">https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml</a><br><a href="https://drive.zznnwn.cloudns.biz/onedrive/k8s%E9%83%A8%E7%BD%B2%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%8F%8Acni/%E4%BD%BF%E7%94%A8container%E4%BD%9C%E4%B8%BA%E5%AE%B9%E5%99%A8%E8%BF%90%E8%A1%8C%E6%97%B6/recommended_v270.yaml">https://drive.zznnwn.cloudns.biz/onedrive/k8s部署配置文件及cni/使用container作为容器运行时/recommended_v270.yaml</a></p><h3 id="部署仪表盘"><a href="#部署仪表盘" class="headerlink" title="部署仪表盘"></a>部署仪表盘</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f &quot;https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml&quot;</span><br><span class="line">kubectl apply -f &quot;https://drive.zznnwn.cloudns.biz/onedrive/k8s部署配置文件及cni/使用container作为容器运行时/recommended_v270.yaml&quot;</span><br></pre></td></tr></table></figure><p><strong>命名空间中的名称创建服务帐户(admin-user.yml)</strong></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kubernetes-dashboard</span></span><br></pre></td></tr></table></figure><p><strong>部署admin-user.yml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f admin-user.yml </span><br><span class="line">kubectl apply -f <span class="string">&quot;https://drive.zznnwn.cloudns.biz/onedrive/k8s部署配置文件及cni/使用container作为容器运行时/admin-user.yml&quot;</span></span><br></pre></td></tr></table></figure><p>创建 ClusterRoleBinding(<code>ClusterRoleBinding.yml</code>)</p><p>在大多数情况下，在使用 或任何其他常用工具预配集群后，集群中已存在。我们可以使用它并只为我们的 . 如果它不存在，则需要先创建此角色并手动授予所需的权限。<code>kops kubeadm ClusterRole cluster-admin ClusterRoleBinding ServiceAccount</code></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">rbac.authorization.k8s.io/v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">ClusterRoleBinding</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line"><span class="attr">roleRef:</span></span><br><span class="line">  <span class="attr">apiGroup:</span> <span class="string">rbac.authorization.k8s.io</span></span><br><span class="line">  <span class="attr">kind:</span> <span class="string">ClusterRole</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">cluster-admin</span></span><br><span class="line"><span class="attr">subjects:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">kind:</span> <span class="string">ServiceAccount</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kubernetes-dashboard</span></span><br></pre></td></tr></table></figure><p><strong>部署ClusterRoleBinding.yml</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f ClusterRoleBinding.yml </span><br><span class="line">kubectl apply -f <span class="string">&quot;https://drive.zznnwn.cloudns.biz/onedrive/k8s部署配置文件及cni/使用container作为容器运行时/ClusterRoleBinding.yml&quot;</span></span><br></pre></td></tr></table></figure><p><strong>获取 ServiceAccount 的持有者令牌</strong></p><p>现在我们需要找到可用于登录的令牌。执行以下命令：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard create token admin-user</span><br></pre></td></tr></table></figure><p><strong>它应该打印如下内容：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlcm5ldGVzLWRhc2hib2FyZCIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLXY1N253Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiIwMzAzMjQzYy00MDQwLTRhNTgtOGE0Ny04NDllZTliYTc5YzEiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZXJuZXRlcy1kYXNoYm9hcmQ6YWRtaW4tdXNlciJ9.Z2JrQlitASVwWbc-s6deLRFVk5DWD3P_vjUFXsqVSY10pbjFLG4njoZwh8p3tLxnX_VBsr7_6bwxhWSYChp9hwxznemD5x5HLtjb16kI9Z7yFWLtohzkTwuFbqmQaMoget_nYcQBUC5fDmBHRfFvNKePh_vSSb2h_aYXa8GV5AcfPQpY7r461itme1EXHQJqv-SN-zUnguDguCTjD80pFZ_CmnSE1z9QdMHPB8hoB4V68gtswR1VLa6mSYdgPwCHauuOobojALSaMc3RH7MmFUumAgguhqAkX3Omqd3rJbYOMRuMjhANqd08piDC3aIabINX6gP5-Tuuw2svnV6NYQ</span><br></pre></td></tr></table></figure><p>查看 <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-an-api-token-for-a-serviceaccount">Kubernetes 文档</a>，了解有关 ServiceAccount 的 API 令牌的更多信息。</p><h4 id="获取-ServiceAccount-的长期持有者令牌-建议使用此种"><a href="#获取-ServiceAccount-的长期持有者令牌-建议使用此种" class="headerlink" title="获取 ServiceAccount 的长期持有者令牌(建议使用此种)"></a>获取 ServiceAccount 的长期持有者令牌(建议使用此种)</h4><p>我们还可以创建一个带有 secret 的令牌，该令牌绑定了服务帐户，令牌将保存在 Secret 中文件(<code>secret_token.yml</code>)</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">apiVersion:</span> <span class="string">v1</span></span><br><span class="line"><span class="attr">kind:</span> <span class="string">Secret</span></span><br><span class="line"><span class="attr">metadata:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">admin-user</span></span><br><span class="line">  <span class="attr">namespace:</span> <span class="string">kubernetes-dashboard</span></span><br><span class="line">  <span class="attr">annotations:</span></span><br><span class="line">    <span class="attr">kubernetes.io/service-account.name:</span> <span class="string">&quot;admin-user&quot;</span>   </span><br><span class="line"><span class="attr">type:</span> <span class="string">kubernetes.io/service-account-token</span>  </span><br></pre></td></tr></table></figure><p><strong>部署</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f secret_token.yml</span><br><span class="line">kubectl apply -f <span class="string">&quot;https://drive.zznnwn.cloudns.biz/onedrive/k8s部署配置文件及cni/使用container作为容器运行时/secret_token.yml&quot;</span></span><br></pre></td></tr></table></figure><p>创建 Secret 后，我们可以执行以下命令来获取保存在 Secret 中的 Token：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl get secret admin-user -n kubernetes-dashboard -o jsonpath=&#123;&quot;.data.token&quot;&#125; | base64 -d</span><br></pre></td></tr></table></figure><p>查看 <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#manually-create-a-long-lived-api-token-for-a-serviceaccount">Kubernetes 文档</a>，了解有关 ServiceAccount 的长期 API 令牌的更多信息。</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_451018f8aaf9cdda00b42a1da75d3b46.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_451018f8aaf9cdda00b42a1da75d3b46.png"></p><h3 id="最后将dashboard端口暴露在外用于访问"><a href="#最后将dashboard端口暴露在外用于访问" class="headerlink" title="最后将dashboard端口暴露在外用于访问"></a>最后将<code>dashboard</code>端口暴露在外用于访问</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl  patch svc kubernetes-dashboard -n kubernetes-dashboard \</span><br><span class="line">-p <span class="string">&#x27;&#123;&quot;spec&quot;:&#123;&quot;type&quot;:&quot;NodePort&quot;,&quot;ports&quot;:[&#123;&quot;port&quot;:443,&quot;targetPort&quot;:8443,&quot;nodePort&quot;:30443&#125;]&#125;&#125;&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_57bf21fb0b0a561b21cf24556ecc01a5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_57bf21fb0b0a561b21cf24556ecc01a5.png"></p><h3 id="扩展一键部署"><a href="#扩展一键部署" class="headerlink" title="扩展一键部署"></a>扩展一键部署</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -sSL https://drive.zznnwn.cloudns.biz/onedrive/脚本/k8s一键部署脚本/k8s-dashboard.sh | bash</span><br></pre></td></tr></table></figure><h3 id="登陆仪表盘"><a href="#登陆仪表盘" class="headerlink" title="登陆仪表盘"></a>登陆仪表盘</h3><p>访问：<a href="https://localhost:8443/#/login">https://localhost:8443/#/login</a></p><h3 id="清理和后续步骤"><a href="#清理和后续步骤" class="headerlink" title="清理和后续步骤"></a>清理和后续步骤</h3><p>删除 admin 和 .<code>ServiceAccount ClusterRoleBinding</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kubernetes-dashboard delete serviceaccount admin-user</span><br><span class="line">kubectl -n kubernetes-dashboard delete clusterrolebinding admin-user</span><br></pre></td></tr></table></figure><p>要了解有关如何在 Kubernetes 中授予/拒绝权限的更多信息，请阅读官方<a href="https://kubernetes.io/docs/reference/access-authn-authz/authentication/">身份验证</a>和<a href="https://kubernetes.io/docs/reference/access-authn-authz/authorization/">授权</a>文档。</p><h4 id="本文参考"><a href="#本文参考" class="headerlink" title="本文参考"></a>本文参考</h4><p><a href="https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/web-ui-dashboard/">https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/web-ui-dashboard/</a><br><a href="https://github.com/kubernetes/dashboard/blob/master/docs/user/access-control/creating-sample-user.md">https://github.com/kubernetes/dashboard/blob/master/docs/user/access-control/creating-sample-user.md</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s去除污点节点</title>
      <link href="/2024/03/12/k8s%E5%8E%BB%E9%99%A4%E6%B1%A1%E7%82%B9%E8%8A%82%E7%82%B9/"/>
      <url>/2024/03/12/k8s%E5%8E%BB%E9%99%A4%E6%B1%A1%E7%82%B9%E8%8A%82%E7%82%B9/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="k8s去除污点节点"><a href="#k8s去除污点节点" class="headerlink" title="k8s去除污点节点"></a>k8s去除污点节点</h3><p><strong>现象</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看节点详情</span></span><br><span class="line">kubectl describe pods nginx-7b7485646b-n9f8g  -n default  </span><br><span class="line"></span><br><span class="line"><span class="comment">################报错信息##############</span></span><br><span class="line"></span><br><span class="line">Node-Selectors:                                                                                                          </span><br><span class="line">Tolerations:                 node.kubernetes.io/not-ready:NoExecute op=Exists <span class="keyword">for</span> 300s                                         </span><br><span class="line">                             node.kubernetes.io/unreachable:NoExecute op=Exists <span class="keyword">for</span> 300s                                       </span><br><span class="line">Events:                                                                                                                        </span><br><span class="line">  Type     Reason            Age    From               Message                                                                 </span><br><span class="line">  ----     ------            ----   ----               -------                                                                 </span><br><span class="line">  Warning  FailedScheduling  2m54s  default-scheduler  0/1 nodes are available: 1 node(s) had untolerated taint &#123;node-role.kubernetes.io/control-plane: &#125;. </span><br><span class="line">preemption: 0/1 nodes are available: 1 Preemption is not helpful <span class="keyword">for</span> scheduling.. </span><br></pre></td></tr></table></figure><p><strong>解决</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@k8s:~<span class="comment"># kubectl describe nodes |grep Taints                                                                                                      </span></span><br><span class="line">Taints:             node-role.kubernetes.io/control-plane:NoSchedule                                                                                 </span><br><span class="line">                                                                                                                                                                                        </span><br><span class="line">root@k8s:~<span class="comment"># kubectl get node                                                                                                                         </span></span><br><span class="line">NAME   STATUS   ROLES           AGE     VERSION                                                                                                      </span><br><span class="line">k8s    Ready    control-plane   4h22m   v1.26.5                                                                                                      </span><br><span class="line">root@k8s:~<span class="comment"># kubectl taint nodes k8s  node-role.kubernetes.io/control-plane-</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_169b466f0666661a0ccb13ce6795653b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/3/image_169b466f0666661a0ccb13ce6795653b.png"></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>k8s常用命令</title>
      <link href="/2024/03/12/k8s%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/2024/03/12/k8s%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="k8s常用命令"><a href="#k8s常用命令" class="headerlink" title="k8s常用命令"></a>k8s常用命令</h3><p>这是一个用于管理 Kubernetes 集群的 kubectl 命令。让我们解释一下这个命令的各个部分：</p><ul><li><strong>kubectl</strong>: 这是 Kubernetes 命令行工具，用于与 Kubernetes 集群进行交互，例如创建、管理和监视资源。</li><li><strong>get</strong>: 这是 kubectl 命令的一个子命令，用于检索（获取）Kubernetes 集群中的资源的信息。</li><li><strong>svc</strong>: 这是 “service” 的缩写，表示你希望获取服务（Service）的相关信息。</li><li><strong>deploy</strong>: 这是 “deployment” 的缩写，表示你希望获取部署（Deployment）的相关信息。</li><li><strong>-n kube-system</strong>: 这是一个标志（flag），用于指定要检索资源所在的命名空间（namespace）。在这种情况下，”-n kube-system” 表示你希望获取位于 kube-system 命名空间中的服务的信息。</li></ul><p><strong>通过yml创建删除应用</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply  -f kuboard-offline.yml</span><br><span class="line">kubectl delete -f kuboard-offline.yml</span><br><span class="line">kubectl apply  -f nginx-deployment.yml</span><br></pre></td></tr></table></figure><p><strong>通过命令行创建应用</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看帮助命令</span></span><br><span class="line">kubectl create deployment --<span class="built_in">help</span></span><br><span class="line"><span class="comment"># 开始发布应用 指定名称是demo 镜像是nginx:1.7.9 副本数是3</span></span><br><span class="line">kubectl create deployment demo --image=nginx:1.7.9 --replicas=3</span><br><span class="line"><span class="comment">#创建service暴露端口使用vip访问</span></span><br><span class="line">kubectl expose deployment demo --port=80 --target-port=80 </span><br><span class="line"></span><br><span class="line">kubectl create deployment nginx --image=registry.cn-hangzhou.aliyuncs.com/xiaohh-docker/nginx:latest</span><br><span class="line">kubectl expose deployment nginx --port=80 --<span class="built_in">type</span>=LoadBalancer</span><br><span class="line">kubectl delete deployment nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建service </span></span><br><span class="line">kubectl create -f nginx-service.yaml</span><br><span class="line"><span class="comment"># 查看暴露在外部的端口</span></span><br><span class="line">kubectl get service/nginx-service</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除pod</span></span><br><span class="line">kubectl delete deployment demo </span><br></pre></td></tr></table></figure><p><strong>暴露外部端口用于访问</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kubectl  patch svc kubernetes-dashboard -n kubernetes-dashboard \</span><br><span class="line">-p <span class="string">&#x27;&#123;&quot;spec&quot;:&#123;&quot;type&quot;:&quot;NodePort&quot;,&quot;ports&quot;:[&#123;&quot;port&quot;:443,&quot;targetPort&quot;:8443,&quot;nodePort&quot;:30443&#125;]&#125;&#125;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>查看pod详情</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看命名空间为kube-system的pod详情</span></span><br><span class="line">kubectl get pods -n kube-system</span><br><span class="line">kubectl get pods -n kube-system -o wide</span><br><span class="line">kubectl describe pod kubernetes-dashboard-7bdfc744fc-hmhh2 -n kube-system</span><br><span class="line"><span class="comment"># 获取位于 kube-system/kubernetes-dashboard 命名空间中的所有服务（Service）的信息。这将列出 kube-system 命名空间中所有服务的详细信息，包括服务的名称、类型、集群IP等。</span></span><br><span class="line">kubectl get svc -n kube-system</span><br><span class="line">kubectl get svc -n kubernetes-dashboard </span><br><span class="line"><span class="comment"># 查看系统pod以外的pod详情/查看自己部署的应用</span></span><br><span class="line">kubectl get pods -o wide</span><br><span class="line">kubectl get deployments.apps</span><br><span class="line">kubectl describe pods nginx-deployment-57c68fcd95-sgd25</span><br><span class="line"><span class="comment"># 查看demo应用（容器）service(svc)详细</span></span><br><span class="line">kubectl describe service demo</span><br><span class="line"><span class="comment"># 查看节点状态</span></span><br><span class="line">kubectl get nodes</span><br><span class="line">kubectl get cs</span><br><span class="line"><span class="comment"># coredns组件用于做名称解析 主要是通过daemonsets.apps的形式在里面部署两个daemonset分别是kube-flannel-ds 和 kube-proxy</span></span><br><span class="line">kubectl get daemonsets.apps -n kube-system</span><br></pre></td></tr></table></figure><p><strong>登陆进入pod相当于docker exec</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 登录容器查看volumes详情</span></span><br><span class="line">kubectl <span class="built_in">exec</span> -it volume-rbd-demo /bin/bash</span><br><span class="line">kubectl <span class="built_in">exec</span> -it volume-rbd-demo -- <span class="built_in">df</span> -h</span><br></pre></td></tr></table></figure><p><strong>部分命令完整写法</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">$ kubectl get deployment --namespace=kubernetes-dashboard kubernetes-dashboard</span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">$ kubectl describe deployment --namespace=kubernetes-dashboard kubernetes-dashboard</span><br><span class="line"><span class="comment"># 查看service</span></span><br><span class="line">$ kubectl get service --namespace=kubernetes-dashboard kubernetes-dashboard </span><br><span class="line">返回</span><br><span class="line">NAME                   TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)   AGE</span><br><span class="line">kubernetes-dashboard   ClusterIP   10.108.163.102   &lt;none&gt;        443/TCP   5m15s</span><br><span class="line"><span class="comment"># 另外查看pod状态 (此时说明安装完成</span></span><br><span class="line">$ kubectl --namespace=kubernetes-dashboard get pod -o wide | grep dashboard</span><br><span class="line">返回</span><br><span class="line">dashboard-metrics-scraper-79459f84f-5g8h6   1/1     Running   0          5m34s   172.16.0.9   ceph1   &lt;none&gt;   </span><br><span class="line">kubernetes-dashboard-76dc96b85f-nhwjd       1/1     Running   0          5m34s   172.16.0.8   ceph1   &lt;none&gt;</span><br><span class="line"><span class="comment"># 查看svc</span></span><br><span class="line">kubectl -n kubernetes-dashboard get svc</span><br><span class="line">NAME                        TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)    AGE</span><br><span class="line">dashboard-metrics-scraper   ClusterIP   10.104.31.122    &lt;none&gt;        8000/TCP   32m</span><br><span class="line">kubernetes-dashboard        ClusterIP   10.108.163.102   &lt;none&gt;        443/TCP    32m</span><br><span class="line"><span class="comment"># 如果状态一直创建中, 使用describe查看具体过程 （如下回显则需要设置拉取镜像方法）</span></span><br><span class="line">$ kubectl describe pod --namespace=kubernetes-dashboard</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一键部署k8s脚本</title>
      <link href="/2024/03/11/%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E5%8D%95%E8%8A%82%E7%82%B9k8s%E8%84%9A%E6%9C%AC/"/>
      <url>/2024/03/11/%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E5%8D%95%E8%8A%82%E7%82%B9k8s%E8%84%9A%E6%9C%AC/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>使用container作为k8s容器运行时服务器不需要安装cni<br><strong>kube-flannel.yml配置原链接</strong><br><a href="https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml">https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</a></p></blockquote><p>项目链接：<a href="https://gitee.com/apple-Teawine/k8s/tree/master/deploy-k8s-container%E7%89%88">https://gitee.com/apple-Teawine/k8s/tree/master/deploy-k8s-container版</a></p><p>本文参考：</p><p><a href="https://blog.csdn.net/weixin_58648684/article/details/130699568">https://blog.csdn.net/weixin_58648684/article/details/130699568</a><br><a href="https://cn.linux-console.net/?p=3508">https://cn.linux-console.net/?p=3508</a>  container安装参考<br><a href="https://wn-apple-teawine.fun/2023/06/04/ubuntu%E9%83%A8%E7%BD%B2kubernetes">https://wn-apple-teawine.fun/2023/06/04/ubuntu部署kubernetes</a><br><a href="https://www.cnblogs.com/way2backend/p/16970506.html#3-%E5%AE%89%E8%A3%85containerd">https://www.cnblogs.com/way2backend/p/16970506.html#3-%E5%AE%89%E8%A3%85containerd</a><br><a href="https://blog.csdn.net/IOT_AI/article/details/131916926">[Ubuntu 22.04] 安装containerd_ubuntu22.04 安装containerd-CSDN博客</a></p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在Linux上以All-in-One模式安装KubeSphere</title>
      <link href="/2024/03/10/%E5%9C%A8Linux%E4%B8%8A%E4%BB%A5All-in-One%E6%A8%A1%E5%BC%8F%E5%AE%89%E8%A3%85KubeSphere/"/>
      <url>/2024/03/10/%E5%9C%A8Linux%E4%B8%8A%E4%BB%A5All-in-One%E6%A8%A1%E5%BC%8F%E5%AE%89%E8%A3%85KubeSphere/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>首先服务器执行初始化脚本 安装docker</p><p>本文参考：<a href="https://kubesphere.io/zh/docs/v3.4/quick-start/all-in-one-on-linux/">https://kubesphere.io/zh/docs/v3.4/quick-start/all-in-one-on-linux/</a></p><h3 id="节点要求"><a href="#节点要求" class="headerlink" title="节点要求"></a>节点要求</h3><ul><li>节点必须能够通过 <code>SSH</code> 连接。</li><li>节点上可以使用 <code>sudo</code>/<code>curl</code>/<code>openssl</code>/<code>tar</code> 命令。</li></ul><h3 id="容器运行时"><a href="#容器运行时" class="headerlink" title="容器运行时"></a>容器运行时</h3><p>您的集群必须有一个可用的容器运行时。如果您使用 KubeKey 搭建集群，KubeKey 会默认安装最新版本的 Docker。或者，您也可以在创建集群前手动安装 Docker 或其他容器运行时。</p><table><thead><tr><th>支持的容器运行时</th><th>版本</th></tr></thead><tbody><tr><td>Docker</td><td>19.3.8 +</td></tr><tr><td>containerd</td><td>最新版</td></tr><tr><td>CRI-O（试验版，未经充分测试）</td><td>最新版</td></tr><tr><td>iSula（试验版，未经充分测试）</td><td>最新版</td></tr></tbody></table><h3 id="依赖项要求"><a href="#依赖项要求" class="headerlink" title="依赖项要求"></a>依赖项要求</h3><p>KubeKey 可以将 Kubernetes 和 KubeSphere 一同安装。针对不同的 Kubernetes 版本，需要安装的依赖项可能有所不同。您可以参考以下列表，查看是否需要提前在节点上安装相关的依赖项。</p><table><thead><tr><th>依赖项</th><th>Kubernetes 版本 ≥ 1.18</th><th>Kubernetes 版本 &lt; 1.18</th></tr></thead><tbody><tr><td><code>socat</code></td><td>必须</td><td>可选但建议</td></tr><tr><td><code>conntrack</code></td><td>必须</td><td>可选但建议</td></tr><tr><td><code>ebtables</code></td><td>可选但建议</td><td>可选但建议</td></tr><tr><td><code>ipset</code></td><td>可选但建议</td><td>可选但建议</td></tr></tbody></table><p>KubeKey 是用 Go 语言开发的一款全新的安装工具，代替了以前基于 ansible 的安装程序。KubeKey 为用户提供了灵活的安装选择，可以分别安装 KubeSphere 和 Kubernetes 或二者同时安装，既方便又高效。</p><h3 id="网络和-DNS-要求"><a href="#网络和-DNS-要求" class="headerlink" title="网络和 DNS 要求"></a>网络和 DNS 要求</h3><ul><li>请确保 <code>/etc/resolv.conf</code> 中的 DNS 地址可用，否则，可能会导致集群中的 DNS 出现问题。</li><li>如果您的网络配置使用防火墙规则或安全组，请务必确保基础设施组件可以通过特定端口相互通信。建议您关闭防火墙。有关更多信息，请参见<a href="https://kubesphere.io/zh/docs/v3.3/installing-on-linux/introduction/port-firewall/">端口要求</a>。</li><li>支持的 CNI 插件：Calico 和 Flannel。其他插件也适用（例如 Cilium 和 Kube-OVN 等），但请注意它们未经充分测试。</li></ul><p>提示</p><ul><li>建议您的操作系统处于干净状态（不安装任何其他软件），否则可能会发生冲突。</li><li>如果您无法从 <code>dockerhub.io</code> 下载容器镜像，建议提前准备仓库的镜像地址（即加速器）。有关更多信息，请参见<a href="https://kubesphere.io/zh/docs/v3.4/faq/installation/configure-booster/">为安装配置加速器</a>。</li></ul><p>硬件推荐配置</p><table><thead><tr><th>操作系统</th><th>最低配置</th></tr></thead><tbody><tr><td><strong>Ubuntu</strong> <em>16.04</em>, <em>18.04</em>, <em>20.04</em>, <em>22.04</em></td><td>2 核 CPU，4 GB 内存，40 GB 磁盘空间</td></tr><tr><td><strong>Debian</strong> <em>Buster</em>, <em>Stretch</em></td><td>2 核 CPU，4 GB 内存，40 GB 磁盘空间</td></tr><tr><td><strong>CentOS</strong> <em>7.x</em></td><td>2 核 CPU，4 GB 内存，40 GB 磁盘空间</td></tr><tr><td><strong>Red Hat Enterprise Linux 7</strong></td><td>2 核 CPU，4 GB 内存，40 GB 磁盘空间</td></tr><tr><td><strong>SUSE Linux Enterprise Server 15/openSUSE Leap 15.2</strong></td><td>2 核 CPU，4 GB 内存，40 GB 磁盘空间</td></tr></tbody></table></blockquote><p><strong>一. 安装依赖</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install -y socat conntrack ipset</span><br></pre></td></tr></table></figure><p><strong>二. 执行部署k8s</strong></p><blockquote><p>此步骤部署很可能因为网络原因导致失败</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">若此命令失败则使用下方先下载软件包解压后执行</span></span><br><span class="line">curl -sfL https://get-kk.kubesphere.io | VERSION=v3.0.13 sh -</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下载软件包</span></span><br><span class="line">cd /opt &amp;&amp; curl -flO https://kubernetes.pek3b.qingstor.com/kubekey/releases/download/v3.0.13/kubekey-v3.0.13-linux-amd64.tar.gz</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压</span></span><br><span class="line">tar -xvf kubekey-v3.0.13-linux-amd64.tar.gz</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">本文使用</span></span><br><span class="line">./kk create cluster --with-kubernetes v1.26.5 --container-manager containerd --with-kubesphere v3.4.1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">可选</span></span><br><span class="line">./kk create cluster --with-kubernetes v1.26.5 --container-manager containerd --with-local-storage</span><br></pre></td></tr></table></figure><p>k8s版本号参考：<a href="https://kubernetes.io/zh-cn/releases/">发行版本 | Kubernetes</a></p><p><strong>三. 最后：验证安装结果</strong></p><p>输入以下命令以检查安装结果。</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kubectl logs -n kubesphere-system $(kubectl get pod -n kubesphere-system -l &#x27;app in (ks-install, ks-installer)&#x27; -o jsonpath=&#x27;&#123;.items[0].metadata.name&#125;&#x27;) -f</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>输出信息会显示 Web 控制台的 IP 地址和端口号，默认的 NodePort 是 <code>30880</code>。现在，您可以使用默认的帐户和密码 (<code>admin/P@88w0rd</code>) 通过 <code>&lt;NodeIP&gt;:30880</code> 访问控制台。</p>]]></content>
      
      
      <categories>
          
          <category> k8s </category>
          
      </categories>
      
      
        <tags>
            
            <tag> k8s </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>服务器遭受SYN洪水攻击</title>
      <link href="/2024/03/05/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%81%AD%E5%8F%97SYN%E6%B4%AA%E6%B0%B4%E6%94%BB%E5%87%BB/"/>
      <url>/2024/03/05/%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%81%AD%E5%8F%97SYN%E6%B4%AA%E6%B0%B4%E6%94%BB%E5%87%BB/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>引用GPT3.5回答：</p><p>SYN 洪水攻击（SYN flooding）的情况。SYN 洪水攻击是一种常见的网络攻击方式，攻击者发送大量伪造的 TCP 连接请求（SYN 包），导致服务器资源耗尽或网络拥塞。</p><p>内核检测到可能的 SYN 洪水攻击后，会采取一些措施来应对，其中之一是发送 cookies。TCP SYN cookies 是一种用于防止 SYN 洪水攻击的技术，它允许服务器在遭受 SYN 洪水攻击时继续处理连接请求，而无需维护半开连接的状态。</p><p>它是一种常见的网络攻击类型，旨在使服务器不可用。在这种攻击中，攻击者发送大量伪造的 SYN 数据包到服务器上，使服务器无法处理所有这些连接请求，从而耗尽其资源。</p></blockquote><h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><p><strong>现象：</strong></p><p><code>Mar  5 18:04:28 ybh83aa9pnppbp kernel: TCP: request_sock_TCP: Possible SYN flooding on port 22. Sending cookies.  Check SNMP counters.</code></p><p>这个是遭受到了 SYN 洪水攻击（SYN flooding）<br>您对22端口做个白名单限制就行了<br>或者使用这个工具进行防御这种攻击<br><a href="https://github.com/fail2ban/fail2ban">https://github.com/fail2ban/fail2ban</a></p><blockquote><p>引用GPT3.5回答：</p><p>这个错误表明你的Linux服务器可能受到了 SYN 洪水攻击，它是一种常见的网络攻击类型，旨在使服务器不可用。在这种攻击中，攻击者发送大量伪造的 SYN 数据包到服务器上，使服务器无法处理所有这些连接请求，从而耗尽其资源。</p><p>要解决这个问题，你可以采取以下措施：</p><ol><li><p><strong>增加 SYN 收队列的大小</strong>：通过调整内核参数，增加服务器上 SYN 收队列的大小，使其能够处理更多的连接请求。你可以通过修改 <code>/proc/sys/net/ipv4/tcp_max_syn_backlog</code> 参数来实现。例如，可以使用以下命令将队列大小增加到 1024：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_max_syn_backlog=1024</span><br></pre></td></tr></table></figure></li><li><p><strong>配置防火墙</strong>：使用防火墙来过滤来自外部网络的恶意流量。可以配置防火墙规则，限制每个 IP 地址对 SSH 端口的连接速率，或者使用工具如 Fail2Ban 来自动检测并封锁恶意 IP 地址。</p></li><li><p><strong>使用 SYN Cookie</strong>：启用 SYN Cookie 可以防止服务器被 SYN 洪水攻击所拒绝服务。这个选项会在服务器端在收到 SYN 请求时不分配资源，而是使用一个加密的 Cookie 发送给客户端。只有当客户端返回带有正确 Cookie 的 ACK 请求时，服务器才会分配资源并完成 TCP 握手。你可以通过以下命令启用 SYN Cookie：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w net.ipv4.tcp_syncookies=1</span><br></pre></td></tr></table></figure></li><li><p><strong>更新系统和软件</strong>：确保你的系统和所有安全相关的软件都是最新的版本，因为厂商通常会修复已知的漏洞和安全问题。</p></li><li><p><strong>监控网络流量</strong>：定期监控服务器上的网络流量，并在检测到异常流量时及时采取行动。</p></li><li><p><strong>限制 SSH 访问</strong>：如果可能，尝试限制 SSH 访问只允许来自特定 IP 地址范围的连接，以减少服务器受到攻击的风险。</p></li></ol><p>如果以上措施都不能解决问题，你可能需要进一步的调查和分析，可能需要与网络安全专家合作，以找出更深层次的解决方案。</p></blockquote><h4 id="fail2ban安装及使用参考"><a href="#fail2ban安装及使用参考" class="headerlink" title="fail2ban安装及使用参考"></a>fail2ban安装及使用参考</h4><p><a href="https://blog.csdn.net/dudu1225/article/details/121242917">Fail2ban安装及配置</a><br><a href="https://blog.csdn.net/qq_46229380/article/details/109802360">Fail2ban安装及配置压缩包方式安装</a><br><a href="https://www.jianshu.com/p/4fdec5794d08">CentOS7下安装和使用Fail2ban - 简书 (jianshu.com)</a></p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Windows或Linux SSH连接或者服务偶发性断开问题处理</title>
      <link href="/2024/02/19/Windows%E6%88%96Linux%20SSH%E8%BF%9E%E6%8E%A5%E6%88%96%E8%80%85%E6%9C%8D%E5%8A%A1%E5%81%B6%E5%8F%91%E6%80%A7%E6%96%AD%E5%BC%80%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/"/>
      <url>/2024/02/19/Windows%E6%88%96Linux%20SSH%E8%BF%9E%E6%8E%A5%E6%88%96%E8%80%85%E6%9C%8D%E5%8A%A1%E5%81%B6%E5%8F%91%E6%80%A7%E6%96%AD%E5%BC%80%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h3 id="Windows或Linux-SSH连接或者服务偶发性断开问题处理"><a href="#Windows或Linux-SSH连接或者服务偶发性断开问题处理" class="headerlink" title="Windows或Linux SSH连接或者服务偶发性断开问题处理"></a>Windows或Linux SSH连接或者服务偶发性断开问题处理</h3><p><a href="https://support.huaweicloud.com/trouble-ecs/ecs-trouble.pdf">查看PDF</a></p><p><a href>分享</a></p><h4 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h4><p>该文档适用于在SSH连接Linux云服务器或者访问该服务器上的应用时偶现连接断开。</p><h4 id="约束与限制"><a href="#约束与限制" class="headerlink" title="约束与限制"></a>约束与限制</h4><ol><li>修改系统内核参数可能产生内核不稳定，请评估风险后进行操作。</li><li>为了确保系统稳定运行，修改内核参数后建议在合理的时间重启系统。</li></ol><h4 id="根因分析"><a href="#根因分析" class="headerlink" title="根因分析"></a>根因分析</h4><ol><li><p>执行以下命令，查看系统内核是否开启了TIME_WAIT快速回收和重利用策略</p><p><strong>sysctl -a |grep tcp_tw</strong></p><p>如<a href="https://support.huaweicloud.com/trouble-ecs/ecs_trouble_0317.html#ecs_trouble_0317__fig258143323916">图1</a>所示，确认已开启该策略。</p><p><strong>图1</strong> TIME_WAIT<br><img src="https://support.huaweicloud.com/trouble-ecs/zh-cn_image_0174991741.png"></p></li><li><p>由于服务端开启了TIME_WAIT快速回收和重利用策略导致，即启用了net.ipv4.tcp_tw_recycle或者net.ipv4.tcp_tw_reuse。系统默认是不启用该功能。<br><img src="https://res-static.hc-cdn.cn/aem/content/dam/cloudbu-site/archive/china/zh-cn/support/resource/framework/v3/images/support-doc-new-note.svg">说明：客户端通常在NAT环境下，多台终端使用同一个公网ip，无法实现服务端与客户端的一对一连接。如果开启此参数服务端会回收处于TIME_WAIT状态的TCP连接，导致连接断开。</p></li></ol><h4 id="操作方法："><a href="#操作方法：" class="headerlink" title="操作方法："></a>操作方法：</h4><p>关闭上述两个内核参数，打开/etc/sysctl.conf，添加或者修改下列两行。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net.ipv4.tcp_tw_recycle = 0</span><br><span class="line">net.ipv4.tcp_tw_reuse = 0</span><br></pre></td></tr></table></figure><p>执行以下命令，使修改的配置生效。<br><strong># sysctl -p</strong></p><p><img src="https://res-static.hc-cdn.cn/aem/content/dam/cloudbu-site/archive/china/zh-cn/support/resource/framework/v3/images/support-doc-new-note.svg">说明：启动中修改内核参数可能存在内核加载该参数不稳定的情况，建议在合适的时间进行重启。</p><p>上文参考：<a href="https://support.huaweicloud.com/trouble-ecs/ecs_trouble_0317.html">SSH连接或者服务偶发性断开问题处理_弹性云服务器 ECS_故障排除_SSH连接 (huaweicloud.com)</a></p><h4 id="windows服务偶发性断连解决"><a href="#windows服务偶发性断连解决" class="headerlink" title="windows服务偶发性断连解决"></a>windows服务偶发性断连解决</h4><p>此文参考：</p><p><a href="https://zhuanlan.zhihu.com/p/604394878">https://zhuanlan.zhihu.com/p/604394878</a><br><a href="https://blog.csdn.net/boonya/article/details/105700988">https://blog.csdn.net/boonya/article/details/105700988</a><br><a href="https://mp.weixin.qq.com/s?__biz=MzkzNzI1MzE2Mw==&mid=2247484249&idx=1&sn=d522df8c29cdc5c2bb1c466403c0d737&chksm=c293031df5e48a0b7856b9a553dbf1df27015afe09c939f114ad35ad486a30737dd4b258f4e5&scene=21#wechat_redirect">运维排查篇 | 服务器产生大量的TIME_WAIT的原因你知道吗？</a></p>]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>openstack上使用windows镜像制作</title>
      <link href="/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/"/>
      <url>/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="一-workstdtion-vsphere-制作openstack镜像"><a href="#一-workstdtion-vsphere-制作openstack镜像" class="headerlink" title="一.  workstdtion/ vsphere 制作openstack镜像"></a>一.  <code>workstdtion</code>/ vsphere 制作<code>openstack</code>镜像</h2><h3 id="note"><a href="#note" class="headerlink" title="note:"></a>note:</h3><h4 id="演示windows-server2016版本-配置时需要至少给C盘50G空间"><a href="#演示windows-server2016版本-配置时需要至少给C盘50G空间" class="headerlink" title="演示windows-server2016版本 / 配置时需要至少给C盘50G空间"></a>演示<code>windows-server2016</code>版本 / 配置时需要至少给C盘<code>50G</code>空间</h4><h3 id="前言："><a href="#前言：" class="headerlink" title="前言："></a>前言：</h3><blockquote><p><strong>因为 windows 默认不支持 virtio 驱动，而通过 openstack 管理的虚拟机是需要 virtio 驱动的，所以需要给 windows 安装驱动，包括硬盘驱动和网卡驱动另外还需要安装CloudbaseInitSetup和qemu-ga (qemu-guest-agent)</strong> <a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/</a> <strong>以上地址可下载最新稳定版的 virtio-win-x.x.xxx.iso 文件，该文件包含了硬盘驱动和网卡驱动以及</strong></p></blockquote><h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><ul><li><a href="https://www.jianshu.com/p/60caf1c2f10a">https://www.jianshu.com/p/60caf1c2f10a</a>                                                                 （简书）</li><li><a href="https://support.huaweicloud.com/usermanual-ims/zh-cn_topic_0030730602.html">https://support.huaweicloud.com/usermanual-ims/zh-cn_topic_0030730602.html</a>   （华为云 could-init使用）</li><li><a href="https://cloud.tencent.com/document/product/213/30000">https://cloud.tencent.com/document/product/213/30000</a>                                             (腾讯云  could-init配置)</li><li><a href="https://blog.51cto.com/readshlinux/1902888">https://blog.51cto.com/readshlinux/1902888</a>                                                                (51cto修改密码脚本)</li></ul><h3 id="命令参考："><a href="#命令参考：" class="headerlink" title="命令参考："></a>命令参考：</h3><ul><li><a href="http://linuxcoming.com/blog/2019/09/03/linux_basic_tools_virt_install_os_variant.html">http://linuxcoming.com/blog/2019/09/03/linux_basic_tools_virt_install_os_variant.html</a></li><li><strong>驱动无法安装参考：</strong></li><li><a href="https://zhidao.baidu.com/question/2207933972086796788.html">https://zhidao.baidu.com/question/2207933972086796788.html</a></li></ul><h4 id="安装必备软件"><a href="#安装必备软件" class="headerlink" title="安装必备软件"></a>安装必备软件</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 安装必备软件</span><br><span class="line">yum install -y qemu-kvm libvirt virt-install bridge-utils</span><br></pre></td></tr></table></figure><h3 id="1-下载Cloudbase-Init工具-下载Cloudbase-Init工具安装包。"><a href="#1-下载Cloudbase-Init工具-下载Cloudbase-Init工具安装包。" class="headerlink" title="1.下载Cloudbase-Init工具  下载Cloudbase-Init工具安装包。"></a><code>1</code>.下载<code>Cloudbase-Init</code>工具  下载<code>Cloudbase-Init</code>工具安装包。</h3><p><strong>根据Windows操作系统的不同位数，您需要下载不同版本的Cloudbase-Init工具安装包。</strong></p><p><strong>Cloudbase官网：</strong></p><p><a href="https://links.jianshu.com/go?to=http://www.cloudbase.it/cloud-init-for-windows-instances/">http://www.cloudbase.it/cloud-init-for-windows-instances/</a>。</p><p><strong>Cloudbase-Init分为稳定版本和Beta版本两种。</strong> <strong>稳定版本获取路径：</strong></p><p><strong>64位：</strong></p><p><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x64.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x64.msi</a><br><a href="https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_11_x64.msi">https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_11_x64.msi</a><br><a href="https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_9_x64.msi">https://cloudbase.it/downloads/CloudbaseInitSetup_0_9_9_x64.msi</a></p><p><strong>32位：</strong></p><p><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x86.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_Stable_x86.msi</a></p><p><strong>Beta版本获取路径：</strong></p><p><strong>64位：</strong><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_x64.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_x64.msi</a></p><p><strong>32位：</strong><a href="https://links.jianshu.com/go?to=https://www.cloudbase.it/downloads/CloudbaseInitSetup_x86.msi">https://www.cloudbase.it/downloads/CloudbaseInitSetup_x86.msi</a></p><p><strong>virtio-win驱动下载:</strong></p><p><strong><a href="https://links.jianshu.com/go?to=https://github.com/virtio-win/kvm-guest-drivers-windows">https://github.com/virtio-win/kvm-guest-drivers-windows</a></strong></p><p><strong>或</strong></p><p> <a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/stable-virtio/</a></p><h4 id="windows-iso镜像下载地址："><a href="#windows-iso镜像下载地址：" class="headerlink" title="windows-iso镜像下载地址："></a>windows-iso镜像下载地址：</h4><p><a href="https://msdn.itellyou.cn/">https://msdn.itellyou.cn/</a></p><hr><h4 id="首先开启vcenter-vmware虚拟化："><a href="#首先开启vcenter-vmware虚拟化：" class="headerlink" title="首先开启vcenter/vmware虚拟化："></a>首先开启vcenter/vmware虚拟化：</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c7a56db15460c4c9ec3337ba89289ef2.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c7a56db15460c4c9ec3337ba89289ef2.png"></p><h5 id="注意事项：-目录建议根目录下创建一个新目录-不能在-root目录执行创建工作目录-会报错-权限错误"><a href="#注意事项：-目录建议根目录下创建一个新目录-不能在-root目录执行创建工作目录-会报错-权限错误" class="headerlink" title="注意事项：  目录建议根目录下创建一个新目录 不能在/root目录执行创建工作目录 会报错 权限错误"></a>注意事项：  目录建议根目录下创建一个新目录 不能在/root目录执行创建工作目录 会报错 权限错误</h5><h4 id="下载完成截图：共3软件"><a href="#下载完成截图：共3软件" class="headerlink" title="下载完成截图：共3软件"></a>下载完成截图：共<code>3</code>软件</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_29087c9168c1688bc91ff2c661a017a6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_29087c9168c1688bc91ff2c661a017a6.png"></p><h3 id="2-网卡配置（物理机-vmware-vcenter创建）"><a href="#2-网卡配置（物理机-vmware-vcenter创建）" class="headerlink" title="2. 网卡配置（物理机/ vmware / vcenter创建）"></a><code>2</code>. 网卡配置（物理机<code>/ vmware / vcenter</code>创建）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 备份网卡</span><br><span class="line">cp ifcfg-ens33 ifcfg-br0</span><br></pre></td></tr></table></figure><h5 id="修改ifcfg-ens33"><a href="#修改ifcfg-ens33" class="headerlink" title="修改ifcfg-ens33"></a>修改<code>ifcfg-ens33</code></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">2、BOOTPROTO=&quot;dhcp&quot; # 改为 BOOTPROTO=&quot;static&quot;</span><br><span class="line">3、BRIDGE=br0       # 调整为网桥模式 其他不做更改</span><br><span class="line"># 保留如下配置其他配置通通删除</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=ens33</span><br><span class="line">BRIDGE=br0</span><br><span class="line">UUID=01d75770-3b87-47e3-bbc3-bebaed2293e3</span><br><span class="line">DEVICE=ens33</span><br><span class="line">ONBOOT=yes</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6372d21fbb18fb333f61a84f13eed939.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6372d21fbb18fb333f61a84f13eed939.png"></p><h4 id="修改ifcfg-br0"><a href="#修改ifcfg-br0" class="headerlink" title="修改ifcfg-br0"></a>修改<code>ifcfg-br0</code></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">1、TYPE=&quot;Ethernet&quot;   # 修改为TYPE=&quot;Bridge&quot;</span><br><span class="line">2、BOOTPROTO=&quot;dhcp&quot;  # 改为 BOOTPROTO=&quot;static&quot;</span><br><span class="line">3、NAME=&quot;ens33&quot;      # 修改为 NAME=&quot;br0&quot;  及 DEVICE=&quot;ens33&quot;  修改为 DEVICE=&quot;br0&quot;</span><br><span class="line">4、注释 UUID         # UUID=&quot;a8d78ec6-485c-4d14-aae1-1908bc6b9a61&quot;</span><br><span class="line">5、配置静态IP</span><br><span class="line">IPADDR=10.0.0.20</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=223.5.5.5</span><br><span class="line"># 完整网卡配置 -------------------------------</span><br><span class="line">TYPE=Bridge</span><br><span class="line">PROXY_METHOD=none</span><br><span class="line">BROWSER_ONLY=no</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEFROUTE=yes</span><br><span class="line">IPV4_FAILURE_FATAL=no</span><br><span class="line">IPV6INIT=yes</span><br><span class="line">IPV6_AUTOCONF=yes</span><br><span class="line">IPV6_DEFROUTE=yes</span><br><span class="line">IPV6_FAILURE_FATAL=no</span><br><span class="line">IPV6_ADDR_GEN_MODE=stable-privacy</span><br><span class="line">NAME=br0</span><br><span class="line"># UUID=01d75770-3b87-47e3-bbc3-bebaed2293e3</span><br><span class="line">DEVICE=br0</span><br><span class="line">ONBOOT=yes</span><br><span class="line">IPADDR=10.0.0.20</span><br><span class="line">PREFIX=24</span><br><span class="line">GATEWAY=10.0.0.220</span><br><span class="line">DNS1=223.5.5.5</span><br><span class="line"># 重启网卡</span><br><span class="line">systemctl restart network.service</span><br></pre></td></tr></table></figure><h4 id="如果采用（云主机）创建需要修改网卡（-强烈建议不要使用云主机可能会出现各种抽风现象-）配置-如下配置-如下："><a href="#如果采用（云主机）创建需要修改网卡（-强烈建议不要使用云主机可能会出现各种抽风现象-）配置-如下配置-如下：" class="headerlink" title="如果采用（云主机）创建需要修改网卡（ 强烈建议不要使用云主机可能会出现各种抽风现象 ）配置 如下配置 如下："></a>如果采用（云主机）创建需要修改网卡（ 强烈建议不要使用云主机可能会出现各种抽风现象 ）配置 如下配置 如下：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@images network-scripts]# cat ifcfg-br0</span><br><span class="line"># Created by cloud-init on instance boot automatically, do not edit.</span><br><span class="line">#</span><br><span class="line">BOOTPROTO=static      # 改</span><br><span class="line">DEVICE=br0            # 改</span><br><span class="line">HWADDR=fa:16:3e:90:a8:67</span><br><span class="line">MTU=1500</span><br><span class="line">ONBOOT=yes</span><br><span class="line">STARTMODE=auto</span><br><span class="line">TYPE=Bridge           # 改</span><br><span class="line">USERCTL=no            </span><br><span class="line">IPADDR=10.0.0.76      # 改</span><br><span class="line">PREFIX=24             # 改</span><br><span class="line">GATEWAY=10.0.0.1      # 改</span><br><span class="line">DNS1=223.5.5.5        # 改</span><br><span class="line">#-------------------------------------------------------------------------</span><br><span class="line">[root@images network-scripts]# cat ifcfg-eth0</span><br><span class="line"># Created by cloud-init on instance boot automatically, do not edit.</span><br><span class="line">#</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">DEVICE=eth0</span><br><span class="line">#HWADDR=fa:16:3e:90:a8:67     # 改</span><br><span class="line">MTU=1500</span><br><span class="line">ONBOOT=yes</span><br><span class="line">STARTMODE=auto</span><br><span class="line">TYPE=Ethernet                 # 改</span><br><span class="line">USERCTL=no</span><br><span class="line">BRIDGE=br0                    # 改</span><br></pre></td></tr></table></figure><h4 id="3-查看是否支持虚拟化-（支持）"><a href="#3-查看是否支持虚拟化-（支持）" class="headerlink" title="3. 查看是否支持虚拟化 （支持）"></a><code>3</code>. 查看是否支持虚拟化 （支持）</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查看是否支持虚拟化</span><br><span class="line">grep -E &#x27;(vmx|svm)&#x27; /proc/cpuinfo</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_a37f9f1aa2fc3773a217aed3042a7fdf.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_a37f9f1aa2fc3773a217aed3042a7fdf.png"></p><h3 id="4-创建镜像文件包"><a href="#4-创建镜像文件包" class="headerlink" title="4. 创建镜像文件包"></a><code>4</code>. 创建镜像文件包</h3><p><strong>文件存放目录必须为根目录下新建一个目录 切记不能在</strong><code>root</code>目录否则会报错</p><h4 id="各个目录存放文件概览："><a href="#各个目录存放文件概览：" class="headerlink" title="各个目录存放文件概览："></a>各个目录存放文件概览：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># 关于文件存放目录必须为根目录下新建一个目录 此处如下：</span><br><span class="line">mkdir -p /data/windows/data</span><br><span class="line">mkdir -p /data/windows/CloudbaseInitSetup</span><br><span class="line"></span><br><span class="line"># /data/windows目录存放：</span><br><span class="line">[root@cpe-172-100-70-251 windows]# ls -lh</span><br><span class="line">总用量 101M</span><br><span class="line">-rw-r--r--. 1 root root 101M 3月  22 13:52 CloudbaseInitSetup.iso</span><br><span class="line">drwxr-xr-x. 2 root root  124 3月  22 13:49 data</span><br><span class="line">-rw-r--r--. 1 root root 193K 3月  22 13:51 windows_server_2016_x64.qcow2</span><br><span class="line"></span><br><span class="line">#/data/windows/data</span><br><span class="line">[root@cpe-172-100-70-251 data]# ll</span><br><span class="line">总用量 6801916</span><br><span class="line">-rw-r--r--. 1 qemu qemu 6302720000 3月  22 10:43 cn_windows_server_2016_vl_x64_dvd_11636695.iso</span><br><span class="line">-rw-r--r--. 1 qemu qemu  534818816 3月  22 09:18 virtio-win-0.1.229.iso</span><br><span class="line"></span><br><span class="line"># /data/windows/CloudbaseInitSetup目录存放 </span><br><span class="line">-rw-r--r--. 1 root root 40M 3月  20 2017 CloudbaseInitSetup_0_9_11_x64.msi   （本教程使用版本）</span><br><span class="line">-rw-r--r--. 1 qemu qemu 61M 3月  22 09:18 CloudbaseInitSetup_1_1_4_x64.msi   （稳定版）</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="执行创建镜像文件包："><a href="#执行创建镜像文件包：" class="headerlink" title="执行创建镜像文件包："></a>执行创建镜像文件包：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 创建镜像文件包 ：/data/windows/ 目录执行</span><br><span class="line">qemu-img create -f qcow2 windows_server_2016_x64.qcow2 50G</span><br><span class="line"># 将CloudbaseInitSetup_1_1_4_x64.msi 配置放在CloudbaseInitSetup.iso中 （执行目录：/data/windows/）</span><br><span class="line">note: 此步骤不执行通过vnc细化配置时将无法找到win2k16目录下网卡驱动</span><br><span class="line"># 基于目录CloudbaseInitSetup制作iso镜像命名为CloudbaseInitSetup.iso</span><br><span class="line">mkisofs -o CloudbaseInitSetup.iso CloudbaseInitSetup/       </span><br><span class="line"># 查看镜像文件包</span><br><span class="line">qemu-img  info  windows_server_2016_x64.qcow2</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_57235b7e44eacb3280aa8ad3117a09f1.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_57235b7e44eacb3280aa8ad3117a09f1.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6594c419f60291d68cc7c6093c655a86.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6594c419f60291d68cc7c6093c655a86.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_8dc76fd0808704d1163b1a63b168b02d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_8dc76fd0808704d1163b1a63b168b02d.png"></p><h3 id="创建镜像虚拟机"><a href="#创建镜像虚拟机" class="headerlink" title="创建镜像虚拟机"></a>创建镜像虚拟机</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"># 参数</span><br><span class="line">--name windows_server_2016_x64                     #系统命名</span><br><span class="line">--ram 4096 \                                       #内存大默认M</span><br><span class="line">--vcpu=4 \                                         #CPU核数</span><br><span class="line">--os-type=windows \                                 #系统类型</span><br><span class="line">--os-variant=win2k16 \                             #系统版本</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio \  #创建系统盘镜像   格式qcow2  总成</span><br><span class="line"> # windows ISO镜像路径 类型为CDROM sata盘</span><br><span class="line">--disk path=/data/cn_windows_server_2016_x64_dvd_9327743.iso,device=cdrom,bus=sata \   </span><br><span class="line"> # windows 驱动 ISO镜像 路径 类型</span><br><span class="line">--disk path=/data/virtio-win-0.1.190.iso,device=cdrom,bus=sata \               </span><br><span class="line">--bridge=br0,model=virtio \                        #网络桥接模式</span><br><span class="line">--graphics vnc,listen=0.0.0.0 \                    #vnc </span><br><span class="line">--noautoconsole</span><br><span class="line"># 云主机创建</span><br><span class="line"># --(需要至少60G空间)--------------------------------------------------------------------------------------------</span><br><span class="line"># 执行创建windows镜像 (windows2016)</span><br><span class="line"># workstdtion / 云主机 创建方式均可采用 （方式1）</span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2016_x64 --vcpus=2 --memory 1024 --os-type=windows --os-variant=win2k16 \</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2016_x64_dvd_9718765.iso,device=cdrom,size=5   \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=sata \</span><br><span class="line">--bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off</span><br><span class="line"></span><br><span class="line"># 云主机 创建（参考）（方式2）</span><br><span class="line">sudo virt-install --connect qemu:///system --name windows_server_2016_x64 --vcpus=2 --memory 1024 --os-type=windows --os-variant=win2k16 \</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2016_x64_dvd_9718765.iso,device=cdrom,size=5  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=sata \</span><br><span class="line">--network network=default,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole </span><br><span class="line"># -----------------------------------------------------------------------------------------------------------</span><br><span class="line"># vsphere创建</span><br><span class="line"># -----------------------------------------------------------------------------------------------------------</span><br><span class="line"># windows2016新增驱动（本教程执行命令）</span><br><span class="line">参数：bus=stat &gt;&gt; bus=ide</span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2016_x64 --vcpus=2 --memory 2048 --os-type=windows --os-variant=win2k16 \</span><br><span class="line">--disk windows_server_2016_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2016_vl_x64_dvd_11636695.iso,device=cdrom,size=5,bus=ide  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=ide \</span><br><span class="line">--disk path=./CloudbaseInitSetup.iso,device=cdrom,bus=ide \   # 新增驱动</span><br><span class="line">--bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off  </span><br><span class="line"></span><br><span class="line"># windows2012r2</span><br><span class="line">qemu-img create -f qcow2 windows_server_2012r2_x64.qcow2 30G</span><br><span class="line"></span><br><span class="line">mkisofs -o CloudbaseInitSetup.iso CloudbaseInitSetup/  </span><br><span class="line"></span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2012r2_x64 --vcpus=2 --memory 4096 --os-type=windows --os-variant=win2k12r2 \</span><br><span class="line">--disk windows_server_2012r2_x64.qcow2,bus=virtio --disk size=30 \</span><br><span class="line">--disk path=./data/cn_windows_server_2012_r2_vl_x64_dvd_2979220.iso,device=cdrom,size=5,bus=ide  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=ide \</span><br><span class="line">--disk path=./CloudbaseInitSetup.iso,device=cdrom,bus=ide --bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off  </span><br><span class="line"></span><br><span class="line"># windows2019</span><br><span class="line">virt-install --connect qemu:///system --name windows_server_2019_x64 --vcpus=2 --memory 2048 --os-type=windows --os-variant=win2k19 \</span><br><span class="line">--disk windows_server_2019_x64.qcow2,bus=virtio --disk size=50 \</span><br><span class="line">--disk path=./data/cn_windows_server_2019_x64_dvd_4de40f33.iso,device=cdrom,size=5,bus=ide  \</span><br><span class="line">--disk path=./data/virtio-win-0.1.229.iso,device=cdrom,bus=ide \</span><br><span class="line">--disk path=./CloudbaseInitSetup.iso,device=cdrom,bus=ide \</span><br><span class="line">--bridge=br0,model=virtio --graphics vnc,listen=0.0.0.0 --noautoconsole  --check all=off </span><br><span class="line"></span><br><span class="line"># -----------------------------------------------------------------------------------------------------------</span><br><span class="line"># 查看刚通过镜像启动的虚拟机虚拟机 / 查看--os-variant支持的类型</span><br><span class="line">virsh list --all       # 列出所有虚机</span><br><span class="line">osinfo-query os        # 查看支持的类型</span><br><span class="line">virsh shutdown ubuntu  # 正常关闭虚拟机</span><br><span class="line">virsh undefine name    # 删除虚机</span><br><span class="line">virsh start name       # 启动指定虚机</span><br><span class="line">virsh reboot name      # 重启指定虚机</span><br><span class="line"></span><br><span class="line">[root@localhost windows]# osinfo-query os</span><br><span class="line"> Short ID             | Name                                               | Version  | ID                              </span><br><span class="line">----------------------+----------------------------------------------------+----------+---</span><br><span class="line"> alpinelinux3.5       | Alpine Linux 3.5                                   | 3.5      |  </span><br><span class="line"> alpinelinux3.6       | Alpine Linux 3.6                                   | 3.6      | </span><br><span class="line"> alpinelinux3.7       | Alpine Linux 3.7                                   | 3.7      | </span><br><span class="line"> alpinelinux3.8       | Alpine Linux 3.8                                   | 3.8      | </span><br><span class="line"> alt.p8               | ALT p8 StarterKits                                 | p8       | </span><br><span class="line"> alt.p9               | ALT p9 StarterKits                                 | p9       |</span><br></pre></td></tr></table></figure><h5 id="参考：-1"><a href="#参考：-1" class="headerlink" title="参考："></a>参考：</h5><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_66220ca6a8e52c12bfe4526cba82dbb3.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_66220ca6a8e52c12bfe4526cba82dbb3.png"></p><h4 id="出现下方回显则说明windows镜像创建成功："><a href="#出现下方回显则说明windows镜像创建成功：" class="headerlink" title="出现下方回显则说明windows镜像创建成功："></a>出现下方回显则说明windows镜像创建成功：</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d46cb89118adb196c752bfeefb854b09.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d46cb89118adb196c752bfeefb854b09.png"></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_49e8c464d4892bd3ca53f4cc2a3e94d9.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_49e8c464d4892bd3ca53f4cc2a3e94d9.png"></p><h3 id="5-virt-install常用命令："><a href="#5-virt-install常用命令：" class="headerlink" title="5. virt-install常用命令："></a><code>5. virt-install</code>常用命令：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># virt-install常用命令</span><br><span class="line">virsh list --all       # 列出所有虚机</span><br><span class="line">virsh start name       # 启动指定虚机</span><br><span class="line">virsh reboot name      # 重启指定虚机</span><br><span class="line">virsh destroy name     # 强制关闭虚机</span><br><span class="line">virsh undefine name    # 删除虚机</span><br><span class="line"># 图形界面：</span><br><span class="line">通过执行名virt-manager，启动libvirt的图形界面，在图形界面下可以一步一步的创建虚拟机，管理虚拟机，还可以直接控制虚拟机的桌面。</span><br><span class="line"># 命令行：</span><br><span class="line">virsh list                              # 显示本地活动虚拟机</span><br><span class="line">virsh list –all                         #显示本地所有的虚拟机（活动的+不活动的）</span><br><span class="line">virsh defineubuntu.xml                  #通过配置文件定义一个虚拟机（这个虚拟机还不是活动的）</span><br><span class="line">virsh start ubuntu                      # 启动名字为ubuntu的非活动虚拟机</span><br><span class="line">virsh create ubuntu.xml                #创建虚拟机（创建后，虚拟机立即执行，成为活动主机）</span><br><span class="line">virsh suspend ubuntu                    #暂停虚拟机</span><br><span class="line">virsh resume ubuntu                     #启动暂停的虚拟机</span><br><span class="line">virsh shutdown ubuntu                   #正常关闭虚拟机</span><br><span class="line">virsh destroy ubuntu                   #强制关闭虚拟机</span><br><span class="line">virsh dominfo ubuntu                   #显示虚拟机的基本信息             </span><br><span class="line">virsh domname 2                        #显示id号为2的虚拟机名                                </span><br><span class="line">virsh domid ubuntu                     #显示虚拟机id号                               </span><br><span class="line">virsh domuuid ubuntu                    #显示虚拟机的uuid           </span><br><span class="line">virsh domstate ubuntu                   #显示虚拟机的当前状态          </span><br><span class="line">virsh dumpxml ubuntu                    #显示虚拟机的当前配置文件（可能和定义虚拟机时的配置不同，因为当虚拟机启动时，需要给# 虚拟机分配id号、uuid、vnc端口号等等）          </span><br><span class="line">virsh setmem ubuntu 512000               #给不活动虚拟机设置内存大小  </span><br><span class="line">virsh setvcpus ubuntu 4                  #给不活动虚拟机设置cpu个数          </span><br><span class="line">virsh edit ubuntu                        #编辑配置文件（一般是在刚定义完虚拟机之后） </span><br></pre></td></tr></table></figure><h4 id="配置snat使镜像可以访问internet-在宿主机执行"><a href="#配置snat使镜像可以访问internet-在宿主机执行" class="headerlink" title="配置snat使镜像可以访问internet( 在宿主机执行 )"></a>配置<code>snat</code>使镜像可以访问<code>internet</code>( 在宿主机执行 )</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 开启</span><br><span class="line">--参数：</span><br><span class="line">-s 172.100.70.241           # 镜像ip  （或 其他虚拟机）</span><br><span class="line">--to-source 172.100.70.251  # 宿主机ip（或 本虚拟机）</span><br><span class="line">sysctl net.ipv4.ip_forward=1</span><br><span class="line">sysctl -p</span><br><span class="line">iptables -t nat -A POSTROUTING -s 172.100.70.241  -j SNAT --to-source 172.100.70.251</span><br></pre></td></tr></table></figure><h2 id="二-vnc细化配置-qemu-img-见下章"><a href="#二-vnc细化配置-qemu-img-见下章" class="headerlink" title="二. vnc细化配置 qemu-img ( 见下章 )"></a>二. <code>vnc</code>细化配置 <code>qemu-img</code> ( 见下章 )</h2><h4 id="qemu-img命令参考："><a href="#qemu-img命令参考：" class="headerlink" title="qemu-img命令参考："></a><code>qemu-img</code>命令参考：</h4><p><a href="https://zhuanlan.zhihu.com/p/623104229">https://zhuanlan.zhihu.com/p/623104229</a></p><p><a href="https://support.huaweicloud.com/bestpractice-ims/ims_bp_0030.html">https://support.huaweicloud.com/bestpractice-ims/ims_bp_0030.html</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_e552b52db5a6700f7e86be4d1ee01215.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_e552b52db5a6700f7e86be4d1ee01215.png"></p><h4 id="11-配置完成后处理镜像（压缩镜像）"><a href="#11-配置完成后处理镜像（压缩镜像）" class="headerlink" title="11.配置完成后处理镜像（压缩镜像）"></a><code>11</code>.配置完成后处理镜像（压缩镜像）</h4><h3 id="参考：-2"><a href="#参考：-2" class="headerlink" title="参考："></a>参考：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 参数</span><br><span class="line">-c，表示必须压缩目标镜像（仅限qcow格式）。</span><br><span class="line">-f，第一种镜像格式。</span><br><span class="line">-o, options：选项，是以逗号分隔的格式特定选项列表，格式为name=value格式。使用“-o？”有关使用的格式支持的选项的概述，或参阅下面的格式说明了解详细信息。</span><br><span class="line">++++++++++++++++++++++++++++++++++</span><br><span class="line">#--sparse=always稀疏拷贝，忽略全0数据</span><br><span class="line">cp --sparse=always ws2012r2.qcow2 ws2012r2-new.qcow2 #--sparse=always稀疏拷贝，忽略全0数据</span><br><span class="line"># raw和qcow2需要转换，这里原本用的qcow2，所以未转换。</span><br><span class="line"># 案例：</span><br><span class="line">qemu-img convert -c -f raw -O qcow2 centos7-new.raw centos7-new.qcow2</span><br><span class="line">qemu-img convert -c -O qcow2 centos7-new.qcow2 centos7-mini.qcow2</span><br><span class="line"># 实际操作</span><br><span class="line">qemu-img convert -c -O qcow2 windows_server_2016_x64_new.qcow2 windows_server_2016_x64_min.qcow2</span><br><span class="line">++++++++++++++++++++++++++++++++++</span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_ea53daa63d24ff564cde1f936d3d4e0f.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_ea53daa63d24ff564cde1f936d3d4e0f.png"></p><h4 id="实际操作"><a href="#实际操作" class="headerlink" title="实际操作:"></a>实际操作:</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># raw和qcow2需要转换，这里原本用的qcow2，所以未转换。</span><br><span class="line"># 案例：</span><br><span class="line">qemu-img convert -c -f raw -O qcow2 centos7-new.raw centos7-new.qcow2</span><br><span class="line">qemu-img convert -c -f qcow2 -o  raw centos7-new.qcow2 centos7-mini.raw</span><br><span class="line"># 实际操作</span><br><span class="line">qemu-img convert -c -f raw -O qcow2 windows_server_2016_x64_new.raw windows_server_2016_x64_min.qcow2</span><br></pre></td></tr></table></figure><h4 id="上传到openstack—skyline"><a href="#上传到openstack—skyline" class="headerlink" title="上传到openstack—skyline:"></a>上传到<code>openstack—skyline</code>:</h4><p><strong>参数：</strong><code>--property os_distro=windows --property os_version=2012 --property os_admin_user=Administrator</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># qcm2格式</span><br><span class="line">openstack image create --disk-format qcow2 --public --property hw_qemu_guest_agent=yes --property os_distro=windows --property os_version=2012 --property os_admin_user=Administrator --file  windows_server_2016_x64.qcow2 windows_server_2016_x64.qcow2</span><br><span class="line"># raw格式</span><br><span class="line">openstack image create --disk-format raw --public --property hw_qemu_guest_agent=yes --property os_distro=windows --property os_version=2012 --property os_admin_user=Administrator --file windows_server_2019_x64.raw windows_server_2019_x64.raw </span><br></pre></td></tr></table></figure><h4 id="使用命令行创建云主机："><a href="#使用命令行创建云主机：" class="headerlink" title="使用命令行创建云主机："></a>使用命令行创建云主机：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 此命令必须要先将镜像上传到openstack</span><br><span class="line">openstack server create --config-drive true --image windows2016min.qcow2 --flavor 9 --password ******20! --network demo-net windows2016_test</span><br></pre></td></tr></table></figure><h4 id="注：-此时配置完成-集成可修改密码"><a href="#注：-此时配置完成-集成可修改密码" class="headerlink" title="注： 此时配置完成  集成可修改密码"></a>注： 此时配置完成  集成可修改密码</h4><h4 id="效果："><a href="#效果：" class="headerlink" title="效果："></a>效果：</h4><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d0e78dd049d08305a4192234429c341d.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_d0e78dd049d08305a4192234429c341d.png"></p><h4 id="扩展：-旧面板-windows-重置密码"><a href="#扩展：-旧面板-windows-重置密码" class="headerlink" title="扩展： 旧面板 windows 重置密码:"></a>扩展： 旧面板 windows 重置密码:</h4><p>更新云主机元数据，添加<code>change_passwd=True</code>, 软重启云主机。重启完之后，虚机密码为 <code>admin_pass</code> 指定的密码。密码重置后再将元数据 <code>change_passwd</code> 删掉，或者改为其他值</p><p><strong>添加后 &gt;&gt; 软重启   ||  软重启之后 &gt;&gt; 删除change_passwd=True    此时密码变为创建云主机时设置的密码即</strong><code>****023!</code>。</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_65022b246096b0295461a22397c72313.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_65022b246096b0295461a22397c72313.png"></p><p><strong>教程结束。</strong></p>]]></content>
      
      
      <categories>
          
          <category> openstack </category>
          
      </categories>
      
      
        <tags>
            
            <tag> openstack </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>赞助墙</title>
      <link href="/2024/02/01/%E8%B5%9E%E5%8A%A9%E5%A2%99/"/>
      <url>/2024/02/01/%E8%B5%9E%E5%8A%A9%E5%A2%99/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>网站建设与维护实属不易，如果我的文章帮助到了您，或者您想支持我的网站，可以扫描下方二维码进行赞助（赞助时请备注自己的 化名/昵称 ，打赏后将在此页面展示），非常感谢您的支持~ 🌹</p></blockquote><h2 id="赞助墙🌹"><a href="#赞助墙🌹" class="headerlink" title="赞助墙🌹"></a>赞助墙🌹</h2><p>打赏方式  微信  支付宝🌙 </p><div class="gallery">    <div class="fj-gallery  data" data-rowheight="220" data-limit="10">    <span class="gallery-data">[{"url":"https://wn-apple-teawine.fun/img/wechatpayqr.webp","alt":"微信"},{"url":"https://wn-apple-teawine.fun/img/alipayqr.webp","alt":"支付宝"}]</span>    </div>    <button class="gallery-load-more"><span>Load More</span><i class="fa-solid fa-arrow-down"></i></button>    </div><table><thead><tr><th>ZzNnWn.</th><th>晒在深海里.</th><th>粘人的鸭嘴兽</th></tr></thead><tbody><tr><td>￥100</td><td>￥50</td><td>￥1000</td></tr><tr><td></td><td></td><td></td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 日常 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日常 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>简历</title>
      <link href="/2024/02/01/%E7%AE%80%E5%8E%86/"/>
      <url>/2024/02/01/%E7%AE%80%E5%8E%86/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="简历"><a href="#简历" class="headerlink" title="简历"></a>简历</h2><h4 id="基本信息-教育背景-求职意向"><a href="#基本信息-教育背景-求职意向" class="headerlink" title="基本信息 教育背景 求职意向"></a><strong>基本信息</strong> <strong>教育背景</strong> <strong>求职意向</strong></h4><p>姓名：<br>邮箱：<a href="mailto:&#x38;&#55;&#x38;&#56;&#x39;&#49;&#54;&#x31;&#x31;&#x40;&#113;&#113;&#46;&#99;&#111;&#109;">&#x38;&#55;&#x38;&#56;&#x39;&#49;&#54;&#x31;&#x31;&#x40;&#113;&#113;&#46;&#99;&#111;&#109;</a><br>证书：阿里云ACP<br>期望薪资：15k<br>岗位：云计算工程师</p><h4 id="专业技能概览"><a href="#专业技能概览" class="headerlink" title="专业技能概览"></a><strong>专业技能概览</strong></h4><p>· 精通各类<strong>linux</strong>系统各项配置性能调优安全优化<strong>shell</strong>脚本操作系统包括但不限于<strong>（ubuntu centos debain 华为欧拉 阿里龙蜥</strong>等）<br>· 精通云计算<strong>iaas paas</strong>层<br>· 精通ceph分布式存储,<br>· 精通openstack集群 nova cinder neutoen glance的运维<br>· 精通grafana开源日志监控<strong>loki</strong><br>· 精通云迁移技术<strong>DTS SMC OSS迁移（阿里云）</strong><br>· 精通冷迁移技术<strong>V2V Qemu-img dd  disk2vhd</strong>等 （使用于任何适配的平台）<br>· 精通<strong>ansible</strong>自动化运维工具<br>· 精通<strong>docker docker-compose Dockerfile。</strong><br>· 精通各种开源时序数据库<strong>influxdb promethus-tsdb</strong>等<br>· 精通各种监控系统<strong>prometheus zabbix telegraf nightingale cacti smartping uptime-Kuma</strong>等<br>· 精通各种关系数据库<strong>mysql postgreSQL mariadb</strong>掌握<strong>Mysql</strong>以及<strong>mariadb</strong>数据库安全策略如（密码安全 登录安全 审计等）<br>· 精通<strong>keepalived+nginx</strong>高可用.掌握<strong>mysql</strong>主从复制 <strong>redis</strong>集群。<br>· 精通部署<strong>openstack</strong>云平台 <strong>管理OpenStack云平台，包括虚拟机实例、网络和存储资源的配置。</strong><br>· 精通<strong>Ceph分布式存储系统，负责Ceph集群的部署、监控和性能调优。</strong><br>· 精通<strong>tcp udp http https snmp ftp vrrp</strong>等各种协议<br>· 精通<strong>nginx</strong> 负载均衡，动静分离，反向代理 熟练掌握开源<strong>openvpn l2tp frp</strong>技术<br>· 精通<strong>nas</strong>存储多副本<strong>cephfs</strong>（单副本<strong>NFS iscsi</strong>） 对象存储 负载均衡 <strong>nat</strong>网关** rds** 等<br>· 精通使用<strong>kubeadm</strong>部署<strong>k8s</strong>以及实现与<strong>ceph</strong>集成（StorageClass）<br>· 熟练掌握<strong>python</strong>脚本（网络爬虫方向）。</p><h4 id="工作经验1"><a href="#工作经验1" class="headerlink" title="工作经验1"></a><strong>工作经验1</strong></h4><p>公司经营范围：主要经营物联网产品 软件开发等</p><h4 id="项目经验："><a href="#项目经验：" class="headerlink" title="项目经验："></a><strong>项目经验：</strong></h4><p>2020.11——2021.04<br>· 维护设计及部署苏州市国家电网各套系统如隧道子系统 精益化管控平台等。<br>2021.04——2021.05<br>· 部署维护优化公司边缘计算箱产品，编写<strong>dockerfile</strong>制作一键启动私有化镜像 并实地测试其功能。<br>2021.05——2021.07<br>· 设计部署公司<strong>vmware vcenter esxi</strong> 私有云平台<br>· 搭建<strong>openvpn</strong>实现企业员工在家访问公司内网<br>· 对需要暴露外网没有<strong>外网IP</strong>的<strong>web</strong>服务做内网穿透。<br>· 对<strong>vcenter</strong>其中一台虚拟机配置外网IP对外服务<br>2021.07——2022.02<br>· 日常维护<strong>mysql</strong>数据库 公司各套系统如禅道 精益化管控平台 <strong>nacos</strong>  虚拟化平台<strong>vcenter</strong>等<br>· 检查系统运行情况排错等<br>· 编写运维技术文档<br>· 利用<strong>ansible</strong>给多台服务器配置环境，编写剧本部署程序环境等。</p><h4 id="工作经验2"><a href="#工作经验2" class="headerlink" title="工作经验2"></a><strong>工作经验2</strong></h4><p><strong>公司介绍：</strong></p><p>华中地区最大的分布式云服务商 阿里云华中地区最大代理商 公司有自己的云计算平台MSC-Stack对外帮助上千家客户上云 对上千家企业提供服务 客户包括小米 华为 英伟达 斗鱼 字节跳动等<br><strong>主要产品：</strong></p><p><strong>MSC-Stack：</strong>基于openstack与ceph分布式存储开发的一套云计算平台。<br>K8s 堡垒机 主机入侵 云主机负载均衡器 nat网关等功能 目前拥有武汉 福州 北京 成都 四节点。<br>原生OpenStack部分：一套openstack n版外网环境 一套openstack zed版内网环境。</p><h4 id="项目经验"><a href="#项目经验" class="headerlink" title="项目经验"></a><strong>项目经验</strong></h4><p><strong>原生OpenStack，MCS-Stack与ceph云计算部分</strong><br>2022.05——2022.06<br>· 部署公司<strong>openstac-zed</strong>版本系统 后端存储采用<strong>ceph</strong>分布式存储 编写<strong>shell</strong>脚本部署九州云开源前端skyline（openstack-ui）<strong>阶段：<br><strong>调研:</strong>  openstack与ceph版本适配 测试搭配情况。<br><strong>制作镜像：</strong>制作</strong>openstack<strong>所需镜像 先搭建</strong>all-in-one<strong>环境</strong>openstack<strong>与</strong>ceph<strong>再制作其镜像 并推送到公司内网harbor镜像平台。<br><strong>搭建：</strong>最后搭建集群版</strong>openstack**<br>· 部署完成后 mariadb passwd等数据备份<br>· 云主机安装docker无法访问外网设置MTU解决<br>· <strong>cephadm</strong>的方式部署后端<strong>ceph</strong>集群。**<br>2023.05—2023.06<br>· 计算节点故障时恢复云主机<br>· 删除云主机卡死，卡在deleting状态<br>2022.07—2022.08<br>· 云盘手动扩容<br>· cinder 云盘无法删除<br>· windows云主机设置密码永不过期<br>· 制作openstack云上使用的镜像（linux(ubuntu16.04-22.04) centos(7.4-8.3) rocky9.2  debain11 windows server 2012r2 —2019）<br>2023.08—2023.08<br>· openstack集群缩减计算节点。</p><p><strong>云计算-云迁移部分</strong><br>2023.06-2023.07<br>· 使用<strong>v2v</strong>，将客户<strong>vmware</strong>数台虚拟机迁移到<strong>MCS-Stack</strong>云平台包括<strong>Linux</strong>与<strong>windows</strong>。<br>· 使用<strong>disk2vhd</strong>技术将客户<strong>OpenStack</strong>云平台<strong>windows server</strong>迁移到<strong>MCS-Stack</strong>云平台。<br>2023.09-2023.09<br>· 阿里云龙蜥镜像ECS，使用<strong>qemu-img</strong>冷迁移技术迁移到<strong>MCS-Stack</strong>云平台 并修改脚本适配<strong>could-init</strong><br>· 客户华为云八台centos7.9，云资源迁移到<strong>MCS-Stack</strong>云平台 使用<strong>qemu-img</strong>冷迁移技术 并安装cloud-init等适配<strong>MCS-Stack</strong>云平台<br>2023.10-2023.11<br>· 将某客户国科云多台centos及rds,ubuntu阿里云<strong>DTS SMC 热</strong>迁移等方式 迁移到阿里云。<br>· 使用共享镜像方式将某客户<strong>A</strong>账号ECS资源迁移到<strong>B</strong>账户及将客户oss迁移到B账号</p><p><strong>客户服务下方为部分例子(2022.04——至今)</strong><br>· 解决rds产品<strong>sql-mode</strong>报错，部署<strong>mysql</strong>主从，部署<strong>redis</strong>集群<br>· 部署<strong>nginx+keepalived</strong>高可用实现一个外网IP两服务器公用 以及一个内网VIP两服务器公用<br>· 客户在mcs-stack上云主机<strong>遭遇xmrig挖矿病毒 pnscan病毒</strong>攻击解决。<br>· 云主机使用lvm卷使数据盘扩容到系统盘后进入<strong>grub rescue</strong>救援模式解决等。<br>· 解决客户使用docker构建nacos遇到的一系列问题包括数据持久化 使用外部数据库等。</p><p><strong>脚本部分</strong><br>· 编写shell脚本监控后端<strong>ceph</strong>集群健康状况（openstack 集成了prometheus实时监控ceph集群状况）。        （告警推送到钉钉），编写清空zabbix表shell脚本。<br>· 编写<strong>zabbix</strong>告警脚本  （企业微信告警），编写lvm自动扩容脚本（人机交互）。<br>· 编写编译安装nginx keepalivedmysql redis，<br>· 监控vcenter exsi python脚本 告警推送到钉钉<br>· 编写部署openstack初始化脚本 以及<strong>all-in-one</strong>环境一键部署openstack脚本<br>· 编写一键清理ceph集群以及一键安装ceph集群脚本，二次开发kalla-ansible集成公司前端面板。<br>· 编写监控oracle python脚本 对某大神的项目二次开发 增加python脚本oracle监控项目<br>· 编写冷迁移v2v半自动迁移脚本，<br>· 编写适用于centos ubuntu 的服务器初始化脚本包括自己设置时区 源 limit docker pip等<br>· 编写mysql pg数据库自动备份脚本，编写ansible剧本实现skyline与openstack集成</p><p><strong>监控部分</strong><br>2022.04-2022.05<br>· 按客户需求设计部署监控某医院七台服务器<strong>telegraf+prometheus+grafana</strong>的方式监控<strong>linux各项指标</strong><br>· <strong>搭建采用telegraf+prometheus架构</strong>监控交换机等数通设备 （后期性能不足替换为zabbix）。<br>· 搭建zabbix监控公司<strong>上百台交换机</strong>实现交换机各种监控不限于（进出口流量 cpu 内存 温度等）搭配脚本实现告警推送到企业微信。<br>2022.07-2022.08<br>· 搭建<strong>telegraf+influxdb+grafana</strong>监控<strong>某客户代运维vcenter</strong>项目 实现对整个集群的监控 包括每一台虚拟机 每一台exsi宿主机 完全满足业务需求 <strong>该vmware项目包含500多台虚拟机</strong>十个<strong>esxi</strong>节点。<br>· 构建<strong>telegraf+influxdb+python</strong>脚本+<strong>grafana</strong>监控<strong>某客户代运维vcenter</strong>项目中五台<strong>oracle</strong>数据库（此项目为对某大神项目二次开发  修改<strong>python</strong>脚本制作<strong>telegraf-py</strong>版镜像实现对<strong>oracle</strong>完全监控）。<br>2023.07-2023.07<br>· 编译<strong>nginx-module-vts</strong>模块进<strong>nginx</strong>使用<strong>prometheus+grafana</strong>实现对<strong>nginx</strong>的监控，部署<strong>uptime-Kuma</strong>监控公司各套系统<br>· 部署<strong>grafana</strong>开源<strong>loki</strong>监控公司各台物理服务器系统日志。</p><p><strong>代运维客户及公司内部系统部署及维护部分（2023.07-至今）</strong><br>· 使用<strong>vercel函数计算</strong>搭建公司<strong>chagpt问答系统实现</strong>跨境访问<strong>openai chatgpt</strong>服务。<br>· 部署<strong>k8s与ceph</strong>集成（<strong>storeglass</strong>）。<br>· 部署<strong>wiki</strong>公司内部知识库系统<br>· 部署<strong>cacti</strong>监控交换机平台<br>· <strong>smartping</strong> 监控网络状况系统并制作<strong>smartping docker</strong>镜像实现快捷部署。<br>· 部署<strong>webstack</strong>网站导航系统。<br>· <strong>ferry万能</strong>工单系统。<br>· <strong>cloudreve</strong>公司云盘系统。<br>· 调研<strong>kanboard</strong>与<strong>禅道</strong>项目管理系统 <strong>因kanboard功能多样但前端简陋</strong>最终选型使用<strong>禅道系统</strong>。<br>· 部署公司<strong>esxi集群使用vcenter</strong>管理平台控制。<br>· 培训公司各种运维人员，研发部署云箱维护<br>· 集群<strong>cronsun</strong>定时任务管理系统，<strong>bitwarden</strong>密码管理平台。<br>· 帮助某云平台客户将<strong>nacos</strong>制作成为镜像实现<strong>docker</strong>一键快捷部署实现数据持久化<br>· 日常维护openstack集群  维护后端存储ceph集群<br>例： 云主机 无法删除 前端卡死 ，10 pgs not deep-scrubbed in time，ceph集群容量告警 osd换盘更换<br>· 公司云平台上千家客户云资源的日常运维服务制作云上环境使用的各种<strong>windows</strong>系统<strong>linux</strong>系统的镜像<br>· 搭建某客户nginx+keepalived高可用 实现主挂<strong>外网IP</strong>及<strong>内网VIP</strong>自动切换到备服务器（该项目只有一个外网IP）<br>· 搭建某客户<strong>mysql</strong>主从复制项目后期替换为<strong>MariaDB Galera****Cluster</strong>实现主备自动切换。</p><h4 id="其他-自有项目"><a href="#其他-自有项目" class="headerlink" title="其他/自有项目"></a>其他/自有项目</h4><p>· 两站点个人博客系统 （编写技术博客180余篇 加上onenote累计三十万字）<br>· <strong>Discuss Twikoo</strong>评论系统<br><strong>OneManager</strong> 网盘管理系统（所有网盘通过此<strong>web</strong>管理<strong>onedrive</strong> 阿里云盘等实现不限格式任意可共享）<br>· <strong>Blazeb2</strong>图床管理系统兼容<strong>s3</strong>协议。<br>· 搭建NextChat访问openai  ChatGpt服务<br>NOTE：上述各种系统均采用<strong>cloudns</strong>提供域名 <strong>cloudfare</strong>提供域名解析及<strong>CDN</strong>缓存等 除博客外其余系统均使用<strong>vercel</strong>函数计算（faas）部署。</p><h4 id="自我评价-兴趣爱好"><a href="#自我评价-兴趣爱好" class="headerlink" title="自我评价/兴趣爱好"></a>自我评价/兴趣爱好</h4><p>自我评价<br>· 强执行力（执行的意愿+执行的能力）<br>· 强学习力（对新技术的渴望+刻苦的钻研精神）<br>· 较强的团队合作意识、乐于并善于分享。<br>兴趣爱好<br>· 篮球 足球 羽毛球 散步 登山 等各种运动及对技术有浓厚的兴趣爱好瞎折腾 。<br>· 热爱中国古诗词文化 及明代历史。</p>]]></content>
      
      
      <categories>
          
          <category> 日常 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日常 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用vercel构建chatgpt-nex-web实现国内访问</title>
      <link href="/2024/01/31/%E4%BD%BF%E7%94%A8vercel%E6%9E%84%E5%BB%BAchatgpt-nex-web%E5%AE%9E%E7%8E%B0%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/"/>
      <url>/2024/01/31/%E4%BD%BF%E7%94%A8vercel%E6%9E%84%E5%BB%BAchatgpt-nex-web%E5%AE%9E%E7%8E%B0%E5%9B%BD%E5%86%85%E8%AE%BF%E9%97%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="使用vercel构建chatgpt-nex-web实现国内访问"><a href="#使用vercel构建chatgpt-nex-web实现国内访问" class="headerlink" title="使用vercel构建chatgpt-nex-web实现国内访问"></a>使用vercel构建chatgpt-nex-web实现国内访问</h2><p>概览：</p><ul><li>需要在某宝购买openai-key</li><li>可购买直连key或中转key 如果购买的为中转key则需要填写中转服务地址</li><li><a href="https://github.com/ChatGPTNextWeb/ChatGPT-Next-Web">chatgpt-nex-web项目地址</a> 先fork到自己仓库</li><li><a href="https://vercel.com/new/clone?repository-url=https://github.com/Yidadaa/ChatGPT-Next-Web&env=OPENAI_API_KEY&env=CODE&env=GOOGLE_API_KEY&project-name=chatgpt-next-web&repository-name=ChatGPT-Next-Web">vercel部署地址</a></li></ul><h4 id="一-构建"><a href="#一-构建" class="headerlink" title="一. 构建"></a>一. 构建</h4><p>添加如下环境变量即可</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CODE: passwd</span><br><span class="line">BASE<span class="emphasis">_URL: https://chatapi<span class="strong">***</span></span></span><br><span class="line"><span class="strong"><span class="emphasis">OPENAI_API_KEY: sk-wD6Ha8FsvZfbpH7AD53**</span><span class="strong">****</span><span class="strong">****</span>*</span></span><br></pre></td></tr></table></figure><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c4148f2652bb4fe1369077b9bafea30c.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_c4148f2652bb4fe1369077b9bafea30c.png"></p><p>此时构建完成。</p><h4 id="二-使用"><a href="#二-使用" class="headerlink" title="二. 使用"></a>二. 使用</h4><ul><li><p>若key额度不够则需要充值, 其他key使用此平台访问chatgpt需要如下操作</p></li><li><p>直连key直接填写后即可使用 自定义接口处 接口地址保留默认“/api/openai”</p></li><li><p>中转key则自定义接口处 接口地址需要填写中转服务地址</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6f3a9535578411a50e84c4b23940099b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/2/image_6f3a9535578411a50e84c4b23940099b.png"></p></li></ul><p>建议使用cloudfare给vercel绑定域名访问。</p>]]></content>
      
      
      <categories>
          
          <category> AI </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>公有云私有云对象桶信息配置</title>
      <link href="/2024/01/29/%E5%85%AC%E6%9C%89%E4%BA%91%E7%A7%81%E6%9C%89%E4%BA%91%E5%AF%B9%E8%B1%A1%E6%A1%B6%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE/"/>
      <url>/2024/01/29/%E5%85%AC%E6%9C%89%E4%BA%91%E7%A7%81%E6%9C%89%E4%BA%91%E5%AF%B9%E8%B1%A1%E6%A1%B6%E4%BF%A1%E6%81%AF%E9%85%8D%E7%BD%AE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="公有云私有云对象桶信息配置"><a href="#公有云私有云对象桶信息配置" class="headerlink" title="公有云私有云对象桶信息配置"></a>公有云私有云对象桶信息配置</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>公有云与私有云配置对象桶信息是有差异的</p><h3 id="一-公有云-阿里云为例"><a href="#一-公有云-阿里云为例" class="headerlink" title="一. 公有云-阿里云为例"></a>一. 公有云-阿里云为例</h3><p>使用软件<strong>s3cmd</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装s3cmd</span></span><br><span class="line">yum install -y epel-release &amp;&amp; yum install -y s3cmd</span><br><span class="line"><span class="comment"># 安装qemu</span></span><br><span class="line">yum install qemu-kvm libvirt virt-install bridge-utils  -y</span><br></pre></td></tr></table></figure><p>其他安装方式（ubuntu）</p><p><a href="https://developer.aliyun.com/article/356106">https://developer.aliyun.com/article/356106</a><br><a href="https://www.s3express.com/download.htm">https://www.s3express.com/download.htm</a>    （s3软件下载链接）</p><p>简介：<br><a href="https://wangyan.org/blog/s3cmd-how-to-use.html">https://wangyan.org/blog/s3cmd-how-to-use.html</a></p><p>s3cmd 安装使用指南<br>s3cmd 是一款 Amazon S3 命令行工具。它不仅能上传、下载、同步，还能设置权限，下面是完整的安装使用指南。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">一、安装方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法一：（Debian/Ubuntu ）</span></span><br><span class="line"><span class="string">wget</span> <span class="string">-O-</span> <span class="string">-q</span> <span class="string">http://s3tools.org/repo/deb-all/stable/s3tools.key</span> <span class="string">|</span> <span class="string">sudo</span> <span class="string">apt-key</span> <span class="string">add</span> <span class="bullet">-</span></span><br><span class="line"><span class="string">wget</span> <span class="string">-O/etc/apt/sources.list.d/s3tools.list</span> <span class="string">http://s3tools.org/repo/deb-all/stable/s3tools.list</span></span><br><span class="line"><span class="string">apt-get</span> <span class="string">update</span> <span class="string">&amp;&amp;</span> <span class="string">sudo</span> <span class="string">apt-get</span> <span class="string">install</span> <span class="string">s3cmd</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 方法二：</span></span><br><span class="line"><span class="string">wget</span> <span class="string">http://nchc.dl.sourceforge.net/project/s3tools/s3cmd/1.0.0/s3cmd-1.0.0.tar.gz</span></span><br><span class="line"><span class="string">tar</span> <span class="string">-zxf</span> <span class="string">s3cmd-1.0.0.tar.gz</span> <span class="string">-C</span> <span class="string">/usr/local/</span></span><br><span class="line"><span class="string">mv</span> <span class="string">/usr/local/s3cmd-1.0.0/</span> <span class="string">/usr/local/s3cmd/</span></span><br><span class="line"><span class="string">ln</span> <span class="string">-s</span> <span class="string">/usr/local/s3cmd/s3cmd</span> <span class="string">/usr/bin/s3cmd</span></span><br></pre></td></tr></table></figure><p>阿里云配置如下</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_896f06a76b5634cec9f24ce6f7ec5119.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_896f06a76b5634cec9f24ce6f7ec5119.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">初始化s3cmd</span></span><br><span class="line">s3cmd --configure</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">执行</span></span><br><span class="line">[root@3z6to251zh02kg system]# s3cmd --configure</span><br><span class="line"></span><br><span class="line">Enter new values or accept defaults in brackets with Enter.</span><br><span class="line">Refer to user manual for detailed description of all options.</span><br><span class="line"></span><br><span class="line">Access key and Secret key are your identifiers for Amazon S3. Leave them empty for using the env variables.</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Access Key: LTAI5t9</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Secret Key: XD0f6iyM0nY8oUJZz</span></span><br><span class="line">Default Region [US]:  # hangzhou</span><br><span class="line"></span><br><span class="line">Use &quot;s3.amazonaws.com&quot; for S3 Endpoint and not modify it to the target Amazon S3.</span><br><span class="line">S3 Endpoint [s3.amazonaws.com]: # oss-cn-hangzhou.aliyuncs.com （buckets域名在阿里云oss概览中查看）</span><br><span class="line"></span><br><span class="line">Use &quot;%(bucket)s.s3.amazonaws.com&quot; to the target Amazon S3. &quot;%(bucket)s&quot; and &quot;%(location)s&quot; vars can be used</span><br><span class="line">if the target S3 system supports dns based buckets.</span><br><span class="line">DNS-style bucket+hostname:port template for accessing a bucket [%(bucket)s.s3.amazonaws.com]: # %(bucket)s.oss-cn-hangzhou.aliyuncs.com</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">%(bucket)s.oss-cn-hangzhou.aliyuncs.com</span></span><br><span class="line">Encryption password is used to protect your files from reading</span><br><span class="line">by unauthorized persons while in transfer to S3</span><br><span class="line">Encryption password: </span><br><span class="line">Path to GPG program [/bin/gpg]: </span><br><span class="line"></span><br><span class="line">When using secure HTTPS protocol all communication with Amazon S3</span><br><span class="line">servers is protected from 3rd party eavesdropping. This method is</span><br><span class="line">slower than plain HTTP, and can only be proxied with Python 2.7 or newer</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Use HTTPS protocol [Yes]: Yes</span></span><br><span class="line"></span><br><span class="line">On some networks all internet access must go through a HTTP proxy.</span><br><span class="line">Try setting it here if you can&#x27;t connect to S3 directly</span><br><span class="line">HTTP Proxy server name: </span><br><span class="line"></span><br><span class="line">New settings:</span><br><span class="line">  Access Key: LTAI5t9EwR</span><br><span class="line">  Secret Key: XD0f6iyM0nJZz1</span><br><span class="line">  Default Region: hangzhou</span><br><span class="line">  S3 Endpoint: oss-cn-hangzhou.aliyuncs.com</span><br><span class="line">  DNS-style bucket+hostname:port template for accessing a bucket: %(bucket)s.oss-cn-hangzhou.aliyuncs.com</span><br><span class="line">  Encryption password: </span><br><span class="line">  Path to GPG program: /bin/gpg</span><br><span class="line">  Use HTTPS protocol: True</span><br><span class="line">  HTTP Proxy server name: </span><br><span class="line">  HTTP Proxy server port: 0</span><br><span class="line"></span><br><span class="line">Test access with supplied credentials? [Y/n] y</span><br><span class="line">Please wait, attempting to list all buckets...</span><br><span class="line">Success. Your access key and secret key worked fine :-)</span><br><span class="line"></span><br><span class="line">Now verifying that encryption works...</span><br><span class="line">Not configured. Never mind.</span><br><span class="line"></span><br><span class="line">Save settings? [y/N] y</span><br><span class="line">Configuration saved to &#x27;/root/.s3cfg&#x27;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">此时设置完成</span></span><br></pre></td></tr></table></figure><p>客户端连接软件配置</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_69abbafcc46e7ce35928521f13a67e58.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_69abbafcc46e7ce35928521f13a67e58.png"></p><p>此时即可访问阿里云对象存储。</p><h3 id="二-私有云-某云配置"><a href="#二-私有云-某云配置" class="headerlink" title="二. 私有云 某云配置"></a>二. 私有云 某云配置</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 创建buckets报错：原因版本不一致 需要将v2启用</span></span><br><span class="line">解决：</span><br><span class="line">vim /root/.s3cfg</span><br><span class="line">signature<span class="emphasis">_v2 = True </span></span><br><span class="line"><span class="emphasis"># 或新建文件输入：</span></span><br><span class="line"><span class="emphasis">vim ~/.s3cfg</span></span><br><span class="line"><span class="emphasis">[default]</span></span><br><span class="line"><span class="emphasis">access_</span>key = 914c4</span><br><span class="line">secret<span class="emphasis">_key = qk45WMQg5VP4MBeAYE</span></span><br><span class="line"><span class="emphasis">host_</span>base = http://111.111.87.99:7480</span><br><span class="line">host<span class="emphasis">_bucket = http://111.111.87.99:7480/914c48814</span></span><br><span class="line"><span class="emphasis">use_</span>https = False</span><br><span class="line">signature<span class="emphasis">_v2 = True </span></span><br></pre></td></tr></table></figure><h3 id="三-扩展s3cmd命令使用"><a href="#三-扩展s3cmd命令使用" class="headerlink" title="三. 扩展s3cmd命令使用"></a>三. 扩展<code>s3cmd</code>命令使用</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 命令使用</span></span><br><span class="line"><span class="section">#创建bucket名称为s3://cem-demo</span></span><br><span class="line">s3cmd -h                                            # 查看命令详情</span><br><span class="line">s3cmd put /etc/fstab  s3://s3cmd-demo/fstab-demo    # 上传文件将/etc目录下文件fstab上传</span><br><span class="line">s3cmd ls s3://ceph-s3-bucket                        # 查看bucket里面有什么查看具体内容后面接目录</span><br><span class="line">s3cmd put /etc s3://ceph-s3-bucket/fstab-demo/etc/ --recursive # 上传目录（递归的方式记得&quot;/&quot;）</span><br><span class="line">s3cmd get s3://ceph-s3-bucket/s3browser-6-4-1.rar              # 下载命令</span><br><span class="line"></span><br><span class="line">s3cmd rm s3://ceph-s3-bucket/fstab-demo                        # 删除文件命令</span><br><span class="line">s3cmd rm s3://ceph-s3-bucket/fstab-demo/ --recursive           # 删除目录命令</span><br><span class="line">s3cmd mb s3://cmd-demo                                         # 创建目录</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos设置登陆密码验证错误自动锁定</title>
      <link href="/2024/01/28/centos%E8%AE%BE%E7%BD%AE%E7%99%BB%E9%99%86%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E9%94%99%E8%AF%AF%E8%87%AA%E5%8A%A8%E9%94%81%E5%AE%9A/"/>
      <url>/2024/01/28/centos%E8%AE%BE%E7%BD%AE%E7%99%BB%E9%99%86%E5%AF%86%E7%A0%81%E9%AA%8C%E8%AF%81%E9%94%99%E8%AF%AF%E8%87%AA%E5%8A%A8%E9%94%81%E5%AE%9A/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>centos设置登陆密码验证错误自动锁定</strong></p><p>参考：</p><p><a href="https://blog.csdn.net/weixin_43822878/article/details/93018223">Linux限制远程登录尝试密码次数及锁定时间_linux ssh连接5次封ip1小时-CSDN博客</a></p><p>CentOS中有一个pam_tally2.so的PAM模块，来限定用户的登录失败次数，如果次数达到设置的阈值，则锁定用户。</p><h3 id="一-system-auth设置登陆错误锁定（本教程使用此优化配置）"><a href="#一-system-auth设置登陆错误锁定（本教程使用此优化配置）" class="headerlink" title="一. system-auth设置登陆错误锁定（本教程使用此优化配置）"></a>一. system-auth设置登陆错误锁定（本教程使用此优化配置）</h3><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_7a31d3176074dee91ac4da1d3a07e168.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_7a31d3176074dee91ac4da1d3a07e168.png"></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/pam.d/system-auth</span><br><span class="line"><span class="comment"># 配置如下</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line"><span class="comment"># This file is auto-generated.</span></span><br><span class="line"><span class="comment"># User changes will be destroyed the next time authconfig is run.</span></span><br><span class="line">auth       required       pam_tally2.so    deny=3    unlock_time=10 even_deny_root root_unlock_time=10</span><br><span class="line">auth        required      pam_env.so</span><br><span class="line">auth        required      pam_faildelay.so delay=2000000</span><br><span class="line">auth        sufficient    pam_unix.so nullok try_first_pass</span><br><span class="line">auth        requisite     pam_succeed_if.so uid &gt;= 1000 quiet_success</span><br><span class="line">auth        required      pam_deny.so</span><br><span class="line"></span><br><span class="line">account     required      pam_unix.so</span><br><span class="line">account     sufficient    pam_localuser.so</span><br><span class="line">account     sufficient    pam_succeed_if.so uid &lt; 1000 quiet</span><br><span class="line">account     required      pam_permit.so</span><br><span class="line"></span><br><span class="line">password    requisite     pam_pwquality.so try_first_pass local_users_only retry=3 authtok_type=</span><br><span class="line">password    sufficient    pam_unix.so sha512 shadow nullok try_first_pass use_authtok</span><br><span class="line">password    required      pam_deny.so</span><br><span class="line"></span><br><span class="line">session     optional      pam_keyinit.so revoke</span><br><span class="line">session     required      pam_limits.so</span><br><span class="line">-session     optional      pam_systemd.so</span><br><span class="line">session     [success=1 default=ignore] pam_succeed_if.so service <span class="keyword">in</span> crond quiet use_uid</span><br><span class="line">session     required      pam_unix.so</span><br></pre></td></tr></table></figure><p>参数解释：</p><p>添加参数介绍：设置密码尝试错误三次，普通用户和root用户都进行锁定，普通用户锁定10秒，root用户锁定10秒</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">auth       required       pam_tally2.so    deny=3    unlock_time=10 even_deny_root root_unlock_time=10</span><br></pre></td></tr></table></figure><h3 id="二-下方为其他配置项内容"><a href="#二-下方为其他配置项内容" class="headerlink" title="二. 下方为其他配置项内容"></a>二. 下方为其他配置项内容</h3><h4 id="1、编译PAM的配置文件"><a href="#1、编译PAM的配置文件" class="headerlink" title="1、编译PAM的配置文件"></a>1、编译PAM的配置文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># vim /etc/pam.d/login</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line">auth    required    pam_tally2.so    deny=3    unlock_time=100 even_deny_root root_unlock_time=200</span><br><span class="line">auth [user_unknown=ignore success=ok ignore=ignore default=bad] pam_securetty.so</span><br><span class="line">auth       substack     system-auth</span><br><span class="line">auth       include      postlogin</span><br><span class="line">account    required     pam_nologin.so</span><br><span class="line">account    include      system-auth</span><br><span class="line">password   include      system-auth</span><br><span class="line"><span class="comment"># pam_selinux.so close should be the first session rule</span></span><br><span class="line">session    required     pam_selinux.so close</span><br><span class="line">session    required     pam_loginuid.so</span><br><span class="line">session    optional     pam_console.so</span><br><span class="line"><span class="comment"># pam_selinux.so open should only be followed by sessions to be executed in the user context</span></span><br><span class="line">session    required     pam_selinux.so open</span><br><span class="line">session    required     pam_namespace.so</span><br><span class="line">session    optional     pam_keyinit.so force revoke</span><br><span class="line">session    include      system-auth</span><br><span class="line">session    include      postlogin</span><br><span class="line">-session   optional     pam_ck_connector.so</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>各参数介绍：</p><blockquote><p>even_deny_root     也限制root用户；<br>deny                      设置普通用户和root用户连续错误登陆的最大次数，超过最大次数，则锁定该用户<br>unlock_time          设定普通用户锁定后，多少时间后解锁，单位是秒；<br>root_unlock_time  设定root用户锁定后，多少时间后解锁，单位是秒；<br>此处使用的是 pam_tally2 模块，如果不支持 pam_tally2 可以使用 pam_tally 模块。另外，不同的pam版本，设置可能有所不同，具体使用方法，可以参照相关模块的使用规则。</p></blockquote><p>在#%PAM-1.0的下面，即第二行，添加内容，一定要写在前面，如果写在后面，虽然用户被锁定，但是只要用户输入正确的密码，还是可以登录的！</p><p>添加参数介绍：设置密码尝试错误三次，普通用户和root用户都进行锁定，普通用户锁定100秒，root用户锁定200秒</p><p><strong>/etc/pam.d/login</strong> —最终配置图：</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_b79029648b226f7ff2cca46a85548223.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_b79029648b226f7ff2cca46a85548223.png"></p><h4 id="2、这个只是限制了用户从tty登录，而没有限制远程登录，如果想限制远程登录，需要改sshd文件"><a href="#2、这个只是限制了用户从tty登录，而没有限制远程登录，如果想限制远程登录，需要改sshd文件" class="headerlink" title="2、这个只是限制了用户从tty登录，而没有限制远程登录，如果想限制远程登录，需要改sshd文件"></a>2、这个只是限制了用户从tty登录，而没有限制远程登录，如果想限制远程登录，需要改sshd文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># vim /etc/pam.d/sshd</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line">auth    required    pam_tally2.so    deny=3    unlock_time=100 even_deny_root root_unlock_time=200</span><br><span class="line">auth       required     pam_sepermit.so</span><br><span class="line">auth       substack     password-auth</span><br><span class="line">auth       include      postlogin</span><br><span class="line"><span class="comment"># Used with polkit to reauthorize users in remote sessions</span></span><br><span class="line">-auth      optional     pam_reauthorize.so prepare</span><br><span class="line">account    required     pam_nologin.so</span><br><span class="line">account    include      password-auth</span><br><span class="line">password   include      password-auth</span><br><span class="line"><span class="comment"># pam_selinux.so close should be the first session rule</span></span><br><span class="line">session    required     pam_selinux.so close</span><br><span class="line">session    required     pam_loginuid.so</span><br><span class="line"><span class="comment"># pam_selinux.so open should only be followed by sessions to be executed in the user context</span></span><br><span class="line">session    required     pam_selinux.so open env_params</span><br><span class="line">session    required     pam_namespace.so</span><br><span class="line">session    optional     pam_keyinit.so force revoke</span><br><span class="line">session    include      password-auth</span><br><span class="line">session    include      postlogin</span><br><span class="line"><span class="comment"># Used with polkit to reauthorize users in remote sessions</span></span><br><span class="line">-session   optional     pam_reauthorize.so prepare</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>同样是增加在第2行！</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5dbaaaaf8233e87db4cc63de60cab88b.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5dbaaaaf8233e87db4cc63de60cab88b.png"></p><p>查看用户登录失败的次数:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># pam_tally2 --user</span></span><br><span class="line">Login           Failures Latest failure     From</span><br><span class="line">aihuidi             6    06/20/19 10:11:07  192.168.200.186    在186这个ip上有个普通用户aihuidi登录失败</span><br></pre></td></tr></table></figure><p>解锁指定用户:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@node2 ~ ]<span class="comment"># pam_tally2 -r -u aihuidi    解锁aihuidi用户</span></span><br><span class="line">Login           Failures Latest failure     From</span><br><span class="line">aihuidi             6    06/20/19 10:11:07  192.168.200.186</span><br><span class="line">[root@node2 ~ ]<span class="comment"># pam_tally2 --user     在进行查看用户登录失败次数</span></span><br><span class="line">[root@node2 ~ ]<span class="comment"># </span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ps：这个远程ssh的时候，输入密码错误超过三次但是没有提示，我用的是Xshell，不知道其它终端有没有提示，但是只要超过设定的值，输入正确的密码也是登陆不了的！，还是要等到设定的时间在重新尝试输入正确密码进行登录认证</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo小猫咪与漫画导航</title>
      <link href="/2024/01/26/hexo%E5%B0%8F%E7%8C%AB%E5%92%AA%E4%B8%8E%E6%BC%AB%E7%94%BB%E5%AF%BC%E8%88%AA/"/>
      <url>/2024/01/26/hexo%E5%B0%8F%E7%8C%AB%E5%92%AA%E4%B8%8E%E6%BC%AB%E7%94%BB%E5%AF%BC%E8%88%AA/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h4 id="hexo小猫咪与漫画导航"><a href="#hexo小猫咪与漫画导航" class="headerlink" title="hexo小猫咪与漫画导航"></a>hexo小猫咪与漫画导航</h4><p>详见：<a href="https://tzy1997.com/articles/hexo1613/">请收下这只可爱的猫咪吧</a><br>详见：<a href="https://www.fomal.cc/posts/5389e93f.html">漫画导航</a></p><h3 id="一-小猫咪"><a href="#一-小猫咪" class="headerlink" title="一. 小猫咪"></a>一. 小猫咪</h3><p>制作一个盛放内容的盒子，在<code>[BlogRoot]/node_modules/hexo-theme-butterfly/layout/includes/head.pug</code>(如果是<code>git clone</code> 安装在<code>[BlogRoot]/themes/butterfly/layout/includes/head.pug</code>)最后一行加入如下代码：</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">#myscoll</span></span><br></pre></td></tr></table></figure><p>其实随便放在哪里都行，只要能加载出来就行</p><p>在<code>[BlogRoot]/node_modules/hexo-theme-butterfly/source/js</code>文件夹下新建一个<code>cat.js</code>，将以下代码复制到文件中。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span> &gt; <span class="number">992</span>) &#123;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getBasicInfo</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">/* 窗口高度 */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">ViewH</span> = $(<span class="variable language_">window</span>).<span class="title function_">height</span>();</span><br><span class="line">        <span class="comment">/* document高度 */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">DocH</span> = $(<span class="string">&quot;body&quot;</span>)[<span class="number">0</span>].<span class="property">scrollHeight</span>;</span><br><span class="line">        <span class="comment">/* 滚动的高度 */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">ScrollTop</span> = $(<span class="variable language_">window</span>).<span class="title function_">scrollTop</span>();</span><br><span class="line">        <span class="comment">/* 可滚动的高度 */</span></span><br><span class="line">        <span class="keyword">var</span> <span class="variable constant_">S_V</span> = <span class="title class_">DocH</span> - <span class="title class_">ViewH</span>;</span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">Band</span>_H = <span class="title class_">ScrollTop</span> / (<span class="title class_">DocH</span> - <span class="title class_">ViewH</span>) * <span class="number">100</span>;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="title class_">ViewH</span>: <span class="title class_">ViewH</span>,</span><br><span class="line">            <span class="title class_">DocH</span>: <span class="title class_">DocH</span>,</span><br><span class="line">            <span class="title class_">ScrollTop</span>: <span class="title class_">ScrollTop</span>,</span><br><span class="line">            <span class="title class_">Band</span><span class="attr">_H</span>: <span class="title class_">Band</span>_H,</span><br><span class="line">            <span class="attr">S_V</span>: <span class="variable constant_">S_V</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">show</span>(<span class="params">basicInfo</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (basicInfo.<span class="property">ScrollTop</span> &gt; <span class="number">0.001</span>) &#123;</span><br><span class="line">            $(<span class="string">&quot;.neko&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;display&#x27;</span>, <span class="string">&#x27;block&#x27;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $(<span class="string">&quot;.neko&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;display&#x27;</span>, <span class="string">&#x27;none&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    (<span class="keyword">function</span> (<span class="params">$</span>) &#123;</span><br><span class="line">        $.fn.<span class="property">nekoScroll</span> = <span class="keyword">function</span> (<span class="params">option</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> defaultSetting = &#123;</span><br><span class="line">                <span class="attr">top</span>: <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">                <span class="attr">scroWidth</span>: <span class="number">6</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                <span class="attr">z_index</span>: <span class="number">9999</span>,</span><br><span class="line">                <span class="attr">zoom</span>: <span class="number">0.9</span>,</span><br><span class="line">                <span class="attr">borderRadius</span>: <span class="number">5</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                <span class="attr">right</span>: <span class="number">60</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                <span class="comment">// 这里可以换为你喜欢的图片，例如我就换为了雪人，但是要抠图</span></span><br><span class="line">                <span class="attr">nekoImg</span>: <span class="string">&quot;https://bu.dusays.com/2022/07/20/62d812db74be9.png&quot;</span>,</span><br><span class="line">                <span class="attr">hoverMsg</span>: <span class="string">&quot;喵喵喵~&quot;</span>,</span><br><span class="line">                <span class="attr">color</span>: <span class="string">&quot;#6f42c1&quot;</span>,</span><br><span class="line">                <span class="attr">during</span>: <span class="number">500</span>,</span><br><span class="line">                <span class="attr">blog_body</span>: <span class="string">&quot;body&quot;</span>,</span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">var</span> setting = $.<span class="title function_">extend</span>(defaultSetting, option);</span><br><span class="line">            <span class="keyword">var</span> getThis = <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;className&quot;</span>) !== <span class="string">&quot;&quot;</span> ? <span class="string">&quot;.&quot;</span> + <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;className&quot;</span>) : <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;id&quot;</span>) !== <span class="string">&quot;&quot;</span> ? <span class="string">&quot;#&quot;</span> +</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;id&quot;</span>) : <span class="variable language_">this</span>.<span class="title function_">prop</span>(<span class="string">&quot;nodeName&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> ($(<span class="string">&quot;.neko&quot;</span>).<span class="property">length</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">after</span>(<span class="string">&quot;&lt;div class=\&quot;neko\&quot; id=&quot;</span> + setting.<span class="property">nekoname</span> + <span class="string">&quot; data-msg=\&quot;&quot;</span> + setting.<span class="property">hoverMsg</span> + <span class="string">&quot;\&quot;&gt;&lt;/div&gt;&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">let</span> basicInfo = <span class="title function_">getBasicInfo</span>();</span><br><span class="line">            $(getThis)</span><br><span class="line">                .<span class="title function_">css</span>(&#123;</span><br><span class="line">                    <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;width&#x27;</span>: setting.<span class="property">scroWidth</span>,</span><br><span class="line">                    <span class="string">&#x27;top&#x27;</span>: setting.<span class="property">top</span>,</span><br><span class="line">                    <span class="string">&#x27;height&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span>,</span><br><span class="line">                    <span class="string">&#x27;background-color&#x27;</span>: setting.<span class="property">bgcolor</span>,</span><br><span class="line">                    <span class="string">&quot;border-radius&quot;</span>: setting.<span class="property">borderRadius</span>,</span><br><span class="line">                    <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                    <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">scImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;-webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.1) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0.1) 75%, transparent 75%, transparent)&#x27;</span>, <span class="string">&#x27;border-radius&#x27;</span>: <span class="string">&#x27;2em&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;background-size&#x27;</span>: <span class="string">&#x27;contain&#x27;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                .<span class="title function_">css</span>(&#123;</span><br><span class="line">                    <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;top&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> - <span class="number">50</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span> * <span class="number">10</span>,</span><br><span class="line">                    <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                    <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">nekoImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="title function_">show</span>(<span class="title function_">getBasicInfo</span>());</span><br><span class="line">            $(<span class="variable language_">window</span>)</span><br><span class="line">                .<span class="title function_">scroll</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    <span class="keyword">let</span> basicInfo = <span class="title function_">getBasicInfo</span>();</span><br><span class="line">                    <span class="title function_">show</span>(basicInfo);</span><br><span class="line">                    $(getThis)</span><br><span class="line">                        .<span class="title function_">css</span>(&#123;</span><br><span class="line">                            <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;width&#x27;</span>: setting.<span class="property">scroWidth</span>,</span><br><span class="line">                            <span class="string">&#x27;top&#x27;</span>: setting.<span class="property">top</span>,</span><br><span class="line">                            <span class="string">&#x27;height&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span>,</span><br><span class="line">                            <span class="string">&#x27;background-color&#x27;</span>: setting.<span class="property">bgcolor</span>,</span><br><span class="line">                            <span class="string">&quot;border-radius&quot;</span>: setting.<span class="property">borderRadius</span>,</span><br><span class="line">                            <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                            <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">scImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;-webkit-linear-gradient(45deg, rgba(255, 255, 255, 0.1) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0.1) 75%, transparent 75%, transparent)&#x27;</span>, <span class="string">&#x27;border-radius&#x27;</span>: <span class="string">&#x27;2em&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;background-size&#x27;</span>: <span class="string">&#x27;contain&#x27;</span></span><br><span class="line">                        &#125;);</span><br><span class="line">                    $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                        .<span class="title function_">css</span>(&#123;</span><br><span class="line">                            <span class="string">&#x27;position&#x27;</span>: <span class="string">&#x27;fixed&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;top&#x27;</span>: basicInfo.<span class="property">Band_H</span> * setting.<span class="property">zoom</span> * basicInfo.<span class="property">ViewH</span> * <span class="number">0.01</span> - <span class="number">50</span> + <span class="string">&#x27;px&#x27;</span>,</span><br><span class="line">                            <span class="string">&#x27;z-index&#x27;</span>: setting.<span class="property">z_index</span> * <span class="number">10</span>,</span><br><span class="line">                            <span class="string">&#x27;right&#x27;</span>: setting.<span class="property">right</span>,</span><br><span class="line">                            <span class="string">&#x27;background-image&#x27;</span>: <span class="string">&#x27;url(&#x27;</span> + setting.<span class="property">nekoImg</span> + <span class="string">&#x27;)&#x27;</span>,</span><br><span class="line">                        &#125;);</span><br><span class="line">                    <span class="keyword">if</span> (basicInfo.<span class="property">ScrollTop</span> == basicInfo.<span class="property">S_V</span>) &#123;</span><br><span class="line">                        $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                            .<span class="title function_">addClass</span>(<span class="string">&quot;showMsg&quot;</span>)</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                            .<span class="title function_">removeClass</span>(<span class="string">&quot;showMsg&quot;</span>);</span><br><span class="line">                        $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                            .<span class="title function_">attr</span>(<span class="string">&quot;data-msg&quot;</span>, setting.<span class="property">hoverMsg</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">                btf.<span class="title function_">scrollToDest</span>(<span class="number">0</span>, <span class="number">500</span>)</span><br><span class="line">            &#125;);</span><br><span class="line">            $(<span class="string">&quot;#&quot;</span> + setting.<span class="property">nekoname</span>)</span><br><span class="line">                .<span class="title function_">click</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                    btf.<span class="title function_">scrollToDest</span>(<span class="number">0</span>, <span class="number">500</span>)</span><br><span class="line">                &#125;);</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">this</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)(jQuery);</span><br><span class="line"></span><br><span class="line">    $(<span class="variable language_">document</span>).<span class="title function_">ready</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">//部分自定义</span></span><br><span class="line">        $(<span class="string">&quot;#myscoll&quot;</span>).<span class="title function_">nekoScroll</span>(&#123;</span><br><span class="line">            <span class="attr">bgcolor</span>: <span class="string">&#x27;rgb(0 0 0 / .5)&#x27;</span>, <span class="comment">//背景颜色，没有绳子背景图片时有效</span></span><br><span class="line">            <span class="attr">borderRadius</span>: <span class="string">&#x27;2em&#x27;</span>,</span><br><span class="line">            <span class="attr">zoom</span>: <span class="number">0.9</span></span><br><span class="line">        &#125;</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">//自定义（去掉以下注释，并注释掉其他的查看效果）</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        $(&quot;#myscoll&quot;).nekoScroll(&#123;</span></span><br><span class="line"><span class="comment">            nekoname:&#x27;neko1&#x27;, //nekoname，相当于id</span></span><br><span class="line"><span class="comment">            nekoImg:&#x27;img/猫咪.png&#x27;, //neko的背景图片</span></span><br><span class="line"><span class="comment">            scImg:&quot;img/绳1.png&quot;, //绳子的背景图片</span></span><br><span class="line"><span class="comment">            bgcolor:&#x27;#1e90ff&#x27;, //背景颜色，没有绳子背景图片时有效</span></span><br><span class="line"><span class="comment">            zoom:0.9, //绳子长度的缩放值</span></span><br><span class="line"><span class="comment">            hoverMsg:&#x27;你好~喵&#x27;, //鼠标浮动到neko上方的对话框信息</span></span><br><span class="line"><span class="comment">            right:&#x27;100px&#x27;, //距离页面右边的距离</span></span><br><span class="line"><span class="comment">            fontFamily:&#x27;楷体&#x27;, //对话框字体</span></span><br><span class="line"><span class="comment">            fontSize:&#x27;14px&#x27;, //对话框字体的大小</span></span><br><span class="line"><span class="comment">            color:&#x27;#1e90ff&#x27;, //对话框字体颜色</span></span><br><span class="line"><span class="comment">            scroWidth:&#x27;8px&#x27;, //绳子的宽度</span></span><br><span class="line"><span class="comment">            z_index:100, //不用解释了吧</span></span><br><span class="line"><span class="comment">            during:1200, //从顶部到底部滑动的时长</span></span><br><span class="line"><span class="comment">        &#125;);</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在<code>[BlogRoot]/node_modules/hexo-theme-butterfly/source/css</code>文件夹下新建一个<code>cat.css</code>，将以下代码复制到文件中。当然你也可以选择不新建 css 文件，复制代码到<code>custom.css</code>也行，总之有地方引入就行。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="selector-tag">body</span>::-webkit-scrollbar &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&quot;https://bu.dusays.com/2022/07/20/62d812db74be9.png&quot;</span>);</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">background-size</span>: contain;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">50%</span>);</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">font-family</span>: tzy;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#6f42c1</span>;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&quot;https://bu.dusays.com/2022/07/20/62d812d95e6f5.png&quot;</span>);</span><br><span class="line">    <span class="attribute">background-size</span>: contain;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">9999</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">115%</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-class">.showMsg</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="built_in">attr</span>(data-msg);</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-pseudo">:hover</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="built_in">attr</span>(data-msg);</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.neko</span><span class="selector-class">.fontColor</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @description: 滚动条样式  跟猫二选一</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>:<span class="number">992px</span>) &#123;</span><br><span class="line">    ::-webkit-scrollbar &#123;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">8px</span> <span class="meta">!important</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">8px</span> <span class="meta">!important</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-track &#123;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">2em</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-thumb &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">255</span> <span class="number">255</span> <span class="number">255</span> / .<span class="number">3</span>);</span><br><span class="line">        <span class="attribute">background-image</span>: <span class="built_in">-webkit-linear-gradient</span>(<span class="number">45deg</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>) <span class="number">25%</span>, transparent <span class="number">25%</span>, transparent <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>) <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.1</span>) <span class="number">75%</span>, transparent <span class="number">75%</span>, transparent);</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">2em</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ::-webkit-scrollbar-corner &#123;</span><br><span class="line">        <span class="attribute">background-color</span>: transparent</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在主题配置文件<code>_config.butterfly.yml</code>中引入<code>cat.js</code>和<code>cat.css</code>，当然还有在bottom的最前面引入<code>jQuery</code>，因为<code>cat.js</code>的语法依赖<code>jQuery</code>。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;/css/cat.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">src=&quot;https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">data-pjax</span> <span class="string">src=&quot;/js/cat.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>最后重新编译运行即可看见效果。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo cl; hexo s</span><br></pre></td></tr></table></figure><h3 id="二-漫画导航"><a href="#二-漫画导航" class="headerlink" title="二. 漫画导航"></a>二. 漫画导航</h3><p>选择喜欢的图标 添加到项目 在<a href="https://www.iconfont.cn/">阿里云图标库</a></p><p>在<code>[BlogRoot]\themes\butterfly\source\css\custom.css</code>中填写如下内容，引入Unicode和Font-class的线上资源：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">@import</span> <span class="string">&quot;//at.alicdn.com/t/c/font_4426032_sy4sytzuoj9.css&quot;</span><span class="string">;</span></span><br></pre></td></tr></table></figure><p>更推荐在在主题配置文件<code>inject</code>配置项进行全局引入：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;//at.alicdn.com/t/c/font_4426032_sy4sytzuoj9.css&quot;</span> <span class="string">media=&quot;defer&quot;</span> <span class="string">onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span> </span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;//at.alicdn.com/t/c/font_4426032_sy4sytzuoj9.js&quot;&gt;&lt;/script&gt;</span> </span><br></pre></td></tr></table></figure><p>同时可以在自定义<code>CSS</code>中添加如下样式来控制图标默认大小和颜色等属性（<strong>若已经在项目设置中勾选了彩色选项，则无需再定义图标颜色</strong>），写法与字体样式类似，这恐怕也是它被称为<code>iconfont</code>（图标字体）的原因:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">.iconfont</span> &#123;</span><br><span class="line">  <span class="attr">font-family:</span> <span class="string">&quot;iconfont&quot;</span> <span class="type">!important;</span></span><br><span class="line">  <span class="string">/*</span> <span class="string">这里可以自定义图标大小</span> <span class="string">*/</span></span><br><span class="line">  <span class="attr">font-size:</span> <span class="string">3em;</span></span><br><span class="line">  <span class="attr">font-style:</span> <span class="string">normal;</span></span><br><span class="line">  <span class="string">-webkit-font-smoothing:</span> <span class="string">antialiased;</span></span><br><span class="line">  <span class="string">-moz-osx-font-smoothing:</span> <span class="string">grayscale;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>最后定义导航栏</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">主页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-shouye</span>              <span class="comment">#fas fa-home</span></span><br><span class="line">  <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-fenlei</span> <span class="comment">#fa fa-archive</span></span><br><span class="line">  <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-biaoqian</span>     <span class="comment">#fa fa-tags</span></span><br><span class="line">  <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-guidang</span>  <span class="comment">#fa fa-folder-open</span></span><br><span class="line">  <span class="string">友链:</span> <span class="string">/link/</span>    <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-kafei</span>  <span class="comment"># fa fa-link</span></span><br><span class="line">  <span class="string">留言板:</span> <span class="string">https://gegewu-cloud.github.io/2023/05/23/留言板/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-lishiliuyan</span> <span class="comment">#fa fa-paper-plane</span></span><br><span class="line">  <span class="string">关于:</span> <span class="string">https://gegewu-cloud.github.io/2023/05/22/关于/</span> <span class="string">||</span> <span class="string">iconfont</span> <span class="string">icon-xing</span> <span class="comment">#fas fa-heart </span></span><br></pre></td></tr></table></figure><p>效果</p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_4b90daa3afa9713b09d6c5b78cbb6671.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_4b90daa3afa9713b09d6c5b78cbb6671.png"></p>]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>清理systemd日志之journalctl</title>
      <link href="/2024/01/25/%E6%B8%85%E7%90%86systemd%E6%97%A5%E5%BF%97%E4%B9%8Bjournalctl/"/>
      <url>/2024/01/25/%E6%B8%85%E7%90%86systemd%E6%97%A5%E5%BF%97%E4%B9%8Bjournalctl/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="清理systemd日志之journalctl"><a href="#清理systemd日志之journalctl" class="headerlink" title="清理systemd日志之journalctl"></a>清理systemd日志之journalctl</h2><p>参考文献</p><p><a href="https://itlanyan.com/clear-systemd-journal-logs/">https://itlanyan.com/clear-systemd-journal-logs/</a></p><p><strong>systemd journal</strong>之于<code>systemd</code>犹如<strong>syslog</strong>之于<code>init</code>，其日志文件保存在 <strong>/var/log/journal</strong> 目录下。随着时间的流逝，该目录下会积累大量日志文件，占用不少的磁盘空间。如果硬盘容量较小或可用空间紧张，可以考虑清理过期日志释放占用的空间。</p><p>本文介绍清理<a href="https://itlanyan.com/tag/systemd/">systemd</a>日志的方法。</p><h3 id="清理systemd日志"><a href="#清理systemd日志" class="headerlink" title="清理systemd日志"></a>清理systemd日志</h3><p><a href="https://itlanyan.com/clear-systemd-journal-logs/#bnp_indexs">返回目录</a></p><p>清理之前，可查看一下systemd日志所占用的磁盘空间。既可以用常用的 <code>&lt;span class=&quot;pln&quot;&gt;du&lt;/span&gt;</code> 命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo du -sh /var/log/journal/</span><br><span class="line"># 示例输出</span><br><span class="line"># 3.9G /var/log/journal/</span><br></pre></td></tr></table></figure><p>但更推荐使用systemd日志管理专用命令 <code>&lt;span class=&quot;pln&quot;&gt;journalctl&lt;/span&gt;</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">journalctl --disk-usage</span><br><span class="line"># 示例输出</span><br><span class="line"># Archived and active journals take up 3.9G on disk.</span><br></pre></td></tr></table></figure><p>知道了日志占用的磁盘空间，接下来便可以清理过期日志。开始之前，建议 <code>&lt;span class=&quot;pln&quot;&gt;rotate&lt;/span&gt;</code> 当前日志(rotate是日志操作中的一个术语，其归档旧日志，后续日志写入新创建的日志文件中)：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo journalctl --rotate</span><br></pre></td></tr></table></figure><p><code>&lt;span class=&quot;pln&quot;&gt;journalctl&lt;/span&gt;</code>提供了三种清理systemd日志的方式。第一种是清理指定时间之前的日志：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 清理7天之前的日志</span><br><span class="line">sudo journalctl --vacuum-time=7d</span><br><span class="line"># 清理2小时之前的日志</span><br><span class="line">sudo journactl --vacuum-time=2h</span><br><span class="line"># 清理10秒之前的日志</span><br><span class="line">sudo journalctl --vacuum-time=10s</span><br><span class="line"># 上述命令示例输出：</span><br><span class="line"># Vacuuming done, freed 3.7G of archived journals on disk.</span><br></pre></td></tr></table></figure><p>第二种是限制日志占用的空间大小：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 限制systemd日志占用不超过1G空间</span><br><span class="line">sudo journalctl --vacuum-size=1G</span><br><span class="line"># 限制systemd日志占用不超过100M</span><br><span class="line">sudo journalctl --vacuum-size=100M</span><br><span class="line"># 输出与第一种类似</span><br></pre></td></tr></table></figure><p>第三种是保留日志文件个数：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 保留最近的5个日志文件</span><br><span class="line">sudo journalctl --vacuum-files=5</span><br><span class="line"># 输出与第一种类似</span><br></pre></td></tr></table></figure><p>不知道 <code>journalctl</code> 管理日志功能之前，本人用过 <code>find 配合 </code><span class="kwd">exec</span><code> (或者管道加</code><span class="pln">xargs</span>`)的土办法清理过期日志：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 删除7天前的日志</span><br><span class="line">find /var/log/journal -mtime +7 -exec rm -rf &#123;&#125; \;</span><br></pre></td></tr></table></figure><h3 id="一劳永逸的办法"><a href="#一劳永逸的办法" class="headerlink" title="一劳永逸的办法"></a>一劳永逸的办法</h3><p><a href="https://itlanyan.com/clear-systemd-journal-logs/#bnp_indexs">返回目录</a></p><p>上文介绍的清理systemd日志方法适合一次性手动管理，重复做就没意思了。一劳永逸的办法是配置systemd journal，让其自动管理日志，不占用过多磁盘空间。</p><p>方法是编辑 <strong>/etc/systemd/journald.conf</strong> 文件，对其中的参数进行设置。例如限制日志最大占用1G空间：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[Journal]</span><br><span class="line">#Storage=auto</span><br><span class="line">#Compress=yes</span><br><span class="line">#Seal=yes</span><br><span class="line">#SplitMode=uid</span><br><span class="line">#SyncIntervalSec=5m</span><br><span class="line">#RateLimitInterval=30s</span><br><span class="line">#RateLimitBurst=1000</span><br><span class="line">SystemMaxUse=1G</span><br><span class="line">#SystemKeepFree=</span><br><span class="line">#SystemMaxFileSize=</span><br><span class="line">#RuntimeMaxUse=</span><br><span class="line">#RuntimeKeepFree=</span><br><span class="line">#RuntimeMaxFileSize=</span><br></pre></td></tr></table></figure><p>保存配置文件后记得重新加载：<code>sudo systemctl restart systemd-journald</code></p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://itlanyan.com/clear-systemd-journal-logs/#bnp_indexs">返回目录</a></p><ol><li><a href="https://linuxhandbook.com/clear-systemd-journal-logs/">How to Clear Systemd Journal Logs</a></li><li><a href="https://itlanyan.com/find-files-in-linux/">Linux文件查找</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>docker方式部署qexo</title>
      <link href="/2024/01/24/docker%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2qexo/"/>
      <url>/2024/01/24/docker%E6%96%B9%E5%BC%8F%E9%83%A8%E7%BD%B2qexo/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="docker方式部署qexo😘"><a href="#docker方式部署qexo😘" class="headerlink" title="docker方式部署qexo😘"></a>docker方式部署qexo😘</h2><h4 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h4><p><a href="https://github.com/Qexo/Qexo.git">https://github.com/Qexo/Qexo.git</a>                   (源码文件)<br><a href="https://www.yyds.space/posts/3dfeb390abb4">https://www.yyds.space/posts/3dfeb390abb4</a></p><h4 id="概览："><a href="#概览：" class="headerlink" title="概览："></a>概览：</h4><ul><li><p>使用Dockerfile文件构建镜像</p></li><li><p>启动容器</p></li><li><p>推送到阿里云镜像栈</p></li><li><p>创建所需目录及文件</p></li><li><p>如不想了解镜像制作过程可直接使用此docker-compose.yml文件启动qexo服务<br>镜像可选“<strong>registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.0.2</strong>”<br>docker-compose.yml文件(需要修改<strong>config.py</strong>文件将自己的机器<strong>IP</strong>或<strong>域名</strong>加入  |  关于<strong>db.sqlite3</strong>只需要在当前目录创建一个名为<strong>db.sqlite3</strong>的空文件即可😎 )</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">&#x27;3&#x27;</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line">  <span class="attr">qexo:</span></span><br><span class="line">    <span class="attr">image:</span> <span class="string">registry.cn-hangzhou.aliyuncs.com/zznn/mycentos:qexo-3.0.2</span> </span><br><span class="line">    <span class="attr">container_name:</span> <span class="string">qexo</span></span><br><span class="line">    <span class="attr">ports:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">&quot;8000:8000&quot;</span></span><br><span class="line">    <span class="attr">volumes:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./db.sqlite3:/app/db/db.sqlite3</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./blog:/app/data</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">./configs.py:/app/configs.py</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="1-创建配置文件目录及空数据库文件"><a href="#1-创建配置文件目录及空数据库文件" class="headerlink" title="1. 创建配置文件目录及空数据库文件"></a>1. 创建配置文件目录及空数据库文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建配置文件目录及空数据库文件</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /app/db /app/data</span><br><span class="line"><span class="built_in">touch</span>    /app/db/db.sqlite3</span><br><span class="line"><span class="comment"># 创建Dockerfile工作目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /data/qexo</span><br><span class="line"><span class="built_in">mkdir</span> -p /data/qexo/db</span><br><span class="line"><span class="built_in">cd</span> /data/qexo/db &amp;&amp; <span class="built_in">touch</span> db.sqlite3</span><br><span class="line"><span class="comment"># 将Qexo源码文件上传至工作目录 并打包为tar.gz格式文件</span></span><br><span class="line"><span class="built_in">cd</span> /data/qexo &amp;&amp; rz</span><br><span class="line"><span class="comment"># 配置编排文件</span></span><br><span class="line">vim Dockerfile</span><br></pre></td></tr></table></figure><p><strong>2. Dockerfile文件</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">FROM python:3.11.3-alpine</span><br><span class="line"><span class="comment"># 维护者信息</span></span><br><span class="line">LABEL maintainer=<span class="string">&quot;xwgegewu@gmail.com&quot;</span></span><br><span class="line"><span class="comment"># 设置生产模式环境变量 </span></span><br><span class="line"><span class="comment"># ENV APP_ENV production</span></span><br><span class="line"><span class="comment"># pipy源设置</span></span><br><span class="line">RUN pip config <span class="built_in">set</span> global.index-url https://mirrors.cloud.tencent.com/pypi/simple/</span><br><span class="line"><span class="comment"># 设置时区</span></span><br><span class="line">RUN sed -i <span class="string">&#x27;s/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g&#x27;</span> /etc/apk/repositories &amp;&amp; \</span><br><span class="line">    apk --no-cache add tzdata &amp;&amp; \</span><br><span class="line">    <span class="built_in">cp</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime &amp;&amp; \</span><br><span class="line">    apk --no-cache del tzdata &amp;&amp; \</span><br><span class="line">    apk --no-cache add git &amp;&amp; \</span><br><span class="line">    <span class="built_in">mkdir</span> /app</span><br><span class="line"><span class="comment"># 设置工作目录</span></span><br><span class="line">WORKDIR /app</span><br><span class="line"><span class="comment"># 拷贝数据</span></span><br><span class="line"><span class="comment"># RUN git clone https://github.com/Qexo/Qexo.git /app</span></span><br><span class="line">ADD ./Qexo.tar.gz /app/</span><br><span class="line">RUN <span class="built_in">mv</span> /app/Qexo/* /app/</span><br><span class="line"><span class="comment"># 安装依赖</span></span><br><span class="line">RUN pip install --upgrade pip </span><br><span class="line">RUN apk --no-cache add build-base python3-dev libffi-dev</span><br><span class="line">RUN pip install Django==3.2.18</span><br><span class="line">RUN pip install PyMySQL==1.0.2</span><br><span class="line">RUN pip install boto3==1.26.94</span><br><span class="line">RUN pip install requests==2.28.2</span><br><span class="line">RUN pip install PyGithub==1.58.1</span><br><span class="line">RUN pip install python-gitlab==3.13.0</span><br><span class="line">RUN pip install html2text==2020.1.16</span><br><span class="line">RUN pip install PyYAML</span><br><span class="line">RUN pip install urllib3==1.26.15</span><br><span class="line">RUN pip install Markdown==3.4.1</span><br><span class="line">RUN pip install djongo==1.3.6</span><br><span class="line">RUN pip install django-cors-headers==3.14.0</span><br><span class="line">RUN pip install pymongo==3.13.0</span><br><span class="line">RUN pip install dnspython==2.2.1</span><br><span class="line">RUN pip install sqlparse==0.2.4</span><br><span class="line">RUN pip install psycopg2-binary==2.9.5</span><br><span class="line">RUN pip install cryptography==39.0.2</span><br><span class="line">RUN pip install pyopenssl==23.0.0</span><br><span class="line">RUN pip install oss2==2.17.0</span><br><span class="line">RUN pip install beautifulsoup4==4.11.2</span><br><span class="line"><span class="comment"># 拷贝启动脚本</span></span><br><span class="line">COPY . /app/</span><br><span class="line">RUN <span class="built_in">chmod</span> +x /app/run.sh</span><br><span class="line"><span class="comment"># 暴露端口</span></span><br><span class="line">EXPOSE 8000</span><br><span class="line"><span class="comment"># 挂载目录</span></span><br><span class="line">VOLUME [<span class="string">&quot;/app/db&quot;</span>, <span class="string">&quot;/app/data&quot;</span>]</span><br><span class="line"><span class="comment"># 启动django</span></span><br><span class="line">ENTRYPOINT [<span class="string">&quot;/bin/sh&quot;</span>, <span class="string">&quot;/app/run.sh&quot;</span>]</span><br></pre></td></tr></table></figure><h4 id="3-在-data-qexo创建配置文件"><a href="#3-在-data-qexo创建配置文件" class="headerlink" title="3. 在/data/qexo创建配置文件"></a>3. 在/data/qexo创建配置文件</h4><h5 id="configs-py"><a href="#configs-py" class="headerlink" title="configs.py"></a>configs.py</h5><p><strong>DOMAINS</strong>处需要加上自己的本机<strong>IP</strong>或者<strong>域名</strong> 相当于设置白名单</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cd /data/qexo &amp;&amp; vim configs.py</span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据库配置</span></span><br><span class="line"><span class="keyword">import</span> pymysql,os</span><br><span class="line"></span><br><span class="line">DOMAINS = [<span class="string">&quot;127.0.0.1&quot;</span>,<span class="string">&quot;10.0.0.10&quot;</span>]</span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.sqlite3&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: os.path.join(<span class="string">&#x27;/app/db&#x27;</span> , <span class="string">&#x27;db.sqlite3&#x27;</span>),</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="run-sh"><a href="#run-sh" class="headerlink" title="run.sh"></a>run.sh</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line">python3 manage.py makemigrations</span><br><span class="line">python3 manage.py migrate</span><br><span class="line">python3 manage.py runserver 0.0.0.0:8000 --noreload</span><br></pre></td></tr></table></figure><h5 id="构建docker镜像-启动容器"><a href="#构建docker镜像-启动容器" class="headerlink" title="构建docker镜像 启动容器"></a>构建docker镜像 启动容器</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 构建</span></span><br><span class="line">docker build -t qexo:3.0.2 .</span><br><span class="line"><span class="comment"># 启动容器</span></span><br><span class="line">docker run -d --name qexo -p 8000:8000 -v /data/qexo/db:/app/db -v /data/blog:/app/data qexo:3.0.2</span><br></pre></td></tr></table></figure><h5 id="查看docker日志是否成功运行"><a href="#查看docker日志是否成功运行" class="headerlink" title="查看docker日志是否成功运行"></a>查看docker日志是否成功运行</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">docker logs qexo</span><br><span class="line"></span><br><span class="line">获取本地配置文件成功, 使用本地数据库配置</span><br><span class="line">           _               _ </span><br><span class="line">     /\   | |             | |</span><br><span class="line">    /  \  | |__  _   _  __| |_   _ </span><br><span class="line">   / /\ \ | |_ \| | | |/ _| | | | |</span><br><span class="line">  / ____ \| |_) | |_| | (_| | |_| |</span><br><span class="line"> /_/    \_\____/ \____|\____|\____|</span><br><span class="line">当前环境: 本地</span><br><span class="line">Operations to perform:</span><br><span class="line">  Apply all migrations: auth, contenttypes, hexoweb, sessions</span><br><span class="line">Running migrations:</span><br><span class="line">  No migrations to apply.</span><br><span class="line">[25/Jan/2024 07:11:16] ERROR: Provider获取失败, 跳过(functions.py.&lt;module&gt;[line:55])</span><br><span class="line">[25/Jan/2024 07:11:40] <span class="string">&quot;GET / HTTP/1.1&quot;</span> 302 0</span><br><span class="line">[25/Jan/2024 07:11:40] INFO: 未检测到初始化配置, 转跳到初始化页面(views.py.login_view[line:40])</span><br><span class="line">[25/Jan/2024 07:11:40] <span class="string">&quot;GET /login/?next=/ HTTP/1.1&quot;</span> 302 0</span><br><span class="line">[25/Jan/2024 07:11:40] INFO: 保存设置CDN_PREV =&gt; https://unpkg.com/(functions.py.save_setting[line:259])</span><br><span class="line">[25/Jan/2024 07:11:40] INFO: 保存设置QEXO_NAME =&gt; Hexo管理面板(functions.py.save_setting[line:259])</span><br></pre></td></tr></table></figure><p>浏览器访问: http://本机IP:8000 完成各项初始化等配置。</p><h4 id="4-最后推送到阿里云镜像栈-略-并使用阿里云镜像构建容器"><a href="#4-最后推送到阿里云镜像栈-略-并使用阿里云镜像构建容器" class="headerlink" title="4. 最后推送到阿里云镜像栈(略)并使用阿里云镜像构建容器"></a>4. 最后推送到阿里云镜像栈(略)并使用阿里云镜像构建容器</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker login ....</span><br><span class="line">docker tag .....</span><br><span class="line">docker push .....</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> qexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> qexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos7重置密码</title>
      <link href="/2024/01/24/centos7%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/"/>
      <url>/2024/01/24/centos7%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>centos7重置密码</strong></p><h4 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h4><p><a href="https://blog.csdn.net/gnail_oug/article/details/94721777">https://blog.csdn.net/gnail_oug/article/details/94721777</a></p><h4 id="环境："><a href="#环境：" class="headerlink" title="环境："></a>环境：</h4><p>centos7.6 / 7.9 重置密码</p><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>当<strong>root</strong>密码忘了之后，可以通过重启系统，在开机时重新设置密码。注：测试版本为**CentOS Linux release 7.6.1810 (Core)**，其他版本可能有些区别。</p><h4 id="重置密码"><a href="#重置密码" class="headerlink" title="重置密码"></a>重置密码</h4><h5 id="1、重启系统，在开机过程中，出现以下界面时按e键，进入编辑界面"><a href="#1、重启系统，在开机过程中，出现以下界面时按e键，进入编辑界面" class="headerlink" title="1、重启系统，在开机过程中，出现以下界面时按e键，进入编辑界面"></a>1、重启系统，在开机过程中，出现以下界面时按e键，进入编辑界面</h5><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_56eb784c63c8b82f62e62f1b5752d680.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_56eb784c63c8b82f62e62f1b5752d680.png"></p><h5 id="2、修改配置修改密码"><a href="#2、修改配置修改密码" class="headerlink" title="2、修改配置修改密码"></a>2、修改配置修改密码</h5><ul><li>按方向键下键↓，找到设置语言的地方，如<strong>LANG=en_US.UTF-8</strong> 在后面追加<strong>rw single init=/bin/bash,<strong>然后按</strong>ctrl+x</strong>重启系统</li><li>进入<strong>bash</strong>界面后，可以输入<strong>passwd</strong>命令重新设置<strong>root</strong>密码</li><li>如果开启了<strong>SELinux</strong>，执行命令<strong>touch /.autorelabel</strong>命令</li><li>输入<strong>exec /sbin/init</strong>命令重启系统 使用新设置的密码进入系统之后，为了安全起见，可以输入<strong>reboot</strong>重新启动一次系统。</li></ul><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5f98f5afcf72816ec0aeff6ad4f81deb.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_5f98f5afcf72816ec0aeff6ad4f81deb.png"></p><p>此时成功！</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux带宽网卡流量监控工具nethogs使用</title>
      <link href="/2024/01/22/linux%E5%B8%A6%E5%AE%BD%E7%BD%91%E5%8D%A1%E6%B5%81%E9%87%8F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7nethogs%E4%BD%BF%E7%94%A8/"/>
      <url>/2024/01/22/linux%E5%B8%A6%E5%AE%BD%E7%BD%91%E5%8D%A1%E6%B5%81%E9%87%8F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7nethogs%E4%BD%BF%E7%94%A8/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>linux带宽网卡流量监控工具nethogs使用</strong></p><p>前言：</p><p>此前在另外一篇博客里面介绍了另一测速工具<a href="https://gegewu-cloud.github.io/2023/07/14/speedtest-%E6%B5%8B%E8%AF%95%E7%BD%91%E7%BB%9C%E5%B8%A6%E5%AE%BD/?highlight=speed">speedtest</a>不少小伙伴反馈说测速不准确 本次介绍另一工具<a href="%5BLinux%E5%B7%A5%E5%85%B7%E4%B9%8Bnethogs%E5%91%BD%E4%BB%A4-CSDN%E5%8D%9A%E5%AE%A2%5D(https://blog.csdn.net/carefree2005/article/details/124199604)">nethogs</a>  各种网络流量监控工具 &gt; <a href="https://gegewu-cloud.github.io/2023/11/23/linux%E6%8E%92%E6%9F%A5%E7%BD%91%E7%BB%9C%E9%97%AE%E9%A2%98%E5%B8%B8%E7%94%A8CMD%E6%80%BB%E7%BB%93/">传送</a></p><h3 id="一-安装"><a href="#一-安装" class="headerlink" title="一. 安装"></a>一. 安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install - y nethogs</span><br></pre></td></tr></table></figure><h3 id="二-使用"><a href="#二-使用" class="headerlink" title="二. 使用"></a>二. 使用</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看帮助</span></span><br><span class="line">nethogs -h</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看版本</span></span><br><span class="line">nethogs -v</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">nethogs命令默认监控所有物理网卡，可以后面接口网卡名称方式指定监控某网卡流量，可以接多个网卡名称，网卡之间空格隔开</span></span><br><span class="line">nethogs eth0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">监控时刷新频率3秒总计2次</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">默认刷新频率间隔1秒，刷新次数不限制直到主动结束进程或者退出。</span></span><br><span class="line">nethogs -d 3 -c 2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">按照MB流量格式显示模式显示</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">指定网卡流量显示单位，默认KB，(0 = KB/s, 1 = total KB, 2 = total B, 3 = total MB)</span></span><br><span class="line">nethogs -v 3</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">监控所有网卡流量</span></span><br><span class="line">nethogs -a</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-t表示启用追踪模式，可以记录每一次的值，也可以结合其他参数一起使用。</span></span><br><span class="line">nethogs -t -d 10 -c 5</span><br></pre></td></tr></table></figure><h3 id="三-使用语法及参数说明"><a href="#三-使用语法及参数说明" class="headerlink" title="三. 使用语法及参数说明"></a>三. 使用语法及参数说明</h3><p>使用语法<br>用法：nethogs [参数] [device]</p><p>参数    参数说明<br>-V    打印命令版本<br>-h    打印帮助<br>-b    bughunt模式<br>-d    指定显示刷新频率，单位秒，默认1秒<br>-v    指定流量单位模式(0 = KB/s, 1 = total KB, 2 = total B, 3 = total MB)<br>-c    设置刷新更新次数<br>-t    tracemode模式，可以记录下每一次刷新的流量值<br>-p    混杂模式下监听流量（不建议使用）<br>-s    按照发送流量排序输出<br>-a    监控所有网卡端口，包括环回接口<br>运行模式下按键说明<br>按键    按键说明<br>q    退出<br>s    按照发送流量排序<br>r    按照接受流量排序<br>m    切换端口流量单位显示模式在B,KB,MB之间流量切换</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>物理服务器结构图</title>
      <link href="/2024/01/17/%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%93%E6%9E%84%E5%9B%BE/"/>
      <url>/2024/01/17/%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%93%E6%9E%84%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>物理服务器结构图</strong></p><p><strong>概览🍉 ：</strong></p><p>外观接口</p><p>产品内部结构</p><div class="gallery">    <div class="fj-gallery  data" data-rowheight="220" data-limit="10">    <span class="gallery-data">[{"url":"https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_e55ad4914ecc2115cae8f66c70a4d2ce.png","alt":""},{"url":"https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_0719498ab66e6038ecc45c5d21398f75.png","alt":""},{"url":"https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_30518c76a3cbacc8c7bfb54189ee5695.png","alt":""}]</span>    </div>    <button class="gallery-load-more"><span>Load More</span><i class="fa-solid fa-arrow-down"></i></button>    </div>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>本站说明</title>
      <link href="/2024/01/17/%E6%9C%AC%E7%AB%99%E8%AF%B4%E6%98%8E/"/>
      <url>/2024/01/17/%E6%9C%AC%E7%AB%99%E8%AF%B4%E6%98%8E/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>本站说明</strong>💗</p><p>本站为<a href="https://gegewu-cloud.github.io/">ZzNnWn.</a>博主新开博客 本站使用图床Blazeb2及Github图床</p><p>之前一直使用<del>hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</del>的方式写作管理博客 不是很方便有时候会出现<strong>hexo d</strong>报错的现象  加之博客篇数太多后导致 每次执行损耗时间过长 一直在寻找解决此问题的方法 中途差点放弃使用hexo  一次偶然的机会 了解到<a href="http://sunlight.zznnwn.cloudns.biz/2024/01/16/hexo-butterfly-Qexo%E5%90%8E%E7%AB%AFgithub%E8%87%AA%E5%8A%A8%E5%8C%96.md/">Qexo</a>这个极其好用的管理hexo的工具几番尝试后决定新开一博客<a href="http://sunlight.zznnwn.cloudns.biz/">粘人的鸭嘴兽. </a> 初衷 用于记录日常 本站技术类文章较少 技术类文章在博主另一小站<a href="https://gegewu-cloud.github.io/">ZzNnWn.</a></p><p>站点初始链接：<a href="http://sunlight.zznnwn.cloudns.biz/">zznn-cloud博客</a><br>托管域名地址：<a href="http://sunlight.zznnwn.cloudns.biz/">http://sunlight.zznnwn.cloudns.biz/</a></p><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_436d9740fba555d84165cf30cad9603a.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_436d9740fba555d84165cf30cad9603a.png"></p>]]></content>
      
      
      <categories>
          
          <category> 日常 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 日常 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux-alias方式防止根目录误删</title>
      <link href="/2024/01/16/linux-alias%E6%96%B9%E5%BC%8F%E9%98%B2%E6%AD%A2%E6%A0%B9%E7%9B%AE%E5%BD%95%E8%AF%AF%E5%88%A0/"/>
      <url>/2024/01/16/linux-alias%E6%96%B9%E5%BC%8F%E9%98%B2%E6%AD%A2%E6%A0%B9%E7%9B%AE%E5%BD%95%E8%AF%AF%E5%88%A0/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>linux-alias方式防止根目录误删（本文档未测试）</strong></p><p>参考：</p><ul><li><a href="http://www.opstool.com/article/179">http://www.opstool.com/article/179</a></li><li><a href="https://steemit.com/cn/@oflyhigh/sudo-rm-rf">https://steemit.com/cn/@oflyhigh/sudo-rm-rf</a></li><li><a href="https://zhuanlan.zhihu.com/p/106066854">https://zhuanlan.zhihu.com/p/106066854</a></li></ul><p>rm是一个危险的命令，为了防止rm /这样的操作发生。我们可以在用户的家目录的.bashrc里将rm alisa一下，加上–preserve-root这个参数。其实除了rm外，另外几个命令也需要谨慎，如chgrp、chown、chmod总结一下，我们可以在.bashrc里加入如下alias：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> <span class="built_in">chgrp</span>=<span class="string">&#x27;chgrp --preserve-root&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">chown</span>=<span class="string">&#x27;chown --preserve-root&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">chmod</span>=<span class="string">&#x27;chmod --preserve-root&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> <span class="built_in">rm</span>=<span class="string">&#x27;rm -i --preserve-root&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>详细解释之根目录保护</strong></p><p>有一定经验的系统管理员可能这个时候会想起来，<code>rm</code> 命令有一对专门针对根目录的选项 <code>--preserve-root</code> 和 <code>--no-preserve-root</code> 。这对选项的意思是：</p><ul><li><code>--preserve-root</code>：保护根目录，这是默认行为。</li><li><code>--no-preserve-root</code>：不保护根目录。</li></ul><p>这对选项是后来添加到 <code>rm</code> 命令的。可能几乎每个系统管理员都犯过操作错误，而这其中删除过根目录的比比皆是（我就是一个）。出现这种情况的原因有几种：</p><ul><li>输入手误：比如本来想输入 <code>rm /tmp/test.txt</code>，结果不小心键盘打的飞起，多输入了一个空格变成： <code>rm / tmp/test.txt</code> 。看到根目录（<code>/</code>）后面的空格了么？！——这就是我当前自己亲手犯过的错误，而且是在生产服务器上。</li><li>未正确初始化或命名错误的 shell 脚本变量：比如在脚本中，<code>rm -rf /$&#123;tmp_dir&#125;</code>，如果无论是 <code>tmp_dir</code> 变量没有正确赋值还是输入错误（原本或许是 <code>tmpdir</code> ？），那会导致什么？当然是删除根目录咯~</li></ul><p>鉴于这种情况层出不穷，在 Linux 圈子几乎和“初学者如何退出 vi” 一样成为经典笑话了。所以，在 POSIX 第七版规范中，<code>rm</code> 命令<a href="https://link.zhihu.com/?target=http://pubs.opengroup.org/onlinepubs/9699919799/utilities/rm.html">添加</a>了 <code>--preserve-root</code> 选项，并将其作为默认行为，以降低出现这种错误的可能。</p><p>但是，这个选项不能防范本文中所述的清除根目录下所有文件（<code>/*</code>）的操作。</p><p>有的同学可能要问，那为什么还会专门出现 <code>--no-preserve-root</code> 选项呢？这可能主要是出于 UNIX 哲学的考虑，给予你想要的一切权力，犯傻是你的事情，而不是操作系统的事情。万一，你真的想删除根目录下的所有文件呢？</p><p>你还别说，真有这种需求：比如你要清除一个 chroot 环境下的所有文件。 chroot 我们这里不多讲，它就是以一个目录作为“监狱”，该目录在逻辑上形成了新的“根目录”，在该监狱内的文件操作不能跨出该目录范畴。近些年流行的 Docker、LXC/LXD 之类的容器技术，都是一种 chroot 技术。</p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo-butterfly-Qexo后端github自动化</title>
      <link href="/2024/01/16/hexo-butterfly-Qexo%E5%90%8E%E7%AB%AFgithub%E8%87%AA%E5%8A%A8%E5%8C%96/"/>
      <url>/2024/01/16/hexo-butterfly-Qexo%E5%90%8E%E7%AB%AFgithub%E8%87%AA%E5%8A%A8%E5%8C%96/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="/assets/css/APlayer.min.css"><script src="/assets/js/APlayer.min.js" class="aplayer-secondary-script-marker"></script><p><strong>hexo+butterfly+Qexo后端+github自动化</strong>👍</p><p>参考：</p><p><a href="https://www.oplog.cn/qexo/">https://www.oplog.cn/qexo/</a>                      （官网）<br><a href="https://blog.kwxos.top/posts/18807.html">https://blog.kwxos.top/posts/18807.html</a> （只此一篇即可👍 ）</p><p>概览：</p><ul><li>新建两个仓库一个放博客源文件 一个存放静态文件<br>存放源文件仓库：<a href="https://github.com/zznn-cloud/qexo-blog-source">qexo-blog-source</a>此仓库需设置为私有<br>存放静态文件仓库：zznn-cloud.github.io 此仓库公开</li><li>常规部署方式hexo clean &amp;&amp; hexo g &amp;&amp; hexo d将静态文件推送到仓库zznn-cloud.github.io</li><li>使用Git或者vscode等工具将博客源文件推送到仓库qexo-blog-source</li><li>源文件仓库qexo-blog-source <strong>.github</strong>下新建Github Action配置文件</li><li>使用Vercel部署qexo管理博客</li><li>浏览器访问zznn-cloud.github.io 此时部署完成</li></ul><blockquote><p><del>note: 关于博客如何搭建及Github pages如何使用相对简单本文不做介绍</del></p></blockquote><h2 id="一-两个仓库配置"><a href="#一-两个仓库配置" class="headerlink" title="一. 两个仓库配置"></a>一. 两个仓库配置</h2><ol><li><p><a href="https://wn-apple-teawine.fun/2023/08/12/hexo%E4%B8%8Egithub%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/#%E5%8D%81-butterfly%E4%B8%BB%E9%A2%98%E8%AE%BE%E7%BD%AE">公开仓库zznn-cloud.github.io静态文件推送较为简单此处略</a></p></li><li><p><strong>github-token</strong>生成此<code>token</code>填入下方<code>action</code>配置文件(配置永不过期以及下方权限)</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/86b145ca-5730-4187-836e-00aad670b76d.png"></p></li><li><p>私有仓库<strong>qexo-blog-source</strong>只需要<strong>push</strong>下方文件即可</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/5ff789ab-8d59-4a54-b2a2-aeec9ba423b4.png"></p></li><li><p>私有仓库.github目录新建配置文件如下</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/6eb998ca-bee5-4b26-9286-86d3ba8ea862.png"></p><p>配置如下</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">自动部署</span></span><br><span class="line"><span class="comment"># 当有改动推送到main分支时，启动Action</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line">  <span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">main</span></span><br><span class="line">      <span class="comment">#2020年10月后github新建仓库默认分支改为main，注意更改</span></span><br><span class="line">  <span class="attr">release:</span></span><br><span class="line">    <span class="attr">types:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">published</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line">  <span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">检查分支</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">ref:</span> <span class="string">main</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Node</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/setup-node@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">node-version:</span> <span class="string">&quot;16.x&quot;</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          export TZ=&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line"><span class="string">          npm install hexo-cli -g</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">缓存</span> <span class="string">Hexo</span></span><br><span class="line">        <span class="attr">id:</span> <span class="string">cache-npm</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">actions/cache@v3</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">          <span class="attr">cache-name:</span> <span class="string">cache-node-modules</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">          <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.os</span> <span class="string">&#125;&#125;-build-$&#123;&#123;</span> <span class="string">env.cache-name</span> <span class="string">&#125;&#125;-$&#123;&#123;</span> <span class="string">hashFiles(&#x27;**/package-lock.json&#x27;)</span> <span class="string">&#125;&#125;</span></span><br><span class="line">          <span class="attr">restore-keys:</span> <span class="string">|</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-build-$&#123;&#123; env.cache-name &#125;&#125;-</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-build-</span></span><br><span class="line"><span class="string">            $&#123;&#123; runner.os &#125;&#125;-</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="comment"># Install pandoc for mathjax (Optional)</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Install</span> <span class="string">pandoc</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          cd /tmp</span></span><br><span class="line"><span class="string">          wget -c https://github.com/jgm/pandoc/releases/download/2.14.0.3/pandoc-2.14.0.3-1-amd64.deb</span></span><br><span class="line"><span class="string">          sudo dpkg -i pandoc-2.14.0.3-1-amd64.deb</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装依赖</span></span><br><span class="line">        <span class="attr">if:</span> <span class="string">$&#123;&#123;</span> <span class="string">steps.cache-npm.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span> <span class="string">&#125;&#125;</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          # npm install gulp-cli -g #全局安装gulp</span></span><br><span class="line"><span class="string">          npm install --save</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">     <span class="comment"># - name: 修改双栏插件的CDN</span></span><br><span class="line">     <span class="comment">#   run: |</span></span><br><span class="line">     <span class="comment">#     sed -i &quot;s/cdn.jsdelivr.net/blogresource.sqwdream.top\/cdn.jsdelivr.net/g&quot; node_modules/hexo-butterfly-article-double-row/index.js</span></span><br><span class="line"></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">生成静态文件</span></span><br><span class="line">        <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">          hexo clean</span></span><br><span class="line"><span class="string">          hexo bangumi -u #bilibili番剧更新</span></span><br><span class="line"><span class="string">          hexo generate</span></span><br><span class="line"><span class="string">          # gulp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">部署到Github</span></span><br><span class="line">        <span class="attr">uses:</span> <span class="string">JamesIves/github-pages-deploy-action@v4</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">          <span class="attr">token:</span> <span class="string">github-token</span>  <span class="comment"># github高权限token</span></span><br><span class="line">          <span class="attr">repository-name:</span> <span class="string">zznn-cloud/zznn-cloud.github.io</span></span><br><span class="line">          <span class="attr">branch:</span> <span class="string">main</span></span><br><span class="line">          <span class="attr">folder:</span> <span class="string">public</span></span><br><span class="line">          <span class="attr">commit-message:</span> <span class="string">&quot;$<span class="template-variable">&#123;&#123; github.event.head_commit.message &#125;&#125;</span> Updated By Github Actions&quot;</span></span><br></pre></td></tr></table></figure></li></ol><h2 id="二-Qexo部署及配置"><a href="#二-Qexo部署及配置" class="headerlink" title="二. Qexo部署及配置"></a>二. Qexo部署及配置</h2><ol><li><p>此处申请vercel免费的数据库作为存储数据使用</p></li><li><p>使用vercel函数计算部署Qexo前端</p><p><del>Note：上方两步骤较为简单本文不做介绍</del></p></li><li><p>一键部署Qexo传送门(<a href="https://vercel.com/new/clone?repository-url=https://github.com/am-abudu/Qexo">New Project – Vercel</a></p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/bc9f1111-b88d-49be-a0dd-a61f94e46078.png"></p></li><li><p>Qexo写博客参数留存</p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/655e81e0-1d98-40ee-9fbe-20f0f9ceea2e.png"></p><p><img src="https://f005.backblazeb2.com/file/boke-images/znn-cloud-boke/04073e0c-4649-4ea8-8e83-5ab25e43507d.png"></p></li></ol><h1 id="三-扩展😘"><a href="#三-扩展😘" class="headerlink" title="三. 扩展😘"></a>三. 扩展😘</h1><p><strong>Qexo logo等信息</strong></p><ul><li><a href="https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo.png">https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo.png</a></li><li><a href="https://unpkg.com/qexo-static@2.2.3/qexo/images/icon.png">https://unpkg.com/qexo-static@2.2.3/qexo/images/icon.png</a></li><li><a href="https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo-dark.png">https://unpkg.com/qexo-static@2.2.3/qexo/images/qexo-dark.png</a></li></ul><p><strong>Github图床设置</strong>✌</p><p><a href="https://github.com/Qexo/Qexo/wiki/%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE">https://github.com/Qexo/Qexo/wiki/%E5%9B%BE%E5%BA%8A%E9%85%8D%E7%BD%AE</a></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># 仓库</span></span><br><span class="line">zznn-cloud/zznn-cloud-blog-images</span><br><span class="line"><span class="section"># 分支</span></span><br><span class="line">main</span><br><span class="line"><span class="section"># 高权限token</span></span><br><span class="line">ghp<span class="emphasis">_Qknm...................</span></span><br><span class="line"><span class="emphasis"># 保存路径</span></span><br><span class="line"><span class="emphasis">Qexo/&#123;year&#125;/&#123;month&#125;/&#123;filename&#125;_</span>&#123;md5&#125;.&#123;extName&#125;</span><br><span class="line"><span class="section"># 自定义域名</span></span><br><span class="line">https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/&#123;year&#125;/&#123;month&#125;/&#123;filename&#125;<span class="emphasis">_&#123;md5&#125;.&#123;extName&#125;</span></span><br></pre></td></tr></table></figure><blockquote><p><img src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_3292d63d8f8d8a13d3e5c4da5693056e.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/1/image_3292d63d8f8d8a13d3e5c4da5693056e.png"></p></blockquote><p>结语：Qexo是一个极其好用的hexo管理平台感谢维护此项目大佬们的贡献👍 。</p>]]></content>
      
      
      <categories>
          
          <category> qexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> qexo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>qexo</title>
      <link href="/2023/12/15/test%E6%96%87%E6%A1%A3/"/>
      <url>/2023/12/15/test%E6%96%87%E6%A1%A3/</url>
      
        <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh,这是一个无效的密码。请检查并重试。" data-whm="OOPS, these decrypted content may changed, but you can still have a look.">  <script id="hbeData" type="hbeData" data-hmacdigest="1e36074e6806db3b794944b334a845b30ee4a44008c0f95412e8164b226bd2f7">a81b18b76326989181327cf554748c52da21cc33c0731b37b224ba7b570727d3b6d5ddf5cf3c517190be31f0da481a7c1ae1ccf60fc7eaceeb9cc5892e16592bedd0fa34da4e1fbebcabbc85c61b51dc15b4dd5c653dd684e603438464111c4758ada5701ed225dfbd33a33cab2ad7f5093655aeb5eaca0232ba36211d5fc9ff44db582730bf5c727b33bccadb8cb8b77cae0b827153cec6695bba5dd664156870a40827582da63c9bb736da2a1bfc98df7330236d44a7d2f8b10dfdfcd122bd5e2c4b11abfa2950fbe9241cf3f70397f4fefef6014cbf3accc24f189e4e0a0c3b4ec4f45e9219defb3827e97c491cc502d47705a211f980292e5d94782afb28e13979fec10f387caf7a4b98b79a86fe4e7ad3f9160a17314f34ae7dc9de9657330c39bdb079565dd9b9028e55be707459664d80e94aaa904db0f7625599f5d554d2eb884008a91dba287ef5a9e3b8d7f9be0e0cb510ed2de19caaef0d93f43f3fab92059dcb4ae3117d38f5f8569e2599dba450684e50ae2cafed01af668acaccbfd559639df872095f921c09511ba9aa98eaa60ff40792ef9de59eaf803fa0385e164e13c46a17baba7df1020fff0da0f5966c893838d94d1acb2cdefc0c668136b567139a3ccdb81c79fe589a04e4c29f588bc4970922e347038b5255e2073adf5a6f7b1b3da9766823e784de618db79c4e9c7fa9bcb8d349420c1caec932caf6fec3f006905a4da03a87acbb2a0c976d6aa75713e4ac4f627cfdf081140629c8e64f4a4f530949bef04038eb8a5f5bda930b8e4f90f00b0054e7424e220988a14706065271315d9cc90efbea5a21e6b2ab3b97950791af32fea88dc1b4997e0f745f4ee19c3ea33ef460bf37f91a0915fef7997f1476766e49003ee3b4a68b8b45b1fa6c2a9819837b731413ac89ca44f96ed6e06fdde14d31aafd7f10be7182781fcc2f07c927aa8a9b3e18889648d59b4731c1118ab551e3eace4c6cbdcec0dafc9ea2038503b1bf4ce5d78f51c6357e483f7ecd9082168c55ef6208c20227a5499cf042252ea5444d6d925806a4834d574b220e8e14e1ee686f2a699360a0fcedebe1c4b8b0ec701509bb99b96bf2bd69b73b8fd4db9ee9adf0bece84ccfef7bb6759ce3d88f32b8d6f5a4c48f33cc5576c609bf4b89b88fec3a9e95657ff7f1a71f8c2c08068bd8f32c9e0e6adae824595277425c51c9342210ea2ddbd0c468a56e49a07dd603b6c077294df30fd2d37ef48c85b28495a7fba0fdceb2f82d630deea7f8de307fb911599f5c6cb732ffa0c94511fb928a2ea94df54502f6e4ee0a1ec2287b6f0ab5d8cb8a71da9f5cd4fe2f3e86440dfef0c5f538f1fa794b49d86b24907d5ab7bef455fce7a1f5f0f8df94c6b4778617a040daa6e38feff24023cdc7d58888534dac1a361c5</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">请输入访问密码</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      
      
      <categories>
          
          <category> default </category>
          
      </categories>
      
      
        <tags>
            
            <tag> default </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
