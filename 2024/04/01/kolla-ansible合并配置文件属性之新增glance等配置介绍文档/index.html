<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£ | ç²˜äººçš„é¸­å˜´å…½ğŸ“</title><meta name="author" content="ç²˜äººçš„é¸­å˜´å…½çš„å°ç«™ğŸˆ"><meta name="copyright" content="ç²˜äººçš„é¸­å˜´å…½çš„å°ç«™ğŸˆ"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»ºå®˜ç½‘ç‰ˆæœ¬ï¼ˆæµ‹è¯•æ­¤ç§ç‰ˆæœ¬ï¼‰ 123ceph auth get-or-create client.glance mon &amp;#x27;profile rbd&amp;#x27; osd &amp;#x27;profile rbd pool&#x3D;images&amp;#x27; mgr &amp;#x27;profile rbd pool&#x3D;"><meta property="og:type" content="article"><meta property="og:title" content="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£"><meta property="og:url" content="https://zznn-cloud.github.io/2024/04/01/kolla-ansible%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E4%B9%8B%E6%96%B0%E5%A2%9Eglance%E7%AD%89%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D%E6%96%87%E6%A1%A3/"><meta property="og:site_name" content="ç²˜äººçš„é¸­å˜´å…½ğŸ“"><meta property="og:description" content="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»ºå®˜ç½‘ç‰ˆæœ¬ï¼ˆæµ‹è¯•æ­¤ç§ç‰ˆæœ¬ï¼‰ 123ceph auth get-or-create client.glance mon &amp;#x27;profile rbd&amp;#x27; osd &amp;#x27;profile rbd pool&#x3D;images&amp;#x27; mgr &amp;#x27;profile rbd pool&#x3D;"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8%F0%9F%8D%A1/%E5%8A%A8%E6%BC%AB/blog_banner/20200723092041_a8fR5.gif"><meta property="article:published_time" content="2024-04-01T22:18:45.133Z"><meta property="article:modified_time" content="2024-04-04T04:14:01.406Z"><meta property="article:author" content="ç²˜äººçš„é¸­å˜´å…½çš„å°ç«™ğŸˆ"><meta property="article:tag" content="openstack"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8%F0%9F%8D%A1/%E5%8A%A8%E6%BC%AB/blog_banner/20200723092041_a8fR5.gif"><link rel="shortcut icon" href="https://wn.zznnwn.cloudns.biz/img/zznnlogo_bak.webp"><link rel="canonical" href="https://zznn-cloud.github.io/2024/04/01/kolla-ansible%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E4%B9%8B%E6%96%B0%E5%A2%9Eglance%E7%AD%89%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D%E6%96%87%E6%A1%A3/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",languages:{hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"ç¹",msgToSimplifiedChinese:"ç°¡"},noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"Copy successfully",error:"Copy error",noSupport:"The browser does not support"},relativeDate:{homepage:!0,post:!0},runtime:"days",dateSuffix:{just:"Just",min:"minutes ago",hour:"hours ago",day:"days ago",month:"months ago"},copyright:{limitCount:1e3,languages:{author:"Author: ç²˜äººçš„é¸­å˜´å…½çš„å°ç«™ğŸˆ",link:"Link: ",source:"Source: ç²˜äººçš„é¸­å˜´å…½ğŸ“",info:"Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source."}},lightbox:"fancybox",Snackbar:{chs_to_cht:"Traditional Chinese Activated Manually",cht_to_chs:"Simplified Chinese Activated Manually",day_to_night:"Dark Mode Activated Manually",night_to_day:"Light Mode Activated Manually",bgLight:"#49b1f5",bgDark:"#121212",position:"top-right"},source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,percent:{toc:!0,rightside:!0},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-04-04 12:14:01"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.getCSS=(o,n=!1)=>new Promise((t,e)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=o,n&&(a.id=n),a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><style type="text/css">.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><link rel="stylesheet" href="/css/pl.css"><link rel="stylesheet" href="/css/color.css"><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/menu.css"><link rel="stylesheet" href="/css/universe.css"><link rel="stylesheet" href="/css/cat.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_4426032_wnvg24di0w.css" media="defer" onload='this.media="all"'><link rel="stylesheet" href="/css/daohang.css"><div id="myscoll"></div><meta name="generator" content="Hexo 5.4.2"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8%F0%9F%8D%A1/%E5%8A%A8%E6%BC%AB/blog_banner/20200723092041_a8fR5.gif" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">23</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">23</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-zhuye-"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/ç®€é€¸äº‘é¦–é¡µ/index-left.html"><i class="fa-fw iconfont icon-a-shuiguochengzijuzi"></i><span> ç®€é€¸äº‘é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-09wenzhang"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-guidang"></i><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-kafeibei"></i><span> åŠ¨ç”»</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/%E6%97%B6%E9%92%9F/clock2.html"><span>æ—¶é’Ÿ</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/%E7%83%9F%E8%8A%B1/fireworks2.html"><span>çƒŸèŠ±</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/%E5%9C%A3%E8%AF%9E%E6%A0%91/christmastree1.html"><span>åœ£è¯æ ‘</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/%E4%B8%83%E5%BD%A9%E9%9B%A8/qicaiyu.html"><span>ä¸ƒå½©é›¨</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://uptime-status.zznnwn.cloudns.biz"><i class="fa-fw iconfont icon-xing"></i><span> å°ç«™ç›‘æ§</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-kafei"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="http://sunlight.zznnwn.cloudns.biz/2024/03/16/éŸ³ä¹/"><i class="fa-fw iconfont icon-juzipian"></i><span> éŸ³ä¹</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://gegewu-cloud.github.io/2023/05/23/ç•™è¨€æ¿/"><i class="fa-fw iconfont icon-lishiliuyan"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://gegewu-cloud.github.io/2023/05/22/å…³äº/"><i class="fa-fw iconfont icon-zhuye_chengchangjilu"></i><span> å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8%F0%9F%8D%A1/%E5%8A%A8%E6%BC%AB/blog_banner/16.jpg)"><nav id="nav"><span id="blog-info"><a href="/" title="ç²˜äººçš„é¸­å˜´å…½ğŸ“"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wn.zznnwn.cloudns.biz/img/zznnlogo_bak.webp"><span class="site-name">ç²˜äººçš„é¸­å˜´å…½ğŸ“</span></a></span><div id="he-plugin-simple"></div><div id="none_space"></div><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw iconfont icon-zhuye-"></i><span> ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/ç®€é€¸äº‘é¦–é¡µ/index-left.html"><i class="fa-fw iconfont icon-a-shuiguochengzijuzi"></i><span> ç®€é€¸äº‘é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-09wenzhang"></i><span> æ–‡ç« </span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw iconfont icon-fenlei"></i><span> åˆ†ç±»</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw iconfont icon-biaoqian"></i><span> æ ‡ç­¾</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw iconfont icon-guidang"></i><span> å½’æ¡£</span></a></li></ul></div><div class="menus_item"><a class="site-page group hide" href="javascript:void(0);"><i class="fa-fw iconfont icon-kafeibei"></i><span> åŠ¨ç”»</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/%E6%97%B6%E9%92%9F/clock2.html"><span>æ—¶é’Ÿ</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/%E7%83%9F%E8%8A%B1/fireworks2.html"><span>çƒŸèŠ±</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/%E5%9C%A3%E8%AF%9E%E6%A0%91/christmastree1.html"><span>åœ£è¯æ ‘</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/html/%E4%B8%83%E5%BD%A9%E9%9B%A8/qicaiyu.html"><span>ä¸ƒå½©é›¨</span></a></li></ul></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://uptime-status.zznnwn.cloudns.biz"><i class="fa-fw iconfont icon-xing"></i><span> å°ç«™ç›‘æ§</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw iconfont icon-kafei"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="http://sunlight.zznnwn.cloudns.biz/2024/03/16/éŸ³ä¹/"><i class="fa-fw iconfont icon-juzipian"></i><span> éŸ³ä¹</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://gegewu-cloud.github.io/2023/05/23/ç•™è¨€æ¿/"><i class="fa-fw iconfont icon-lishiliuyan"></i><span> ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://gegewu-cloud.github.io/2023/05/22/å…³äº/"><i class="fa-fw iconfont icon-zhuye_chengchangjilu"></i><span> å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-04-01T22:18:45.133Z" title="Created 2024-04-02 06:18:45">2024-04-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-04-04T04:14:01.406Z" title="Updated 2024-04-04 12:14:01">2024-04-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/openstack/">openstack</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word count:</span><span class="word-count">1.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading time:</span><span>9min</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post View:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£"><a href="#kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£" class="headerlink" title="kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£"></a>kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£</h1><h2 id="cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º"><a href="#cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º" class="headerlink" title="cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º"></a>cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º</h2><p>å®˜ç½‘ç‰ˆæœ¬ï¼ˆæµ‹è¯•æ­¤ç§ç‰ˆæœ¬ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ceph auth get-or-create client.glance mon <span class="string">&#x27;profile rbd&#x27;</span> osd <span class="string">&#x27;profile rbd pool=images&#x27;</span> mgr <span class="string">&#x27;profile rbd pool=images&#x27;</span> -o ceph.client.glance.keyring </span><br><span class="line">ceph auth get-or-create client.cinder mon <span class="string">&#x27;profile rbd&#x27;</span> osd <span class="string">&#x27;profile rbd pool=volumes, profile rbd pool=vms, profile rbd-read-only pool=images&#x27;</span> mgr <span class="string">&#x27;profile rbd pool=volumes, profile rbd pool=vms&#x27;</span> -o ceph.client.cinder.keyring</span><br><span class="line">ceph auth get-or-create client.cinder-backup mon <span class="string">&#x27;profile rbd&#x27;</span> osd <span class="string">&#x27;profile rbd pool=backups&#x27;</span> mgr <span class="string">&#x27;profile rbd pool=backups&#x27;</span> -o ceph.client.cinder-backup.keyring</span><br></pre></td></tr></table></figure><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬å¯†é’¥åˆ›å»ºå¦‚ä¸‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /etc/ceph</span><br><span class="line">ceph auth get-or-create client.cinder mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=volumes, allow rwx pool=vms, allow rx pool=images&#x27;</span> -o ceph.client.cinder.keyring</span><br><span class="line">ceph auth get-or-create client.glance mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=images&#x27;</span>  -o ceph.client.glance.keyring</span><br><span class="line">ceph auth get-or-create client.cinder-backup mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=backups, allow rwx pool=volumes&#x27;</span>  -o ceph.client.cinder-backup.keyring</span><br><span class="line">ceph auth get-or-create client.nova mon <span class="string">&#x27;allow r&#x27;</span> osd <span class="string">&#x27;allow class-read object_prefix rbd_children, allow rwx pool=vms, allow rwx pool=volumes, allow rx pool=images&#x27;</span>  -o ceph.client.nova.keyring</span><br></pre></td></tr></table></figure><h2 id="ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®"><a href="#ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®" class="headerlink" title="ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®"></a>ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®</h2><blockquote><p>ä¸‹æ–¹å†…å®¹æ¥è‡ª | ï¼š</p><p><a target="_blank" rel="noopener" href="https://wn-apple-teawine.fun/2023/06/02/ceph%E4%B8%8Eopenstack-yoga%E9%9B%86%E6%88%90">https://wn-apple-teawine.fun/2023/06/02/cephä¸openstack-yogaé›†æˆ</a></p><p>å¯å‚è€ƒå®˜ç½‘ï¼š</p><p><a target="_blank" rel="noopener" href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/">https://docs.ceph.com/en/reef/rbd/rbd-openstack/</a></p><p><del><strong>volume</strong>ä¸<strong>cinder-backup</strong>åˆ©ç”¨<strong>kolla-ansible</strong>åˆå¹¶é…ç½®æ–‡ä»¶å±æ€§åç”Ÿæˆçš„é…ç½®æ–‡ä»¶åˆ†åˆ«ä½äº</del></p><p>/etc/kolla/cinder-volume/cinder.conf<br>/etc/kolla/cinder-backup/cinder.conf</p><p><del><strong>glance</strong>ä¸<strong>nova</strong>åˆ†åˆ«ä½äº</del></p><p>/etc/kolla/glance-api/glance-api.conf<br>/etc/kolla/nova-compute/nova.conf</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># glanceçš„é…ç½®é•œåƒå­˜å‚¨</span></span><br><span class="line">vi /etc/kolla/config/glance/glance-api.conf</span><br><span class="line"><span class="comment"># æ·»åŠ ï¼š</span></span><br><span class="line">[glance_store]</span><br><span class="line">stores=rbd</span><br><span class="line">default_store=rbd</span><br><span class="line">rbd_store_pool=images</span><br><span class="line">rbd_store_user=glance</span><br><span class="line">rbd_store_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># cinderçš„é…ç½®å·å­˜å‚¨</span></span><br><span class="line">vi /etc/kolla/config/cinder/cinder-volume.conf</span><br><span class="line"><span class="comment"># æ·»åŠ :</span></span><br><span class="line">[DEFAULT]</span><br><span class="line">enabled_backends=rbd-1</span><br><span class="line">[rbd-1]</span><br><span class="line">rbd_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line"><span class="comment"># rbd_flatten_volume_from_snapshot = true</span></span><br><span class="line">rbd_user=cinder  </span><br><span class="line">backend_host=rbd:volumes</span><br><span class="line">rbd_pool=volumes</span><br><span class="line">volume_backend_name=rbd-1</span><br><span class="line">volume_driver=cinder.volume.drivers.rbd.RBDDriver     <span class="comment"># æ­¤ä¸ºé©±åŠ¨</span></span><br><span class="line">rbd_secret_uuid=ea241bba-2031-4b0e-b750-c8356cbb46a8 </span><br><span class="line"></span><br><span class="line">æ–°å¢ï¼šï¼ˆ rbd_flatten_volume_from_snapshot = <span class="literal">true</span></span><br><span class="line">ï¼‰</span><br><span class="line"><span class="comment"># æ³¨æ„ï¼šrbd_secret_uuidåœ¨/etc/kolla/passwords.yml æ–‡ä»¶ä¸­æ‰¾</span></span><br><span class="line"><span class="comment"># cat /etc/kolla/passwords.yml | grep rbd_secret_uuid</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cinder-backupçš„é…ç½®</span></span><br><span class="line">vi /etc/kolla/config/cinder/cinder-backup.conf</span><br><span class="line"><span class="comment"># æ·»åŠ :</span></span><br><span class="line">[DEFAULT]</span><br><span class="line">backup_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line">backup_ceph_user=cinder-backup   </span><br><span class="line">backup_ceph_chunk_size=134217728</span><br><span class="line">backup_ceph_pool=backups</span><br><span class="line"><span class="comment"># æœ¬æ¬¡ä½¿ç”¨cinder.backup.drivers.ceph.CephBackupDriver</span></span><br><span class="line">backup_driver=cinder.backup.drivers.ceph.CephBackupDriver    <span class="comment">#æ­¤ä¸ºé©±åŠ¨å¯é€‰cinder.backup.drivers.ceph</span></span><br><span class="line">backup_ceph_stripe_unit=0</span><br><span class="line">backup_ceph_stripe_count=0</span><br><span class="line">restore_discard_excess_bytes=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># novaçš„é…ç½®</span></span><br><span class="line">vi /etc/kolla/config/nova/nova-compute.conf</span><br><span class="line"><span class="comment"># æ·»åŠ ï¼š   </span></span><br><span class="line">[libvirt]   </span><br><span class="line">virt_type=kvm  </span><br><span class="line">cpu_mode=none </span><br><span class="line">images_rbd_pool=vms</span><br><span class="line">images_type=rbd</span><br><span class="line">images_rbd_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line">rbd_user=nova</span><br><span class="line"><span class="comment"># disk_cachemodes= &quot;network=writeback&quot;</span></span><br><span class="line"><span class="comment"># inject_password=true</span></span><br><span class="line"><span class="comment"># å¦‚æœæ˜¯åœ¨è™šæ‹Ÿæœºä¸Šéƒ¨ç½²çš„è¯éœ€è¦å°†virt_type æ”¹ä¸ºqemuï¼Œå¦‚æœä¸æ”¹æˆqemuï¼Œåœ¨openstackä¹‹ä¸Šåœ¨èµ·è™šæœºï¼Œè¿™ä¸ªè™šæœºæ˜¯èµ·ä¸æ¥çš„ </span></span><br><span class="line">ï¼ˆå®é™…ç¯å¢ƒå‚è€ƒ</span><br><span class="line">æ–°å¢: disk_cachemodes= <span class="string">&quot;network=writeback&quot;</span> inject_password=<span class="literal">true</span>,images_type=rbd </span><br><span class="line">åˆ é™¤: virt_type=kvm, cpu_mode = none :åˆ é™¤æ–°å¢é…ç½®æ­¤ç§æ—¶æˆåŠŸ ï¼‰</span><br></pre></td></tr></table></figure></blockquote><h2 id="glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api-confï¼‰"><a href="#glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api-confï¼‰" class="headerlink" title="glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api.confï¼‰"></a>glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api.confï¼‰</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/glance/glance-api.conf</p><blockquote><p>å®˜ç½‘å¼•ç”¨</p><h4 id="KILO-AND-AFTER-gt-gt"><a href="#KILO-AND-AFTER-gt-gt" class="headerlink" title="KILO AND AFTER&gt;&gt;"></a>KILO AND AFTER<a target="_blank" rel="noopener" href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#kilo-and-after" title="Permalink to this heading">&gt;&gt;</a></h4><p>Edit <code>/etc/glance/glance-api.conf</code> and add under the <code>[glance_store]</code> section:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[glance_store]</span><br><span class="line">stores = rbd</span><br><span class="line">default_store = rbd</span><br><span class="line">rbd_store_pool = images</span><br><span class="line">rbd_store_user = glance</span><br><span class="line">rbd_store_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">rbd_store_chunk_size = 8</span><br></pre></td></tr></table></figure><p>For more information about the configuration options available in Glance please refer to the OpenStack Configuration Reference: <a target="_blank" rel="noopener" href="http://docs.openstack.org/">http://docs.openstack.org/</a>.</p><h4 id="ENABLE-COPY-ON-WRITE-CLONING-OF-IMAGESïƒ"><a href="#ENABLE-COPY-ON-WRITE-CLONING-OF-IMAGESïƒ" class="headerlink" title="ENABLE COPY-ON-WRITE CLONING OF IMAGESïƒ"></a>ENABLE COPY-ON-WRITE CLONING OF IMAGES<a target="_blank" rel="noopener" href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#enable-copy-on-write-cloning-of-images" title="Permalink to this heading">ïƒ</a></h4><p>Note that this exposes the back end location via Glanceâ€™s API, so the endpoint with this option enabled should not be publicly accessible.</p><h5 id="ANY-OPENSTACK-VERSION-EXCEPT-MITAKAïƒ"><a href="#ANY-OPENSTACK-VERSION-EXCEPT-MITAKAïƒ" class="headerlink" title="ANY OPENSTACK VERSION EXCEPT MITAKAïƒ"></a>ANY OPENSTACK VERSION EXCEPT MITAKA<a target="_blank" rel="noopener" href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#any-openstack-version-except-mitaka" title="Permalink to this heading">ïƒ</a></h5><p>If you want to enable copy-on-write cloning of images, also add under the <code>&lt;span class=&quot;pre&quot;&gt;[DEFAULT]&lt;/span&gt;</code> section:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_image_direct_url = True</span><br></pre></td></tr></table></figure></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show_image_direct_url = True</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨OpenStackä¸­ï¼ŒGlanceæ˜¯ç”¨äºç®¡ç†è™šæ‹Ÿæœºé•œåƒçš„ç»„ä»¶ï¼Œè€ŒCephåˆ™æ˜¯ä¸€ç§åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œå¸¸è¢«ç”¨äºOpenStackçš„åç«¯å­˜å‚¨ã€‚åœ¨ä½ æåˆ°çš„é…ç½®ä¸­ï¼Œ<code>show_image_direct_url = True</code> æ˜¯ç”¨äºé…ç½® Glance çš„ <code>glance-api.conf</code> æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒç”¨äºå¯ç”¨æˆ–ç¦ç”¨æ˜¾ç¤ºé•œåƒç›´æ¥URLçš„åŠŸèƒ½ã€‚å½“ä½ è®¾ç½® <code>show_image_direct_url = True</code> æ—¶ï¼ŒGlance API å°†åŒ…å«ä¸€ä¸ªåä¸º <code>direct_url</code> çš„å±æ€§ï¼Œè¯¥å±æ€§åŒ…å«æŒ‡å‘å­˜å‚¨é•œåƒç›´æ¥URLçš„é“¾æ¥ã€‚è¿™ä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ç›´æ¥URLè®¿é—®é•œåƒï¼Œè€Œä¸å¿…é€šè¿‡ Glance API æœåŠ¡ã€‚è¿™åœ¨æŸäº›æƒ…å†µä¸‹å¯èƒ½æ˜¯æœ‰ç”¨çš„ï¼Œä¾‹å¦‚ï¼Œå¦‚æœä½ å¸Œæœ›é€šè¿‡ç›´æ¥é“¾æ¥å…±äº«é•œåƒç»™å…¶ä»–ç”¨æˆ·æˆ–ç³»ç»Ÿï¼Œè€Œæ— éœ€é€šè¿‡ Glance API ã€‚åœ¨ Ceph å’Œ OpenStack é›†æˆçš„æƒ…å†µä¸‹ï¼Œä½ éœ€è¦ç¡®ä¿ Glance é…ç½®æ–‡ä»¶ä¸­çš„ <code>default_store</code> è®¾ç½®ä¸º <code>rbd</code>ï¼Œä»¥ä¾¿å°†é•œåƒå­˜å‚¨åœ¨ Ceph RBDï¼ˆå—è®¾å¤‡ï¼‰åç«¯ã€‚åŒæ—¶ï¼Œä½ éœ€è¦é…ç½®å¥½ Ceph çš„è®¿é—®æƒé™ï¼Œç¡®ä¿ OpenStack çš„å„ä¸ªç»„ä»¶å¯ä»¥æ­£ç¡®åœ°è®¿é—®å’Œä½¿ç”¨ Ceph å­˜å‚¨ã€‚</p></blockquote><h2 id="ciner-å®˜ç½‘å‚è€ƒ"><a href="#ciner-å®˜ç½‘å‚è€ƒ" class="headerlink" title="ciner(å®˜ç½‘å‚è€ƒ)"></a>ciner(å®˜ç½‘å‚è€ƒ)</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/cinder/cinder-volume.conf</p><blockquote><p>OpenStack requires a driver to interact with Ceph block devices. You must also specify the pool name for the block device. On your OpenStack node, edit <code>/etc/cinder/cinder.conf</code> by adding:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[DEFAULT]</span><br><span class="line">...</span><br><span class="line">enabled_backends = ceph</span><br><span class="line">glance_api_version = 2</span><br><span class="line">...</span><br><span class="line">[ceph]</span><br><span class="line">volume_driver = cinder.volume.drivers.rbd.RBDDriver</span><br><span class="line">volume_backend_name = ceph</span><br><span class="line">rbd_pool = volumes</span><br><span class="line">rbd_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">rbd_flatten_volume_from_snapshot = false</span><br><span class="line">rbd_max_clone_depth = 5</span><br><span class="line">rbd_store_chunk_size = 4</span><br><span class="line">rados_connect_timeout = -1</span><br></pre></td></tr></table></figure><p>If you are using <a target="_blank" rel="noopener" href="https://docs.ceph.com/en/reef/rados/configuration/auth-config-ref/#enabling-disabling-cephx">cephx authentication</a>, also configure the user and uuid of the secret you added to <code>libvirt</code> as documented earlier:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[ceph]</span><br><span class="line">...</span><br><span class="line">rbd_user = cinder</span><br><span class="line">rbd_secret_uuid = 457eb676-33da-42ec-9a8c-9293d545c337</span><br></pre></td></tr></table></figure><p>Note that if you are configuring multiple cinder back ends, <code>&lt;span class=&quot;pre&quot;&gt;glance_api_version&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span class=&quot;pre&quot;&gt;=&lt;/span&gt;&lt;span&gt;Â &lt;/span&gt;&lt;span class=&quot;pre&quot;&gt;2&lt;/span&gt;</code> must be in the <code>&lt;span class=&quot;pre&quot;&gt;[DEFAULT]&lt;/span&gt;</code> section.</p></blockquote><p><strong>enabled_backends = ceph</strong> æ­¤é…ç½®å®é™…ä¸Šåç«¯æ‰‹åŠ¨æ“ä½œä¸ºå¦‚ä¸‹ å®é™…ä¸Šå°±æ˜¯åˆ›å»ºç£ç›˜æ—¶é€‰æ‹©çš„ç±»å‹ æ–°ç‰ˆæœ¬ä¸éœ€è¦æ‰‹åŠ¨åˆ›å»º é…ç½®æ–‡ä»¶å¡«å†™å®Œæˆå³å¯</p><p>æ¯”å¦‚ æˆ‘æ‰‹åŠ¨åˆ›å»ºrbd-1ç±»å‹æ—¶åˆ™ä¼šæŠ¥é”™ï¼š</p><p>æ‰§è¡Œ cinder type-key 1f90a0e1-3657-4d42-9965-4e9ab76ed635 set volume_backend_name=rbd-1 æŠ¥é”™<br>ERROR: Volume Type is currently in use. (HTTP 400) (Request-ID: req-48ab8f51-d024-45e4-a9f8-376f7c71bf45)</p><blockquote><p>cinder type-create ceph</p><p>cinder type-key 8a8a69b6-ec9f-4a09-8126-a211fce34ef3 set volume_backend_name=ceph</p><p>cinder type-list</p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_081d10d51610d49db32c3074544340f6.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_081d10d51610d49db32c3074544340f6.png"></p></blockquote><h2 id="ciner-backup"><a href="#ciner-backup" class="headerlink" title="ciner-backup"></a>ciner-backup</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/cinder/cinder-backup.conf</p><p>äº‹å®ä¸Šé»˜è®¤ä½¿ç”¨çš„é©±åŠ¨æ˜¯swifté©±åŠ¨ ZzNnWn.ä½¿ç”¨é©±åŠ¨ä¸º<strong>cinder.backup.drivers.ceph.CephBackupDriver</strong> éœ€è¦æ³¨æ„çš„æ˜¯<strong>cinder.backup.drivers.ceph</strong>æ­¤é©±åŠ¨å·²å¼ƒç”¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">backup_driver= cinder.backup.drivers.swift.SwiftBackupDriver</span><br><span class="line">backup_driver=cinder.backup.drivers.swift.SwiftBackupDriver</span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c901ca872c1b350140046935d9a97ad.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_0c901ca872c1b350140046935d9a97ad.png"></p><blockquote><p>å®˜ç½‘å¼•ç”¨</p><h3 id="CONFIGURING-CINDER-BACKUPïƒ"><a href="#CONFIGURING-CINDER-BACKUPïƒ" class="headerlink" title="CONFIGURING CINDER BACKUPïƒ"></a>CONFIGURING CINDER BACKUP<a target="_blank" rel="noopener" href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#configuring-cinder-backup" title="Permalink to this heading">ïƒ</a></h3><p>OpenStack Cinder Backup requires a specific daemon so donâ€™t forget to install it. On your Cinder Backup node, edit <code>/etc/cinder/cinder.conf</code> and add:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">backup_driver = cinder.backup.drivers.ceph</span><br><span class="line">backup_ceph_conf = /etc/ceph/ceph.conf</span><br><span class="line">backup_ceph_user = cinder-backup</span><br><span class="line">backup_ceph_chunk_size = 134217728</span><br><span class="line">backup_ceph_pool = backups</span><br><span class="line">backup_ceph_stripe_unit = 0</span><br><span class="line">backup_ceph_stripe_count = 0</span><br><span class="line">restore_discard_excess_bytes = <span class="literal">true</span></span><br></pre></td></tr></table></figure></blockquote><h2 id="novaä¸ceph"><a href="#novaä¸ceph" class="headerlink" title="novaä¸ceph"></a>novaä¸ceph</h2><p>ZzNnwN.éƒ¨ç½²ç‰ˆæœ¬ kolla_ansibleåˆå¹¶ é…ç½®æ–‡ä»¶è·¯å¾„ï¼š/etc/kolla/config/nova/nova-compute.conf</p><p>æ­¤å¤„åº”è®¾ç½®ä¸ºå¦‚ä¸‹</p><p>rbd_secret_uuid é€šè¿‡å¦‚ä¸‹ä¸¤ç§æ–¹å¼çš†å¯æŸ¥çœ‹</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apt install libvirt-clients -y</span><br><span class="line">virsh secret-list  (æ­¤ç§ä¸ºå·²ä¸openstacké›†æˆæ‰èƒ½ä½¿ç”¨)</span><br><span class="line"><span class="built_in">cat</span> /etc/kolla/passwords.yml |grep rbd_secret_uuid</span><br></pre></td></tr></table></figure><p>å®Œæ•´é…ç½®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># novaçš„é…ç½®</span></span><br><span class="line">vi /etc/kolla/config/nova/nova-compute.conf</span><br><span class="line"><span class="comment"># æ·»åŠ ï¼š   </span></span><br><span class="line">[libvirt]   </span><br><span class="line">virt_type=kvm  </span><br><span class="line">cpu_mode=none </span><br><span class="line">images_rbd_pool=vms</span><br><span class="line">images_type=rbd</span><br><span class="line">images_rbd_ceph_conf=/etc/ceph/ceph.conf</span><br><span class="line">rbd_user=nova</span><br><span class="line"><span class="comment"># rbd_secret_uuid=ea241bba-2031-4b0e-b750-c8356cbb46a8 (å¯é€‰ä¸éœ€è¦é…ç½®åç«¯ä¼šè‡ªåŠ¨ç”Ÿæˆ)</span></span><br></pre></td></tr></table></figure><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5cdbe807c394a81c86e7f04b76d40922.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_5cdbe807c394a81c86e7f04b76d40922.png"></p><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4e38f71c5e42268c245ab6d95a5044b5.png" alt="https://github.com/zznn-cloud/zznn-cloud-blog-images/raw/main/Qexo/24/4/image_4e38f71c5e42268c245ab6d95a5044b5.png"></p><blockquote><p>å®˜ç½‘å¼•ç”¨</p><h3 id="CONFIGURING-NOVA-TO-ATTACH-CEPH-RBD-BLOCK-DEVICEïƒ"><a href="#CONFIGURING-NOVA-TO-ATTACH-CEPH-RBD-BLOCK-DEVICEïƒ" class="headerlink" title="CONFIGURING NOVA TO ATTACH CEPH RBD BLOCK DEVICEïƒ"></a>CONFIGURING NOVA TO ATTACH CEPH RBD BLOCK DEVICE<a target="_blank" rel="noopener" href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#configuring-nova-to-attach-ceph-rbd-block-device" title="Permalink to this heading">ïƒ</a></h3><p>In order to attach Cinder devices (either normal block or by issuing a boot from volume), you must tell Nova (and libvirt) which user and UUID to refer to when attaching the device. libvirt will refer to this user when connecting and authenticating with the Ceph cluster.</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[libvirt]</span><br><span class="line">...</span><br><span class="line">rbd_user = cinder</span><br><span class="line">rbd_secret_uuid = 457eb676-33da-42ec-9a8c-9293d545c337</span><br></pre></td></tr></table></figure><p>These two flags are also used by the Nova ephemeral back end.</p><h3 id="CONFIGURING-NOVAïƒ"><a href="#CONFIGURING-NOVAïƒ" class="headerlink" title="CONFIGURING NOVAïƒ"></a>CONFIGURING NOVA<a target="_blank" rel="noopener" href="https://docs.ceph.com/en/reef/rbd/rbd-openstack/#configuring-nova" title="Permalink to this heading">ïƒ</a></h3><p>In order to boot virtual machines directly from Ceph volumes, you must configure the ephemeral backend for Nova.</p><p>It is recommended to enable the RBD cache in your Ceph configuration file; this has been enabled by default since the Giant release. Moreover, enabling the client admin socket allows the collection of metrics and can be invaluable for troubleshooting.</p><p>This socket can be accessed on the hypervisor (Nova compute) node:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ceph daemon /var/run/ceph/ceph-client.cinder.19195.32310016.asok help</span><br></pre></td></tr></table></figure><p>To enable RBD cache and admin sockets, ensure that on each hypervisorâ€™s <code>&lt;span class=&quot;pre&quot;&gt;ceph.conf&lt;/span&gt;</code> contains:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[client]</span><br><span class="line">    rbd cache = true</span><br><span class="line">    rbd cache writethrough until flush = true</span><br><span class="line">    admin socket = /var/run/ceph/guests/$cluster-$type.$id.$pid.$cctid.asok</span><br><span class="line">    log file = /var/log/qemu/qemu-guest-$pid.log</span><br><span class="line">    rbd concurrent management ops = 20</span><br></pre></td></tr></table></figure><p>Configure permissions for these directories:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /var/run/ceph/guests/ /var/log/qemu/</span><br><span class="line">chown qemu:libvirtd /var/run/ceph/guests /var/log/qemu/</span><br></pre></td></tr></table></figure><p>Note that user <code>&lt;span class=&quot;pre&quot;&gt;qemu&lt;/span&gt;</code> and group <code>&lt;span class=&quot;pre&quot;&gt;libvirtd&lt;/span&gt;</code> can vary depending on your system. The provided example works for RedHat based systems.</p><p>Tip</p><p>If your virtual machine is already running you can simply restart it to enable the admin socket</p></blockquote></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="https://zznn-cloud.github.io">ç²˜äººçš„é¸­å˜´å…½çš„å°ç«™ğŸˆ</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://zznn-cloud.github.io/2024/04/01/kolla-ansible%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E4%B9%8B%E6%96%B0%E5%A2%9Eglance%E7%AD%89%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D%E6%96%87%E6%A1%A3/">https://zznn-cloud.github.io/2024/04/01/kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/openstack/">openstack</a></div><div class="post_share"><div class="social-share" data-image="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8%F0%9F%8D%A1/%E5%8A%A8%E6%BC%AB/blog_banner/20200723092041_a8fR5.gif" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>Donate</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://gegewu-cloud.github.io/img/wechatpayqr.webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gegewu-cloud.github.io/img/wechatpayqr.webp" alt="å¾®ä¿¡"></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://gegewu-cloud.github.io/img/alipayqr.webp" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gegewu-cloud.github.io/img/alipayqr.webp" alt="æ”¯ä»˜å®"></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/04/02/workstdtion%E6%A8%A1%E6%8B%9F%E4%BA%A4%E6%8D%A2%E6%9C%BA%E5%88%92%E5%88%86vlan,%E4%BB%A5%E5%8F%8A%E7%89%A9%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BD%91%E5%8D%A1bond%E8%AE%BE%E7%BD%AE/" title="workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlan,ä»¥åŠç‰©ç†æœåŠ¡å™¨ç½‘å¡bondè®¾ç½®"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8%F0%9F%8D%A1/%E5%8A%A8%E6%BC%AB/blog_banner/20200723092038_dHyHM.gif" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">workstdtionæ¨¡æ‹Ÿäº¤æ¢æœºåˆ’åˆ†vlan,ä»¥åŠç‰©ç†æœåŠ¡å™¨ç½‘å¡bondè®¾ç½®</div></div></a></div><div class="next-post pull-right"><a href="/2024/04/01/openstack%E4%B8%8Eceph%E9%9B%86%E6%88%90%E5%AE%8C%E6%88%90%E5%90%8E%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/" title="openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•"><div class="cover" style="background:var(--default-bg-color)"></div><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><div><a href="/2024/02/19/openstack%E4%B8%8A%E4%BD%BF%E7%94%A8windows%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/" title="openstackä¸Šä½¿ç”¨windowsé•œåƒåˆ¶ä½œ"><div class="cover" style="background:var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-20</div><div class="title">openstackä¸Šä½¿ç”¨windowsé•œåƒåˆ¶ä½œ</div></div></a></div><div><a href="/2024/04/01/openstack%E4%B8%8Eceph%E9%9B%86%E6%88%90%E5%AE%8C%E6%88%90%E5%90%8E%E5%8A%9F%E8%83%BD%E6%B5%8B%E8%AF%95/" title="openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•"><div class="cover" style="background:var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-02</div><div class="title">openstackä¸cephé›†æˆå®ŒæˆååŠŸèƒ½æµ‹è¯•</div></div></a></div><div><a href="/2024/04/02/ubuntu%E9%85%8D%E7%BD%AE%E7%BD%91%E5%8D%A1bond%E7%89%88%20openstack%E9%83%A8%E7%BD%B2/" title="ubuntué…ç½®ç½‘å¡bondç‰ˆ openstackéƒ¨ç½²"><div class="cover" style="background:var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-03</div><div class="title">ubuntué…ç½®ç½‘å¡bondç‰ˆ openstackéƒ¨ç½²</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comment</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8%F0%9F%8D%A1/%E5%8A%A8%E6%BC%AB/blog_banner/20200723092041_a8fR5.gif" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">ç²˜äººçš„é¸­å˜´å…½çš„å°ç«™ğŸˆ</div><div class="author-info__description">..........</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">92</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">23</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">23</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zznn-cloud"><i class="fab fa-github"></i><span>ZzNnWn.</span><i class="faa-passing animated" style="padding-left:20px;display:inline-block;vertical-align:middle"><svg class="icon" style="height:28px;width:28px;fill:currentColor;position:relative;top:5px"><use xlink:href="#icon-xiaoqiche"></use></svg></i></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zznn-cloud" target="_blank" title="Github"><i class="fab fa-github" style="color:#24292e"></i></a><a class="social-icon" href="mailto:12345678@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color:#4a7dbe"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">æ¬¢è¿æ¥åˆ°ZzNnWn.çš„åšå®¢</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Catalog</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#kolla-ansible%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E4%B9%8B%E6%96%B0%E5%A2%9Eglance%E7%AD%89%E9%85%8D%E7%BD%AE%E4%BB%8B%E7%BB%8D%E6%96%87%E6%A1%A3"><span class="toc-number">1.</span> <span class="toc-text">kolla-ansibleåˆå¹¶é…ç½®æ–‡ä»¶å±æ€§ä¹‹æ–°å¢glanceç­‰é…ç½®ä»‹ç»æ–‡æ¡£</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ceph%E5%AF%86%E9%92%A5%E6%B5%8B%E8%AF%95%E5%AE%98%E7%BD%91%E6%96%B9%E5%BC%8F%E6%9E%84%E5%BB%BA"><span class="toc-number">1.1.</span> <span class="toc-text">cephå¯†é’¥æµ‹è¯•å®˜ç½‘æ–¹å¼æ„å»º</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%89%8D%E5%B7%B2%E9%AA%8C%E8%AF%81%E5%90%88%E5%B9%B6%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%94%9F%E6%95%88%E9%85%8D%E7%BD%AE"><span class="toc-number">1.2.</span> <span class="toc-text">ç›®å‰å·²éªŒè¯åˆå¹¶é…ç½®æ–‡ä»¶ç”Ÿæ•ˆé…ç½®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#glance%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%EF%BC%88glance-api-conf%EF%BC%89"><span class="toc-number">1.3.</span> <span class="toc-text">glanceé…ç½®æ–‡ä»¶ï¼ˆglance-api.confï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#KILO-AND-AFTER-gt-gt"><span class="toc-number">1.3.0.1.</span> <span class="toc-text">KILO AND AFTER&gt;&gt;</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ENABLE-COPY-ON-WRITE-CLONING-OF-IMAGES%EF%83%81"><span class="toc-number">1.3.0.2.</span> <span class="toc-text">ENABLE COPY-ON-WRITE CLONING OF IMAGES</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#ANY-OPENSTACK-VERSION-EXCEPT-MITAKA%EF%83%81"><span class="toc-number">1.3.0.2.1.</span> <span class="toc-text">ANY OPENSTACK VERSION EXCEPT MITAKA</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciner-%E5%AE%98%E7%BD%91%E5%8F%82%E8%80%83"><span class="toc-number">1.4.</span> <span class="toc-text">ciner(å®˜ç½‘å‚è€ƒ)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ciner-backup"><span class="toc-number">1.5.</span> <span class="toc-text">ciner-backup</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CONFIGURING-CINDER-BACKUP%EF%83%81"><span class="toc-number">1.5.1.</span> <span class="toc-text">CONFIGURING CINDER BACKUP</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nova%E4%B8%8Eceph"><span class="toc-number">1.6.</span> <span class="toc-text">novaä¸ceph</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CONFIGURING-NOVA-TO-ATTACH-CEPH-RBD-BLOCK-DEVICE%EF%83%81"><span class="toc-number">1.6.1.</span> <span class="toc-text">CONFIGURING NOVA TO ATTACH CEPH RBD BLOCK DEVICE</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CONFIGURING-NOVA%EF%83%81"><span class="toc-number">1.6.2.</span> <span class="toc-text">CONFIGURING NOVA</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/10/28/hello-world/" title="Hello World">Hello World</a><time datetime="2024-10-28T02:33:02.157Z" title="Created 2024-10-28 10:33:02">2024-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/27/5%E3%80%81deployment%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%EF%BC%88pod%E6%8E%A7%E5%88%B6%E5%99%A8%EF%BC%89/" title="5ã€k8s-deploymentå¢åˆ æ”¹æŸ¥ï¼ˆpodæ§åˆ¶å™¨ï¼‰"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8%F0%9F%8D%A1/%E5%8A%A8%E6%BC%AB/%E5%90%84%E7%A7%8D%E5%8A%A8%E6%BC%AB%E5%A3%81%E7%BA%B8/btf11.png" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="5ã€k8s-deploymentå¢åˆ æ”¹æŸ¥ï¼ˆpodæ§åˆ¶å™¨ï¼‰"></a><div class="content"><a class="title" href="/2024/10/27/5%E3%80%81deployment%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%EF%BC%88pod%E6%8E%A7%E5%88%B6%E5%99%A8%EF%BC%89/" title="5ã€k8s-deploymentå¢åˆ æ”¹æŸ¥ï¼ˆpodæ§åˆ¶å™¨ï¼‰">5ã€k8s-deploymentå¢åˆ æ”¹æŸ¥ï¼ˆpodæ§åˆ¶å™¨ï¼‰</a><time datetime="2024-10-27T18:19:38.337Z" title="Created 2024-10-28 02:19:38">2024-10-28</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(https://onenote.zznnwn.cloudns.biz/api/raw/?path=/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8%F0%9F%8D%A1/%E5%8A%A8%E6%BC%AB/blog_banner/16.jpg)"><div id="footer-wrap"><div id="ft"><div class="ft-item-1"><div class="t-top"><div class="t-t-l"><p class="ft-t t-l-t">è¯´ç‚¹ä»€ä¹ˆ</p><div class="bg-ad"><div>é™æ°´æµæ·±!</div><div class="btn-xz-box"><a class="btn-xz" target="_blank" rel="noopener" href="https://gegewu-cloud.github.io">æ™’åœ¨æ·±æµ·é‡Œ.</a></div></div></div><div class="t-t-r"><p class="ft-t t-l-t">ä¿®ä»™å¯¼èˆª</p><ul class="ft-links"><li><a target="_blank" rel="noopener" href="https://gegewu-cloud.github.io/2023/08/12/hexo%E4%B8%8Egithub%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/">å»ºç«™æŒ‡å—</a><a href="http://zznn-cloud.github.io/link/">ç½‘å€å¯¼èˆª</a></li><li><a href="http://zznn-cloud.github.io/2024/02/01/%E8%B5%9E%E5%8A%A9%E5%A2%99/">æ¥æ¯å’–å•¡</a><a target="_blank" rel="noopener" href="https://gegewu-cloud.github.io/2023/05/23/%E7%95%99%E8%A8%80%E6%9D%BF/">ç•™ç‚¹ä»€ä¹ˆ</a></li><li><a href="https://zznn-cloud.github.io/2024/02/01/ç®€å†/">ç®€å†</a><a target="_blank" rel="noopener" href="https://gegewu-cloud.github.io/2023/05/22/%E5%85%B3%E4%BA%8E/">å…³äºåšä¸»</a></li><li><a href="http://zznn-cloud.github.io/categories/">æ–‡ç« åˆ†ç±»</a><a href="http://zznn-cloud.github.io/tags/">æ–‡ç« æ ‡ç­¾</a></li><li><a href="http://zznn-cloud.github.io/archives/">æ–‡ç« å½’æ¡£</a><a target="_blank" rel="noopener" href="https://gegewu-cloud.github.io/2023/10/04/%E5%9B%BE%E5%BA%93/">æˆ‘çš„ç›¸å†Œ</a></li><li><a target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/onedrive/%E7%94%B5%E8%84%91%E5%A3%81%E7%BA%B8/%E5%8A%A8%E6%BC%AB/">ä¸€äº›å£çº¸</a></li></ul></div><div class="t-t-r"><p class="ft-t t-l-t">è‡ªæœ‰å·¥å…·ä¸è¯ä¹¦</p><ul class="ft-links"><li><a target="_blank" rel="noopener" href="https://Qexo.zznnwn.cloudns.biz/">Qexo</a><a target="_blank" rel="noopener" href="https://zznngpt.zznnwn.cloudns.biz/">GPT.</a><a target="_blank" rel="noopener" href="https://lchat.zznnwn.cloudns.biz">LobeChat.</a><a target="_blank" rel="noopener" href="https://images.zznnwn.cloudns.biz/">Blazeb2</a><a target="_blank" rel="noopener" href="https://drive.zznnwn.cloudns.biz/">ClouDreve</a><a target="_blank" rel="noopener" href="https://onenote.zznnwn.cloudns.biz/">onedrive</a><a target="_blank" rel="noopener" href="https://gegewu-proxy.zznnwn.cloudns.biz/">ghproxy</a></li></ul></div></div></div><div class="ft-item-2"><p class="ft-t">æ¨èå‹é“¾</p><div class="ft-img-group"><div class="img-group-item"><a target="_blank" rel="noopener" href="https://www.oiox.cn/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.oiox.cn/1.jpg" alt=""></a></div><div class="img-group-item"><a target="_blank" rel="noopener" href="https://www.yyds.space/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.whbblog.cn/other/touxiang.jpg" alt=""></a></div><div class="img-group-item"><a target="_blank" rel="noopener" href="https://fe32.top/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://bu.dusays.com/2022/05/02/626f92e193879.jpg" alt=""></a></div><div class="img-group-item"><a target="_blank" rel="noopener" href="https://www.gucat.vip/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://mirrors.gucat.vip/api/public/dl/Rkcdr-Y4/head.jpg" alt=""></a></div><div class="img-group-item"><a target="_blank" rel="noopener" href="https://www.fomal.cc/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://sourcebucket.s3.bitiful.net/img/avatar.webp" alt=""></a></div><div class="img-group-item"><a target="_blank" rel="noopener" href="https://qexo.zznnwn.cloudns.biz/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://unpkg.com/qexo-static@2.2.3/qexo/images/icon.png" alt=""></a></div><div class="img-group-item"><a target="_blank" rel="noopener" href="https://chatgpt.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://wn-apple-teawine.fun/img/chatgpt.jpg" alt=""></a></div><div class="img-group-item"><a target="_blank" rel="noopener" href="https://gegewu-cloud.github.io/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://gegewu-cloud.github.io/img/zznnlogo.webp" alt=""></a></div></div></div><div class="ft-item-3"><p class="ft-t">æ¬¢è¿å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ğŸ¡</p><div class="ft-img-group"><div class="img-group-item"><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://f005.backblazeb2.com/file/ZzNnWn-Images/ZzNnWn-Images/32669c3a-70bf-4466-87c4-b677eab7cc82.png" alt=""></a></div></div></div></div><div class="copyright">&copy;2023 - 2024 <i id="heartbeat" class="fa fas fa-heartbeat"></i> ç²˜äººçš„é¸­å˜´å…½çš„å°ç«™ğŸˆ</div><div class="footer_custom_text"><a href="https://icp.gov.moe/?keyword=20240203" target="_blank">èŒICPå¤‡20240203å·</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Read Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Switch Between Traditional Chinese And Simplified Chinese">ç¹</button><button id="darkmode" type="button" title="Switch Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table Of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll To Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back To Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(0!==e.length){const n=()=>{window.loadMermaid=!0;const r="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach((e,t)=>{const n=e.firstElementChild;e="%%{init:{ 'theme':'"+r+"'}}%%\n"+n.textContent;const d=mermaid.render("mermaid-"+t,e);"string"==typeof d?(t=d,n.insertAdjacentHTML("afterend",t)):d.then(({svg:e})=>{n.insertAdjacentHTML("afterend",e)})})};var t=()=>{window.loadMermaid?n():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(n)};btf.addModeChange("mermaid",n),window.pjax?t():document.addEventListener("DOMContentLoaded",t)}})()</script><script>function loadValine(){function n(){new Valine(Object.assign({el:"#vcomment",appId:"P48Q1dVi0g9C7kUF7YMa25B4-gzGzoHsz",appKey:"C4EAGswe0EuoSlvTIlJYyi7S",avatar:"monsterid",serverURLs:"",emojiMaps:"",path:window.location.pathname,visitor:!0},null))}"function"==typeof Valine?n():getScript("https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js").then(n)}function loadOtherComment(){loadValine()}btf.loadComment(document.getElementById("vcomment"),loadValine)</script></div><script defer src="https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js"></script><script defer data-pjax src="/js/cat.js"></script><canvas id="universe"></canvas><script defer src="/js/universe.js"></script><div class="aplayer no-destroy" data-id="8456378003" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true" data-lrctype="-1" data-order="random"></div><script async data-pjax src="/js/randombg.js"></script><script async src="/js/diytitle.js"></script><script src="https://cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script><script defer src="/live2d-widget-master/autoload.js"></script><script async src="//at.alicdn.com/t/c/font_4426032_wnvg24di0w.css"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="false" data-text="ä¸œé£å¤œæ”¾èŠ±åƒæ ‘ï¼Œæ›´å¹è½ï¼Œæ˜Ÿå¦‚é›¨ã€‚,å®é©¬é›•è½¦é¦™æ»¡è·¯ã€‚,å‡¤ç®«å£°åŠ¨ï¼Œç‰å£¶å…‰è½¬ï¼Œä¸€å¤œé±¼é¾™èˆã€‚,è›¾å„¿é›ªæŸ³é»„é‡‘ç¼•ï¼Œç¬‘è¯­ç›ˆç›ˆæš—é¦™å»ã€‚,ä¼—é‡Œå¯»ä»–åƒç™¾åº¦ï¼Œè“¦ç„¶å›é¦–ï¼Œé‚£äººå´åœ¨ï¼Œç¯ç«é˜‘çŠå¤„ã€‚" data-fontsize="15px" data-random="false" async></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",function(){if(window.tocScrollFn&&window.removeEventListener("scroll",window.tocScrollFn),window.scrollCollect&&window.removeEventListener("scroll",scrollCollect),document.getElementById("rightside").style.cssText="opacity: ''; transform: ''",window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();var e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode"),"object"==typeof disqusjs&&disqusjs.destroy()}),document.addEventListener("pjax:complete",function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script");var o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()}),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> Loading the Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>